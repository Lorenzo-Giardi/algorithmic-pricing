{"episode_reward_max": 57.80398935785938, "episode_reward_min": 53.694054821490674, "episode_reward_mean": 55.90074277486431, "episode_len_mean": 100.0, "episodes_this_iter": 808, "policy_reward_mean": {"agent_0": 27.94175027888624, "agent_1": 27.958992495978098}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6379816993028808, "mean_processing_ms": 3.0158581513362064, "mean_inference_ms": 1.9093028142877808}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1, "num_steps_trained": 89600, "num_steps_sampled": 79872, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 154, "num_samples_dropped": 354, "learner_queue": {"size_count": 10761, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.162, "replay_time_ms": 93.423, "update_priorities_time_ms": 58.304, "policy_agent_0": {"added_count": 19200, "sampled_count": 22784, "est_size_bytes": 25018200, "num_entries": 19200}, "policy_agent_1": {"added_count": 19200, "sampled_count": 22784, "est_size_bytes": 25018200, "num_entries": 19200}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 1.048586368560791, "min_q": 0.9149249196052551, "max_q": 1.162501335144043, "mean_td_error": -0.022961391136050224, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 1.0764919519424438, "min_q": 0.9440535306930542, "max_q": 1.1906579732894897, "mean_td_error": 0.02096356824040413, "model": {}}}}, "timesteps_this_iter": 79872, "done": false, "timesteps_total": 79872, "episodes_total": 808, "training_iteration": 1, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-37-37", "timestamp": 1569659857, "time_this_iter_s": 30.577207326889038, "time_total_s": 30.577207326889038, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5faba60>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 30.577207326889038, "timesteps_since_restore": 79872, "iterations_since_restore": 1, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.71496358077946, "episode_reward_min": 53.06496038664924, "episode_reward_mean": 55.33321314941616, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.713190924324607, "agent_1": 27.620022225091578}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6710168720300517, "mean_processing_ms": 3.087048010952805, "mean_inference_ms": 1.922214806691712}, "off_policy_estimator": {}, "info": {"min_exploration": 0.84345088, "max_exploration": 0.84345088, "num_target_updates": 5, "num_steps_trained": 252928, "num_steps_sampled": 182016, "sample_throughput": 22052.162, "train_throughput": 0.0, "num_weight_syncs": 354, "num_samples_dropped": 354, "learner_queue": {"size_count": 11398, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.751, "replay_time_ms": 77.398, "update_priorities_time_ms": 44.532, "policy_agent_0": {"added_count": 43776, "sampled_count": 63744, "est_size_bytes": 57041472, "num_entries": 43776}, "policy_agent_1": {"added_count": 43776, "sampled_count": 63744, "est_size_bytes": 57041472, "num_entries": 43776}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 4.033945560455322, "min_q": 3.8420636653900146, "max_q": 4.22796106338501, "mean_td_error": 0.37234488129615784, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 4.074042320251465, "min_q": 3.8520209789276123, "max_q": 4.247175693511963, "mean_td_error": 0.4408809244632721, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 182016, "episodes_total": 1824, "training_iteration": 2, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-38-08", "timestamp": 1569659888, "time_this_iter_s": 30.551321029663086, "time_total_s": 61.128528356552124, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5fc3d90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 61.128528356552124, "timesteps_since_restore": 182016, "iterations_since_restore": 2, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 56.3632815854098, "episode_reward_min": 51.86405206440215, "episode_reward_mean": 54.314960133603904, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 27.23709275839985, "agent_1": 27.077867375204086}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6774515874523718, "mean_processing_ms": 3.0672358760383016, "mean_inference_ms": 1.8973048679057187}, "off_policy_estimator": {}, "info": {"min_exploration": 0.6432486399999999, "max_exploration": 0.6432486399999999, "num_target_updates": 8, "num_steps_trained": 411392, "num_steps_sampled": 287232, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 560, "num_samples_dropped": 354, "learner_queue": {"size_count": 12017, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.056, "replay_time_ms": 81.28, "update_priorities_time_ms": 45.691, "policy_agent_0": {"added_count": 67584, "sampled_count": 106240, "est_size_bytes": 88064016, "num_entries": 67584}, "policy_agent_1": {"added_count": 67584, "sampled_count": 106240, "est_size_bytes": 88064016, "num_entries": 67584}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 5.12343692779541, "min_q": 4.96356725692749, "max_q": 5.228359222412109, "mean_td_error": 0.014664243906736374, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 5.151347637176514, "min_q": 5.001224040985107, "max_q": 5.284277439117432, "mean_td_error": 0.06881663203239441, "model": {}}}}, "timesteps_this_iter": 105216, "done": false, "timesteps_total": 287232, "episodes_total": 2872, "training_iteration": 3, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-38-38", "timestamp": 1569659918, "time_this_iter_s": 30.565897703170776, "time_total_s": 91.6944260597229, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5fd1e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 91.6944260597229, "timesteps_since_restore": 287232, "iterations_since_restore": 3, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.42251545049904, "episode_reward_min": 48.450387673773385, "episode_reward_mean": 52.785026785021934, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.68530335997241, "agent_1": 26.099723425049547}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6779842277087613, "mean_processing_ms": 3.06840523320838, "mean_inference_ms": 1.9142385038785537}, "off_policy_estimator": {}, "info": {"min_exploration": 0.43702528000000007, "max_exploration": 0.43702528000000007, "num_target_updates": 11, "num_steps_trained": 567808, "num_steps_sampled": 390400, "sample_throughput": 9617.149, "train_throughput": 0.0, "num_weight_syncs": 762, "num_samples_dropped": 354, "learner_queue": {"size_count": 12630, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.91, "replay_time_ms": 105.914, "update_priorities_time_ms": 58.996, "policy_agent_0": {"added_count": 94720, "sampled_count": 145152, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 94720, "sampled_count": 145152, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 6.226869583129883, "min_q": 6.10826301574707, "max_q": 6.316619873046875, "mean_td_error": 0.004207797348499298, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 6.160495281219482, "min_q": 6.007535457611084, "max_q": 6.282728672027588, "mean_td_error": -0.028935858979821205, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 390400, "episodes_total": 3904, "training_iteration": 4, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-39-09", "timestamp": 1569659949, "time_this_iter_s": 30.591118812561035, "time_total_s": 122.28554487228394, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f61378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 122.28554487228394, "timesteps_since_restore": 390400, "iterations_since_restore": 4, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 56.35770902205887, "episode_reward_min": 47.26871641538637, "episode_reward_mean": 51.60345457879575, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 26.021693925180717, "agent_1": 25.581760653615046}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6755043822035594, "mean_processing_ms": 3.050295407287238, "mean_inference_ms": 1.9067959672834076}, "off_policy_estimator": {}, "info": {"min_exploration": 0.2348159999999999, "max_exploration": 0.2348159999999999, "num_target_updates": 14, "num_steps_trained": 721152, "num_steps_sampled": 496128, "sample_throughput": 4651.959, "train_throughput": 9303.917, "num_weight_syncs": 969, "num_samples_dropped": 354, "learner_queue": {"size_count": 13228, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.244, "replay_time_ms": 90.823, "update_priorities_time_ms": 46.288, "policy_agent_0": {"added_count": 116992, "sampled_count": 183552, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 116992, "sampled_count": 183552, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 7.0552520751953125, "min_q": 6.899584770202637, "max_q": 7.166431427001953, "mean_td_error": 0.0185525082051754, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 7.0211944580078125, "min_q": 6.8671112060546875, "max_q": 7.166854381561279, "mean_td_error": 0.005150953307747841, "model": {}}}}, "timesteps_this_iter": 105728, "done": false, "timesteps_total": 496128, "episodes_total": 4968, "training_iteration": 5, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-39-39", "timestamp": 1569659979, "time_this_iter_s": 30.579097032546997, "time_total_s": 152.86464190483093, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f61f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 152.86464190483093, "timesteps_since_restore": 496128, "iterations_since_restore": 5, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.90251521477389, "episode_reward_min": 44.946289293765794, "episode_reward_mean": 52.13184990505276, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.63072947431855, "agent_1": 25.50112043073424}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6809463957404968, "mean_processing_ms": 3.0675350702979385, "mean_inference_ms": 1.9119866643735197}, "off_policy_estimator": {}, "info": {"min_exploration": 0.027589120000000023, "max_exploration": 0.027589120000000023, "num_target_updates": 17, "num_steps_trained": 872960, "num_steps_sampled": 598272, "sample_throughput": 8203.892, "train_throughput": 8203.892, "num_weight_syncs": 1168, "num_samples_dropped": 354, "learner_queue": {"size_count": 13820, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.644, "replay_time_ms": 85.383, "update_priorities_time_ms": 51.28, "policy_agent_0": {"added_count": 142848, "sampled_count": 223232, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 142848, "sampled_count": 223232, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 7.658933639526367, "min_q": 7.431421279907227, "max_q": 7.888525009155273, "mean_td_error": -0.012070439755916595, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 7.558726787567139, "min_q": 7.3852033615112305, "max_q": 7.737677574157715, "mean_td_error": -0.01594541408121586, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 598272, "episodes_total": 5992, "training_iteration": 6, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-40-10", "timestamp": 1569660010, "time_this_iter_s": 30.55000400543213, "time_total_s": 183.41464591026306, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f77488>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 183.41464591026306, "timesteps_since_restore": 598272, "iterations_since_restore": 6, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.041634783545064, "episode_reward_min": 43.309242321453326, "episode_reward_mean": 49.3929250847115, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 25.2799381472679, "agent_1": 24.112986937443598}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814764002952547, "mean_processing_ms": 3.069644742064673, "mean_inference_ms": 1.9066401974508926}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 20, "num_steps_trained": 1027584, "num_steps_sampled": 702720, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1371, "num_samples_dropped": 354, "learner_queue": {"size_count": 14424, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.139, "replay_time_ms": 111.493, "update_priorities_time_ms": 55.022, "policy_agent_0": {"added_count": 169216, "sampled_count": 261376, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 169216, "sampled_count": 261376, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 8.15589714050293, "min_q": 7.907284259796143, "max_q": 8.516548156738281, "mean_td_error": -0.009739404544234276, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 8.054606437683105, "min_q": 7.763699531555176, "max_q": 8.33191967010498, "mean_td_error": 0.028417887166142464, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 702720, "episodes_total": 7032, "training_iteration": 7, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-40-41", "timestamp": 1569660041, "time_this_iter_s": 30.58389401435852, "time_total_s": 213.99853992462158, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f840d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 213.99853992462158, "timesteps_since_restore": 702720, "iterations_since_restore": 7, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 53.779746157271425, "episode_reward_min": 41.2260045742948, "episode_reward_mean": 47.941366181024755, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 23.569629488993638, "agent_1": 24.37173669203111}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6845336673724317, "mean_processing_ms": 3.0823226375927506, "mean_inference_ms": 1.9280182654657656}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 23, "num_steps_trained": 1169408, "num_steps_sampled": 800512, "sample_throughput": 7339.717, "train_throughput": 0.0, "num_weight_syncs": 1562, "num_samples_dropped": 354, "learner_queue": {"size_count": 14978, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.735, "replay_time_ms": 93.839, "update_priorities_time_ms": 52.582, "policy_agent_0": {"added_count": 192000, "sampled_count": 296960, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 192000, "sampled_count": 296960, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 8.453463554382324, "min_q": 8.000975608825684, "max_q": 9.297324180603027, "mean_td_error": 0.014388345181941986, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 8.296751022338867, "min_q": 7.94149923324585, "max_q": 8.694695472717285, "mean_td_error": -0.013369658961892128, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 800512, "episodes_total": 8008, "training_iteration": 8, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-41-11", "timestamp": 1569660071, "time_this_iter_s": 30.620682954788208, "time_total_s": 244.6192228794098, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f87598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 244.6192228794098, "timesteps_since_restore": 800512, "iterations_since_restore": 8, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.28910640896172, "episode_reward_min": 48.66176497803196, "episode_reward_mean": 52.85871191672154, "episode_len_mean": 100.0, "episodes_this_iter": 928, "policy_reward_mean": {"agent_0": 27.95942369527559, "agent_1": 24.89928822144599}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6839467933574217, "mean_processing_ms": 3.102608564308817, "mean_inference_ms": 1.9603707574985338}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 26, "num_steps_trained": 1306112, "num_steps_sampled": 894208, "sample_throughput": 6905.359, "train_throughput": 0.0, "num_weight_syncs": 1745, "num_samples_dropped": 354, "learner_queue": {"size_count": 15512, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.951, "replay_time_ms": 118.118, "update_priorities_time_ms": 55.071, "policy_agent_0": {"added_count": 215040, "sampled_count": 330752, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 215040, "sampled_count": 330752, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 8.693146705627441, "min_q": 8.182905197143555, "max_q": 9.176191329956055, "mean_td_error": -0.0785904973745346, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 8.545591354370117, "min_q": 8.229025840759277, "max_q": 8.933504104614258, "mean_td_error": -0.06235409528017044, "model": {}}}}, "timesteps_this_iter": 93696, "done": false, "timesteps_total": 894208, "episodes_total": 8936, "training_iteration": 9, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-41-42", "timestamp": 1569660102, "time_this_iter_s": 30.590017080307007, "time_total_s": 275.2092399597168, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f141e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 275.2092399597168, "timesteps_since_restore": 894208, "iterations_since_restore": 9, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.391092489673476, "episode_reward_min": 50.970605036334135, "episode_reward_mean": 52.12399938006635, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.59492854297996, "agent_1": 25.529070837086376}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6819994647456988, "mean_processing_ms": 3.1024918521629594, "mean_inference_ms": 1.9651084467644724}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 29, "num_steps_trained": 1460736, "num_steps_sampled": 995584, "sample_throughput": 0.0, "train_throughput": 28403.614, "num_weight_syncs": 1944, "num_samples_dropped": 354, "learner_queue": {"size_count": 16116, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.845, "replay_time_ms": 79.569, "update_priorities_time_ms": 42.148, "policy_agent_0": {"added_count": 242944, "sampled_count": 371200, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 242944, "sampled_count": 371200, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.150813102722168, "min_q": 8.723071098327637, "max_q": 9.499162673950195, "mean_td_error": 0.07153552770614624, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 8.90483283996582, "min_q": 8.674005508422852, "max_q": 9.237996101379395, "mean_td_error": 0.004463542252779007, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 995584, "episodes_total": 9952, "training_iteration": 10, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-42-12", "timestamp": 1569660132, "time_this_iter_s": 30.48760747909546, "time_total_s": 305.69684743881226, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f226a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 305.69684743881226, "timesteps_since_restore": 995584, "iterations_since_restore": 10, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.73362180068202, "episode_reward_min": 48.137657795311, "episode_reward_mean": 51.36093834426156, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 26.393258430462264, "agent_1": 24.967679913799245}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6829951976032052, "mean_processing_ms": 3.101663403097502, "mean_inference_ms": 1.9604499994578037}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 32, "num_steps_trained": 1607680, "num_steps_sampled": 1098496, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2145, "num_samples_dropped": 354, "learner_queue": {"size_count": 16691, "size_mean": 0.18, "size_std": 0.4770744176750626, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.408, "replay_time_ms": 107.838, "update_priorities_time_ms": 55.164, "policy_agent_0": {"added_count": 267008, "sampled_count": 408576, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 267008, "sampled_count": 408576, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.375860214233398, "min_q": 9.092011451721191, "max_q": 9.742581367492676, "mean_td_error": 0.019989781081676483, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.086749076843262, "min_q": 8.754737854003906, "max_q": 9.289918899536133, "mean_td_error": 0.04022954776883125, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 1098496, "episodes_total": 10992, "training_iteration": 11, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-42-43", "timestamp": 1569660163, "time_this_iter_s": 30.607298374176025, "time_total_s": 336.3041458129883, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f2d2f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 336.3041458129883, "timesteps_since_restore": 1098496, "iterations_since_restore": 11, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 51.95050892078685, "episode_reward_min": 43.8089705564185, "episode_reward_mean": 47.48308686583245, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 23.025796800700377, "agent_1": 24.4572900651321}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811045571982294, "mean_processing_ms": 3.0996845904211425, "mean_inference_ms": 1.9619340875550613}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 35, "num_steps_trained": 1765632, "num_steps_sampled": 1200896, "sample_throughput": 18995.875, "train_throughput": 0.0, "num_weight_syncs": 2344, "num_samples_dropped": 354, "learner_queue": {"size_count": 17307, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.53, "replay_time_ms": 104.458, "update_priorities_time_ms": 49.793, "policy_agent_0": {"added_count": 293632, "sampled_count": 448000, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 293632, "sampled_count": 448000, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.435922622680664, "min_q": 9.027040481567383, "max_q": 9.666388511657715, "mean_td_error": 0.02491307258605957, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.13432788848877, "min_q": 8.974230766296387, "max_q": 9.370806694030762, "mean_td_error": 0.026796404272317886, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 1200896, "episodes_total": 12016, "training_iteration": 12, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-43-14", "timestamp": 1569660194, "time_this_iter_s": 30.526407718658447, "time_total_s": 366.83055353164673, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f317b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 366.83055353164673, "timesteps_since_restore": 1200896, "iterations_since_restore": 12, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 47.61223795852941, "episode_reward_min": 43.78897465127707, "episode_reward_mean": 45.601923466424, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 20.374537304093074, "agent_1": 25.227386162330944}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681653311569201, "mean_processing_ms": 3.099405618070401, "mean_inference_ms": 1.9649929927545624}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 38, "num_steps_trained": 1924096, "num_steps_sampled": 1302784, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2543, "num_samples_dropped": 354, "learner_queue": {"size_count": 17926, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.614, "replay_time_ms": 97.502, "update_priorities_time_ms": 56.571, "policy_agent_0": {"added_count": 320000, "sampled_count": 486912, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 320000, "sampled_count": 486912, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.282247543334961, "min_q": 8.940980911254883, "max_q": 9.759730339050293, "mean_td_error": 0.0869871973991394, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.236452102661133, "min_q": 9.087028503417969, "max_q": 9.367426872253418, "mean_td_error": -0.002776946872472763, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 1302784, "episodes_total": 13032, "training_iteration": 13, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-43-44", "timestamp": 1569660224, "time_this_iter_s": 30.572375297546387, "time_total_s": 397.4029288291931, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f41400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 397.4029288291931, "timesteps_since_restore": 1302784, "iterations_since_restore": 13, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 50.54837424832872, "episode_reward_min": 44.54503333511544, "episode_reward_mean": 47.99383380716441, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 23.224006253043953, "agent_1": 24.76982755412046}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6825579240552888, "mean_processing_ms": 3.096149699693808, "mean_inference_ms": 1.9594382064280127}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 41, "num_steps_trained": 2080256, "num_steps_sampled": 1405696, "sample_throughput": 0.0, "train_throughput": 13010.952, "num_weight_syncs": 2745, "num_samples_dropped": 354, "learner_queue": {"size_count": 18536, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.155, "replay_time_ms": 84.824, "update_priorities_time_ms": 44.37, "policy_agent_0": {"added_count": 345600, "sampled_count": 527872, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 345600, "sampled_count": 527872, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.099239349365234, "min_q": 8.820865631103516, "max_q": 9.574478149414062, "mean_td_error": 0.00575082004070282, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.195898056030273, "min_q": 9.078147888183594, "max_q": 9.323232650756836, "mean_td_error": 0.00671299546957016, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 1405696, "episodes_total": 14056, "training_iteration": 14, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-44-15", "timestamp": 1569660255, "time_this_iter_s": 30.589340686798096, "time_total_s": 427.9922695159912, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f468c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 427.9922695159912, "timesteps_since_restore": 1405696, "iterations_since_restore": 14, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.31440363707561, "episode_reward_min": 44.22150443305352, "episode_reward_mean": 47.915373165984604, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 23.283763223941886, "agent_1": 24.63160994204275}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6835560940465606, "mean_processing_ms": 3.0995744136062933, "mean_inference_ms": 1.9602834704718584}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 44, "num_steps_trained": 2237696, "num_steps_sampled": 1508352, "sample_throughput": 0.0, "train_throughput": 21252.114, "num_weight_syncs": 2945, "num_samples_dropped": 354, "learner_queue": {"size_count": 19151, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.317, "replay_time_ms": 85.287, "update_priorities_time_ms": 47.768, "policy_agent_0": {"added_count": 370432, "sampled_count": 568576, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 370432, "sampled_count": 568576, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.10416030883789, "min_q": 8.89513874053955, "max_q": 9.503087043762207, "mean_td_error": -0.003352861851453781, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.263978004455566, "min_q": 9.178304672241211, "max_q": 9.377299308776855, "mean_td_error": -0.0065174587070941925, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 1508352, "episodes_total": 15088, "training_iteration": 15, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-44-45", "timestamp": 1569660285, "time_this_iter_s": 30.61727523803711, "time_total_s": 458.6095447540283, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f22840>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 458.6095447540283, "timesteps_since_restore": 1508352, "iterations_since_restore": 15, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 51.61901570610763, "episode_reward_min": 43.86293745755633, "episode_reward_mean": 48.34192537488743, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 24.37631490883884, "agent_1": 23.965610466048606}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6810270233101436, "mean_processing_ms": 3.093446563108186, "mean_inference_ms": 1.953617888187024}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 47, "num_steps_trained": 2390016, "num_steps_sampled": 1613568, "sample_throughput": 8872.103, "train_throughput": 8872.103, "num_weight_syncs": 3151, "num_samples_dropped": 354, "learner_queue": {"size_count": 19746, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.764, "replay_time_ms": 93.421, "update_priorities_time_ms": 46.685, "policy_agent_0": {"added_count": 395008, "sampled_count": 608000, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 395008, "sampled_count": 608000, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.047571182250977, "min_q": 8.883037567138672, "max_q": 9.25705623626709, "mean_td_error": -0.04696067422628403, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.266358375549316, "min_q": 9.092721939086914, "max_q": 9.419775009155273, "mean_td_error": 0.02581675723195076, "model": {}}}}, "timesteps_this_iter": 105216, "done": false, "timesteps_total": 1613568, "episodes_total": 16136, "training_iteration": 16, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-45-16", "timestamp": 1569660316, "time_this_iter_s": 30.50917887687683, "time_total_s": 489.11872363090515, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c6809c80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 489.11872363090515, "timesteps_since_restore": 1613568, "iterations_since_restore": 16, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.759587253442966, "episode_reward_min": 44.993682782572236, "episode_reward_mean": 48.6213493588408, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 24.86815735478211, "agent_1": 23.75319200405873}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6807696325719972, "mean_processing_ms": 3.0912089091020634, "mean_inference_ms": 1.950664857628139}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 50, "num_steps_trained": 2539776, "num_steps_sampled": 1718272, "sample_throughput": 18026.388, "train_throughput": 0.0, "num_weight_syncs": 3355, "num_samples_dropped": 354, "learner_queue": {"size_count": 20332, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.844, "replay_time_ms": 100.401, "update_priorities_time_ms": 52.021, "policy_agent_0": {"added_count": 422912, "sampled_count": 644864, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 422912, "sampled_count": 644864, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.150802612304688, "min_q": 8.946619987487793, "max_q": 9.338412284851074, "mean_td_error": -0.022077761590480804, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.21875, "min_q": 9.074737548828125, "max_q": 9.451313972473145, "mean_td_error": 0.03923032060265541, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 1718272, "episodes_total": 17184, "training_iteration": 17, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-45-46", "timestamp": 1569660346, "time_this_iter_s": 30.543171167373657, "time_total_s": 519.6618947982788, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c6892bf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 519.6618947982788, "timesteps_since_restore": 1718272, "iterations_since_restore": 17, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 61.272832642382866, "episode_reward_min": 48.94018184949091, "episode_reward_mean": 52.633302600368566, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 27.843723665564205, "agent_1": 24.789578934804368}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6817658351877202, "mean_processing_ms": 3.0954044494492825, "mean_inference_ms": 1.94949831853758}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 53, "num_steps_trained": 2692096, "num_steps_sampled": 1821440, "sample_throughput": 0.0, "train_throughput": 20903.339, "num_weight_syncs": 3556, "num_samples_dropped": 354, "learner_queue": {"size_count": 20926, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.306, "replay_time_ms": 105.433, "update_priorities_time_ms": 51.038, "policy_agent_0": {"added_count": 451328, "sampled_count": 679680, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 451328, "sampled_count": 679680, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.435848236083984, "min_q": 9.20173454284668, "max_q": 9.791143417358398, "mean_td_error": 0.07653844356536865, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.339774131774902, "min_q": 9.130395889282227, "max_q": 9.515338897705078, "mean_td_error": 0.038733117282390594, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 1821440, "episodes_total": 18224, "training_iteration": 18, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-46-17", "timestamp": 1569660377, "time_this_iter_s": 30.56126117706299, "time_total_s": 550.2231559753418, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c67eb9d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 550.2231559753418, "timesteps_since_restore": 1821440, "iterations_since_restore": 18, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 61.94949165619009, "episode_reward_min": 50.24803175664196, "episode_reward_mean": 57.25541189663854, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.503660897714607, "agent_1": 29.75175099892393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6810232693874789, "mean_processing_ms": 3.0940958180302176, "mean_inference_ms": 1.9510092194269257}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 56, "num_steps_trained": 2850304, "num_steps_sampled": 1923584, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3756, "num_samples_dropped": 354, "learner_queue": {"size_count": 21544, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.962, "replay_time_ms": 75.674, "update_priorities_time_ms": 38.264, "policy_agent_0": {"added_count": 478208, "sampled_count": 719360, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 478208, "sampled_count": 719360, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.794363021850586, "min_q": 9.535639762878418, "max_q": 9.989018440246582, "mean_td_error": 0.03368878737092018, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.48254680633545, "min_q": 9.288191795349121, "max_q": 9.651458740234375, "mean_td_error": 0.024015109986066818, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 1923584, "episodes_total": 19240, "training_iteration": 19, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-46-48", "timestamp": 1569660408, "time_this_iter_s": 30.41489005088806, "time_total_s": 580.6380460262299, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f51620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 580.6380460262299, "timesteps_since_restore": 1923584, "iterations_since_restore": 19, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 60.677128443589666, "episode_reward_min": 49.78239079713873, "episode_reward_mean": 56.52621478868551, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.627599662698902, "agent_1": 29.898615125986584}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6815762538809347, "mean_processing_ms": 3.095402235422189, "mean_inference_ms": 1.9489938457990477}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 59, "num_steps_trained": 3002624, "num_steps_sampled": 2025984, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3956, "num_samples_dropped": 354, "learner_queue": {"size_count": 22139, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.66, "replay_time_ms": 98.496, "update_priorities_time_ms": 51.142, "policy_agent_0": {"added_count": 498944, "sampled_count": 760064, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 498944, "sampled_count": 760064, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.053021430969238, "min_q": 9.835042953491211, "max_q": 10.238828659057617, "mean_td_error": 0.06777307391166687, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.854276657104492, "min_q": 9.576878547668457, "max_q": 9.975598335266113, "mean_td_error": 0.0001734904944896698, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 2025984, "episodes_total": 20272, "training_iteration": 20, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-47-18", "timestamp": 1569660438, "time_this_iter_s": 30.514797925949097, "time_total_s": 611.152843952179, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f2dae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 611.152843952179, "timesteps_since_restore": 2025984, "iterations_since_restore": 20, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 59.38470094985976, "episode_reward_min": 44.44743037032586, "episode_reward_mean": 51.41212076519893, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 27.320959194164427, "agent_1": 24.091161571034533}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6799013001166937, "mean_processing_ms": 3.0923338993946436, "mean_inference_ms": 1.9486183063636355}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 62, "num_steps_trained": 3155200, "num_steps_sampled": 2130432, "sample_throughput": 17063.564, "train_throughput": 8531.782, "num_weight_syncs": 4160, "num_samples_dropped": 354, "learner_queue": {"size_count": 22735, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.949, "replay_time_ms": 79.388, "update_priorities_time_ms": 44.398, "policy_agent_0": {"added_count": 521728, "sampled_count": 797696, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 521728, "sampled_count": 797696, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.960898399353027, "min_q": 9.813764572143555, "max_q": 10.100882530212402, "mean_td_error": 0.03614649921655655, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.108898162841797, "min_q": 9.836760520935059, "max_q": 10.375962257385254, "mean_td_error": 0.01713399961590767, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 2130432, "episodes_total": 21304, "training_iteration": 21, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-47-49", "timestamp": 1569660469, "time_this_iter_s": 30.517114639282227, "time_total_s": 641.6699585914612, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5fab510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 641.6699585914612, "timesteps_since_restore": 2130432, "iterations_since_restore": 21, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.82941257596748, "episode_reward_min": 42.68034852423216, "episode_reward_mean": 49.15897080499562, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 27.478595861175624, "agent_1": 21.68037494382001}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.680604676871489, "mean_processing_ms": 3.0905958366908024, "mean_inference_ms": 1.9483994263069624}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 65, "num_steps_trained": 3307520, "num_steps_sampled": 2234880, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4364, "num_samples_dropped": 354, "learner_queue": {"size_count": 23330, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.189, "replay_time_ms": 91.089, "update_priorities_time_ms": 47.189, "policy_agent_0": {"added_count": 542464, "sampled_count": 838656, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 542464, "sampled_count": 838656, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.04189682006836, "min_q": 9.7866849899292, "max_q": 10.333539009094238, "mean_td_error": -0.03192035108804703, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.925652503967285, "min_q": 9.466550827026367, "max_q": 10.49704360961914, "mean_td_error": -0.03396022692322731, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 2234880, "episodes_total": 22352, "training_iteration": 22, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-48-19", "timestamp": 1569660499, "time_this_iter_s": 30.47282576560974, "time_total_s": 672.1427843570709, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5fcba60>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 672.1427843570709, "timesteps_since_restore": 2234880, "iterations_since_restore": 22, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.34480159512436, "episode_reward_min": 44.84372480160893, "episode_reward_mean": 48.08604569097851, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 24.950873112125393, "agent_1": 23.13517257885318}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6803168507070756, "mean_processing_ms": 3.0901601085093424, "mean_inference_ms": 1.947609240503068}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 68, "num_steps_trained": 3460096, "num_steps_sampled": 2338560, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4566, "num_samples_dropped": 354, "learner_queue": {"size_count": 23926, "size_mean": 0.1, "size_std": 0.36055512754639896, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.382, "replay_time_ms": 109.348, "update_priorities_time_ms": 52.289, "policy_agent_0": {"added_count": 566272, "sampled_count": 878336, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 566272, "sampled_count": 878336, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.020429611206055, "min_q": 9.807859420776367, "max_q": 10.361894607543945, "mean_td_error": -0.03204936534166336, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.75963306427002, "min_q": 9.48363971710205, "max_q": 10.250256538391113, "mean_td_error": 0.005225777626037598, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 2338560, "episodes_total": 23392, "training_iteration": 23, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-48-50", "timestamp": 1569660530, "time_this_iter_s": 30.675424575805664, "time_total_s": 702.8182089328766, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f688c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 702.8182089328766, "timesteps_since_restore": 2338560, "iterations_since_restore": 23, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.91194243320143, "episode_reward_min": 44.770156276934955, "episode_reward_mean": 52.2536251680928, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 25.94520442779348, "agent_1": 26.30842074029935}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6799685735165022, "mean_processing_ms": 3.087603709423557, "mean_inference_ms": 1.9462564816556296}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 71, "num_steps_trained": 3612672, "num_steps_sampled": 2442240, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4769, "num_samples_dropped": 354, "learner_queue": {"size_count": 24523, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.291, "replay_time_ms": 101.422, "update_priorities_time_ms": 54.449, "policy_agent_0": {"added_count": 591360, "sampled_count": 918016, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 591360, "sampled_count": 918016, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.988704681396484, "min_q": 9.783111572265625, "max_q": 10.240836143493652, "mean_td_error": -1.0866671800613403e-05, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.668760299682617, "min_q": 9.395209312438965, "max_q": 9.975905418395996, "mean_td_error": 0.010102879256010056, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 2442240, "episodes_total": 24424, "training_iteration": 24, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-49-20", "timestamp": 1569660560, "time_this_iter_s": 30.465640544891357, "time_total_s": 733.283849477768, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f61d90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 733.283849477768, "timesteps_since_restore": 2442240, "iterations_since_restore": 24, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.98048525845091, "episode_reward_min": 46.64935885380166, "episode_reward_mean": 53.25478797961821, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.472070053896132, "agent_1": 26.7827179257222}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6807138956360456, "mean_processing_ms": 3.088539156586923, "mean_inference_ms": 1.9465884240755418}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 75, "num_steps_trained": 3768320, "num_steps_sampled": 2545664, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4970, "num_samples_dropped": 354, "learner_queue": {"size_count": 25130, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.751, "replay_time_ms": 101.226, "update_priorities_time_ms": 52.791, "policy_agent_0": {"added_count": 615936, "sampled_count": 955904, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 615936, "sampled_count": 955904, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.001867294311523, "min_q": 9.769767761230469, "max_q": 10.171823501586914, "mean_td_error": 0.03337752819061279, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.815300941467285, "min_q": 9.471053123474121, "max_q": 10.33640193939209, "mean_td_error": 0.026911400258541107, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 2545664, "episodes_total": 25456, "training_iteration": 25, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-49-51", "timestamp": 1569660591, "time_this_iter_s": 30.538002014160156, "time_total_s": 763.8218514919281, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f7c9d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 763.8218514919281, "timesteps_since_restore": 2545664, "iterations_since_restore": 25, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 56.55451012715748, "episode_reward_min": 48.223664241563775, "episode_reward_mean": 51.87426369620607, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 25.82513585762503, "agent_1": 26.049127838581118}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6806328003296601, "mean_processing_ms": 3.0876381900597543, "mean_inference_ms": 1.9458469211285605}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 78, "num_steps_trained": 3921408, "num_steps_sampled": 2649344, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5173, "num_samples_dropped": 354, "learner_queue": {"size_count": 25728, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.171, "replay_time_ms": 105.382, "update_priorities_time_ms": 51.257, "policy_agent_0": {"added_count": 644096, "sampled_count": 994304, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 644096, "sampled_count": 994304, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.071557998657227, "min_q": 9.769335746765137, "max_q": 10.176738739013672, "mean_td_error": -0.0023054778575897217, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.926902770996094, "min_q": 9.574936866760254, "max_q": 10.427687644958496, "mean_td_error": -0.01767118275165558, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 2649344, "episodes_total": 26504, "training_iteration": 26, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-50-21", "timestamp": 1569660621, "time_this_iter_s": 30.517332792282104, "time_total_s": 794.3391842842102, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ed2ea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 794.3391842842102, "timesteps_since_restore": 2649344, "iterations_since_restore": 26, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.81827106305472, "episode_reward_min": 46.59675357644559, "episode_reward_mean": 51.391352120591584, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.157887888240154, "agent_1": 25.233464232351444}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6798469813857169, "mean_processing_ms": 3.085787997122597, "mean_inference_ms": 1.9469732762956078}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 81, "num_steps_trained": 4075008, "num_steps_sampled": 2751744, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5373, "num_samples_dropped": 354, "learner_queue": {"size_count": 26329, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.822, "replay_time_ms": 97.206, "update_priorities_time_ms": 48.558, "policy_agent_0": {"added_count": 670720, "sampled_count": 1033984, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 670720, "sampled_count": 1033984, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.030289649963379, "min_q": 9.654112815856934, "max_q": 10.387591361999512, "mean_td_error": 0.017609402537345886, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.827241897583008, "min_q": 9.665574073791504, "max_q": 10.257551193237305, "mean_td_error": -0.022230669856071472, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 2751744, "episodes_total": 27528, "training_iteration": 27, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-50-52", "timestamp": 1569660652, "time_this_iter_s": 30.505226850509644, "time_total_s": 824.8444111347198, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ed8ae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 824.8444111347198, "timesteps_since_restore": 2751744, "iterations_since_restore": 27, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 56.542146271560895, "episode_reward_min": 45.460884265133416, "episode_reward_mean": 50.47710688203032, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 23.450977276470468, "agent_1": 27.02612960555988}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6788462122670904, "mean_processing_ms": 3.0832015580920595, "mean_inference_ms": 1.945431360350372}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 84, "num_steps_trained": 4226048, "num_steps_sampled": 2857216, "sample_throughput": 12614.448, "train_throughput": 0.0, "num_weight_syncs": 5580, "num_samples_dropped": 354, "learner_queue": {"size_count": 26920, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.738, "replay_time_ms": 97.994, "update_priorities_time_ms": 48.713, "policy_agent_0": {"added_count": 697344, "sampled_count": 1074432, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 697344, "sampled_count": 1074432, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.00507926940918, "min_q": 9.8331937789917, "max_q": 10.562121391296387, "mean_td_error": 0.014469064772129059, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.952484130859375, "min_q": 9.76671028137207, "max_q": 10.194546699523926, "mean_td_error": -0.03010912612080574, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 2857216, "episodes_total": 28576, "training_iteration": 28, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-51-23", "timestamp": 1569660683, "time_this_iter_s": 30.523783922195435, "time_total_s": 855.3681950569153, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5eea048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 855.3681950569153, "timesteps_since_restore": 2857216, "iterations_since_restore": 28, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.70390209975896, "episode_reward_min": 48.50401148191788, "episode_reward_mean": 53.737303850558234, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 24.874614783833874, "agent_1": 28.862689066724432}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6791002985910589, "mean_processing_ms": 3.0845782270655904, "mean_inference_ms": 1.9453931330814678}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 87, "num_steps_trained": 4379136, "num_steps_sampled": 2960640, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5781, "num_samples_dropped": 354, "learner_queue": {"size_count": 27516, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.455, "replay_time_ms": 80.971, "update_priorities_time_ms": 36.358, "policy_agent_0": {"added_count": 722944, "sampled_count": 1114368, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 722944, "sampled_count": 1114368, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.95161247253418, "min_q": 9.732794761657715, "max_q": 10.379267692565918, "mean_td_error": 0.04808633774518967, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.072385787963867, "min_q": 9.666548728942871, "max_q": 10.433174133300781, "mean_td_error": 0.03989406302571297, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 2960640, "episodes_total": 29616, "training_iteration": 29, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-51-53", "timestamp": 1569660713, "time_this_iter_s": 30.551217079162598, "time_total_s": 885.9194121360779, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5eeabf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 885.9194121360779, "timesteps_since_restore": 2960640, "iterations_since_restore": 29, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.70614852671898, "episode_reward_min": 49.304323286344946, "episode_reward_mean": 56.87044719294714, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.487134913538434, "agent_1": 29.383312279408837}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6790771927241523, "mean_processing_ms": 3.084221453197092, "mean_inference_ms": 1.9468141608397747}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 90, "num_steps_trained": 4535296, "num_steps_sampled": 3062272, "sample_throughput": 16103.631, "train_throughput": 0.0, "num_weight_syncs": 5980, "num_samples_dropped": 354, "learner_queue": {"size_count": 28126, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.695, "replay_time_ms": 118.944, "update_priorities_time_ms": 57.525, "policy_agent_0": {"added_count": 746240, "sampled_count": 1152512, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 746240, "sampled_count": 1152512, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.976552963256836, "min_q": 9.76685619354248, "max_q": 10.447652816772461, "mean_td_error": 0.029905423521995544, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.30005931854248, "min_q": 9.96951961517334, "max_q": 10.800411224365234, "mean_td_error": -0.050416648387908936, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 3062272, "episodes_total": 30632, "training_iteration": 30, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-52-24", "timestamp": 1569660744, "time_this_iter_s": 30.48230814933777, "time_total_s": 916.4017202854156, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5efe158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 916.4017202854156, "timesteps_since_restore": 3062272, "iterations_since_restore": 30, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.67751663955195, "episode_reward_min": 54.20721417332865, "episode_reward_mean": 59.261858563118736, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 29.58486942630933, "agent_1": 29.676989136809496}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6792227400818752, "mean_processing_ms": 3.0852471245138227, "mean_inference_ms": 1.9475349765565817}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 93, "num_steps_trained": 4692480, "num_steps_sampled": 3164672, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6180, "num_samples_dropped": 354, "learner_queue": {"size_count": 28741, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.716, "replay_time_ms": 111.647, "update_priorities_time_ms": 58.237, "policy_agent_0": {"added_count": 771328, "sampled_count": 1192704, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 771328, "sampled_count": 1192704, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.192888259887695, "min_q": 9.794429779052734, "max_q": 10.876704216003418, "mean_td_error": -0.027824927121400833, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.566067695617676, "min_q": 10.266595840454102, "max_q": 11.210424423217773, "mean_td_error": 0.004276663064956665, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 3164672, "episodes_total": 31648, "training_iteration": 31, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-52-54", "timestamp": 1569660774, "time_this_iter_s": 30.522874116897583, "time_total_s": 946.9245944023132, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5efed08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 946.9245944023132, "timesteps_since_restore": 3164672, "iterations_since_restore": 31, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.42443253703873, "episode_reward_min": 52.918696034492605, "episode_reward_mean": 60.72782773926542, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 28.986519104225092, "agent_1": 31.741308635040365}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6784535607129532, "mean_processing_ms": 3.0844697575268767, "mean_inference_ms": 1.948519210209341}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 96, "num_steps_trained": 4844288, "num_steps_sampled": 3266304, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6378, "num_samples_dropped": 354, "learner_queue": {"size_count": 29334, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.455, "replay_time_ms": 79.66, "update_priorities_time_ms": 38.267, "policy_agent_0": {"added_count": 798208, "sampled_count": 1231360, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 798208, "sampled_count": 1231360, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.39894962310791, "min_q": 10.075382232666016, "max_q": 11.012237548828125, "mean_td_error": 0.039278075098991394, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.971992492675781, "min_q": 10.502286911010742, "max_q": 11.286127090454102, "mean_td_error": 0.036593902856111526, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 3266304, "episodes_total": 32664, "training_iteration": 32, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-53-25", "timestamp": 1569660805, "time_this_iter_s": 30.537313222885132, "time_total_s": 977.4619076251984, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f10268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 977.4619076251984, "timesteps_since_restore": 3266304, "iterations_since_restore": 32, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.84672052535737, "episode_reward_min": 48.166573709629844, "episode_reward_mean": 59.38766413610607, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.564418138315848, "agent_1": 32.82324599779021}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6792373557834697, "mean_processing_ms": 3.0871950456646498, "mean_inference_ms": 1.9491468096924707}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 99, "num_steps_trained": 4999680, "num_steps_sampled": 3368704, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6579, "num_samples_dropped": 354, "learner_queue": {"size_count": 29940, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.36, "replay_time_ms": 114.737, "update_priorities_time_ms": 57.695, "policy_agent_0": {"added_count": 826624, "sampled_count": 1269504, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 826624, "sampled_count": 1269504, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.488286972045898, "min_q": 10.133087158203125, "max_q": 10.837076187133789, "mean_td_error": 0.0033992864191532135, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.425835609436035, "min_q": 11.091062545776367, "max_q": 11.763190269470215, "mean_td_error": 0.011691369116306305, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 3368704, "episodes_total": 33696, "training_iteration": 33, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-53-55", "timestamp": 1569660835, "time_this_iter_s": 30.565823793411255, "time_total_s": 1008.0277314186096, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f10e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1008.0277314186096, "timesteps_since_restore": 3368704, "iterations_since_restore": 33, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.00008666503063, "episode_reward_min": 45.85494520646308, "episode_reward_mean": 53.19772648606849, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.736953955849515, "agent_1": 26.460772530218993}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6785860117339237, "mean_processing_ms": 3.0869518694630464, "mean_inference_ms": 1.9495770328362818}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 102, "num_steps_trained": 5153792, "num_steps_sampled": 3471360, "sample_throughput": 0.0, "train_throughput": 18639.086, "num_weight_syncs": 6778, "num_samples_dropped": 354, "learner_queue": {"size_count": 30542, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.143, "replay_time_ms": 91.103, "update_priorities_time_ms": 42.539, "policy_agent_0": {"added_count": 851200, "sampled_count": 1308928, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 851200, "sampled_count": 1308928, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.572182655334473, "min_q": 10.124153137207031, "max_q": 10.862424850463867, "mean_td_error": 0.03494338318705559, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.476806640625, "min_q": 10.99587345123291, "max_q": 11.824024200439453, "mean_td_error": 0.03596356138586998, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 3471360, "episodes_total": 34712, "training_iteration": 34, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-54-26", "timestamp": 1569660866, "time_this_iter_s": 30.514623641967773, "time_total_s": 1038.5423550605774, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ea1378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1038.5423550605774, "timesteps_since_restore": 3471360, "iterations_since_restore": 34, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.51682196311926, "episode_reward_min": 46.21423147879216, "episode_reward_mean": 55.01243936186995, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 27.15811305243389, "agent_1": 27.85432630943612}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6775593569353379, "mean_processing_ms": 3.086347174528585, "mean_inference_ms": 1.9507861968692037}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 105, "num_steps_trained": 5305856, "num_steps_sampled": 3574272, "sample_throughput": 17253.576, "train_throughput": 17253.576, "num_weight_syncs": 6980, "num_samples_dropped": 354, "learner_queue": {"size_count": 31136, "size_mean": 0.22, "size_std": 0.4142463035441596, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.892, "replay_time_ms": 103.631, "update_priorities_time_ms": 53.227, "policy_agent_0": {"added_count": 876544, "sampled_count": 1347328, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 876544, "sampled_count": 1347328, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.52896785736084, "min_q": 10.206849098205566, "max_q": 10.694802284240723, "mean_td_error": 0.08653749525547028, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.344247817993164, "min_q": 10.827164649963379, "max_q": 11.868054389953613, "mean_td_error": -0.04380636289715767, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 3574272, "episodes_total": 35752, "training_iteration": 35, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-54-57", "timestamp": 1569660897, "time_this_iter_s": 30.637529373168945, "time_total_s": 1069.1798844337463, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ea1f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1069.1798844337463, "timesteps_since_restore": 3574272, "iterations_since_restore": 35, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.89071808905196, "episode_reward_min": 44.77129329642253, "episode_reward_mean": 51.93952105072701, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 25.4059715424671, "agent_1": 26.53354950825998}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6778866751557774, "mean_processing_ms": 3.0855828777654164, "mean_inference_ms": 1.9516440469149727}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 108, "num_steps_trained": 5457920, "num_steps_sampled": 3677440, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7181, "num_samples_dropped": 354, "learner_queue": {"size_count": 31730, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.863, "replay_time_ms": 99.126, "update_priorities_time_ms": 44.81, "policy_agent_0": {"added_count": 897280, "sampled_count": 1386496, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 897280, "sampled_count": 1386496, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.329720497131348, "min_q": 10.08279037475586, "max_q": 10.561480522155762, "mean_td_error": -0.0023906826972961426, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.09597396850586, "min_q": 10.840548515319824, "max_q": 11.471769332885742, "mean_td_error": 0.03210706263780594, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 3677440, "episodes_total": 36776, "training_iteration": 36, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-55-27", "timestamp": 1569660927, "time_this_iter_s": 30.62529945373535, "time_total_s": 1099.8051838874817, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5eb8488>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1099.8051838874817, "timesteps_since_restore": 3677440, "iterations_since_restore": 36, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 56.82612748489468, "episode_reward_min": 43.616767501711514, "episode_reward_mean": 53.3547230083407, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 25.307628882206362, "agent_1": 28.047094126134432}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6778892394146383, "mean_processing_ms": 3.0858123211358195, "mean_inference_ms": 1.9516177465886457}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 111, "num_steps_trained": 5611520, "num_steps_sampled": 3780608, "sample_throughput": 9997.131, "train_throughput": 19994.261, "num_weight_syncs": 7383, "num_samples_dropped": 354, "learner_queue": {"size_count": 32330, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 25.756, "replay_time_ms": 81.445, "update_priorities_time_ms": 50.818, "policy_agent_0": {"added_count": 922624, "sampled_count": 1425920, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 922624, "sampled_count": 1425920, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.379766464233398, "min_q": 9.936182022094727, "max_q": 10.662235260009766, "mean_td_error": -0.005235753953456879, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.060121536254883, "min_q": 10.615108489990234, "max_q": 11.441436767578125, "mean_td_error": 0.025693539530038834, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 3780608, "episodes_total": 37816, "training_iteration": 37, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-55-58", "timestamp": 1569660958, "time_this_iter_s": 30.600088119506836, "time_total_s": 1130.4052720069885, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f10400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1130.4052720069885, "timesteps_since_restore": 3780608, "iterations_since_restore": 37, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 62.552748624109476, "episode_reward_min": 49.079883827393274, "episode_reward_mean": 59.688132024370944, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 29.901578860613135, "agent_1": 29.786553163757826}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6778801116774859, "mean_processing_ms": 3.0849402458631046, "mean_inference_ms": 1.950717261771404}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 114, "num_steps_trained": 5761792, "num_steps_sampled": 3885568, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7589, "num_samples_dropped": 354, "learner_queue": {"size_count": 32917, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.249, "replay_time_ms": 103.725, "update_priorities_time_ms": 56.446, "policy_agent_0": {"added_count": 948736, "sampled_count": 1461760, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 948736, "sampled_count": 1461760, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.378654479980469, "min_q": 10.093152046203613, "max_q": 10.719498634338379, "mean_td_error": 0.05249932035803795, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.047399520874023, "min_q": 10.496307373046875, "max_q": 11.278459548950195, "mean_td_error": 0.008539430797100067, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 3885568, "episodes_total": 38856, "training_iteration": 38, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-56-28", "timestamp": 1569660988, "time_this_iter_s": 30.494080305099487, "time_total_s": 1160.899352312088, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5efeae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1160.899352312088, "timesteps_since_restore": 3885568, "iterations_since_restore": 38, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 62.368277662911744, "episode_reward_min": 49.01951812357467, "episode_reward_mean": 60.2790192638619, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 29.983464394834378, "agent_1": 30.295554869027526}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6784733546850783, "mean_processing_ms": 3.086372503263609, "mean_inference_ms": 1.9521683836302004}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 117, "num_steps_trained": 5914880, "num_steps_sampled": 3986432, "sample_throughput": 0.0, "train_throughput": 16189.341, "num_weight_syncs": 7785, "num_samples_dropped": 354, "learner_queue": {"size_count": 33515, "size_mean": 1.16, "size_std": 2.1850400453996257, "size_quantiles": [0.0, 0.0, 0.0, 5.100000000000001, 8.0]}, "replay_shard_0": {"add_batch_time_ms": 34.005, "replay_time_ms": 80.88, "update_priorities_time_ms": 43.593, "policy_agent_0": {"added_count": 974848, "sampled_count": 1501952, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 974848, "sampled_count": 1501952, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.543673515319824, "min_q": 10.057528495788574, "max_q": 10.69798755645752, "mean_td_error": 0.013267569243907928, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.140304565429688, "min_q": 10.474780082702637, "max_q": 11.269145011901855, "mean_td_error": -0.0317629836499691, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 3986432, "episodes_total": 39872, "training_iteration": 39, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-56-59", "timestamp": 1569661019, "time_this_iter_s": 30.49197554588318, "time_total_s": 1191.3913278579712, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f2db70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1191.3913278579712, "timesteps_since_restore": 3986432, "iterations_since_restore": 39, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.125897118582586, "episode_reward_min": 56.112625090207594, "episode_reward_mean": 61.70998129737736, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.76683795711976, "agent_1": 30.94314334025759}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.679459574379234, "mean_processing_ms": 3.087558868064556, "mean_inference_ms": 1.9525943455787826}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 121, "num_steps_trained": 6072832, "num_steps_sampled": 4087296, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7981, "num_samples_dropped": 354, "learner_queue": {"size_count": 34132, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.634, "replay_time_ms": 94.408, "update_priorities_time_ms": 56.214, "policy_agent_0": {"added_count": 996352, "sampled_count": 1539584, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 996352, "sampled_count": 1539584, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.733684539794922, "min_q": 10.06149959564209, "max_q": 10.827078819274902, "mean_td_error": -0.0016083605587482452, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.308511734008789, "min_q": 10.796605110168457, "max_q": 11.559124946594238, "mean_td_error": 0.013865634799003601, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 4087296, "episodes_total": 40880, "training_iteration": 40, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-57-29", "timestamp": 1569661049, "time_this_iter_s": 30.56823754310608, "time_total_s": 1221.9595654010773, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c6892e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1221.9595654010773, "timesteps_since_restore": 4087296, "iterations_since_restore": 40, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 62.972517004741356, "episode_reward_min": 52.01909437182675, "episode_reward_mean": 58.84966511629584, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 28.134417507914293, "agent_1": 30.71524760838153}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6791896936871183, "mean_processing_ms": 3.0869661044139116, "mean_inference_ms": 1.951529800157915}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 124, "num_steps_trained": 6224128, "num_steps_sampled": 4189952, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8183, "num_samples_dropped": 354, "learner_queue": {"size_count": 34723, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 25.229, "replay_time_ms": 106.891, "update_priorities_time_ms": 49.254, "policy_agent_0": {"added_count": 1021952, "sampled_count": 1577216, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1021952, "sampled_count": 1577216, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.826136589050293, "min_q": 10.554217338562012, "max_q": 10.95657730102539, "mean_td_error": 0.02434384450316429, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.457987785339355, "min_q": 11.044403076171875, "max_q": 11.616969108581543, "mean_td_error": 0.013315152376890182, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 4189952, "episodes_total": 41904, "training_iteration": 41, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-58-00", "timestamp": 1569661080, "time_this_iter_s": 30.570828676223755, "time_total_s": 1252.530394077301, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f416a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1252.530394077301, "timesteps_since_restore": 4189952, "iterations_since_restore": 41, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 66.04280914036218, "episode_reward_min": 49.78543802544854, "episode_reward_mean": 60.26356229118549, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 29.73292879465151, "agent_1": 30.53063349653398}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6803323763070002, "mean_processing_ms": 3.0896503550445233, "mean_inference_ms": 1.9500604073405117}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 127, "num_steps_trained": 6376192, "num_steps_sampled": 4293888, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8385, "num_samples_dropped": 354, "learner_queue": {"size_count": 35318, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.978, "replay_time_ms": 106.915, "update_priorities_time_ms": 53.899, "policy_agent_0": {"added_count": 1045760, "sampled_count": 1615616, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1045760, "sampled_count": 1615616, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.030299186706543, "min_q": 10.76613712310791, "max_q": 11.17188835144043, "mean_td_error": 0.06319855153560638, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.473487854003906, "min_q": 11.099167823791504, "max_q": 11.813393592834473, "mean_td_error": 0.008931424468755722, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 4293888, "episodes_total": 42944, "training_iteration": 42, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-58-31", "timestamp": 1569661111, "time_this_iter_s": 30.56358003616333, "time_total_s": 1283.0939741134644, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f22510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1283.0939741134644, "timesteps_since_restore": 4293888, "iterations_since_restore": 42, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 66.05346060047377, "episode_reward_min": 45.98084844655327, "episode_reward_mean": 60.66194255692593, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 30.313970708344975, "agent_1": 30.34797184858095}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6798715351330569, "mean_processing_ms": 3.0864213199619797, "mean_inference_ms": 1.9488093206311219}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 130, "num_steps_trained": 6525696, "num_steps_sampled": 4398592, "sample_throughput": 9522.365, "train_throughput": 0.0, "num_weight_syncs": 8590, "num_samples_dropped": 354, "learner_queue": {"size_count": 35901, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.17, "replay_time_ms": 108.55, "update_priorities_time_ms": 50.316, "policy_agent_0": {"added_count": 1073664, "sampled_count": 1652224, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1073664, "sampled_count": 1652224, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.044440269470215, "min_q": 10.75523853302002, "max_q": 11.360397338867188, "mean_td_error": -0.026488862931728363, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.478569030761719, "min_q": 10.935347557067871, "max_q": 11.792888641357422, "mean_td_error": 0.002480093389749527, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 4398592, "episodes_total": 43992, "training_iteration": 43, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-59-01", "timestamp": 1569661141, "time_this_iter_s": 30.541139602661133, "time_total_s": 1313.6351137161255, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f22d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1313.6351137161255, "timesteps_since_restore": 4398592, "iterations_since_restore": 43, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.97799185988303, "episode_reward_min": 50.34626062494448, "episode_reward_mean": 61.387664620130295, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 32.51414614355132, "agent_1": 28.873518476578866}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6788394990098972, "mean_processing_ms": 3.0844924046622118, "mean_inference_ms": 1.947926337023736}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 132, "num_steps_trained": 6674432, "num_steps_sampled": 4504064, "sample_throughput": 8331.039, "train_throughput": 0.0, "num_weight_syncs": 8797, "num_samples_dropped": 354, "learner_queue": {"size_count": 36482, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.744, "replay_time_ms": 101.644, "update_priorities_time_ms": 51.936, "policy_agent_0": {"added_count": 1102080, "sampled_count": 1687552, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1102080, "sampled_count": 1687552, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.141876220703125, "min_q": 10.844002723693848, "max_q": 11.476141929626465, "mean_td_error": 0.025080036371946335, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.567975997924805, "min_q": 11.009864807128906, "max_q": 11.951780319213867, "mean_td_error": 0.07368206977844238, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 4504064, "episodes_total": 45048, "training_iteration": 44, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_08-59-32", "timestamp": 1569661172, "time_this_iter_s": 30.48534107208252, "time_total_s": 1344.120454788208, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5eb8e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1344.120454788208, "timesteps_since_restore": 4504064, "iterations_since_restore": 44, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.54520250788129, "episode_reward_min": 54.61670152797311, "episode_reward_mean": 61.86952621513661, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 33.83730033496332, "agent_1": 28.032225880173193}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6791231477323548, "mean_processing_ms": 3.0859438332636637, "mean_inference_ms": 1.9480024728973127}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 136, "num_steps_trained": 6827008, "num_steps_sampled": 4606464, "sample_throughput": 0.0, "train_throughput": 4991.246, "num_weight_syncs": 8995, "num_samples_dropped": 354, "learner_queue": {"size_count": 37080, "size_mean": 0.3, "size_std": 0.5385164807134504, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.692, "replay_time_ms": 81.112, "update_priorities_time_ms": 47.498, "policy_agent_0": {"added_count": 1127168, "sampled_count": 1728000, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1127168, "sampled_count": 1728000, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.47730827331543, "min_q": 11.20494270324707, "max_q": 11.74113655090332, "mean_td_error": -0.03040093556046486, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.530040740966797, "min_q": 10.950130462646484, "max_q": 11.871831893920898, "mean_td_error": 0.07220910489559174, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 4606464, "episodes_total": 46072, "training_iteration": 45, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-00-02", "timestamp": 1569661202, "time_this_iter_s": 30.58609914779663, "time_total_s": 1374.7065539360046, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c67eba60>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1374.7065539360046, "timesteps_since_restore": 4606464, "iterations_since_restore": 45, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.43182156741193, "episode_reward_min": 50.38997972014007, "episode_reward_mean": 57.75040772768908, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 30.824331683079894, "agent_1": 26.926076044609207}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6791414901018293, "mean_processing_ms": 3.088439004208217, "mean_inference_ms": 1.9523243419063525}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 138, "num_steps_trained": 6968320, "num_steps_sampled": 4704256, "sample_throughput": 20230.651, "train_throughput": 0.0, "num_weight_syncs": 9187, "num_samples_dropped": 354, "learner_queue": {"size_count": 37630, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.404, "replay_time_ms": 102.911, "update_priorities_time_ms": 59.687, "policy_agent_0": {"added_count": 1154816, "sampled_count": 1761792, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1154816, "sampled_count": 1761792, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.670372009277344, "min_q": 11.295522689819336, "max_q": 11.958182334899902, "mean_td_error": 0.0047441087663173676, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.32583236694336, "min_q": 11.073638916015625, "max_q": 11.679664611816406, "mean_td_error": -0.006428968161344528, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 4704256, "episodes_total": 47056, "training_iteration": 46, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-00-33", "timestamp": 1569661233, "time_this_iter_s": 30.482783317565918, "time_total_s": 1405.1893372535706, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f50f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1405.1893372535706, "timesteps_since_restore": 4704256, "iterations_since_restore": 46, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.94958152181198, "episode_reward_min": 45.18420084243087, "episode_reward_mean": 57.92957559700979, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 31.334019615871814, "agent_1": 26.595555981137974}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6788938117013791, "mean_processing_ms": 3.0864392361616577, "mean_inference_ms": 1.9513740833376318}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 141, "num_steps_trained": 7121408, "num_steps_sampled": 4808448, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9390, "num_samples_dropped": 354, "learner_queue": {"size_count": 38228, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.909, "replay_time_ms": 105.429, "update_priorities_time_ms": 57.636, "policy_agent_0": {"added_count": 1179648, "sampled_count": 1800704, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1179648, "sampled_count": 1800704, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.768427848815918, "min_q": 11.411734580993652, "max_q": 12.080426216125488, "mean_td_error": 0.027959227561950684, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.178815841674805, "min_q": 10.868330001831055, "max_q": 11.335567474365234, "mean_td_error": 0.052224788814783096, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 4808448, "episodes_total": 48096, "training_iteration": 47, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-01-04", "timestamp": 1569661264, "time_this_iter_s": 30.58332920074463, "time_total_s": 1435.7726664543152, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f9fb70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1435.7726664543152, "timesteps_since_restore": 4808448, "iterations_since_restore": 47, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 66.79502022827057, "episode_reward_min": 48.35252862572606, "episode_reward_mean": 60.208486773315286, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 31.634488636658816, "agent_1": 28.573998136656378}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6787891688214738, "mean_processing_ms": 3.087222410993141, "mean_inference_ms": 1.9511152925492532}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 144, "num_steps_trained": 7273216, "num_steps_sampled": 4910336, "sample_throughput": 7535.083, "train_throughput": 0.0, "num_weight_syncs": 9590, "num_samples_dropped": 354, "learner_queue": {"size_count": 38821, "size_mean": 0.14, "size_std": 0.4476605857119878, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.169, "replay_time_ms": 86.937, "update_priorities_time_ms": 39.965, "policy_agent_0": {"added_count": 1204224, "sampled_count": 1838592, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1204224, "sampled_count": 1838592, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.726585388183594, "min_q": 11.342487335205078, "max_q": 11.977938652038574, "mean_td_error": 0.06630772352218628, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.019743919372559, "min_q": 10.307909965515137, "max_q": 11.156332969665527, "mean_td_error": 0.03192417696118355, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 4910336, "episodes_total": 49112, "training_iteration": 48, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-01-34", "timestamp": 1569661294, "time_this_iter_s": 30.527302980422974, "time_total_s": 1466.2999694347382, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f6f0d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1466.2999694347382, "timesteps_since_restore": 4910336, "iterations_since_restore": 48, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 65.40729644389806, "episode_reward_min": 46.94096767917716, "episode_reward_mean": 56.91855236618802, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.150393059682706, "agent_1": 26.76815930650529}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.679759176719311, "mean_processing_ms": 3.0893150930664914, "mean_inference_ms": 1.9522017368280133}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 148, "num_steps_trained": 7431424, "num_steps_sampled": 5011200, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9787, "num_samples_dropped": 354, "learner_queue": {"size_count": 39439, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.446, "replay_time_ms": 105.912, "update_priorities_time_ms": 50.215, "policy_agent_0": {"added_count": 1229568, "sampled_count": 1876736, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1229568, "sampled_count": 1876736, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.721481323242188, "min_q": 11.370455741882324, "max_q": 11.932480812072754, "mean_td_error": -0.0057874396443367004, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.878620147705078, "min_q": 10.362037658691406, "max_q": 11.427267074584961, "mean_td_error": 0.003056161105632782, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 5011200, "episodes_total": 50120, "training_iteration": 49, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-02-05", "timestamp": 1569661325, "time_this_iter_s": 30.543739795684814, "time_total_s": 1496.843709230423, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f6fc80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1496.843709230423, "timesteps_since_restore": 5011200, "iterations_since_restore": 49, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 65.10128204022796, "episode_reward_min": 47.62008495069741, "episode_reward_mean": 58.516136139654535, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 30.218903204182503, "agent_1": 28.29723293547198}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6799268274346969, "mean_processing_ms": 3.089404835528149, "mean_inference_ms": 1.9531444065586387}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 151, "num_steps_trained": 7585024, "num_steps_sampled": 5114368, "sample_throughput": 0.0, "train_throughput": 13463.341, "num_weight_syncs": 9987, "num_samples_dropped": 354, "learner_queue": {"size_count": 40039, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.706, "replay_time_ms": 90.19, "update_priorities_time_ms": 50.068, "policy_agent_0": {"added_count": 1258496, "sampled_count": 1914880, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1258496, "sampled_count": 1914880, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.734262466430664, "min_q": 11.404220581054688, "max_q": 12.087201118469238, "mean_td_error": 0.022165153175592422, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.925230026245117, "min_q": 10.508096694946289, "max_q": 11.398613929748535, "mean_td_error": 0.0755743458867073, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 5114368, "episodes_total": 51152, "training_iteration": 50, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-02-35", "timestamp": 1569661355, "time_this_iter_s": 30.56395411491394, "time_total_s": 1527.407663345337, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f841e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1527.407663345337, "timesteps_since_restore": 5114368, "iterations_since_restore": 50, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 65.55627183290859, "episode_reward_min": 50.058322703989035, "episode_reward_mean": 62.329538041183966, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 29.995204273595885, "agent_1": 32.33433376758815}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6787423065015904, "mean_processing_ms": 3.0859578240673238, "mean_inference_ms": 1.951855554600577}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 154, "num_steps_trained": 7735040, "num_steps_sampled": 5217536, "sample_throughput": 0.0, "train_throughput": 23507.79, "num_weight_syncs": 10189, "num_samples_dropped": 354, "learner_queue": {"size_count": 40625, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.558, "replay_time_ms": 104.265, "update_priorities_time_ms": 52.578, "policy_agent_0": {"added_count": 1284864, "sampled_count": 1952512, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1284864, "sampled_count": 1952512, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.727913856506348, "min_q": 10.95767593383789, "max_q": 12.207408905029297, "mean_td_error": 0.04937421530485153, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.026491165161133, "min_q": 10.392247200012207, "max_q": 11.611452102661133, "mean_td_error": -0.04159892722964287, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 5217536, "episodes_total": 52176, "training_iteration": 51, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-03-06", "timestamp": 1569661386, "time_this_iter_s": 30.62197780609131, "time_total_s": 1558.0296411514282, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f84d90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1558.0296411514282, "timesteps_since_restore": 5217536, "iterations_since_restore": 51, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.42614333378987, "episode_reward_min": 48.739821928503524, "episode_reward_mean": 60.23442327312689, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 28.66889132705558, "agent_1": 31.565531946071346}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6800156256582528, "mean_processing_ms": 3.0903545556262944, "mean_inference_ms": 1.951487773799788}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 157, "num_steps_trained": 7889920, "num_steps_sampled": 5319936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10389, "num_samples_dropped": 354, "learner_queue": {"size_count": 41230, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.966, "replay_time_ms": 87.084, "update_priorities_time_ms": 42.414, "policy_agent_0": {"added_count": 1313280, "sampled_count": 1992448, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1313280, "sampled_count": 1992448, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.619584083557129, "min_q": 10.954012870788574, "max_q": 11.81208324432373, "mean_td_error": 9.92901623249054e-05, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.501848220825195, "min_q": 10.903990745544434, "max_q": 11.729310035705566, "mean_td_error": 0.012924112379550934, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 5319936, "episodes_total": 53200, "training_iteration": 52, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-03-37", "timestamp": 1569661417, "time_this_iter_s": 30.59477162361145, "time_total_s": 1588.6244127750397, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f022f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1588.6244127750397, "timesteps_since_restore": 5319936, "iterations_since_restore": 52, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.265574249632834, "episode_reward_min": 49.339582775242555, "episode_reward_mean": 60.41601866858719, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 29.660766384377915, "agent_1": 30.755252284209323}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6798843940848932, "mean_processing_ms": 3.090018303976835, "mean_inference_ms": 1.952240767609372}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 160, "num_steps_trained": 8043776, "num_steps_sampled": 5422848, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10590, "num_samples_dropped": 354, "learner_queue": {"size_count": 41831, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.582, "replay_time_ms": 100.933, "update_priorities_time_ms": 51.826, "policy_agent_0": {"added_count": 1336320, "sampled_count": 2033152, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1336320, "sampled_count": 2033152, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.583566665649414, "min_q": 11.037129402160645, "max_q": 11.794232368469238, "mean_td_error": -0.023097548633813858, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.52186107635498, "min_q": 11.249113082885742, "max_q": 12.035053253173828, "mean_td_error": -0.025520388036966324, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 5422848, "episodes_total": 54232, "training_iteration": 53, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-04-07", "timestamp": 1569661447, "time_this_iter_s": 30.513086557388306, "time_total_s": 1619.137499332428, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f02ea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1619.137499332428, "timesteps_since_restore": 5422848, "iterations_since_restore": 53, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.94220393342003, "episode_reward_min": 51.96039279718876, "episode_reward_mean": 58.44130915330993, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 27.644862045769795, "agent_1": 30.79644710754019}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6799308529129415, "mean_processing_ms": 3.089309065691388, "mean_inference_ms": 1.9514295296938033}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 163, "num_steps_trained": 8195840, "num_steps_sampled": 5526272, "sample_throughput": 0.0, "train_throughput": 23239.153, "num_weight_syncs": 10793, "num_samples_dropped": 354, "learner_queue": {"size_count": 42425, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.754, "replay_time_ms": 100.195, "update_priorities_time_ms": 47.923, "policy_agent_0": {"added_count": 1360384, "sampled_count": 2072832, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1360384, "sampled_count": 2072832, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.466435432434082, "min_q": 11.085765838623047, "max_q": 11.917954444885254, "mean_td_error": -0.0044990405440330505, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.61207389831543, "min_q": 11.375125885009766, "max_q": 11.855122566223145, "mean_td_error": 0.022645648568868637, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 5526272, "episodes_total": 55264, "training_iteration": 54, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-04-38", "timestamp": 1569661478, "time_this_iter_s": 30.459707736968994, "time_total_s": 1649.597207069397, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e98400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1649.597207069397, "timesteps_since_restore": 5526272, "iterations_since_restore": 54, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 60.37273731789336, "episode_reward_min": 52.57860448946218, "episode_reward_mean": 56.87972510943362, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 30.140105496578457, "agent_1": 26.739619612855236}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6802459786722603, "mean_processing_ms": 3.0884032645034254, "mean_inference_ms": 1.9503093850296718}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 166, "num_steps_trained": 8343040, "num_steps_sampled": 5630208, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10996, "num_samples_dropped": 354, "learner_queue": {"size_count": 43000, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.026, "replay_time_ms": 92.263, "update_priorities_time_ms": 41.073, "policy_agent_0": {"added_count": 1385472, "sampled_count": 2110464, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1385472, "sampled_count": 2110464, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.447042465209961, "min_q": 11.172392845153809, "max_q": 11.88718032836914, "mean_td_error": -0.005196735262870789, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.512042045593262, "min_q": 11.114595413208008, "max_q": 11.831300735473633, "mean_td_error": 0.01733163371682167, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 5630208, "episodes_total": 56304, "training_iteration": 55, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-05-08", "timestamp": 1569661508, "time_this_iter_s": 30.460424184799194, "time_total_s": 1680.0576312541962, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ec2048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1680.0576312541962, "timesteps_since_restore": 5630208, "iterations_since_restore": 55, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 56.77331084862202, "episode_reward_min": 50.75456817855634, "episode_reward_mean": 54.4436255628599, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 28.684047796323494, "agent_1": 25.75957776653642}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6801611680599838, "mean_processing_ms": 3.0884442758767863, "mean_inference_ms": 1.9497110251277907}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 169, "num_steps_trained": 8492032, "num_steps_sampled": 5734400, "sample_throughput": 0.0, "train_throughput": 21819.586, "num_weight_syncs": 11198, "num_samples_dropped": 354, "learner_queue": {"size_count": 43582, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.549, "replay_time_ms": 112.517, "update_priorities_time_ms": 56.895, "policy_agent_0": {"added_count": 1415424, "sampled_count": 2147072, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1415424, "sampled_count": 2147072, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.491005897521973, "min_q": 11.264302253723145, "max_q": 11.980281829833984, "mean_td_error": 0.040644776076078415, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.24581241607666, "min_q": 10.851855278015137, "max_q": 11.793475151062012, "mean_td_error": 0.008349206298589706, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 5734400, "episodes_total": 57352, "training_iteration": 56, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-05-39", "timestamp": 1569661539, "time_this_iter_s": 30.521522045135498, "time_total_s": 1710.5791532993317, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ec5510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1710.5791532993317, "timesteps_since_restore": 5734400, "iterations_since_restore": 56, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 59.166100657680836, "episode_reward_min": 46.92084643382044, "episode_reward_mean": 51.728105614661054, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 25.073045527317994, "agent_1": 26.655060087343124}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6798835184659741, "mean_processing_ms": 3.0861737271706473, "mean_inference_ms": 1.9485612696012529}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 172, "num_steps_trained": 8642304, "num_steps_sampled": 5840384, "sample_throughput": 8466.259, "train_throughput": 0.0, "num_weight_syncs": 11406, "num_samples_dropped": 354, "learner_queue": {"size_count": 44170, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.517, "replay_time_ms": 107.686, "update_priorities_time_ms": 54.135, "policy_agent_0": {"added_count": 1441280, "sampled_count": 2184192, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1441280, "sampled_count": 2184192, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.265880584716797, "min_q": 10.784210205078125, "max_q": 12.010051727294922, "mean_td_error": 0.052981503307819366, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.973165512084961, "min_q": 10.550064086914062, "max_q": 11.725371360778809, "mean_td_error": -0.01588035374879837, "model": {}}}}, "timesteps_this_iter": 105984, "done": false, "timesteps_total": 5840384, "episodes_total": 58408, "training_iteration": 57, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-06-09", "timestamp": 1569661569, "time_this_iter_s": 30.589885711669922, "time_total_s": 1741.1690390110016, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e59158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1741.1690390110016, "timesteps_since_restore": 5840384, "iterations_since_restore": 57, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 59.992350559902874, "episode_reward_min": 47.86132303755616, "episode_reward_mean": 52.711338648157565, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 25.084952631953485, "agent_1": 27.626386016204144}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6799079324358709, "mean_processing_ms": 3.0856582974147693, "mean_inference_ms": 1.9480053855584951}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 175, "num_steps_trained": 8795392, "num_steps_sampled": 5943296, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11607, "num_samples_dropped": 354, "learner_queue": {"size_count": 44767, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.692, "replay_time_ms": 105.112, "update_priorities_time_ms": 53.57, "policy_agent_0": {"added_count": 1465600, "sampled_count": 2223104, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1465600, "sampled_count": 2223104, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.797670364379883, "min_q": 10.365082740783691, "max_q": 11.377145767211914, "mean_td_error": -0.07201750576496124, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.739116668701172, "min_q": 10.54443359375, "max_q": 11.451508522033691, "mean_td_error": -0.0015667229890823364, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 5943296, "episodes_total": 59440, "training_iteration": 58, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-06-40", "timestamp": 1569661600, "time_this_iter_s": 30.44697880744934, "time_total_s": 1771.616017818451, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e5c620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1771.616017818451, "timesteps_since_restore": 5943296, "iterations_since_restore": 58, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 59.98677134033702, "episode_reward_min": 53.79508282547957, "episode_reward_mean": 56.83370770030929, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.352840019228786, "agent_1": 29.480867681080536}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811106335666278, "mean_processing_ms": 3.0897556538297417, "mean_inference_ms": 1.948836867897034}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 178, "num_steps_trained": 8947456, "num_steps_sampled": 6045696, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11807, "num_samples_dropped": 354, "learner_queue": {"size_count": 45362, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.498, "replay_time_ms": 94.836, "update_priorities_time_ms": 46.939, "policy_agent_0": {"added_count": 1488128, "sampled_count": 2261760, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1488128, "sampled_count": 2261760, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.737008094787598, "min_q": 10.404035568237305, "max_q": 11.031085968017578, "mean_td_error": 0.011603236198425293, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.087885856628418, "min_q": 10.772761344909668, "max_q": 11.618945121765137, "mean_td_error": 0.08315806090831757, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 6045696, "episodes_total": 60456, "training_iteration": 59, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-07-10", "timestamp": 1569661630, "time_this_iter_s": 30.477023124694824, "time_total_s": 1802.0930409431458, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e6a268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1802.0930409431458, "timesteps_since_restore": 6045696, "iterations_since_restore": 59, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 60.37917412930209, "episode_reward_min": 51.88665207314251, "episode_reward_mean": 58.056988015901545, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 28.17124588846699, "agent_1": 29.885742127434625}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6808840876511708, "mean_processing_ms": 3.0881578776397296, "mean_inference_ms": 1.9487076757075537}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 181, "num_steps_trained": 9099264, "num_steps_sampled": 6147840, "sample_throughput": 0.0, "train_throughput": 19995.378, "num_weight_syncs": 12007, "num_samples_dropped": 354, "learner_queue": {"size_count": 45954, "size_mean": 0.22, "size_std": 0.54, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.914, "replay_time_ms": 85.396, "update_priorities_time_ms": 50.316, "policy_agent_0": {"added_count": 1511936, "sampled_count": 2301696, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1511936, "sampled_count": 2301696, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.698999404907227, "min_q": 10.463428497314453, "max_q": 10.885746002197266, "mean_td_error": 0.010954339057207108, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.212926864624023, "min_q": 10.84376049041748, "max_q": 11.48028564453125, "mean_td_error": -0.016485415399074554, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 6147840, "episodes_total": 61480, "training_iteration": 60, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-07-41", "timestamp": 1569661661, "time_this_iter_s": 30.51400852203369, "time_total_s": 1832.6070494651794, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e71730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1832.6070494651794, "timesteps_since_restore": 6147840, "iterations_since_restore": 60, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 60.35619450650193, "episode_reward_min": 55.60250880188698, "episode_reward_mean": 58.58067941401458, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 28.24889598928534, "agent_1": 30.33178342472935}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6807811600842344, "mean_processing_ms": 3.086754835621217, "mean_inference_ms": 1.947731538324922}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 184, "num_steps_trained": 9248512, "num_steps_sampled": 6252032, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12211, "num_samples_dropped": 354, "learner_queue": {"size_count": 46537, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.776, "replay_time_ms": 78.127, "update_priorities_time_ms": 47.678, "policy_agent_0": {"added_count": 1536768, "sampled_count": 2340864, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1536768, "sampled_count": 2340864, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.726259231567383, "min_q": 10.495868682861328, "max_q": 10.898831367492676, "mean_td_error": 0.05470415577292442, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.324369430541992, "min_q": 11.068336486816406, "max_q": 11.50809097290039, "mean_td_error": 0.030332207679748535, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 6252032, "episodes_total": 62520, "training_iteration": 61, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-08-11", "timestamp": 1569661691, "time_this_iter_s": 30.498138189315796, "time_total_s": 1863.1051876544952, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ec56a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1863.1051876544952, "timesteps_since_restore": 6252032, "iterations_since_restore": 61, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 59.62740148052729, "episode_reward_min": 46.82029608957588, "episode_reward_mean": 54.32536771045516, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 26.12332949946559, "agent_1": 28.202038210989603}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6810521678765843, "mean_processing_ms": 3.0868335092381076, "mean_inference_ms": 1.946996608050888}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 187, "num_steps_trained": 9398528, "num_steps_sampled": 6356224, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12413, "num_samples_dropped": 354, "learner_queue": {"size_count": 47123, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.427, "replay_time_ms": 101.194, "update_priorities_time_ms": 47.891, "policy_agent_0": {"added_count": 1559808, "sampled_count": 2378496, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1559808, "sampled_count": 2378496, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.645079612731934, "min_q": 10.397810935974121, "max_q": 10.878266334533691, "mean_td_error": 0.04351046308875084, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.289278984069824, "min_q": 10.867105484008789, "max_q": 11.407342910766602, "mean_td_error": 0.05361878126859665, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 6356224, "episodes_total": 63568, "training_iteration": 62, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-08-42", "timestamp": 1569661722, "time_this_iter_s": 30.574960231781006, "time_total_s": 1893.6801478862762, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5eb86a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1893.6801478862762, "timesteps_since_restore": 6356224, "iterations_since_restore": 62, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.24353599209297, "episode_reward_min": 46.32937740258442, "episode_reward_mean": 50.74992998245422, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.41664828302155, "agent_1": 24.33328169943266}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6822998714743512, "mean_processing_ms": 3.0897666318436556, "mean_inference_ms": 1.947277133186836}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 190, "num_steps_trained": 9550336, "num_steps_sampled": 6457856, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12612, "num_samples_dropped": 354, "learner_queue": {"size_count": 47717, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.231, "replay_time_ms": 96.108, "update_priorities_time_ms": 49.694, "policy_agent_0": {"added_count": 1585408, "sampled_count": 2414848, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1585408, "sampled_count": 2414848, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.589492797851562, "min_q": 10.321296691894531, "max_q": 10.851200103759766, "mean_td_error": 0.0019645914435386658, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.08083724975586, "min_q": 10.571817398071289, "max_q": 11.365127563476562, "mean_td_error": -0.002041831612586975, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 6457856, "episodes_total": 64584, "training_iteration": 63, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-09-13", "timestamp": 1569661753, "time_this_iter_s": 30.584094047546387, "time_total_s": 1924.2642419338226, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f316a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1924.2642419338226, "timesteps_since_restore": 6457856, "iterations_since_restore": 63, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 60.65058274990305, "episode_reward_min": 47.62402593423853, "episode_reward_mean": 53.91917429499587, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.298383658010174, "agent_1": 27.620790636985667}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6824664099518906, "mean_processing_ms": 3.089538685112862, "mean_inference_ms": 1.946034600346657}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 193, "num_steps_trained": 9698304, "num_steps_sampled": 6561024, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12813, "num_samples_dropped": 354, "learner_queue": {"size_count": 48295, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.146, "replay_time_ms": 111.062, "update_priorities_time_ms": 57.01, "policy_agent_0": {"added_count": 1614336, "sampled_count": 2449664, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1614336, "sampled_count": 2449664, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.399754524230957, "min_q": 10.231864929199219, "max_q": 10.545967102050781, "mean_td_error": -0.04049890115857124, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.844090461730957, "min_q": 10.348380088806152, "max_q": 11.338566780090332, "mean_td_error": 0.012448053807020187, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 6561024, "episodes_total": 65608, "training_iteration": 64, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-09-43", "timestamp": 1569661783, "time_this_iter_s": 30.60643196105957, "time_total_s": 1954.8706738948822, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f14bf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1954.8706738948822, "timesteps_since_restore": 6561024, "iterations_since_restore": 64, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.78580280936641, "episode_reward_min": 43.99105730010064, "episode_reward_mean": 48.79727473410718, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 21.634791727406004, "agent_1": 27.162483006701237}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6823740931770689, "mean_processing_ms": 3.088876257541349, "mean_inference_ms": 1.9454434461600172}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 196, "num_steps_trained": 9847808, "num_steps_sampled": 6664704, "sample_throughput": 0.0, "train_throughput": 21703.154, "num_weight_syncs": 13015, "num_samples_dropped": 354, "learner_queue": {"size_count": 48878, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.688, "replay_time_ms": 93.015, "update_priorities_time_ms": 48.633, "policy_agent_0": {"added_count": 1640448, "sampled_count": 2488064, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1640448, "sampled_count": 2488064, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.203401565551758, "min_q": 9.718409538269043, "max_q": 10.395217895507812, "mean_td_error": 0.0006166957318782806, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.819990158081055, "min_q": 10.491375923156738, "max_q": 11.072315216064453, "mean_td_error": 0.04802357032895088, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 6664704, "episodes_total": 66648, "training_iteration": 65, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-10-14", "timestamp": 1569661814, "time_this_iter_s": 30.56855821609497, "time_total_s": 1985.4392321109772, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c6809d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1985.4392321109772, "timesteps_since_restore": 6664704, "iterations_since_restore": 65, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.91254786759471, "episode_reward_min": 46.24261332435698, "episode_reward_mean": 55.06156511327604, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 25.461992484276262, "agent_1": 29.599572628999873}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6823794749697959, "mean_processing_ms": 3.089062418211329, "mean_inference_ms": 1.9455214673261243}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 199, "num_steps_trained": 9999360, "num_steps_sampled": 6768640, "sample_throughput": 17722.094, "train_throughput": 15506.833, "num_weight_syncs": 13218, "num_samples_dropped": 354, "learner_queue": {"size_count": 49473, "size_mean": 0.86, "size_std": 1.8762729012593025, "size_quantiles": [0.0, 0.0, 0.0, 3.1000000000000014, 8.0]}, "replay_shard_0": {"add_batch_time_ms": 33.061, "replay_time_ms": 92.108, "update_priorities_time_ms": 44.198, "policy_agent_0": {"added_count": 1669120, "sampled_count": 2529280, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1669120, "sampled_count": 2529280, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.087915420532227, "min_q": 9.722155570983887, "max_q": 10.245550155639648, "mean_td_error": 0.021001920104026794, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.811056137084961, "min_q": 10.470105171203613, "max_q": 11.003722190856934, "mean_td_error": 0.003616783767938614, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 6768640, "episodes_total": 67696, "training_iteration": 66, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-10-44", "timestamp": 1569661844, "time_this_iter_s": 30.611128568649292, "time_total_s": 2016.0503606796265, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f517b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2016.0503606796265, "timesteps_since_restore": 6768640, "iterations_since_restore": 66, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 61.06106442138034, "episode_reward_min": 46.49216539632243, "episode_reward_mean": 57.59002251796022, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.848576648043622, "agent_1": 31.74144586991662}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6831376919965266, "mean_processing_ms": 3.0905842203369573, "mean_inference_ms": 1.9459190694027533}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 202, "num_steps_trained": 10153728, "num_steps_sampled": 6869248, "sample_throughput": 39390.36, "train_throughput": 0.0, "num_weight_syncs": 13415, "num_samples_dropped": 354, "learner_queue": {"size_count": 50073, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.134, "replay_time_ms": 117.555, "update_priorities_time_ms": 67.789, "policy_agent_0": {"added_count": 1695488, "sampled_count": 2566144, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1695488, "sampled_count": 2566144, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.069854736328125, "min_q": 9.828445434570312, "max_q": 10.225564002990723, "mean_td_error": 0.020566441118717194, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.968013763427734, "min_q": 10.378375053405762, "max_q": 11.411602973937988, "mean_td_error": -0.008124180138111115, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 6869248, "episodes_total": 68696, "training_iteration": 67, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-11-15", "timestamp": 1569661875, "time_this_iter_s": 30.666691541671753, "time_total_s": 2046.7170522212982, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5efe048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2046.7170522212982, "timesteps_since_restore": 6869248, "iterations_since_restore": 67, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 60.07555226519532, "episode_reward_min": 50.49549020642663, "episode_reward_mean": 54.30539947045979, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 27.758760828197726, "agent_1": 26.546638642262085}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6833874853273423, "mean_processing_ms": 3.0902549764867357, "mean_inference_ms": 1.9458848092063992}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 205, "num_steps_trained": 10304512, "num_steps_sampled": 6973184, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13618, "num_samples_dropped": 354, "learner_queue": {"size_count": 50663, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.115, "replay_time_ms": 96.535, "update_priorities_time_ms": 58.437, "policy_agent_0": {"added_count": 1720064, "sampled_count": 2605568, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1720064, "sampled_count": 2605568, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.135885238647461, "min_q": 9.889998435974121, "max_q": 10.390460968017578, "mean_td_error": -0.0013144835829734802, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.956701278686523, "min_q": 10.208306312561035, "max_q": 11.649144172668457, "mean_td_error": -0.02122507616877556, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 6973184, "episodes_total": 69736, "training_iteration": 68, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-11-46", "timestamp": 1569661906, "time_this_iter_s": 30.575625896453857, "time_total_s": 2077.292678117752, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f09840>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2077.292678117752, "timesteps_since_restore": 6973184, "iterations_since_restore": 68, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 53.68988203032739, "episode_reward_min": 49.657617073532215, "episode_reward_mean": 51.204033812459606, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.99845649502935, "agent_1": 24.205577317430276}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.683319526534663, "mean_processing_ms": 3.0903003935528695, "mean_inference_ms": 1.9459102916809725}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 208, "num_steps_trained": 10457600, "num_steps_sampled": 7076864, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13821, "num_samples_dropped": 354, "learner_queue": {"size_count": 51260, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.676, "replay_time_ms": 124.094, "update_priorities_time_ms": 50.356, "policy_agent_0": {"added_count": 1744896, "sampled_count": 2642432, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1744896, "sampled_count": 2642432, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.248748779296875, "min_q": 10.131241798400879, "max_q": 10.417045593261719, "mean_td_error": 0.039379917085170746, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.905149459838867, "min_q": 10.339689254760742, "max_q": 11.777009963989258, "mean_td_error": 0.027006100863218307, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 7076864, "episodes_total": 70768, "training_iteration": 69, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-12-16", "timestamp": 1569661936, "time_this_iter_s": 30.578332901000977, "time_total_s": 2107.871011018753, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f108c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2107.871011018753, "timesteps_since_restore": 7076864, "iterations_since_restore": 69, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.89447299521598, "episode_reward_min": 45.79417603045213, "episode_reward_mean": 54.29534580081481, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 29.602368784040376, "agent_1": 24.692977016774385}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.68318988159803, "mean_processing_ms": 3.0880196480101416, "mean_inference_ms": 1.9451057098790818}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 211, "num_steps_trained": 10604288, "num_steps_sampled": 7182336, "sample_throughput": 0.0, "train_throughput": 9809.086, "num_weight_syncs": 14027, "num_samples_dropped": 354, "learner_queue": {"size_count": 51834, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.385, "replay_time_ms": 81.886, "update_priorities_time_ms": 39.28, "policy_agent_0": {"added_count": 1773056, "sampled_count": 2678528, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1773056, "sampled_count": 2678528, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.276491165161133, "min_q": 10.072843551635742, "max_q": 10.435039520263672, "mean_td_error": -0.019560430198907852, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.475547790527344, "min_q": 10.07376480102539, "max_q": 11.25117301940918, "mean_td_error": -0.022503670305013657, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 7182336, "episodes_total": 71824, "training_iteration": 70, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-12-47", "timestamp": 1569661967, "time_this_iter_s": 30.62075924873352, "time_total_s": 2138.4917702674866, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f50158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2138.4917702674866, "timesteps_since_restore": 7182336, "iterations_since_restore": 70, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.72784162951892, "episode_reward_min": 44.76389593844597, "episode_reward_mean": 52.2451607603306, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.189338593077732, "agent_1": 26.05582216725289}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6837518696154213, "mean_processing_ms": 3.0901439387669645, "mean_inference_ms": 1.9460059710359645}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 214, "num_steps_trained": 10758400, "num_steps_sampled": 7284224, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14226, "num_samples_dropped": 354, "learner_queue": {"size_count": 52435, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.417, "replay_time_ms": 100.888, "update_priorities_time_ms": 53.036, "policy_agent_0": {"added_count": 1803264, "sampled_count": 2716416, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1803264, "sampled_count": 2716416, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.53125, "min_q": 10.02778434753418, "max_q": 10.726318359375, "mean_td_error": 0.03531375527381897, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.36826229095459, "min_q": 10.098872184753418, "max_q": 10.63460636138916, "mean_td_error": 0.024747591465711594, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 7284224, "episodes_total": 72840, "training_iteration": 71, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-13-17", "timestamp": 1569661997, "time_this_iter_s": 30.49258327484131, "time_total_s": 2168.984353542328, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f50d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2168.984353542328, "timesteps_since_restore": 7284224, "iterations_since_restore": 71, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.45644178976988, "episode_reward_min": 44.79328832682271, "episode_reward_mean": 49.75694343549209, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 22.923887132844666, "agent_1": 26.833056302647478}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6833348379235191, "mean_processing_ms": 3.0883802730560763, "mean_inference_ms": 1.9459322150947358}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 217, "num_steps_trained": 10908160, "num_steps_sampled": 7386624, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14426, "num_samples_dropped": 354, "learner_queue": {"size_count": 53020, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.594, "replay_time_ms": 88.715, "update_priorities_time_ms": 46.116, "policy_agent_0": {"added_count": 1832192, "sampled_count": 2756096, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1832192, "sampled_count": 2756096, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.401962280273438, "min_q": 9.951799392700195, "max_q": 10.819449424743652, "mean_td_error": -0.03261721879243851, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.346343994140625, "min_q": 10.14454174041748, "max_q": 10.822639465332031, "mean_td_error": 0.010678064078092575, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 7386624, "episodes_total": 73864, "training_iteration": 72, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-13-48", "timestamp": 1569662028, "time_this_iter_s": 30.48221516609192, "time_total_s": 2199.46656870842, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f33268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2199.46656870842, "timesteps_since_restore": 7386624, "iterations_since_restore": 72, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.16602762172447, "episode_reward_min": 47.373088303540584, "episode_reward_mean": 51.09404594742196, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 22.776459200091914, "agent_1": 28.317586747330115}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.683319953770556, "mean_processing_ms": 3.0882926221683062, "mean_inference_ms": 1.9458477231589637}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 220, "num_steps_trained": 11057920, "num_steps_sampled": 7488768, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14626, "num_samples_dropped": 354, "learner_queue": {"size_count": 53605, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.105, "replay_time_ms": 70.329, "update_priorities_time_ms": 42.138, "policy_agent_0": {"added_count": 1858048, "sampled_count": 2794240, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1858048, "sampled_count": 2794240, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.190669059753418, "min_q": 9.85048770904541, "max_q": 10.73278522491455, "mean_td_error": -0.03549179062247276, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.474202156066895, "min_q": 10.321976661682129, "max_q": 10.672008514404297, "mean_td_error": 0.07489705085754395, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 7488768, "episodes_total": 74896, "training_iteration": 73, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-14-18", "timestamp": 1569662058, "time_this_iter_s": 30.481889963150024, "time_total_s": 2229.94845867157, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f33e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2229.94845867157, "timesteps_since_restore": 7488768, "iterations_since_restore": 73, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.305891545284446, "episode_reward_min": 46.429418459664575, "episode_reward_mean": 50.12299402789706, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 22.066718100154876, "agent_1": 28.056275927742224}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6834426114702975, "mean_processing_ms": 3.0881567944692003, "mean_inference_ms": 1.9462724695814408}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 223, "num_steps_trained": 11208192, "num_steps_sampled": 7591168, "sample_throughput": 7495.58, "train_throughput": 0.0, "num_weight_syncs": 14825, "num_samples_dropped": 354, "learner_queue": {"size_count": 54192, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.086, "replay_time_ms": 111.27, "update_priorities_time_ms": 48.799, "policy_agent_0": {"added_count": 1880832, "sampled_count": 2832640, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1880832, "sampled_count": 2832640, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.849227905273438, "min_q": 9.525919914245605, "max_q": 10.253225326538086, "mean_td_error": 0.026783328503370285, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.53564739227295, "min_q": 10.332718849182129, "max_q": 10.785981178283691, "mean_td_error": 0.025049462914466858, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 7591168, "episodes_total": 75920, "training_iteration": 74, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-14-49", "timestamp": 1569662089, "time_this_iter_s": 30.70821738243103, "time_total_s": 2260.656676054001, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e98378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2260.656676054001, "timesteps_since_restore": 7591168, "iterations_since_restore": 74, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.50853083669212, "episode_reward_min": 46.29008355786973, "episode_reward_mean": 51.68282493163173, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 24.262109600591568, "agent_1": 27.420715331040185}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6836755696063566, "mean_processing_ms": 3.088787759939058, "mean_inference_ms": 1.946537704891206}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 226, "num_steps_trained": 11363328, "num_steps_sampled": 7693312, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15025, "num_samples_dropped": 354, "learner_queue": {"size_count": 54798, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.506, "replay_time_ms": 97.668, "update_priorities_time_ms": 47.871, "policy_agent_0": {"added_count": 1904896, "sampled_count": 2873344, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1904896, "sampled_count": 2873344, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.687167167663574, "min_q": 9.334845542907715, "max_q": 10.3130521774292, "mean_td_error": 0.012221038341522217, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.506669998168945, "min_q": 10.249579429626465, "max_q": 10.657478332519531, "mean_td_error": -0.047542549669742584, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 7693312, "episodes_total": 76944, "training_iteration": 75, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-15-20", "timestamp": 1569662120, "time_this_iter_s": 30.534661293029785, "time_total_s": 2291.1913373470306, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e98f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2291.1913373470306, "timesteps_since_restore": 7693312, "iterations_since_restore": 75, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.362439376598076, "episode_reward_min": 48.73531849280022, "episode_reward_mean": 54.04040569472079, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.310592971906477, "agent_1": 27.72981272281427}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6837800348318801, "mean_processing_ms": 3.0881168215790744, "mean_inference_ms": 1.9454334285514758}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 229, "num_steps_trained": 11515392, "num_steps_sampled": 7796736, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15227, "num_samples_dropped": 354, "learner_queue": {"size_count": 55393, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.176, "replay_time_ms": 100.85, "update_priorities_time_ms": 51.033, "policy_agent_0": {"added_count": 1927936, "sampled_count": 2910976, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1927936, "sampled_count": 2910976, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.706588745117188, "min_q": 9.347912788391113, "max_q": 10.199028968811035, "mean_td_error": -0.006341796368360519, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.535953521728516, "min_q": 10.2531099319458, "max_q": 10.731990814208984, "mean_td_error": -0.0020966753363609314, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 7796736, "episodes_total": 77976, "training_iteration": 76, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-15-50", "timestamp": 1569662150, "time_this_iter_s": 30.62953472137451, "time_total_s": 2321.820872068405, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5fab488>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2321.820872068405, "timesteps_since_restore": 7796736, "iterations_since_restore": 76, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.728921505816416, "episode_reward_min": 51.47473484047365, "episode_reward_mean": 53.64318353072023, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.352529439619932, "agent_1": 27.29065409110035}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6839811974024238, "mean_processing_ms": 3.0890211498142426, "mean_inference_ms": 1.9458265001890787}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 232, "num_steps_trained": 11667200, "num_steps_sampled": 7900672, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15430, "num_samples_dropped": 354, "learner_queue": {"size_count": 55985, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.388, "replay_time_ms": 98.163, "update_priorities_time_ms": 48.757, "policy_agent_0": {"added_count": 1954560, "sampled_count": 2949120, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1954560, "sampled_count": 2949120, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.85941219329834, "min_q": 9.58989143371582, "max_q": 10.143050193786621, "mean_td_error": 0.025712095201015472, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.59600830078125, "min_q": 10.450565338134766, "max_q": 10.792712211608887, "mean_td_error": 0.061968281865119934, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 7900672, "episodes_total": 79008, "training_iteration": 77, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-16-21", "timestamp": 1569662181, "time_this_iter_s": 30.558107137680054, "time_total_s": 2352.378979206085, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f8c0d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2352.378979206085, "timesteps_since_restore": 7900672, "iterations_since_restore": 77, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 61.57602646020666, "episode_reward_min": 46.16742870644528, "episode_reward_mean": 51.86595862969881, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 24.973863034251313, "agent_1": 26.892095595447625}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6841375830752561, "mean_processing_ms": 3.0894571191940767, "mean_inference_ms": 1.9453301177319862}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 235, "num_steps_trained": 11818496, "num_steps_sampled": 8004608, "sample_throughput": 14716.184, "train_throughput": 9810.789, "num_weight_syncs": 15633, "num_samples_dropped": 354, "learner_queue": {"size_count": 56576, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.318, "replay_time_ms": 87.743, "update_priorities_time_ms": 40.055, "policy_agent_0": {"added_count": 1980416, "sampled_count": 2988544, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 1980416, "sampled_count": 2988544, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.814850807189941, "min_q": 9.439594268798828, "max_q": 10.222408294677734, "mean_td_error": 0.028214149177074432, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.519436836242676, "min_q": 10.303850173950195, "max_q": 11.391288757324219, "mean_td_error": 0.04978161305189133, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 8004608, "episodes_total": 80048, "training_iteration": 78, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-16-52", "timestamp": 1569662212, "time_this_iter_s": 30.55025625228882, "time_total_s": 2382.929235458374, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f7c598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2382.929235458374, "timesteps_since_restore": 8004608, "iterations_since_restore": 78, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 60.48240019772753, "episode_reward_min": 43.74393765783172, "episode_reward_mean": 52.19579467421427, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 25.541014538610387, "agent_1": 26.65478013560393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6837080125743316, "mean_processing_ms": 3.0876992252852102, "mean_inference_ms": 1.9454871083590526}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 238, "num_steps_trained": 11969792, "num_steps_sampled": 8109312, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15837, "num_samples_dropped": 354, "learner_queue": {"size_count": 57167, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.343, "replay_time_ms": 84.881, "update_priorities_time_ms": 37.693, "policy_agent_0": {"added_count": 2004992, "sampled_count": 3027712, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2004992, "sampled_count": 3027712, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.777512550354004, "min_q": 9.446880340576172, "max_q": 10.256766319274902, "mean_td_error": 0.02754673734307289, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.51630973815918, "min_q": 10.228550910949707, "max_q": 11.36195182800293, "mean_td_error": 0.0824892446398735, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 8109312, "episodes_total": 81096, "training_iteration": 79, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-17-22", "timestamp": 1569662242, "time_this_iter_s": 30.49139976501465, "time_total_s": 2413.4206352233887, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ef31e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2413.4206352233887, "timesteps_since_restore": 8109312, "iterations_since_restore": 79, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 60.43780335733289, "episode_reward_min": 43.734324625809066, "episode_reward_mean": 52.90023118990207, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 24.74456540646849, "agent_1": 28.155665783433598}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6844997690858692, "mean_processing_ms": 3.089156279381458, "mean_inference_ms": 1.9457778910135064}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 241, "num_steps_trained": 12120320, "num_steps_sampled": 8211200, "sample_throughput": 14117.13, "train_throughput": 0.0, "num_weight_syncs": 16037, "num_samples_dropped": 354, "learner_queue": {"size_count": 57755, "size_mean": 0.1, "size_std": 0.3605551275463989, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.752, "replay_time_ms": 85.575, "update_priorities_time_ms": 45.169, "policy_agent_0": {"added_count": 2030592, "sampled_count": 3066624, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2030592, "sampled_count": 3066624, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.776634216308594, "min_q": 9.4230375289917, "max_q": 10.139307975769043, "mean_td_error": 0.007408317178487778, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.45531177520752, "min_q": 9.884222030639648, "max_q": 10.90501880645752, "mean_td_error": 0.025770775973796844, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 8211200, "episodes_total": 82112, "training_iteration": 80, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-17-53", "timestamp": 1569662273, "time_this_iter_s": 30.506847620010376, "time_total_s": 2443.927482843399, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f066a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2443.927482843399, "timesteps_since_restore": 8211200, "iterations_since_restore": 80, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.16982688140807, "episode_reward_min": 45.79889385520581, "episode_reward_mean": 55.85642969304989, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 25.159270233391222, "agent_1": 30.6971594596587}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6842571158352208, "mean_processing_ms": 3.087548303290651, "mean_inference_ms": 1.9457804706321036}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 244, "num_steps_trained": 12271872, "num_steps_sampled": 8315648, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16240, "num_samples_dropped": 354, "learner_queue": {"size_count": 58347, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.012, "replay_time_ms": 109.278, "update_priorities_time_ms": 54.917, "policy_agent_0": {"added_count": 2054912, "sampled_count": 3104256, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2054912, "sampled_count": 3104256, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.773940086364746, "min_q": 9.325277328491211, "max_q": 10.141563415527344, "mean_td_error": 0.0145471952855587, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.783307075500488, "min_q": 10.305534362792969, "max_q": 11.47144603729248, "mean_td_error": 0.02641543373465538, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 8315648, "episodes_total": 83168, "training_iteration": 81, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-18-23", "timestamp": 1569662303, "time_this_iter_s": 30.46460723876953, "time_total_s": 2474.3920900821686, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e8b048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2474.3920900821686, "timesteps_since_restore": 8315648, "iterations_since_restore": 81, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.36961658673081, "episode_reward_min": 47.573983386548775, "episode_reward_mean": 50.48322733512341, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.92811382902814, "agent_1": 24.555113506095246}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6847542985604554, "mean_processing_ms": 3.0881146735105376, "mean_inference_ms": 1.9452568561707617}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 247, "num_steps_trained": 12423168, "num_steps_sampled": 8417024, "sample_throughput": 0.0, "train_throughput": 12947.88, "num_weight_syncs": 16438, "num_samples_dropped": 354, "learner_queue": {"size_count": 58938, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 27.928, "replay_time_ms": 93.278, "update_priorities_time_ms": 46.364, "policy_agent_0": {"added_count": 2079488, "sampled_count": 3144960, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2079488, "sampled_count": 3144960, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.843587875366211, "min_q": 9.618298530578613, "max_q": 10.079813003540039, "mean_td_error": 0.010099194943904877, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.868541717529297, "min_q": 10.23149585723877, "max_q": 11.694278717041016, "mean_td_error": -0.026202421635389328, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 8417024, "episodes_total": 84168, "training_iteration": 82, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-18-54", "timestamp": 1569662334, "time_this_iter_s": 30.51547408103943, "time_total_s": 2504.907564163208, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e7d598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2504.907564163208, "timesteps_since_restore": 8417024, "iterations_since_restore": 82, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.243425117435294, "episode_reward_min": 43.83324339278038, "episode_reward_mean": 50.268471749984684, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 25.394242041540622, "agent_1": 24.874229708444027}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6852456791708071, "mean_processing_ms": 3.0888603009223337, "mean_inference_ms": 1.9444332279870906}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 250, "num_steps_trained": 12571136, "num_steps_sampled": 8521984, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16644, "num_samples_dropped": 354, "learner_queue": {"size_count": 59517, "size_mean": 0.18, "size_std": 0.47707441767506253, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.793, "replay_time_ms": 103.638, "update_priorities_time_ms": 52.139, "policy_agent_0": {"added_count": 2106624, "sampled_count": 3181568, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2106624, "sampled_count": 3181568, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.84112548828125, "min_q": 9.625469207763672, "max_q": 10.02202320098877, "mean_td_error": -0.0018988586962223053, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.499673843383789, "min_q": 10.065190315246582, "max_q": 11.698040008544922, "mean_td_error": -0.0866946429014206, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 8521984, "episodes_total": 85224, "training_iteration": 83, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-19-24", "timestamp": 1569662364, "time_this_iter_s": 30.574674606323242, "time_total_s": 2535.4822387695312, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f7c268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2535.4822387695312, "timesteps_since_restore": 8521984, "iterations_since_restore": 83, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.67569297562458, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 50.20104141316493, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 24.367303801400514, "agent_1": 25.833737611764434}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6851685121262117, "mean_processing_ms": 3.087562369446194, "mean_inference_ms": 1.9429389451577657}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 253, "num_steps_trained": 12719360, "num_steps_sampled": 8627712, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16850, "num_samples_dropped": 354, "learner_queue": {"size_count": 60095, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.843, "replay_time_ms": 81.306, "update_priorities_time_ms": 46.199, "policy_agent_0": {"added_count": 2132736, "sampled_count": 3217664, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2132736, "sampled_count": 3217664, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.848458290100098, "min_q": 9.623245239257812, "max_q": 10.025849342346191, "mean_td_error": 0.009214669466018677, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.415555953979492, "min_q": 10.092127799987793, "max_q": 11.199148178100586, "mean_td_error": 0.024359501898288727, "model": {}}}}, "timesteps_this_iter": 105728, "done": false, "timesteps_total": 8627712, "episodes_total": 86280, "training_iteration": 84, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-19-55", "timestamp": 1569662395, "time_this_iter_s": 30.44715118408203, "time_total_s": 2565.9293899536133, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e717b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2565.9293899536133, "timesteps_since_restore": 8627712, "iterations_since_restore": 84, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.68565490355142, "episode_reward_min": 42.96614732336051, "episode_reward_mean": 47.13398689180269, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 21.435194167647584, "agent_1": 25.698792724155073}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6849495589719932, "mean_processing_ms": 3.086851221210147, "mean_inference_ms": 1.9420500940550964}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 256, "num_steps_trained": 12866816, "num_steps_sampled": 8732928, "sample_throughput": 0.0, "train_throughput": 10098.202, "num_weight_syncs": 17055, "num_samples_dropped": 354, "learner_queue": {"size_count": 60671, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.134, "replay_time_ms": 94.106, "update_priorities_time_ms": 56.74, "policy_agent_0": {"added_count": 2158848, "sampled_count": 3256064, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2158848, "sampled_count": 3256064, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.818788528442383, "min_q": 9.508666038513184, "max_q": 10.303950309753418, "mean_td_error": 0.056625694036483765, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.367609024047852, "min_q": 10.03591537475586, "max_q": 11.318501472473145, "mean_td_error": -0.03402601554989815, "model": {}}}}, "timesteps_this_iter": 105216, "done": false, "timesteps_total": 8732928, "episodes_total": 87336, "training_iteration": 85, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-20-25", "timestamp": 1569662425, "time_this_iter_s": 30.51725125312805, "time_total_s": 2596.4466412067413, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f107b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2596.4466412067413, "timesteps_since_restore": 8732928, "iterations_since_restore": 85, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.6693020384634, "episode_reward_min": 47.66948396687371, "episode_reward_mean": 56.72254441333244, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 27.657741104611564, "agent_1": 29.06480330872094}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6850801294547416, "mean_processing_ms": 3.0873098062870166, "mean_inference_ms": 1.9416356037645257}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 259, "num_steps_trained": 13016576, "num_steps_sampled": 8837632, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17260, "num_samples_dropped": 354, "learner_queue": {"size_count": 61257, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.339, "replay_time_ms": 99.544, "update_priorities_time_ms": 55.059, "policy_agent_0": {"added_count": 2186240, "sampled_count": 3295488, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2186240, "sampled_count": 3295488, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.723493576049805, "min_q": 9.168694496154785, "max_q": 10.252504348754883, "mean_td_error": -0.023223672062158585, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.53212833404541, "min_q": 10.020602226257324, "max_q": 11.484563827514648, "mean_td_error": -0.024936076253652573, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 8837632, "episodes_total": 88384, "training_iteration": 86, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-20-56", "timestamp": 1569662456, "time_this_iter_s": 30.472599029541016, "time_total_s": 2626.9192402362823, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f09598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2626.9192402362823, "timesteps_since_restore": 8837632, "iterations_since_restore": 86, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.187047790233, "episode_reward_min": 57.16043307239549, "episode_reward_mean": 61.73667341503648, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.513131261623855, "agent_1": 31.223542153412644}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6848764399772314, "mean_processing_ms": 3.0868820391937395, "mean_inference_ms": 1.941826530057293}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 262, "num_steps_trained": 13169664, "num_steps_sampled": 8941056, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17462, "num_samples_dropped": 354, "learner_queue": {"size_count": 61854, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.232, "replay_time_ms": 85.702, "update_priorities_time_ms": 49.872, "policy_agent_0": {"added_count": 2210304, "sampled_count": 3335168, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2210304, "sampled_count": 3335168, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.152284622192383, "min_q": 9.683185577392578, "max_q": 10.605676651000977, "mean_td_error": 0.06844615936279297, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.899335861206055, "min_q": 10.211755752563477, "max_q": 11.434290885925293, "mean_td_error": -0.09361891448497772, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 8941056, "episodes_total": 89408, "training_iteration": 87, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-21-26", "timestamp": 1569662486, "time_this_iter_s": 30.492897033691406, "time_total_s": 2657.4121372699738, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5efe598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2657.4121372699738, "timesteps_since_restore": 8941056, "iterations_since_restore": 87, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.13672609153593, "episode_reward_min": 53.964952345717045, "episode_reward_mean": 58.98686540957004, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 28.316377070076584, "agent_1": 30.67048833949344}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.685438369032261, "mean_processing_ms": 3.0883269442595167, "mean_inference_ms": 1.9406668588889782}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 265, "num_steps_trained": 13316352, "num_steps_sampled": 9046016, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17667, "num_samples_dropped": 354, "learner_queue": {"size_count": 62428, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.109, "replay_time_ms": 91.884, "update_priorities_time_ms": 57.864, "policy_agent_0": {"added_count": 2241280, "sampled_count": 3372800, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2241280, "sampled_count": 3372800, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.316461563110352, "min_q": 9.966767311096191, "max_q": 10.445968627929688, "mean_td_error": 0.027032218873500824, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.472126960754395, "min_q": 10.693142890930176, "max_q": 11.820534706115723, "mean_td_error": 0.07940348982810974, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 9046016, "episodes_total": 90464, "training_iteration": 88, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-21-57", "timestamp": 1569662517, "time_this_iter_s": 30.575273990631104, "time_total_s": 2687.987411260605, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c67f30d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2687.987411260605, "timesteps_since_restore": 9046016, "iterations_since_restore": 88, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 65.09567508359257, "episode_reward_min": 51.23535542648443, "episode_reward_mean": 57.17214275697955, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 25.76864886915507, "agent_1": 31.403493887824492}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6853399826733277, "mean_processing_ms": 3.0868454366845266, "mean_inference_ms": 1.9407262141799746}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 268, "num_steps_trained": 13468928, "num_steps_sampled": 9150464, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17871, "num_samples_dropped": 354, "learner_queue": {"size_count": 63024, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.621, "replay_time_ms": 101.574, "update_priorities_time_ms": 55.272, "policy_agent_0": {"added_count": 2265344, "sampled_count": 3410944, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2265344, "sampled_count": 3410944, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.4327392578125, "min_q": 10.234105110168457, "max_q": 10.58213996887207, "mean_td_error": -0.007476393133401871, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.488912582397461, "min_q": 11.174453735351562, "max_q": 11.79713249206543, "mean_td_error": 0.03391820564866066, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 9150464, "episodes_total": 91512, "training_iteration": 89, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-22-28", "timestamp": 1569662548, "time_this_iter_s": 30.593791723251343, "time_total_s": 2718.581202983856, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c6809f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2718.581202983856, "timesteps_since_restore": 9150464, "iterations_since_restore": 89, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 65.2126244231531, "episode_reward_min": 49.16841863640918, "episode_reward_mean": 61.92647293328426, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 28.66285540166529, "agent_1": 33.26361753161914}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6847536805517811, "mean_processing_ms": 3.085373333424361, "mean_inference_ms": 1.9403299407827312}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 271, "num_steps_trained": 13622272, "num_steps_sampled": 9254400, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18074, "num_samples_dropped": 354, "learner_queue": {"size_count": 63622, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.994, "replay_time_ms": 89.167, "update_priorities_time_ms": 44.991, "policy_agent_0": {"added_count": 2289152, "sampled_count": 3451136, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2289152, "sampled_count": 3451136, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.382156372070312, "min_q": 9.95447063446045, "max_q": 10.670845031738281, "mean_td_error": -0.07326380163431168, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.739623069763184, "min_q": 11.331550598144531, "max_q": 11.998671531677246, "mean_td_error": 0.01055021584033966, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 9254400, "episodes_total": 92552, "training_iteration": 90, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-22-58", "timestamp": 1569662578, "time_this_iter_s": 30.436333894729614, "time_total_s": 2749.017536878586, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f22598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2749.017536878586, "timesteps_since_restore": 9254400, "iterations_since_restore": 90, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 65.60352154045377, "episode_reward_min": 54.93123709699921, "episode_reward_mean": 62.13715034347921, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 28.31337087471539, "agent_1": 33.82377946876382}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6852000290045319, "mean_processing_ms": 3.0864288374372255, "mean_inference_ms": 1.9402310977654595}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 274, "num_steps_trained": 13776640, "num_steps_sampled": 9358080, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18277, "num_samples_dropped": 354, "learner_queue": {"size_count": 64225, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.498, "replay_time_ms": 98.209, "update_priorities_time_ms": 49.3, "policy_agent_0": {"added_count": 2319360, "sampled_count": 3488768, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2319360, "sampled_count": 3488768, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.522374153137207, "min_q": 10.139801025390625, "max_q": 10.83198070526123, "mean_td_error": -0.019095517694950104, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 12.053237915039062, "min_q": 11.48402214050293, "max_q": 12.371089935302734, "mean_td_error": 0.017240311950445175, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 9358080, "episodes_total": 93592, "training_iteration": 91, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-23-29", "timestamp": 1569662609, "time_this_iter_s": 30.57693910598755, "time_total_s": 2779.5944759845734, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f31510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2779.5944759845734, "timesteps_since_restore": 9358080, "iterations_since_restore": 91, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.07408627804459, "episode_reward_min": 49.419781101880965, "episode_reward_mean": 56.856783215301355, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 27.51802157575949, "agent_1": 29.338761639541875}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6849692376626334, "mean_processing_ms": 3.084689443031154, "mean_inference_ms": 1.9392889348647062}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 277, "num_steps_trained": 13929984, "num_steps_sampled": 9462528, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18481, "num_samples_dropped": 354, "learner_queue": {"size_count": 64824, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.931, "replay_time_ms": 77.322, "update_priorities_time_ms": 45.853, "policy_agent_0": {"added_count": 2344192, "sampled_count": 3530496, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2344192, "sampled_count": 3530496, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.638607025146484, "min_q": 10.2341947555542, "max_q": 10.871406555175781, "mean_td_error": -0.01040339469909668, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 12.108335494995117, "min_q": 11.710217475891113, "max_q": 12.63383960723877, "mean_td_error": 0.05538361147046089, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 9462528, "episodes_total": 94632, "training_iteration": 92, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-23-59", "timestamp": 1569662639, "time_this_iter_s": 30.49324345588684, "time_total_s": 2810.08771944046, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5eb8ea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2810.08771944046, "timesteps_since_restore": 9462528, "iterations_since_restore": 92, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.4130425091277, "episode_reward_min": 48.95166460107197, "episode_reward_mean": 60.30326901700765, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 29.130636167771502, "agent_1": 31.172632849236145}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6852999185358273, "mean_processing_ms": 3.0863437625112713, "mean_inference_ms": 1.9399375534695227}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 280, "num_steps_trained": 14084352, "num_steps_sampled": 9565696, "sample_throughput": 0.0, "train_throughput": 19554.221, "num_weight_syncs": 18681, "num_samples_dropped": 354, "learner_queue": {"size_count": 65427, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.02, "replay_time_ms": 62.174, "update_priorities_time_ms": 41.007, "policy_agent_0": {"added_count": 2369280, "sampled_count": 3571712, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2369280, "sampled_count": 3571712, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.702219009399414, "min_q": 10.337063789367676, "max_q": 10.943020820617676, "mean_td_error": -0.05548855662345886, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 12.096355438232422, "min_q": 11.283651351928711, "max_q": 13.001298904418945, "mean_td_error": 0.04441206902265549, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 9565696, "episodes_total": 95656, "training_iteration": 93, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-24-30", "timestamp": 1569662670, "time_this_iter_s": 30.435234785079956, "time_total_s": 2840.52295422554, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ec2e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2840.52295422554, "timesteps_since_restore": 9565696, "iterations_since_restore": 93, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.01917745792531, "episode_reward_min": 52.83626556162186, "episode_reward_mean": 57.414910268907235, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 28.076278997809723, "agent_1": 29.338631271097494}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6847502086147256, "mean_processing_ms": 3.0837279487390052, "mean_inference_ms": 1.9397461623374803}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 283, "num_steps_trained": 14236928, "num_steps_sampled": 9669888, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18885, "num_samples_dropped": 354, "learner_queue": {"size_count": 66023, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.923, "replay_time_ms": 97.309, "update_priorities_time_ms": 49.39, "policy_agent_0": {"added_count": 2396416, "sampled_count": 3611648, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2396416, "sampled_count": 3611648, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.77027416229248, "min_q": 10.478658676147461, "max_q": 11.00895881652832, "mean_td_error": -0.01682526245713234, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.93887710571289, "min_q": 11.32780933380127, "max_q": 12.250579833984375, "mean_td_error": 0.02368178963661194, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 9669888, "episodes_total": 96696, "training_iteration": 94, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-25-00", "timestamp": 1569662700, "time_this_iter_s": 30.49390435218811, "time_total_s": 2871.0168585777283, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e5c378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2871.0168585777283, "timesteps_since_restore": 9669888, "iterations_since_restore": 94, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.06587161709963, "episode_reward_min": 51.948780346905636, "episode_reward_mean": 60.907553763251876, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 29.191549302493183, "agent_1": 31.716004460758608}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6850825537236195, "mean_processing_ms": 3.0849698439349904, "mean_inference_ms": 1.9392493567884541}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 286, "num_steps_trained": 14387200, "num_steps_sampled": 9775104, "sample_throughput": 0.0, "train_throughput": 27140.051, "num_weight_syncs": 19091, "num_samples_dropped": 354, "learner_queue": {"size_count": 66610, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.541, "replay_time_ms": 89.127, "update_priorities_time_ms": 46.108, "policy_agent_0": {"added_count": 2420224, "sampled_count": 3653120, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2420224, "sampled_count": 3653120, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.886170387268066, "min_q": 10.6356782913208, "max_q": 11.090859413146973, "mean_td_error": 0.01712270826101303, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.977657318115234, "min_q": 11.570472717285156, "max_q": 12.159064292907715, "mean_td_error": 0.023738034069538116, "model": {}}}}, "timesteps_this_iter": 105216, "done": false, "timesteps_total": 9775104, "episodes_total": 97752, "training_iteration": 95, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-25-31", "timestamp": 1569662731, "time_this_iter_s": 30.579538822174072, "time_total_s": 2901.5963973999023, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f84048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2901.5963973999023, "timesteps_since_restore": 9775104, "iterations_since_restore": 95, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.07278937093056, "episode_reward_min": 47.2820371555433, "episode_reward_mean": 59.59440400105204, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 28.997280180497775, "agent_1": 30.597123820554216}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6849303563398187, "mean_processing_ms": 3.0845652017542706, "mean_inference_ms": 1.9386259046007075}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 289, "num_steps_trained": 14537984, "num_steps_sampled": 9880832, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19297, "num_samples_dropped": 354, "learner_queue": {"size_count": 67199, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.523, "replay_time_ms": 72.43, "update_priorities_time_ms": 49.311, "policy_agent_0": {"added_count": 2444288, "sampled_count": 3693312, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2444288, "sampled_count": 3693312, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.89412784576416, "min_q": 10.520034790039062, "max_q": 11.09013557434082, "mean_td_error": -0.02337583899497986, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.94355297088623, "min_q": 11.522366523742676, "max_q": 12.149672508239746, "mean_td_error": 0.003934770822525024, "model": {}}}}, "timesteps_this_iter": 105728, "done": false, "timesteps_total": 9880832, "episodes_total": 98816, "training_iteration": 96, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-26-01", "timestamp": 1569662761, "time_this_iter_s": 30.49704384803772, "time_total_s": 2932.09344124794, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f50510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2932.09344124794, "timesteps_since_restore": 9880832, "iterations_since_restore": 96, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.69867495744776, "episode_reward_min": 46.11027341515828, "episode_reward_mean": 59.34941881273771, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 28.6491369614234, "agent_1": 30.70028185131421}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6844598515627525, "mean_processing_ms": 3.0832738796269834, "mean_inference_ms": 1.9388885891186165}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 292, "num_steps_trained": 14691328, "num_steps_sampled": 9985280, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19502, "num_samples_dropped": 354, "learner_queue": {"size_count": 67798, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.913, "replay_time_ms": 71.668, "update_priorities_time_ms": 46.719, "policy_agent_0": {"added_count": 2471680, "sampled_count": 3734784, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2471680, "sampled_count": 3734784, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.85050106048584, "min_q": 10.440093040466309, "max_q": 11.111726760864258, "mean_td_error": -0.018885638564825058, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.938555717468262, "min_q": 11.453801155090332, "max_q": 12.109312057495117, "mean_td_error": 0.04564874991774559, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 9985280, "episodes_total": 99864, "training_iteration": 97, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-26-32", "timestamp": 1569662792, "time_this_iter_s": 30.466322422027588, "time_total_s": 2962.5597636699677, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e98158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2962.5597636699677, "timesteps_since_restore": 9985280, "iterations_since_restore": 97, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 65.23673858342131, "episode_reward_min": 45.556898989845244, "episode_reward_mean": 55.519566772373594, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 28.53270470774221, "agent_1": 26.98686206463139}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6846541060956688, "mean_processing_ms": 3.083097175231631, "mean_inference_ms": 1.9377794644291737}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 295, "num_steps_trained": 14838528, "num_steps_sampled": 10092800, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19711, "num_samples_dropped": 354, "learner_queue": {"size_count": 68373, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.908, "replay_time_ms": 101.055, "update_priorities_time_ms": 50.418, "policy_agent_0": {"added_count": 2500352, "sampled_count": 3773696, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2500352, "sampled_count": 3773696, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.890396118164062, "min_q": 10.321151733398438, "max_q": 11.179730415344238, "mean_td_error": 0.017586003988981247, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.740954399108887, "min_q": 11.147028923034668, "max_q": 12.072904586791992, "mean_td_error": -0.03950989246368408, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 10092800, "episodes_total": 100928, "training_iteration": 98, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-27-02", "timestamp": 1569662822, "time_this_iter_s": 30.51775884628296, "time_total_s": 2993.0775225162506, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5eca620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2993.0775225162506, "timesteps_since_restore": 10092800, "iterations_since_restore": 98, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.04917812406137, "episode_reward_min": 45.41267528479213, "episode_reward_mean": 50.59923564688769, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 25.435054882438095, "agent_1": 25.16418076444963}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6845543017053415, "mean_processing_ms": 3.083026235970395, "mean_inference_ms": 1.9378308244300158}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 298, "num_steps_trained": 14994944, "num_steps_sampled": 10196992, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19915, "num_samples_dropped": 354, "learner_queue": {"size_count": 68984, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.303, "replay_time_ms": 92.824, "update_priorities_time_ms": 53.4, "policy_agent_0": {"added_count": 2523648, "sampled_count": 3818496, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2523648, "sampled_count": 3818496, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.820599555969238, "min_q": 10.380777359008789, "max_q": 11.171744346618652, "mean_td_error": 0.009011983871459961, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.539142608642578, "min_q": 10.92586612701416, "max_q": 12.30568790435791, "mean_td_error": 0.043350666761398315, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 10196992, "episodes_total": 101984, "training_iteration": 99, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-27-33", "timestamp": 1569662853, "time_this_iter_s": 30.517881393432617, "time_total_s": 3023.5954039096832, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f9f268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3023.5954039096832, "timesteps_since_restore": 10196992, "iterations_since_restore": 99, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.05118135550562, "episode_reward_min": 46.68855380599195, "episode_reward_mean": 52.60895621898558, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 26.50404529962212, "agent_1": 26.104910919363498}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6848190022412879, "mean_processing_ms": 3.082815218678453, "mean_inference_ms": 1.936790747630513}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 301, "num_steps_trained": 15142656, "num_steps_sampled": 10304256, "sample_throughput": 0.0, "train_throughput": 31731.835, "num_weight_syncs": 20125, "num_samples_dropped": 354, "learner_queue": {"size_count": 69562, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.262, "replay_time_ms": 93.075, "update_priorities_time_ms": 53.04, "policy_agent_0": {"added_count": 2549760, "sampled_count": 3859712, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2549760, "sampled_count": 3859712, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.611783027648926, "min_q": 10.320573806762695, "max_q": 11.129274368286133, "mean_td_error": 0.046045366674661636, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.053257942199707, "min_q": 10.683767318725586, "max_q": 12.123444557189941, "mean_td_error": 0.013878483325242996, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 10304256, "episodes_total": 103048, "training_iteration": 100, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-28-03", "timestamp": 1569662883, "time_this_iter_s": 30.455065965652466, "time_total_s": 3054.0504698753357, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bd5730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3054.0504698753357, "timesteps_since_restore": 10304256, "iterations_since_restore": 100, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.11735560188235, "episode_reward_min": 46.2215571643762, "episode_reward_mean": 55.25865810335328, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 26.883732277250136, "agent_1": 28.374925826103166}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6848357520186038, "mean_processing_ms": 3.082630932345839, "mean_inference_ms": 1.9361330512847634}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 304, "num_steps_trained": 15294208, "num_steps_sampled": 10408960, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20329, "num_samples_dropped": 354, "learner_queue": {"size_count": 70153, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.496, "replay_time_ms": 95.633, "update_priorities_time_ms": 49.263, "policy_agent_0": {"added_count": 2578944, "sampled_count": 3897344, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2578944, "sampled_count": 3897344, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.552139282226562, "min_q": 10.258069038391113, "max_q": 11.191448211669922, "mean_td_error": -0.012449797242879868, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.898823738098145, "min_q": 10.455245018005371, "max_q": 11.941753387451172, "mean_td_error": -0.05936615914106369, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 10408960, "episodes_total": 104088, "training_iteration": 101, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-28-34", "timestamp": 1569662914, "time_this_iter_s": 30.51524782180786, "time_total_s": 3084.5657176971436, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5be82f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3084.5657176971436, "timesteps_since_restore": 10408960, "iterations_since_restore": 101, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.47484107125373, "episode_reward_min": 48.905870730603894, "episode_reward_mean": 60.9039651200559, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 31.173760637444342, "agent_1": 29.730204482611644}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6844110724433481, "mean_processing_ms": 3.0812769660100017, "mean_inference_ms": 1.9357635677001845}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 307, "num_steps_trained": 15447296, "num_steps_sampled": 10514432, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20535, "num_samples_dropped": 354, "learner_queue": {"size_count": 70751, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.295, "replay_time_ms": 68.927, "update_priorities_time_ms": 39.32, "policy_agent_0": {"added_count": 2605568, "sampled_count": 3938048, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2605568, "sampled_count": 3938048, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.04982852935791, "min_q": 10.146688461303711, "max_q": 11.538002967834473, "mean_td_error": -0.0017667077481746674, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.158162117004395, "min_q": 10.74468994140625, "max_q": 11.777322769165039, "mean_td_error": 0.03316599130630493, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 10514432, "episodes_total": 105144, "training_iteration": 102, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-29-04", "timestamp": 1569662944, "time_this_iter_s": 30.421425580978394, "time_total_s": 3114.987143278122, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5be1840>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3114.987143278122, "timesteps_since_restore": 10514432, "iterations_since_restore": 102, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.13331216653178, "episode_reward_min": 46.18385484089852, "episode_reward_mean": 53.65125770187809, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 26.587367148921686, "agent_1": 27.063890552956444}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6846717572921465, "mean_processing_ms": 3.0824296734206134, "mean_inference_ms": 1.936100980085593}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 310, "num_steps_trained": 15598080, "num_steps_sampled": 10618880, "sample_throughput": 0.0, "train_throughput": 21722.033, "num_weight_syncs": 20739, "num_samples_dropped": 354, "learner_queue": {"size_count": 71340, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.369, "replay_time_ms": 83.086, "update_priorities_time_ms": 51.093, "policy_agent_0": {"added_count": 2636032, "sampled_count": 3978240, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2636032, "sampled_count": 3978240, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 11.061599731445312, "min_q": 10.576998710632324, "max_q": 11.479726791381836, "mean_td_error": 0.05097537860274315, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.270926475524902, "min_q": 10.909407615661621, "max_q": 11.71847152709961, "mean_td_error": -0.03183392807841301, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 10618880, "episodes_total": 106192, "training_iteration": 103, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-29-35", "timestamp": 1569662975, "time_this_iter_s": 30.47529649734497, "time_total_s": 3145.462439775467, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bd6488>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3145.462439775467, "timesteps_since_restore": 10618880, "iterations_since_restore": 103, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.85309830475541, "episode_reward_min": 44.35388182361283, "episode_reward_mean": 51.50839363086686, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 24.585679103417075, "agent_1": 26.922714527449816}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6844803693593048, "mean_processing_ms": 3.081936969784478, "mean_inference_ms": 1.935461022360805}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 313, "num_steps_trained": 15750656, "num_steps_sampled": 10723584, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20944, "num_samples_dropped": 354, "learner_queue": {"size_count": 71936, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.94, "replay_time_ms": 85.979, "update_priorities_time_ms": 44.964, "policy_agent_0": {"added_count": 2662400, "sampled_count": 4017152, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2662400, "sampled_count": 4017152, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.886706352233887, "min_q": 10.142849922180176, "max_q": 11.223599433898926, "mean_td_error": 0.02567482739686966, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.297399520874023, "min_q": 10.692649841308594, "max_q": 11.717896461486816, "mean_td_error": 0.012320570647716522, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 10723584, "episodes_total": 107240, "training_iteration": 104, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-30-06", "timestamp": 1569663006, "time_this_iter_s": 30.562026739120483, "time_total_s": 3176.0244665145874, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bf8950>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3176.0244665145874, "timesteps_since_restore": 10723584, "iterations_since_restore": 104, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.158535021172995, "episode_reward_min": 46.57750881573683, "episode_reward_mean": 57.524786260069185, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 28.047921171891392, "agent_1": 29.476865088177703}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.684553795768497, "mean_processing_ms": 3.082071058695012, "mean_inference_ms": 1.935136276085986}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 317, "num_steps_trained": 15908608, "num_steps_sampled": 10827520, "sample_throughput": 13303.29, "train_throughput": 0.0, "num_weight_syncs": 21146, "num_samples_dropped": 354, "learner_queue": {"size_count": 72553, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.625, "replay_time_ms": 100.61, "update_priorities_time_ms": 51.176, "policy_agent_0": {"added_count": 2688512, "sampled_count": 4060416, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2688512, "sampled_count": 4060416, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.723393440246582, "min_q": 10.232680320739746, "max_q": 10.985944747924805, "mean_td_error": 0.028964273631572723, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.323246955871582, "min_q": 10.529352188110352, "max_q": 11.769838333129883, "mean_td_error": 0.018137577921152115, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 10827520, "episodes_total": 108280, "training_iteration": 105, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-30-36", "timestamp": 1569663036, "time_this_iter_s": 30.607476472854614, "time_total_s": 3206.631942987442, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bf9598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3206.631942987442, "timesteps_since_restore": 10827520, "iterations_since_restore": 105, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.165165088712904, "episode_reward_min": 48.22521861621116, "episode_reward_mean": 60.58086027818914, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 27.747032369563993, "agent_1": 32.83382790862509}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6842589037757904, "mean_processing_ms": 3.080641250639589, "mean_inference_ms": 1.934354234887123}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 320, "num_steps_trained": 16058624, "num_steps_sampled": 10936064, "sample_throughput": 13794.394, "train_throughput": 6897.197, "num_weight_syncs": 21358, "num_samples_dropped": 354, "learner_queue": {"size_count": 73139, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.579, "replay_time_ms": 74.537, "update_priorities_time_ms": 46.476, "policy_agent_0": {"added_count": 2716416, "sampled_count": 4101888, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2716416, "sampled_count": 4101888, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.773435592651367, "min_q": 10.389474868774414, "max_q": 10.99031925201416, "mean_td_error": -0.027623720467090607, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.348670959472656, "min_q": 10.801589965820312, "max_q": 11.73377799987793, "mean_td_error": 0.024145938456058502, "model": {}}}}, "timesteps_this_iter": 108544, "done": false, "timesteps_total": 10936064, "episodes_total": 109368, "training_iteration": 106, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-31-07", "timestamp": 1569663067, "time_this_iter_s": 30.443708419799805, "time_total_s": 3237.075651407242, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5c0ba60>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3237.075651407242, "timesteps_since_restore": 10936064, "iterations_since_restore": 106, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.14682563971385, "episode_reward_min": 53.428280467100755, "episode_reward_mean": 60.55551489825114, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 27.771970099297263, "agent_1": 32.783544798953834}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.684130498906493, "mean_processing_ms": 3.080060997439457, "mean_inference_ms": 1.934303624494392}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 323, "num_steps_trained": 16212480, "num_steps_sampled": 11041536, "sample_throughput": 8940.324, "train_throughput": 4470.162, "num_weight_syncs": 21565, "num_samples_dropped": 354, "learner_queue": {"size_count": 73740, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.616, "replay_time_ms": 66.538, "update_priorities_time_ms": 39.074, "policy_agent_0": {"added_count": 2746112, "sampled_count": 4142336, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2746112, "sampled_count": 4142336, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.863005638122559, "min_q": 10.548130989074707, "max_q": 11.110137939453125, "mean_td_error": 0.029369696974754333, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.534854888916016, "min_q": 11.138503074645996, "max_q": 11.64668083190918, "mean_td_error": -0.00437704473733902, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 11041536, "episodes_total": 110424, "training_iteration": 107, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-31-37", "timestamp": 1569663097, "time_this_iter_s": 30.499961853027344, "time_total_s": 3267.575613260269, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5be1950>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3267.575613260269, "timesteps_since_restore": 11041536, "iterations_since_restore": 107, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.16572126574741, "episode_reward_min": 48.831263805608415, "episode_reward_mean": 60.18294854233836, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 27.269122200222746, "agent_1": 32.91382634211558}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6840802603393739, "mean_processing_ms": 3.0792177373826157, "mean_inference_ms": 1.9336981730088354}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 326, "num_steps_trained": 16360960, "num_steps_sampled": 11148032, "sample_throughput": 6792.223, "train_throughput": 0.0, "num_weight_syncs": 21772, "num_samples_dropped": 354, "learner_queue": {"size_count": 74320, "size_mean": 0.9, "size_std": 1.9621416870348585, "size_quantiles": [0.0, 0.0, 0.0, 4.100000000000001, 8.0]}, "replay_shard_0": {"add_batch_time_ms": 27.886, "replay_time_ms": 84.81, "update_priorities_time_ms": 45.183, "policy_agent_0": {"added_count": 2768384, "sampled_count": 4185088, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2768384, "sampled_count": 4185088, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.669181823730469, "min_q": 10.380597114562988, "max_q": 10.919071197509766, "mean_td_error": 0.010921385139226913, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.926797866821289, "min_q": 11.426806449890137, "max_q": 12.108388900756836, "mean_td_error": 0.10285889357328415, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 11148032, "episodes_total": 111488, "training_iteration": 108, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-32-08", "timestamp": 1569663128, "time_this_iter_s": 30.536559104919434, "time_total_s": 3298.1121723651886, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bd5b70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3298.1121723651886, "timesteps_since_restore": 11148032, "iterations_since_restore": 108, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 62.1102035944913, "episode_reward_min": 47.85656819929549, "episode_reward_mean": 52.54276718174509, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 25.564904104374257, "agent_1": 26.97786307737089}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6845885964177302, "mean_processing_ms": 3.0802570801582014, "mean_inference_ms": 1.9332435251162448}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 328, "num_steps_trained": 16507904, "num_steps_sampled": 11256832, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21985, "num_samples_dropped": 354, "learner_queue": {"size_count": 74894, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.015, "replay_time_ms": 78.668, "update_priorities_time_ms": 45.807, "policy_agent_0": {"added_count": 2795008, "sampled_count": 4222208, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2795008, "sampled_count": 4222208, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.553160667419434, "min_q": 10.235136985778809, "max_q": 10.911073684692383, "mean_td_error": 0.010906070470809937, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.825460433959961, "min_q": 11.41684341430664, "max_q": 12.094404220581055, "mean_td_error": 0.037290651351213455, "model": {}}}}, "timesteps_this_iter": 108800, "done": false, "timesteps_total": 11256832, "episodes_total": 112576, "training_iteration": 109, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-32-38", "timestamp": 1569663158, "time_this_iter_s": 30.53387999534607, "time_total_s": 3328.6460523605347, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f9f1e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3328.6460523605347, "timesteps_since_restore": 11256832, "iterations_since_restore": 109, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.58977921868949, "episode_reward_min": 47.14587891914709, "episode_reward_mean": 53.72329546216937, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 25.254723982955355, "agent_1": 28.468571479214006}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6845425491386185, "mean_processing_ms": 3.0799407325509702, "mean_inference_ms": 1.932427490839654}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 331, "num_steps_trained": 16657920, "num_steps_sampled": 11364096, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22195, "num_samples_dropped": 354, "learner_queue": {"size_count": 75480, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.227, "replay_time_ms": 82.997, "update_priorities_time_ms": 53.681, "policy_agent_0": {"added_count": 2824192, "sampled_count": 4262144, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2824192, "sampled_count": 4262144, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.373103141784668, "min_q": 9.93704891204834, "max_q": 10.847694396972656, "mean_td_error": -0.011325929313898087, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.679667472839355, "min_q": 11.304012298583984, "max_q": 12.088520050048828, "mean_td_error": -0.007050022482872009, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 11364096, "episodes_total": 113648, "training_iteration": 110, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-33-09", "timestamp": 1569663189, "time_this_iter_s": 30.589507818222046, "time_total_s": 3359.2355601787567, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ec5268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3359.2355601787567, "timesteps_since_restore": 11364096, "iterations_since_restore": 110, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.32814750738824, "episode_reward_min": 60.85229740676895, "episode_reward_mean": 62.8628906108622, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 29.942172714264633, "agent_1": 32.92071789659763}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6841540435385846, "mean_processing_ms": 3.078374672114013, "mean_inference_ms": 1.9320452172744575}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 334, "num_steps_trained": 16808960, "num_steps_sampled": 11470592, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22403, "num_samples_dropped": 354, "learner_queue": {"size_count": 76070, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.397, "replay_time_ms": 97.317, "update_priorities_time_ms": 54.487, "policy_agent_0": {"added_count": 2850560, "sampled_count": 4303616, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2850560, "sampled_count": 4303616, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.653680801391602, "min_q": 10.288705825805664, "max_q": 10.935025215148926, "mean_td_error": 0.00535883754491806, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.70816421508789, "min_q": 11.254878044128418, "max_q": 12.074003219604492, "mean_td_error": 0.02562180906534195, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 11470592, "episodes_total": 114712, "training_iteration": 111, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-33-39", "timestamp": 1569663219, "time_this_iter_s": 30.562214612960815, "time_total_s": 3389.7977747917175, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ec57b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3389.7977747917175, "timesteps_since_restore": 11470592, "iterations_since_restore": 111, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 64.15519024230063, "episode_reward_min": 57.422514937445925, "episode_reward_mean": 60.92821081768572, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 27.59759421585501, "agent_1": 33.33061660183078}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6845328576966604, "mean_processing_ms": 3.0798290469861556, "mean_inference_ms": 1.932100390363048}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 338, "num_steps_trained": 16963584, "num_steps_sampled": 11575296, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22607, "num_samples_dropped": 354, "learner_queue": {"size_count": 76674, "size_mean": 0.12, "size_std": 0.3815756805667783, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.39, "replay_time_ms": 100.414, "update_priorities_time_ms": 51.632, "policy_agent_0": {"added_count": 2876160, "sampled_count": 4345856, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2876160, "sampled_count": 4345856, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.69885540008545, "min_q": 10.184688568115234, "max_q": 10.953032493591309, "mean_td_error": 0.01986585184931755, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 12.046768188476562, "min_q": 11.558623313903809, "max_q": 12.248800277709961, "mean_td_error": -0.0037577860057353973, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 11575296, "episodes_total": 115760, "training_iteration": 112, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-34-10", "timestamp": 1569663250, "time_this_iter_s": 30.618077039718628, "time_total_s": 3420.415851831436, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5eb8d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3420.415851831436, "timesteps_since_restore": 11575296, "iterations_since_restore": 112, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.24798639099325, "episode_reward_min": 55.36761002936003, "episode_reward_mean": 59.9236068650161, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 28.674734599295945, "agent_1": 31.248872265720227}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6836509454536207, "mean_processing_ms": 3.0772374806482343, "mean_inference_ms": 1.9317371628035853}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 340, "num_steps_trained": 17108480, "num_steps_sampled": 11679744, "sample_throughput": 0.0, "train_throughput": 14664.998, "num_weight_syncs": 22811, "num_samples_dropped": 354, "learner_queue": {"size_count": 77240, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.25, "replay_time_ms": 101.534, "update_priorities_time_ms": 50.25, "policy_agent_0": {"added_count": 2898688, "sampled_count": 4385024, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2898688, "sampled_count": 4385024, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.895284652709961, "min_q": 10.4119234085083, "max_q": 11.096999168395996, "mean_td_error": 0.07019326090812683, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 12.210801124572754, "min_q": 11.922240257263184, "max_q": 12.454745292663574, "mean_td_error": 0.018610935658216476, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 11679744, "episodes_total": 116800, "training_iteration": 113, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-34-41", "timestamp": 1569663281, "time_this_iter_s": 30.56824254989624, "time_total_s": 3450.9840943813324, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f31378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3450.9840943813324, "timesteps_since_restore": 11679744, "iterations_since_restore": 113, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 63.209173377235054, "episode_reward_min": 56.5433995266362, "episode_reward_mean": 60.73887531086392, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 30.526329532203718, "agent_1": 30.21254577866027}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6838031932138197, "mean_processing_ms": 3.0781219107836244, "mean_inference_ms": 1.933581457427665}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 343, "num_steps_trained": 17252864, "num_steps_sampled": 11779072, "sample_throughput": 0.0, "train_throughput": 26292.713, "num_weight_syncs": 23004, "num_samples_dropped": 354, "learner_queue": {"size_count": 77804, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.272, "replay_time_ms": 77.756, "update_priorities_time_ms": 41.876, "policy_agent_0": {"added_count": 2923008, "sampled_count": 4425728, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2923008, "sampled_count": 4425728, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.910999298095703, "min_q": 10.644726753234863, "max_q": 11.187734603881836, "mean_td_error": 0.034928180277347565, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 12.138933181762695, "min_q": 11.998922348022461, "max_q": 12.412873268127441, "mean_td_error": 0.028974473476409912, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 11779072, "episodes_total": 117800, "training_iteration": 114, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-35-11", "timestamp": 1569663311, "time_this_iter_s": 30.581714630126953, "time_total_s": 3481.5658090114594, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f14b70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3481.5658090114594, "timesteps_since_restore": 11779072, "iterations_since_restore": 114, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 61.75789735330619, "episode_reward_min": 49.609111833844565, "episode_reward_mean": 55.358224086808356, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 25.834137567625245, "agent_1": 29.524086519183175}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6836295120174043, "mean_processing_ms": 3.077526262418965, "mean_inference_ms": 1.932587864960802}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 346, "num_steps_trained": 17402624, "num_steps_sampled": 11887104, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23217, "num_samples_dropped": 354, "learner_queue": {"size_count": 78389, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.535, "replay_time_ms": 83.481, "update_priorities_time_ms": 45.064, "policy_agent_0": {"added_count": 2949376, "sampled_count": 4467712, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2949376, "sampled_count": 4467712, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.807209014892578, "min_q": 10.521806716918945, "max_q": 11.080841064453125, "mean_td_error": 0.02160654589533806, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.940710067749023, "min_q": 11.782366752624512, "max_q": 12.17266845703125, "mean_td_error": -0.005549252033233643, "model": {}}}}, "timesteps_this_iter": 108032, "done": false, "timesteps_total": 11887104, "episodes_total": 118872, "training_iteration": 115, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-35-42", "timestamp": 1569663342, "time_this_iter_s": 30.469552278518677, "time_total_s": 3512.035361289978, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c68097b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3512.035361289978, "timesteps_since_restore": 11887104, "iterations_since_restore": 115, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 56.89748470197301, "episode_reward_min": 44.62753116403657, "episode_reward_mean": 50.53975047598137, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 24.792611073816197, "agent_1": 25.74713940216522}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6832102782655055, "mean_processing_ms": 3.075848539269002, "mean_inference_ms": 1.9330567508269585}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 349, "num_steps_trained": 17558528, "num_steps_sampled": 11991552, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23420, "num_samples_dropped": 354, "learner_queue": {"size_count": 78998, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.915, "replay_time_ms": 83.171, "update_priorities_time_ms": 42.609, "policy_agent_0": {"added_count": 2978816, "sampled_count": 4510720, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 2978816, "sampled_count": 4510720, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.779975891113281, "min_q": 10.403111457824707, "max_q": 11.306863784790039, "mean_td_error": -0.002890169620513916, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.678750991821289, "min_q": 11.05741024017334, "max_q": 12.099594116210938, "mean_td_error": 0.030942466109991074, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 11991552, "episodes_total": 119912, "training_iteration": 116, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-36-12", "timestamp": 1569663372, "time_this_iter_s": 30.456122636795044, "time_total_s": 3542.491483926773, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c6892e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3542.491483926773, "timesteps_since_restore": 11991552, "iterations_since_restore": 116, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 56.37461622801171, "episode_reward_min": 44.06950309222537, "episode_reward_mean": 49.236954370476276, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 22.579357162394285, "agent_1": 26.65759720808203}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6836341036217471, "mean_processing_ms": 3.0768264762679585, "mean_inference_ms": 1.9325944719867696}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 352, "num_steps_trained": 17711104, "num_steps_sampled": 12097792, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23627, "num_samples_dropped": 354, "learner_queue": {"size_count": 79594, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.25, "replay_time_ms": 96.611, "update_priorities_time_ms": 46.375, "policy_agent_0": {"added_count": 3008768, "sampled_count": 4551680, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3008768, "sampled_count": 4551680, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.451197624206543, "min_q": 9.863798141479492, "max_q": 11.066323280334473, "mean_td_error": 0.026953767985105515, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.61696720123291, "min_q": 11.148738861083984, "max_q": 12.003867149353027, "mean_td_error": 0.0662291869521141, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 12097792, "episodes_total": 120992, "training_iteration": 117, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-36-43", "timestamp": 1569663403, "time_this_iter_s": 30.583765983581543, "time_total_s": 3573.0752499103546, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5efeae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3573.0752499103546, "timesteps_since_restore": 12097792, "iterations_since_restore": 117, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.00322025013421, "episode_reward_min": 41.9797703717829, "episode_reward_mean": 46.894227843487265, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 24.09293837952696, "agent_1": 22.80128946396037}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.683091882659636, "mean_processing_ms": 3.074988131403892, "mean_inference_ms": 1.9322103557616537}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 355, "num_steps_trained": 17863424, "num_steps_sampled": 12204288, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23835, "num_samples_dropped": 354, "learner_queue": {"size_count": 80190, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.765, "replay_time_ms": 104.966, "update_priorities_time_ms": 48.079, "policy_agent_0": {"added_count": 3034624, "sampled_count": 4592640, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3034624, "sampled_count": 4592640, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.158221244812012, "min_q": 9.729242324829102, "max_q": 10.736244201660156, "mean_td_error": 0.001207098364830017, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 11.250630378723145, "min_q": 10.861163139343262, "max_q": 11.772461891174316, "mean_td_error": 0.07129275053739548, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 12204288, "episodes_total": 122048, "training_iteration": 118, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-37-14", "timestamp": 1569663434, "time_this_iter_s": 30.584258556365967, "time_total_s": 3603.6595084667206, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f09620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3603.6595084667206, "timesteps_since_restore": 12204288, "iterations_since_restore": 118, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 51.99984585752964, "episode_reward_min": 41.9366629558912, "episode_reward_mean": 48.15872620105088, "episode_len_mean": 100.0, "episodes_this_iter": 1112, "policy_reward_mean": {"agent_0": 22.07455908294255, "agent_1": 26.08416711810837}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6833865469851604, "mean_processing_ms": 3.0751526738300297, "mean_inference_ms": 1.9315337410085445}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 358, "num_steps_trained": 18011392, "num_steps_sampled": 12314368, "sample_throughput": 8109.894, "train_throughput": 0.0, "num_weight_syncs": 24051, "num_samples_dropped": 354, "learner_queue": {"size_count": 80769, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.206, "replay_time_ms": 97.344, "update_priorities_time_ms": 57.379, "policy_agent_0": {"added_count": 3056384, "sampled_count": 4633856, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3056384, "sampled_count": 4633856, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.048213005065918, "min_q": 9.746448516845703, "max_q": 10.585306167602539, "mean_td_error": 0.027121197432279587, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.886293411254883, "min_q": 10.53591251373291, "max_q": 11.305607795715332, "mean_td_error": 0.0032832100987434387, "model": {}}}}, "timesteps_this_iter": 110080, "done": false, "timesteps_total": 12314368, "episodes_total": 123160, "training_iteration": 119, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-37-44", "timestamp": 1569663464, "time_this_iter_s": 30.556840419769287, "time_total_s": 3634.21634888649, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f10378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3634.21634888649, "timesteps_since_restore": 12314368, "iterations_since_restore": 119, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.920054407404194, "episode_reward_min": 41.11521956202861, "episode_reward_mean": 46.66060635951531, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 20.159085481984885, "agent_1": 26.50152087753048}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6830624564008811, "mean_processing_ms": 3.0738381021968255, "mean_inference_ms": 1.9310044424437784}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 361, "num_steps_trained": 18163712, "num_steps_sampled": 12421376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24259, "num_samples_dropped": 354, "learner_queue": {"size_count": 81362, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.258, "replay_time_ms": 79.744, "update_priorities_time_ms": 38.293, "policy_agent_0": {"added_count": 3082496, "sampled_count": 4676352, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3082496, "sampled_count": 4676352, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.745708465576172, "min_q": 9.461063385009766, "max_q": 10.438684463500977, "mean_td_error": -0.03032790496945381, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.682215690612793, "min_q": 10.482152938842773, "max_q": 10.853835105895996, "mean_td_error": -0.005261287093162537, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 12421376, "episodes_total": 124224, "training_iteration": 120, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-38-15", "timestamp": 1569663495, "time_this_iter_s": 30.518271684646606, "time_total_s": 3664.7346205711365, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e71f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3664.7346205711365, "timesteps_since_restore": 12421376, "iterations_since_restore": 120, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.05836335536126, "episode_reward_min": 41.27222536432018, "episode_reward_mean": 46.56425897790585, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.60147691545039, "agent_1": 25.962782062455503}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6825145729520389, "mean_processing_ms": 3.0716300883963292, "mean_inference_ms": 1.9296427910598224}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 364, "num_steps_trained": 18310400, "num_steps_sampled": 12531200, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24475, "num_samples_dropped": 354, "learner_queue": {"size_count": 81935, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.482, "replay_time_ms": 69.223, "update_priorities_time_ms": 40.219, "policy_agent_0": {"added_count": 3107584, "sampled_count": 4718848, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3107584, "sampled_count": 4718848, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.27747917175293, "min_q": 9.153627395629883, "max_q": 9.569807052612305, "mean_td_error": -0.018785331398248672, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.626083374023438, "min_q": 10.409136772155762, "max_q": 10.784854888916016, "mean_td_error": -0.02287924662232399, "model": {}}}}, "timesteps_this_iter": 109824, "done": false, "timesteps_total": 12531200, "episodes_total": 125320, "training_iteration": 121, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-38-45", "timestamp": 1569663525, "time_this_iter_s": 30.41736388206482, "time_total_s": 3695.1519844532013, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f8cc80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3695.1519844532013, "timesteps_since_restore": 12531200, "iterations_since_restore": 121, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.099802181978006, "episode_reward_min": 42.495459201519616, "episode_reward_mean": 47.17514036814043, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 21.69543526672966, "agent_1": 25.47970510141082}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.683237103488832, "mean_processing_ms": 3.0735346067680616, "mean_inference_ms": 1.92929557993317}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 367, "num_steps_trained": 18455808, "num_steps_sampled": 12639232, "sample_throughput": 22204.476, "train_throughput": 0.0, "num_weight_syncs": 24685, "num_samples_dropped": 354, "learner_queue": {"size_count": 82503, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.579, "replay_time_ms": 90.557, "update_priorities_time_ms": 56.147, "policy_agent_0": {"added_count": 3135232, "sampled_count": 4758272, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3135232, "sampled_count": 4758272, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.103240013122559, "min_q": 8.944690704345703, "max_q": 9.29971694946289, "mean_td_error": 0.053406573832035065, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.536839485168457, "min_q": 10.25986385345459, "max_q": 10.921272277832031, "mean_td_error": -0.04207606241106987, "model": {}}}}, "timesteps_this_iter": 108032, "done": false, "timesteps_total": 12639232, "episodes_total": 126400, "training_iteration": 122, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-39-16", "timestamp": 1569663556, "time_this_iter_s": 30.62490439414978, "time_total_s": 3725.776888847351, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ef3378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3725.776888847351, "timesteps_since_restore": 12639232, "iterations_since_restore": 122, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 53.596630417860304, "episode_reward_min": 42.549834178530475, "episode_reward_mean": 47.4439690558301, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 23.337555997760962, "agent_1": 24.106413058069172}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6831230894736038, "mean_processing_ms": 3.072984170712799, "mean_inference_ms": 1.9286868095068785}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 370, "num_steps_trained": 18606080, "num_steps_sampled": 12745984, "sample_throughput": 6542.539, "train_throughput": 0.0, "num_weight_syncs": 24893, "num_samples_dropped": 354, "learner_queue": {"size_count": 83090, "size_mean": 0.2, "size_std": 0.4898979485566357, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 26.641, "replay_time_ms": 85.283, "update_priorities_time_ms": 43.108, "policy_agent_0": {"added_count": 3164672, "sampled_count": 4798208, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3164672, "sampled_count": 4798208, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 8.958367347717285, "min_q": 8.785455703735352, "max_q": 9.093152046203613, "mean_td_error": 0.026831921190023422, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.368117332458496, "min_q": 10.00048542022705, "max_q": 10.996232986450195, "mean_td_error": -0.020184170454740524, "model": {}}}}, "timesteps_this_iter": 106752, "done": false, "timesteps_total": 12745984, "episodes_total": 127464, "training_iteration": 123, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-39-46", "timestamp": 1569663586, "time_this_iter_s": 30.388397455215454, "time_total_s": 3756.1652863025665, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f50400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3756.1652863025665, "timesteps_since_restore": 12745984, "iterations_since_restore": 123, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.645217949383635, "episode_reward_min": 42.38754035367696, "episode_reward_mean": 45.39943945897522, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 23.420440375467855, "agent_1": 21.978999083507425}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6825963976493931, "mean_processing_ms": 3.0711315652753517, "mean_inference_ms": 1.9276370151597537}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 373, "num_steps_trained": 18754816, "num_steps_sampled": 12854272, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25105, "num_samples_dropped": 354, "learner_queue": {"size_count": 83671, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.52, "replay_time_ms": 90.198, "update_priorities_time_ms": 47.297, "policy_agent_0": {"added_count": 3194112, "sampled_count": 4840704, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3194112, "sampled_count": 4840704, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 8.945027351379395, "min_q": 8.81782341003418, "max_q": 9.073959350585938, "mean_td_error": -0.043556757271289825, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.095752716064453, "min_q": 9.685420989990234, "max_q": 11.071749687194824, "mean_td_error": 0.006710600107908249, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 12854272, "episodes_total": 128552, "training_iteration": 124, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-40-17", "timestamp": 1569663617, "time_this_iter_s": 30.395561695098877, "time_total_s": 3786.5608479976654, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5c0a8c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3786.5608479976654, "timesteps_since_restore": 12854272, "iterations_since_restore": 124, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 50.849187877188115, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 43.398436495238464, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 23.04142244681114, "agent_1": 20.357014048427423}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6824500365895153, "mean_processing_ms": 3.0716382603401167, "mean_inference_ms": 1.9286833920434423}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 376, "num_steps_trained": 18893056, "num_steps_sampled": 12953856, "sample_throughput": 14645.196, "train_throughput": 0.0, "num_weight_syncs": 25299, "num_samples_dropped": 354, "learner_queue": {"size_count": 84212, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.928, "replay_time_ms": 107.518, "update_priorities_time_ms": 55.945, "policy_agent_0": {"added_count": 3222016, "sampled_count": 4875520, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3222016, "sampled_count": 4875520, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.011802673339844, "min_q": 8.86302661895752, "max_q": 9.13811206817627, "mean_td_error": -0.019562900066375732, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.659961700439453, "min_q": 9.239147186279297, "max_q": 10.668083190917969, "mean_td_error": -0.0018936805427074432, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 12953856, "episodes_total": 129552, "training_iteration": 125, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-40-47", "timestamp": 1569663647, "time_this_iter_s": 30.537875175476074, "time_total_s": 3817.0987231731415, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5c0f510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3817.0987231731415, "timesteps_since_restore": 12953856, "iterations_since_restore": 125, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 50.47511871985769, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 43.056632913295246, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 21.40410842317466, "agent_1": 21.65252449012069}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6821499543430539, "mean_processing_ms": 3.0720011247055785, "mean_inference_ms": 1.9298065366939867}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 379, "num_steps_trained": 19032832, "num_steps_sampled": 13051904, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25491, "num_samples_dropped": 354, "learner_queue": {"size_count": 84757, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 45.977, "replay_time_ms": 91.729, "update_priorities_time_ms": 60.611, "policy_agent_0": {"added_count": 3244800, "sampled_count": 4911360, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3244800, "sampled_count": 4911360, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 8.919142723083496, "min_q": 8.828695297241211, "max_q": 9.173134803771973, "mean_td_error": 0.051780834794044495, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.304506301879883, "min_q": 9.090889930725098, "max_q": 10.725282669067383, "mean_td_error": 0.03626314923167229, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 13051904, "episodes_total": 130520, "training_iteration": 126, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-41-18", "timestamp": 1569663678, "time_this_iter_s": 30.583678722381592, "time_total_s": 3847.682401895523, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bed9d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3847.682401895523, "timesteps_since_restore": 13051904, "iterations_since_restore": 126, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 49.59483040768623, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 43.600209488195325, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 23.31388258217932, "agent_1": 20.286326906016107}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6825736034778437, "mean_processing_ms": 3.073682962956931, "mean_inference_ms": 1.930551653661004}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 382, "num_steps_trained": 19176448, "num_steps_sampled": 13153024, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25688, "num_samples_dropped": 354, "learner_queue": {"size_count": 85318, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.706, "replay_time_ms": 86.304, "update_priorities_time_ms": 48.041, "policy_agent_0": {"added_count": 3271168, "sampled_count": 4951296, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3271168, "sampled_count": 4951296, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 8.947813987731934, "min_q": 8.803247451782227, "max_q": 9.330974578857422, "mean_td_error": 0.007350914180278778, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.002058029174805, "min_q": 8.779448509216309, "max_q": 9.269076347351074, "mean_td_error": 0.010364409536123276, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 13153024, "episodes_total": 131536, "training_iteration": 127, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-41-48", "timestamp": 1569663708, "time_this_iter_s": 30.540947914123535, "time_total_s": 3878.2233498096466, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5be4620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3878.2233498096466, "timesteps_since_restore": 13153024, "iterations_since_restore": 127, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 53.26977712990728, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 44.872104443508114, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 21.38771273973759, "agent_1": 23.484391703770573}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828311743970653, "mean_processing_ms": 3.074460642685868, "mean_inference_ms": 1.9302955128927521}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 385, "num_steps_trained": 19330560, "num_steps_sampled": 13258752, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25895, "num_samples_dropped": 354, "learner_queue": {"size_count": 85920, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.075, "replay_time_ms": 102.143, "update_priorities_time_ms": 51.521, "policy_agent_0": {"added_count": 3294720, "sampled_count": 4995072, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3294720, "sampled_count": 4995072, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 8.803934097290039, "min_q": 8.585138320922852, "max_q": 9.441400527954102, "mean_td_error": 0.017034374177455902, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 8.991323471069336, "min_q": 8.819915771484375, "max_q": 10.035656929016113, "mean_td_error": 0.04635988920927048, "model": {}}}}, "timesteps_this_iter": 105728, "done": false, "timesteps_total": 13258752, "episodes_total": 132592, "training_iteration": 128, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-42-19", "timestamp": 1569663739, "time_this_iter_s": 30.54147696495056, "time_total_s": 3908.764826774597, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5b94ae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3908.764826774597, "timesteps_since_restore": 13258752, "iterations_since_restore": 128, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.56647262090386, "episode_reward_min": 44.64205313534076, "episode_reward_mean": 50.92884740552026, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 23.95629499155556, "agent_1": 26.97255241396468}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6824169303628705, "mean_processing_ms": 3.0727825718595256, "mean_inference_ms": 1.9302319128284997}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 388, "num_steps_trained": 19485440, "num_steps_sampled": 13364224, "sample_throughput": 0.0, "train_throughput": 15827.562, "num_weight_syncs": 26101, "num_samples_dropped": 354, "learner_queue": {"size_count": 86525, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.727, "replay_time_ms": 78.317, "update_priorities_time_ms": 46.597, "policy_agent_0": {"added_count": 3323136, "sampled_count": 5036288, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3323136, "sampled_count": 5036288, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 8.95395565032959, "min_q": 8.6529541015625, "max_q": 9.471803665161133, "mean_td_error": -0.009418182075023651, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.334158897399902, "min_q": 8.817187309265137, "max_q": 10.042525291442871, "mean_td_error": 0.025039982050657272, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 13364224, "episodes_total": 133648, "training_iteration": 129, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-42-50", "timestamp": 1569663770, "time_this_iter_s": 30.488107442855835, "time_total_s": 3939.252934217453, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ba7730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3939.252934217453, "timesteps_since_restore": 13364224, "iterations_since_restore": 129, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 49.96284338357728, "episode_reward_min": 45.48242430670611, "episode_reward_mean": 48.83287652019004, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 25.54158665204558, "agent_1": 23.29128986814438}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6824076799328993, "mean_processing_ms": 3.0722907033829516, "mean_inference_ms": 1.929422561763107}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 391, "num_steps_trained": 19636480, "num_steps_sampled": 13472000, "sample_throughput": 0.0, "train_throughput": 11235.37, "num_weight_syncs": 26312, "num_samples_dropped": 354, "learner_queue": {"size_count": 87115, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.462, "replay_time_ms": 90.756, "update_priorities_time_ms": 46.487, "policy_agent_0": {"added_count": 3347456, "sampled_count": 5077504, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3347456, "sampled_count": 5077504, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.068926811218262, "min_q": 8.762039184570312, "max_q": 9.72726058959961, "mean_td_error": -0.003228612244129181, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.52180290222168, "min_q": 8.832306861877441, "max_q": 10.161837577819824, "mean_td_error": -0.011521168053150177, "model": {}}}}, "timesteps_this_iter": 107776, "done": false, "timesteps_total": 13472000, "episodes_total": 134728, "training_iteration": 130, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-43-20", "timestamp": 1569663800, "time_this_iter_s": 30.56833529472351, "time_total_s": 3969.8212695121765, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5babbf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3969.8212695121765, "timesteps_since_restore": 13472000, "iterations_since_restore": 130, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 52.09065489317089, "episode_reward_min": 42.38754035367696, "episode_reward_mean": 47.52811950534248, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 25.22292498623089, "agent_1": 22.305194519111602}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828297991478025, "mean_processing_ms": 3.07306158768533, "mean_inference_ms": 1.9293230102693748}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 394, "num_steps_trained": 19789312, "num_steps_sampled": 13577728, "sample_throughput": 0.0, "train_throughput": 12296.631, "num_weight_syncs": 26518, "num_samples_dropped": 354, "learner_queue": {"size_count": 87712, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.26, "replay_time_ms": 79.799, "update_priorities_time_ms": 43.875, "policy_agent_0": {"added_count": 3374080, "sampled_count": 5116416, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3374080, "sampled_count": 5116416, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.277048110961914, "min_q": 9.057291030883789, "max_q": 9.442771911621094, "mean_td_error": 0.035664018243551254, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.494463920593262, "min_q": 9.094582557678223, "max_q": 10.295604705810547, "mean_td_error": 0.026354044675827026, "model": {}}}}, "timesteps_this_iter": 105728, "done": false, "timesteps_total": 13577728, "episodes_total": 135784, "training_iteration": 131, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-43-51", "timestamp": 1569663831, "time_this_iter_s": 30.520766496658325, "time_total_s": 4000.342036008835, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bedb70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4000.342036008835, "timesteps_since_restore": 13577728, "iterations_since_restore": 131, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 52.7857533226607, "episode_reward_min": 45.26347931282806, "episode_reward_mean": 47.774593841327544, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 26.202111009059752, "agent_1": 21.57248283226774}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6820072850313377, "mean_processing_ms": 3.0710265583627225, "mean_inference_ms": 1.9285794701284924}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 397, "num_steps_trained": 19936000, "num_steps_sampled": 13685760, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26729, "num_samples_dropped": 354, "learner_queue": {"size_count": 88285, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.193, "replay_time_ms": 91.297, "update_priorities_time_ms": 49.824, "policy_agent_0": {"added_count": 3399424, "sampled_count": 5155840, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3399424, "sampled_count": 5155840, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.396841049194336, "min_q": 9.158580780029297, "max_q": 9.681208610534668, "mean_td_error": 0.03328651934862137, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.224658966064453, "min_q": 8.908903121948242, "max_q": 9.565166473388672, "mean_td_error": 0.009423352777957916, "model": {}}}}, "timesteps_this_iter": 108032, "done": false, "timesteps_total": 13685760, "episodes_total": 136864, "training_iteration": 132, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-44-21", "timestamp": 1569663861, "time_this_iter_s": 30.5519061088562, "time_total_s": 4030.893942117691, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5c0f048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4030.893942117691, "timesteps_since_restore": 13685760, "iterations_since_restore": 132, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 52.70469866135371, "episode_reward_min": 41.32145439550449, "episode_reward_mean": 47.544450686347716, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 24.291442622215527, "agent_1": 23.253008064132164}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6821408814178878, "mean_processing_ms": 3.0708330599297575, "mean_inference_ms": 1.9276540834091218}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 400, "num_steps_trained": 20088064, "num_steps_sampled": 13793280, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26939, "num_samples_dropped": 354, "learner_queue": {"size_count": 88879, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 28.5, "replay_time_ms": 82.072, "update_priorities_time_ms": 49.127, "policy_agent_0": {"added_count": 3426304, "sampled_count": 5199616, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3426304, "sampled_count": 5199616, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.343509674072266, "min_q": 9.01279067993164, "max_q": 9.808809280395508, "mean_td_error": -0.10205108672380447, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.129642486572266, "min_q": 8.750908851623535, "max_q": 9.543059349060059, "mean_td_error": -0.013300087302923203, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 13793280, "episodes_total": 137936, "training_iteration": 133, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-44-52", "timestamp": 1569663892, "time_this_iter_s": 30.62911820411682, "time_total_s": 4061.523060321808, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e8b268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4061.523060321808, "timesteps_since_restore": 13793280, "iterations_since_restore": 133, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 50.83306849467395, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 47.150765628199544, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 24.15658129367239, "agent_1": 22.99418433452711}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681345382645598, "mean_processing_ms": 3.068943979253593, "mean_inference_ms": 1.926694052791096}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 403, "num_steps_trained": 20236288, "num_steps_sampled": 13902080, "sample_throughput": 10468.279, "train_throughput": 0.0, "num_weight_syncs": 27151, "num_samples_dropped": 354, "learner_queue": {"size_count": 89458, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.927, "replay_time_ms": 97.381, "update_priorities_time_ms": 51.632, "policy_agent_0": {"added_count": 3452160, "sampled_count": 5241088, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3452160, "sampled_count": 5241088, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.47653579711914, "min_q": 9.222336769104004, "max_q": 10.03400707244873, "mean_td_error": 0.06186414510011673, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 8.99337100982666, "min_q": 8.625335693359375, "max_q": 9.60111141204834, "mean_td_error": 0.018160682171583176, "model": {}}}}, "timesteps_this_iter": 108800, "done": false, "timesteps_total": 13902080, "episodes_total": 139024, "training_iteration": 134, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-45-22", "timestamp": 1569663922, "time_this_iter_s": 30.561912536621094, "time_total_s": 4092.084972858429, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f8c7b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4092.084972858429, "timesteps_since_restore": 13902080, "iterations_since_restore": 134, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.22904121846219, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 47.72638088450901, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 23.84423676596463, "agent_1": 23.882144118544353}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6821923200978272, "mean_processing_ms": 3.0711313707230468, "mean_inference_ms": 1.9272840879812843}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 406, "num_steps_trained": 20389888, "num_steps_sampled": 14006784, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27356, "num_samples_dropped": 354, "learner_queue": {"size_count": 90058, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.401, "replay_time_ms": 94.987, "update_priorities_time_ms": 49.642, "policy_agent_0": {"added_count": 3472896, "sampled_count": 5283328, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3472896, "sampled_count": 5283328, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.31879997253418, "min_q": 9.13487720489502, "max_q": 9.894240379333496, "mean_td_error": 0.043717727065086365, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.038593292236328, "min_q": 8.651820182800293, "max_q": 9.65942668914795, "mean_td_error": 0.0022658929228782654, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 14006784, "episodes_total": 140072, "training_iteration": 135, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-45-53", "timestamp": 1569663953, "time_this_iter_s": 30.588693618774414, "time_total_s": 4122.673666477203, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f10b70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4122.673666477203, "timesteps_since_restore": 14006784, "iterations_since_restore": 135, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 52.520657202064896, "episode_reward_min": 46.798282314584846, "episode_reward_mean": 50.65340779782847, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 24.672596487794053, "agent_1": 25.98081131003437}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814853824357142, "mean_processing_ms": 3.0686582940741705, "mean_inference_ms": 1.9265535711605788}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 409, "num_steps_trained": 20538880, "num_steps_sampled": 14115840, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27570, "num_samples_dropped": 354, "learner_queue": {"size_count": 90641, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.406, "replay_time_ms": 93.22, "update_priorities_time_ms": 50.264, "policy_agent_0": {"added_count": 3499008, "sampled_count": 5321984, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3499008, "sampled_count": 5321984, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.266990661621094, "min_q": 9.016755104064941, "max_q": 9.628666877746582, "mean_td_error": 0.07275257259607315, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.098560333251953, "min_q": 8.711965560913086, "max_q": 9.599045753479004, "mean_td_error": -0.04525240510702133, "model": {}}}}, "timesteps_this_iter": 109056, "done": false, "timesteps_total": 14115840, "episodes_total": 141168, "training_iteration": 136, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-46-24", "timestamp": 1569663984, "time_this_iter_s": 30.48962140083313, "time_total_s": 4153.1632878780365, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f09b70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4153.1632878780365, "timesteps_since_restore": 14115840, "iterations_since_restore": 136, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 53.13895314050074, "episode_reward_min": 43.598372367310304, "episode_reward_mean": 50.57550165219671, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 25.21222418592289, "agent_1": 25.3632774662739}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814177011331689, "mean_processing_ms": 3.0680839814537166, "mean_inference_ms": 1.9254524434165272}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 412, "num_steps_trained": 20690432, "num_steps_sampled": 14222080, "sample_throughput": 5082.585, "train_throughput": 5082.585, "num_weight_syncs": 27777, "num_samples_dropped": 354, "learner_queue": {"size_count": 91232, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.429, "replay_time_ms": 87.185, "update_priorities_time_ms": 50.713, "policy_agent_0": {"added_count": 3527680, "sampled_count": 5361152, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3527680, "sampled_count": 5361152, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.35805892944336, "min_q": 9.194815635681152, "max_q": 9.628450393676758, "mean_td_error": 0.05075846239924431, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.309930801391602, "min_q": 8.899170875549316, "max_q": 9.796523094177246, "mean_td_error": 0.001991778612136841, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 14222080, "episodes_total": 142232, "training_iteration": 137, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-46-54", "timestamp": 1569664014, "time_this_iter_s": 30.56602191925049, "time_total_s": 4183.729309797287, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5efe048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4183.729309797287, "timesteps_since_restore": 14222080, "iterations_since_restore": 137, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 53.051551169504705, "episode_reward_min": 43.59318953044251, "episode_reward_mean": 50.28213346488014, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 24.842211968212077, "agent_1": 25.439921496668045}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6810597136329668, "mean_processing_ms": 3.0665113721917328, "mean_inference_ms": 1.9247638741278434}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 415, "num_steps_trained": 20841472, "num_steps_sampled": 14327040, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27981, "num_samples_dropped": 354, "learner_queue": {"size_count": 91822, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.86, "replay_time_ms": 63.881, "update_priorities_time_ms": 35.409, "policy_agent_0": {"added_count": 3552512, "sampled_count": 5400064, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3552512, "sampled_count": 5400064, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.448972702026367, "min_q": 9.240015983581543, "max_q": 9.603872299194336, "mean_td_error": 0.02929633855819702, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.39472484588623, "min_q": 8.96137809753418, "max_q": 9.65351390838623, "mean_td_error": 0.011876028031110764, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 14327040, "episodes_total": 143280, "training_iteration": 138, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-47-25", "timestamp": 1569664045, "time_this_iter_s": 30.48840045928955, "time_total_s": 4214.2177102565765, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c67f3620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4214.2177102565765, "timesteps_since_restore": 14327040, "iterations_since_restore": 138, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.287332916893455, "episode_reward_min": 43.73795888606661, "episode_reward_mean": 50.54501491143717, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 24.755110396954024, "agent_1": 25.78990451448311}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6820772132362685, "mean_processing_ms": 3.0689369019603925, "mean_inference_ms": 1.9246443280815568}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 418, "num_steps_trained": 20992000, "num_steps_sampled": 14433280, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28189, "num_samples_dropped": 354, "learner_queue": {"size_count": 92410, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.234, "replay_time_ms": 91.807, "update_priorities_time_ms": 48.989, "policy_agent_0": {"added_count": 3580160, "sampled_count": 5440256, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3580160, "sampled_count": 5440256, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.480561256408691, "min_q": 9.3073148727417, "max_q": 9.678009986877441, "mean_td_error": 0.03186314180493355, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.480955123901367, "min_q": 9.03818416595459, "max_q": 9.741230010986328, "mean_td_error": 0.02725471928715706, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 14433280, "episodes_total": 144336, "training_iteration": 139, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-47-55", "timestamp": 1569664075, "time_this_iter_s": 30.408286333084106, "time_total_s": 4244.625996589661, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c6809ae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4244.625996589661, "timesteps_since_restore": 14433280, "iterations_since_restore": 139, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.12997889929024, "episode_reward_min": 46.427096092643254, "episode_reward_mean": 52.69078665218327, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 26.279607325057892, "agent_1": 26.41117932712546}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814907456883749, "mean_processing_ms": 3.0676227878000724, "mean_inference_ms": 1.9241907194738255}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 421, "num_steps_trained": 21141504, "num_steps_sampled": 14540800, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28398, "num_samples_dropped": 354, "learner_queue": {"size_count": 92994, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.723, "replay_time_ms": 103.886, "update_priorities_time_ms": 58.059, "policy_agent_0": {"added_count": 3607040, "sampled_count": 5480192, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3607040, "sampled_count": 5480192, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.428605079650879, "min_q": 9.250471115112305, "max_q": 9.638837814331055, "mean_td_error": 0.01780068874359131, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.568958282470703, "min_q": 9.130741119384766, "max_q": 9.791891098022461, "mean_td_error": 0.00399056077003479, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 14540800, "episodes_total": 145416, "training_iteration": 140, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-48-26", "timestamp": 1569664106, "time_this_iter_s": 30.55363392829895, "time_total_s": 4275.17963051796, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f229d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4275.17963051796, "timesteps_since_restore": 14540800, "iterations_since_restore": 140, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.712264548586305, "episode_reward_min": 52.376211710195065, "episode_reward_mean": 54.13278132318696, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 26.143041590644525, "agent_1": 27.989739732542528}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814637739843419, "mean_processing_ms": 3.0669970871291254, "mean_inference_ms": 1.9232397994276298}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 424, "num_steps_trained": 21287936, "num_steps_sampled": 14651392, "sample_throughput": 0.0, "train_throughput": 13888.424, "num_weight_syncs": 28616, "num_samples_dropped": 354, "learner_queue": {"size_count": 93566, "size_mean": 0.2, "size_std": 0.447213595499958, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.18, "replay_time_ms": 101.606, "update_priorities_time_ms": 54.199, "policy_agent_0": {"added_count": 3633152, "sampled_count": 5519616, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3633152, "sampled_count": 5519616, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.545727729797363, "min_q": 9.277325630187988, "max_q": 9.826559066772461, "mean_td_error": -0.003456398844718933, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.752147674560547, "min_q": 9.392908096313477, "max_q": 9.916974067687988, "mean_td_error": -0.009511515498161316, "model": {}}}}, "timesteps_this_iter": 110592, "done": false, "timesteps_total": 14651392, "episodes_total": 146520, "training_iteration": 141, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-48-56", "timestamp": 1569664136, "time_this_iter_s": 30.580748081207275, "time_total_s": 4305.760378599167, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f31620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4305.760378599167, "timesteps_since_restore": 14651392, "iterations_since_restore": 141, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 56.32084720311439, "episode_reward_min": 46.967868590828225, "episode_reward_mean": 51.08526383199626, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 25.001979942482762, "agent_1": 26.0832838895135}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681061940055617, "mean_processing_ms": 3.0661943499388977, "mean_inference_ms": 1.922973831472906}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 427, "num_steps_trained": 21442560, "num_steps_sampled": 14757632, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28823, "num_samples_dropped": 354, "learner_queue": {"size_count": 94170, "size_mean": 0.16, "size_std": 0.463033476111609, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.654, "replay_time_ms": 94.766, "update_priorities_time_ms": 47.611, "policy_agent_0": {"added_count": 3658496, "sampled_count": 5558784, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3658496, "sampled_count": 5558784, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.688438415527344, "min_q": 9.304831504821777, "max_q": 10.051888465881348, "mean_td_error": 0.055248234421014786, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.810664176940918, "min_q": 9.465603828430176, "max_q": 9.988557815551758, "mean_td_error": -0.0018825046718120575, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 14757632, "episodes_total": 147592, "training_iteration": 142, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-49-27", "timestamp": 1569664167, "time_this_iter_s": 30.497055768966675, "time_total_s": 4336.2574343681335, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ec2e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4336.2574343681335, "timesteps_since_restore": 14757632, "iterations_since_restore": 142, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.44992825728292, "episode_reward_min": 43.72218480925688, "episode_reward_mean": 48.96436694972525, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 25.734158357161853, "agent_1": 23.23020859256339}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6808132769583709, "mean_processing_ms": 3.0650638944659354, "mean_inference_ms": 1.9230867858844523}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 430, "num_steps_trained": 21595648, "num_steps_sampled": 14864896, "sample_throughput": 0.0, "train_throughput": 12536.683, "num_weight_syncs": 29032, "num_samples_dropped": 354, "learner_queue": {"size_count": 94768, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.714, "replay_time_ms": 68.616, "update_priorities_time_ms": 42.583, "policy_agent_0": {"added_count": 3689472, "sampled_count": 5602048, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3689472, "sampled_count": 5602048, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.777093887329102, "min_q": 9.550440788269043, "max_q": 10.170903205871582, "mean_td_error": 0.018576771020889282, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.788494110107422, "min_q": 9.458327293395996, "max_q": 10.009771347045898, "mean_td_error": -0.00862894207239151, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 14864896, "episodes_total": 148648, "training_iteration": 143, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-49-57", "timestamp": 1569664197, "time_this_iter_s": 30.44988751411438, "time_total_s": 4366.707321882248, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ec52f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4366.707321882248, "timesteps_since_restore": 14864896, "iterations_since_restore": 143, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.72577428989286, "episode_reward_min": 47.4556205984424, "episode_reward_mean": 49.451593575570364, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 24.608186054517766, "agent_1": 24.843407521052566}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681269134224064, "mean_processing_ms": 3.0657711423931797, "mean_inference_ms": 1.9225424999601386}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 433, "num_steps_trained": 21745920, "num_steps_sampled": 14971904, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29241, "num_samples_dropped": 354, "learner_queue": {"size_count": 95355, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.701, "replay_time_ms": 102.022, "update_priorities_time_ms": 52.395, "policy_agent_0": {"added_count": 3717376, "sampled_count": 5641216, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3717376, "sampled_count": 5641216, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.797325134277344, "min_q": 9.605766296386719, "max_q": 10.188040733337402, "mean_td_error": 0.021997112780809402, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.635185241699219, "min_q": 9.365142822265625, "max_q": 10.006887435913086, "mean_td_error": -0.041393931955099106, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 14971904, "episodes_total": 149728, "training_iteration": 144, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-50-28", "timestamp": 1569664228, "time_this_iter_s": 30.44696354866028, "time_total_s": 4397.154285430908, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e7d950>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4397.154285430908, "timesteps_since_restore": 14971904, "iterations_since_restore": 144, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.84365157999521, "episode_reward_min": 46.784988868306165, "episode_reward_mean": 52.19397514701533, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 25.68948625841561, "agent_1": 26.504488888599752}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814169565169964, "mean_processing_ms": 3.06635125451713, "mean_inference_ms": 1.9223023353529438}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 436, "num_steps_trained": 21896192, "num_steps_sampled": 15078912, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29449, "num_samples_dropped": 354, "learner_queue": {"size_count": 95942, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.382, "replay_time_ms": 72.274, "update_priorities_time_ms": 44.489, "policy_agent_0": {"added_count": 3742976, "sampled_count": 5681920, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3742976, "sampled_count": 5681920, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.889979362487793, "min_q": 9.625186920166016, "max_q": 10.225529670715332, "mean_td_error": 0.02795637771487236, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.808674812316895, "min_q": 9.42074966430664, "max_q": 10.011467933654785, "mean_td_error": 0.03246340900659561, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 15078912, "episodes_total": 150800, "training_iteration": 145, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-50-58", "timestamp": 1569664258, "time_this_iter_s": 30.495394229888916, "time_total_s": 4427.649679660797, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f9f158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4427.649679660797, "timesteps_since_restore": 15078912, "iterations_since_restore": 145, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.89262980440199, "episode_reward_min": 51.482818186330014, "episode_reward_mean": 54.517040113909665, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 26.685125801833063, "agent_1": 27.831914312076616}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6807738947331928, "mean_processing_ms": 3.0640400286247114, "mean_inference_ms": 1.9214269413689746}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 439, "num_steps_trained": 22047232, "num_steps_sampled": 15185920, "sample_throughput": 3737.64, "train_throughput": 11212.921, "num_weight_syncs": 29659, "num_samples_dropped": 354, "learner_queue": {"size_count": 96532, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.051, "replay_time_ms": 99.473, "update_priorities_time_ms": 51.974, "policy_agent_0": {"added_count": 3768320, "sampled_count": 5719808, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3768320, "sampled_count": 5719808, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.021589279174805, "min_q": 9.694976806640625, "max_q": 10.173379898071289, "mean_td_error": 0.07199668139219284, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.960644721984863, "min_q": 9.617069244384766, "max_q": 10.075390815734863, "mean_td_error": -0.02556779235601425, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 15185920, "episodes_total": 151864, "training_iteration": 146, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-51-29", "timestamp": 1569664289, "time_this_iter_s": 30.653874397277832, "time_total_s": 4458.303554058075, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5be8048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4458.303554058075, "timesteps_since_restore": 15185920, "iterations_since_restore": 146, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.86804171356001, "episode_reward_min": 49.532758279316845, "episode_reward_mean": 54.880915864583116, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 27.312484080067946, "agent_1": 27.568431784515173}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6809188089638639, "mean_processing_ms": 3.0643898930151474, "mean_inference_ms": 1.9206675945710088}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 442, "num_steps_trained": 22195456, "num_steps_sampled": 15293952, "sample_throughput": 5501.431, "train_throughput": 5501.431, "num_weight_syncs": 29870, "num_samples_dropped": 354, "learner_queue": {"size_count": 97112, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.156, "replay_time_ms": 108.878, "update_priorities_time_ms": 48.525, "policy_agent_0": {"added_count": 3791872, "sampled_count": 5759488, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3791872, "sampled_count": 5759488, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.000805854797363, "min_q": 9.768865585327148, "max_q": 10.069727897644043, "mean_td_error": -0.009965114295482635, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.123555183410645, "min_q": 9.779890060424805, "max_q": 10.239238739013672, "mean_td_error": 0.03142089396715164, "model": {}}}}, "timesteps_this_iter": 108032, "done": false, "timesteps_total": 15293952, "episodes_total": 152944, "training_iteration": 147, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-52-00", "timestamp": 1569664320, "time_this_iter_s": 30.643842458724976, "time_total_s": 4488.9473965168, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5be1048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4488.9473965168, "timesteps_since_restore": 15293952, "iterations_since_restore": 147, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.705917197415, "episode_reward_min": 52.157187708164564, "episode_reward_mean": 53.7119933432008, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 25.240176919949818, "agent_1": 28.47181642325098}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814442885611898, "mean_processing_ms": 3.064922834926445, "mean_inference_ms": 1.920312500620408}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 445, "num_steps_trained": 22349056, "num_steps_sampled": 15400448, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30078, "num_samples_dropped": 354, "learner_queue": {"size_count": 97711, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.869, "replay_time_ms": 87.303, "update_priorities_time_ms": 49.399, "policy_agent_0": {"added_count": 3814656, "sampled_count": 5801984, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3814656, "sampled_count": 5801984, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.037577629089355, "min_q": 9.769177436828613, "max_q": 10.114107131958008, "mean_td_error": -0.003081291913986206, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.233159065246582, "min_q": 10.10689926147461, "max_q": 10.292115211486816, "mean_td_error": -0.014412295073270798, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 15400448, "episodes_total": 154008, "training_iteration": 148, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-52-30", "timestamp": 1569664350, "time_this_iter_s": 30.492995262145996, "time_total_s": 4519.440391778946, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bf81e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4519.440391778946, "timesteps_since_restore": 15400448, "iterations_since_restore": 148, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.328103336227414, "episode_reward_min": 52.256769018530036, "episode_reward_mean": 52.72849885056245, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 24.128776024930925, "agent_1": 28.5997228256316}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6816338836773912, "mean_processing_ms": 3.0650644888669802, "mean_inference_ms": 1.9196974541975842}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 448, "num_steps_trained": 22501888, "num_steps_sampled": 15507200, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30286, "num_samples_dropped": 354, "learner_queue": {"size_count": 98308, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.181, "replay_time_ms": 76.52, "update_priorities_time_ms": 39.161, "policy_agent_0": {"added_count": 3841024, "sampled_count": 5844992, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3841024, "sampled_count": 5844992, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.920300483703613, "min_q": 9.641425132751465, "max_q": 10.123493194580078, "mean_td_error": 0.025392893701791763, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.455268859863281, "min_q": 10.32227611541748, "max_q": 10.691248893737793, "mean_td_error": 0.011002380400896072, "model": {}}}}, "timesteps_this_iter": 106752, "done": false, "timesteps_total": 15507200, "episodes_total": 155072, "training_iteration": 149, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-53-01", "timestamp": 1569664381, "time_this_iter_s": 30.44251036643982, "time_total_s": 4549.882902145386, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f506a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4549.882902145386, "timesteps_since_restore": 15507200, "iterations_since_restore": 149, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.641426253533545, "episode_reward_min": 47.18122702038977, "episode_reward_mean": 52.35762237529341, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 24.128336662761175, "agent_1": 28.229285712532324}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6812020223041195, "mean_processing_ms": 3.0636914361847394, "mean_inference_ms": 1.9192328251586837}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 451, "num_steps_trained": 22653440, "num_steps_sampled": 15613696, "sample_throughput": 7690.569, "train_throughput": 0.0, "num_weight_syncs": 30494, "num_samples_dropped": 354, "learner_queue": {"size_count": 98900, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.322, "replay_time_ms": 88.051, "update_priorities_time_ms": 52.49, "policy_agent_0": {"added_count": 3868416, "sampled_count": 5885696, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3868416, "sampled_count": 5885696, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.751736640930176, "min_q": 9.634928703308105, "max_q": 10.114351272583008, "mean_td_error": 0.04622306674718857, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.504137992858887, "min_q": 10.329190254211426, "max_q": 10.680431365966797, "mean_td_error": -0.003907047212123871, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 15613696, "episodes_total": 156144, "training_iteration": 150, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-53-31", "timestamp": 1569664411, "time_this_iter_s": 30.5482759475708, "time_total_s": 4580.4311780929565, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5c0ab70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4580.4311780929565, "timesteps_since_restore": 15613696, "iterations_since_restore": 150, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 52.903179396461404, "episode_reward_min": 46.773079675027724, "episode_reward_mean": 48.21956092000451, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 25.07417296155763, "agent_1": 23.145387958446847}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6819895462590233, "mean_processing_ms": 3.0662080071884974, "mean_inference_ms": 1.9193172885126708}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 454, "num_steps_trained": 22804992, "num_steps_sampled": 15718656, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30700, "num_samples_dropped": 354, "learner_queue": {"size_count": 99492, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.682, "replay_time_ms": 104.432, "update_priorities_time_ms": 55.333, "policy_agent_0": {"added_count": 3897344, "sampled_count": 5925888, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3897344, "sampled_count": 5925888, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.596097946166992, "min_q": 9.490222930908203, "max_q": 9.80359172821045, "mean_td_error": 0.02075374126434326, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.366434097290039, "min_q": 10.05141830444336, "max_q": 10.579103469848633, "mean_td_error": 0.002627100795507431, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 15718656, "episodes_total": 157192, "training_iteration": 151, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-54-02", "timestamp": 1569664442, "time_this_iter_s": 30.42978549003601, "time_total_s": 4610.860963582993, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bbf7b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4610.860963582993, "timesteps_since_restore": 15718656, "iterations_since_restore": 151, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 51.7329608696306, "episode_reward_min": 46.765632327181635, "episode_reward_mean": 48.20618869930715, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 25.346896069094548, "agent_1": 22.859292630212536}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681082756574127, "mean_processing_ms": 3.0626738317203155, "mean_inference_ms": 1.9180905959507093}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 457, "num_steps_trained": 22949120, "num_steps_sampled": 15828480, "sample_throughput": 8544.75, "train_throughput": 0.0, "num_weight_syncs": 30915, "num_samples_dropped": 354, "learner_queue": {"size_count": 100055, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.831, "replay_time_ms": 67.241, "update_priorities_time_ms": 37.11, "policy_agent_0": {"added_count": 3923456, "sampled_count": 5963008, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3923456, "sampled_count": 5963008, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.557364463806152, "min_q": 9.46166706085205, "max_q": 9.686668395996094, "mean_td_error": 0.017389174550771713, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.105714797973633, "min_q": 9.693656921386719, "max_q": 10.540600776672363, "mean_td_error": 0.009516105055809021, "model": {}}}}, "timesteps_this_iter": 109824, "done": false, "timesteps_total": 15828480, "episodes_total": 158288, "training_iteration": 152, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-54-32", "timestamp": 1569664472, "time_this_iter_s": 30.464553594589233, "time_total_s": 4641.325517177582, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5baec80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4641.325517177582, "timesteps_since_restore": 15828480, "iterations_since_restore": 152, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 51.76759399782021, "episode_reward_min": 46.88639534553838, "episode_reward_mean": 50.14197711258526, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 26.136173735457426, "agent_1": 24.00580337712777}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6810491203332774, "mean_processing_ms": 3.0626435444501747, "mean_inference_ms": 1.9182272089185275}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 460, "num_steps_trained": 23106560, "num_steps_sampled": 15933696, "sample_throughput": 6976.427, "train_throughput": 0.0, "num_weight_syncs": 31119, "num_samples_dropped": 354, "learner_queue": {"size_count": 100670, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 47.036, "replay_time_ms": 102.258, "update_priorities_time_ms": 48.426, "policy_agent_0": {"added_count": 3952640, "sampled_count": 6005248, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3952640, "sampled_count": 6005248, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.531434059143066, "min_q": 9.412588119506836, "max_q": 9.77381706237793, "mean_td_error": -0.04689518362283707, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.811164855957031, "min_q": 9.447346687316895, "max_q": 10.2868013381958, "mean_td_error": 0.018107734620571136, "model": {}}}}, "timesteps_this_iter": 105216, "done": false, "timesteps_total": 15933696, "episodes_total": 159336, "training_iteration": 153, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-55-03", "timestamp": 1569664503, "time_this_iter_s": 30.49683403968811, "time_total_s": 4671.82235121727, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bc78c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4671.82235121727, "timesteps_since_restore": 15933696, "iterations_since_restore": 153, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 51.832054761183436, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 47.53613113930848, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 24.857100090134818, "agent_1": 22.679031049173666}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6812895800198475, "mean_processing_ms": 3.063354838533159, "mean_inference_ms": 1.9176409383213904}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 463, "num_steps_trained": 23255040, "num_steps_sampled": 16041984, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31331, "num_samples_dropped": 354, "learner_queue": {"size_count": 101250, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.662, "replay_time_ms": 99.178, "update_priorities_time_ms": 49.042, "policy_agent_0": {"added_count": 3981568, "sampled_count": 6046208, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 3981568, "sampled_count": 6046208, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.565194129943848, "min_q": 9.272177696228027, "max_q": 9.782891273498535, "mean_td_error": -0.014529280364513397, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.586250305175781, "min_q": 9.280841827392578, "max_q": 9.821757316589355, "mean_td_error": -0.0009097494184970856, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 16041984, "episodes_total": 160424, "training_iteration": 154, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-55-33", "timestamp": 1569664533, "time_this_iter_s": 30.616873025894165, "time_total_s": 4702.439224243164, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bd0d90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4702.439224243164, "timesteps_since_restore": 16041984, "iterations_since_restore": 154, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.398812017825755, "episode_reward_min": 43.73526250300368, "episode_reward_mean": 47.98726590780729, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 25.62180328438529, "agent_1": 22.365462623422005}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811565418780572, "mean_processing_ms": 3.0628782607705265, "mean_inference_ms": 1.91689027079491}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 466, "num_steps_trained": 23404032, "num_steps_sampled": 16148992, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31541, "num_samples_dropped": 354, "learner_queue": {"size_count": 101833, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.577, "replay_time_ms": 94.271, "update_priorities_time_ms": 50.896, "policy_agent_0": {"added_count": 4009216, "sampled_count": 6088704, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4009216, "sampled_count": 6088704, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.535088539123535, "min_q": 8.98312759399414, "max_q": 9.790823936462402, "mean_td_error": -0.037377018481492996, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.369165420532227, "min_q": 9.008317947387695, "max_q": 9.767322540283203, "mean_td_error": 0.011356223374605179, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 16148992, "episodes_total": 161496, "training_iteration": 155, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-56-04", "timestamp": 1569664564, "time_this_iter_s": 30.53806972503662, "time_total_s": 4732.977293968201, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5c0ae18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4732.977293968201, "timesteps_since_restore": 16148992, "iterations_since_restore": 155, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.51873526920129, "episode_reward_min": 52.61748942062881, "episode_reward_mean": 53.76457916414803, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 27.626181048607293, "agent_1": 26.138398115540664}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681524604906956, "mean_processing_ms": 3.0635917866831286, "mean_inference_ms": 1.9165280904705932}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 469, "num_steps_trained": 23556096, "num_steps_sampled": 16256000, "sample_throughput": 0.0, "train_throughput": 18010.967, "num_weight_syncs": 31749, "num_samples_dropped": 354, "learner_queue": {"size_count": 102427, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.792, "replay_time_ms": 79.066, "update_priorities_time_ms": 43.926, "policy_agent_0": {"added_count": 4032000, "sampled_count": 6131712, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4032000, "sampled_count": 6131712, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.809768676757812, "min_q": 9.117417335510254, "max_q": 10.022830963134766, "mean_td_error": 0.03553899750113487, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.646018981933594, "min_q": 9.115429878234863, "max_q": 9.905733108520508, "mean_td_error": 0.053388562053442, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 16256000, "episodes_total": 162568, "training_iteration": 156, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-56-35", "timestamp": 1569664595, "time_this_iter_s": 30.568676710128784, "time_total_s": 4763.5459706783295, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f50598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4763.5459706783295, "timesteps_since_restore": 16256000, "iterations_since_restore": 156, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.49767125824013, "episode_reward_min": 52.60871909117709, "episode_reward_mean": 53.19273415045442, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 26.918226705225077, "agent_1": 26.27450744522929}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814674219929868, "mean_processing_ms": 3.063063900864657, "mean_inference_ms": 1.916154335178863}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 472, "num_steps_trained": 23708672, "num_steps_sampled": 16362240, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31956, "num_samples_dropped": 354, "learner_queue": {"size_count": 103022, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.561, "replay_time_ms": 93.614, "update_priorities_time_ms": 56.593, "policy_agent_0": {"added_count": 4057088, "sampled_count": 6172928, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4057088, "sampled_count": 6172928, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.973154067993164, "min_q": 9.625680923461914, "max_q": 10.129115104675293, "mean_td_error": 0.03265007957816124, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.806941032409668, "min_q": 9.237548828125, "max_q": 10.034164428710938, "mean_td_error": 0.060459334403276443, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 16362240, "episodes_total": 163624, "training_iteration": 157, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-57-05", "timestamp": 1569664625, "time_this_iter_s": 30.556229829788208, "time_total_s": 4794.102200508118, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bf8268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4794.102200508118, "timesteps_since_restore": 16362240, "iterations_since_restore": 157, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 56.9697133222751, "episode_reward_min": 52.6338388386246, "episode_reward_mean": 54.03420714276802, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 27.13723202425836, "agent_1": 26.896975118509665}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6812287355143839, "mean_processing_ms": 3.0624119395878364, "mean_inference_ms": 1.9158848854248722}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 475, "num_steps_trained": 23860224, "num_steps_sampled": 16470528, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32167, "num_samples_dropped": 354, "learner_queue": {"size_count": 103614, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 27.776, "replay_time_ms": 98.463, "update_priorities_time_ms": 52.08, "policy_agent_0": {"added_count": 4081920, "sampled_count": 6214912, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4081920, "sampled_count": 6214912, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.955796241760254, "min_q": 9.858757019042969, "max_q": 10.086806297302246, "mean_td_error": 0.0069412961602211, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.897950172424316, "min_q": 9.7396821975708, "max_q": 10.053208351135254, "mean_td_error": -0.00012976303696632385, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 16470528, "episodes_total": 164712, "training_iteration": 158, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-57-36", "timestamp": 1569664656, "time_this_iter_s": 30.71930956840515, "time_total_s": 4824.821510076523, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5be1268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4824.821510076523, "timesteps_since_restore": 16470528, "iterations_since_restore": 158, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 56.511035879402016, "episode_reward_min": 51.17044167639384, "episode_reward_mean": 53.90748779002043, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 26.81533257359391, "agent_1": 27.092155216426562}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6813790130977192, "mean_processing_ms": 3.0623348380817723, "mean_inference_ms": 1.9152338431799885}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 478, "num_steps_trained": 24010496, "num_steps_sampled": 16578816, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32379, "num_samples_dropped": 354, "learner_queue": {"size_count": 104201, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.218, "replay_time_ms": 88.974, "update_priorities_time_ms": 48.471, "policy_agent_0": {"added_count": 4108288, "sampled_count": 6256128, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4108288, "sampled_count": 6256128, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.953601837158203, "min_q": 9.752376556396484, "max_q": 10.07054328918457, "mean_td_error": -0.034108005464076996, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.94703483581543, "min_q": 9.827478408813477, "max_q": 10.3267183303833, "mean_td_error": 0.03607270121574402, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 16578816, "episodes_total": 165792, "training_iteration": 159, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-58-07", "timestamp": 1569664687, "time_this_iter_s": 30.57619333267212, "time_total_s": 4855.397703409195, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5be8c80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4855.397703409195, "timesteps_since_restore": 16578816, "iterations_since_restore": 159, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.27333895384905, "episode_reward_min": 45.280717971320534, "episode_reward_mean": 48.894953617311124, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 26.82412209867892, "agent_1": 22.07083151863221}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6809832472235064, "mean_processing_ms": 3.0603679590993225, "mean_inference_ms": 1.9149050950819158}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 481, "num_steps_trained": 24165376, "num_steps_sampled": 16685056, "sample_throughput": 0.0, "train_throughput": 16731.727, "num_weight_syncs": 32587, "num_samples_dropped": 354, "learner_queue": {"size_count": 104806, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.728, "replay_time_ms": 74.197, "update_priorities_time_ms": 47.991, "policy_agent_0": {"added_count": 4135936, "sampled_count": 6297600, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4135936, "sampled_count": 6297600, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 10.027050018310547, "min_q": 9.868593215942383, "max_q": 10.191269874572754, "mean_td_error": 0.05682789161801338, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.904029846191406, "min_q": 9.388895988464355, "max_q": 10.43842887878418, "mean_td_error": 0.01943092793226242, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 16685056, "episodes_total": 166856, "training_iteration": 160, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-58-37", "timestamp": 1569664717, "time_this_iter_s": 30.431264638900757, "time_total_s": 4885.828968048096, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e7d620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4885.828968048096, "timesteps_since_restore": 16685056, "iterations_since_restore": 160, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.85985088558363, "episode_reward_min": 45.46589757379192, "episode_reward_mean": 52.126461312981185, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 26.472141542047503, "agent_1": 25.654319770933643}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811010912697057, "mean_processing_ms": 3.0608340304700015, "mean_inference_ms": 1.9143847204510749}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 484, "num_steps_trained": 24312064, "num_steps_sampled": 16793088, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32799, "num_samples_dropped": 354, "learner_queue": {"size_count": 105379, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.191, "replay_time_ms": 88.826, "update_priorities_time_ms": 54.836, "policy_agent_0": {"added_count": 4157952, "sampled_count": 6339072, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4157952, "sampled_count": 6339072, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.916261672973633, "min_q": 9.817778587341309, "max_q": 10.306907653808594, "mean_td_error": 0.006644677370786667, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.792808532714844, "min_q": 9.144864082336426, "max_q": 10.276357650756836, "mean_td_error": 0.013471081852912903, "model": {}}}}, "timesteps_this_iter": 108032, "done": false, "timesteps_total": 16793088, "episodes_total": 167928, "training_iteration": 161, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-59-08", "timestamp": 1569664748, "time_this_iter_s": 30.5513334274292, "time_total_s": 4916.380301475525, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e5c268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4916.380301475525, "timesteps_since_restore": 16793088, "iterations_since_restore": 161, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.691759823890585, "episode_reward_min": 47.11497521032851, "episode_reward_mean": 51.13609498098732, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 26.564892662081053, "agent_1": 24.571202318906245}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811704080529434, "mean_processing_ms": 3.060635457862564, "mean_inference_ms": 1.9139465188244624}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 487, "num_steps_trained": 24464640, "num_steps_sampled": 16900352, "sample_throughput": 0.0, "train_throughput": 13783.946, "num_weight_syncs": 33007, "num_samples_dropped": 354, "learner_queue": {"size_count": 105975, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.642, "replay_time_ms": 79.198, "update_priorities_time_ms": 44.152, "policy_agent_0": {"added_count": 4185600, "sampled_count": 6382592, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4185600, "sampled_count": 6382592, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.977181434631348, "min_q": 9.763335227966309, "max_q": 10.307852745056152, "mean_td_error": 0.019365206360816956, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.609761238098145, "min_q": 8.94978141784668, "max_q": 10.629042625427246, "mean_td_error": -0.019089508801698685, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 16900352, "episodes_total": 169016, "training_iteration": 162, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_09-59-38", "timestamp": 1569664778, "time_this_iter_s": 30.533944606781006, "time_total_s": 4946.914246082306, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ec2598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4946.914246082306, "timesteps_since_restore": 16900352, "iterations_since_restore": 162, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 51.180547461310226, "episode_reward_min": 43.81938865756844, "episode_reward_mean": 48.18073603458279, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 25.124199292531095, "agent_1": 23.056536742051726}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6817035482092352, "mean_processing_ms": 3.0624120428904247, "mean_inference_ms": 1.9149134572445627}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 490, "num_steps_trained": 24608512, "num_steps_sampled": 17004032, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33210, "num_samples_dropped": 354, "learner_queue": {"size_count": 106537, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 49.944, "replay_time_ms": 119.341, "update_priorities_time_ms": 58.325, "policy_agent_0": {"added_count": 4212992, "sampled_count": 6420992, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4212992, "sampled_count": 6420992, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.94137954711914, "min_q": 9.691840171813965, "max_q": 10.217239379882812, "mean_td_error": 0.028436437249183655, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.511788368225098, "min_q": 8.743353843688965, "max_q": 10.999845504760742, "mean_td_error": 0.014224804937839508, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 17004032, "episodes_total": 170040, "training_iteration": 163, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-00-09", "timestamp": 1569664809, "time_this_iter_s": 30.577711820602417, "time_total_s": 4977.491957902908, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5eb89d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4977.491957902908, "timesteps_since_restore": 17004032, "iterations_since_restore": 163, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 52.85581920884879, "episode_reward_min": 45.33376858372505, "episode_reward_mean": 49.53603315368415, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 25.749151685637184, "agent_1": 23.78688146804694}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811820880658258, "mean_processing_ms": 3.0603208411840295, "mean_inference_ms": 1.9147344218925766}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 493, "num_steps_trained": 24755712, "num_steps_sampled": 17110272, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33417, "num_samples_dropped": 354, "learner_queue": {"size_count": 107112, "size_mean": 0.22, "size_std": 0.4142463035441596, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.626, "replay_time_ms": 86.155, "update_priorities_time_ms": 45.964, "policy_agent_0": {"added_count": 4236288, "sampled_count": 6462976, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4236288, "sampled_count": 6462976, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.925188064575195, "min_q": 9.579401969909668, "max_q": 10.207596778869629, "mean_td_error": -0.014536909759044647, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.198256492614746, "min_q": 8.677592277526855, "max_q": 10.349042892456055, "mean_td_error": 0.0010867193341255188, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 17110272, "episodes_total": 171112, "training_iteration": 164, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-00-39", "timestamp": 1569664839, "time_this_iter_s": 30.556730031967163, "time_total_s": 5008.0486879348755, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f31378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5008.0486879348755, "timesteps_since_restore": 17110272, "iterations_since_restore": 164, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.20481635299813, "episode_reward_min": 42.553894499641956, "episode_reward_mean": 47.84565923399454, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 23.26371054142524, "agent_1": 24.581948692569302}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814954333021095, "mean_processing_ms": 3.061602559305464, "mean_inference_ms": 1.9152047606074065}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 496, "num_steps_trained": 24913920, "num_steps_sampled": 17213184, "sample_throughput": 0.0, "train_throughput": 13428.487, "num_weight_syncs": 33618, "num_samples_dropped": 354, "learner_queue": {"size_count": 107730, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.964, "replay_time_ms": 83.988, "update_priorities_time_ms": 44.982, "policy_agent_0": {"added_count": 4261120, "sampled_count": 6504960, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4261120, "sampled_count": 6504960, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.8565092086792, "min_q": 9.607529640197754, "max_q": 10.204967498779297, "mean_td_error": 0.05816270411014557, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.135420799255371, "min_q": 8.667046546936035, "max_q": 9.621780395507812, "mean_td_error": -0.036217790096998215, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 17213184, "episodes_total": 172136, "training_iteration": 165, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-01-10", "timestamp": 1569664870, "time_this_iter_s": 30.543236255645752, "time_total_s": 5038.591924190521, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c6809ae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5038.591924190521, "timesteps_since_restore": 17213184, "iterations_since_restore": 165, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 52.66847475193897, "episode_reward_min": 45.67031907202921, "episode_reward_mean": 49.2373814755382, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 23.471058742660432, "agent_1": 25.766322732877747}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681505211384221, "mean_processing_ms": 3.0613376603486646, "mean_inference_ms": 1.9148907313507337}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 499, "num_steps_trained": 25067008, "num_steps_sampled": 17319680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33826, "num_samples_dropped": 354, "learner_queue": {"size_count": 108328, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.747, "replay_time_ms": 102.799, "update_priorities_time_ms": 54.46, "policy_agent_0": {"added_count": 4286208, "sampled_count": 6546432, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4286208, "sampled_count": 6546432, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.60676383972168, "min_q": 9.39802074432373, "max_q": 10.008935928344727, "mean_td_error": -0.004239194095134735, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.257660865783691, "min_q": 8.61451244354248, "max_q": 9.6207914352417, "mean_td_error": -0.02387956902384758, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 17319680, "episodes_total": 173192, "training_iteration": 166, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-01-41", "timestamp": 1569664901, "time_this_iter_s": 30.497947931289673, "time_total_s": 5069.089872121811, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f519d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5069.089872121811, "timesteps_since_restore": 17319680, "iterations_since_restore": 166, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.22972680581082, "episode_reward_min": 47.2655910526503, "episode_reward_mean": 51.74402381573977, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 24.67211160920569, "agent_1": 27.07191220653404}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811353446532148, "mean_processing_ms": 3.0604348566750406, "mean_inference_ms": 1.9145258002516239}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 502, "num_steps_trained": 25219072, "num_steps_sampled": 17427456, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 34037, "num_samples_dropped": 354, "learner_queue": {"size_count": 108922, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.263, "replay_time_ms": 112.752, "update_priorities_time_ms": 50.593, "policy_agent_0": {"added_count": 4314368, "sampled_count": 6585600, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4314368, "sampled_count": 6585600, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.415664672851562, "min_q": 9.230325698852539, "max_q": 9.93217945098877, "mean_td_error": 0.03965559974312782, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.390931129455566, "min_q": 8.659032821655273, "max_q": 9.750948905944824, "mean_td_error": -0.01060224324464798, "model": {}}}}, "timesteps_this_iter": 107776, "done": false, "timesteps_total": 17427456, "episodes_total": 174272, "training_iteration": 167, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-02-11", "timestamp": 1569664931, "time_this_iter_s": 30.43996238708496, "time_total_s": 5099.529834508896, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5efe048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5099.529834508896, "timesteps_since_restore": 17427456, "iterations_since_restore": 167, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.26244383192258, "episode_reward_min": 56.39768496746478, "episode_reward_mean": 57.886602530410855, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 28.82232309768618, "agent_1": 29.06427943272468}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6810265996011701, "mean_processing_ms": 3.0595666618510577, "mean_inference_ms": 1.9139523566891299}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 505, "num_steps_trained": 25370624, "num_steps_sampled": 17533440, "sample_throughput": 0.0, "train_throughput": 29019.265, "num_weight_syncs": 34244, "num_samples_dropped": 354, "learner_queue": {"size_count": 109514, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.817, "replay_time_ms": 79.17, "update_priorities_time_ms": 46.986, "policy_agent_0": {"added_count": 4339712, "sampled_count": 6628096, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4339712, "sampled_count": 6628096, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.548254013061523, "min_q": 9.309386253356934, "max_q": 9.702940940856934, "mean_td_error": 0.05472349375486374, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.698101043701172, "min_q": 9.237411499023438, "max_q": 9.888540267944336, "mean_td_error": 0.013757914304733276, "model": {}}}}, "timesteps_this_iter": 105984, "done": false, "timesteps_total": 17533440, "episodes_total": 175344, "training_iteration": 168, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-02-42", "timestamp": 1569664962, "time_this_iter_s": 30.513028144836426, "time_total_s": 5130.042862653732, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f09d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5130.042862653732, "timesteps_since_restore": 17533440, "iterations_since_restore": 168, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 58.39815165630781, "episode_reward_min": 56.301453930158104, "episode_reward_mean": 57.00704997391583, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 27.522301090924845, "agent_1": 29.484748882991198}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6809694962359416, "mean_processing_ms": 3.0590048007232484, "mean_inference_ms": 1.913012663382222}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 508, "num_steps_trained": 25520640, "num_steps_sampled": 17641984, "sample_throughput": 14664.597, "train_throughput": 0.0, "num_weight_syncs": 34456, "num_samples_dropped": 354, "learner_queue": {"size_count": 110100, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.531, "replay_time_ms": 77.493, "update_priorities_time_ms": 49.14, "policy_agent_0": {"added_count": 4370432, "sampled_count": 6668800, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4370432, "sampled_count": 6668800, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.671863555908203, "min_q": 9.400147438049316, "max_q": 9.86337661743164, "mean_td_error": 0.021668173372745514, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.097953796386719, "min_q": 9.467506408691406, "max_q": 10.215256690979004, "mean_td_error": -0.007239874452352524, "model": {}}}}, "timesteps_this_iter": 108544, "done": false, "timesteps_total": 17641984, "episodes_total": 176424, "training_iteration": 169, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-03-12", "timestamp": 1569664992, "time_this_iter_s": 30.542393684387207, "time_total_s": 5160.5852563381195, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f10158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5160.5852563381195, "timesteps_since_restore": 17641984, "iterations_since_restore": 169, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.77721249636435, "episode_reward_min": 43.818848533882864, "episode_reward_mean": 50.929462341785346, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 27.468669543569316, "agent_1": 23.460792798216087}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.680923598755569, "mean_processing_ms": 3.0592817672834594, "mean_inference_ms": 1.9129489754911138}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 511, "num_steps_trained": 25668864, "num_steps_sampled": 17751040, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 34669, "num_samples_dropped": 354, "learner_queue": {"size_count": 110679, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.264, "replay_time_ms": 99.687, "update_priorities_time_ms": 50.826, "policy_agent_0": {"added_count": 4400128, "sampled_count": 6708480, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4400128, "sampled_count": 6708480, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.7836275100708, "min_q": 9.468267440795898, "max_q": 10.040215492248535, "mean_td_error": 0.04187997058033943, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.195881843566895, "min_q": 9.39975357055664, "max_q": 10.4330472946167, "mean_td_error": -0.024380803108215332, "model": {}}}}, "timesteps_this_iter": 109056, "done": false, "timesteps_total": 17751040, "episodes_total": 177520, "training_iteration": 170, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-03-43", "timestamp": 1569665023, "time_this_iter_s": 30.568450927734375, "time_total_s": 5191.153707265854, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f7cbf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5191.153707265854, "timesteps_since_restore": 17751040, "iterations_since_restore": 170, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.47210100589696, "episode_reward_min": 45.92075322286282, "episode_reward_mean": 50.85146841314088, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 26.920365108148975, "agent_1": 23.93110330499199}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811914565175229, "mean_processing_ms": 3.0593922178497333, "mean_inference_ms": 1.9125950834860546}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 514, "num_steps_trained": 25819136, "num_steps_sampled": 17858304, "sample_throughput": 24985.848, "train_throughput": 24985.848, "num_weight_syncs": 34878, "num_samples_dropped": 354, "learner_queue": {"size_count": 111266, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.03, "replay_time_ms": 103.589, "update_priorities_time_ms": 52.711, "policy_agent_0": {"added_count": 4426240, "sampled_count": 6747648, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4426240, "sampled_count": 6747648, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.86070442199707, "min_q": 9.526002883911133, "max_q": 10.226166725158691, "mean_td_error": -0.014342870563268661, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.009105682373047, "min_q": 9.18627643585205, "max_q": 10.589245796203613, "mean_td_error": -0.014474108815193176, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 17858304, "episodes_total": 178592, "training_iteration": 171, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-04-13", "timestamp": 1569665053, "time_this_iter_s": 30.614163637161255, "time_total_s": 5221.767870903015, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5e8b158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5221.767870903015, "timesteps_since_restore": 17858304, "iterations_since_restore": 171, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.70286369326737, "episode_reward_min": 47.669128160828414, "episode_reward_mean": 53.34858800420778, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 26.247818791877425, "agent_1": 27.10076921233041}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6810577701863121, "mean_processing_ms": 3.0590780061663856, "mean_inference_ms": 1.912039057081704}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 517, "num_steps_trained": 25968896, "num_steps_sampled": 17966336, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 35089, "num_samples_dropped": 354, "learner_queue": {"size_count": 111851, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.41, "replay_time_ms": 83.076, "update_priorities_time_ms": 40.342, "policy_agent_0": {"added_count": 4451584, "sampled_count": 6789120, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4451584, "sampled_count": 6789120, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.909958839416504, "min_q": 9.573758125305176, "max_q": 10.412408828735352, "mean_td_error": 0.05023493990302086, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.987369537353516, "min_q": 9.378846168518066, "max_q": 10.684795379638672, "mean_td_error": 0.04388967901468277, "model": {}}}}, "timesteps_this_iter": 108032, "done": false, "timesteps_total": 17966336, "episodes_total": 179672, "training_iteration": 172, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-04-44", "timestamp": 1569665084, "time_this_iter_s": 30.486210823059082, "time_total_s": 5252.254081726074, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5c0fc80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5252.254081726074, "timesteps_since_restore": 17966336, "iterations_since_restore": 172, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.61810325493231, "episode_reward_min": 45.901350334193275, "episode_reward_mean": 51.351001899096694, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 26.192732789254766, "agent_1": 25.158269109841996}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681778630267781, "mean_processing_ms": 3.0606169711324527, "mean_inference_ms": 1.9125262690885778}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 520, "num_steps_trained": 26120704, "num_steps_sampled": 18072832, "sample_throughput": 9116.194, "train_throughput": 9116.194, "num_weight_syncs": 35297, "num_samples_dropped": 354, "learner_queue": {"size_count": 112445, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.919, "replay_time_ms": 98.913, "update_priorities_time_ms": 54.465, "policy_agent_0": {"added_count": 4478464, "sampled_count": 6830592, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4478464, "sampled_count": 6830592, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.910202980041504, "min_q": 9.723855018615723, "max_q": 10.38459300994873, "mean_td_error": 0.01720704883337021, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 10.072885513305664, "min_q": 9.4829683303833, "max_q": 10.609946250915527, "mean_td_error": 0.04759521037340164, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 18072832, "episodes_total": 180736, "training_iteration": 173, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-05-14", "timestamp": 1569665114, "time_this_iter_s": 30.548548460006714, "time_total_s": 5282.802630186081, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bed7b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5282.802630186081, "timesteps_since_restore": 18072832, "iterations_since_restore": 173, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.07560324084911, "episode_reward_min": 43.23519280934983, "episode_reward_mean": 49.322511022048715, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 26.013227827904704, "agent_1": 23.309283194144033}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811494004659105, "mean_processing_ms": 3.0575039655652745, "mean_inference_ms": 1.911801314596604}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 523, "num_steps_trained": 26272512, "num_steps_sampled": 18180352, "sample_throughput": 9990.898, "train_throughput": 0.0, "num_weight_syncs": 35507, "num_samples_dropped": 354, "learner_queue": {"size_count": 113037, "size_mean": 0.1, "size_std": 0.30000000000000004, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.698, "replay_time_ms": 98.784, "update_priorities_time_ms": 50.351, "policy_agent_0": {"added_count": 4505344, "sampled_count": 6872320, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4505344, "sampled_count": 6872320, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.96662425994873, "min_q": 9.72447395324707, "max_q": 10.487849235534668, "mean_td_error": -0.011498715728521347, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.965337753295898, "min_q": 9.481207847595215, "max_q": 10.418827056884766, "mean_td_error": -0.007170606404542923, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 18180352, "episodes_total": 181808, "training_iteration": 174, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-05-45", "timestamp": 1569665145, "time_this_iter_s": 30.483027935028076, "time_total_s": 5313.285658121109, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5b948c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5313.285658121109, "timesteps_since_restore": 18180352, "iterations_since_restore": 174, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.732557169028475, "episode_reward_min": 45.04165584765875, "episode_reward_mean": 50.44193152482682, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 24.85678473840682, "agent_1": 25.585146786419976}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814701716626157, "mean_processing_ms": 3.058552436256585, "mean_inference_ms": 1.9116801636605145}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 526, "num_steps_trained": 26425344, "num_steps_sampled": 18286080, "sample_throughput": 7930.41, "train_throughput": 7930.41, "num_weight_syncs": 35714, "num_samples_dropped": 354, "learner_queue": {"size_count": 113634, "size_mean": 0.16, "size_std": 0.41761226035642207, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.031, "replay_time_ms": 77.171, "update_priorities_time_ms": 35.614, "policy_agent_0": {"added_count": 4531968, "sampled_count": 6915072, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4531968, "sampled_count": 6915072, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.967634201049805, "min_q": 9.677581787109375, "max_q": 10.6319580078125, "mean_td_error": 0.011857651174068451, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.863122940063477, "min_q": 9.407257080078125, "max_q": 10.27389144897461, "mean_td_error": 0.006813790649175644, "model": {}}}}, "timesteps_this_iter": 105728, "done": false, "timesteps_total": 18286080, "episodes_total": 182864, "training_iteration": 175, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-06-16", "timestamp": 1569665176, "time_this_iter_s": 30.565056324005127, "time_total_s": 5343.850714445114, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5b5d950>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5343.850714445114, "timesteps_since_restore": 18286080, "iterations_since_restore": 175, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 53.39985726171274, "episode_reward_min": 42.51768691825271, "episode_reward_mean": 48.12169165070676, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 23.41176556079065, "agent_1": 24.70992608991612}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814518877269324, "mean_processing_ms": 3.0582641352480247, "mean_inference_ms": 1.9104724719286366}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 529, "num_steps_trained": 26570752, "num_steps_sampled": 18396416, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 35929, "num_samples_dropped": 354, "learner_queue": {"size_count": 114202, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.007, "replay_time_ms": 107.044, "update_priorities_time_ms": 50.982, "policy_agent_0": {"added_count": 4560128, "sampled_count": 6952960, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4560128, "sampled_count": 6952960, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.977897644042969, "min_q": 9.286626815795898, "max_q": 10.652535438537598, "mean_td_error": -0.035567983984947205, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.87895393371582, "min_q": 9.379497528076172, "max_q": 10.249290466308594, "mean_td_error": 0.021331217139959335, "model": {}}}}, "timesteps_this_iter": 110336, "done": false, "timesteps_total": 18396416, "episodes_total": 183968, "training_iteration": 176, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-06-46", "timestamp": 1569665206, "time_this_iter_s": 30.53759741783142, "time_total_s": 5374.388311862946, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5b59e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5374.388311862946, "timesteps_since_restore": 18396416, "iterations_since_restore": 176, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.943417535379474, "episode_reward_min": 43.72218480925688, "episode_reward_mean": 48.058669085260064, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 24.28192191755133, "agent_1": 23.77674716770871}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814706499387394, "mean_processing_ms": 3.057851164581304, "mean_inference_ms": 1.9103765334763378}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 532, "num_steps_trained": 26722816, "num_steps_sampled": 18504448, "sample_throughput": 6797.383, "train_throughput": 0.0, "num_weight_syncs": 36141, "num_samples_dropped": 354, "learner_queue": {"size_count": 114796, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.581, "replay_time_ms": 87.099, "update_priorities_time_ms": 49.685, "policy_agent_0": {"added_count": 4586496, "sampled_count": 6994688, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4586496, "sampled_count": 6994688, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.643837928771973, "min_q": 9.378377914428711, "max_q": 10.028063774108887, "mean_td_error": 0.005387473851442337, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.739837646484375, "min_q": 9.469079971313477, "max_q": 10.447148323059082, "mean_td_error": 0.017914269119501114, "model": {}}}}, "timesteps_this_iter": 108032, "done": false, "timesteps_total": 18504448, "episodes_total": 185048, "training_iteration": 177, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-07-17", "timestamp": 1569665237, "time_this_iter_s": 30.577768564224243, "time_total_s": 5404.96608042717, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5b6ca60>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5404.96608042717, "timesteps_since_restore": 18504448, "iterations_since_restore": 177, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 53.087155520686174, "episode_reward_min": 43.734324625809066, "episode_reward_mean": 46.88348577155086, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 23.666453450687115, "agent_1": 23.21703232086368}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6816031615744047, "mean_processing_ms": 3.058075194298091, "mean_inference_ms": 1.9095418552954144}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 535, "num_steps_trained": 26869248, "num_steps_sampled": 18613760, "sample_throughput": 5236.909, "train_throughput": 7855.364, "num_weight_syncs": 36354, "num_samples_dropped": 354, "learner_queue": {"size_count": 115368, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 24.8, "replay_time_ms": 70.019, "update_priorities_time_ms": 41.525, "policy_agent_0": {"added_count": 4615680, "sampled_count": 7036672, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4615680, "sampled_count": 7036672, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.456206321716309, "min_q": 9.274855613708496, "max_q": 9.799098014831543, "mean_td_error": -0.004348058253526688, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.654245376586914, "min_q": 9.370917320251465, "max_q": 10.516276359558105, "mean_td_error": 0.041997186839580536, "model": {}}}}, "timesteps_this_iter": 109312, "done": false, "timesteps_total": 18613760, "episodes_total": 186144, "training_iteration": 178, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-07-47", "timestamp": 1569665267, "time_this_iter_s": 30.49777865409851, "time_total_s": 5435.463859081268, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5b74f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5435.463859081268, "timesteps_since_restore": 18613760, "iterations_since_restore": 178, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.461995359398905, "episode_reward_min": 45.62859747163018, "episode_reward_mean": 47.089186275043666, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 24.558316574795644, "agent_1": 22.53086970024798}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6812742164000444, "mean_processing_ms": 3.0572436988176794, "mean_inference_ms": 1.9091980124902792}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 538, "num_steps_trained": 27018752, "num_steps_sampled": 18719232, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36560, "num_samples_dropped": 354, "learner_queue": {"size_count": 115953, "size_mean": 0.74, "size_std": 1.682973558912914, "size_quantiles": [0.0, 0.0, 0.0, 3.1000000000000014, 7.0]}, "replay_shard_0": {"add_batch_time_ms": 32.495, "replay_time_ms": 81.995, "update_priorities_time_ms": 44.117, "policy_agent_0": {"added_count": 4646912, "sampled_count": 7075072, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4646912, "sampled_count": 7075072, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.547679901123047, "min_q": 9.29601001739502, "max_q": 9.79149055480957, "mean_td_error": 0.046452708542346954, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.557862281799316, "min_q": 9.35721492767334, "max_q": 10.165034294128418, "mean_td_error": 0.03798042982816696, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 18719232, "episodes_total": 187200, "training_iteration": 179, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-08-18", "timestamp": 1569665298, "time_this_iter_s": 30.45707678794861, "time_total_s": 5465.920935869217, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5b94510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5465.920935869217, "timesteps_since_restore": 18719232, "iterations_since_restore": 179, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 53.24479640110585, "episode_reward_min": 45.62253766915076, "episode_reward_mean": 51.042471048156635, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 26.040342882935533, "agent_1": 25.002128165221155}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6807985806391071, "mean_processing_ms": 3.0552494113475532, "mean_inference_ms": 1.9083695173889446}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 541, "num_steps_trained": 27168512, "num_steps_sampled": 18826752, "sample_throughput": 0.0, "train_throughput": 22015.087, "num_weight_syncs": 36770, "num_samples_dropped": 354, "learner_queue": {"size_count": 116537, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.779, "replay_time_ms": 81.675, "update_priorities_time_ms": 42.959, "policy_agent_0": {"added_count": 4673792, "sampled_count": 7113472, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4673792, "sampled_count": 7113472, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.529870986938477, "min_q": 9.295026779174805, "max_q": 9.745865821838379, "mean_td_error": 0.017434295266866684, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.416831016540527, "min_q": 9.266826629638672, "max_q": 9.738656997680664, "mean_td_error": -0.012613419443368912, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 18826752, "episodes_total": 188272, "training_iteration": 180, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-08-48", "timestamp": 1569665328, "time_this_iter_s": 30.456732749938965, "time_total_s": 5496.377668619156, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5c0fea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5496.377668619156, "timesteps_since_restore": 18826752, "iterations_since_restore": 180, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.40263931106796, "episode_reward_min": 51.25257055418298, "episode_reward_mean": 52.771747754460286, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 26.49160558022215, "agent_1": 26.28014217423822}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6815776031874025, "mean_processing_ms": 3.056564758938314, "mean_inference_ms": 1.907532726559073}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 544, "num_steps_trained": 27313920, "num_steps_sampled": 18937344, "sample_throughput": 0.0, "train_throughput": 22422.407, "num_weight_syncs": 36986, "num_samples_dropped": 354, "learner_queue": {"size_count": 117105, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.842, "replay_time_ms": 92.857, "update_priorities_time_ms": 47.872, "policy_agent_0": {"added_count": 4700160, "sampled_count": 7155200, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4700160, "sampled_count": 7155200, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.697599411010742, "min_q": 9.465483665466309, "max_q": 9.886680603027344, "mean_td_error": 0.007807552814483643, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.454217910766602, "min_q": 9.199746131896973, "max_q": 9.706693649291992, "mean_td_error": 0.043076906353235245, "model": {}}}}, "timesteps_this_iter": 110592, "done": false, "timesteps_total": 18937344, "episodes_total": 189376, "training_iteration": 181, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-09-19", "timestamp": 1569665359, "time_this_iter_s": 30.50036597251892, "time_total_s": 5526.878034591675, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ba7950>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5526.878034591675, "timesteps_since_restore": 18937344, "iterations_since_restore": 181, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 53.11187173215595, "episode_reward_min": 50.142414606665874, "episode_reward_mean": 51.51149540770096, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 24.960849269789023, "agent_1": 26.5506461379119}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6820220129322652, "mean_processing_ms": 3.0576313678198224, "mean_inference_ms": 1.9075177898815758}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 547, "num_steps_trained": 27465472, "num_steps_sampled": 19044864, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 37196, "num_samples_dropped": 354, "learner_queue": {"size_count": 117698, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.499, "replay_time_ms": 91.894, "update_priorities_time_ms": 52.527, "policy_agent_0": {"added_count": 4727040, "sampled_count": 7196672, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4727040, "sampled_count": 7196672, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.797281265258789, "min_q": 9.563493728637695, "max_q": 10.018974304199219, "mean_td_error": 0.049583762884140015, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.604604721069336, "min_q": 9.236227989196777, "max_q": 9.680540084838867, "mean_td_error": 0.04487975686788559, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 19044864, "episodes_total": 190456, "training_iteration": 182, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-09-49", "timestamp": 1569665389, "time_this_iter_s": 30.498711585998535, "time_total_s": 5557.376746177673, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f7cd90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5557.376746177673, "timesteps_since_restore": 19044864, "iterations_since_restore": 182, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.07422436198672, "episode_reward_min": 48.92801882897689, "episode_reward_mean": 51.9287731480405, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 25.781696170953524, "agent_1": 26.14707697708706}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6815831125763152, "mean_processing_ms": 3.0560051767473673, "mean_inference_ms": 1.9068344973664932}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 550, "num_steps_trained": 27614208, "num_steps_sampled": 19153152, "sample_throughput": 8263.939, "train_throughput": 8263.939, "num_weight_syncs": 37407, "num_samples_dropped": 354, "learner_queue": {"size_count": 118278, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.781, "replay_time_ms": 109.689, "update_priorities_time_ms": 56.015, "policy_agent_0": {"added_count": 4754944, "sampled_count": 7235584, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4754944, "sampled_count": 7235584, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.77322006225586, "min_q": 9.550450325012207, "max_q": 10.015625953674316, "mean_td_error": 0.018292635679244995, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.64542293548584, "min_q": 9.394211769104004, "max_q": 9.68841552734375, "mean_td_error": -7.228925824165344e-05, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 19153152, "episodes_total": 191536, "training_iteration": 183, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-10-20", "timestamp": 1569665420, "time_this_iter_s": 30.552502393722534, "time_total_s": 5587.929248571396, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f8c620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5587.929248571396, "timesteps_since_restore": 19153152, "iterations_since_restore": 183, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.36720358530442, "episode_reward_min": 47.68408128488159, "episode_reward_mean": 50.810305002375586, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 24.40055957541317, "agent_1": 26.409745426962406}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6812547920461467, "mean_processing_ms": 3.0542924743803783, "mean_inference_ms": 1.9060924800583299}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 553, "num_steps_trained": 27768320, "num_steps_sampled": 19260416, "sample_throughput": 6033.003, "train_throughput": 0.0, "num_weight_syncs": 37617, "num_samples_dropped": 354, "learner_queue": {"size_count": 118881, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 26.229, "replay_time_ms": 89.222, "update_priorities_time_ms": 46.355, "policy_agent_0": {"added_count": 4781312, "sampled_count": 7276544, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4781312, "sampled_count": 7276544, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.753761291503906, "min_q": 9.523754119873047, "max_q": 9.984755516052246, "mean_td_error": 0.058514926582574844, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.769466400146484, "min_q": 9.503411293029785, "max_q": 9.842080116271973, "mean_td_error": 0.031876351684331894, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 19260416, "episodes_total": 192608, "training_iteration": 184, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-10-50", "timestamp": 1569665450, "time_this_iter_s": 30.56487774848938, "time_total_s": 5618.494126319885, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f10510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5618.494126319885, "timesteps_since_restore": 19260416, "iterations_since_restore": 184, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 59.02783978827983, "episode_reward_min": 45.50615756347258, "episode_reward_mean": 49.80634350012844, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 23.109860113397616, "agent_1": 26.69648338673086}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6816356007815888, "mean_processing_ms": 3.055844346365207, "mean_inference_ms": 1.9062181447427624}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 556, "num_steps_trained": 27915776, "num_steps_sampled": 19368960, "sample_throughput": 0.0, "train_throughput": 21467.967, "num_weight_syncs": 37830, "num_samples_dropped": 354, "learner_queue": {"size_count": 119456, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.035, "replay_time_ms": 91.157, "update_priorities_time_ms": 51.845, "policy_agent_0": {"added_count": 4804864, "sampled_count": 7314176, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4804864, "sampled_count": 7314176, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.670308113098145, "min_q": 9.245842933654785, "max_q": 10.086448669433594, "mean_td_error": 0.056525178253650665, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.779903411865234, "min_q": 9.564695358276367, "max_q": 10.000348091125488, "mean_td_error": -0.005396995693445206, "model": {}}}}, "timesteps_this_iter": 108544, "done": false, "timesteps_total": 19368960, "episodes_total": 193696, "training_iteration": 185, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-11-21", "timestamp": 1569665481, "time_this_iter_s": 30.51792883872986, "time_total_s": 5649.012055158615, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f096a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5649.012055158615, "timesteps_since_restore": 19368960, "iterations_since_restore": 185, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.94424510797898, "episode_reward_min": 50.25408282162525, "episode_reward_mean": 51.71262301027153, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 24.339931419876002, "agent_1": 27.372691590395505}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6818185276303804, "mean_processing_ms": 3.0558042863361132, "mean_inference_ms": 1.9059239135997654}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 559, "num_steps_trained": 28069632, "num_steps_sampled": 19474944, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38035, "num_samples_dropped": 354, "learner_queue": {"size_count": 120057, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.825, "replay_time_ms": 87.352, "update_priorities_time_ms": 53.807, "policy_agent_0": {"added_count": 4826112, "sampled_count": 7356672, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4826112, "sampled_count": 7356672, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.485586166381836, "min_q": 9.118745803833008, "max_q": 9.932901382446289, "mean_td_error": 0.06166791915893555, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.8970308303833, "min_q": 9.744155883789062, "max_q": 10.286431312561035, "mean_td_error": 0.017506372183561325, "model": {}}}}, "timesteps_this_iter": 105984, "done": false, "timesteps_total": 19474944, "episodes_total": 194752, "training_iteration": 186, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-11-52", "timestamp": 1569665512, "time_this_iter_s": 30.570613145828247, "time_total_s": 5679.582668304443, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f2dae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5679.582668304443, "timesteps_since_restore": 19474944, "iterations_since_restore": 186, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.23338190351206, "episode_reward_min": 43.76593524070786, "episode_reward_mean": 49.10556511424712, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 24.294434739753548, "agent_1": 24.811130374493523}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6812435733929618, "mean_processing_ms": 3.054451284258647, "mean_inference_ms": 1.9059627994732575}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 562, "num_steps_trained": 28225280, "num_steps_sampled": 19579904, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38241, "num_samples_dropped": 354, "learner_queue": {"size_count": 120665, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 27.059, "replay_time_ms": 79.447, "update_priorities_time_ms": 48.903, "policy_agent_0": {"added_count": 4850432, "sampled_count": 7401216, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4850432, "sampled_count": 7401216, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.388871192932129, "min_q": 8.956676483154297, "max_q": 9.808067321777344, "mean_td_error": 0.04085130989551544, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.946015357971191, "min_q": 9.67568588256836, "max_q": 10.563996315002441, "mean_td_error": 0.018432214856147766, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 19579904, "episodes_total": 195808, "training_iteration": 187, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-12-22", "timestamp": 1569665542, "time_this_iter_s": 30.474188566207886, "time_total_s": 5710.056856870651, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c67f3048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5710.056856870651, "timesteps_since_restore": 19579904, "iterations_since_restore": 187, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 55.68219426123642, "episode_reward_min": 45.71865231593378, "episode_reward_mean": 50.19503387874333, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 24.817366853755075, "agent_1": 25.377667024988305}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6810226298918213, "mean_processing_ms": 3.053969256171711, "mean_inference_ms": 1.9063498252125746}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 565, "num_steps_trained": 28372480, "num_steps_sampled": 19685888, "sample_throughput": 0.0, "train_throughput": 27431.961, "num_weight_syncs": 38449, "num_samples_dropped": 354, "learner_queue": {"size_count": 121241, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.62, "replay_time_ms": 103.263, "update_priorities_time_ms": 57.422, "policy_agent_0": {"added_count": 4877056, "sampled_count": 7440640, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4877056, "sampled_count": 7440640, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.414266586303711, "min_q": 9.004992485046387, "max_q": 9.68781566619873, "mean_td_error": 0.00029617175459861755, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.842121124267578, "min_q": 9.52160358428955, "max_q": 10.539933204650879, "mean_td_error": 0.04539119452238083, "model": {}}}}, "timesteps_this_iter": 105984, "done": false, "timesteps_total": 19685888, "episodes_total": 196856, "training_iteration": 188, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-12-53", "timestamp": 1569665573, "time_this_iter_s": 30.543719053268433, "time_total_s": 5740.60057592392, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f22598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5740.60057592392, "timesteps_since_restore": 19685888, "iterations_since_restore": 188, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 57.89014581670969, "episode_reward_min": 49.66999400033916, "episode_reward_mean": 52.77882870176443, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 26.393394255319336, "agent_1": 26.385434446445213}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6815075036263196, "mean_processing_ms": 3.055152855437484, "mean_inference_ms": 1.9060415671040871}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 568, "num_steps_trained": 28521984, "num_steps_sampled": 19793920, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38658, "num_samples_dropped": 354, "learner_queue": {"size_count": 121824, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.852, "replay_time_ms": 87.641, "update_priorities_time_ms": 46.864, "policy_agent_0": {"added_count": 4903936, "sampled_count": 7481088, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4903936, "sampled_count": 7481088, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.56227970123291, "min_q": 9.077430725097656, "max_q": 9.98791217803955, "mean_td_error": 0.018682315945625305, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.712389945983887, "min_q": 9.387226104736328, "max_q": 9.938830375671387, "mean_td_error": 0.006699714809656143, "model": {}}}}, "timesteps_this_iter": 108032, "done": false, "timesteps_total": 19793920, "episodes_total": 197944, "training_iteration": 189, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-13-23", "timestamp": 1569665603, "time_this_iter_s": 30.50573992729187, "time_total_s": 5771.106315851212, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5f31510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5771.106315851212, "timesteps_since_restore": 19793920, "iterations_since_restore": 189, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 54.61377465747635, "episode_reward_min": 48.64435705256503, "episode_reward_mean": 51.85358595769577, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 25.27136747024205, "agent_1": 26.582218487453822}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6818220546383787, "mean_processing_ms": 3.0554440530628404, "mean_inference_ms": 1.9058503860424367}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 571, "num_steps_trained": 28672512, "num_steps_sampled": 19900416, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38867, "num_samples_dropped": 354, "learner_queue": {"size_count": 122412, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.18, "replay_time_ms": 95.452, "update_priorities_time_ms": 43.905, "policy_agent_0": {"added_count": 4931072, "sampled_count": 7521280, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4931072, "sampled_count": 7521280, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.655179023742676, "min_q": 9.090030670166016, "max_q": 10.12632942199707, "mean_td_error": 0.029745399951934814, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.826688766479492, "min_q": 9.429774284362793, "max_q": 10.14273452758789, "mean_td_error": -0.006225790828466415, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 19900416, "episodes_total": 199008, "training_iteration": 190, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-13-54", "timestamp": 1569665634, "time_this_iter_s": 30.509644746780396, "time_total_s": 5801.615960597992, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5bd5ae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5801.615960597992, "timesteps_since_restore": 19900416, "iterations_since_restore": 190, "num_healthy_workers": 4, "trial_id": "0d984810"}
{"episode_reward_max": 51.872304340061596, "episode_reward_min": 48.61936082852553, "episode_reward_mean": 51.036778077712285, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 24.342715156803177, "agent_1": 26.694062920909076}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6813199094902068, "mean_processing_ms": 3.054322154878461, "mean_inference_ms": 1.9057140604886669}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 574, "num_steps_trained": 28825088, "num_steps_sampled": 20005888, "sample_throughput": 14179.677, "train_throughput": 14179.677, "num_weight_syncs": 39073, "num_samples_dropped": 354, "learner_queue": {"size_count": 123008, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.999, "replay_time_ms": 99.985, "update_priorities_time_ms": 52.739, "policy_agent_0": {"added_count": 4956672, "sampled_count": 7561216, "est_size_bytes": 97727292, "num_entries": 75000}, "policy_agent_1": {"added_count": 4956672, "sampled_count": 7561216, "est_size_bytes": 97727292, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.004999999888241291, "mean_q": 9.495871543884277, "min_q": 9.01077938079834, "max_q": 9.929688453674316, "mean_td_error": -0.03632352128624916, "model": {}}, "agent_1": {"cur_lr": 0.004999999888241291, "mean_q": 9.922264099121094, "min_q": 9.661957740783691, "max_q": 10.06041431427002, "mean_td_error": -0.01651427149772644, "model": {}}}}, "timesteps_this_iter": 105472, "done": true, "timesteps_total": 20005888, "episodes_total": 200056, "training_iteration": 191, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-14-24", "timestamp": 1569665664, "time_this_iter_s": 30.5927631855011, "time_total_s": 5832.208723783493, "pid": 3488, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f63c5ec29d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5832.208723783493, "timesteps_since_restore": 20005888, "iterations_since_restore": 191, "num_healthy_workers": 4, "trial_id": "0d984810"}
