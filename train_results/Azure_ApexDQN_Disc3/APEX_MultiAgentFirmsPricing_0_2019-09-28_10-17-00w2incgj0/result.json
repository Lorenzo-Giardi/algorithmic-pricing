{"episode_reward_max": 56.886030751282604, "episode_reward_min": 45.63956746840746, "episode_reward_mean": 50.55696112943996, "episode_len_mean": 100.0, "episodes_this_iter": 848, "policy_reward_mean": {"agent_0": 24.461273482889617, "agent_1": 26.09568764655028}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6495699463570429, "mean_processing_ms": 3.0171109707546475, "mean_inference_ms": 1.851669687771575}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 576, "num_steps_trained": 28922624, "num_steps_sampled": 20089856, "sample_throughput": 7988.794, "train_throughput": 0.0, "num_weight_syncs": 164, "num_samples_dropped": 205, "learner_queue": {"size_count": 10258, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.314, "replay_time_ms": 113.144, "update_priorities_time_ms": 54.339, "policy_agent_0": {"added_count": 21248, "sampled_count": 29184, "est_size_bytes": 27686984, "num_entries": 21248}, "policy_agent_1": {"added_count": 21248, "sampled_count": 29184, "est_size_bytes": 27686984, "num_entries": 21248}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 9.519519805908203, "min_q": 9.255602836608887, "max_q": 10.124439239501953, "mean_td_error": 0.013776522129774094, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 9.95760726928711, "min_q": 9.6527099609375, "max_q": 10.354086875915527, "mean_td_error": 0.031123295426368713, "model": {}}}}, "timesteps_this_iter": 83968, "done": false, "timesteps_total": 20089856, "episodes_total": 200904, "training_iteration": 192, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-17-43", "timestamp": 1569665863, "time_this_iter_s": 30.586990356445312, "time_total_s": 5862.795714139938, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b452840>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 30.586990356445312, "timesteps_since_restore": 83968, "iterations_since_restore": 1, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.299061264026484, "episode_reward_min": 43.67303945328779, "episode_reward_mean": 52.12683436154408, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.88779225669541, "agent_1": 24.239042104848725}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6740222865547747, "mean_processing_ms": 3.0590070374758636, "mean_inference_ms": 1.9156188057281487}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 579, "num_steps_trained": 29083648, "num_steps_sampled": 20191744, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 362, "num_samples_dropped": 205, "learner_queue": {"size_count": 10887, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.481, "replay_time_ms": 80.337, "update_priorities_time_ms": 47.678, "policy_agent_0": {"added_count": 46848, "sampled_count": 68608, "est_size_bytes": 61044636, "num_entries": 46848}, "policy_agent_1": {"added_count": 46848, "sampled_count": 68608, "est_size_bytes": 61044636, "num_entries": 46848}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 9.792234420776367, "min_q": 9.318668365478516, "max_q": 10.280738830566406, "mean_td_error": 0.002870984375476837, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 9.905743598937988, "min_q": 9.123075485229492, "max_q": 10.514761924743652, "mean_td_error": 0.00775802880525589, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 20191744, "episodes_total": 201912, "training_iteration": 193, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-18-13", "timestamp": 1569665893, "time_this_iter_s": 30.491164445877075, "time_total_s": 5893.286878585815, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b477d90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 61.07815480232239, "timesteps_since_restore": 185856, "iterations_since_restore": 2, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.3115969355877, "episode_reward_min": 50.2034960879942, "episode_reward_mean": 59.574832896116035, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 31.05631901487139, "agent_1": 28.518513881244743}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6758781598947028, "mean_processing_ms": 3.0449355932149245, "mean_inference_ms": 1.952685881713634}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 582, "num_steps_trained": 29242112, "num_steps_sampled": 20294912, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 563, "num_samples_dropped": 205, "learner_queue": {"size_count": 11506, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.101, "replay_time_ms": 92.288, "update_priorities_time_ms": 53.791, "policy_agent_0": {"added_count": 75776, "sampled_count": 109568, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 75776, "sampled_count": 109568, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.13604736328125, "min_q": 9.541415214538574, "max_q": 10.482114791870117, "mean_td_error": 0.04083738476037979, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.171371459960938, "min_q": 9.532673835754395, "max_q": 10.71302604675293, "mean_td_error": 0.026567894965410233, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 20294912, "episodes_total": 202944, "training_iteration": 194, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-18-44", "timestamp": 1569665924, "time_this_iter_s": 30.4343478679657, "time_total_s": 5923.721226453781, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b458e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 91.51250267028809, "timesteps_since_restore": 289024, "iterations_since_restore": 3, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.30166952106748, "episode_reward_min": 59.1807617097153, "episode_reward_mean": 60.76404822263351, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 31.87827833669299, "agent_1": 28.885769885940643}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811046975388236, "mean_processing_ms": 3.0518547172281734, "mean_inference_ms": 1.9650181695299835}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 585, "num_steps_trained": 29398528, "num_steps_sampled": 20397568, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 764, "num_samples_dropped": 205, "learner_queue": {"size_count": 12118, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.476, "replay_time_ms": 81.275, "update_priorities_time_ms": 51.7, "policy_agent_0": {"added_count": 103424, "sampled_count": 149504, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 103424, "sampled_count": 149504, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.63345718383789, "min_q": 10.139724731445312, "max_q": 10.693206787109375, "mean_td_error": 0.01696481555700302, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.318363189697266, "min_q": 9.7727689743042, "max_q": 10.621670722961426, "mean_td_error": 0.021369531750679016, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 20397568, "episodes_total": 203976, "training_iteration": 195, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-19-14", "timestamp": 1569665954, "time_this_iter_s": 30.6060848236084, "time_total_s": 5954.3273112773895, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b416378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 122.11858749389648, "timesteps_since_restore": 391680, "iterations_since_restore": 4, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.28756833225528, "episode_reward_min": 59.13505849519617, "episode_reward_mean": 60.69959824818466, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 31.85194663609729, "agent_1": 28.8476516120875}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6853880233102522, "mean_processing_ms": 3.044875740150863, "mean_inference_ms": 1.9475075373225743}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 588, "num_steps_trained": 29545216, "num_steps_sampled": 20502016, "sample_throughput": 0.0, "train_throughput": 23025.858, "num_weight_syncs": 969, "num_samples_dropped": 205, "learner_queue": {"size_count": 12690, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.271, "replay_time_ms": 100.387, "update_priorities_time_ms": 51.994, "policy_agent_0": {"added_count": 128000, "sampled_count": 188672, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 128000, "sampled_count": 188672, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.953004837036133, "min_q": 10.58383560180664, "max_q": 11.146734237670898, "mean_td_error": 0.008692119270563126, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.471449851989746, "min_q": 10.115697860717773, "max_q": 10.51148796081543, "mean_td_error": 0.04433007538318634, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 20502016, "episodes_total": 205016, "training_iteration": 196, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-19-45", "timestamp": 1569665985, "time_this_iter_s": 30.645085096359253, "time_total_s": 5984.972396373749, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b416f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 152.76367259025574, "timesteps_since_restore": 496128, "iterations_since_restore": 5, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.308599947466625, "episode_reward_min": 58.911101319273364, "episode_reward_mean": 60.77006883439159, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 31.888001159658263, "agent_1": 28.882067674733452}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6917134961438178, "mean_processing_ms": 3.0627019401049473, "mean_inference_ms": 1.9598449800524054}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 591, "num_steps_trained": 29697280, "num_steps_sampled": 20601856, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1162, "num_samples_dropped": 205, "learner_queue": {"size_count": 13284, "size_mean": 0.1, "size_std": 0.36055512754639896, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.522, "replay_time_ms": 115.61, "update_priorities_time_ms": 56.301, "policy_agent_0": {"added_count": 154624, "sampled_count": 226560, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 154624, "sampled_count": 226560, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.163148880004883, "min_q": 10.946090698242188, "max_q": 11.178618431091309, "mean_td_error": 0.006570674479007721, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.543331146240234, "min_q": 10.196152687072754, "max_q": 10.574686050415039, "mean_td_error": 0.010857202112674713, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 20601856, "episodes_total": 206024, "training_iteration": 197, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-20-16", "timestamp": 1569666016, "time_this_iter_s": 30.540190935134888, "time_total_s": 6015.512587308884, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b42c488>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 183.30386352539062, "timesteps_since_restore": 595968, "iterations_since_restore": 6, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.32912134729974, "episode_reward_min": 59.21999718355077, "episode_reward_mean": 60.81668886748703, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 31.90442160036995, "agent_1": 28.912267267117205}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6931690046772456, "mean_processing_ms": 3.066473217496725, "mean_inference_ms": 1.9582448908454468}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 594, "num_steps_trained": 29847296, "num_steps_sampled": 20705024, "sample_throughput": 7017.966, "train_throughput": 7017.966, "num_weight_syncs": 1365, "num_samples_dropped": 205, "learner_queue": {"size_count": 13870, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.317, "replay_time_ms": 105.735, "update_priorities_time_ms": 45.409, "policy_agent_0": {"added_count": 181504, "sampled_count": 264960, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 181504, "sampled_count": 264960, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.313833236694336, "min_q": 11.110322952270508, "max_q": 11.32225513458252, "mean_td_error": 0.0118645541369915, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.613177299499512, "min_q": 10.4471435546875, "max_q": 10.618514060974121, "mean_td_error": 0.01703312247991562, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 20705024, "episodes_total": 207048, "training_iteration": 198, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-20-46", "timestamp": 1569666046, "time_this_iter_s": 30.67376208305359, "time_total_s": 6046.186349391937, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4370d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 213.9776256084442, "timesteps_since_restore": 699136, "iterations_since_restore": 7, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.312177820956926, "episode_reward_min": 59.222229257071504, "episode_reward_mean": 60.85065287099079, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 31.915074679308145, "agent_1": 28.935578191682776}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6911521338773196, "mean_processing_ms": 3.0611038971994016, "mean_inference_ms": 1.959957173323722}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 597, "num_steps_trained": 29999872, "num_steps_sampled": 20808960, "sample_throughput": 17737.83, "train_throughput": 0.0, "num_weight_syncs": 1567, "num_samples_dropped": 205, "learner_queue": {"size_count": 14467, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.292, "replay_time_ms": 95.816, "update_priorities_time_ms": 52.689, "policy_agent_0": {"added_count": 205824, "sampled_count": 302336, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 205824, "sampled_count": 302336, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.48481559753418, "min_q": 11.273612976074219, "max_q": 11.500734329223633, "mean_td_error": 0.00811447948217392, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.692756652832031, "min_q": 10.393209457397461, "max_q": 10.699445724487305, "mean_td_error": 0.050902269780635834, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 20808960, "episodes_total": 208088, "training_iteration": 199, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-21-17", "timestamp": 1569666077, "time_this_iter_s": 30.486170530319214, "time_total_s": 6076.6725199222565, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b440598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 244.46379613876343, "timesteps_since_restore": 803072, "iterations_since_restore": 8, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.3023040221277, "episode_reward_min": 59.38579254190181, "episode_reward_mean": 60.84613618378489, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 31.911468726825063, "agent_1": 28.934667456959957}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6905373745435751, "mean_processing_ms": 3.0647186071901973, "mean_inference_ms": 1.9649485838691398}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 600, "num_steps_trained": 30155520, "num_steps_sampled": 20910592, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1765, "num_samples_dropped": 205, "learner_queue": {"size_count": 15074, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 26.739, "replay_time_ms": 81.863, "update_priorities_time_ms": 46.516, "policy_agent_0": {"added_count": 230400, "sampled_count": 343808, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 230400, "sampled_count": 343808, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.574121475219727, "min_q": 11.307124137878418, "max_q": 11.584381103515625, "mean_td_error": 0.03814392909407616, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.72275161743164, "min_q": 10.46918773651123, "max_q": 10.751537322998047, "mean_td_error": 0.024064309895038605, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 20910592, "episodes_total": 209112, "training_iteration": 200, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-21-47", "timestamp": 1569666107, "time_this_iter_s": 30.510324954986572, "time_total_s": 6107.182844877243, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3cc1e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 274.97412109375, "timesteps_since_restore": 904704, "iterations_since_restore": 9, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.333801482070186, "episode_reward_min": 59.12645062036697, "episode_reward_mean": 60.83423043584996, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 31.90776485711047, "agent_1": 28.92646557873961}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6905021934021619, "mean_processing_ms": 3.05817923221382, "mean_inference_ms": 1.9621597884516908}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 603, "num_steps_trained": 30304256, "num_steps_sampled": 21015552, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1970, "num_samples_dropped": 205, "learner_queue": {"size_count": 15655, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.048, "replay_time_ms": 88.272, "update_priorities_time_ms": 50.691, "policy_agent_0": {"added_count": 256512, "sampled_count": 382208, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 256512, "sampled_count": 382208, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.665792465209961, "min_q": 11.458202362060547, "max_q": 11.678449630737305, "mean_td_error": 0.017899122089147568, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.749467849731445, "min_q": 10.435589790344238, "max_q": 10.757645606994629, "mean_td_error": 0.010574929416179657, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 21015552, "episodes_total": 210152, "training_iteration": 201, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-22-18", "timestamp": 1569666138, "time_this_iter_s": 30.68838667869568, "time_total_s": 6137.871231555939, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4402f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 305.6625077724457, "timesteps_since_restore": 1009664, "iterations_since_restore": 10, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.34846847406443, "episode_reward_min": 58.8880914074306, "episode_reward_mean": 60.81076999556317, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 31.898942797460826, "agent_1": 28.911827198102472}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6915889733739293, "mean_processing_ms": 3.0590421741353446, "mean_inference_ms": 1.9590112997535993}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 606, "num_steps_trained": 30450688, "num_steps_sampled": 21119488, "sample_throughput": 18973.385, "train_throughput": 0.0, "num_weight_syncs": 2174, "num_samples_dropped": 205, "learner_queue": {"size_count": 16228, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.228, "replay_time_ms": 113.301, "update_priorities_time_ms": 57.522, "policy_agent_0": {"added_count": 278016, "sampled_count": 419072, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 278016, "sampled_count": 419072, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.721352577209473, "min_q": 11.578186988830566, "max_q": 11.726971626281738, "mean_td_error": 0.02822994440793991, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.760436058044434, "min_q": 10.461997032165527, "max_q": 10.777920722961426, "mean_td_error": 0.017389997839927673, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 21119488, "episodes_total": 211200, "training_iteration": 202, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-22-49", "timestamp": 1569666169, "time_this_iter_s": 30.559202194213867, "time_total_s": 6168.430433750153, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b42cc80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 336.22170996665955, "timesteps_since_restore": 1113600, "iterations_since_restore": 11, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.35011965392806, "episode_reward_min": 59.18217226933301, "episode_reward_mean": 60.85407653768164, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 31.915130479626892, "agent_1": 28.93894605805487}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6956558712652967, "mean_processing_ms": 3.066036539985092, "mean_inference_ms": 1.9608733638100524}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 609, "num_steps_trained": 30601728, "num_steps_sampled": 21220864, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2373, "num_samples_dropped": 205, "learner_queue": {"size_count": 16817, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.176, "replay_time_ms": 86.096, "update_priorities_time_ms": 51.888, "policy_agent_0": {"added_count": 299776, "sampled_count": 457472, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 299776, "sampled_count": 457472, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.745878219604492, "min_q": 11.567803382873535, "max_q": 11.781975746154785, "mean_td_error": 0.02816811576485634, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.811479568481445, "min_q": 10.527351379394531, "max_q": 10.818822860717773, "mean_td_error": 0.05797296762466431, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 21220864, "episodes_total": 212208, "training_iteration": 203, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-23-19", "timestamp": 1569666199, "time_this_iter_s": 30.49615168571472, "time_total_s": 6198.926585435867, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b423730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 366.71786165237427, "timesteps_since_restore": 1214976, "iterations_since_restore": 12, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 62.951726565140035, "episode_reward_min": 59.24150570134889, "episode_reward_mean": 60.967923417066764, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 31.938609334480986, "agent_1": 29.0293140825859}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6989605066504575, "mean_processing_ms": 3.0717173889725213, "mean_inference_ms": 1.963505342261497}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 612, "num_steps_trained": 30751744, "num_steps_sampled": 21322240, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2571, "num_samples_dropped": 205, "learner_queue": {"size_count": 17403, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.497, "replay_time_ms": 100.525, "update_priorities_time_ms": 42.722, "policy_agent_0": {"added_count": 325376, "sampled_count": 495616, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 325376, "sampled_count": 495616, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.773297309875488, "min_q": 11.620816230773926, "max_q": 11.797453880310059, "mean_td_error": 0.01042085513472557, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.788487434387207, "min_q": 10.646578788757324, "max_q": 10.792505264282227, "mean_td_error": 0.023929018527269363, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 21322240, "episodes_total": 213224, "training_iteration": 204, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-23-50", "timestamp": 1569666230, "time_this_iter_s": 30.505078077316284, "time_total_s": 6229.431663513184, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b416400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 397.22293972969055, "timesteps_since_restore": 1316352, "iterations_since_restore": 13, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.401943926582305, "episode_reward_min": 59.18944499927113, "episode_reward_mean": 60.99179106224897, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 31.952797891539944, "agent_1": 29.038993170709148}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6985661626687205, "mean_processing_ms": 3.0714828792671898, "mean_inference_ms": 1.968466140179285}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 615, "num_steps_trained": 30904320, "num_steps_sampled": 21424384, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2769, "num_samples_dropped": 205, "learner_queue": {"size_count": 17999, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.524, "replay_time_ms": 82.051, "update_priorities_time_ms": 48.287, "policy_agent_0": {"added_count": 352256, "sampled_count": 535040, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 352256, "sampled_count": 535040, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.833131790161133, "min_q": 11.626641273498535, "max_q": 11.841167449951172, "mean_td_error": 0.04068167880177498, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.798724174499512, "min_q": 10.724345207214355, "max_q": 10.80508041381836, "mean_td_error": 0.012652479112148285, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 21424384, "episodes_total": 214248, "training_iteration": 205, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-24-20", "timestamp": 1569666260, "time_this_iter_s": 30.503319263458252, "time_total_s": 6259.934982776642, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bd46d90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 427.7262589931488, "timesteps_since_restore": 1418496, "iterations_since_restore": 14, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.410799116716376, "episode_reward_min": 53.466488450125205, "episode_reward_mean": 60.96256175517337, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 31.95034866227292, "agent_1": 29.012213092900573}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6979910305319451, "mean_processing_ms": 3.070472930537511, "mean_inference_ms": 1.967332615904781}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 618, "num_steps_trained": 31055360, "num_steps_sampled": 21527552, "sample_throughput": 6217.67, "train_throughput": 6217.67, "num_weight_syncs": 2971, "num_samples_dropped": 205, "learner_queue": {"size_count": 18589, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.957, "replay_time_ms": 97.421, "update_priorities_time_ms": 49.686, "policy_agent_0": {"added_count": 379392, "sampled_count": 572928, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 379392, "sampled_count": 572928, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.845226287841797, "min_q": 11.691696166992188, "max_q": 11.914470672607422, "mean_td_error": 0.03475715219974518, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.803092002868652, "min_q": 10.515033721923828, "max_q": 10.841361045837402, "mean_td_error": 0.027063634246587753, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 21527552, "episodes_total": 215280, "training_iteration": 206, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-24-51", "timestamp": 1569666291, "time_this_iter_s": 30.608222723007202, "time_total_s": 6290.543205499649, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bc9d1e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 458.334481716156, "timesteps_since_restore": 1521664, "iterations_since_restore": 15, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.39822349430495, "episode_reward_min": 59.6573219031993, "episode_reward_mean": 60.978701264757994, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 31.953913230159483, "agent_1": 29.02478803459863}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6972555584014186, "mean_processing_ms": 3.069481400402158, "mean_inference_ms": 1.9666124976115846}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 621, "num_steps_trained": 31202816, "num_steps_sampled": 21631232, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3174, "num_samples_dropped": 205, "learner_queue": {"size_count": 19165, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.26, "replay_time_ms": 74.525, "update_priorities_time_ms": 36.527, "policy_agent_0": {"added_count": 404224, "sampled_count": 611584, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 404224, "sampled_count": 611584, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.840980529785156, "min_q": 11.715251922607422, "max_q": 11.859848976135254, "mean_td_error": 0.021806612610816956, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.820515632629395, "min_q": 10.616117477416992, "max_q": 10.920906066894531, "mean_td_error": 0.030531208962202072, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 21631232, "episodes_total": 216320, "training_iteration": 207, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-25-22", "timestamp": 1569666322, "time_this_iter_s": 30.518962383270264, "time_total_s": 6321.062167882919, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b47db70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 488.85344409942627, "timesteps_since_restore": 1625344, "iterations_since_restore": 16, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.4034620427403, "episode_reward_min": 59.590705683708755, "episode_reward_mean": 60.94928592511903, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 31.944489780028675, "agent_1": 29.004796145090477}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6966077371612247, "mean_processing_ms": 3.072555959245067, "mean_inference_ms": 1.9670668875615676}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 624, "num_steps_trained": 31351040, "num_steps_sampled": 21733376, "sample_throughput": 7503.07, "train_throughput": 7503.07, "num_weight_syncs": 3373, "num_samples_dropped": 205, "learner_queue": {"size_count": 19744, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.14, "replay_time_ms": 94.076, "update_priorities_time_ms": 51.37, "policy_agent_0": {"added_count": 430080, "sampled_count": 649728, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 430080, "sampled_count": 649728, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.881113052368164, "min_q": 11.772552490234375, "max_q": 11.895147323608398, "mean_td_error": 0.07521311193704605, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.807519912719727, "min_q": 10.616426467895508, "max_q": 10.826172828674316, "mean_td_error": 0.010085772722959518, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 21733376, "episodes_total": 217336, "training_iteration": 208, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-25-52", "timestamp": 1569666352, "time_this_iter_s": 30.502307891845703, "time_total_s": 6351.564475774765, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4797b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 519.355751991272, "timesteps_since_restore": 1727488, "iterations_since_restore": 17, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.41886845580766, "episode_reward_min": 59.08217901817188, "episode_reward_mean": 60.98550243514826, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 31.96229895929579, "agent_1": 29.023203475852597}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6964597713041686, "mean_processing_ms": 3.0709086552253293, "mean_inference_ms": 1.9674983614813402}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 627, "num_steps_trained": 31499520, "num_steps_sampled": 21835520, "sample_throughput": 19405.791, "train_throughput": 0.0, "num_weight_syncs": 3572, "num_samples_dropped": 205, "learner_queue": {"size_count": 20324, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.253, "replay_time_ms": 98.749, "update_priorities_time_ms": 52.401, "policy_agent_0": {"added_count": 454400, "sampled_count": 687104, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 454400, "sampled_count": 687104, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.853525161743164, "min_q": 11.75355339050293, "max_q": 11.865541458129883, "mean_td_error": -0.007236447185277939, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.798686981201172, "min_q": 10.601560592651367, "max_q": 10.842325210571289, "mean_td_error": 0.01783677563071251, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 21835520, "episodes_total": 218360, "training_iteration": 209, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-26-23", "timestamp": 1569666383, "time_this_iter_s": 30.52601194381714, "time_total_s": 6382.090487718582, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b484c80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 549.8817639350891, "timesteps_since_restore": 1829632, "iterations_since_restore": 18, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.392644274739105, "episode_reward_min": 58.78429510488013, "episode_reward_mean": 60.98967188763562, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 31.955615572490014, "agent_1": 29.034056315145733}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6957757373813838, "mean_processing_ms": 3.0738200789996153, "mean_inference_ms": 1.9682061136690396}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 630, "num_steps_trained": 31653120, "num_steps_sampled": 21936896, "sample_throughput": 8506.233, "train_throughput": 0.0, "num_weight_syncs": 3770, "num_samples_dropped": 205, "learner_queue": {"size_count": 20926, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.282, "replay_time_ms": 93.742, "update_priorities_time_ms": 50.921, "policy_agent_0": {"added_count": 481280, "sampled_count": 726784, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 481280, "sampled_count": 726784, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.877562522888184, "min_q": 11.729079246520996, "max_q": 11.928691864013672, "mean_td_error": 0.033965591341257095, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.82252025604248, "min_q": 10.735611915588379, "max_q": 10.84990406036377, "mean_td_error": 0.01737070456147194, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 21936896, "episodes_total": 219376, "training_iteration": 210, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-26-53", "timestamp": 1569666413, "time_this_iter_s": 30.59451723098755, "time_total_s": 6412.68500494957, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3d98c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 580.4762811660767, "timesteps_since_restore": 1931008, "iterations_since_restore": 19, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.41688817998761, "episode_reward_min": 59.640920219583, "episode_reward_mean": 60.999893112638915, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 31.960405275449368, "agent_1": 29.039487837189675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6960002807814549, "mean_processing_ms": 3.072718253562685, "mean_inference_ms": 1.9652694684220213}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 633, "num_steps_trained": 31803392, "num_steps_sampled": 22040320, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3972, "num_samples_dropped": 205, "learner_queue": {"size_count": 21511, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.633, "replay_time_ms": 104.407, "update_priorities_time_ms": 51.128, "policy_agent_0": {"added_count": 506880, "sampled_count": 765440, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 506880, "sampled_count": 765440, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.900627136230469, "min_q": 11.711182594299316, "max_q": 11.916548728942871, "mean_td_error": 0.010306484997272491, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.827779769897461, "min_q": 10.62964153289795, "max_q": 10.845508575439453, "mean_td_error": 0.014480117708444595, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 22040320, "episodes_total": 220400, "training_iteration": 211, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-27-24", "timestamp": 1569666444, "time_this_iter_s": 30.508145093917847, "time_total_s": 6443.193150043488, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3cfd90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 610.9844262599945, "timesteps_since_restore": 2034432, "iterations_since_restore": 20, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.855597129165865, "episode_reward_min": 59.58180164205087, "episode_reward_mean": 61.07529939252118, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 31.91514532015466, "agent_1": 29.160154072366634}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6954333519252748, "mean_processing_ms": 3.070625824348472, "mean_inference_ms": 1.9645257080311593}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 636, "num_steps_trained": 31952640, "num_steps_sampled": 22144512, "sample_throughput": 10704.875, "train_throughput": 0.0, "num_weight_syncs": 4177, "num_samples_dropped": 205, "learner_queue": {"size_count": 22094, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.345, "replay_time_ms": 93.267, "update_priorities_time_ms": 46.663, "policy_agent_0": {"added_count": 528640, "sampled_count": 804608, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 528640, "sampled_count": 804608, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.937077522277832, "min_q": 11.814557075500488, "max_q": 11.951204299926758, "mean_td_error": 0.0316065177321434, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.829594612121582, "min_q": 10.591341972351074, "max_q": 10.888763427734375, "mean_td_error": 0.02908027544617653, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 22144512, "episodes_total": 221448, "training_iteration": 212, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-27-54", "timestamp": 1569666474, "time_this_iter_s": 30.53766655921936, "time_total_s": 6473.730816602707, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3f69d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 641.5220928192139, "timesteps_since_restore": 2138624, "iterations_since_restore": 21, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.401804124493474, "episode_reward_min": 59.42296727043741, "episode_reward_mean": 61.012880684166205, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 31.97062817075677, "agent_1": 29.04225251340955}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6942121342004077, "mean_processing_ms": 3.0689607718241594, "mean_inference_ms": 1.9624049160425538}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 639, "num_steps_trained": 32101888, "num_steps_sampled": 22248960, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4379, "num_samples_dropped": 205, "learner_queue": {"size_count": 22677, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.964, "replay_time_ms": 87.3, "update_priorities_time_ms": 45.121, "policy_agent_0": {"added_count": 556032, "sampled_count": 841728, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 556032, "sampled_count": 841728, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.913091659545898, "min_q": 11.794384002685547, "max_q": 11.963579177856445, "mean_td_error": 0.00483737513422966, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.834185600280762, "min_q": 10.616790771484375, "max_q": 10.85788345336914, "mean_td_error": 0.02086009830236435, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 22248960, "episodes_total": 222496, "training_iteration": 213, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-28-25", "timestamp": 1569666505, "time_this_iter_s": 30.525028705596924, "time_total_s": 6504.255845308304, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3fdea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 672.0471215248108, "timesteps_since_restore": 2243072, "iterations_since_restore": 22, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.37762698040084, "episode_reward_min": 59.25730613630175, "episode_reward_mean": 61.00805904517678, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 31.969780847961882, "agent_1": 29.038278197215018}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6939046867266556, "mean_processing_ms": 3.067005080084452, "mean_inference_ms": 1.9607696636974687}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 642, "num_steps_trained": 32250112, "num_steps_sampled": 22351872, "sample_throughput": 5704.596, "train_throughput": 0.0, "num_weight_syncs": 4581, "num_samples_dropped": 205, "learner_queue": {"size_count": 23256, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.599, "replay_time_ms": 95.154, "update_priorities_time_ms": 52.861, "policy_agent_0": {"added_count": 579584, "sampled_count": 878080, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 579584, "sampled_count": 878080, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.918828010559082, "min_q": 11.727082252502441, "max_q": 11.923938751220703, "mean_td_error": 0.030507531017065048, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.869940757751465, "min_q": 10.6295166015625, "max_q": 10.894858360290527, "mean_td_error": 0.04539526253938675, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 22351872, "episodes_total": 223520, "training_iteration": 214, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-28-56", "timestamp": 1569666536, "time_this_iter_s": 30.530932188034058, "time_total_s": 6534.786777496338, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b389ae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 702.5780537128448, "timesteps_since_restore": 2345984, "iterations_since_restore": 23, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.38807270661253, "episode_reward_min": 59.02684285317023, "episode_reward_mean": 61.00088234461708, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 31.961384897210273, "agent_1": 29.039497447406934}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6942161516166584, "mean_processing_ms": 3.0692895790045682, "mean_inference_ms": 1.9632937916364737}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 645, "num_steps_trained": 32404480, "num_steps_sampled": 22452992, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4778, "num_samples_dropped": 205, "learner_queue": {"size_count": 23859, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.687, "replay_time_ms": 75.903, "update_priorities_time_ms": 45.571, "policy_agent_0": {"added_count": 604928, "sampled_count": 915712, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 604928, "sampled_count": 915712, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.929423332214355, "min_q": 11.797184944152832, "max_q": 11.951818466186523, "mean_td_error": 0.028572700917720795, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.86197280883789, "min_q": 10.573430061340332, "max_q": 10.87752914428711, "mean_td_error": 0.04167960211634636, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 22452992, "episodes_total": 224536, "training_iteration": 215, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-29-26", "timestamp": 1569666566, "time_this_iter_s": 30.489954471588135, "time_total_s": 6565.276731967926, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b39c048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 733.068008184433, "timesteps_since_restore": 2447104, "iterations_since_restore": 24, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.42398344257342, "episode_reward_min": 59.620105397193456, "episode_reward_mean": 61.02421097827049, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 31.972718155390513, "agent_1": 29.051492822880096}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.695840838572337, "mean_processing_ms": 3.070003283116892, "mean_inference_ms": 1.9612474851379678}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 648, "num_steps_trained": 32552960, "num_steps_sampled": 22557184, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4983, "num_samples_dropped": 205, "learner_queue": {"size_count": 24439, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.13, "replay_time_ms": 90.334, "update_priorities_time_ms": 48.462, "policy_agent_0": {"added_count": 630016, "sampled_count": 954112, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 630016, "sampled_count": 954112, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.933725357055664, "min_q": 11.745980262756348, "max_q": 11.937097549438477, "mean_td_error": 0.022576954215765, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.856922149658203, "min_q": 10.664560317993164, "max_q": 10.87159252166748, "mean_td_error": 0.024039972573518753, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 22557184, "episodes_total": 225576, "training_iteration": 216, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-29-57", "timestamp": 1569666597, "time_this_iter_s": 30.539414882659912, "time_total_s": 6595.816146850586, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b39cbf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 763.6074230670929, "timesteps_since_restore": 2551296, "iterations_since_restore": 25, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.387885415310194, "episode_reward_min": 58.96890543602247, "episode_reward_mean": 60.66974959219896, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 31.275090058017575, "agent_1": 29.394659534181493}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6952005321277716, "mean_processing_ms": 3.067965349919592, "mean_inference_ms": 1.9615144014865813}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 651, "num_steps_trained": 32701696, "num_steps_sampled": 22660864, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5184, "num_samples_dropped": 205, "learner_queue": {"size_count": 25020, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.656, "replay_time_ms": 101.485, "update_priorities_time_ms": 51.844, "policy_agent_0": {"added_count": 656640, "sampled_count": 990464, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 656640, "sampled_count": 990464, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.899436950683594, "min_q": 11.656217575073242, "max_q": 11.934654235839844, "mean_td_error": 0.057090986520051956, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.885564804077148, "min_q": 10.76827335357666, "max_q": 10.959856986999512, "mean_td_error": 0.04934417083859444, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 22660864, "episodes_total": 226608, "training_iteration": 217, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-30-27", "timestamp": 1569666627, "time_this_iter_s": 30.548403024673462, "time_total_s": 6626.364549875259, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3af158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 794.1558260917664, "timesteps_since_restore": 2654976, "iterations_since_restore": 26, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.46547542198171, "episode_reward_min": 58.73401543478508, "episode_reward_mean": 60.00780374819445, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.040465898447955, "agent_1": 29.967337849746574}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6956649271501104, "mean_processing_ms": 3.0700937326470816, "mean_inference_ms": 1.9625640801587785}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 654, "num_steps_trained": 32855040, "num_steps_sampled": 22762752, "sample_throughput": 16980.317, "train_throughput": 0.0, "num_weight_syncs": 5384, "num_samples_dropped": 205, "learner_queue": {"size_count": 25619, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.099, "replay_time_ms": 100.655, "update_priorities_time_ms": 51.812, "policy_agent_0": {"added_count": 680192, "sampled_count": 1028096, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 680192, "sampled_count": 1028096, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.797637939453125, "min_q": 11.670632362365723, "max_q": 11.942038536071777, "mean_td_error": 0.013020243495702744, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.93844985961914, "min_q": 10.659676551818848, "max_q": 10.989655494689941, "mean_td_error": 0.026210933923721313, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 22762752, "episodes_total": 227632, "training_iteration": 218, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-30-58", "timestamp": 1569666658, "time_this_iter_s": 30.5203959941864, "time_total_s": 6656.884945869446, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3afd08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 824.6762220859528, "timesteps_since_restore": 2756864, "iterations_since_restore": 27, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.46827167928308, "episode_reward_min": 58.167697976472915, "episode_reward_mean": 59.9629223097716, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.03355395682237, "agent_1": 29.9293683529493}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6958485459162252, "mean_processing_ms": 3.0703121901010246, "mean_inference_ms": 1.962464333702339}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 657, "num_steps_trained": 33006592, "num_steps_sampled": 22863872, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5581, "num_samples_dropped": 205, "learner_queue": {"size_count": 26211, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.633, "replay_time_ms": 115.193, "update_priorities_time_ms": 49.73, "policy_agent_0": {"added_count": 706304, "sampled_count": 1063936, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 706304, "sampled_count": 1063936, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.647868156433105, "min_q": 11.447661399841309, "max_q": 11.887008666992188, "mean_td_error": 0.03239157423377037, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.010512351989746, "min_q": 10.757448196411133, "max_q": 11.082005500793457, "mean_td_error": 0.01438181847333908, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 22863872, "episodes_total": 228640, "training_iteration": 219, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-31-28", "timestamp": 1569666688, "time_this_iter_s": 30.58442211151123, "time_total_s": 6687.469367980957, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3c3268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 855.260644197464, "timesteps_since_restore": 2857984, "iterations_since_restore": 28, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.435811550433726, "episode_reward_min": 58.2616832241276, "episode_reward_mean": 59.90619331882091, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.019682502344484, "agent_1": 29.88651081647651}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.696129863157651, "mean_processing_ms": 3.070924987405288, "mean_inference_ms": 1.96450432177728}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 660, "num_steps_trained": 33157632, "num_steps_sampled": 22966528, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5782, "num_samples_dropped": 205, "learner_queue": {"size_count": 26802, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.739, "replay_time_ms": 87.855, "update_priorities_time_ms": 46.797, "policy_agent_0": {"added_count": 731392, "sampled_count": 1100544, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 731392, "sampled_count": 1100544, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.550890922546387, "min_q": 11.385757446289062, "max_q": 11.656197547912598, "mean_td_error": 0.015959613025188446, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.081300735473633, "min_q": 10.827417373657227, "max_q": 11.087119102478027, "mean_td_error": 0.024668369442224503, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 22966528, "episodes_total": 229664, "training_iteration": 220, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-31-59", "timestamp": 1569666719, "time_this_iter_s": 30.497626066207886, "time_total_s": 6717.966994047165, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3c3e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 885.7582702636719, "timesteps_since_restore": 2960640, "iterations_since_restore": 29, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.63313292166134, "episode_reward_min": 57.97779079848448, "episode_reward_mean": 60.021197687605614, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 29.970188255101583, "agent_1": 30.05100943250411}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6957939246298952, "mean_processing_ms": 3.0704191939849763, "mean_inference_ms": 1.9637248622254737}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 663, "num_steps_trained": 33306112, "num_steps_sampled": 23069696, "sample_throughput": 6867.113, "train_throughput": 6867.113, "num_weight_syncs": 5983, "num_samples_dropped": 205, "learner_queue": {"size_count": 27382, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.225, "replay_time_ms": 94.138, "update_priorities_time_ms": 43.869, "policy_agent_0": {"added_count": 759552, "sampled_count": 1138944, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 759552, "sampled_count": 1138944, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.502396583557129, "min_q": 11.325732231140137, "max_q": 11.51965618133545, "mean_td_error": 0.021949317306280136, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.102933883666992, "min_q": 10.9600830078125, "max_q": 11.106757164001465, "mean_td_error": 0.041804783046245575, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 23069696, "episodes_total": 230704, "training_iteration": 221, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-32-30", "timestamp": 1569666750, "time_this_iter_s": 30.626973628997803, "time_total_s": 6748.593967676163, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b356bf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 916.3852438926697, "timesteps_since_restore": 3063808, "iterations_since_restore": 30, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.4926239717747, "episode_reward_min": 58.13633141769747, "episode_reward_mean": 60.053647602415055, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 30.0562225987453, "agent_1": 29.997425003669832}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6956323990175315, "mean_processing_ms": 3.0699254929149187, "mean_inference_ms": 1.9643725259554627}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 666, "num_steps_trained": 33459200, "num_steps_sampled": 23172096, "sample_throughput": 0.0, "train_throughput": 22048.539, "num_weight_syncs": 6183, "num_samples_dropped": 205, "learner_queue": {"size_count": 27979, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.203, "replay_time_ms": 101.238, "update_priorities_time_ms": 51.109, "policy_agent_0": {"added_count": 781824, "sampled_count": 1175808, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 781824, "sampled_count": 1175808, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.443514823913574, "min_q": 11.282252311706543, "max_q": 11.500904083251953, "mean_td_error": 0.021196816116571426, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.123481750488281, "min_q": 10.921656608581543, "max_q": 11.213287353515625, "mean_td_error": 0.011541713029146194, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 23172096, "episodes_total": 231720, "training_iteration": 222, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-33-00", "timestamp": 1569666780, "time_this_iter_s": 30.499921798706055, "time_total_s": 6779.093889474869, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b36d1e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 946.8851656913757, "timesteps_since_restore": 3166208, "iterations_since_restore": 31, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.468100131419455, "episode_reward_min": 58.21385357448997, "episode_reward_mean": 60.058859940563856, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 30.061683978483135, "agent_1": 29.997175962080796}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6951427899567708, "mean_processing_ms": 3.070072510743701, "mean_inference_ms": 1.9669018377822456}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 669, "num_steps_trained": 33608704, "num_steps_sampled": 23273472, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6380, "num_samples_dropped": 205, "learner_queue": {"size_count": 28563, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 49.895, "replay_time_ms": 109.964, "update_priorities_time_ms": 49.227, "policy_agent_0": {"added_count": 805632, "sampled_count": 1214720, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 805632, "sampled_count": 1214720, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.41074275970459, "min_q": 11.27943229675293, "max_q": 11.440534591674805, "mean_td_error": 0.029235530644655228, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.18814468383789, "min_q": 10.978187561035156, "max_q": 11.305103302001953, "mean_td_error": 0.04943595826625824, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 23273472, "episodes_total": 232736, "training_iteration": 223, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-33-31", "timestamp": 1569666811, "time_this_iter_s": 30.466055393218994, "time_total_s": 6809.559944868088, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b379048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 977.3512210845947, "timesteps_since_restore": 3267584, "iterations_since_restore": 32, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.477295030472156, "episode_reward_min": 58.63487366154676, "episode_reward_mean": 60.05034288253706, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.058916524243685, "agent_1": 29.99142635829344}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6957446088938308, "mean_processing_ms": 3.071880990702142, "mean_inference_ms": 1.9676687519080795}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 672, "num_steps_trained": 33759744, "num_steps_sampled": 23374592, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6578, "num_samples_dropped": 205, "learner_queue": {"size_count": 29153, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.736, "replay_time_ms": 95.285, "update_priorities_time_ms": 46.192, "policy_agent_0": {"added_count": 829184, "sampled_count": 1252352, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 829184, "sampled_count": 1252352, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.373590469360352, "min_q": 11.245512008666992, "max_q": 11.405983924865723, "mean_td_error": 0.01710331439971924, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.193732261657715, "min_q": 10.97745132446289, "max_q": 11.316768646240234, "mean_td_error": 0.013907261192798615, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 23374592, "episodes_total": 233744, "training_iteration": 224, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-34-01", "timestamp": 1569666841, "time_this_iter_s": 30.468751907348633, "time_total_s": 6840.028696775436, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b381510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1007.8199729919434, "timesteps_since_restore": 3368704, "iterations_since_restore": 33, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.465118439350235, "episode_reward_min": 58.57463137313187, "episode_reward_mean": 60.05713956046455, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.05998834369, "agent_1": 29.997151216774625}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.694804175328425, "mean_processing_ms": 3.071014710292513, "mean_inference_ms": 1.9700043468408677}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 675, "num_steps_trained": 33912576, "num_steps_sampled": 23475712, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6776, "num_samples_dropped": 205, "learner_queue": {"size_count": 29750, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.484, "replay_time_ms": 83.585, "update_priorities_time_ms": 36.494, "policy_agent_0": {"added_count": 859648, "sampled_count": 1287936, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 859648, "sampled_count": 1287936, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.324223518371582, "min_q": 11.215371131896973, "max_q": 11.32612419128418, "mean_td_error": 0.02938394621014595, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.193716049194336, "min_q": 11.098751068115234, "max_q": 11.195453643798828, "mean_td_error": 0.043871667236089706, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 23475712, "episodes_total": 234752, "training_iteration": 225, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-34-32", "timestamp": 1569666872, "time_this_iter_s": 30.454163074493408, "time_total_s": 6870.48285984993, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3560d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1038.2741360664368, "timesteps_since_restore": 3469824, "iterations_since_restore": 34, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.460812036017465, "episode_reward_min": 58.6411383136429, "episode_reward_mean": 60.06629571886705, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 30.062267122132564, "agent_1": 30.004028596734567}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6950989996690425, "mean_processing_ms": 3.071321851684083, "mean_inference_ms": 1.9704496234979314}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 678, "num_steps_trained": 34059264, "num_steps_sampled": 23579136, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6978, "num_samples_dropped": 205, "learner_queue": {"size_count": 30323, "size_mean": 0.24, "size_std": 0.4270831300812525, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.623, "replay_time_ms": 124.241, "update_priorities_time_ms": 55.138, "policy_agent_0": {"added_count": 882688, "sampled_count": 1326336, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 882688, "sampled_count": 1326336, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.274199485778809, "min_q": 11.144082069396973, "max_q": 11.371851921081543, "mean_td_error": 0.033853959292173386, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.196317672729492, "min_q": 10.818830490112305, "max_q": 11.226245880126953, "mean_td_error": -0.009508591145277023, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 23579136, "episodes_total": 235784, "training_iteration": 226, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-35-02", "timestamp": 1569666902, "time_this_iter_s": 30.603679656982422, "time_total_s": 6901.086539506912, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3adea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1068.8778157234192, "timesteps_since_restore": 3573248, "iterations_since_restore": 35, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.51599345231768, "episode_reward_min": 58.89616266951879, "episode_reward_mean": 60.07497779497556, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.06404004286606, "agent_1": 30.010937752109573}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.695437576795965, "mean_processing_ms": 3.0731087977917246, "mean_inference_ms": 1.970167948379369}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 681, "num_steps_trained": 34210304, "num_steps_sampled": 23680768, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7177, "num_samples_dropped": 205, "learner_queue": {"size_count": 30913, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.029, "replay_time_ms": 99.519, "update_priorities_time_ms": 51.347, "policy_agent_0": {"added_count": 907776, "sampled_count": 1363968, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 907776, "sampled_count": 1363968, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.256997108459473, "min_q": 11.144259452819824, "max_q": 11.259942054748535, "mean_td_error": 0.0016179010272026062, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.22011947631836, "min_q": 11.117775917053223, "max_q": 11.261724472045898, "mean_td_error": 0.038660138845443726, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 23680768, "episodes_total": 236808, "training_iteration": 227, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-35-33", "timestamp": 1569666933, "time_this_iter_s": 30.494801998138428, "time_total_s": 6931.581341505051, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ad158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1099.3726177215576, "timesteps_since_restore": 3674880, "iterations_since_restore": 36, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.43875724313926, "episode_reward_min": 58.734529892201294, "episode_reward_mean": 60.03619582739802, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.05408382865265, "agent_1": 29.982111998745438}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959565879529447, "mean_processing_ms": 3.0733875981766943, "mean_inference_ms": 1.9703172606636323}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 684, "num_steps_trained": 34360320, "num_steps_sampled": 23783680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7377, "num_samples_dropped": 205, "learner_queue": {"size_count": 31499, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.664, "replay_time_ms": 104.628, "update_priorities_time_ms": 48.988, "policy_agent_0": {"added_count": 934400, "sampled_count": 1400064, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 934400, "sampled_count": 1400064, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.263490676879883, "min_q": 11.178080558776855, "max_q": 11.267402648925781, "mean_td_error": 0.008737049996852875, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.194108009338379, "min_q": 11.044273376464844, "max_q": 11.215620994567871, "mean_td_error": 0.016048196703195572, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 23783680, "episodes_total": 237832, "training_iteration": 228, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-36-03", "timestamp": 1569666963, "time_this_iter_s": 30.479182243347168, "time_total_s": 6962.060523748398, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bc9d598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1129.8517999649048, "timesteps_since_restore": 3777792, "iterations_since_restore": 37, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.59288501807604, "episode_reward_min": 58.558450267550576, "episode_reward_mean": 60.067405158261906, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 30.009650462106016, "agent_1": 30.057754696155953}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6949934326263065, "mean_processing_ms": 3.0735037324931156, "mean_inference_ms": 1.9695561414319862}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 687, "num_steps_trained": 34507520, "num_steps_sampled": 23887616, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7580, "num_samples_dropped": 205, "learner_queue": {"size_count": 32074, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.64, "replay_time_ms": 107.835, "update_priorities_time_ms": 54.267, "policy_agent_0": {"added_count": 960768, "sampled_count": 1436928, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 960768, "sampled_count": 1436928, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.261439323425293, "min_q": 11.147394180297852, "max_q": 11.297884941101074, "mean_td_error": 0.025661014020442963, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.210028648376465, "min_q": 10.934879302978516, "max_q": 11.254751205444336, "mean_td_error": 0.009260844439268112, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 23887616, "episodes_total": 238888, "training_iteration": 229, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-36-34", "timestamp": 1569666994, "time_this_iter_s": 30.545962810516357, "time_total_s": 6992.606486558914, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bd46f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1160.3977627754211, "timesteps_since_restore": 3881728, "iterations_since_restore": 38, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.43645675037851, "episode_reward_min": 58.47621992037553, "episode_reward_mean": 60.056222360555104, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.061001365364042, "agent_1": 29.995220995191133}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6956028187143433, "mean_processing_ms": 3.072537233183017, "mean_inference_ms": 1.9695960824405592}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 690, "num_steps_trained": 34660352, "num_steps_sampled": 23989760, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7780, "num_samples_dropped": 205, "learner_queue": {"size_count": 32671, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 26.932, "replay_time_ms": 102.003, "update_priorities_time_ms": 49.355, "policy_agent_0": {"added_count": 984320, "sampled_count": 1475328, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 984320, "sampled_count": 1475328, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.253814697265625, "min_q": 11.146010398864746, "max_q": 11.26156234741211, "mean_td_error": 0.021325290203094482, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.189948081970215, "min_q": 10.981301307678223, "max_q": 11.240909576416016, "mean_td_error": 0.0133344866335392, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 23989760, "episodes_total": 239896, "training_iteration": 230, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-37-05", "timestamp": 1569667025, "time_this_iter_s": 30.645530939102173, "time_total_s": 7023.252017498016, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4162f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1191.0432937145233, "timesteps_since_restore": 3983872, "iterations_since_restore": 39, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.4823652573166, "episode_reward_min": 58.16814755122958, "episode_reward_mean": 60.04987582474179, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.057829633641937, "agent_1": 29.992046191099927}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6963381382004865, "mean_processing_ms": 3.073459559114518, "mean_inference_ms": 1.969268453088866}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 693, "num_steps_trained": 34808064, "num_steps_sampled": 24092416, "sample_throughput": 7420.802, "train_throughput": 7420.802, "num_weight_syncs": 7980, "num_samples_dropped": 205, "learner_queue": {"size_count": 33248, "size_mean": 0.22, "size_std": 0.41424630354415964, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.702, "replay_time_ms": 84.356, "update_priorities_time_ms": 45.78, "policy_agent_0": {"added_count": 1007872, "sampled_count": 1513984, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1007872, "sampled_count": 1513984, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.249635696411133, "min_q": 11.1039457321167, "max_q": 11.255817413330078, "mean_td_error": 0.0013203099370002747, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.236568450927734, "min_q": 11.116724014282227, "max_q": 11.291908264160156, "mean_td_error": 0.040379300713539124, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 24092416, "episodes_total": 240920, "training_iteration": 231, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-37-35", "timestamp": 1569667055, "time_this_iter_s": 30.523663759231567, "time_total_s": 7053.775681257248, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4400d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1221.5669574737549, "timesteps_since_restore": 4086528, "iterations_since_restore": 40, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.47297669095112, "episode_reward_min": 58.38210258618066, "episode_reward_mean": 60.07760315082693, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 30.0712296993641, "agent_1": 30.006373451462903}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6964267479245918, "mean_processing_ms": 3.0752212964290337, "mean_inference_ms": 1.9711859086162216}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 696, "num_steps_trained": 34961152, "num_steps_sampled": 24194560, "sample_throughput": 0.0, "train_throughput": 16036.768, "num_weight_syncs": 8180, "num_samples_dropped": 205, "learner_queue": {"size_count": 33846, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.944, "replay_time_ms": 97.485, "update_priorities_time_ms": 50.797, "policy_agent_0": {"added_count": 1037824, "sampled_count": 1551104, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1037824, "sampled_count": 1551104, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.255388259887695, "min_q": 11.157341957092285, "max_q": 11.290020942687988, "mean_td_error": 0.009281326085329056, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.255965232849121, "min_q": 10.874360084533691, "max_q": 11.286567687988281, "mean_td_error": 0.04578043147921562, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 24194560, "episodes_total": 241952, "training_iteration": 232, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-38-06", "timestamp": 1569667086, "time_this_iter_s": 30.679321765899658, "time_total_s": 7084.455003023148, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b42c510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1252.2462792396545, "timesteps_since_restore": 4188672, "iterations_since_restore": 41, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.472834126347415, "episode_reward_min": 58.319492561015906, "episode_reward_mean": 60.07817570779523, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.070675063746165, "agent_1": 30.00750064404914}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6954489525791073, "mean_processing_ms": 3.0741346978435726, "mean_inference_ms": 1.9720096393563844}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 699, "num_steps_trained": 35114240, "num_steps_sampled": 24296448, "sample_throughput": 13473.815, "train_throughput": 6736.908, "num_weight_syncs": 8379, "num_samples_dropped": 205, "learner_queue": {"size_count": 34444, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.263, "replay_time_ms": 70.668, "update_priorities_time_ms": 41.412, "policy_agent_0": {"added_count": 1065472, "sampled_count": 1589760, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1065472, "sampled_count": 1589760, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.254720687866211, "min_q": 11.09705924987793, "max_q": 11.268823623657227, "mean_td_error": 0.04099605232477188, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.281932830810547, "min_q": 11.179383277893066, "max_q": 11.307516098022461, "mean_td_error": 0.03534327447414398, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 24296448, "episodes_total": 242960, "training_iteration": 233, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-38-36", "timestamp": 1569667116, "time_this_iter_s": 30.509965181350708, "time_total_s": 7114.964968204498, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b437598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1282.7562444210052, "timesteps_since_restore": 4290560, "iterations_since_restore": 42, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.45864424477193, "episode_reward_min": 58.47373563922308, "episode_reward_mean": 60.030315727795674, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 30.05037391913646, "agent_1": 29.97994180865928}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959452863570401, "mean_processing_ms": 3.073933745330142, "mean_inference_ms": 1.9717805378189428}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 702, "num_steps_trained": 35268096, "num_steps_sampled": 24397312, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8576, "num_samples_dropped": 205, "learner_queue": {"size_count": 35045, "size_mean": 1.56, "size_std": 2.5935304123915723, "size_quantiles": [0.0, 0.0, 0.0, 6.100000000000001, 9.0]}, "replay_shard_0": {"add_batch_time_ms": 37.033, "replay_time_ms": 95.544, "update_priorities_time_ms": 48.244, "policy_agent_0": {"added_count": 1091840, "sampled_count": 1625600, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1091840, "sampled_count": 1625600, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.242552757263184, "min_q": 11.102317810058594, "max_q": 11.244980812072754, "mean_td_error": 0.03965390846133232, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.260316848754883, "min_q": 11.04684066772461, "max_q": 11.281227111816406, "mean_td_error": 0.01364842802286148, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 24397312, "episodes_total": 243976, "training_iteration": 234, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-39-07", "timestamp": 1569667147, "time_this_iter_s": 30.611943244934082, "time_total_s": 7145.576911449432, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b381f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1313.3681876659393, "timesteps_since_restore": 4391424, "iterations_since_restore": 43, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.48589314462524, "episode_reward_min": 58.430316939610506, "episode_reward_mean": 59.8716274953498, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 30.166375130037164, "agent_1": 29.705252365312717}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6966951440199988, "mean_processing_ms": 3.07378543406647, "mean_inference_ms": 1.972630583071042}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 705, "num_steps_trained": 35418624, "num_steps_sampled": 24499712, "sample_throughput": 8117.865, "train_throughput": 0.0, "num_weight_syncs": 8776, "num_samples_dropped": 205, "learner_queue": {"size_count": 35634, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.906, "replay_time_ms": 80.304, "update_priorities_time_ms": 38.129, "policy_agent_0": {"added_count": 1116160, "sampled_count": 1661696, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1116160, "sampled_count": 1661696, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.21013355255127, "min_q": 11.113382339477539, "max_q": 11.236103057861328, "mean_td_error": -0.005887787789106369, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.273972511291504, "min_q": 11.049093246459961, "max_q": 11.29167366027832, "mean_td_error": 0.030729074031114578, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 24499712, "episodes_total": 244992, "training_iteration": 235, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-39-38", "timestamp": 1569667178, "time_this_iter_s": 30.535499811172485, "time_total_s": 7176.112411260605, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b35cb70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1343.9036874771118, "timesteps_since_restore": 4493824, "iterations_since_restore": 44, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.61247595753752, "episode_reward_min": 52.50900145116729, "episode_reward_mean": 59.05770656973362, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 31.1854225775809, "agent_1": 27.87228399215283}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6968601095204843, "mean_processing_ms": 3.0740728524672196, "mean_inference_ms": 1.9726674015838503}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 708, "num_steps_trained": 35571968, "num_steps_sampled": 24602368, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8976, "num_samples_dropped": 205, "learner_queue": {"size_count": 36235, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.659, "replay_time_ms": 100.696, "update_priorities_time_ms": 51.235, "policy_agent_0": {"added_count": 1141248, "sampled_count": 1700608, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1141248, "sampled_count": 1700608, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.293567657470703, "min_q": 11.118138313293457, "max_q": 11.46924114227295, "mean_td_error": 0.04165814071893692, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.18940544128418, "min_q": 10.908209800720215, "max_q": 11.245546340942383, "mean_td_error": -0.0017238594591617584, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 24602368, "episodes_total": 246032, "training_iteration": 236, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-40-08", "timestamp": 1569667208, "time_this_iter_s": 30.595985412597656, "time_total_s": 7206.7083966732025, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b38d0d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1374.4996728897095, "timesteps_since_restore": 4596480, "iterations_since_restore": 45, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.32791134340787, "episode_reward_min": 46.318614003386955, "episode_reward_mean": 58.44674911673101, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 30.545378382707124, "agent_1": 27.901370734024002}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6972033229539892, "mean_processing_ms": 3.0753869917214387, "mean_inference_ms": 1.9742110187282444}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 712, "num_steps_trained": 35729664, "num_steps_sampled": 24702208, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9171, "num_samples_dropped": 205, "learner_queue": {"size_count": 36848, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.721, "replay_time_ms": 97.529, "update_priorities_time_ms": 49.045, "policy_agent_0": {"added_count": 1166080, "sampled_count": 1738496, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1166080, "sampled_count": 1738496, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.378170013427734, "min_q": 11.003337860107422, "max_q": 11.724905967712402, "mean_td_error": 0.023951400071382523, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.03221321105957, "min_q": 10.70345401763916, "max_q": 11.197139739990234, "mean_td_error": 0.0206407830119133, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 24702208, "episodes_total": 247016, "training_iteration": 237, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-40-39", "timestamp": 1569667239, "time_this_iter_s": 30.49224853515625, "time_total_s": 7237.200645208359, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b38dc80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1404.9919214248657, "timesteps_since_restore": 4696320, "iterations_since_restore": 46, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.35806211524823, "episode_reward_min": 57.39256372910388, "episode_reward_mean": 58.92048866554113, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 30.819354710443548, "agent_1": 28.101133955097698}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6964600505548975, "mean_processing_ms": 3.074163878589135, "mean_inference_ms": 1.9735963337711644}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 714, "num_steps_trained": 35878400, "num_steps_sampled": 24806400, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9375, "num_samples_dropped": 205, "learner_queue": {"size_count": 37429, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.075, "replay_time_ms": 100.839, "update_priorities_time_ms": 50.791, "policy_agent_0": {"added_count": 1189888, "sampled_count": 1776896, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1189888, "sampled_count": 1776896, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.356292724609375, "min_q": 10.923956871032715, "max_q": 11.80523681640625, "mean_td_error": 0.02314169332385063, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.87771224975586, "min_q": 10.658931732177734, "max_q": 11.068599700927734, "mean_td_error": 0.02600783482193947, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 24806400, "episodes_total": 248072, "training_iteration": 238, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-41-09", "timestamp": 1569667269, "time_this_iter_s": 30.561657905578613, "time_total_s": 7267.762303113937, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3971e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1435.5535793304443, "timesteps_since_restore": 4800512, "iterations_since_restore": 47, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.342730292341955, "episode_reward_min": 57.08645753732759, "episode_reward_mean": 58.924465597856084, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.825425281805906, "agent_1": 28.099040316050292}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6967342250458217, "mean_processing_ms": 3.0754109041080824, "mean_inference_ms": 1.9739580092515185}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 718, "num_steps_trained": 36029952, "num_steps_sampled": 24909568, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9576, "num_samples_dropped": 205, "learner_queue": {"size_count": 38023, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.6, "replay_time_ms": 83.738, "update_priorities_time_ms": 41.564, "policy_agent_0": {"added_count": 1216768, "sampled_count": 1814528, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1216768, "sampled_count": 1814528, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.38005256652832, "min_q": 10.983593940734863, "max_q": 11.795816421508789, "mean_td_error": 0.042196907103061676, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.762748718261719, "min_q": 10.489129066467285, "max_q": 10.819826126098633, "mean_td_error": 0.0328478179872036, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 24909568, "episodes_total": 249096, "training_iteration": 239, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-41-40", "timestamp": 1569667300, "time_this_iter_s": 30.46322751045227, "time_total_s": 7298.22553062439, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b397d90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1466.0168068408966, "timesteps_since_restore": 4903680, "iterations_since_restore": 48, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.3699032826488, "episode_reward_min": 57.74614700972546, "episode_reward_mean": 59.05478556731469, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 30.767908543247355, "agent_1": 28.286877024067447}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6968114247793968, "mean_processing_ms": 3.0766782929174408, "mean_inference_ms": 1.974310181126013}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 721, "num_steps_trained": 36183296, "num_steps_sampled": 25010432, "sample_throughput": 0.0, "train_throughput": 13448.839, "num_weight_syncs": 9774, "num_samples_dropped": 205, "learner_queue": {"size_count": 38620, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.49, "replay_time_ms": 107.402, "update_priorities_time_ms": 53.57, "policy_agent_0": {"added_count": 1239296, "sampled_count": 1852928, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1239296, "sampled_count": 1852928, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.373306274414062, "min_q": 11.250418663024902, "max_q": 11.479785919189453, "mean_td_error": 0.004364632070064545, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.717269897460938, "min_q": 10.5852689743042, "max_q": 10.750200271606445, "mean_td_error": 0.023523014038801193, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 25010432, "episodes_total": 250112, "training_iteration": 240, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-42-10", "timestamp": 1569667330, "time_this_iter_s": 30.62885308265686, "time_total_s": 7328.8543837070465, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4522f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1496.6456599235535, "timesteps_since_restore": 5004544, "iterations_since_restore": 49, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.31696907518243, "episode_reward_min": 57.76029965667272, "episode_reward_mean": 59.04038784852072, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 30.779371001559483, "agent_1": 28.26101684696136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959367841618176, "mean_processing_ms": 3.0754512920481907, "mean_inference_ms": 1.9723685870386336}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 724, "num_steps_trained": 36332544, "num_steps_sampled": 25115648, "sample_throughput": 6943.269, "train_throughput": 0.0, "num_weight_syncs": 9979, "num_samples_dropped": 205, "learner_queue": {"size_count": 39203, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.762, "replay_time_ms": 86.899, "update_priorities_time_ms": 56.193, "policy_agent_0": {"added_count": 1266944, "sampled_count": 1890560, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1266944, "sampled_count": 1890560, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.436420440673828, "min_q": 11.223895072937012, "max_q": 11.501077651977539, "mean_td_error": 0.03706663101911545, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.684643745422363, "min_q": 10.541497230529785, "max_q": 10.759737968444824, "mean_td_error": 0.005596216768026352, "model": {}}}}, "timesteps_this_iter": 105216, "done": false, "timesteps_total": 25115648, "episodes_total": 251152, "training_iteration": 241, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-42-41", "timestamp": 1569667361, "time_this_iter_s": 30.642619848251343, "time_total_s": 7359.497003555298, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b452e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1527.2882797718048, "timesteps_since_restore": 5109760, "iterations_since_restore": 50, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.31158728066582, "episode_reward_min": 57.68248165358365, "episode_reward_mean": 58.96479630247049, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 30.846729784500805, "agent_1": 28.118066517969798}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6958531544019645, "mean_processing_ms": 3.0754550025354255, "mean_inference_ms": 1.9725902897788197}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 727, "num_steps_trained": 36486912, "num_steps_sampled": 25218048, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10179, "num_samples_dropped": 205, "learner_queue": {"size_count": 39806, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.683, "replay_time_ms": 96.838, "update_priorities_time_ms": 53.797, "policy_agent_0": {"added_count": 1292288, "sampled_count": 1928448, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1292288, "sampled_count": 1928448, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.440394401550293, "min_q": 11.353402137756348, "max_q": 11.494592666625977, "mean_td_error": 0.011373993009328842, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.656153678894043, "min_q": 10.433871269226074, "max_q": 10.755086898803711, "mean_td_error": 0.005558285862207413, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 25218048, "episodes_total": 252184, "training_iteration": 242, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-43-12", "timestamp": 1569667392, "time_this_iter_s": 30.64368438720703, "time_total_s": 7390.140687942505, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b401400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1557.9319641590118, "timesteps_since_restore": 5212160, "iterations_since_restore": 51, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.37441724171412, "episode_reward_min": 57.857313688321504, "episode_reward_mean": 58.98516858069766, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.847665213293144, "agent_1": 28.137503367404626}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959786453124581, "mean_processing_ms": 3.075040836225851, "mean_inference_ms": 1.9726281906068106}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 730, "num_steps_trained": 36640256, "num_steps_sampled": 25321216, "sample_throughput": 7417.444, "train_throughput": 0.0, "num_weight_syncs": 10380, "num_samples_dropped": 205, "learner_queue": {"size_count": 40405, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.385, "replay_time_ms": 109.899, "update_priorities_time_ms": 51.683, "policy_agent_0": {"added_count": 1317120, "sampled_count": 1964288, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1317120, "sampled_count": 1964288, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.453970909118652, "min_q": 11.362272262573242, "max_q": 11.54769515991211, "mean_td_error": 0.01466454192996025, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.61386489868164, "min_q": 10.469943046569824, "max_q": 10.730376243591309, "mean_td_error": 0.0230938158929348, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 25321216, "episodes_total": 253208, "training_iteration": 243, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-43-42", "timestamp": 1569667422, "time_this_iter_s": 30.54160475730896, "time_total_s": 7420.682292699814, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ee048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1588.4735689163208, "timesteps_since_restore": 5315328, "iterations_since_restore": 52, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.32585661973839, "episode_reward_min": 57.59072339485922, "episode_reward_mean": 58.98071939868373, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 30.83212130680692, "agent_1": 28.148598091876927}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6966559187316641, "mean_processing_ms": 3.0749656742232827, "mean_inference_ms": 1.9731921197813158}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 733, "num_steps_trained": 36794368, "num_steps_sampled": 25424128, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10582, "num_samples_dropped": 205, "learner_queue": {"size_count": 41007, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.947, "replay_time_ms": 93.804, "update_priorities_time_ms": 46.993, "policy_agent_0": {"added_count": 1341696, "sampled_count": 2001408, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1341696, "sampled_count": 2001408, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.450277328491211, "min_q": 11.355972290039062, "max_q": 11.485118865966797, "mean_td_error": 0.021864891052246094, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.590346336364746, "min_q": 10.449514389038086, "max_q": 10.659561157226562, "mean_td_error": 0.024932462722063065, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 25424128, "episodes_total": 254240, "training_iteration": 244, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-44-13", "timestamp": 1569667453, "time_this_iter_s": 30.584893226623535, "time_total_s": 7451.267185926437, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d0510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1619.0584621429443, "timesteps_since_restore": 5418240, "iterations_since_restore": 53, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.332797165116546, "episode_reward_min": 58.09375385463255, "episode_reward_mean": 58.98661040701403, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 30.838092146876907, "agent_1": 28.14851826013724}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6965043282420703, "mean_processing_ms": 3.0748771648974036, "mean_inference_ms": 1.9729747536682576}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 736, "num_steps_trained": 36942592, "num_steps_sampled": 25528832, "sample_throughput": 7698.454, "train_throughput": 0.0, "num_weight_syncs": 10786, "num_samples_dropped": 205, "learner_queue": {"size_count": 41587, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.977, "replay_time_ms": 91.305, "update_priorities_time_ms": 47.36, "policy_agent_0": {"added_count": 1367808, "sampled_count": 2038528, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1367808, "sampled_count": 2038528, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.46667194366455, "min_q": 11.415854454040527, "max_q": 11.473319053649902, "mean_td_error": 0.01743122935295105, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.54731273651123, "min_q": 10.424018859863281, "max_q": 10.565411567687988, "mean_td_error": 0.03222087398171425, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 25528832, "episodes_total": 255288, "training_iteration": 245, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-44-43", "timestamp": 1569667483, "time_this_iter_s": 30.464942693710327, "time_total_s": 7481.732128620148, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d2158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1649.5234048366547, "timesteps_since_restore": 5522944, "iterations_since_restore": 54, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.33414061144144, "episode_reward_min": 55.21248115255931, "episode_reward_mean": 58.867560507967674, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.668636664578884, "agent_1": 28.198923843388908}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6965386680685806, "mean_processing_ms": 3.0751760762048077, "mean_inference_ms": 1.9728176057000688}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 739, "num_steps_trained": 37098240, "num_steps_sampled": 25631232, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10986, "num_samples_dropped": 205, "learner_queue": {"size_count": 42194, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.327, "replay_time_ms": 91.686, "update_priorities_time_ms": 44.857, "policy_agent_0": {"added_count": 1394176, "sampled_count": 2075648, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1394176, "sampled_count": 2075648, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.471660614013672, "min_q": 11.360550880432129, "max_q": 11.50407600402832, "mean_td_error": 0.04034208133816719, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.543055534362793, "min_q": 10.311415672302246, "max_q": 10.584125518798828, "mean_td_error": 0.0014738552272319794, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 25631232, "episodes_total": 256312, "training_iteration": 246, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-45-14", "timestamp": 1569667514, "time_this_iter_s": 30.509853839874268, "time_total_s": 7512.241982460022, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d8620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1680.033258676529, "timesteps_since_restore": 5625344, "iterations_since_restore": 55, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.38187828625425, "episode_reward_min": 54.71318814806628, "episode_reward_mean": 56.44222555341341, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.57106341593624, "agent_1": 29.87116213747727}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6968734375047045, "mean_processing_ms": 3.0742696905404627, "mean_inference_ms": 1.9717692112304195}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 742, "num_steps_trained": 37254144, "num_steps_sampled": 25733376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11186, "num_samples_dropped": 205, "learner_queue": {"size_count": 42803, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.583, "replay_time_ms": 101.421, "update_priorities_time_ms": 50.527, "policy_agent_0": {"added_count": 1417216, "sampled_count": 2115072, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1417216, "sampled_count": 2115072, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.336124420166016, "min_q": 10.988174438476562, "max_q": 11.388975143432617, "mean_td_error": 0.0496019646525383, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.657815933227539, "min_q": 10.395624160766602, "max_q": 10.696222305297852, "mean_td_error": 0.028819791972637177, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 25733376, "episodes_total": 257336, "training_iteration": 247, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-45-45", "timestamp": 1569667545, "time_this_iter_s": 30.51124095916748, "time_total_s": 7542.753223419189, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0da268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1710.5444996356964, "timesteps_since_restore": 5727488, "iterations_since_restore": 56, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.45495303528678, "episode_reward_min": 58.82100703645263, "episode_reward_mean": 60.08216389615346, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 30.005340797673092, "agent_1": 30.076823098480435}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6962735829372543, "mean_processing_ms": 3.0737854104545477, "mean_inference_ms": 1.9723753775504742}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 745, "num_steps_trained": 37410816, "num_steps_sampled": 25836032, "sample_throughput": 0.0, "train_throughput": 15293.725, "num_weight_syncs": 11387, "num_samples_dropped": 205, "learner_queue": {"size_count": 43415, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.414, "replay_time_ms": 105.442, "update_priorities_time_ms": 55.868, "policy_agent_0": {"added_count": 1443072, "sampled_count": 2151680, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1443072, "sampled_count": 2151680, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.257842063903809, "min_q": 11.100122451782227, "max_q": 11.328903198242188, "mean_td_error": 0.029703252017498016, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.78341007232666, "min_q": 10.677437782287598, "max_q": 10.815473556518555, "mean_td_error": -0.002101268619298935, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 25836032, "episodes_total": 258368, "training_iteration": 248, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-46-15", "timestamp": 1569667575, "time_this_iter_s": 30.637717962265015, "time_total_s": 7573.3909413814545, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f2730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1741.1822175979614, "timesteps_since_restore": 5830144, "iterations_since_restore": 57, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.47207030283572, "episode_reward_min": 58.86195552598743, "episode_reward_mean": 60.04588363449143, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 29.994883713282512, "agent_1": 30.050999921208998}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6966820228281637, "mean_processing_ms": 3.072993032502319, "mean_inference_ms": 1.972328818285914}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 748, "num_steps_trained": 37564928, "num_steps_sampled": 25938432, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11586, "num_samples_dropped": 205, "learner_queue": {"size_count": 44017, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 43.949, "replay_time_ms": 102.399, "update_priorities_time_ms": 54.072, "policy_agent_0": {"added_count": 1470208, "sampled_count": 2185728, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1470208, "sampled_count": 2185728, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.187487602233887, "min_q": 11.03901195526123, "max_q": 11.279237747192383, "mean_td_error": 0.022001218050718307, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.881187438964844, "min_q": 10.767611503601074, "max_q": 10.916990280151367, "mean_td_error": 0.028954915702342987, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 25938432, "episodes_total": 259384, "training_iteration": 249, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-46-46", "timestamp": 1569667606, "time_this_iter_s": 30.642866134643555, "time_total_s": 7604.033807516098, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d0620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1771.825083732605, "timesteps_since_restore": 5932544, "iterations_since_restore": 58, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.45414819011095, "episode_reward_min": 49.18051058802865, "episode_reward_mean": 59.379408374722736, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 29.578388758921058, "agent_1": 29.801019615801742}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959339355648246, "mean_processing_ms": 3.0744872687190643, "mean_inference_ms": 1.9736115315810905}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 751, "num_steps_trained": 37719296, "num_steps_sampled": 26041088, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11787, "num_samples_dropped": 205, "learner_queue": {"size_count": 44620, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.751, "replay_time_ms": 105.886, "update_priorities_time_ms": 55.921, "policy_agent_0": {"added_count": 1497856, "sampled_count": 2223104, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1497856, "sampled_count": 2223104, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.209783554077148, "min_q": 11.084182739257812, "max_q": 11.218819618225098, "mean_td_error": 0.01455705612897873, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.994624137878418, "min_q": 10.876191139221191, "max_q": 11.02858829498291, "mean_td_error": 0.05514110252261162, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 26041088, "episodes_total": 260408, "training_iteration": 250, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-47-17", "timestamp": 1569667637, "time_this_iter_s": 30.601842641830444, "time_total_s": 7634.6356501579285, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4527b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1802.4269263744354, "timesteps_since_restore": 6035200, "iterations_since_restore": 59, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.484110883572725, "episode_reward_min": 58.85590645807893, "episode_reward_mean": 60.109678120067706, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 30.07451881624433, "agent_1": 30.035159303823452}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6963433466605007, "mean_processing_ms": 3.072814853409814, "mean_inference_ms": 1.972381603485853}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 754, "num_steps_trained": 37872640, "num_steps_sampled": 26144000, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11988, "num_samples_dropped": 205, "learner_queue": {"size_count": 45220, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.305, "replay_time_ms": 95.17, "update_priorities_time_ms": 51.114, "policy_agent_0": {"added_count": 1520896, "sampled_count": 2258944, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1520896, "sampled_count": 2258944, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.218637466430664, "min_q": 11.076231002807617, "max_q": 11.225868225097656, "mean_td_error": 0.021834339946508408, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.016926765441895, "min_q": 10.841643333435059, "max_q": 11.051396369934082, "mean_td_error": 0.013842470943927765, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 26144000, "episodes_total": 261440, "training_iteration": 251, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-47-47", "timestamp": 1569667667, "time_this_iter_s": 30.612799406051636, "time_total_s": 7665.24844956398, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b381840>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1833.039725780487, "timesteps_since_restore": 6138112, "iterations_since_restore": 60, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.48294784669332, "episode_reward_min": 58.6764367118214, "episode_reward_mean": 60.0675545199172, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 30.058258099352855, "agent_1": 30.00929642056443}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6954137907470037, "mean_processing_ms": 3.07364312843307, "mean_inference_ms": 1.973075881450142}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 757, "num_steps_trained": 38029056, "num_steps_sampled": 26247680, "sample_throughput": 7619.946, "train_throughput": 0.0, "num_weight_syncs": 12191, "num_samples_dropped": 205, "learner_queue": {"size_count": 45831, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.338, "replay_time_ms": 82.653, "update_priorities_time_ms": 46.126, "policy_agent_0": {"added_count": 1538304, "sampled_count": 2297856, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1538304, "sampled_count": 2297856, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.234236717224121, "min_q": 11.037797927856445, "max_q": 11.242785453796387, "mean_td_error": 0.000912986695766449, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.06357192993164, "min_q": 10.94151782989502, "max_q": 11.080093383789062, "mean_td_error": 0.04221776872873306, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 26247680, "episodes_total": 262480, "training_iteration": 252, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-48-18", "timestamp": 1569667698, "time_this_iter_s": 30.512367248535156, "time_total_s": 7695.760816812515, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4377b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1863.5520930290222, "timesteps_since_restore": 6241792, "iterations_since_restore": 61, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.952568911733096, "episode_reward_min": 58.60983215119523, "episode_reward_mean": 60.082873161500174, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 30.027243285188973, "agent_1": 30.05562987631128}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.695455389958096, "mean_processing_ms": 3.07281439691501, "mean_inference_ms": 1.9729229510723403}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 760, "num_steps_trained": 38183424, "num_steps_sampled": 26352128, "sample_throughput": 0.0, "train_throughput": 31452.98, "num_weight_syncs": 12394, "num_samples_dropped": 205, "learner_queue": {"size_count": 46433, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.408, "replay_time_ms": 85.85, "update_priorities_time_ms": 47.82, "policy_agent_0": {"added_count": 1563648, "sampled_count": 2334208, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1563648, "sampled_count": 2334208, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.232348442077637, "min_q": 11.093254089355469, "max_q": 11.257079124450684, "mean_td_error": 0.007013034075498581, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.045282363891602, "min_q": 10.747149467468262, "max_q": 11.174076080322266, "mean_td_error": 0.028905250132083893, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 26352128, "episodes_total": 263520, "training_iteration": 253, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-48-48", "timestamp": 1569667728, "time_this_iter_s": 30.52213191986084, "time_total_s": 7726.282948732376, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b42c6a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1894.074224948883, "timesteps_since_restore": 6346240, "iterations_since_restore": 62, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.50901981625323, "episode_reward_min": 58.569460450446535, "episode_reward_mean": 60.040130061878294, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 30.047930062135464, "agent_1": 29.99219999974291}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6953096979235608, "mean_processing_ms": 3.0720201324188916, "mean_inference_ms": 1.9717950549161594}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 763, "num_steps_trained": 38335232, "num_steps_sampled": 26456064, "sample_throughput": 16348.577, "train_throughput": 0.0, "num_weight_syncs": 12597, "num_samples_dropped": 205, "learner_queue": {"size_count": 47026, "size_mean": 0.28, "size_std": 0.44899888641287294, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.187, "replay_time_ms": 82.035, "update_priorities_time_ms": 42.722, "policy_agent_0": {"added_count": 1593088, "sampled_count": 2369792, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1593088, "sampled_count": 2369792, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.248594284057617, "min_q": 11.122233390808105, "max_q": 11.276985168457031, "mean_td_error": 0.011370111256837845, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.082955360412598, "min_q": 10.96694278717041, "max_q": 11.2031831741333, "mean_td_error": 0.006822235882282257, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 26456064, "episodes_total": 264560, "training_iteration": 254, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-49-19", "timestamp": 1569667759, "time_this_iter_s": 30.570140600204468, "time_total_s": 7756.853089332581, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4169d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1924.6443655490875, "timesteps_since_restore": 6450176, "iterations_since_restore": 63, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.45624054113641, "episode_reward_min": 58.639140610129026, "episode_reward_mean": 60.051500855620304, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.056502697686188, "agent_1": 29.994998157934198}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6947903503163576, "mean_processing_ms": 3.072224164515034, "mean_inference_ms": 1.9715551332191263}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 766, "num_steps_trained": 38489344, "num_steps_sampled": 26557952, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12796, "num_samples_dropped": 205, "learner_queue": {"size_count": 47628, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.211, "replay_time_ms": 83.03, "update_priorities_time_ms": 45.299, "policy_agent_0": {"added_count": 1622784, "sampled_count": 2405632, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1622784, "sampled_count": 2405632, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.246589660644531, "min_q": 11.13220500946045, "max_q": 11.248552322387695, "mean_td_error": 0.023591961711645126, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.158267974853516, "min_q": 10.907811164855957, "max_q": 11.19970417022705, "mean_td_error": 0.015659146010875702, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 26557952, "episodes_total": 265584, "training_iteration": 255, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-49-50", "timestamp": 1569667790, "time_this_iter_s": 30.566989421844482, "time_total_s": 7787.420078754425, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b416158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1955.211354970932, "timesteps_since_restore": 6552064, "iterations_since_restore": 64, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.48675552845367, "episode_reward_min": 58.55278288464336, "episode_reward_mean": 60.054469022359584, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 30.05617289410857, "agent_1": 29.99829612825109}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6949247371235948, "mean_processing_ms": 3.0741443081709243, "mean_inference_ms": 1.9733179730824018}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 770, "num_steps_trained": 38646528, "num_steps_sampled": 26659328, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12994, "num_samples_dropped": 205, "learner_queue": {"size_count": 48242, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 23.349, "replay_time_ms": 94.218, "update_priorities_time_ms": 43.486, "policy_agent_0": {"added_count": 1647360, "sampled_count": 2446848, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1647360, "sampled_count": 2446848, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.263715744018555, "min_q": 11.186984062194824, "max_q": 11.29836654663086, "mean_td_error": 0.01402955874800682, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.166954040527344, "min_q": 10.976184844970703, "max_q": 11.223597526550293, "mean_td_error": 0.01975521817803383, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 26659328, "episodes_total": 266600, "training_iteration": 256, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-50-20", "timestamp": 1569667820, "time_this_iter_s": 30.506430625915527, "time_total_s": 7817.926509380341, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bd467b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1985.7177855968475, "timesteps_since_restore": 6653440, "iterations_since_restore": 65, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.48023424715085, "episode_reward_min": 58.721168018570324, "episode_reward_mean": 60.05778344958297, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.05747657672294, "agent_1": 30.000306872860108}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6952405650289115, "mean_processing_ms": 3.0732358198977816, "mean_inference_ms": 1.9731578844682143}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 773, "num_steps_trained": 38803968, "num_steps_sampled": 26761728, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13194, "num_samples_dropped": 205, "learner_queue": {"size_count": 48857, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.433, "replay_time_ms": 101.714, "update_priorities_time_ms": 50.144, "policy_agent_0": {"added_count": 1676032, "sampled_count": 2484992, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1676032, "sampled_count": 2484992, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.247207641601562, "min_q": 11.1494722366333, "max_q": 11.27070426940918, "mean_td_error": 0.02983967214822769, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.191938400268555, "min_q": 10.9999418258667, "max_q": 11.19851303100586, "mean_td_error": 0.04262428358197212, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 26761728, "episodes_total": 267624, "training_iteration": 257, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-50-51", "timestamp": 1569667851, "time_this_iter_s": 30.510886192321777, "time_total_s": 7848.437395572662, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bc9d488>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2016.2286717891693, "timesteps_since_restore": 6755840, "iterations_since_restore": 66, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.49159405690868, "episode_reward_min": 58.46823768688195, "episode_reward_mean": 60.05140979360679, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 30.055063059136135, "agent_1": 29.99634673447074}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6952501751679857, "mean_processing_ms": 3.071798004474436, "mean_inference_ms": 1.9724268256203585}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 776, "num_steps_trained": 38957312, "num_steps_sampled": 26865152, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13396, "num_samples_dropped": 205, "learner_queue": {"size_count": 49456, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.588, "replay_time_ms": 97.634, "update_priorities_time_ms": 46.362, "policy_agent_0": {"added_count": 1699584, "sampled_count": 2523392, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1699584, "sampled_count": 2523392, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.231085777282715, "min_q": 11.107830047607422, "max_q": 11.281766891479492, "mean_td_error": 0.016412507742643356, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.20846176147461, "min_q": 11.0125150680542, "max_q": 11.247620582580566, "mean_td_error": -0.0008340366184711456, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 26865152, "episodes_total": 268656, "training_iteration": 258, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-51-21", "timestamp": 1569667881, "time_this_iter_s": 30.59265446662903, "time_total_s": 7879.030050039291, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3c3048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2046.8213262557983, "timesteps_since_restore": 6859264, "iterations_since_restore": 67, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.442267184928205, "episode_reward_min": 58.63705037618208, "episode_reward_mean": 60.0647205489746, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.06124152888896, "agent_1": 30.003479020085713}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6961015386942455, "mean_processing_ms": 3.073765849092229, "mean_inference_ms": 1.9727410638842404}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 779, "num_steps_trained": 39115008, "num_steps_sampled": 26966528, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13594, "num_samples_dropped": 205, "learner_queue": {"size_count": 50073, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.127, "replay_time_ms": 112.81, "update_priorities_time_ms": 48.182, "policy_agent_0": {"added_count": 1722880, "sampled_count": 2561280, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1722880, "sampled_count": 2561280, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.23897933959961, "min_q": 11.120043754577637, "max_q": 11.24839973449707, "mean_td_error": 0.06169336289167404, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.191370964050293, "min_q": 10.985629081726074, "max_q": 11.197135925292969, "mean_td_error": 0.01603744924068451, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 26966528, "episodes_total": 269664, "training_iteration": 259, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-51-52", "timestamp": 1569667912, "time_this_iter_s": 30.528605461120605, "time_total_s": 7909.558655500412, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ad510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2077.349931716919, "timesteps_since_restore": 6960640, "iterations_since_restore": 68, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.51144828658829, "episode_reward_min": 58.46920647371593, "episode_reward_mean": 60.08564390327751, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 30.054187100563265, "agent_1": 30.031456802714317}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6954411479165363, "mean_processing_ms": 3.07256157181618, "mean_inference_ms": 1.9724100840947856}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 782, "num_steps_trained": 39267328, "num_steps_sampled": 27070720, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13797, "num_samples_dropped": 205, "learner_queue": {"size_count": 50667, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.791, "replay_time_ms": 116.226, "update_priorities_time_ms": 52.253, "policy_agent_0": {"added_count": 1749760, "sampled_count": 2597120, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1749760, "sampled_count": 2597120, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.203184127807617, "min_q": 11.08515739440918, "max_q": 11.206560134887695, "mean_td_error": 0.012952737510204315, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.19778823852539, "min_q": 11.0880708694458, "max_q": 11.209259986877441, "mean_td_error": 0.045623116195201874, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 27070720, "episodes_total": 270704, "training_iteration": 260, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-52-22", "timestamp": 1569667942, "time_this_iter_s": 30.561564445495605, "time_total_s": 7940.120219945908, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3afae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2107.9114961624146, "timesteps_since_restore": 7064832, "iterations_since_restore": 69, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.47405266714456, "episode_reward_min": 58.884916038391836, "episode_reward_mean": 60.121783605928485, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 30.065457105233133, "agent_1": 30.056326500695427}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959951712531559, "mean_processing_ms": 3.0710686772038382, "mean_inference_ms": 1.9713887230027793}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 785, "num_steps_trained": 39420928, "num_steps_sampled": 27175936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14002, "num_samples_dropped": 205, "learner_queue": {"size_count": 51267, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.451, "replay_time_ms": 91.917, "update_priorities_time_ms": 43.618, "policy_agent_0": {"added_count": 1779712, "sampled_count": 2633728, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1779712, "sampled_count": 2633728, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.239446640014648, "min_q": 11.123498916625977, "max_q": 11.244593620300293, "mean_td_error": 0.025438722223043442, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.227471351623535, "min_q": 10.987226486206055, "max_q": 11.268160820007324, "mean_td_error": 0.027118809521198273, "model": {}}}}, "timesteps_this_iter": 105216, "done": false, "timesteps_total": 27175936, "episodes_total": 271760, "training_iteration": 261, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-52-53", "timestamp": 1569667973, "time_this_iter_s": 30.529995679855347, "time_total_s": 7970.650215625763, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b356840>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2138.44149184227, "timesteps_since_restore": 7170048, "iterations_since_restore": 70, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.47048861996194, "episode_reward_min": 58.969784019795185, "episode_reward_mean": 60.15543329845798, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 30.07926402788626, "agent_1": 30.0761692705718}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6954320958783274, "mean_processing_ms": 3.072604164007438, "mean_inference_ms": 1.9716341425394757}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 788, "num_steps_trained": 39574784, "num_steps_sampled": 27276544, "sample_throughput": 22835.853, "train_throughput": 0.0, "num_weight_syncs": 14199, "num_samples_dropped": 205, "learner_queue": {"size_count": 51868, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.812, "replay_time_ms": 98.307, "update_priorities_time_ms": 54.142, "policy_agent_0": {"added_count": 1804032, "sampled_count": 2670336, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1804032, "sampled_count": 2670336, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.246838569641113, "min_q": 11.122797012329102, "max_q": 11.251882553100586, "mean_td_error": 0.027008190751075745, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.180598258972168, "min_q": 11.0381441116333, "max_q": 11.207279205322266, "mean_td_error": 0.004542384296655655, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 27276544, "episodes_total": 272776, "training_iteration": 262, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-53-23", "timestamp": 1569668003, "time_this_iter_s": 30.51192593574524, "time_total_s": 8001.162141561508, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b47d378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2168.953417778015, "timesteps_since_restore": 7270656, "iterations_since_restore": 71, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.249814521107965, "episode_reward_min": 58.865314407936744, "episode_reward_mean": 60.183131998983896, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.058188522207665, "agent_1": 30.12494347677631}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6958695916976911, "mean_processing_ms": 3.0718691111748564, "mean_inference_ms": 1.971890585072391}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 791, "num_steps_trained": 39731200, "num_steps_sampled": 27379456, "sample_throughput": 13259.018, "train_throughput": 0.0, "num_weight_syncs": 14400, "num_samples_dropped": 205, "learner_queue": {"size_count": 52480, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.218, "replay_time_ms": 98.088, "update_priorities_time_ms": 51.425, "policy_agent_0": {"added_count": 1829632, "sampled_count": 2710528, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1829632, "sampled_count": 2710528, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.226054191589355, "min_q": 11.129267692565918, "max_q": 11.254502296447754, "mean_td_error": 0.023775722831487656, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.215801239013672, "min_q": 11.013630867004395, "max_q": 11.254616737365723, "mean_td_error": 0.040940333157777786, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 27379456, "episodes_total": 273800, "training_iteration": 263, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-53-54", "timestamp": 1569668034, "time_this_iter_s": 30.523884296417236, "time_total_s": 8031.686025857925, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b47df28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2199.4773020744324, "timesteps_since_restore": 7373568, "iterations_since_restore": 72, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.542037269563494, "episode_reward_min": 58.94134440252056, "episode_reward_mean": 60.162262487743185, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 30.09651186330565, "agent_1": 30.065750624437605}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.69534609006354, "mean_processing_ms": 3.0722062925838562, "mean_inference_ms": 1.971709697472492}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 794, "num_steps_trained": 39884544, "num_steps_sampled": 27482624, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14601, "num_samples_dropped": 205, "learner_queue": {"size_count": 53078, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.345, "replay_time_ms": 117.096, "update_priorities_time_ms": 56.073, "policy_agent_0": {"added_count": 1856768, "sampled_count": 2745600, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1856768, "sampled_count": 2745600, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.211651802062988, "min_q": 11.09178638458252, "max_q": 11.229206085205078, "mean_td_error": 0.013307832181453705, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.235600471496582, "min_q": 11.058781623840332, "max_q": 11.269604682922363, "mean_td_error": 0.020015522837638855, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 27482624, "episodes_total": 274832, "training_iteration": 264, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-54-25", "timestamp": 1569668065, "time_this_iter_s": 30.513179540634155, "time_total_s": 8062.19920539856, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3b2488>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2229.9904816150665, "timesteps_since_restore": 7476736, "iterations_since_restore": 73, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.87472796247864, "episode_reward_min": 58.920394824257436, "episode_reward_mean": 60.48610644838875, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 31.02610088097836, "agent_1": 29.460005567410466}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6953344762246877, "mean_processing_ms": 3.0715120750972607, "mean_inference_ms": 1.9724563236252481}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 797, "num_steps_trained": 40033280, "num_steps_sampled": 27584000, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14800, "num_samples_dropped": 205, "learner_queue": {"size_count": 53659, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 27.383, "replay_time_ms": 95.891, "update_priorities_time_ms": 53.625, "policy_agent_0": {"added_count": 1885184, "sampled_count": 2780672, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1885184, "sampled_count": 2780672, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.264625549316406, "min_q": 11.104748725891113, "max_q": 11.510358810424805, "mean_td_error": -0.0019370727241039276, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.201383590698242, "min_q": 11.062808990478516, "max_q": 11.239614486694336, "mean_td_error": 0.01937161758542061, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 27584000, "episodes_total": 275848, "training_iteration": 265, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-54-55", "timestamp": 1569668095, "time_this_iter_s": 30.090485334396362, "time_total_s": 8092.289690732956, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3820d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2260.080966949463, "timesteps_since_restore": 7578112, "iterations_since_restore": 74, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.311617597659954, "episode_reward_min": 58.81301705116826, "episode_reward_mean": 60.011342080872744, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 29.976428718045756, "agent_1": 30.034913362827105}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6957145459903404, "mean_processing_ms": 3.072971293583597, "mean_inference_ms": 1.9729270137841797}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 800, "num_steps_trained": 40187904, "num_steps_sampled": 27685632, "sample_throughput": 0.0, "train_throughput": 25224.747, "num_weight_syncs": 14999, "num_samples_dropped": 205, "learner_queue": {"size_count": 54264, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.954, "replay_time_ms": 109.561, "update_priorities_time_ms": 60.012, "policy_agent_0": {"added_count": 1909504, "sampled_count": 2816512, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1909504, "sampled_count": 2816512, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.358091354370117, "min_q": 11.226901054382324, "max_q": 11.622116088867188, "mean_td_error": 0.041600052267313004, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.163280487060547, "min_q": 11.094491958618164, "max_q": 11.196788787841797, "mean_td_error": -0.017007891088724136, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 27685632, "episodes_total": 276864, "training_iteration": 266, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-55-25", "timestamp": 1569668125, "time_this_iter_s": 30.573575973510742, "time_total_s": 8122.863266706467, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b361598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2290.6545429229736, "timesteps_since_restore": 7679744, "iterations_since_restore": 75, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.85261843216818, "episode_reward_min": 58.90065350821738, "episode_reward_mean": 60.15215765763619, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 29.886066233686403, "agent_1": 30.2660914239499}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6957511499162728, "mean_processing_ms": 3.0729343555613164, "mean_inference_ms": 1.9726631778579724}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 803, "num_steps_trained": 40339968, "num_steps_sampled": 27791360, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15205, "num_samples_dropped": 205, "learner_queue": {"size_count": 54857, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.849, "replay_time_ms": 101.0, "update_priorities_time_ms": 55.229, "policy_agent_0": {"added_count": 1932032, "sampled_count": 2854656, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1932032, "sampled_count": 2854656, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.292028427124023, "min_q": 11.077066421508789, "max_q": 11.6726713180542, "mean_td_error": 0.017069615423679352, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.162772178649902, "min_q": 10.881549835205078, "max_q": 11.18162727355957, "mean_td_error": 0.04265527054667473, "model": {}}}}, "timesteps_this_iter": 105728, "done": false, "timesteps_total": 27791360, "episodes_total": 277920, "training_iteration": 267, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-55-56", "timestamp": 1569668156, "time_this_iter_s": 30.604236125946045, "time_total_s": 8153.467502832413, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4011e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2321.2587790489197, "timesteps_since_restore": 7785472, "iterations_since_restore": 76, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.43985131496615, "episode_reward_min": 58.70815596688677, "episode_reward_mean": 60.09148044367941, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 30.03617514810291, "agent_1": 30.055305295576588}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6958765269538245, "mean_processing_ms": 3.072020060181569, "mean_inference_ms": 1.9715155169485519}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 806, "num_steps_trained": 40486912, "num_steps_sampled": 27897344, "sample_throughput": 18167.606, "train_throughput": 36335.211, "num_weight_syncs": 15412, "num_samples_dropped": 205, "learner_queue": {"size_count": 55431, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.409, "replay_time_ms": 116.861, "update_priorities_time_ms": 56.118, "policy_agent_0": {"added_count": 1957120, "sampled_count": 2888960, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1957120, "sampled_count": 2888960, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.264272689819336, "min_q": 11.131848335266113, "max_q": 11.274081230163574, "mean_td_error": 0.03675422444939613, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.171542167663574, "min_q": 10.989450454711914, "max_q": 11.2377347946167, "mean_td_error": 0.03105892986059189, "model": {}}}}, "timesteps_this_iter": 105984, "done": false, "timesteps_total": 27897344, "episodes_total": 278976, "training_iteration": 268, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-56-27", "timestamp": 1569668187, "time_this_iter_s": 30.689352989196777, "time_total_s": 8184.1568558216095, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f86a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2351.9481320381165, "timesteps_since_restore": 7891456, "iterations_since_restore": 77, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.43511665333184, "episode_reward_min": 58.8485265345719, "episode_reward_mean": 60.164689832057114, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.073739424100935, "agent_1": 30.090950407956257}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6962785389605503, "mean_processing_ms": 3.073735633216879, "mean_inference_ms": 1.971171191222767}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 809, "num_steps_trained": 40640512, "num_steps_sampled": 27999744, "sample_throughput": 0.0, "train_throughput": 20708.618, "num_weight_syncs": 15612, "num_samples_dropped": 205, "learner_queue": {"size_count": 56031, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.1, "replay_time_ms": 100.044, "update_priorities_time_ms": 50.226, "policy_agent_0": {"added_count": 1986048, "sampled_count": 2926592, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 1986048, "sampled_count": 2926592, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.288146018981934, "min_q": 11.1740083694458, "max_q": 11.303274154663086, "mean_td_error": 0.059105489403009415, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.196456909179688, "min_q": 10.910284042358398, "max_q": 11.207735061645508, "mean_td_error": 0.029632173478603363, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 27999744, "episodes_total": 280000, "training_iteration": 269, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-56-57", "timestamp": 1569668217, "time_this_iter_s": 30.58242630958557, "time_total_s": 8214.739282131195, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0ff2f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2382.530558347702, "timesteps_since_restore": 7993856, "iterations_since_restore": 78, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.47728657716339, "episode_reward_min": 59.42898190757803, "episode_reward_mean": 60.22033128405303, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 30.093081067944386, "agent_1": 30.127250216108713}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6961308336881401, "mean_processing_ms": 3.071778930800971, "mean_inference_ms": 1.970202170853983}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 812, "num_steps_trained": 40790528, "num_steps_sampled": 28103680, "sample_throughput": 19969.533, "train_throughput": 0.0, "num_weight_syncs": 15815, "num_samples_dropped": 205, "learner_queue": {"size_count": 56617, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 46.95, "replay_time_ms": 101.26, "update_priorities_time_ms": 49.077, "policy_agent_0": {"added_count": 2012160, "sampled_count": 2964224, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2012160, "sampled_count": 2964224, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.25316047668457, "min_q": 11.12714958190918, "max_q": 11.295894622802734, "mean_td_error": 0.024113081395626068, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.19510555267334, "min_q": 11.033672332763672, "max_q": 11.201943397521973, "mean_td_error": 0.007024142891168594, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 28103680, "episodes_total": 281040, "training_iteration": 270, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-57-28", "timestamp": 1569668248, "time_this_iter_s": 30.54955005645752, "time_total_s": 8245.288832187653, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b1037b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2413.0801084041595, "timesteps_since_restore": 8097792, "iterations_since_restore": 79, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.2186916578086, "episode_reward_min": 59.335646820794565, "episode_reward_mean": 60.31610054053576, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.248772790942585, "agent_1": 30.06732774959324}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959935634555476, "mean_processing_ms": 3.0728478542612674, "mean_inference_ms": 1.97024814466558}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 815, "num_steps_trained": 40946944, "num_steps_sampled": 28206336, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16015, "num_samples_dropped": 205, "learner_queue": {"size_count": 57228, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.388, "replay_time_ms": 93.379, "update_priorities_time_ms": 48.745, "policy_agent_0": {"added_count": 2039040, "sampled_count": 3001344, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2039040, "sampled_count": 3001344, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.273802757263184, "min_q": 11.19008731842041, "max_q": 11.386951446533203, "mean_td_error": 0.019627194851636887, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.196704864501953, "min_q": 11.113252639770508, "max_q": 11.204456329345703, "mean_td_error": 0.0032962411642074585, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 28206336, "episodes_total": 282064, "training_iteration": 271, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-57-58", "timestamp": 1569668278, "time_this_iter_s": 30.448206901550293, "time_total_s": 8275.737039089203, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae0d400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2443.52831530571, "timesteps_since_restore": 8200448, "iterations_since_restore": 80, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.790065955746826, "episode_reward_min": 59.484331311425336, "episode_reward_mean": 60.21150753993398, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 30.01271043166757, "agent_1": 30.198797108266504}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6956811438752559, "mean_processing_ms": 3.0702378049708186, "mean_inference_ms": 1.9688367584520141}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 818, "num_steps_trained": 41098496, "num_steps_sampled": 28311808, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16221, "num_samples_dropped": 205, "learner_queue": {"size_count": 57820, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.831, "replay_time_ms": 108.402, "update_priorities_time_ms": 55.948, "policy_agent_0": {"added_count": 2065408, "sampled_count": 3039744, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2065408, "sampled_count": 3039744, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.267816543579102, "min_q": 11.163269996643066, "max_q": 11.45720100402832, "mean_td_error": 0.004209749400615692, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.230733871459961, "min_q": 11.1234130859375, "max_q": 11.299445152282715, "mean_td_error": 0.03377906233072281, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 28311808, "episodes_total": 283120, "training_iteration": 272, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-58-29", "timestamp": 1569668309, "time_this_iter_s": 30.51917600631714, "time_total_s": 8306.25621509552, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae1b8c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2474.047491312027, "timesteps_since_restore": 8305920, "iterations_since_restore": 81, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.41850830850205, "episode_reward_min": 46.33246404972324, "episode_reward_mean": 54.30785972683292, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 23.336885251228953, "agent_1": 30.970974475604013}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6960733570730733, "mean_processing_ms": 3.0724287362089466, "mean_inference_ms": 1.9696442650065373}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 822, "num_steps_trained": 41252096, "num_steps_sampled": 28413952, "sample_throughput": 0.0, "train_throughput": 24916.85, "num_weight_syncs": 16421, "num_samples_dropped": 205, "learner_queue": {"size_count": 58420, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.951, "replay_time_ms": 107.257, "update_priorities_time_ms": 57.676, "policy_agent_0": {"added_count": 2091520, "sampled_count": 3075584, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2091520, "sampled_count": 3075584, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.01125431060791, "min_q": 10.414034843444824, "max_q": 11.448479652404785, "mean_td_error": -0.01842261478304863, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.424426078796387, "min_q": 11.303899765014648, "max_q": 11.597431182861328, "mean_td_error": 0.04659518599510193, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 28413952, "episodes_total": 284136, "training_iteration": 273, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-58-59", "timestamp": 1569668339, "time_this_iter_s": 30.509371042251587, "time_total_s": 8336.765586137772, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f87b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2504.5568623542786, "timesteps_since_restore": 8408064, "iterations_since_restore": 82, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 54.03506639599697, "episode_reward_min": 52.944495214833324, "episode_reward_mean": 53.67735758650116, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 23.264340655646052, "agent_1": 30.41301693085519}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959933458798301, "mean_processing_ms": 3.0696821908125513, "mean_inference_ms": 1.9680872953047102}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 825, "num_steps_trained": 41407488, "num_steps_sampled": 28516608, "sample_throughput": 0.0, "train_throughput": 23500.587, "num_weight_syncs": 16621, "num_samples_dropped": 205, "learner_queue": {"size_count": 59027, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.083, "replay_time_ms": 74.689, "update_priorities_time_ms": 36.805, "policy_agent_0": {"added_count": 2112768, "sampled_count": 3112704, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2112768, "sampled_count": 3112704, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.72868537902832, "min_q": 10.114311218261719, "max_q": 11.134458541870117, "mean_td_error": 0.005637548863887787, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.476113319396973, "min_q": 11.400469779968262, "max_q": 11.571576118469238, "mean_td_error": 0.04678203538060188, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 28516608, "episodes_total": 285168, "training_iteration": 274, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_10-59-30", "timestamp": 1569668370, "time_this_iter_s": 30.443119287490845, "time_total_s": 8367.208705425262, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f2ea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2534.9999816417694, "timesteps_since_restore": 8510720, "iterations_since_restore": 83, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 55.256184119243905, "episode_reward_min": 48.633119752331666, "episode_reward_mean": 51.92908119652683, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 23.023841607550363, "agent_1": 28.9052395889765}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6956268812751899, "mean_processing_ms": 3.072409060168367, "mean_inference_ms": 1.970521291605953}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 828, "num_steps_trained": 41563136, "num_steps_sampled": 28617728, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16820, "num_samples_dropped": 205, "learner_queue": {"size_count": 59636, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.215, "replay_time_ms": 125.18, "update_priorities_time_ms": 55.281, "policy_agent_0": {"added_count": 2136064, "sampled_count": 3153408, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2136064, "sampled_count": 3153408, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.332263946533203, "min_q": 10.072994232177734, "max_q": 11.008014678955078, "mean_td_error": 0.01764177531003952, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.449670791625977, "min_q": 11.164881706237793, "max_q": 11.541175842285156, "mean_td_error": 0.020544327795505524, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 28617728, "episodes_total": 286184, "training_iteration": 275, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-00-00", "timestamp": 1569668400, "time_this_iter_s": 30.480345487594604, "time_total_s": 8397.689050912857, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b356b70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2565.480327129364, "timesteps_since_restore": 8611840, "iterations_since_restore": 84, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 55.37927547725564, "episode_reward_min": 49.30029961383921, "episode_reward_mean": 51.07182833862468, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 23.778050442611892, "agent_1": 27.293777896012806}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6958015612195921, "mean_processing_ms": 3.074322050483251, "mean_inference_ms": 1.9716994962467544}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 831, "num_steps_trained": 41707520, "num_steps_sampled": 28713216, "sample_throughput": 22045.823, "train_throughput": 0.0, "num_weight_syncs": 17005, "num_samples_dropped": 205, "learner_queue": {"size_count": 60199, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.252, "replay_time_ms": 82.492, "update_priorities_time_ms": 42.356, "policy_agent_0": {"added_count": 2160896, "sampled_count": 3187968, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2160896, "sampled_count": 3187968, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.038379669189453, "min_q": 9.928037643432617, "max_q": 10.420492172241211, "mean_td_error": 0.020249731838703156, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.277061462402344, "min_q": 11.031277656555176, "max_q": 11.5780029296875, "mean_td_error": 0.015324946492910385, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 28713216, "episodes_total": 287128, "training_iteration": 276, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-00-31", "timestamp": 1569668431, "time_this_iter_s": 30.456334114074707, "time_total_s": 8428.145385026932, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ad268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2595.9366612434387, "timesteps_since_restore": 8707328, "iterations_since_restore": 85, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 61.97216717350622, "episode_reward_min": 45.47631115994102, "episode_reward_mean": 55.81810411875267, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 26.566713384302396, "agent_1": 29.251390734450332}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6958031536639914, "mean_processing_ms": 3.0750205866484936, "mean_inference_ms": 1.9717778509746364}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 834, "num_steps_trained": 41857280, "num_steps_sampled": 28818688, "sample_throughput": 0.0, "train_throughput": 28664.455, "num_weight_syncs": 17212, "num_samples_dropped": 205, "learner_queue": {"size_count": 60784, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.442, "replay_time_ms": 94.219, "update_priorities_time_ms": 49.43, "policy_agent_0": {"added_count": 2186496, "sampled_count": 3226112, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2186496, "sampled_count": 3226112, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 9.963508605957031, "min_q": 9.706337928771973, "max_q": 10.687697410583496, "mean_td_error": 0.042321499437093735, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.21857738494873, "min_q": 10.954523086547852, "max_q": 11.50601863861084, "mean_td_error": 0.011214200407266617, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 28818688, "episodes_total": 288192, "training_iteration": 277, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-01-02", "timestamp": 1569668462, "time_this_iter_s": 30.626675128936768, "time_total_s": 8458.772060155869, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b39c9d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2626.5633363723755, "timesteps_since_restore": 8812800, "iterations_since_restore": 86, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.393900376584185, "episode_reward_min": 43.70738894036642, "episode_reward_mean": 54.17043576252515, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.161805648476864, "agent_1": 26.008630114048362}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959598512241195, "mean_processing_ms": 3.074828816205462, "mean_inference_ms": 1.970594124688991}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 837, "num_steps_trained": 42011392, "num_steps_sampled": 28919808, "sample_throughput": 0.0, "train_throughput": 22485.563, "num_weight_syncs": 17409, "num_samples_dropped": 205, "learner_queue": {"size_count": 61386, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.255, "replay_time_ms": 96.634, "update_priorities_time_ms": 49.652, "policy_agent_0": {"added_count": 2210560, "sampled_count": 3261440, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2210560, "sampled_count": 3261440, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.065200805664062, "min_q": 9.547259330749512, "max_q": 10.986116409301758, "mean_td_error": 0.02073204517364502, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.049100875854492, "min_q": 10.487930297851562, "max_q": 11.450905799865723, "mean_td_error": 0.00730365514755249, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 28919808, "episodes_total": 289200, "training_iteration": 278, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-01-32", "timestamp": 1569668492, "time_this_iter_s": 30.480550050735474, "time_total_s": 8489.252610206604, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bc9dd08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2657.043886423111, "timesteps_since_restore": 8913920, "iterations_since_restore": 87, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.2604292897827, "episode_reward_min": 43.70738894036642, "episode_reward_mean": 53.00256437705427, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 25.600860274784925, "agent_1": 27.401704102269434}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959701433177221, "mean_processing_ms": 3.0753238052670335, "mean_inference_ms": 1.9712560063888784}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 840, "num_steps_trained": 42162176, "num_steps_sampled": 29023488, "sample_throughput": 8942.483, "train_throughput": 8942.483, "num_weight_syncs": 17612, "num_samples_dropped": 205, "learner_queue": {"size_count": 61975, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.81, "replay_time_ms": 76.184, "update_priorities_time_ms": 38.991, "policy_agent_0": {"added_count": 2232320, "sampled_count": 3300608, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2232320, "sampled_count": 3300608, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.182361602783203, "min_q": 9.693347930908203, "max_q": 11.136808395385742, "mean_td_error": -0.0005797445774078369, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.100525856018066, "min_q": 10.337606430053711, "max_q": 11.403705596923828, "mean_td_error": 0.009804245084524155, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 29023488, "episodes_total": 290240, "training_iteration": 279, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-02-03", "timestamp": 1569668523, "time_this_iter_s": 30.516741037368774, "time_total_s": 8519.769351243973, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bd46d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2687.5606274604797, "timesteps_since_restore": 9017600, "iterations_since_restore": 88, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.23689238935356, "episode_reward_min": 57.60315880068597, "episode_reward_mean": 58.80872154899692, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 28.126585882127177, "agent_1": 30.682135666869858}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6957001460822108, "mean_processing_ms": 3.0754849156065815, "mean_inference_ms": 1.9709977461881656}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 843, "num_steps_trained": 42312704, "num_steps_sampled": 29127680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17814, "num_samples_dropped": 205, "learner_queue": {"size_count": 62564, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.644, "replay_time_ms": 113.553, "update_priorities_time_ms": 57.542, "policy_agent_0": {"added_count": 2258176, "sampled_count": 3334656, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2258176, "sampled_count": 3334656, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.332697868347168, "min_q": 9.986297607421875, "max_q": 11.125784873962402, "mean_td_error": -0.0020951442420482635, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.164860725402832, "min_q": 10.345722198486328, "max_q": 11.50661849975586, "mean_td_error": 0.006699640303850174, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 29127680, "episodes_total": 291272, "training_iteration": 280, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-02-33", "timestamp": 1569668553, "time_this_iter_s": 30.630005836486816, "time_total_s": 8550.39935708046, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b416e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2718.1906332969666, "timesteps_since_restore": 9121792, "iterations_since_restore": 89, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.25425715236673, "episode_reward_min": 57.36067267920378, "episode_reward_mean": 58.7784453736848, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 28.121069405175493, "agent_1": 30.65737596850942}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6958068002445834, "mean_processing_ms": 3.0744946123852728, "mean_inference_ms": 1.9698477688619378}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 846, "num_steps_trained": 42464000, "num_steps_sampled": 29231616, "sample_throughput": 7255.65, "train_throughput": 0.0, "num_weight_syncs": 18019, "num_samples_dropped": 205, "learner_queue": {"size_count": 63156, "size_mean": 0.16, "size_std": 0.463033476111609, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.332, "replay_time_ms": 91.495, "update_priorities_time_ms": 48.525, "policy_agent_0": {"added_count": 2287104, "sampled_count": 3371008, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2287104, "sampled_count": 3371008, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.313119888305664, "min_q": 10.10007095336914, "max_q": 10.560998916625977, "mean_td_error": 0.007173400372266769, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.284747123718262, "min_q": 10.840153694152832, "max_q": 11.440839767456055, "mean_td_error": 0.027853641659021378, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 29231616, "episodes_total": 292320, "training_iteration": 281, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-03-04", "timestamp": 1569668584, "time_this_iter_s": 30.501452207565308, "time_total_s": 8580.900809288025, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4400d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2748.692085504532, "timesteps_since_restore": 9225728, "iterations_since_restore": 90, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.21503266006838, "episode_reward_min": 57.38597525665718, "episode_reward_mean": 58.77224842225485, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 28.11814512662072, "agent_1": 30.65410329563425}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6961167891469401, "mean_processing_ms": 3.0746293359495, "mean_inference_ms": 1.9695041198940066}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 849, "num_steps_trained": 42613248, "num_steps_sampled": 29336576, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18223, "num_samples_dropped": 205, "learner_queue": {"size_count": 63737, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.179, "replay_time_ms": 120.238, "update_priorities_time_ms": 59.224, "policy_agent_0": {"added_count": 2316288, "sampled_count": 3404288, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2316288, "sampled_count": 3404288, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.359448432922363, "min_q": 10.239337921142578, "max_q": 10.440515518188477, "mean_td_error": 0.033972445875406265, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.37362003326416, "min_q": 10.93501091003418, "max_q": 11.475430488586426, "mean_td_error": 0.027772270143032074, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 29336576, "episodes_total": 293368, "training_iteration": 282, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-03-34", "timestamp": 1569668614, "time_this_iter_s": 30.584744215011597, "time_total_s": 8611.485553503036, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b42ca60>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2779.2768297195435, "timesteps_since_restore": 9330688, "iterations_since_restore": 91, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.25458382908599, "episode_reward_min": 57.58324200407884, "episode_reward_mean": 58.80928937990585, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.11501209342652, "agent_1": 30.69427728647944}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6961327780984726, "mean_processing_ms": 3.075630365008679, "mean_inference_ms": 1.97010514979118}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 852, "num_steps_trained": 42770944, "num_steps_sampled": 29437440, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18420, "num_samples_dropped": 205, "learner_queue": {"size_count": 64353, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.713, "replay_time_ms": 94.286, "update_priorities_time_ms": 47.46, "policy_agent_0": {"added_count": 2340864, "sampled_count": 3442432, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2340864, "sampled_count": 3442432, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.3857421875, "min_q": 10.10531234741211, "max_q": 10.419919967651367, "mean_td_error": 0.009741522371768951, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.402326583862305, "min_q": 11.224807739257812, "max_q": 11.407238960266113, "mean_td_error": 0.016200322657823563, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 29437440, "episodes_total": 294376, "training_iteration": 283, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-04-05", "timestamp": 1569668645, "time_this_iter_s": 30.434312105178833, "time_total_s": 8641.919865608215, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b437510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2809.7111418247223, "timesteps_since_restore": 9431552, "iterations_since_restore": 92, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.23689238935356, "episode_reward_min": 57.74165223496886, "episode_reward_mean": 58.854773648351085, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 28.10186387513663, "agent_1": 30.752909773214565}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6966147440515934, "mean_processing_ms": 3.0744157117313513, "mean_inference_ms": 1.9703935286721255}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 855, "num_steps_trained": 42927872, "num_steps_sampled": 29538816, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18618, "num_samples_dropped": 205, "learner_queue": {"size_count": 64966, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.832, "replay_time_ms": 108.708, "update_priorities_time_ms": 58.062, "policy_agent_0": {"added_count": 2364928, "sampled_count": 3480832, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2364928, "sampled_count": 3480832, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.42087173461914, "min_q": 10.351855278015137, "max_q": 10.581235885620117, "mean_td_error": 0.006096594035625458, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.403361320495605, "min_q": 11.212177276611328, "max_q": 11.430893898010254, "mean_td_error": 0.025140047073364258, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 29538816, "episodes_total": 295392, "training_iteration": 284, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-04-35", "timestamp": 1569668675, "time_this_iter_s": 30.52512264251709, "time_total_s": 8672.444988250732, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0da400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2840.2362644672394, "timesteps_since_restore": 9532928, "iterations_since_restore": 93, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.23689238935356, "episode_reward_min": 57.56072341117054, "episode_reward_mean": 58.849445820579994, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 28.108857701201266, "agent_1": 30.740588119378852}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6961925434337426, "mean_processing_ms": 3.0756755735450807, "mean_inference_ms": 1.9704588765922728}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 858, "num_steps_trained": 43081728, "num_steps_sampled": 29640704, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18817, "num_samples_dropped": 205, "learner_queue": {"size_count": 65567, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.035, "replay_time_ms": 92.425, "update_priorities_time_ms": 45.613, "policy_agent_0": {"added_count": 2387200, "sampled_count": 3520512, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2387200, "sampled_count": 3520512, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.439168930053711, "min_q": 10.34957218170166, "max_q": 10.478852272033691, "mean_td_error": 0.0006587915122509003, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.414407730102539, "min_q": 11.21574592590332, "max_q": 11.470357894897461, "mean_td_error": 0.025030281394720078, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 29640704, "episodes_total": 296408, "training_iteration": 285, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-05-06", "timestamp": 1569668706, "time_this_iter_s": 30.468285083770752, "time_total_s": 8702.913273334503, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4526a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2870.70454955101, "timesteps_since_restore": 9634816, "iterations_since_restore": 94, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.38248688979695, "episode_reward_min": 57.120553511088545, "episode_reward_mean": 58.695452304472234, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 28.242661624854982, "agent_1": 30.45279067961733}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6961618599691354, "mean_processing_ms": 3.074772073688081, "mean_inference_ms": 1.9703034825118895}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 861, "num_steps_trained": 43239168, "num_steps_sampled": 29743104, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19017, "num_samples_dropped": 205, "learner_queue": {"size_count": 66182, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.475, "replay_time_ms": 101.773, "update_priorities_time_ms": 54.712, "policy_agent_0": {"added_count": 2414080, "sampled_count": 3558144, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2414080, "sampled_count": 3558144, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.447579383850098, "min_q": 10.3259916305542, "max_q": 10.52100658416748, "mean_td_error": 0.02162877470254898, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.389681816101074, "min_q": 11.186006546020508, "max_q": 11.423035621643066, "mean_td_error": -0.0065949708223342896, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 29743104, "episodes_total": 297440, "training_iteration": 286, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-05-37", "timestamp": 1569668737, "time_this_iter_s": 30.584775924682617, "time_total_s": 8733.498049259186, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d01e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2901.2893254756927, "timesteps_since_restore": 9737216, "iterations_since_restore": 95, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.21292181863585, "episode_reward_min": 57.09031593385311, "episode_reward_mean": 58.121889759618, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 28.85852916319221, "agent_1": 29.26336059642579}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.696473467725172, "mean_processing_ms": 3.0749809554832295, "mean_inference_ms": 1.9707246260253488}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 864, "num_steps_trained": 43394560, "num_steps_sampled": 29845760, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19217, "num_samples_dropped": 205, "learner_queue": {"size_count": 66789, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.672, "replay_time_ms": 97.751, "update_priorities_time_ms": 51.753, "policy_agent_0": {"added_count": 2438656, "sampled_count": 3595264, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2438656, "sampled_count": 3595264, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.512165069580078, "min_q": 10.341453552246094, "max_q": 10.87032413482666, "mean_td_error": 0.023647621273994446, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.342529296875, "min_q": 11.170034408569336, "max_q": 11.40175724029541, "mean_td_error": 0.0283876471221447, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 29845760, "episodes_total": 298464, "training_iteration": 287, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-06-07", "timestamp": 1569668767, "time_this_iter_s": 30.580549716949463, "time_total_s": 8764.078598976135, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d0a60>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2931.869875192642, "timesteps_since_restore": 9839872, "iterations_since_restore": 96, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 58.23557669602266, "episode_reward_min": 57.12976168533727, "episode_reward_mean": 58.00338498130135, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 28.982768532683608, "agent_1": 29.02061644861772}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6968170111177605, "mean_processing_ms": 3.075146013214464, "mean_inference_ms": 1.9707168600268405}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 867, "num_steps_trained": 43549952, "num_steps_sampled": 29947648, "sample_throughput": 8735.219, "train_throughput": 8735.219, "num_weight_syncs": 19417, "num_samples_dropped": 205, "learner_queue": {"size_count": 67396, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.299, "replay_time_ms": 102.747, "update_priorities_time_ms": 50.278, "policy_agent_0": {"added_count": 2466560, "sampled_count": 3632128, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2466560, "sampled_count": 3632128, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.638115882873535, "min_q": 10.520986557006836, "max_q": 10.665726661682129, "mean_td_error": 0.043283861130476, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.23196029663086, "min_q": 11.040657043457031, "max_q": 11.409788131713867, "mean_td_error": 0.015531238168478012, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 29947648, "episodes_total": 299480, "training_iteration": 288, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-06-38", "timestamp": 1569668798, "time_this_iter_s": 30.568129062652588, "time_total_s": 8794.646728038788, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b361620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2962.438004255295, "timesteps_since_restore": 9941760, "iterations_since_restore": 97, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 58.43081705529759, "episode_reward_min": 57.19883504130973, "episode_reward_mean": 58.02865906311534, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 29.009131263949946, "agent_1": 29.01952779916538}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6963593717515447, "mean_processing_ms": 3.0755855913603423, "mean_inference_ms": 1.9716195460857568}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 870, "num_steps_trained": 43706880, "num_steps_sampled": 30049024, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19615, "num_samples_dropped": 205, "learner_queue": {"size_count": 68010, "size_mean": 0.12, "size_std": 0.3815756805667783, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.834, "replay_time_ms": 101.521, "update_priorities_time_ms": 54.502, "policy_agent_0": {"added_count": 2496512, "sampled_count": 3667200, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2496512, "sampled_count": 3667200, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.698159217834473, "min_q": 10.550966262817383, "max_q": 10.726632118225098, "mean_td_error": 0.030018970370292664, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.090171813964844, "min_q": 10.966822624206543, "max_q": 11.359747886657715, "mean_td_error": 0.0015309453010559082, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 30049024, "episodes_total": 300496, "training_iteration": 289, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-07-08", "timestamp": 1569668828, "time_this_iter_s": 30.55443549156189, "time_total_s": 8825.20116353035, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3b2268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2992.9924397468567, "timesteps_since_restore": 10043136, "iterations_since_restore": 98, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 58.27721749444334, "episode_reward_min": 57.40232548570787, "episode_reward_mean": 58.038069984130004, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 29.02565050240572, "agent_1": 29.01241948172426}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6967938534861408, "mean_processing_ms": 3.0752431512231886, "mean_inference_ms": 1.972038390430965}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 873, "num_steps_trained": 43858944, "num_steps_sampled": 30152960, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19818, "num_samples_dropped": 205, "learner_queue": {"size_count": 68603, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 45.643, "replay_time_ms": 112.88, "update_priorities_time_ms": 55.508, "policy_agent_0": {"added_count": 2519808, "sampled_count": 3704064, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2519808, "sampled_count": 3704064, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.720012664794922, "min_q": 10.63637924194336, "max_q": 10.766195297241211, "mean_td_error": -0.011732090264558792, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 11.057975769042969, "min_q": 11.017675399780273, "max_q": 11.13277816772461, "mean_td_error": 0.0102161206305027, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 30152960, "episodes_total": 301536, "training_iteration": 290, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-07-39", "timestamp": 1569668859, "time_this_iter_s": 30.446588277816772, "time_total_s": 8855.647751808167, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b400730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3023.4390280246735, "timesteps_since_restore": 10147072, "iterations_since_restore": 99, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.372500840805245, "episode_reward_min": 57.387573888595, "episode_reward_mean": 58.247326494410245, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 29.289632773903037, "agent_1": 28.957693720507212}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6963345710651563, "mean_processing_ms": 3.075187942402593, "mean_inference_ms": 1.971399812565099}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 877, "num_steps_trained": 44012800, "num_steps_sampled": 30255616, "sample_throughput": 6932.465, "train_throughput": 20797.396, "num_weight_syncs": 20018, "num_samples_dropped": 205, "learner_queue": {"size_count": 69204, "size_mean": 0.2, "size_std": 0.48989794855663565, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.298, "replay_time_ms": 106.461, "update_priorities_time_ms": 53.462, "policy_agent_0": {"added_count": 2545152, "sampled_count": 3741952, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2545152, "sampled_count": 3741952, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.791444778442383, "min_q": 10.706270217895508, "max_q": 10.858116149902344, "mean_td_error": 0.055934224277734756, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.999773025512695, "min_q": 10.953072547912598, "max_q": 11.09526538848877, "mean_td_error": 0.01817484200000763, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 30255616, "episodes_total": 302560, "training_iteration": 291, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-08-10", "timestamp": 1569668890, "time_this_iter_s": 30.66570234298706, "time_total_s": 8886.313454151154, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0ff378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3054.1047303676605, "timesteps_since_restore": 10249728, "iterations_since_restore": 100, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 58.24479821192353, "episode_reward_min": 51.291018500046185, "episode_reward_mean": 56.97089806984512, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 28.745022279112714, "agent_1": 28.225875790732406}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6965530514913217, "mean_processing_ms": 3.0745278498569077, "mean_inference_ms": 1.9717196545813136}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 880, "num_steps_trained": 44162304, "num_steps_sampled": 30360576, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20223, "num_samples_dropped": 205, "learner_queue": {"size_count": 69788, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.15, "replay_time_ms": 83.956, "update_priorities_time_ms": 40.404, "policy_agent_0": {"added_count": 2571520, "sampled_count": 3777792, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2571520, "sampled_count": 3777792, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.817743301391602, "min_q": 10.754806518554688, "max_q": 10.93359661102295, "mean_td_error": 0.0480264388024807, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.955070495605469, "min_q": 10.853006362915039, "max_q": 11.000954627990723, "mean_td_error": 0.0039001330733299255, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 30360576, "episodes_total": 303616, "training_iteration": 292, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-08-40", "timestamp": 1569668920, "time_this_iter_s": 30.483237266540527, "time_total_s": 8916.796691417694, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b102840>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3084.587967634201, "timesteps_since_restore": 10354688, "iterations_since_restore": 101, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.37264340540895, "episode_reward_min": 52.27787373825395, "episode_reward_mean": 59.149270765506564, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 30.537866434758854, "agent_1": 28.611404330747817}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959975323709123, "mean_processing_ms": 3.0735756599920236, "mean_inference_ms": 1.9712666902647442}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 883, "num_steps_trained": 44316416, "num_steps_sampled": 30464512, "sample_throughput": 0.0, "train_throughput": 25371.372, "num_weight_syncs": 20426, "num_samples_dropped": 205, "learner_queue": {"size_count": 70390, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.111, "replay_time_ms": 86.517, "update_priorities_time_ms": 43.213, "policy_agent_0": {"added_count": 2599424, "sampled_count": 3813632, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2599424, "sampled_count": 3813632, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.836813926696777, "min_q": 10.676491737365723, "max_q": 10.994769096374512, "mean_td_error": 0.016924597322940826, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.98190689086914, "min_q": 10.816191673278809, "max_q": 11.044134140014648, "mean_td_error": 0.019585683941841125, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 30464512, "episodes_total": 304640, "training_iteration": 293, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-09-11", "timestamp": 1569668951, "time_this_iter_s": 30.48192262649536, "time_total_s": 8947.27861404419, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae20488>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3115.0698902606964, "timesteps_since_restore": 10458624, "iterations_since_restore": 102, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.365376801392486, "episode_reward_min": 58.607445758489895, "episode_reward_mean": 59.34278247166267, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 30.678050288688855, "agent_1": 28.664732182973925}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6958204188531533, "mean_processing_ms": 3.072835154342521, "mean_inference_ms": 1.9711473026532969}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 886, "num_steps_trained": 44470016, "num_steps_sampled": 30567936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20628, "num_samples_dropped": 205, "learner_queue": {"size_count": 70990, "size_mean": 0.22, "size_std": 0.4142463035441596, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 47.868, "replay_time_ms": 132.315, "update_priorities_time_ms": 64.15, "policy_agent_0": {"added_count": 2627328, "sampled_count": 3849472, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2627328, "sampled_count": 3849472, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.979154586791992, "min_q": 10.727788925170898, "max_q": 11.113512992858887, "mean_td_error": 0.05027811601758003, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.91282844543457, "min_q": 10.773595809936523, "max_q": 11.121421813964844, "mean_td_error": 0.04010732099413872, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 30567936, "episodes_total": 305680, "training_iteration": 294, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-09-41", "timestamp": 1569668981, "time_this_iter_s": 30.46752429008484, "time_total_s": 8977.746138334274, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae29950>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3145.5374145507812, "timesteps_since_restore": 10562048, "iterations_since_restore": 103, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.365376801392486, "episode_reward_min": 58.27356100742402, "episode_reward_mean": 59.33156483951379, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 30.697555767658613, "agent_1": 28.63400907185528}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6959098319486271, "mean_processing_ms": 3.0733154091957884, "mean_inference_ms": 1.9712565260438022}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 889, "num_steps_trained": 44618752, "num_steps_sampled": 30673408, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20833, "num_samples_dropped": 205, "learner_queue": {"size_count": 71571, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.355, "replay_time_ms": 85.13, "update_priorities_time_ms": 51.389, "policy_agent_0": {"added_count": 2654464, "sampled_count": 3884288, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2654464, "sampled_count": 3884288, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.141700744628906, "min_q": 10.884256362915039, "max_q": 11.26304817199707, "mean_td_error": 0.004187539219856262, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.831052780151367, "min_q": 10.692117691040039, "max_q": 11.022493362426758, "mean_td_error": 0.015556015074253082, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 30673408, "episodes_total": 306728, "training_iteration": 295, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-10-12", "timestamp": 1569669012, "time_this_iter_s": 30.57204008102417, "time_total_s": 9008.318178415298, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae2f598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3176.1094546318054, "timesteps_since_restore": 10667520, "iterations_since_restore": 104, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.299882962548644, "episode_reward_min": 56.726418920354355, "episode_reward_mean": 58.88073506871954, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 30.886305829894393, "agent_1": 27.994429238825237}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6958043100329524, "mean_processing_ms": 3.0723914277426925, "mean_inference_ms": 1.971480316360554}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 892, "num_steps_trained": 44771584, "num_steps_sampled": 30776320, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21035, "num_samples_dropped": 205, "learner_queue": {"size_count": 72168, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.143, "replay_time_ms": 104.054, "update_priorities_time_ms": 57.254, "policy_agent_0": {"added_count": 2678528, "sampled_count": 3925248, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2678528, "sampled_count": 3925248, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.258065223693848, "min_q": 11.082818031311035, "max_q": 11.299911499023438, "mean_td_error": 0.013354834169149399, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.788223266601562, "min_q": 10.614487648010254, "max_q": 11.05141544342041, "mean_td_error": 0.0012447796761989594, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 30776320, "episodes_total": 307760, "training_iteration": 296, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-10-42", "timestamp": 1569669042, "time_this_iter_s": 30.19154381752014, "time_total_s": 9038.509722232819, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae3ca60>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3206.3009984493256, "timesteps_since_restore": 10770432, "iterations_since_restore": 105, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 60.34934455785369, "episode_reward_min": 53.996177463993845, "episode_reward_mean": 58.30198284082265, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 30.253338202553174, "agent_1": 28.048644638269568}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6957375248709682, "mean_processing_ms": 3.0722120140646223, "mean_inference_ms": 1.9713047459632094}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 895, "num_steps_trained": 44925440, "num_steps_sampled": 30881280, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21240, "num_samples_dropped": 205, "learner_queue": {"size_count": 72770, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.322, "replay_time_ms": 79.868, "update_priorities_time_ms": 45.217, "policy_agent_0": {"added_count": 2709248, "sampled_count": 3962368, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2709248, "sampled_count": 3962368, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.279884338378906, "min_q": 11.113506317138672, "max_q": 11.302659034729004, "mean_td_error": 0.021000076085329056, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.73117733001709, "min_q": 10.55923080444336, "max_q": 11.024691581726074, "mean_td_error": 0.01426343247294426, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 30881280, "episodes_total": 308816, "training_iteration": 297, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-11-12", "timestamp": 1569669072, "time_this_iter_s": 30.45636749267578, "time_total_s": 9068.966089725494, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b1029d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3236.7573659420013, "timesteps_since_restore": 10875392, "iterations_since_restore": 106, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.267695893799164, "episode_reward_min": 57.497573586192075, "episode_reward_mean": 58.96711905759746, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 30.778277688671682, "agent_1": 28.188841368925896}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6953519749392785, "mean_processing_ms": 3.070536024619382, "mean_inference_ms": 1.970480478585448}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 898, "num_steps_trained": 45081856, "num_steps_sampled": 30985728, "sample_throughput": 9055.458, "train_throughput": 0.0, "num_weight_syncs": 21444, "num_samples_dropped": 205, "learner_queue": {"size_count": 73381, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.389, "replay_time_ms": 83.861, "update_priorities_time_ms": 48.771, "policy_agent_0": {"added_count": 2732032, "sampled_count": 4002048, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2732032, "sampled_count": 4002048, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.32331657409668, "min_q": 11.149879455566406, "max_q": 11.406441688537598, "mean_td_error": 0.01801786571741104, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.655778884887695, "min_q": 10.481276512145996, "max_q": 10.895174980163574, "mean_td_error": 0.031679507344961166, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 30985728, "episodes_total": 309856, "training_iteration": 298, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-11-43", "timestamp": 1569669103, "time_this_iter_s": 30.48159909248352, "time_total_s": 9099.447688817978, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae1be18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3267.238965034485, "timesteps_since_restore": 10979840, "iterations_since_restore": 107, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 59.2360781015874, "episode_reward_min": 51.15951894328984, "episode_reward_mean": 55.666600405980226, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.708631976864847, "agent_1": 28.95796842911538}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6960261593846495, "mean_processing_ms": 3.0715872397774815, "mean_inference_ms": 1.9709558157630984}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 901, "num_steps_trained": 45241856, "num_steps_sampled": 31088896, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21645, "num_samples_dropped": 205, "learner_queue": {"size_count": 74005, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.789, "replay_time_ms": 82.806, "update_priorities_time_ms": 42.427, "policy_agent_0": {"added_count": 2758912, "sampled_count": 4041472, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2758912, "sampled_count": 4041472, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 11.308494567871094, "min_q": 10.925681114196777, "max_q": 11.383672714233398, "mean_td_error": 0.025926966220140457, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.683204650878906, "min_q": 10.55555248260498, "max_q": 10.86186695098877, "mean_td_error": 0.020777065306901932, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 31088896, "episodes_total": 310888, "training_iteration": 299, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-12-13", "timestamp": 1569669133, "time_this_iter_s": 30.550330638885498, "time_total_s": 9129.998019456863, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d8268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3297.7892956733704, "timesteps_since_restore": 11083008, "iterations_since_restore": 108, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 51.89028870797957, "episode_reward_min": 50.94051600587655, "episode_reward_mean": 51.299672462471285, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 21.404830554392372, "agent_1": 29.894841908078774}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6956532933760747, "mean_processing_ms": 3.071899318090793, "mean_inference_ms": 1.9709326539317924}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 904, "num_steps_trained": 45396992, "num_steps_sampled": 31192320, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21848, "num_samples_dropped": 205, "learner_queue": {"size_count": 74611, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.697, "replay_time_ms": 96.747, "update_priorities_time_ms": 46.296, "policy_agent_0": {"added_count": 2781952, "sampled_count": 4080640, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2781952, "sampled_count": 4080640, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.980573654174805, "min_q": 10.417669296264648, "max_q": 11.290214538574219, "mean_td_error": 0.011346954852342606, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.796480178833008, "min_q": 10.59365463256836, "max_q": 10.89794635772705, "mean_td_error": 0.019098594784736633, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 31192320, "episodes_total": 311928, "training_iteration": 300, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-12-44", "timestamp": 1569669164, "time_this_iter_s": 30.572654724121094, "time_total_s": 9160.570674180984, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ee598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3328.3619503974915, "timesteps_since_restore": 11186432, "iterations_since_restore": 109, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 52.01742502895207, "episode_reward_min": 50.95083657864812, "episode_reward_mean": 51.3058382355011, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 21.34573001477289, "agent_1": 29.960108220728078}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6961353678667569, "mean_processing_ms": 3.0717426688049, "mean_inference_ms": 1.9701502871516354}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 907, "num_steps_trained": 45549312, "num_steps_sampled": 31296512, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22050, "num_samples_dropped": 205, "learner_queue": {"size_count": 75207, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.523, "replay_time_ms": 102.342, "update_priorities_time_ms": 51.413, "policy_agent_0": {"added_count": 2801664, "sampled_count": 4125440, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2801664, "sampled_count": 4125440, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 10.427614212036133, "min_q": 10.060786247253418, "max_q": 10.971965789794922, "mean_td_error": 0.010829057544469833, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.90747356414795, "min_q": 10.737663269042969, "max_q": 10.95235824584961, "mean_td_error": 0.018903985619544983, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 31296512, "episodes_total": 312976, "training_iteration": 301, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-13-15", "timestamp": 1569669195, "time_this_iter_s": 30.566774606704712, "time_total_s": 9191.13744878769, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b452c80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3358.928725004196, "timesteps_since_restore": 11290624, "iterations_since_restore": 110, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 51.60095197787908, "episode_reward_min": 50.9619552089289, "episode_reward_mean": 51.293881141681844, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 21.395261626918604, "agent_1": 29.898619514763105}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6962022639185921, "mean_processing_ms": 3.071653578823358, "mean_inference_ms": 1.9696717899784744}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 910, "num_steps_trained": 45704960, "num_steps_sampled": 31399168, "sample_throughput": 12117.25, "train_throughput": 4039.083, "num_weight_syncs": 22252, "num_samples_dropped": 205, "learner_queue": {"size_count": 75816, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 26.617, "replay_time_ms": 84.144, "update_priorities_time_ms": 50.812, "policy_agent_0": {"added_count": 2823680, "sampled_count": 4169984, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2823680, "sampled_count": 4169984, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 9.74802303314209, "min_q": 9.613292694091797, "max_q": 9.934952735900879, "mean_td_error": 0.01253223791718483, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.93663501739502, "min_q": 10.894979476928711, "max_q": 11.069327354431152, "mean_td_error": 0.011126268655061722, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 31399168, "episodes_total": 313992, "training_iteration": 302, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-13-45", "timestamp": 1569669225, "time_this_iter_s": 30.54027795791626, "time_total_s": 9221.677726745605, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3817b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3389.4690029621124, "timesteps_since_restore": 11393280, "iterations_since_restore": 111, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 57.03838728797221, "episode_reward_min": 50.55578115050739, "episode_reward_mean": 52.64393388993114, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 23.52255834770908, "agent_1": 29.12137554222204}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.696274813105232, "mean_processing_ms": 3.0721873766423995, "mean_inference_ms": 1.9698415771314028}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 913, "num_steps_trained": 45861376, "num_steps_sampled": 31501568, "sample_throughput": 0.0, "train_throughput": 10847.959, "num_weight_syncs": 22452, "num_samples_dropped": 205, "learner_queue": {"size_count": 76426, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.728, "replay_time_ms": 98.534, "update_priorities_time_ms": 53.963, "policy_agent_0": {"added_count": 2851328, "sampled_count": 4210176, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2851328, "sampled_count": 4210176, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 9.393905639648438, "min_q": 9.27536392211914, "max_q": 9.762621879577637, "mean_td_error": 0.002589598298072815, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.980965614318848, "min_q": 10.900653839111328, "max_q": 11.14083194732666, "mean_td_error": 0.015587285161018372, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 31501568, "episodes_total": 315016, "training_iteration": 303, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-14-16", "timestamp": 1569669256, "time_this_iter_s": 30.528220891952515, "time_total_s": 9252.205947637558, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4378c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3419.997223854065, "timesteps_since_restore": 11495680, "iterations_since_restore": 112, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 57.011593438538455, "episode_reward_min": 50.440811505743106, "episode_reward_mean": 51.171325077611954, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 22.68520737854311, "agent_1": 28.486117699068885}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6963765847097028, "mean_processing_ms": 3.070448482023095, "mean_inference_ms": 1.969269916620656}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 917, "num_steps_trained": 46018816, "num_steps_sampled": 31604992, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22653, "num_samples_dropped": 205, "learner_queue": {"size_count": 77040, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.776, "replay_time_ms": 93.357, "update_priorities_time_ms": 50.179, "policy_agent_0": {"added_count": 2877952, "sampled_count": 4249344, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2877952, "sampled_count": 4249344, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 9.225515365600586, "min_q": 9.087529182434082, "max_q": 9.822286605834961, "mean_td_error": -0.004010733217000961, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.93566608428955, "min_q": 10.790264129638672, "max_q": 11.049910545349121, "mean_td_error": 0.002431478351354599, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 31604992, "episodes_total": 316048, "training_iteration": 304, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-14-46", "timestamp": 1569669286, "time_this_iter_s": 30.572447061538696, "time_total_s": 9282.778394699097, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4239d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3450.5696709156036, "timesteps_since_restore": 11599104, "iterations_since_restore": 113, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 50.97060653372813, "episode_reward_min": 48.42859597041102, "episode_reward_mean": 50.59902141404297, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 22.1848575934429, "agent_1": 28.414163820600095}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6965326805693057, "mean_processing_ms": 3.070246397429055, "mean_inference_ms": 1.9689621535031194}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 920, "num_steps_trained": 46174720, "num_steps_sampled": 31708160, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22854, "num_samples_dropped": 205, "learner_queue": {"size_count": 77649, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.293, "replay_time_ms": 102.82, "update_priorities_time_ms": 54.925, "policy_agent_0": {"added_count": 2899712, "sampled_count": 4292352, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2899712, "sampled_count": 4292352, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 9.16883659362793, "min_q": 9.004837036132812, "max_q": 10.167580604553223, "mean_td_error": -0.007415402680635452, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.829197883605957, "min_q": 10.756102561950684, "max_q": 11.01573657989502, "mean_td_error": 0.03656802326440811, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 31708160, "episodes_total": 317080, "training_iteration": 305, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-15-17", "timestamp": 1569669317, "time_this_iter_s": 30.51915407180786, "time_total_s": 9313.297548770905, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b440048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3481.0888249874115, "timesteps_since_restore": 11702272, "iterations_since_restore": 114, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 57.242323869465814, "episode_reward_min": 47.77314681905729, "episode_reward_mean": 51.765446340431886, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 23.492120687249354, "agent_1": 28.27332565318257}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6968335325165318, "mean_processing_ms": 3.071303549062137, "mean_inference_ms": 1.9691594820117428}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 923, "num_steps_trained": 46327040, "num_steps_sampled": 31811072, "sample_throughput": 6852.607, "train_throughput": 0.0, "num_weight_syncs": 23056, "num_samples_dropped": 205, "learner_queue": {"size_count": 78244, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.243, "replay_time_ms": 114.628, "update_priorities_time_ms": 52.467, "policy_agent_0": {"added_count": 2924544, "sampled_count": 4329984, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2924544, "sampled_count": 4329984, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 9.004317283630371, "min_q": 8.82906436920166, "max_q": 9.816383361816406, "mean_td_error": 0.038047198206186295, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.778976440429688, "min_q": 10.727716445922852, "max_q": 10.867626190185547, "mean_td_error": 0.002269849181175232, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 31811072, "episodes_total": 318120, "training_iteration": 306, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-15-48", "timestamp": 1569669348, "time_this_iter_s": 30.487221240997314, "time_total_s": 9343.784770011902, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bc9dd08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3511.576046228409, "timesteps_since_restore": 11805184, "iterations_since_restore": 115, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 56.10539576583682, "episode_reward_min": 46.185758023271404, "episode_reward_mean": 49.63652180276895, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 24.41619538801581, "agent_1": 25.220326414753163}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6964268612929039, "mean_processing_ms": 3.071473136104414, "mean_inference_ms": 1.9686441530553667}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 926, "num_steps_trained": 46485504, "num_steps_sampled": 31912960, "sample_throughput": 7551.458, "train_throughput": 0.0, "num_weight_syncs": 23256, "num_samples_dropped": 205, "learner_queue": {"size_count": 78863, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.969, "replay_time_ms": 80.96, "update_priorities_time_ms": 53.316, "policy_agent_0": {"added_count": 2951168, "sampled_count": 4370176, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2951168, "sampled_count": 4370176, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 9.16584300994873, "min_q": 8.81519889831543, "max_q": 9.838523864746094, "mean_td_error": 0.027543816715478897, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.713691711425781, "min_q": 10.453203201293945, "max_q": 10.790839195251465, "mean_td_error": 0.040436387062072754, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 31912960, "episodes_total": 319136, "training_iteration": 307, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-16-18", "timestamp": 1569669378, "time_this_iter_s": 30.56332540512085, "time_total_s": 9374.348095417023, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bc9d1e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3542.1393716335297, "timesteps_since_restore": 11907072, "iterations_since_restore": 116, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 51.067737538014576, "episode_reward_min": 45.42467525632243, "episode_reward_mean": 48.499291508022424, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 21.99426563616378, "agent_1": 26.505025871858646}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.697473076581195, "mean_processing_ms": 3.0724384804390095, "mean_inference_ms": 1.9690161058604596}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 929, "num_steps_trained": 46643200, "num_steps_sampled": 32016128, "sample_throughput": 0.0, "train_throughput": 27150.344, "num_weight_syncs": 23457, "num_samples_dropped": 205, "learner_queue": {"size_count": 79479, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.372, "replay_time_ms": 87.528, "update_priorities_time_ms": 44.392, "policy_agent_0": {"added_count": 2977024, "sampled_count": 4411392, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 2977024, "sampled_count": 4411392, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 9.2139253616333, "min_q": 8.899539947509766, "max_q": 9.813399314880371, "mean_td_error": 0.03275783360004425, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.56052017211914, "min_q": 10.30335521697998, "max_q": 10.685857772827148, "mean_td_error": 0.0025561079382896423, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 32016128, "episodes_total": 320168, "training_iteration": 308, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-16-49", "timestamp": 1569669409, "time_this_iter_s": 30.505399703979492, "time_total_s": 9404.853495121002, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3c3ea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3572.644771337509, "timesteps_since_restore": 12010240, "iterations_since_restore": 117, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 50.44256844075981, "episode_reward_min": 45.62690647561688, "episode_reward_mean": 47.585082120752276, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 18.747735309047965, "agent_1": 28.837346811704343}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6967987648646538, "mean_processing_ms": 3.0722567158924696, "mean_inference_ms": 1.9690401309704602}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 932, "num_steps_trained": 46804992, "num_steps_sampled": 32119040, "sample_throughput": 6426.321, "train_throughput": 6426.321, "num_weight_syncs": 23657, "num_samples_dropped": 205, "learner_queue": {"size_count": 80112, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.183, "replay_time_ms": 96.834, "update_priorities_time_ms": 53.95, "policy_agent_0": {"added_count": 3001600, "sampled_count": 4452352, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3001600, "sampled_count": 4452352, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 9.084842681884766, "min_q": 8.801225662231445, "max_q": 9.787858963012695, "mean_td_error": -0.012070011347532272, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.499246597290039, "min_q": 10.266578674316406, "max_q": 10.660099983215332, "mean_td_error": 0.018436264246702194, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 32119040, "episodes_total": 321184, "training_iteration": 309, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-17-19", "timestamp": 1569669439, "time_this_iter_s": 30.54784321784973, "time_total_s": 9435.401338338852, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ad7b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3603.192614555359, "timesteps_since_restore": 12113152, "iterations_since_restore": 118, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 46.83225253932567, "episode_reward_min": 44.708004008757435, "episode_reward_mean": 46.18437711963576, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 17.419913068766906, "agent_1": 28.76446405086892}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6967949152420726, "mean_processing_ms": 3.0728797482248495, "mean_inference_ms": 1.9690125994429428}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 935, "num_steps_trained": 46963456, "num_steps_sampled": 32221440, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23857, "num_samples_dropped": 205, "learner_queue": {"size_count": 80730, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.8, "replay_time_ms": 87.318, "update_priorities_time_ms": 52.059, "policy_agent_0": {"added_count": 3027456, "sampled_count": 4491008, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3027456, "sampled_count": 4491008, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.745586395263672, "min_q": 8.56447696685791, "max_q": 8.915566444396973, "mean_td_error": 0.012161504477262497, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.681026458740234, "min_q": 10.426856994628906, "max_q": 10.831805229187012, "mean_td_error": 0.01603451743721962, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 32221440, "episodes_total": 322224, "training_iteration": 310, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-17-50", "timestamp": 1569669470, "time_this_iter_s": 30.524091482162476, "time_total_s": 9465.925429821014, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b356620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3633.7167060375214, "timesteps_since_restore": 12215552, "iterations_since_restore": 119, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 50.51302347231668, "episode_reward_min": 43.20227280783109, "episode_reward_mean": 45.1804251591543, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 19.57183166081195, "agent_1": 25.608593498342444}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.696685514975494, "mean_processing_ms": 3.0715553701812564, "mean_inference_ms": 1.9690745813011772}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 939, "num_steps_trained": 47126528, "num_steps_sampled": 32323072, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24056, "num_samples_dropped": 205, "learner_queue": {"size_count": 81367, "size_mean": 0.24, "size_std": 0.5499090833947008, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.85, "replay_time_ms": 94.837, "update_priorities_time_ms": 46.185, "policy_agent_0": {"added_count": 3051520, "sampled_count": 4529664, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3051520, "sampled_count": 4529664, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.370259284973145, "min_q": 8.15682315826416, "max_q": 8.797364234924316, "mean_td_error": 0.017940474674105644, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.66362476348877, "min_q": 10.520671844482422, "max_q": 10.814826011657715, "mean_td_error": 0.005360275506973267, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 32323072, "episodes_total": 323224, "training_iteration": 311, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-18-20", "timestamp": 1569669500, "time_this_iter_s": 30.519092321395874, "time_total_s": 9496.44452214241, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f2e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3664.2357983589172, "timesteps_since_restore": 12317184, "iterations_since_restore": 120, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 48.88274895791303, "episode_reward_min": 43.187476938940634, "episode_reward_mean": 44.0162064787718, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 20.67008980112193, "agent_1": 23.346116677650002}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6970961002021229, "mean_processing_ms": 3.0734263754306266, "mean_inference_ms": 1.9695636361978874}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 942, "num_steps_trained": 47283968, "num_steps_sampled": 32425984, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24257, "num_samples_dropped": 205, "learner_queue": {"size_count": 81983, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.833, "replay_time_ms": 97.803, "update_priorities_time_ms": 53.613, "policy_agent_0": {"added_count": 3077632, "sampled_count": 4568832, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3077632, "sampled_count": 4568832, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.306002616882324, "min_q": 7.995509624481201, "max_q": 8.818422317504883, "mean_td_error": 0.0046305786818265915, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.450139045715332, "min_q": 10.1827974319458, "max_q": 10.70398235321045, "mean_td_error": 0.03947693109512329, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 32425984, "episodes_total": 324264, "training_iteration": 312, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-18-51", "timestamp": 1569669531, "time_this_iter_s": 30.550090551376343, "time_total_s": 9526.994612693787, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f8158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3694.7858889102936, "timesteps_since_restore": 12420096, "iterations_since_restore": 121, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.16174130529348, "episode_reward_min": 43.18021502666316, "episode_reward_mean": 43.51415078328896, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 20.19289201949785, "agent_1": 23.32125876379124}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6969442190212972, "mean_processing_ms": 3.07231810239515, "mean_inference_ms": 1.9685849670281739}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 945, "num_steps_trained": 47444480, "num_steps_sampled": 32529920, "sample_throughput": 16900.537, "train_throughput": 0.0, "num_weight_syncs": 24460, "num_samples_dropped": 205, "learner_queue": {"size_count": 82609, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.537, "replay_time_ms": 82.358, "update_priorities_time_ms": 47.579, "policy_agent_0": {"added_count": 3099648, "sampled_count": 4611328, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3099648, "sampled_count": 4611328, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.234140396118164, "min_q": 7.955711841583252, "max_q": 8.45329761505127, "mean_td_error": 0.02236448973417282, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 10.177881240844727, "min_q": 10.030278205871582, "max_q": 10.38785171508789, "mean_td_error": -0.006238717585802078, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 32529920, "episodes_total": 325304, "training_iteration": 313, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-19-21", "timestamp": 1569669561, "time_this_iter_s": 30.527384757995605, "time_total_s": 9557.521997451782, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b1032f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3725.313273668289, "timesteps_since_restore": 12524032, "iterations_since_restore": 122, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 48.797515884205346, "episode_reward_min": 43.187476938940634, "episode_reward_mean": 43.68715154839997, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 20.226819959711847, "agent_1": 23.460331588688245}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6971522574422641, "mean_processing_ms": 3.0733274684550067, "mean_inference_ms": 1.9697466320342163}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 948, "num_steps_trained": 47606528, "num_steps_sampled": 32632576, "sample_throughput": 17953.147, "train_throughput": 0.0, "num_weight_syncs": 24660, "num_samples_dropped": 205, "learner_queue": {"size_count": 83243, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 25.354, "replay_time_ms": 88.42, "update_priorities_time_ms": 43.14, "policy_agent_0": {"added_count": 3123968, "sampled_count": 4650240, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3123968, "sampled_count": 4650240, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.174335479736328, "min_q": 8.028614044189453, "max_q": 8.359087944030762, "mean_td_error": 0.007418176159262657, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 9.878767013549805, "min_q": 9.819737434387207, "max_q": 10.06834888458252, "mean_td_error": 0.014210399240255356, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 32632576, "episodes_total": 326320, "training_iteration": 314, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-19-52", "timestamp": 1569669592, "time_this_iter_s": 30.524325132369995, "time_total_s": 9588.046322584152, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae418c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3755.837598800659, "timesteps_since_restore": 12626688, "iterations_since_restore": 123, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.938434119365205, "episode_reward_min": 42.38754035367697, "episode_reward_mean": 43.73145265509085, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 20.180692017036066, "agent_1": 23.550760638054864}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6967883104698511, "mean_processing_ms": 3.0738075023970186, "mean_inference_ms": 1.9696581519430687}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 951, "num_steps_trained": 47765504, "num_steps_sampled": 32737024, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24864, "num_samples_dropped": 205, "learner_queue": {"size_count": 83863, "size_mean": 0.08, "size_std": 0.33704599092705434, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.052, "replay_time_ms": 96.442, "update_priorities_time_ms": 51.971, "policy_agent_0": {"added_count": 3151616, "sampled_count": 4688384, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3151616, "sampled_count": 4688384, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.05992603302002, "min_q": 7.951074600219727, "max_q": 8.278966903686523, "mean_td_error": 0.017104867845773697, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 9.693777084350586, "min_q": 9.588128089904785, "max_q": 9.79405689239502, "mean_td_error": 0.00024127215147018433, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 32737024, "episodes_total": 327376, "training_iteration": 315, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-20-23", "timestamp": 1569669623, "time_this_iter_s": 30.58296775817871, "time_total_s": 9618.629290342331, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b400510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3786.420566558838, "timesteps_since_restore": 12731136, "iterations_since_restore": 124, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.356420832453466, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.92258322185776, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 20.606900059422472, "agent_1": 21.315683162435416}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6968261213218657, "mean_processing_ms": 3.072969254963449, "mean_inference_ms": 1.9694790229546895}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 955, "num_steps_trained": 47927040, "num_steps_sampled": 32839168, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25064, "num_samples_dropped": 205, "learner_queue": {"size_count": 84494, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.009, "replay_time_ms": 101.262, "update_priorities_time_ms": 54.399, "policy_agent_0": {"added_count": 3175168, "sampled_count": 4728320, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3175168, "sampled_count": 4728320, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.99319314956665, "min_q": 7.918672561645508, "max_q": 8.161916732788086, "mean_td_error": 0.021334705874323845, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 9.401378631591797, "min_q": 9.239494323730469, "max_q": 9.523499488830566, "mean_td_error": -0.011426307260990143, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 32839168, "episodes_total": 328384, "training_iteration": 316, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-20-53", "timestamp": 1569669653, "time_this_iter_s": 30.44565439224243, "time_total_s": 9649.074944734573, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae449d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3816.8662209510803, "timesteps_since_restore": 12833280, "iterations_since_restore": 125, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.59505484052801, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.83212779713521, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 20.195258689310588, "agent_1": 22.63686910782474}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6970690968325903, "mean_processing_ms": 3.0727096128224107, "mean_inference_ms": 1.9693307106655087}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 958, "num_steps_trained": 48084736, "num_steps_sampled": 32943616, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25268, "num_samples_dropped": 205, "learner_queue": {"size_count": 85110, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.529, "replay_time_ms": 79.851, "update_priorities_time_ms": 47.888, "policy_agent_0": {"added_count": 3209216, "sampled_count": 4763904, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3209216, "sampled_count": 4763904, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.900733947753906, "min_q": 7.7930073738098145, "max_q": 8.061820030212402, "mean_td_error": 0.016785116866230965, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 9.244665145874023, "min_q": 9.103199005126953, "max_q": 9.363037109375, "mean_td_error": 0.005418818444013596, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 32943616, "episodes_total": 329440, "training_iteration": 317, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-21-24", "timestamp": 1569669684, "time_this_iter_s": 30.5047287940979, "time_total_s": 9679.579673528671, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae22620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3847.370949745178, "timesteps_since_restore": 12937728, "iterations_since_restore": 126, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.754560019297806, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.27241972962983, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 20.506966731000226, "agent_1": 21.765452998629684}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6977323339649697, "mean_processing_ms": 3.0728854964830727, "mean_inference_ms": 1.9693774814487461}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 961, "num_steps_trained": 48246272, "num_steps_sampled": 33047296, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25471, "num_samples_dropped": 205, "learner_queue": {"size_count": 85741, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.365, "replay_time_ms": 95.534, "update_priorities_time_ms": 51.475, "policy_agent_0": {"added_count": 3231232, "sampled_count": 4807168, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3231232, "sampled_count": 4807168, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.853671073913574, "min_q": 7.7721381187438965, "max_q": 8.015512466430664, "mean_td_error": 0.018761824816465378, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 9.074928283691406, "min_q": 8.994412422180176, "max_q": 9.221946716308594, "mean_td_error": 0.011557724326848984, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 33047296, "episodes_total": 330472, "training_iteration": 318, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-21-54", "timestamp": 1569669714, "time_this_iter_s": 30.499715089797974, "time_total_s": 9710.07938861847, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344aacbae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3877.870664834976, "timesteps_since_restore": 13041408, "iterations_since_restore": 127, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.199693125319136, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.82811494120076, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 20.772946703228683, "agent_1": 22.055168237972158}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6972996403784425, "mean_processing_ms": 3.072506486046063, "mean_inference_ms": 1.9688776837917972}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 964, "num_steps_trained": 48405760, "num_steps_sampled": 33152256, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25675, "num_samples_dropped": 205, "learner_queue": {"size_count": 86364, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 24.532, "replay_time_ms": 90.244, "update_priorities_time_ms": 66.14, "policy_agent_0": {"added_count": 3257344, "sampled_count": 4847360, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3257344, "sampled_count": 4847360, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.823766708374023, "min_q": 7.695803165435791, "max_q": 7.992499828338623, "mean_td_error": 0.016559943556785583, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.931710243225098, "min_q": 8.836791038513184, "max_q": 8.980768203735352, "mean_td_error": 0.0030307061970233917, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 33152256, "episodes_total": 331520, "training_iteration": 319, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-22-25", "timestamp": 1569669745, "time_this_iter_s": 30.570040225982666, "time_total_s": 9740.649428844452, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344aadb730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3908.440705060959, "timesteps_since_restore": 13146368, "iterations_since_restore": 128, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.84592574362765, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.71608673410004, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 20.50129234026318, "agent_1": 22.214794393836943}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.69730508825674, "mean_processing_ms": 3.072803967277046, "mean_inference_ms": 1.9685371574460857}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 967, "num_steps_trained": 48571136, "num_steps_sampled": 33253888, "sample_throughput": 0.0, "train_throughput": 23638.725, "num_weight_syncs": 25873, "num_samples_dropped": 205, "learner_queue": {"size_count": 87010, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.191, "replay_time_ms": 98.943, "update_priorities_time_ms": 49.369, "policy_agent_0": {"added_count": 3279360, "sampled_count": 4889600, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3279360, "sampled_count": 4889600, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.808747291564941, "min_q": 7.727691650390625, "max_q": 7.9047160148620605, "mean_td_error": 0.04265836626291275, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.789518356323242, "min_q": 8.713434219360352, "max_q": 8.897396087646484, "mean_td_error": 0.016305074095726013, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 33253888, "episodes_total": 332536, "training_iteration": 320, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-22-55", "timestamp": 1569669775, "time_this_iter_s": 30.52524495124817, "time_total_s": 9771.1746737957, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344aae0bf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3938.965950012207, "timesteps_since_restore": 13248000, "iterations_since_restore": 129, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.656098249744076, "episode_reward_min": 41.302381280308566, "episode_reward_mean": 42.58440680583353, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 20.537396245550966, "agent_1": 22.04701056028264}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6975080800441738, "mean_processing_ms": 3.0738262446248745, "mean_inference_ms": 1.9692331018713114}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 971, "num_steps_trained": 48736768, "num_steps_sampled": 33355776, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26073, "num_samples_dropped": 205, "learner_queue": {"size_count": 87658, "size_mean": 0.16, "size_std": 0.463033476111609, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.762, "replay_time_ms": 89.498, "update_priorities_time_ms": 50.236, "policy_agent_0": {"added_count": 3305472, "sampled_count": 4930816, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3305472, "sampled_count": 4930816, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.792934417724609, "min_q": 7.718850612640381, "max_q": 7.926157474517822, "mean_td_error": 0.019243642687797546, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.660758972167969, "min_q": 8.550758361816406, "max_q": 8.809903144836426, "mean_td_error": 0.018268786370754242, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 33355776, "episodes_total": 333560, "training_iteration": 321, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-23-26", "timestamp": 1569669806, "time_this_iter_s": 30.583402395248413, "time_total_s": 9801.758076190948, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae44b70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3969.5493524074554, "timesteps_since_restore": 13349888, "iterations_since_restore": 130, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.21897723030212, "episode_reward_min": 41.0891034794863, "episode_reward_mean": 42.507232854391816, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 20.516540559639235, "agent_1": 21.990692294752648}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6972332635439331, "mean_processing_ms": 3.0731004909771347, "mean_inference_ms": 1.9691331148584135}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 974, "num_steps_trained": 48896000, "num_steps_sampled": 33459712, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26276, "num_samples_dropped": 205, "learner_queue": {"size_count": 88279, "size_mean": 0.16, "size_std": 0.463033476111609, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.625, "replay_time_ms": 98.06, "update_priorities_time_ms": 54.921, "policy_agent_0": {"added_count": 3326208, "sampled_count": 4974848, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3326208, "sampled_count": 4974848, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.784537315368652, "min_q": 7.730596542358398, "max_q": 7.89075231552124, "mean_td_error": 0.03774134814739227, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.583148002624512, "min_q": 8.481806755065918, "max_q": 8.611390113830566, "mean_td_error": 0.007719486951828003, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 33459712, "episodes_total": 334600, "training_iteration": 322, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-23-57", "timestamp": 1569669837, "time_this_iter_s": 30.607938051223755, "time_total_s": 9832.366014242172, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b400048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4000.157290458679, "timesteps_since_restore": 13453824, "iterations_since_restore": 131, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.21832820256485, "episode_reward_min": 41.780549526067915, "episode_reward_mean": 42.53195913906639, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 20.560469975239144, "agent_1": 21.97148916382728}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6975228374350708, "mean_processing_ms": 3.0726983653582756, "mean_inference_ms": 1.969013859234994}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 977, "num_steps_trained": 49056256, "num_steps_sampled": 33565952, "sample_throughput": 19019.091, "train_throughput": 0.0, "num_weight_syncs": 26483, "num_samples_dropped": 205, "learner_queue": {"size_count": 88905, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.163, "replay_time_ms": 94.368, "update_priorities_time_ms": 47.129, "policy_agent_0": {"added_count": 3352320, "sampled_count": 5016576, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3352320, "sampled_count": 5016576, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7670698165893555, "min_q": 7.670440196990967, "max_q": 7.862553596496582, "mean_td_error": 0.027745379135012627, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.547468185424805, "min_q": 8.453643798828125, "max_q": 8.566384315490723, "mean_td_error": 0.03491416200995445, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 33565952, "episodes_total": 335664, "training_iteration": 323, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-24-27", "timestamp": 1569669867, "time_this_iter_s": 30.732718229293823, "time_total_s": 9863.098732471466, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b1036a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4030.890008687973, "timesteps_since_restore": 13560064, "iterations_since_restore": 132, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.499946923591835, "episode_reward_min": 41.159123032668546, "episode_reward_mean": 42.36468504702753, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 20.577967336889277, "agent_1": 21.786717710138316}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6971039738042311, "mean_processing_ms": 3.0727201758347924, "mean_inference_ms": 1.9685986417750163}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 980, "num_steps_trained": 49216256, "num_steps_sampled": 33670656, "sample_throughput": 8345.446, "train_throughput": 0.0, "num_weight_syncs": 26688, "num_samples_dropped": 205, "learner_queue": {"size_count": 89531, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.249, "replay_time_ms": 81.859, "update_priorities_time_ms": 44.791, "policy_agent_0": {"added_count": 3378944, "sampled_count": 5057280, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3378944, "sampled_count": 5057280, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.751377105712891, "min_q": 7.619084358215332, "max_q": 7.812473773956299, "mean_td_error": 0.02815890498459339, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.451274871826172, "min_q": 8.387308120727539, "max_q": 8.548103332519531, "mean_td_error": -0.0035093314945697784, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 33670656, "episodes_total": 336712, "training_iteration": 324, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-24-58", "timestamp": 1569669898, "time_this_iter_s": 30.50216269493103, "time_total_s": 9893.600895166397, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b401840>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4061.392171382904, "timesteps_since_restore": 13664768, "iterations_since_restore": 133, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.0507358957025, "episode_reward_min": 41.365383287613355, "episode_reward_mean": 42.43831918714458, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.5894854692922, "agent_1": 21.84883371785243}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6972502276803191, "mean_processing_ms": 3.071020094603341, "mean_inference_ms": 1.96746496780557}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 983, "num_steps_trained": 49372672, "num_steps_sampled": 33777920, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26898, "num_samples_dropped": 205, "learner_queue": {"size_count": 90141, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.425, "replay_time_ms": 99.018, "update_priorities_time_ms": 54.276, "policy_agent_0": {"added_count": 3404544, "sampled_count": 5097216, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3404544, "sampled_count": 5097216, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.746870040893555, "min_q": 7.659404277801514, "max_q": 7.808602809906006, "mean_td_error": 0.009064516052603722, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.389667510986328, "min_q": 8.3452787399292, "max_q": 8.47484302520752, "mean_td_error": 0.013024400919675827, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 33777920, "episodes_total": 337784, "training_iteration": 325, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-25-29", "timestamp": 1569669929, "time_this_iter_s": 30.548854112625122, "time_total_s": 9924.149749279022, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f2bf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4091.941025495529, "timesteps_since_restore": 13772032, "iterations_since_restore": 134, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.27937396151158, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.25472134211924, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 20.506830908966386, "agent_1": 21.747890433152932}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.69679249569456, "mean_processing_ms": 3.071829191753756, "mean_inference_ms": 1.968129426299994}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 987, "num_steps_trained": 49532672, "num_steps_sampled": 33881600, "sample_throughput": 0.0, "train_throughput": 14789.425, "num_weight_syncs": 27100, "num_samples_dropped": 205, "learner_queue": {"size_count": 90766, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.358, "replay_time_ms": 95.746, "update_priorities_time_ms": 50.43, "policy_agent_0": {"added_count": 3430144, "sampled_count": 5140224, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3430144, "sampled_count": 5140224, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7248759269714355, "min_q": 7.679941177368164, "max_q": 7.801970958709717, "mean_td_error": 0.005514154210686684, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.348628044128418, "min_q": 8.261509895324707, "max_q": 8.372527122497559, "mean_td_error": 0.029746409505605698, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 33881600, "episodes_total": 338816, "training_iteration": 326, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-25-59", "timestamp": 1569669959, "time_this_iter_s": 30.519046306610107, "time_total_s": 9954.668795585632, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3560d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4122.460071802139, "timesteps_since_restore": 13875712, "iterations_since_restore": 135, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.187128680903434, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.808026370304056, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 20.575460551113007, "agent_1": 21.23256581919114}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6973537297670087, "mean_processing_ms": 3.0707101849764746, "mean_inference_ms": 1.967731301473289}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 990, "num_steps_trained": 49696768, "num_steps_sampled": 33984512, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27301, "num_samples_dropped": 205, "learner_queue": {"size_count": 91407, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.198, "replay_time_ms": 82.996, "update_priorities_time_ms": 45.205, "policy_agent_0": {"added_count": 3456000, "sampled_count": 5181440, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3456000, "sampled_count": 5181440, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.701529502868652, "min_q": 7.639153957366943, "max_q": 7.787167549133301, "mean_td_error": 0.00559329055249691, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.295620918273926, "min_q": 8.196930885314941, "max_q": 8.35606575012207, "mean_td_error": 0.013173969462513924, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 33984512, "episodes_total": 339848, "training_iteration": 327, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-26-30", "timestamp": 1569669990, "time_this_iter_s": 30.415153741836548, "time_total_s": 9985.083949327469, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ad620>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4152.875225543976, "timesteps_since_restore": 13978624, "iterations_since_restore": 136, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.873378443047, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.77003881342804, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 20.57328041534463, "agent_1": 21.196758398083517}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6973148832433238, "mean_processing_ms": 3.0704907158274697, "mean_inference_ms": 1.9667584891606376}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 993, "num_steps_trained": 49857280, "num_steps_sampled": 34089984, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27507, "num_samples_dropped": 205, "learner_queue": {"size_count": 92034, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.147, "replay_time_ms": 103.221, "update_priorities_time_ms": 55.272, "policy_agent_0": {"added_count": 3486720, "sampled_count": 5219584, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3486720, "sampled_count": 5219584, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7268385887146, "min_q": 7.698365688323975, "max_q": 7.741085529327393, "mean_td_error": 0.01192672923207283, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.240427017211914, "min_q": 8.1492919921875, "max_q": 8.283075332641602, "mean_td_error": 0.024656716734170914, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 34089984, "episodes_total": 340896, "training_iteration": 328, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-27-00", "timestamp": 1569670020, "time_this_iter_s": 30.547852516174316, "time_total_s": 10015.631801843643, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b39c1e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4183.42307806015, "timesteps_since_restore": 14084096, "iterations_since_restore": 137, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.13537190588205, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.863290842513905, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 20.542650300603782, "agent_1": 21.32064054191023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6967587769979794, "mean_processing_ms": 3.06980265868371, "mean_inference_ms": 1.9672617319691064}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 996, "num_steps_trained": 50016256, "num_steps_sampled": 34194688, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27712, "num_samples_dropped": 205, "learner_queue": {"size_count": 92655, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.375, "replay_time_ms": 93.874, "update_priorities_time_ms": 51.692, "policy_agent_0": {"added_count": 3513344, "sampled_count": 5257984, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3513344, "sampled_count": 5257984, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.733678817749023, "min_q": 7.6769700050354, "max_q": 7.752377033233643, "mean_td_error": 0.021850816905498505, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.17091178894043, "min_q": 8.098092079162598, "max_q": 8.242050170898438, "mean_td_error": 0.01054571382701397, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 34194688, "episodes_total": 341952, "training_iteration": 329, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-27-31", "timestamp": 1569670051, "time_this_iter_s": 30.498898029327393, "time_total_s": 10046.13069987297, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bc9d7b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4213.9219760894775, "timesteps_since_restore": 14188800, "iterations_since_restore": 138, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.15995545626458, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.040235609786656, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 20.565321281726153, "agent_1": 21.474914328060585}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6966983058093549, "mean_processing_ms": 3.069820153997862, "mean_inference_ms": 1.9670551536567433}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 999, "num_steps_trained": 50171648, "num_steps_sampled": 34301696, "sample_throughput": 0.0, "train_throughput": 23899.7, "num_weight_syncs": 27921, "num_samples_dropped": 205, "learner_queue": {"size_count": 93262, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.057, "replay_time_ms": 102.922, "update_priorities_time_ms": 50.861, "policy_agent_0": {"added_count": 3540224, "sampled_count": 5297408, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3540224, "sampled_count": 5297408, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.726198673248291, "min_q": 7.635761737823486, "max_q": 7.734382629394531, "mean_td_error": 0.02862289734184742, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.150957107543945, "min_q": 8.13631820678711, "max_q": 8.215517044067383, "mean_td_error": -0.00366855226457119, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 34301696, "episodes_total": 343016, "training_iteration": 330, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-28-01", "timestamp": 1569670081, "time_this_iter_s": 30.44235062599182, "time_total_s": 10076.573050498962, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b416ea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4244.364326715469, "timesteps_since_restore": 14295808, "iterations_since_restore": 139, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.89801108909456, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.63747440419086, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 20.573516212812404, "agent_1": 21.06395819137858}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6965846882842684, "mean_processing_ms": 3.070831943030926, "mean_inference_ms": 1.9675283317720986}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1002, "num_steps_trained": 50332416, "num_steps_sampled": 34405632, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28123, "num_samples_dropped": 205, "learner_queue": {"size_count": 93890, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.083, "replay_time_ms": 107.315, "update_priorities_time_ms": 55.224, "policy_agent_0": {"added_count": 3568128, "sampled_count": 5338112, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3568128, "sampled_count": 5338112, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.736412048339844, "min_q": 7.693665504455566, "max_q": 7.7592926025390625, "mean_td_error": 0.0025359001010656357, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.118892669677734, "min_q": 8.025884628295898, "max_q": 8.197311401367188, "mean_td_error": 0.03399350866675377, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 34405632, "episodes_total": 344056, "training_iteration": 331, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-28-32", "timestamp": 1569670112, "time_this_iter_s": 30.626081466674805, "time_total_s": 10107.199131965637, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b440268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4274.990408182144, "timesteps_since_restore": 14399744, "iterations_since_restore": 140, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.88543758067755, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.815090381537175, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 20.58871292645718, "agent_1": 21.22637745508008}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6969794871254156, "mean_processing_ms": 3.0697732294299733, "mean_inference_ms": 1.9670893813039096}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1006, "num_steps_trained": 50497280, "num_steps_sampled": 34508544, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28324, "num_samples_dropped": 205, "learner_queue": {"size_count": 94534, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.312, "replay_time_ms": 87.822, "update_priorities_time_ms": 47.727, "policy_agent_0": {"added_count": 3594240, "sampled_count": 5380352, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3594240, "sampled_count": 5380352, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.741659164428711, "min_q": 7.672039985656738, "max_q": 7.804673671722412, "mean_td_error": 0.028841888532042503, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.058263778686523, "min_q": 7.9592084884643555, "max_q": 8.132513046264648, "mean_td_error": -0.012118278071284294, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 34508544, "episodes_total": 345096, "training_iteration": 332, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-29-02", "timestamp": 1569670142, "time_this_iter_s": 30.594820499420166, "time_total_s": 10137.793952465057, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b42c9d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4305.585228681564, "timesteps_since_restore": 14502656, "iterations_since_restore": 141, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.79697497746166, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.93604272014395, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 20.574886681643605, "agent_1": 21.361156038500447}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6963080748184556, "mean_processing_ms": 3.069069192470048, "mean_inference_ms": 1.9666644042010828}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1009, "num_steps_trained": 50658560, "num_steps_sampled": 34612736, "sample_throughput": 8227.886, "train_throughput": 2742.629, "num_weight_syncs": 28528, "num_samples_dropped": 205, "learner_queue": {"size_count": 95165, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.141, "replay_time_ms": 88.589, "update_priorities_time_ms": 50.128, "policy_agent_0": {"added_count": 3618816, "sampled_count": 5421312, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3618816, "sampled_count": 5421312, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.708874702453613, "min_q": 7.6361985206604, "max_q": 7.760863304138184, "mean_td_error": -0.004474537447094917, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.069137573242188, "min_q": 7.975260257720947, "max_q": 8.127691268920898, "mean_td_error": 0.01876797340810299, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 34612736, "episodes_total": 346136, "training_iteration": 333, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-29-33", "timestamp": 1569670173, "time_this_iter_s": 30.56986975669861, "time_total_s": 10168.363822221756, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b437ea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4336.155098438263, "timesteps_since_restore": 14606848, "iterations_since_restore": 142, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.86704626069372, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.1773187184398, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 20.5940693221083, "agent_1": 21.58324939633157}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6966972988699204, "mean_processing_ms": 3.0681310801651165, "mean_inference_ms": 1.9663254481986292}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1012, "num_steps_trained": 50817792, "num_steps_sampled": 34719488, "sample_throughput": 5305.468, "train_throughput": 10610.936, "num_weight_syncs": 28737, "num_samples_dropped": 205, "learner_queue": {"size_count": 95787, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.325, "replay_time_ms": 83.049, "update_priorities_time_ms": 47.906, "policy_agent_0": {"added_count": 3647232, "sampled_count": 5461760, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3647232, "sampled_count": 5461760, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.728540897369385, "min_q": 7.643344879150391, "max_q": 7.732974052429199, "mean_td_error": 0.01978333666920662, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.077136993408203, "min_q": 7.945495128631592, "max_q": 8.120950698852539, "mean_td_error": 0.006318271160125732, "model": {}}}}, "timesteps_this_iter": 106752, "done": false, "timesteps_total": 34719488, "episodes_total": 347200, "training_iteration": 334, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-30-04", "timestamp": 1569670204, "time_this_iter_s": 30.526038646697998, "time_total_s": 10198.889860868454, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b381b70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4366.681137084961, "timesteps_since_restore": 14713600, "iterations_since_restore": 143, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.80826758980417, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.93879348181864, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 20.579025136155632, "agent_1": 21.359768345663095}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6964205400145842, "mean_processing_ms": 3.0686624633960546, "mean_inference_ms": 1.966619446611366}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1015, "num_steps_trained": 50979072, "num_steps_sampled": 34825216, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28943, "num_samples_dropped": 205, "learner_queue": {"size_count": 96416, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.866, "replay_time_ms": 95.23, "update_priorities_time_ms": 49.631, "policy_agent_0": {"added_count": 3675392, "sampled_count": 5501184, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3675392, "sampled_count": 5501184, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7157487869262695, "min_q": 7.648538112640381, "max_q": 7.740962028503418, "mean_td_error": 0.02096792496740818, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.074816703796387, "min_q": 7.960428714752197, "max_q": 8.136115074157715, "mean_td_error": 0.010901661589741707, "model": {}}}}, "timesteps_this_iter": 105728, "done": false, "timesteps_total": 34825216, "episodes_total": 348256, "training_iteration": 335, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-30-34", "timestamp": 1569670234, "time_this_iter_s": 30.597347259521484, "time_total_s": 10229.487208127975, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b452378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4397.278484344482, "timesteps_since_restore": 14819328, "iterations_since_restore": 144, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.031659806022255, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.011202841636276, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 20.578421248006016, "agent_1": 21.432781593630345}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6962725771178441, "mean_processing_ms": 3.067733062512194, "mean_inference_ms": 1.9660592211212733}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1019, "num_steps_trained": 51140864, "num_steps_sampled": 34930176, "sample_throughput": 0.0, "train_throughput": 12969.463, "num_weight_syncs": 29148, "num_samples_dropped": 205, "learner_queue": {"size_count": 97049, "size_mean": 0.28, "size_std": 0.6013318551349163, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 34.223, "replay_time_ms": 98.605, "update_priorities_time_ms": 54.299, "policy_agent_0": {"added_count": 3701760, "sampled_count": 5539840, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3701760, "sampled_count": 5539840, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.732473850250244, "min_q": 7.635850429534912, "max_q": 7.744320392608643, "mean_td_error": 0.02307889237999916, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.06018352508545, "min_q": 7.9495625495910645, "max_q": 8.095460891723633, "mean_td_error": 0.019911425188183784, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 34930176, "episodes_total": 349304, "training_iteration": 336, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-31-05", "timestamp": 1569670265, "time_this_iter_s": 30.50152325630188, "time_total_s": 10259.988731384277, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d8048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4427.780007600784, "timesteps_since_restore": 14924288, "iterations_since_restore": 145, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.86165672260835, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.02885892404816, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.57005866093152, "agent_1": 21.45880026311673}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6967521571264575, "mean_processing_ms": 3.0674865625989827, "mean_inference_ms": 1.9659888637777898}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1022, "num_steps_trained": 51299072, "num_steps_sampled": 35037696, "sample_throughput": 9041.123, "train_throughput": 0.0, "num_weight_syncs": 29358, "num_samples_dropped": 205, "learner_queue": {"size_count": 97666, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.79, "replay_time_ms": 70.725, "update_priorities_time_ms": 38.833, "policy_agent_0": {"added_count": 3728640, "sampled_count": 5579264, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3728640, "sampled_count": 5579264, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.742895603179932, "min_q": 7.660371780395508, "max_q": 7.7486419677734375, "mean_td_error": 0.025967633351683617, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.071157455444336, "min_q": 8.015213966369629, "max_q": 8.129136085510254, "mean_td_error": 0.0261395126581192, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 35037696, "episodes_total": 350376, "training_iteration": 337, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-31-35", "timestamp": 1569670295, "time_this_iter_s": 30.39725685119629, "time_total_s": 10290.385988235474, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae1bd08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4458.177264451981, "timesteps_since_restore": 15031808, "iterations_since_restore": 146, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.79983285903644, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.95046670291286, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 20.58100567482278, "agent_1": 21.36946102809017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6967003875263938, "mean_processing_ms": 3.066950699980513, "mean_inference_ms": 1.9655555807203005}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1025, "num_steps_trained": 51456000, "num_steps_sampled": 35146240, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29570, "num_samples_dropped": 205, "learner_queue": {"size_count": 98279, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.728, "replay_time_ms": 89.352, "update_priorities_time_ms": 48.404, "policy_agent_0": {"added_count": 3756544, "sampled_count": 5620736, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3756544, "sampled_count": 5620736, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.701637268066406, "min_q": 7.607416152954102, "max_q": 7.7086710929870605, "mean_td_error": 0.013277895748615265, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.070259094238281, "min_q": 8.03662109375, "max_q": 8.130599021911621, "mean_td_error": 0.021217918023467064, "model": {}}}}, "timesteps_this_iter": 108544, "done": false, "timesteps_total": 35146240, "episodes_total": 351464, "training_iteration": 338, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-32-06", "timestamp": 1569670326, "time_this_iter_s": 30.470194578170776, "time_total_s": 10320.856182813644, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b102048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4488.647459030151, "timesteps_since_restore": 15140352, "iterations_since_restore": 147, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.830646731532866, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.80405559577912, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 20.575522578069464, "agent_1": 21.22853301770974}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6963100465849605, "mean_processing_ms": 3.066710249132111, "mean_inference_ms": 1.9652414328373073}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1028, "num_steps_trained": 51619072, "num_steps_sampled": 35250944, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29774, "num_samples_dropped": 205, "learner_queue": {"size_count": 98916, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.806, "replay_time_ms": 103.82, "update_priorities_time_ms": 55.609, "policy_agent_0": {"added_count": 3782400, "sampled_count": 5660672, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3782400, "sampled_count": 5660672, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.712281703948975, "min_q": 7.6921234130859375, "max_q": 7.726009845733643, "mean_td_error": 0.006890216842293739, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.048933029174805, "min_q": 8.035813331604004, "max_q": 8.125346183776855, "mean_td_error": 0.016144007444381714, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 35250944, "episodes_total": 352512, "training_iteration": 339, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-32-36", "timestamp": 1569670356, "time_this_iter_s": 30.58330202102661, "time_total_s": 10351.439484834671, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae297b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4519.230761051178, "timesteps_since_restore": 15245056, "iterations_since_restore": 148, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.34973653595862, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.18980427277834, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 20.574856938032298, "agent_1": 21.614947334746116}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6966936504696611, "mean_processing_ms": 3.067287574354834, "mean_inference_ms": 1.9653250095558314}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1031, "num_steps_trained": 51782656, "num_steps_sampled": 35355392, "sample_throughput": 7700.469, "train_throughput": 3850.234, "num_weight_syncs": 29979, "num_samples_dropped": 205, "learner_queue": {"size_count": 99555, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 25.963, "replay_time_ms": 90.835, "update_priorities_time_ms": 52.932, "policy_agent_0": {"added_count": 3810048, "sampled_count": 5703168, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3810048, "sampled_count": 5703168, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.710217475891113, "min_q": 7.607074737548828, "max_q": 7.717042446136475, "mean_td_error": 0.02813771180808544, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.037626266479492, "min_q": 7.926169395446777, "max_q": 8.096367835998535, "mean_td_error": 0.016229579225182533, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 35355392, "episodes_total": 353552, "training_iteration": 340, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-33-07", "timestamp": 1569670387, "time_this_iter_s": 30.542405366897583, "time_total_s": 10381.981890201569, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344aae9b70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4549.773166418076, "timesteps_since_restore": 15349504, "iterations_since_restore": 149, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.81982013988226, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.702786548799544, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.58099550028275, "agent_1": 21.1217910485169}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6967136439495413, "mean_processing_ms": 3.067115835646701, "mean_inference_ms": 1.9650925360049436}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1034, "num_steps_trained": 51938048, "num_steps_sampled": 35462656, "sample_throughput": 0.0, "train_throughput": 24118.19, "num_weight_syncs": 30188, "num_samples_dropped": 205, "learner_queue": {"size_count": 100162, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 28.529, "replay_time_ms": 99.42, "update_priorities_time_ms": 55.996, "policy_agent_0": {"added_count": 3833600, "sampled_count": 5741312, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3833600, "sampled_count": 5741312, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.706954002380371, "min_q": 7.622034549713135, "max_q": 7.7173590660095215, "mean_td_error": 0.011047007516026497, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.041664123535156, "min_q": 7.971825122833252, "max_q": 8.103201866149902, "mean_td_error": 0.03720799461007118, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 35462656, "episodes_total": 354624, "training_iteration": 341, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-33-38", "timestamp": 1569670418, "time_this_iter_s": 30.669835329055786, "time_total_s": 10412.651725530624, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae29840>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4580.443001747131, "timesteps_since_restore": 15456768, "iterations_since_restore": 150, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.92327328137691, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.25890453766711, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 20.55492428968941, "agent_1": 21.703980247977782}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6960452532902416, "mean_processing_ms": 3.0661967637750576, "mean_inference_ms": 1.9636185180380523}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1038, "num_steps_trained": 52094976, "num_steps_sampled": 35570944, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30399, "num_samples_dropped": 205, "learner_queue": {"size_count": 100775, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.154, "replay_time_ms": 76.579, "update_priorities_time_ms": 36.276, "policy_agent_0": {"added_count": 3858176, "sampled_count": 5780992, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3858176, "sampled_count": 5780992, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.694777488708496, "min_q": 7.562727928161621, "max_q": 7.785232067108154, "mean_td_error": 0.012326614931225777, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.069811820983887, "min_q": 7.933415412902832, "max_q": 8.160500526428223, "mean_td_error": 0.032522350549697876, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 35570944, "episodes_total": 355712, "training_iteration": 342, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-34-08", "timestamp": 1569670448, "time_this_iter_s": 30.49757218360901, "time_total_s": 10443.149297714233, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344aaf7840>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4610.94057393074, "timesteps_since_restore": 15565056, "iterations_since_restore": 151, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.37578306418271, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.97559588668994, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.575286893870107, "agent_1": 21.400308992819923}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6961617423777344, "mean_processing_ms": 3.063246673726494, "mean_inference_ms": 1.9622594603406651}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1041, "num_steps_trained": 52250624, "num_steps_sampled": 35680256, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30613, "num_samples_dropped": 205, "learner_queue": {"size_count": 101383, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.348, "replay_time_ms": 86.134, "update_priorities_time_ms": 42.117, "policy_agent_0": {"added_count": 3879936, "sampled_count": 5822208, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3879936, "sampled_count": 5822208, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.701117515563965, "min_q": 7.5710344314575195, "max_q": 7.713119983673096, "mean_td_error": -0.01316988468170166, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.017807960510254, "min_q": 7.935972213745117, "max_q": 8.139115333557129, "mean_td_error": 0.003853878006339073, "model": {}}}}, "timesteps_this_iter": 109312, "done": false, "timesteps_total": 35680256, "episodes_total": 356808, "training_iteration": 343, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-34-39", "timestamp": 1569670479, "time_this_iter_s": 30.499463319778442, "time_total_s": 10473.648761034012, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ab05d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4641.440037250519, "timesteps_since_restore": 15674368, "iterations_since_restore": 152, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.91802713722842, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.062663141687246, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.56888576135231, "agent_1": 21.49377738033502}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6954574971118762, "mean_processing_ms": 3.0652532662960983, "mean_inference_ms": 1.9628275073891326}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1044, "num_steps_trained": 52407552, "num_steps_sampled": 35788544, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30825, "num_samples_dropped": 205, "learner_queue": {"size_count": 101998, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.624, "replay_time_ms": 96.518, "update_priorities_time_ms": 54.702, "policy_agent_0": {"added_count": 3907072, "sampled_count": 5860608, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3907072, "sampled_count": 5860608, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.731062412261963, "min_q": 7.612546443939209, "max_q": 7.7368388175964355, "mean_td_error": 0.027422411367297173, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.043926239013672, "min_q": 7.918506145477295, "max_q": 8.165060997009277, "mean_td_error": 0.005577070638537407, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 35788544, "episodes_total": 357888, "training_iteration": 344, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-35-09", "timestamp": 1569670509, "time_this_iter_s": 30.494130611419678, "time_total_s": 10504.142891645432, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae29510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4671.9341678619385, "timesteps_since_restore": 15782656, "iterations_since_restore": 153, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.3314360499016, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.81526256725769, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.55195911913117, "agent_1": 21.26330344812663}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6955002879227298, "mean_processing_ms": 3.0630841873949857, "mean_inference_ms": 1.961112383044945}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1047, "num_steps_trained": 52565504, "num_steps_sampled": 35895808, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31035, "num_samples_dropped": 205, "learner_queue": {"size_count": 102613, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.552, "replay_time_ms": 62.145, "update_priorities_time_ms": 36.696, "policy_agent_0": {"added_count": 3939840, "sampled_count": 5900032, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3939840, "sampled_count": 5900032, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.726501941680908, "min_q": 7.6737871170043945, "max_q": 7.731416702270508, "mean_td_error": -0.005614124238491058, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.062769889831543, "min_q": 7.994572162628174, "max_q": 8.195372581481934, "mean_td_error": 0.008410733193159103, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 35895808, "episodes_total": 358960, "training_iteration": 345, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-35-40", "timestamp": 1569670540, "time_this_iter_s": 30.461411952972412, "time_total_s": 10534.604303598404, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0fff28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4702.395579814911, "timesteps_since_restore": 15889920, "iterations_since_restore": 154, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.734324625809066, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.05961683453399, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 20.56623488384927, "agent_1": 21.493381950684807}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6962877658745561, "mean_processing_ms": 3.0626901731467346, "mean_inference_ms": 1.9613519751497392}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1050, "num_steps_trained": 52727296, "num_steps_sampled": 36001536, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31240, "num_samples_dropped": 205, "learner_queue": {"size_count": 103246, "size_mean": 0.24, "size_std": 0.42708313008125254, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 26.73, "replay_time_ms": 94.078, "update_priorities_time_ms": 52.111, "policy_agent_0": {"added_count": 3965440, "sampled_count": 5938688, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3965440, "sampled_count": 5938688, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.734473705291748, "min_q": 7.6594414710998535, "max_q": 7.762688159942627, "mean_td_error": 0.0012949686497449875, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.038259506225586, "min_q": 7.89999532699585, "max_q": 8.21688461303711, "mean_td_error": 0.004140650853514671, "model": {}}}}, "timesteps_this_iter": 105728, "done": false, "timesteps_total": 36001536, "episodes_total": 360016, "training_iteration": 346, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-36-10", "timestamp": 1569670570, "time_this_iter_s": 30.62635350227356, "time_total_s": 10565.230657100677, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae1bc80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4733.021933317184, "timesteps_since_restore": 15995648, "iterations_since_restore": 155, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.79535846632765, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.937726940074256, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.570083624664367, "agent_1": 21.367643315409985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6958520167416059, "mean_processing_ms": 3.062334162042758, "mean_inference_ms": 1.9607658436652071}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1053, "num_steps_trained": 52884736, "num_steps_sampled": 36111360, "sample_throughput": 0.0, "train_throughput": 16898.941, "num_weight_syncs": 31455, "num_samples_dropped": 205, "learner_queue": {"size_count": 103860, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.804, "replay_time_ms": 82.994, "update_priorities_time_ms": 45.268, "policy_agent_0": {"added_count": 3988992, "sampled_count": 5978624, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 3988992, "sampled_count": 5978624, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.727518558502197, "min_q": 7.642108917236328, "max_q": 7.735443115234375, "mean_td_error": 0.03216671943664551, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.043341636657715, "min_q": 7.80702543258667, "max_q": 8.259710311889648, "mean_td_error": 0.015896381810307503, "model": {}}}}, "timesteps_this_iter": 109824, "done": false, "timesteps_total": 36111360, "episodes_total": 361112, "training_iteration": 347, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-36-41", "timestamp": 1569670601, "time_this_iter_s": 30.442445993423462, "time_total_s": 10595.673103094101, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ee7b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4763.464379310608, "timesteps_since_restore": 16105472, "iterations_since_restore": 156, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.98090370929512, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.84405861195335, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.57901362028649, "agent_1": 21.26504499166695}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6955194754586386, "mean_processing_ms": 3.0619350470288182, "mean_inference_ms": 1.960546901567727}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1056, "num_steps_trained": 53038080, "num_steps_sampled": 36220160, "sample_throughput": 0.0, "train_throughput": 14793.092, "num_weight_syncs": 31667, "num_samples_dropped": 205, "learner_queue": {"size_count": 104459, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.86, "replay_time_ms": 71.551, "update_priorities_time_ms": 37.744, "policy_agent_0": {"added_count": 4014848, "sampled_count": 6017792, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4014848, "sampled_count": 6017792, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.754446506500244, "min_q": 7.687609672546387, "max_q": 7.7596235275268555, "mean_td_error": 0.03668724745512009, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.057746887207031, "min_q": 8.008182525634766, "max_q": 8.230180740356445, "mean_td_error": 0.031738318502902985, "model": {}}}}, "timesteps_this_iter": 108800, "done": false, "timesteps_total": 36220160, "episodes_total": 362208, "training_iteration": 348, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-37-11", "timestamp": 1569670631, "time_this_iter_s": 30.456971168518066, "time_total_s": 10626.130074262619, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4527b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4793.921350479126, "timesteps_since_restore": 16214272, "iterations_since_restore": 157, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.86858025240636, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.99233961244839, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.577798172850493, "agent_1": 21.41454143959797}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6949988803541525, "mean_processing_ms": 3.061685530282115, "mean_inference_ms": 1.9602377587387276}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1060, "num_steps_trained": 53195008, "num_steps_sampled": 36328448, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31879, "num_samples_dropped": 205, "learner_queue": {"size_count": 105072, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.888, "replay_time_ms": 99.629, "update_priorities_time_ms": 50.808, "policy_agent_0": {"added_count": 4043776, "sampled_count": 6057472, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4043776, "sampled_count": 6057472, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.719121932983398, "min_q": 7.634631156921387, "max_q": 7.735129356384277, "mean_td_error": 0.01667197421193123, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.023924827575684, "min_q": 7.948055267333984, "max_q": 8.162717819213867, "mean_td_error": 0.022755173966288567, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 36328448, "episodes_total": 363288, "training_iteration": 349, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-37-42", "timestamp": 1569670662, "time_this_iter_s": 30.546871423721313, "time_total_s": 10656.67694568634, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d0d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4824.468221902847, "timesteps_since_restore": 16322560, "iterations_since_restore": 158, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.90755628711646, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.06779415756316, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.584397284479124, "agent_1": 21.48339687308411}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6954406551990716, "mean_processing_ms": 3.0605899340171208, "mean_inference_ms": 1.9593715526789655}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1063, "num_steps_trained": 53354496, "num_steps_sampled": 36435968, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32089, "num_samples_dropped": 205, "learner_queue": {"size_count": 105695, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.242, "replay_time_ms": 95.16, "update_priorities_time_ms": 50.366, "policy_agent_0": {"added_count": 4071424, "sampled_count": 6097664, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4071424, "sampled_count": 6097664, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.716938495635986, "min_q": 7.623550891876221, "max_q": 7.722785472869873, "mean_td_error": 0.0065609607845544815, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.035552024841309, "min_q": 7.927412509918213, "max_q": 8.098676681518555, "mean_td_error": 0.025555768981575966, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 36435968, "episodes_total": 364368, "training_iteration": 350, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-38-12", "timestamp": 1569670692, "time_this_iter_s": 30.603055715560913, "time_total_s": 10687.280001401901, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b437bf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4855.071277618408, "timesteps_since_restore": 16430080, "iterations_since_restore": 159, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.06167503441311, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.42261724417621, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.597074028048567, "agent_1": 21.825543216127677}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6952649695535376, "mean_processing_ms": 3.060574675606027, "mean_inference_ms": 1.9586237710443757}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1066, "num_steps_trained": 53506816, "num_steps_sampled": 36546304, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32304, "num_samples_dropped": 205, "learner_queue": {"size_count": 106290, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.609, "replay_time_ms": 67.977, "update_priorities_time_ms": 42.725, "policy_agent_0": {"added_count": 4097792, "sampled_count": 6136832, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4097792, "sampled_count": 6136832, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.702002048492432, "min_q": 7.613762855529785, "max_q": 7.711711883544922, "mean_td_error": -2.8470531105995178e-05, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.06367301940918, "min_q": 7.94364070892334, "max_q": 8.0929594039917, "mean_td_error": 0.02751464769244194, "model": {}}}}, "timesteps_this_iter": 110336, "done": false, "timesteps_total": 36546304, "episodes_total": 365464, "training_iteration": 351, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-38-43", "timestamp": 1569670723, "time_this_iter_s": 30.479620933532715, "time_total_s": 10717.759622335434, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b423488>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4885.550898551941, "timesteps_since_restore": 16540416, "iterations_since_restore": 160, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.91996390282641, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.1279291234028, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.59016088306013, "agent_1": 21.537768240342732}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6952130216365472, "mean_processing_ms": 3.059116493371881, "mean_inference_ms": 1.9570281480187772}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1069, "num_steps_trained": 53666048, "num_steps_sampled": 36653312, "sample_throughput": 12067.091, "train_throughput": 4022.364, "num_weight_syncs": 32514, "num_samples_dropped": 205, "learner_queue": {"size_count": 106912, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.941, "replay_time_ms": 95.454, "update_priorities_time_ms": 50.136, "policy_agent_0": {"added_count": 4125952, "sampled_count": 6177792, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4125952, "sampled_count": 6177792, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.699826717376709, "min_q": 7.638228416442871, "max_q": 7.703084945678711, "mean_td_error": 0.015679599717259407, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.055002212524414, "min_q": 7.900107383728027, "max_q": 8.089420318603516, "mean_td_error": 0.006157103925943375, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 36653312, "episodes_total": 366536, "training_iteration": 352, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-39-13", "timestamp": 1569670753, "time_this_iter_s": 30.511725425720215, "time_total_s": 10748.271347761154, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b440158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4916.062623977661, "timesteps_since_restore": 16647424, "iterations_since_restore": 161, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.79285251056278, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.27990975821513, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 20.592929054946453, "agent_1": 21.686980703268734}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6954507530211111, "mean_processing_ms": 3.0594751457163247, "mean_inference_ms": 1.9565236381331856}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1072, "num_steps_trained": 53823488, "num_steps_sampled": 36761856, "sample_throughput": 7726.559, "train_throughput": 5151.039, "num_weight_syncs": 32726, "num_samples_dropped": 205, "learner_queue": {"size_count": 107528, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.733, "replay_time_ms": 89.278, "update_priorities_time_ms": 48.001, "policy_agent_0": {"added_count": 4152064, "sampled_count": 6216704, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4152064, "sampled_count": 6216704, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.705247402191162, "min_q": 7.61474084854126, "max_q": 7.7758588790893555, "mean_td_error": 0.022155527025461197, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.102356910705566, "min_q": 8.005948066711426, "max_q": 8.161869049072266, "mean_td_error": 0.035180043429136276, "model": {}}}}, "timesteps_this_iter": 108544, "done": false, "timesteps_total": 36761856, "episodes_total": 367624, "training_iteration": 353, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-39-44", "timestamp": 1569670784, "time_this_iter_s": 30.619829893112183, "time_total_s": 10778.891177654266, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bc9d730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4946.682453870773, "timesteps_since_restore": 16755968, "iterations_since_restore": 162, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.03781047195595, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.914113129293945, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.586232197610588, "agent_1": 21.327880931683442}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6956886874808035, "mean_processing_ms": 3.0585799612740976, "mean_inference_ms": 1.9556523310146323}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1075, "num_steps_trained": 53982208, "num_steps_sampled": 36871168, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32939, "num_samples_dropped": 205, "learner_queue": {"size_count": 108147, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.262, "replay_time_ms": 91.45, "update_priorities_time_ms": 42.39, "policy_agent_0": {"added_count": 4180480, "sampled_count": 6257920, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4180480, "sampled_count": 6257920, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.727814674377441, "min_q": 7.605894565582275, "max_q": 7.732015609741211, "mean_td_error": 0.025264671072363853, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.095856666564941, "min_q": 8.06064224243164, "max_q": 8.180788040161133, "mean_td_error": 0.014660261571407318, "model": {}}}}, "timesteps_this_iter": 109312, "done": false, "timesteps_total": 36871168, "episodes_total": 368720, "training_iteration": 354, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-40-15", "timestamp": 1569670815, "time_this_iter_s": 30.533294439315796, "time_total_s": 10809.424472093582, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bc9d1e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4977.215748310089, "timesteps_since_restore": 16865280, "iterations_since_restore": 163, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.90834452795645, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.87231576202368, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.583846227464456, "agent_1": 21.288469534559308}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6955435002953356, "mean_processing_ms": 3.0570993029571056, "mean_inference_ms": 1.9551390137785827}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1078, "num_steps_trained": 54140928, "num_steps_sampled": 36980224, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33152, "num_samples_dropped": 205, "learner_queue": {"size_count": 108767, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.656, "replay_time_ms": 99.852, "update_priorities_time_ms": 57.501, "policy_agent_0": {"added_count": 4210432, "sampled_count": 6298880, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4210432, "sampled_count": 6298880, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.722226142883301, "min_q": 7.618485450744629, "max_q": 7.726118087768555, "mean_td_error": 0.014699233695864677, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.113819122314453, "min_q": 8.006268501281738, "max_q": 8.177014350891113, "mean_td_error": 0.025643721222877502, "model": {}}}}, "timesteps_this_iter": 109056, "done": false, "timesteps_total": 36980224, "episodes_total": 369800, "training_iteration": 355, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-40-45", "timestamp": 1569670845, "time_this_iter_s": 30.59056520462036, "time_total_s": 10840.015037298203, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3c30d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5007.8063135147095, "timesteps_since_restore": 16974336, "iterations_since_restore": 164, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.037023508348625, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.016870849629925, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.642924469575238, "agent_1": 21.373946380054768}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6944062980439891, "mean_processing_ms": 3.0584327794189914, "mean_inference_ms": 1.9557829593416298}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1082, "num_steps_trained": 54302464, "num_steps_sampled": 37087488, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33361, "num_samples_dropped": 205, "learner_queue": {"size_count": 109398, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 25.409, "replay_time_ms": 72.654, "update_priorities_time_ms": 41.911, "policy_agent_0": {"added_count": 4239616, "sampled_count": 6337536, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4239616, "sampled_count": 6337536, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.749154567718506, "min_q": 7.6619672775268555, "max_q": 7.805047512054443, "mean_td_error": 0.027220532298088074, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.072380065917969, "min_q": 8.006174087524414, "max_q": 8.098401069641113, "mean_td_error": 0.026542410254478455, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 37087488, "episodes_total": 370880, "training_iteration": 356, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-41-16", "timestamp": 1569670876, "time_this_iter_s": 30.564505577087402, "time_total_s": 10870.57954287529, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ad7b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5038.370819091797, "timesteps_since_restore": 17081600, "iterations_since_restore": 165, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.424156408587855, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.98263675621382, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 20.628518884624647, "agent_1": 21.354117871589274}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6950407680242708, "mean_processing_ms": 3.057064481147979, "mean_inference_ms": 1.9548575774194008}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1085, "num_steps_trained": 54465280, "num_steps_sampled": 37192192, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33566, "num_samples_dropped": 205, "learner_queue": {"size_count": 110034, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.973, "replay_time_ms": 79.983, "update_priorities_time_ms": 49.689, "policy_agent_0": {"added_count": 4262400, "sampled_count": 6379264, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4262400, "sampled_count": 6379264, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.744595527648926, "min_q": 7.650596618652344, "max_q": 7.824915409088135, "mean_td_error": 0.038343172520399094, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.052804946899414, "min_q": 7.995538234710693, "max_q": 8.148250579833984, "mean_td_error": 0.00619247741997242, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 37192192, "episodes_total": 371920, "training_iteration": 357, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-41-47", "timestamp": 1569670907, "time_this_iter_s": 30.544198513031006, "time_total_s": 10901.123741388321, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b36d048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5068.915017604828, "timesteps_since_restore": 17186304, "iterations_since_restore": 166, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.382912913211854, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.94513651249537, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 20.47169265230491, "agent_1": 21.473443860190546}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6948965113637053, "mean_processing_ms": 3.0563902415675175, "mean_inference_ms": 1.9537570068377117}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1088, "num_steps_trained": 54624000, "num_steps_sampled": 37300992, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33778, "num_samples_dropped": 205, "learner_queue": {"size_count": 110654, "size_mean": 0.06, "size_std": 0.31048349392520047, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.738, "replay_time_ms": 83.362, "update_priorities_time_ms": 45.897, "policy_agent_0": {"added_count": 4292096, "sampled_count": 6416640, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4292096, "sampled_count": 6416640, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7294182777404785, "min_q": 7.6624755859375, "max_q": 7.838662147521973, "mean_td_error": 0.02704242803156376, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.056719779968262, "min_q": 7.9600396156311035, "max_q": 8.196832656860352, "mean_td_error": 0.010772934183478355, "model": {}}}}, "timesteps_this_iter": 108800, "done": false, "timesteps_total": 37300992, "episodes_total": 373008, "training_iteration": 358, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-42-17", "timestamp": 1569670937, "time_this_iter_s": 30.4561026096344, "time_total_s": 10931.579843997955, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f2f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5099.371120214462, "timesteps_since_restore": 17295104, "iterations_since_restore": 167, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.82409851319803, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.80692787252283, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.585987022577125, "agent_1": 21.220940849945798}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6951017065618336, "mean_processing_ms": 3.057040588389016, "mean_inference_ms": 1.954484924062328}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1091, "num_steps_trained": 54785536, "num_steps_sampled": 37408512, "sample_throughput": 7770.94, "train_throughput": 0.0, "num_weight_syncs": 33988, "num_samples_dropped": 205, "learner_queue": {"size_count": 111286, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.363, "replay_time_ms": 79.212, "update_priorities_time_ms": 41.359, "policy_agent_0": {"added_count": 4316160, "sampled_count": 6459392, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4316160, "sampled_count": 6459392, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.715810298919678, "min_q": 7.652140140533447, "max_q": 7.852459907531738, "mean_td_error": -0.0011775549501180649, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.09219741821289, "min_q": 7.991821765899658, "max_q": 8.234814643859863, "mean_td_error": 0.016426006332039833, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 37408512, "episodes_total": 374088, "training_iteration": 359, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-42-48", "timestamp": 1569670968, "time_this_iter_s": 30.59837818145752, "time_total_s": 10962.178222179413, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f87b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5129.96949839592, "timesteps_since_restore": 17402624, "iterations_since_restore": 168, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.58714732504107, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.63985259627096, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.575615532861963, "agent_1": 21.06423706340911}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6946608881555392, "mean_processing_ms": 3.0555798741708897, "mean_inference_ms": 1.953415961178111}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1094, "num_steps_trained": 54945792, "num_steps_sampled": 37515776, "sample_throughput": 9002.086, "train_throughput": 0.0, "num_weight_syncs": 34198, "num_samples_dropped": 205, "learner_queue": {"size_count": 111911, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.113, "replay_time_ms": 96.879, "update_priorities_time_ms": 53.193, "policy_agent_0": {"added_count": 4342272, "sampled_count": 6499072, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4342272, "sampled_count": 6499072, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7107696533203125, "min_q": 7.632399559020996, "max_q": 7.796794414520264, "mean_td_error": 0.0035301856696605682, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.05769157409668, "min_q": 8.037391662597656, "max_q": 8.24952220916748, "mean_td_error": 0.00852101668715477, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 37515776, "episodes_total": 375160, "training_iteration": 360, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-43-18", "timestamp": 1569670998, "time_this_iter_s": 30.652653455734253, "time_total_s": 10992.830875635147, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b103730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5160.622151851654, "timesteps_since_restore": 17509888, "iterations_since_restore": 169, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.24750422866867, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.376973609035815, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.972821477244867, "agent_1": 21.404152131791015}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6950927904125842, "mean_processing_ms": 3.0546164902788178, "mean_inference_ms": 1.9528517301028687}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1098, "num_steps_trained": 55103232, "num_steps_sampled": 37624832, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 34411, "num_samples_dropped": 205, "learner_queue": {"size_count": 112526, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.925, "replay_time_ms": 86.033, "update_priorities_time_ms": 48.23, "policy_agent_0": {"added_count": 4367616, "sampled_count": 6538752, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4367616, "sampled_count": 6538752, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.709329128265381, "min_q": 7.625240325927734, "max_q": 7.766260147094727, "mean_td_error": -0.0007816683501005173, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.001344680786133, "min_q": 7.944730758666992, "max_q": 8.099552154541016, "mean_td_error": 0.017122037708759308, "model": {}}}}, "timesteps_this_iter": 109056, "done": false, "timesteps_total": 37624832, "episodes_total": 376256, "training_iteration": 361, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-43-49", "timestamp": 1569671029, "time_this_iter_s": 30.35834813117981, "time_total_s": 11023.189223766327, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4002f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5190.980499982834, "timesteps_since_restore": 17618944, "iterations_since_restore": 170, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.838765088668254, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.7197998680237, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.584509125135792, "agent_1": 21.135290742888}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6944424745216753, "mean_processing_ms": 3.0557530431066393, "mean_inference_ms": 1.9529063345102866}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1101, "num_steps_trained": 55260416, "num_steps_sampled": 37732096, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 34620, "num_samples_dropped": 205, "learner_queue": {"size_count": 113140, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 42.355, "replay_time_ms": 98.879, "update_priorities_time_ms": 49.326, "policy_agent_0": {"added_count": 4392704, "sampled_count": 6577920, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4392704, "sampled_count": 6577920, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.732074737548828, "min_q": 7.655338764190674, "max_q": 7.837478160858154, "mean_td_error": 0.017521370202302933, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.010698318481445, "min_q": 7.911157131195068, "max_q": 8.074548721313477, "mean_td_error": 0.021467914804816246, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 37732096, "episodes_total": 377328, "training_iteration": 362, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-44-19", "timestamp": 1569671059, "time_this_iter_s": 30.547601222991943, "time_total_s": 11053.736824989319, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae44510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5221.528101205826, "timesteps_since_restore": 17726208, "iterations_since_restore": 171, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.7228689648055, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.65517013381087, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.578398426839506, "agent_1": 21.076771706971464}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6948785132046398, "mean_processing_ms": 3.0551012850587136, "mean_inference_ms": 1.9528167409998933}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1104, "num_steps_trained": 55419392, "num_steps_sampled": 37840384, "sample_throughput": 20211.611, "train_throughput": 0.0, "num_weight_syncs": 34832, "num_samples_dropped": 205, "learner_queue": {"size_count": 113761, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.412, "replay_time_ms": 84.804, "update_priorities_time_ms": 43.325, "policy_agent_0": {"added_count": 4419584, "sampled_count": 6619648, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4419584, "sampled_count": 6619648, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7543721199035645, "min_q": 7.670814037322998, "max_q": 7.844273090362549, "mean_td_error": 0.03883834928274155, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.003745079040527, "min_q": 7.916489124298096, "max_q": 8.027921676635742, "mean_td_error": 0.014557559043169022, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 37840384, "episodes_total": 378408, "training_iteration": 363, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-44-50", "timestamp": 1569671090, "time_this_iter_s": 30.538670778274536, "time_total_s": 11084.275495767593, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ab05d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5252.0667719841, "timesteps_since_restore": 17834496, "iterations_since_restore": 172, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.46190004257293, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.55808517524442, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.774779062752454, "agent_1": 20.78330611249211}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6952386558096832, "mean_processing_ms": 3.05426850454418, "mean_inference_ms": 1.9521630327202197}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1107, "num_steps_trained": 55580160, "num_steps_sampled": 37948160, "sample_throughput": 0.0, "train_throughput": 17539.069, "num_weight_syncs": 35042, "num_samples_dropped": 205, "learner_queue": {"size_count": 114389, "size_mean": 0.34, "size_std": 0.7644605941446557, "size_quantiles": [0.0, 0.0, 0.0, 1.1000000000000014, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 26.387, "replay_time_ms": 78.215, "update_priorities_time_ms": 47.497, "policy_agent_0": {"added_count": 4445952, "sampled_count": 6658048, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4445952, "sampled_count": 6658048, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.75071907043457, "min_q": 7.69555139541626, "max_q": 7.850237846374512, "mean_td_error": 0.01798534207046032, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.98151159286499, "min_q": 7.8950018882751465, "max_q": 8.00225830078125, "mean_td_error": 0.0040811337530612946, "model": {}}}}, "timesteps_this_iter": 107776, "done": false, "timesteps_total": 37948160, "episodes_total": 379488, "training_iteration": 364, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-45-20", "timestamp": 1569671120, "time_this_iter_s": 30.463555574417114, "time_total_s": 11114.73905134201, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a8c950>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5282.5303275585175, "timesteps_since_restore": 17942272, "iterations_since_restore": 173, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.78277995253642, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.60864777681105, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 20.57617077979916, "agent_1": 21.032476997012008}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6948091389872814, "mean_processing_ms": 3.053525868512746, "mean_inference_ms": 1.9516827384890898}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1110, "num_steps_trained": 55740928, "num_steps_sampled": 38054656, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 35251, "num_samples_dropped": 205, "learner_queue": {"size_count": 115017, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.319, "replay_time_ms": 91.288, "update_priorities_time_ms": 54.179, "policy_agent_0": {"added_count": 4475904, "sampled_count": 6699008, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4475904, "sampled_count": 6699008, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7608442306518555, "min_q": 7.686361789703369, "max_q": 7.799114227294922, "mean_td_error": 0.01709907129406929, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.948652744293213, "min_q": 7.862480640411377, "max_q": 7.9576416015625, "mean_td_error": 0.021344443783164024, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 38054656, "episodes_total": 380552, "training_iteration": 365, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-45-51", "timestamp": 1569671151, "time_this_iter_s": 30.543145656585693, "time_total_s": 11145.282196998596, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a8be18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5313.073473215103, "timesteps_since_restore": 18048768, "iterations_since_restore": 174, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.63850439209725, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.5264166895919, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.574678928415, "agent_1": 20.951737761177018}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6945290830531065, "mean_processing_ms": 3.053679990284073, "mean_inference_ms": 1.9511184239635533}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1113, "num_steps_trained": 55901184, "num_steps_sampled": 38162944, "sample_throughput": 10072.877, "train_throughput": 10072.877, "num_weight_syncs": 35462, "num_samples_dropped": 205, "learner_queue": {"size_count": 115643, "size_mean": 0.2, "size_std": 0.447213595499958, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.49, "replay_time_ms": 80.262, "update_priorities_time_ms": 46.772, "policy_agent_0": {"added_count": 4504576, "sampled_count": 6739456, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4504576, "sampled_count": 6739456, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.76022481918335, "min_q": 7.677125930786133, "max_q": 7.834278106689453, "mean_td_error": 0.011392923071980476, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.918878555297852, "min_q": 7.8799824714660645, "max_q": 7.950256824493408, "mean_td_error": 0.028088241815567017, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 38162944, "episodes_total": 381632, "training_iteration": 366, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-46-22", "timestamp": 1569671182, "time_this_iter_s": 30.584678888320923, "time_total_s": 11175.866875886917, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449aaca60>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5343.658152103424, "timesteps_since_restore": 18157056, "iterations_since_restore": 175, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.76832132771589, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.656751064184604, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 20.57335698360027, "agent_1": 21.08339408058444}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6949613499641437, "mean_processing_ms": 3.052876035822017, "mean_inference_ms": 1.9509035915935122}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1117, "num_steps_trained": 56059904, "num_steps_sampled": 38269440, "sample_throughput": 14349.082, "train_throughput": 28698.164, "num_weight_syncs": 35669, "num_samples_dropped": 205, "learner_queue": {"size_count": 116263, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.862, "replay_time_ms": 84.099, "update_priorities_time_ms": 50.244, "policy_agent_0": {"added_count": 4531200, "sampled_count": 6779136, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4531200, "sampled_count": 6779136, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7397356033325195, "min_q": 7.650681018829346, "max_q": 7.772971153259277, "mean_td_error": -0.0019505191594362259, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.905547618865967, "min_q": 7.816832065582275, "max_q": 7.938304424285889, "mean_td_error": 0.018879640847444534, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 38269440, "episodes_total": 382688, "training_iteration": 367, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-46-52", "timestamp": 1569671212, "time_this_iter_s": 30.48141050338745, "time_total_s": 11206.348286390305, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449aaff28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5374.1395626068115, "timesteps_since_restore": 18263552, "iterations_since_restore": 176, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.89918321715641, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.94459115737155, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.559964811197013, "agent_1": 21.384626346174638}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6951902333133171, "mean_processing_ms": 3.052415862026041, "mean_inference_ms": 1.9509268340430324}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1120, "num_steps_trained": 56223232, "num_steps_sampled": 38376192, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 35878, "num_samples_dropped": 205, "learner_queue": {"size_count": 116901, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.46, "replay_time_ms": 94.383, "update_priorities_time_ms": 47.142, "policy_agent_0": {"added_count": 4557568, "sampled_count": 6820608, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4557568, "sampled_count": 6820608, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.737599849700928, "min_q": 7.638277530670166, "max_q": 7.793582439422607, "mean_td_error": 0.010821446776390076, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.908303737640381, "min_q": 7.814958572387695, "max_q": 7.917694091796875, "mean_td_error": 0.004722008481621742, "model": {}}}}, "timesteps_this_iter": 106752, "done": false, "timesteps_total": 38376192, "episodes_total": 383760, "training_iteration": 368, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-47-23", "timestamp": 1569671243, "time_this_iter_s": 30.59104561805725, "time_total_s": 11236.939332008362, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ab05ea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5404.730608224869, "timesteps_since_restore": 18370304, "iterations_since_restore": 177, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.78508521286678, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.10110957658067, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 20.58755336711582, "agent_1": 21.513556209464923}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6949418393200131, "mean_processing_ms": 3.0517007288249536, "mean_inference_ms": 1.9496149164582657}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1123, "num_steps_trained": 56381696, "num_steps_sampled": 38484736, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36090, "num_samples_dropped": 205, "learner_queue": {"size_count": 117520, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 26.821, "replay_time_ms": 88.763, "update_priorities_time_ms": 47.971, "policy_agent_0": {"added_count": 4584960, "sampled_count": 6859776, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4584960, "sampled_count": 6859776, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.725623607635498, "min_q": 7.709349632263184, "max_q": 7.775073528289795, "mean_td_error": 0.020074699074029922, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.938860893249512, "min_q": 7.83449649810791, "max_q": 7.993861198425293, "mean_td_error": 0.021758442744612694, "model": {}}}}, "timesteps_this_iter": 108544, "done": false, "timesteps_total": 38484736, "episodes_total": 384848, "training_iteration": 369, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-47-53", "timestamp": 1569671273, "time_this_iter_s": 30.595897436141968, "time_total_s": 11267.535229444504, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae446a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5435.326505661011, "timesteps_since_restore": 18478848, "iterations_since_restore": 178, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.81552155588081, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.964492011571885, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 20.583409680620978, "agent_1": 21.38108233095098}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6947900915744679, "mean_processing_ms": 3.051658124929222, "mean_inference_ms": 1.9491531413114134}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1126, "num_steps_trained": 56537088, "num_steps_sampled": 38594816, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36305, "num_samples_dropped": 205, "learner_queue": {"size_count": 118127, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.076, "replay_time_ms": 94.347, "update_priorities_time_ms": 52.794, "policy_agent_0": {"added_count": 4612864, "sampled_count": 6900736, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4612864, "sampled_count": 6900736, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.720893383026123, "min_q": 7.694836139678955, "max_q": 7.724556922912598, "mean_td_error": 0.013268711045384407, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.93861722946167, "min_q": 7.8526716232299805, "max_q": 7.976198196411133, "mean_td_error": 0.0006605461239814758, "model": {}}}}, "timesteps_this_iter": 110080, "done": false, "timesteps_total": 38594816, "episodes_total": 385952, "training_iteration": 370, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-48-24", "timestamp": 1569671304, "time_this_iter_s": 30.591190576553345, "time_total_s": 11298.126420021057, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b400d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5465.917696237564, "timesteps_since_restore": 18588928, "iterations_since_restore": 179, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.848486350964606, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.90683516324545, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 20.581779914064168, "agent_1": 21.325055249181364}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6946826100908055, "mean_processing_ms": 3.0517795391375273, "mean_inference_ms": 1.9489804217573825}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1129, "num_steps_trained": 56696320, "num_steps_sampled": 38703616, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36518, "num_samples_dropped": 205, "learner_queue": {"size_count": 118750, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.844, "replay_time_ms": 93.783, "update_priorities_time_ms": 52.731, "policy_agent_0": {"added_count": 4637440, "sampled_count": 6941184, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4637440, "sampled_count": 6941184, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.743745803833008, "min_q": 7.6297807693481445, "max_q": 7.760592460632324, "mean_td_error": 0.04015221446752548, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.966701030731201, "min_q": 7.871072292327881, "max_q": 8.011857986450195, "mean_td_error": 0.025215106084942818, "model": {}}}}, "timesteps_this_iter": 108800, "done": false, "timesteps_total": 38703616, "episodes_total": 387040, "training_iteration": 371, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-48-54", "timestamp": 1569671334, "time_this_iter_s": 30.480883359909058, "time_total_s": 11328.607303380966, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f8400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5496.398579597473, "timesteps_since_restore": 18697728, "iterations_since_restore": 180, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.9567314915306, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.96827937642207, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.58964762014312, "agent_1": 21.378631756279034}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6947291806932092, "mean_processing_ms": 3.050863751184899, "mean_inference_ms": 1.9480753420948047}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1133, "num_steps_trained": 56856576, "num_steps_sampled": 38810880, "sample_throughput": 0.0, "train_throughput": 17352.842, "num_weight_syncs": 36728, "num_samples_dropped": 205, "learner_queue": {"size_count": 119376, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.231, "replay_time_ms": 85.388, "update_priorities_time_ms": 47.177, "policy_agent_0": {"added_count": 4659456, "sampled_count": 6982656, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4659456, "sampled_count": 6982656, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.745796203613281, "min_q": 7.6969451904296875, "max_q": 7.771289825439453, "mean_td_error": 0.007237594574689865, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.965095043182373, "min_q": 7.942938804626465, "max_q": 8.034658432006836, "mean_td_error": 0.001236356794834137, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 38810880, "episodes_total": 388112, "training_iteration": 372, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-49-25", "timestamp": 1569671365, "time_this_iter_s": 30.508881330490112, "time_total_s": 11359.116184711456, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4012f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5526.907460927963, "timesteps_since_restore": 18804992, "iterations_since_restore": 181, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.73626471475928, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.698766868750766, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.57941178788797, "agent_1": 21.1193550808629}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6947827085641843, "mean_processing_ms": 3.0494775314550435, "mean_inference_ms": 1.9478991617711943}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1136, "num_steps_trained": 57020160, "num_steps_sampled": 38917888, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36937, "num_samples_dropped": 205, "learner_queue": {"size_count": 120015, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.183, "replay_time_ms": 107.245, "update_priorities_time_ms": 53.87, "policy_agent_0": {"added_count": 4687616, "sampled_count": 7022592, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4687616, "sampled_count": 7022592, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.725040912628174, "min_q": 7.616661071777344, "max_q": 7.734499931335449, "mean_td_error": 0.02636870928108692, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.972066879272461, "min_q": 7.876378536224365, "max_q": 7.985350131988525, "mean_td_error": 0.02327963523566723, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 38917888, "episodes_total": 389184, "training_iteration": 373, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-49-56", "timestamp": 1569671396, "time_this_iter_s": 30.568888425827026, "time_total_s": 11389.685073137283, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b356158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5557.47634935379, "timesteps_since_restore": 18912000, "iterations_since_restore": 182, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.72069636401073, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.83719138566636, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 20.58516623743306, "agent_1": 21.252025148233383}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.694989852033018, "mean_processing_ms": 3.0497851202536848, "mean_inference_ms": 1.94792036495202}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1139, "num_steps_trained": 57182464, "num_steps_sampled": 39022848, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 37141, "num_samples_dropped": 205, "learner_queue": {"size_count": 120649, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.864, "replay_time_ms": 95.442, "update_priorities_time_ms": 52.072, "policy_agent_0": {"added_count": 4714496, "sampled_count": 7064320, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4714496, "sampled_count": 7064320, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7056097984313965, "min_q": 7.656052589416504, "max_q": 7.729441165924072, "mean_td_error": 0.011102894321084023, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.993842124938965, "min_q": 7.928147792816162, "max_q": 8.007237434387207, "mean_td_error": 0.008084451779723167, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 39022848, "episodes_total": 390232, "training_iteration": 374, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-50-26", "timestamp": 1569671426, "time_this_iter_s": 30.450127840042114, "time_total_s": 11420.135200977325, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ad0d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5587.926477193832, "timesteps_since_restore": 19016960, "iterations_since_restore": 183, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.86176220590574, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.80693113606555, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.5800653965867, "agent_1": 21.22686573947893}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6942940743269402, "mean_processing_ms": 3.0495056344381157, "mean_inference_ms": 1.9471392426815488}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1142, "num_steps_trained": 57344512, "num_steps_sampled": 39130112, "sample_throughput": 0.0, "train_throughput": 13635.336, "num_weight_syncs": 37350, "num_samples_dropped": 205, "learner_queue": {"size_count": 121282, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.663, "replay_time_ms": 67.519, "update_priorities_time_ms": 47.852, "policy_agent_0": {"added_count": 4745728, "sampled_count": 7104512, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4745728, "sampled_count": 7104512, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.712995529174805, "min_q": 7.682947635650635, "max_q": 7.770823955535889, "mean_td_error": 0.010363176465034485, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.985184192657471, "min_q": 7.9440016746521, "max_q": 8.025823593139648, "mean_td_error": 0.03788160905241966, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 39130112, "episodes_total": 391304, "training_iteration": 375, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-50-57", "timestamp": 1569671457, "time_this_iter_s": 30.525628328323364, "time_total_s": 11450.660829305649, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b39c488>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5618.452105522156, "timesteps_since_restore": 19124224, "iterations_since_restore": 184, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.336744547649126, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.95599012345577, "episode_len_mean": 100.0, "episodes_this_iter": 1112, "policy_reward_mean": {"agent_0": 20.634045589273047, "agent_1": 21.321944534182805}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6947271950855547, "mean_processing_ms": 3.0491500909635, "mean_inference_ms": 1.9470178347914822}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1145, "num_steps_trained": 57499904, "num_steps_sampled": 39240704, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 37567, "num_samples_dropped": 205, "learner_queue": {"size_count": 121889, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.248, "replay_time_ms": 100.211, "update_priorities_time_ms": 54.916, "policy_agent_0": {"added_count": 4774400, "sampled_count": 7141376, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4774400, "sampled_count": 7141376, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.709496974945068, "min_q": 7.640270233154297, "max_q": 7.720475673675537, "mean_td_error": 0.019770411774516106, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.984329700469971, "min_q": 7.902012825012207, "max_q": 8.05614948272705, "mean_td_error": 0.017939934507012367, "model": {}}}}, "timesteps_this_iter": 110592, "done": false, "timesteps_total": 39240704, "episodes_total": 392416, "training_iteration": 376, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-51-27", "timestamp": 1569671487, "time_this_iter_s": 30.53466796875, "time_total_s": 11481.195497274399, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bc9d730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5648.986773490906, "timesteps_since_restore": 19234816, "iterations_since_restore": 185, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.75951374263883, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.953685029256114, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 20.593188189972214, "agent_1": 21.36049683928399}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.694592264881372, "mean_processing_ms": 3.048552538242865, "mean_inference_ms": 1.9465020694165631}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1148, "num_steps_trained": 57658880, "num_steps_sampled": 39347968, "sample_throughput": 7204.532, "train_throughput": 7204.532, "num_weight_syncs": 37777, "num_samples_dropped": 205, "learner_queue": {"size_count": 122509, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.167, "replay_time_ms": 80.872, "update_priorities_time_ms": 48.055, "policy_agent_0": {"added_count": 4802048, "sampled_count": 7180032, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4802048, "sampled_count": 7180032, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.702747344970703, "min_q": 7.619060039520264, "max_q": 7.723138332366943, "mean_td_error": 0.038767214864492416, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.972345352172852, "min_q": 7.876936912536621, "max_q": 7.9815802574157715, "mean_td_error": 0.006895577535033226, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 39347968, "episodes_total": 393480, "training_iteration": 377, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-51-58", "timestamp": 1569671518, "time_this_iter_s": 30.557537317276, "time_total_s": 11511.753034591675, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b416048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5679.544310808182, "timesteps_since_restore": 19342080, "iterations_since_restore": 186, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.8755965461574, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.99130527546378, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 20.591019734270517, "agent_1": 21.40028554119334}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6943891056234099, "mean_processing_ms": 3.048125974751489, "mean_inference_ms": 1.9458454774647351}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1152, "num_steps_trained": 57814016, "num_steps_sampled": 39457280, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 37989, "num_samples_dropped": 205, "learner_queue": {"size_count": 123115, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.627, "replay_time_ms": 101.512, "update_priorities_time_ms": 53.646, "policy_agent_0": {"added_count": 4831744, "sampled_count": 7220736, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4831744, "sampled_count": 7220736, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.710154056549072, "min_q": 7.615425109863281, "max_q": 7.737340927124023, "mean_td_error": 0.012303242459893227, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.989119052886963, "min_q": 7.766525745391846, "max_q": 8.042098045349121, "mean_td_error": 0.005402842536568642, "model": {}}}}, "timesteps_this_iter": 109312, "done": false, "timesteps_total": 39457280, "episodes_total": 394568, "training_iteration": 378, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-52-28", "timestamp": 1569671548, "time_this_iter_s": 30.56780171394348, "time_total_s": 11542.320836305618, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4402f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5710.112112522125, "timesteps_since_restore": 19451392, "iterations_since_restore": 187, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.76489811089349, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.76520922145918, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.586801840362682, "agent_1": 21.1784073810966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6944898913395192, "mean_processing_ms": 3.0482653858374795, "mean_inference_ms": 1.9458507920027601}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1155, "num_steps_trained": 57970688, "num_steps_sampled": 39564288, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38199, "num_samples_dropped": 205, "learner_queue": {"size_count": 123728, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 47.578, "replay_time_ms": 91.027, "update_priorities_time_ms": 55.661, "policy_agent_0": {"added_count": 4855040, "sampled_count": 7259904, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4855040, "sampled_count": 7259904, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7103071212768555, "min_q": 7.628290176391602, "max_q": 7.714081287384033, "mean_td_error": 0.019708644598722458, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.025845527648926, "min_q": 7.95355224609375, "max_q": 8.039737701416016, "mean_td_error": 0.016305478289723396, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 39564288, "episodes_total": 395640, "training_iteration": 379, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-52-59", "timestamp": 1569671579, "time_this_iter_s": 30.500444889068604, "time_total_s": 11572.821281194687, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b42c598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5740.612557411194, "timesteps_since_restore": 19558400, "iterations_since_restore": 188, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.014757120815716, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.17285796013401, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 20.6002724088077, "agent_1": 21.572585551326377}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6943172774802483, "mean_processing_ms": 3.0477683671543305, "mean_inference_ms": 1.9453151106228097}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1158, "num_steps_trained": 58135552, "num_steps_sampled": 39669504, "sample_throughput": 8354.407, "train_throughput": 4177.204, "num_weight_syncs": 38405, "num_samples_dropped": 205, "learner_queue": {"size_count": 124373, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.278, "replay_time_ms": 104.526, "update_priorities_time_ms": 49.564, "policy_agent_0": {"added_count": 4882176, "sampled_count": 7301120, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4882176, "sampled_count": 7301120, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.725222110748291, "min_q": 7.669435024261475, "max_q": 7.730729103088379, "mean_td_error": 0.024883940815925598, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.027894020080566, "min_q": 7.926483631134033, "max_q": 8.036542892456055, "mean_td_error": 0.029842283576726913, "model": {}}}}, "timesteps_this_iter": 105216, "done": false, "timesteps_total": 39669504, "episodes_total": 396696, "training_iteration": 380, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-53-29", "timestamp": 1569671609, "time_this_iter_s": 30.486469507217407, "time_total_s": 11603.307750701904, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b437378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5771.099026918411, "timesteps_since_restore": 19663616, "iterations_since_restore": 189, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.820508926515515, "episode_reward_min": 41.09173501334802, "episode_reward_mean": 42.180503683930965, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 20.5950691526536, "agent_1": 21.58543453127742}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6941197687521549, "mean_processing_ms": 3.047489963298371, "mean_inference_ms": 1.9451291238126596}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1161, "num_steps_trained": 58293760, "num_steps_sampled": 39778304, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38617, "num_samples_dropped": 205, "learner_queue": {"size_count": 124989, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.326, "replay_time_ms": 107.696, "update_priorities_time_ms": 55.406, "policy_agent_0": {"added_count": 4909824, "sampled_count": 7340544, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4909824, "sampled_count": 7340544, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.702287673950195, "min_q": 7.6125712394714355, "max_q": 7.746208190917969, "mean_td_error": 0.00785927101969719, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.02366828918457, "min_q": 7.889851093292236, "max_q": 8.032220840454102, "mean_td_error": 0.012724244967103004, "model": {}}}}, "timesteps_this_iter": 108800, "done": false, "timesteps_total": 39778304, "episodes_total": 397784, "training_iteration": 381, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-54-00", "timestamp": 1569671640, "time_this_iter_s": 30.43838667869568, "time_total_s": 11633.7461373806, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b381e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5801.537413597107, "timesteps_since_restore": 19772416, "iterations_since_restore": 190, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.83800548290942, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.91230733428894, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 20.591160859512538, "agent_1": 21.321146474776484}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6945130684453715, "mean_processing_ms": 3.0467471167343785, "mean_inference_ms": 1.9447398349206915}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1164, "num_steps_trained": 58457344, "num_steps_sampled": 39882752, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38821, "num_samples_dropped": 205, "learner_queue": {"size_count": 125628, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.578, "replay_time_ms": 102.717, "update_priorities_time_ms": 49.67, "policy_agent_0": {"added_count": 4934400, "sampled_count": 7383040, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4934400, "sampled_count": 7383040, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.723672866821289, "min_q": 7.616550445556641, "max_q": 7.7352800369262695, "mean_td_error": 0.01047428883612156, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.039165496826172, "min_q": 7.957334041595459, "max_q": 8.077021598815918, "mean_td_error": 0.021611757576465607, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 39882752, "episodes_total": 398832, "training_iteration": 382, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-54-30", "timestamp": 1569671670, "time_this_iter_s": 30.526913166046143, "time_total_s": 11664.273050546646, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b452e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5832.064326763153, "timesteps_since_restore": 19876864, "iterations_since_restore": 191, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.71380945693255, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.276607838489305, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 20.55412817565376, "agent_1": 21.722479662835607}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6938767309325188, "mean_processing_ms": 3.047386778028429, "mean_inference_ms": 1.9452945575802687}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1168, "num_steps_trained": 58620928, "num_steps_sampled": 39989248, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 39029, "num_samples_dropped": 205, "learner_queue": {"size_count": 126267, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.698, "replay_time_ms": 93.789, "update_priorities_time_ms": 63.178, "policy_agent_0": {"added_count": 4961024, "sampled_count": 7423488, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4961024, "sampled_count": 7423488, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.71004581451416, "min_q": 7.603466510772705, "max_q": 7.732294082641602, "mean_td_error": 0.0205631572753191, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.042929649353027, "min_q": 7.9674882888793945, "max_q": 8.31412124633789, "mean_td_error": 0.002749145030975342, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 39989248, "episodes_total": 399888, "training_iteration": 383, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-55-01", "timestamp": 1569671701, "time_this_iter_s": 30.480259895324707, "time_total_s": 11694.75331044197, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d8510>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5862.544586658478, "timesteps_since_restore": 19983360, "iterations_since_restore": 192, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.31524571406878, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.14564147337252, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 20.577994936941433, "agent_1": 21.567646536431177}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6941337762405563, "mean_processing_ms": 3.045873777026827, "mean_inference_ms": 1.944746973014618}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1171, "num_steps_trained": 58784256, "num_steps_sampled": 40096000, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 39238, "num_samples_dropped": 205, "learner_queue": {"size_count": 126905, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 22.721, "replay_time_ms": 82.785, "update_priorities_time_ms": 46.669, "policy_agent_0": {"added_count": 4987392, "sampled_count": 7463168, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 4987392, "sampled_count": 7463168, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.694735050201416, "min_q": 7.621288299560547, "max_q": 7.785604476928711, "mean_td_error": -0.000866299495100975, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.086100578308105, "min_q": 8.000686645507812, "max_q": 8.373812675476074, "mean_td_error": 0.01244099996984005, "model": {}}}}, "timesteps_this_iter": 106752, "done": false, "timesteps_total": 40096000, "episodes_total": 400976, "training_iteration": 384, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-55-32", "timestamp": 1569671732, "time_this_iter_s": 30.56803846359253, "time_total_s": 11725.321348905563, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae1bd90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5893.11262512207, "timesteps_since_restore": 20090112, "iterations_since_restore": 193, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.92576641147688, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.04624768179662, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 20.595499960705425, "agent_1": 21.450747721091272}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6937814231253902, "mean_processing_ms": 3.0475772318136696, "mean_inference_ms": 1.9455797956842416}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1174, "num_steps_trained": 58944000, "num_steps_sampled": 40202240, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 39445, "num_samples_dropped": 205, "learner_queue": {"size_count": 127529, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.899, "replay_time_ms": 103.268, "update_priorities_time_ms": 49.842, "policy_agent_0": {"added_count": 5014528, "sampled_count": 7502592, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5014528, "sampled_count": 7502592, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.718301773071289, "min_q": 7.639193534851074, "max_q": 7.8440775871276855, "mean_td_error": 0.013610243797302246, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.078540802001953, "min_q": 7.9588751792907715, "max_q": 8.427581787109375, "mean_td_error": 0.0053961388766765594, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 40202240, "episodes_total": 402024, "training_iteration": 385, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-56-02", "timestamp": 1569671762, "time_this_iter_s": 30.471704721450806, "time_total_s": 11755.793053627014, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b102400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5923.584329843521, "timesteps_since_restore": 20196352, "iterations_since_restore": 194, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.17740316339241, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.982314400853284, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 20.560069536700976, "agent_1": 21.422244864152393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6939601489820801, "mean_processing_ms": 3.0459030460491703, "mean_inference_ms": 1.9446343859592647}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1177, "num_steps_trained": 59108608, "num_steps_sampled": 40306944, "sample_throughput": 0.0, "train_throughput": 13115.685, "num_weight_syncs": 39649, "num_samples_dropped": 205, "learner_queue": {"size_count": 128172, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.579, "replay_time_ms": 76.082, "update_priorities_time_ms": 47.027, "policy_agent_0": {"added_count": 5041152, "sampled_count": 7550720, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5041152, "sampled_count": 7550720, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.726568222045898, "min_q": 7.675762176513672, "max_q": 7.737029075622559, "mean_td_error": 0.008353158831596375, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.069716453552246, "min_q": 7.966280937194824, "max_q": 8.10665512084961, "mean_td_error": 0.012150861322879791, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 40306944, "episodes_total": 403072, "training_iteration": 386, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-56-33", "timestamp": 1569671793, "time_this_iter_s": 30.579939365386963, "time_total_s": 11786.372992992401, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b102f28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5954.164269208908, "timesteps_since_restore": 20301056, "iterations_since_restore": 195, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.87439461279642, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.99102098694403, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.59317255785771, "agent_1": 21.39784842908639}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6940149044373944, "mean_processing_ms": 3.0468781271955017, "mean_inference_ms": 1.9451300622631598}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1180, "num_steps_trained": 59263744, "num_steps_sampled": 40416768, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 39863, "num_samples_dropped": 205, "learner_queue": {"size_count": 128778, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.458, "replay_time_ms": 80.406, "update_priorities_time_ms": 46.087, "policy_agent_0": {"added_count": 5069568, "sampled_count": 7590912, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5069568, "sampled_count": 7590912, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.72367000579834, "min_q": 7.661364555358887, "max_q": 7.822236061096191, "mean_td_error": 0.015435945242643356, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.050554275512695, "min_q": 8.010149002075195, "max_q": 8.082475662231445, "mean_td_error": 0.0016741268336772919, "model": {}}}}, "timesteps_this_iter": 109824, "done": false, "timesteps_total": 40416768, "episodes_total": 404168, "training_iteration": 387, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-57-03", "timestamp": 1569671823, "time_this_iter_s": 30.550487995147705, "time_total_s": 11816.923480987549, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344aaf6598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5984.714757204056, "timesteps_since_restore": 20410880, "iterations_since_restore": 196, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.873012568809145, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.96956547577728, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 20.611886217695464, "agent_1": 21.357679258081898}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6937534253480309, "mean_processing_ms": 3.0442320776779725, "mean_inference_ms": 1.943621561516094}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1184, "num_steps_trained": 59418368, "num_steps_sampled": 40527360, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 40080, "num_samples_dropped": 205, "learner_queue": {"size_count": 129382, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.359, "replay_time_ms": 86.488, "update_priorities_time_ms": 44.118, "policy_agent_0": {"added_count": 5101056, "sampled_count": 7630080, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5101056, "sampled_count": 7630080, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.710860729217529, "min_q": 7.613760471343994, "max_q": 7.810107231140137, "mean_td_error": -0.0019069164991378784, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.027576446533203, "min_q": 7.920395374298096, "max_q": 8.049243927001953, "mean_td_error": 0.020317383110523224, "model": {}}}}, "timesteps_this_iter": 110592, "done": false, "timesteps_total": 40527360, "episodes_total": 405272, "training_iteration": 388, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-57-34", "timestamp": 1569671854, "time_this_iter_s": 30.476659059524536, "time_total_s": 11847.400140047073, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a94ae8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6015.19141626358, "timesteps_since_restore": 20521472, "iterations_since_restore": 197, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.80613780243642, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.864586877834476, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.585506200851786, "agent_1": 21.279080676982776}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6935581617639512, "mean_processing_ms": 3.0443081327054027, "mean_inference_ms": 1.9433677533742126}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1187, "num_steps_trained": 59575040, "num_steps_sampled": 40636416, "sample_throughput": 11627.504, "train_throughput": 0.0, "num_weight_syncs": 40293, "num_samples_dropped": 205, "learner_queue": {"size_count": 129994, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.07, "replay_time_ms": 103.77, "update_priorities_time_ms": 53.252, "policy_agent_0": {"added_count": 5126656, "sampled_count": 7669248, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5126656, "sampled_count": 7669248, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.711264133453369, "min_q": 7.685299873352051, "max_q": 7.799718856811523, "mean_td_error": 0.028438527137041092, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.014371871948242, "min_q": 7.9029059410095215, "max_q": 8.023290634155273, "mean_td_error": 0.008567657321691513, "model": {}}}}, "timesteps_this_iter": 109056, "done": false, "timesteps_total": 40636416, "episodes_total": 406368, "training_iteration": 389, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-58-04", "timestamp": 1569671884, "time_this_iter_s": 30.49783682823181, "time_total_s": 11877.897976875305, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449ab5048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6045.689253091812, "timesteps_since_restore": 20630528, "iterations_since_restore": 198, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.78977594064861, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.91263776763372, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 20.577302060682914, "agent_1": 21.335335706950893}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6944343035716404, "mean_processing_ms": 3.0451984383811617, "mean_inference_ms": 1.9438883673172616}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1190, "num_steps_trained": 59736832, "num_steps_sampled": 40742656, "sample_throughput": 0.0, "train_throughput": 15887.28, "num_weight_syncs": 40500, "num_samples_dropped": 205, "learner_queue": {"size_count": 130626, "size_mean": 1.0, "size_std": 2.009975124224178, "size_quantiles": [0.0, 0.0, 0.0, 4.100000000000001, 8.0]}, "replay_shard_0": {"add_batch_time_ms": 37.362, "replay_time_ms": 91.797, "update_priorities_time_ms": 57.311, "policy_agent_0": {"added_count": 5152000, "sampled_count": 7709696, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5152000, "sampled_count": 7709696, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.720666885375977, "min_q": 7.666793346405029, "max_q": 7.806715965270996, "mean_td_error": 0.01258622296154499, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 7.991077423095703, "min_q": 7.883987903594971, "max_q": 8.003129959106445, "mean_td_error": 0.02356777898967266, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 40742656, "episodes_total": 407432, "training_iteration": 390, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-58-35", "timestamp": 1569671915, "time_this_iter_s": 30.573766231536865, "time_total_s": 11908.471743106842, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449ab5bf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6076.263019323349, "timesteps_since_restore": 20736768, "iterations_since_restore": 199, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.741902761918176, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.97473500639723, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 20.592781181961904, "agent_1": 21.38195382443541}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6934522843534696, "mean_processing_ms": 3.0450017228054143, "mean_inference_ms": 1.943329909349049}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1193, "num_steps_trained": 59892736, "num_steps_sampled": 40853248, "sample_throughput": 20290.673, "train_throughput": 0.0, "num_weight_syncs": 40716, "num_samples_dropped": 205, "learner_queue": {"size_count": 131235, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.101, "replay_time_ms": 83.573, "update_priorities_time_ms": 43.969, "policy_agent_0": {"added_count": 5178880, "sampled_count": 7747840, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5178880, "sampled_count": 7747840, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.733272552490234, "min_q": 7.701609134674072, "max_q": 7.767545223236084, "mean_td_error": 0.007838979363441467, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.015745162963867, "min_q": 7.901588439941406, "max_q": 8.220014572143555, "mean_td_error": 0.015346666797995567, "model": {}}}}, "timesteps_this_iter": 110592, "done": false, "timesteps_total": 40853248, "episodes_total": 408536, "training_iteration": 391, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-59-06", "timestamp": 1569671946, "time_this_iter_s": 30.598135471343994, "time_total_s": 11939.069878578186, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a5b158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6106.861154794693, "timesteps_since_restore": 20847360, "iterations_since_restore": 200, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.87216303750012, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.144962751429965, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 20.59458898846621, "agent_1": 21.55037376296382}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6934651816102665, "mean_processing_ms": 3.044234723444712, "mean_inference_ms": 1.9422176551241193}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1196, "num_steps_trained": 60051712, "num_steps_sampled": 40961792, "sample_throughput": 20072.942, "train_throughput": 0.0, "num_weight_syncs": 40928, "num_samples_dropped": 205, "learner_queue": {"size_count": 131856, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.25, "replay_time_ms": 102.869, "update_priorities_time_ms": 52.501, "policy_agent_0": {"added_count": 5209600, "sampled_count": 7789312, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5209600, "sampled_count": 7789312, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.758059501647949, "min_q": 7.671001434326172, "max_q": 7.762594223022461, "mean_td_error": 0.006870303303003311, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.023849487304688, "min_q": 7.948824882507324, "max_q": 8.050373077392578, "mean_td_error": 0.008212542161345482, "model": {}}}}, "timesteps_this_iter": 108544, "done": false, "timesteps_total": 40961792, "episodes_total": 409624, "training_iteration": 392, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_11-59-36", "timestamp": 1569671976, "time_this_iter_s": 30.537593603134155, "time_total_s": 11969.60747218132, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae291e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6137.398748397827, "timesteps_since_restore": 20955904, "iterations_since_restore": 201, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.88908738472587, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.29472951392386, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 20.601269322411333, "agent_1": 21.69346019151257}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6940736732377567, "mean_processing_ms": 3.0437124969140887, "mean_inference_ms": 1.9420141732473242}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1199, "num_steps_trained": 60206080, "num_steps_sampled": 41067520, "sample_throughput": 14353.11, "train_throughput": 0.0, "num_weight_syncs": 41134, "num_samples_dropped": 205, "learner_queue": {"size_count": 132459, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.722, "replay_time_ms": 114.37, "update_priorities_time_ms": 62.262, "policy_agent_0": {"added_count": 5238784, "sampled_count": 7827712, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5238784, "sampled_count": 7827712, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.744106292724609, "min_q": 7.740658283233643, "max_q": 7.748629570007324, "mean_td_error": 0.017329763621091843, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.040956497192383, "min_q": 7.985931396484375, "max_q": 8.073630332946777, "mean_td_error": 0.012355038896203041, "model": {}}}}, "timesteps_this_iter": 105728, "done": false, "timesteps_total": 41067520, "episodes_total": 410680, "training_iteration": 393, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-00-07", "timestamp": 1569672007, "time_this_iter_s": 30.62679100036621, "time_total_s": 12000.234263181686, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0ffd08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6168.025539398193, "timesteps_since_restore": 21061632, "iterations_since_restore": 202, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.817304895920785, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.132591774416916, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 20.601975342662286, "agent_1": 21.530616431754684}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6935021125191836, "mean_processing_ms": 3.0446262467753864, "mean_inference_ms": 1.9420069856505746}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1202, "num_steps_trained": 60360704, "num_steps_sampled": 41170688, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 41337, "num_samples_dropped": 205, "learner_queue": {"size_count": 133064, "size_mean": 0.14, "size_std": 0.40049968789001567, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.497, "replay_time_ms": 91.538, "update_priorities_time_ms": 45.335, "policy_agent_0": {"added_count": 5262336, "sampled_count": 7866880, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5262336, "sampled_count": 7866880, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.737855911254883, "min_q": 7.651818752288818, "max_q": 7.742642402648926, "mean_td_error": -0.002496948465704918, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.062776565551758, "min_q": 8.01970386505127, "max_q": 8.071135520935059, "mean_td_error": 0.01327480934560299, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 41170688, "episodes_total": 411712, "training_iteration": 394, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-00-37", "timestamp": 1569672037, "time_this_iter_s": 30.597492933273315, "time_total_s": 12030.83175611496, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae1bbf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6198.623032331467, "timesteps_since_restore": 21164800, "iterations_since_restore": 203, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.63172822909581, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.283950628784496, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.592484843425435, "agent_1": 21.691465785359117}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6933074508673412, "mean_processing_ms": 3.044126083038495, "mean_inference_ms": 1.9417740706974806}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1205, "num_steps_trained": 60517888, "num_steps_sampled": 41281024, "sample_throughput": 6953.566, "train_throughput": 6953.566, "num_weight_syncs": 41552, "num_samples_dropped": 205, "learner_queue": {"size_count": 133678, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.954, "replay_time_ms": 102.327, "update_priorities_time_ms": 52.256, "policy_agent_0": {"added_count": 5294080, "sampled_count": 7905792, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5294080, "sampled_count": 7905792, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.719308853149414, "min_q": 7.635615348815918, "max_q": 7.784830570220947, "mean_td_error": -0.0006910096853971481, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.057127952575684, "min_q": 7.982359409332275, "max_q": 8.069555282592773, "mean_td_error": 0.007587620988488197, "model": {}}}}, "timesteps_this_iter": 110336, "done": false, "timesteps_total": 41281024, "episodes_total": 412808, "training_iteration": 395, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-01-08", "timestamp": 1569672068, "time_this_iter_s": 30.54338002204895, "time_total_s": 12061.375136137009, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ee8c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6229.166412353516, "timesteps_since_restore": 21275136, "iterations_since_restore": 204, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.89382712814568, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.976189194701334, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 20.598692630101457, "agent_1": 21.377496564599955}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6936400080516425, "mean_processing_ms": 3.042043800387773, "mean_inference_ms": 1.9402983213772227}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1209, "num_steps_trained": 60674304, "num_steps_sampled": 41390848, "sample_throughput": 9780.406, "train_throughput": 0.0, "num_weight_syncs": 41767, "num_samples_dropped": 205, "learner_queue": {"size_count": 134288, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.227, "replay_time_ms": 96.131, "update_priorities_time_ms": 58.084, "policy_agent_0": {"added_count": 5321984, "sampled_count": 7943936, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5321984, "sampled_count": 7943936, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.751443386077881, "min_q": 7.724635601043701, "max_q": 7.753958225250244, "mean_td_error": 0.025504114106297493, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.071039199829102, "min_q": 7.9529032707214355, "max_q": 8.143974304199219, "mean_td_error": 0.02219584956765175, "model": {}}}}, "timesteps_this_iter": 109824, "done": false, "timesteps_total": 41390848, "episodes_total": 413912, "training_iteration": 396, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-01-39", "timestamp": 1569672099, "time_this_iter_s": 30.58295226097107, "time_total_s": 12091.95808839798, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b452378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6259.749364614487, "timesteps_since_restore": 21384960, "iterations_since_restore": 205, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.896512743365655, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.250752658174605, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.595722498747115, "agent_1": 21.655030159427536}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6941386020025156, "mean_processing_ms": 3.0433528552693994, "mean_inference_ms": 1.9411064761476615}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1212, "num_steps_trained": 60831232, "num_steps_sampled": 41499648, "sample_throughput": 0.0, "train_throughput": 19227.524, "num_weight_syncs": 41979, "num_samples_dropped": 205, "learner_queue": {"size_count": 134901, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.884, "replay_time_ms": 107.962, "update_priorities_time_ms": 59.174, "policy_agent_0": {"added_count": 5348352, "sampled_count": 7983360, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5348352, "sampled_count": 7983360, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.721325874328613, "min_q": 7.694850444793701, "max_q": 7.753879547119141, "mean_td_error": 0.009217102080583572, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.094831466674805, "min_q": 8.006049156188965, "max_q": 8.105925559997559, "mean_td_error": 0.016558149829506874, "model": {}}}}, "timesteps_this_iter": 108800, "done": false, "timesteps_total": 41499648, "episodes_total": 415008, "training_iteration": 397, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-02-09", "timestamp": 1569672129, "time_this_iter_s": 30.466705083847046, "time_total_s": 12122.424793481827, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d07b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6290.216069698334, "timesteps_since_restore": 21493760, "iterations_since_restore": 206, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.40728863080329, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.07428455636993, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 20.593528616617874, "agent_1": 21.480755939752136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6934450417016027, "mean_processing_ms": 3.0421506764564623, "mean_inference_ms": 1.9400487222130898}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1215, "num_steps_trained": 60992000, "num_steps_sampled": 41605632, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 42186, "num_samples_dropped": 205, "learner_queue": {"size_count": 135529, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.499, "replay_time_ms": 105.74, "update_priorities_time_ms": 48.615, "policy_agent_0": {"added_count": 5374208, "sampled_count": 8027648, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5374208, "sampled_count": 8027648, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.726450443267822, "min_q": 7.659418106079102, "max_q": 7.747064113616943, "mean_td_error": 0.02413146197795868, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.097259521484375, "min_q": 7.973712921142578, "max_q": 8.109659194946289, "mean_td_error": 0.017673416063189507, "model": {}}}}, "timesteps_this_iter": 105984, "done": false, "timesteps_total": 41605632, "episodes_total": 416064, "training_iteration": 398, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-02-40", "timestamp": 1569672160, "time_this_iter_s": 30.538158655166626, "time_total_s": 12152.962952136993, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b42c598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6320.7542283535, "timesteps_since_restore": 21599744, "iterations_since_restore": 207, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.00421905002894, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.15808049205057, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 20.586475590417045, "agent_1": 21.571604901633584}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6934363734500569, "mean_processing_ms": 3.04188979627958, "mean_inference_ms": 1.9396755951815292}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1218, "num_steps_trained": 61149952, "num_steps_sampled": 41715456, "sample_throughput": 18945.376, "train_throughput": 0.0, "num_weight_syncs": 42400, "num_samples_dropped": 205, "learner_queue": {"size_count": 136147, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.291, "replay_time_ms": 90.387, "update_priorities_time_ms": 54.548, "policy_agent_0": {"added_count": 5403392, "sampled_count": 8069632, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5403392, "sampled_count": 8069632, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.720399379730225, "min_q": 7.679124355316162, "max_q": 7.737518310546875, "mean_td_error": 0.00681484118103981, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.089584350585938, "min_q": 8.04810905456543, "max_q": 8.130455017089844, "mean_td_error": 0.019453050568699837, "model": {}}}}, "timesteps_this_iter": 109824, "done": false, "timesteps_total": 41715456, "episodes_total": 417160, "training_iteration": 399, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-03-10", "timestamp": 1569672190, "time_this_iter_s": 30.649622917175293, "time_total_s": 12183.612575054169, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4400d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6351.403851270676, "timesteps_since_restore": 21709568, "iterations_since_restore": 208, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.93111758277691, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.21312110120183, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.598966111753157, "agent_1": 21.614154989448725}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6936683424224211, "mean_processing_ms": 3.042482798061478, "mean_inference_ms": 1.9400215300147126}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1221, "num_steps_trained": 61309952, "num_steps_sampled": 41823232, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 42611, "num_samples_dropped": 205, "learner_queue": {"size_count": 136771, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.67, "replay_time_ms": 68.54, "update_priorities_time_ms": 39.381, "policy_agent_0": {"added_count": 5433344, "sampled_count": 8107776, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5433344, "sampled_count": 8107776, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.723516464233398, "min_q": 7.707113265991211, "max_q": 7.745486259460449, "mean_td_error": 0.025465374812483788, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.084687232971191, "min_q": 8.017677307128906, "max_q": 8.252413749694824, "mean_td_error": 0.003954261541366577, "model": {}}}}, "timesteps_this_iter": 107776, "done": false, "timesteps_total": 41823232, "episodes_total": 418232, "training_iteration": 400, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-03-41", "timestamp": 1569672221, "time_this_iter_s": 30.462388038635254, "time_total_s": 12214.074963092804, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bca6400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6381.866239309311, "timesteps_since_restore": 21817344, "iterations_since_restore": 209, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.06382296186476, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.39438476854271, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.615523702020344, "agent_1": 21.7788610665224}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6941373356378413, "mean_processing_ms": 3.041074647439205, "mean_inference_ms": 1.9394711774896467}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1224, "num_steps_trained": 61470720, "num_steps_sampled": 41930496, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 42820, "num_samples_dropped": 205, "learner_queue": {"size_count": 137399, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.657, "replay_time_ms": 89.613, "update_priorities_time_ms": 47.89, "policy_agent_0": {"added_count": 5456384, "sampled_count": 8148224, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5456384, "sampled_count": 8148224, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.696796417236328, "min_q": 7.678081035614014, "max_q": 7.707895755767822, "mean_td_error": 0.013971082866191864, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.093647956848145, "min_q": 7.984427452087402, "max_q": 8.277307510375977, "mean_td_error": 0.025047341361641884, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 41930496, "episodes_total": 419312, "training_iteration": 401, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-04-11", "timestamp": 1569672251, "time_this_iter_s": 30.48343276977539, "time_total_s": 12244.55839586258, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b39c6a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6412.349672079086, "timesteps_since_restore": 21924608, "iterations_since_restore": 210, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.94052076669212, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.17706507362505, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 20.604065994412494, "agent_1": 21.57299907921261}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6935983902779306, "mean_processing_ms": 3.040185638898267, "mean_inference_ms": 1.9387109718684015}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1228, "num_steps_trained": 61632000, "num_steps_sampled": 42037504, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 43029, "num_samples_dropped": 205, "learner_queue": {"size_count": 138029, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.463, "replay_time_ms": 89.133, "update_priorities_time_ms": 41.896, "policy_agent_0": {"added_count": 5484032, "sampled_count": 8190208, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5484032, "sampled_count": 8190208, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.699761390686035, "min_q": 7.600597381591797, "max_q": 7.7087178230285645, "mean_td_error": 0.003275590017437935, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.102954864501953, "min_q": 7.934882164001465, "max_q": 8.26318073272705, "mean_td_error": 0.013331055641174316, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 42037504, "episodes_total": 420376, "training_iteration": 402, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-04-42", "timestamp": 1569672282, "time_this_iter_s": 30.522843837738037, "time_total_s": 12275.081239700317, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ccea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6442.872515916824, "timesteps_since_restore": 22031616, "iterations_since_restore": 211, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.989306322503126, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 41.79764840167979, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 20.584652348518475, "agent_1": 21.2129960531614}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.693845862738498, "mean_processing_ms": 3.040991262359898, "mean_inference_ms": 1.9389644987701844}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1231, "num_steps_trained": 61789952, "num_steps_sampled": 42144768, "sample_throughput": 7374.803, "train_throughput": 0.0, "num_weight_syncs": 43239, "num_samples_dropped": 205, "learner_queue": {"size_count": 138648, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.935, "replay_time_ms": 96.986, "update_priorities_time_ms": 48.375, "policy_agent_0": {"added_count": 5511168, "sampled_count": 8230912, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5511168, "sampled_count": 8230912, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.7138800621032715, "min_q": 7.6161627769470215, "max_q": 7.726967811584473, "mean_td_error": 0.03660898655653, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.06167984008789, "min_q": 7.895996570587158, "max_q": 8.153261184692383, "mean_td_error": 0.01484982855618, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 42144768, "episodes_total": 421448, "training_iteration": 403, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-05-12", "timestamp": 1569672312, "time_this_iter_s": 30.56273078918457, "time_total_s": 12305.643970489502, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b356048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6473.435246706009, "timesteps_since_restore": 22138880, "iterations_since_restore": 212, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.04206898039401, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.360895264924885, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.60056113060406, "agent_1": 21.76033413432087}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.693875439315194, "mean_processing_ms": 3.0394865266478064, "mean_inference_ms": 1.9385451135611498}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1234, "num_steps_trained": 61950976, "num_steps_sampled": 42253056, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 43451, "num_samples_dropped": 205, "learner_queue": {"size_count": 139275, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 26.789, "replay_time_ms": 80.903, "update_priorities_time_ms": 47.032, "policy_agent_0": {"added_count": 5536000, "sampled_count": 8273152, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5536000, "sampled_count": 8273152, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.730813980102539, "min_q": 7.654268264770508, "max_q": 7.73253870010376, "mean_td_error": 0.022688990458846092, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.054418563842773, "min_q": 7.881961822509766, "max_q": 8.160157203674316, "mean_td_error": 0.010045057162642479, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 42253056, "episodes_total": 422528, "training_iteration": 404, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-05-43", "timestamp": 1569672343, "time_this_iter_s": 30.515526294708252, "time_total_s": 12336.15949678421, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b356e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6503.950773000717, "timesteps_since_restore": 22247168, "iterations_since_restore": 213, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 42.87192796693351, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.120590685311065, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 20.594792566386154, "agent_1": 21.525798118924975}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6934995395486441, "mean_processing_ms": 3.0407094938133614, "mean_inference_ms": 1.938562476065135}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1237, "num_steps_trained": 62108672, "num_steps_sampled": 42360064, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 43660, "num_samples_dropped": 205, "learner_queue": {"size_count": 139891, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.142, "replay_time_ms": 89.003, "update_priorities_time_ms": 51.271, "policy_agent_0": {"added_count": 5560832, "sampled_count": 8310784, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5560832, "sampled_count": 8310784, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.715401649475098, "min_q": 7.705838203430176, "max_q": 7.750396728515625, "mean_td_error": 0.0041402969509363174, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.088322639465332, "min_q": 7.882340431213379, "max_q": 8.18222713470459, "mean_td_error": 0.02193000167608261, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 42360064, "episodes_total": 423608, "training_iteration": 405, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-06-14", "timestamp": 1569672374, "time_this_iter_s": 30.5153751373291, "time_total_s": 12366.67487192154, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b401950>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6534.466148138046, "timesteps_since_restore": 22354176, "iterations_since_restore": 214, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 54.12701962833036, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 44.785020455306906, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 21.924002455376225, "agent_1": 22.861017999930713}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6936140125622591, "mean_processing_ms": 3.0399878371882596, "mean_inference_ms": 1.938210044835662}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1240, "num_steps_trained": 62267904, "num_steps_sampled": 42468096, "sample_throughput": 0.0, "train_throughput": 18295.141, "num_weight_syncs": 43871, "num_samples_dropped": 205, "learner_queue": {"size_count": 140514, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.477, "replay_time_ms": 83.968, "update_priorities_time_ms": 50.514, "policy_agent_0": {"added_count": 5586688, "sampled_count": 8350976, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5586688, "sampled_count": 8350976, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.745151996612549, "min_q": 7.65803861618042, "max_q": 7.92846155166626, "mean_td_error": 0.019660700112581253, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.153953552246094, "min_q": 7.86729621887207, "max_q": 8.468086242675781, "mean_td_error": 0.010847557336091995, "model": {}}}}, "timesteps_this_iter": 108032, "done": false, "timesteps_total": 42468096, "episodes_total": 424672, "training_iteration": 406, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-06-44", "timestamp": 1569672404, "time_this_iter_s": 30.489013195037842, "time_total_s": 12397.163885116577, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b103730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6564.955161333084, "timesteps_since_restore": 22462208, "iterations_since_restore": 215, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 54.13098272562325, "episode_reward_min": 46.70745805620049, "episode_reward_mean": 47.27314858188226, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 24.976774491793208, "agent_1": 22.29637409008903}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6938479242969272, "mean_processing_ms": 3.039380847784099, "mean_inference_ms": 1.937675265279792}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1243, "num_steps_trained": 62423552, "num_steps_sampled": 42577152, "sample_throughput": 15897.63, "train_throughput": 7948.815, "num_weight_syncs": 44083, "num_samples_dropped": 205, "learner_queue": {"size_count": 141121, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.94, "replay_time_ms": 96.592, "update_priorities_time_ms": 51.09, "policy_agent_0": {"added_count": 5617152, "sampled_count": 8389376, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5617152, "sampled_count": 8389376, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 7.949299335479736, "min_q": 7.660614490509033, "max_q": 8.192730903625488, "mean_td_error": 0.01840725727379322, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.24728775024414, "min_q": 7.877049446105957, "max_q": 9.078634262084961, "mean_td_error": 0.029404398053884506, "model": {}}}}, "timesteps_this_iter": 109056, "done": false, "timesteps_total": 42577152, "episodes_total": 425776, "training_iteration": 407, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-07-15", "timestamp": 1569672435, "time_this_iter_s": 30.528844118118286, "time_total_s": 12427.692729234695, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4001e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6595.484005451202, "timesteps_since_restore": 22571264, "iterations_since_restore": 216, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.12031248716246, "episode_reward_min": 46.66557025461116, "episode_reward_mean": 46.84953812190645, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 25.130697050783994, "agent_1": 21.718841071122412}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6939518714282709, "mean_processing_ms": 3.039402558840254, "mean_inference_ms": 1.9371976623834741}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1247, "num_steps_trained": 62581248, "num_steps_sampled": 42684928, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 44293, "num_samples_dropped": 205, "learner_queue": {"size_count": 141738, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.784, "replay_time_ms": 74.077, "update_priorities_time_ms": 46.008, "policy_agent_0": {"added_count": 5640960, "sampled_count": 8430848, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5640960, "sampled_count": 8430848, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.384522438049316, "min_q": 7.938336372375488, "max_q": 8.4541654586792, "mean_td_error": -0.0016002003103494644, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.338224411010742, "min_q": 7.962954044342041, "max_q": 9.498885154724121, "mean_td_error": 0.005176989361643791, "model": {}}}}, "timesteps_this_iter": 107776, "done": false, "timesteps_total": 42684928, "episodes_total": 426856, "training_iteration": 408, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-07-45", "timestamp": 1569672465, "time_this_iter_s": 30.46356749534607, "time_total_s": 12458.156296730042, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae448c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6625.9475729465485, "timesteps_since_restore": 22679040, "iterations_since_restore": 217, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.20113448393682, "episode_reward_min": 46.6651520110201, "episode_reward_mean": 46.84597354363617, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 25.134296975720034, "agent_1": 21.711676567916093}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6937124004725599, "mean_processing_ms": 3.039785106574316, "mean_inference_ms": 1.9372516333265073}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1250, "num_steps_trained": 62746368, "num_steps_sampled": 42790400, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 44500, "num_samples_dropped": 205, "learner_queue": {"size_count": 142382, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.094, "replay_time_ms": 91.133, "update_priorities_time_ms": 49.328, "policy_agent_0": {"added_count": 5671936, "sampled_count": 8473088, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5671936, "sampled_count": 8473088, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.668008804321289, "min_q": 8.549944877624512, "max_q": 8.7122802734375, "mean_td_error": 0.020462971180677414, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.203591346740723, "min_q": 7.914534568786621, "max_q": 9.340496063232422, "mean_td_error": 0.0273326076567173, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 42790400, "episodes_total": 427904, "training_iteration": 409, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-08-16", "timestamp": 1569672496, "time_this_iter_s": 30.614917993545532, "time_total_s": 12488.771214723587, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344aacb9d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6656.562490940094, "timesteps_since_restore": 22784512, "iterations_since_restore": 218, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 46.96185920185621, "episode_reward_min": 42.49075123281007, "episode_reward_mean": 42.80238270913394, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 20.817519735731942, "agent_1": 21.98486297340201}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6941916688325189, "mean_processing_ms": 3.0390587240886218, "mean_inference_ms": 1.9370019425764384}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1253, "num_steps_trained": 62904576, "num_steps_sampled": 42897152, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 44708, "num_samples_dropped": 205, "learner_queue": {"size_count": 143000, "size_mean": 0.22, "size_std": 0.54, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.877, "replay_time_ms": 98.988, "update_priorities_time_ms": 57.065, "policy_agent_0": {"added_count": 5699072, "sampled_count": 8513024, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5699072, "sampled_count": 8513024, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.680537223815918, "min_q": 8.304045677185059, "max_q": 8.788101196289062, "mean_td_error": 0.02880651131272316, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.193939208984375, "min_q": 7.9702982902526855, "max_q": 8.222723007202148, "mean_td_error": 0.012593327090144157, "model": {}}}}, "timesteps_this_iter": 106752, "done": false, "timesteps_total": 42897152, "episodes_total": 428968, "training_iteration": 410, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-08-46", "timestamp": 1569672526, "time_this_iter_s": 30.572651386260986, "time_total_s": 12519.343866109848, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a8bd90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6687.135142326355, "timesteps_since_restore": 22891264, "iterations_since_restore": 219, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.57839040630034, "episode_reward_min": 42.50554710170052, "episode_reward_mean": 43.65028048639708, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 21.566150812205883, "agent_1": 22.084129674191203}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6942436273606937, "mean_processing_ms": 3.0389725051331897, "mean_inference_ms": 1.9371340863104964}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1256, "num_steps_trained": 63069184, "num_steps_sampled": 43002624, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 44914, "num_samples_dropped": 205, "learner_queue": {"size_count": 143643, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.496, "replay_time_ms": 79.32, "update_priorities_time_ms": 46.306, "policy_agent_0": {"added_count": 5724672, "sampled_count": 8554752, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5724672, "sampled_count": 8554752, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.552756309509277, "min_q": 8.225488662719727, "max_q": 8.896536827087402, "mean_td_error": 0.02146630920469761, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.197854042053223, "min_q": 8.076457977294922, "max_q": 8.212491989135742, "mean_td_error": 0.02169240638613701, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 43002624, "episodes_total": 430024, "training_iteration": 411, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-09-17", "timestamp": 1569672557, "time_this_iter_s": 30.503987550735474, "time_total_s": 12549.847853660583, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a650d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6717.63912987709, "timesteps_since_restore": 22996736, "iterations_since_restore": 220, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.096747829452205, "episode_reward_min": 44.189263297747296, "episode_reward_mean": 44.3060027769855, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 22.173125110693363, "agent_1": 22.132877666292142}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6942156056165736, "mean_processing_ms": 3.0385856229586063, "mean_inference_ms": 1.9370159187950344}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1259, "num_steps_trained": 63228672, "num_steps_sampled": 43109888, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 45124, "num_samples_dropped": 205, "learner_queue": {"size_count": 144266, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.456, "replay_time_ms": 100.125, "update_priorities_time_ms": 49.689, "policy_agent_0": {"added_count": 5751808, "sampled_count": 8593152, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5751808, "sampled_count": 8593152, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.362125396728516, "min_q": 8.168634414672852, "max_q": 8.685550689697266, "mean_td_error": 0.002243960276246071, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.231189727783203, "min_q": 8.125999450683594, "max_q": 8.316089630126953, "mean_td_error": 0.012411929666996002, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 43109888, "episodes_total": 431096, "training_iteration": 412, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-09-47", "timestamp": 1569672587, "time_this_iter_s": 30.570313692092896, "time_total_s": 12580.418167352676, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a65c80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6748.209443569183, "timesteps_since_restore": 23104000, "iterations_since_restore": 221, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.06232324078599, "episode_reward_min": 44.1892632977473, "episode_reward_mean": 44.784380736395114, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 22.060824092799063, "agent_1": 22.723556643596023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.69363599708041, "mean_processing_ms": 3.0391345770298037, "mean_inference_ms": 1.9368075782299112}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1263, "num_steps_trained": 63386368, "num_steps_sampled": 43219200, "sample_throughput": 0.0, "train_throughput": 20896.83, "num_weight_syncs": 45337, "num_samples_dropped": 205, "learner_queue": {"size_count": 144882, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.709, "replay_time_ms": 83.246, "update_priorities_time_ms": 45.227, "policy_agent_0": {"added_count": 5775872, "sampled_count": 8633600, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5775872, "sampled_count": 8633600, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.371668815612793, "min_q": 8.179227828979492, "max_q": 8.396944046020508, "mean_td_error": 1.5426427125930786e-05, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.257583618164062, "min_q": 8.11772632598877, "max_q": 8.426013946533203, "mean_td_error": 0.017537137493491173, "model": {}}}}, "timesteps_this_iter": 109312, "done": false, "timesteps_total": 43219200, "episodes_total": 432192, "training_iteration": 413, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-10-18", "timestamp": 1569672618, "time_this_iter_s": 30.550864458084106, "time_total_s": 12610.96903181076, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a641e0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6778.7603080272675, "timesteps_since_restore": 23213312, "iterations_since_restore": 222, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 46.04521730554107, "episode_reward_min": 44.172233498490606, "episode_reward_mean": 44.33646615722749, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 22.136369140480202, "agent_1": 22.20009701674729}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6942195101228045, "mean_processing_ms": 3.0379579539164916, "mean_inference_ms": 1.9367387099278666}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1266, "num_steps_trained": 63549952, "num_steps_sampled": 43324672, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 45543, "num_samples_dropped": 205, "learner_queue": {"size_count": 145521, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.473, "replay_time_ms": 97.604, "update_priorities_time_ms": 55.713, "policy_agent_0": {"added_count": 5802496, "sampled_count": 8674304, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5802496, "sampled_count": 8674304, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.398303985595703, "min_q": 8.29826831817627, "max_q": 8.499177932739258, "mean_td_error": 0.03319767117500305, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.291431427001953, "min_q": 8.123851776123047, "max_q": 8.642966270446777, "mean_td_error": 0.015450391918420792, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 43324672, "episodes_total": 433256, "training_iteration": 414, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-10-49", "timestamp": 1569672649, "time_this_iter_s": 30.533360242843628, "time_total_s": 12641.502392053604, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a64d90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6809.293668270111, "timesteps_since_restore": 23318784, "iterations_since_restore": 223, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.783096632873175, "episode_reward_min": 44.1892632977473, "episode_reward_mean": 44.46071746819652, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 22.145737500327677, "agent_1": 22.314979967868823}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6938421424489802, "mean_processing_ms": 3.0388454875837896, "mean_inference_ms": 1.936564167309413}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1269, "num_steps_trained": 63708672, "num_steps_sampled": 43431936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 45754, "num_samples_dropped": 205, "learner_queue": {"size_count": 146141, "size_mean": 0.1, "size_std": 0.36055512754639896, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.711, "replay_time_ms": 107.122, "update_priorities_time_ms": 48.39, "policy_agent_0": {"added_count": 5827072, "sampled_count": 8713728, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5827072, "sampled_count": 8713728, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.379812240600586, "min_q": 8.278177261352539, "max_q": 8.4833984375, "mean_td_error": 0.009930931031703949, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.316183090209961, "min_q": 8.268059730529785, "max_q": 8.714483261108398, "mean_td_error": 0.020809220150113106, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 43431936, "episodes_total": 434320, "training_iteration": 415, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-11-19", "timestamp": 1569672679, "time_this_iter_s": 30.503109455108643, "time_total_s": 12672.005501508713, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a7d2f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6839.79677772522, "timesteps_since_restore": 23426048, "iterations_since_restore": 224, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 46.01530202554464, "episode_reward_min": 44.1892632977473, "episode_reward_mean": 44.796140065337376, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 22.116276990838692, "agent_1": 22.67986307449861}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6938321978528025, "mean_processing_ms": 3.0373199503681314, "mean_inference_ms": 1.9359763815394428}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1272, "num_steps_trained": 63866368, "num_steps_sampled": 43540224, "sample_throughput": 0.0, "train_throughput": 13970.281, "num_weight_syncs": 45965, "num_samples_dropped": 205, "learner_queue": {"size_count": 146758, "size_mean": 0.38, "size_std": 0.8219489035213806, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 4.0]}, "replay_shard_0": {"add_batch_time_ms": 36.439, "replay_time_ms": 90.457, "update_priorities_time_ms": 58.933, "policy_agent_0": {"added_count": 5853696, "sampled_count": 8750336, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5853696, "sampled_count": 8750336, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.372695922851562, "min_q": 8.329435348510742, "max_q": 8.392267227172852, "mean_td_error": 0.026537690311670303, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.340456008911133, "min_q": 8.133735656738281, "max_q": 8.560830116271973, "mean_td_error": 0.02808568812906742, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 43540224, "episodes_total": 435400, "training_iteration": 416, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-11-50", "timestamp": 1569672710, "time_this_iter_s": 30.52648091316223, "time_total_s": 12702.531982421875, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a65158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6870.323258638382, "timesteps_since_restore": 23534336, "iterations_since_restore": 225, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.92638629724378, "episode_reward_min": 44.1892632977473, "episode_reward_mean": 44.98149308484969, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 22.094779665725603, "agent_1": 22.886713419124}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6935997831974271, "mean_processing_ms": 3.037861486800484, "mean_inference_ms": 1.9354384623953185}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1275, "num_steps_trained": 64024576, "num_steps_sampled": 43647744, "sample_throughput": 0.0, "train_throughput": 33558.627, "num_weight_syncs": 46174, "num_samples_dropped": 205, "learner_queue": {"size_count": 147375, "size_mean": 0.2, "size_std": 0.447213595499958, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.147, "replay_time_ms": 114.209, "update_priorities_time_ms": 53.495, "policy_agent_0": {"added_count": 5878272, "sampled_count": 8790272, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5878272, "sampled_count": 8790272, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.330106735229492, "min_q": 8.21997356414795, "max_q": 8.354839324951172, "mean_td_error": 0.006927605718374252, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.433382987976074, "min_q": 8.165372848510742, "max_q": 8.612971305847168, "mean_td_error": 0.013638516888022423, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 43647744, "episodes_total": 436480, "training_iteration": 417, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-12-20", "timestamp": 1569672740, "time_this_iter_s": 30.491937398910522, "time_total_s": 12733.023919820786, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a8b8c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6900.8151960372925, "timesteps_since_restore": 23641856, "iterations_since_restore": 226, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.5616074175738, "episode_reward_min": 42.60060198416996, "episode_reward_mean": 44.26401465349049, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 22.118762691429687, "agent_1": 22.1452519620608}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6936622504957375, "mean_processing_ms": 3.0373190174724907, "mean_inference_ms": 1.935087990062495}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1278, "num_steps_trained": 64181760, "num_steps_sampled": 43757312, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 46388, "num_samples_dropped": 205, "learner_queue": {"size_count": 147989, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.111, "replay_time_ms": 81.524, "update_priorities_time_ms": 45.968, "policy_agent_0": {"added_count": 5908224, "sampled_count": 8831232, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5908224, "sampled_count": 8831232, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.345916748046875, "min_q": 8.285892486572266, "max_q": 8.382190704345703, "mean_td_error": 0.022457854822278023, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.454412460327148, "min_q": 8.28348445892334, "max_q": 8.772936820983887, "mean_td_error": 0.024362750351428986, "model": {}}}}, "timesteps_this_iter": 109568, "done": false, "timesteps_total": 43757312, "episodes_total": 437584, "training_iteration": 418, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-12-51", "timestamp": 1569672771, "time_this_iter_s": 30.454181671142578, "time_total_s": 12763.478101491928, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344aacb268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6931.269377708435, "timesteps_since_restore": 23751424, "iterations_since_restore": 227, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.75737201796857, "episode_reward_min": 42.50554710170052, "episode_reward_mean": 43.9760239393601, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 22.093128300246125, "agent_1": 21.882895639113947}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6936627634851305, "mean_processing_ms": 3.037936023142145, "mean_inference_ms": 1.9352195148948441}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1282, "num_steps_trained": 64339968, "num_steps_sampled": 43866624, "sample_throughput": 0.0, "train_throughput": 19957.656, "num_weight_syncs": 46602, "num_samples_dropped": 205, "learner_queue": {"size_count": 148607, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "replay_shard_0": {"add_batch_time_ms": 32.169, "replay_time_ms": 74.837, "update_priorities_time_ms": 44.893, "policy_agent_0": {"added_count": 5935104, "sampled_count": 8873728, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5935104, "sampled_count": 8873728, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.31362533569336, "min_q": 8.219913482666016, "max_q": 8.387613296508789, "mean_td_error": 0.028947316110134125, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.35744857788086, "min_q": 8.111851692199707, "max_q": 8.651142120361328, "mean_td_error": 0.019894413650035858, "model": {}}}}, "timesteps_this_iter": 109312, "done": false, "timesteps_total": 43866624, "episodes_total": 438664, "training_iteration": 419, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-13-21", "timestamp": 1569672801, "time_this_iter_s": 30.501477241516113, "time_total_s": 12793.979578733444, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449aaca60>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6961.770854949951, "timesteps_since_restore": 23860736, "iterations_since_restore": 228, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.049124827928566, "episode_reward_min": 43.99602384070984, "episode_reward_mean": 45.077474202936166, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 23.051674361793193, "agent_1": 22.025799841142934}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6937068013197828, "mean_processing_ms": 3.037268790230845, "mean_inference_ms": 1.9347575957513248}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1285, "num_steps_trained": 64499712, "num_steps_sampled": 43973120, "sample_throughput": 11636.387, "train_throughput": 5818.194, "num_weight_syncs": 46810, "num_samples_dropped": 205, "learner_queue": {"size_count": 149232, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.433, "replay_time_ms": 103.232, "update_priorities_time_ms": 56.926, "policy_agent_0": {"added_count": 5964800, "sampled_count": 8913920, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5964800, "sampled_count": 8913920, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.296405792236328, "min_q": 8.167573928833008, "max_q": 8.448920249938965, "mean_td_error": 0.00026392191648483276, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.313966751098633, "min_q": 8.059516906738281, "max_q": 8.686545372009277, "mean_td_error": 0.011383973062038422, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 43973120, "episodes_total": 439728, "training_iteration": 420, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-13-52", "timestamp": 1569672832, "time_this_iter_s": 30.580941200256348, "time_total_s": 12824.5605199337, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4000d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6992.3517961502075, "timesteps_since_restore": 23967232, "iterations_since_restore": 229, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.83532476873444, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 44.39881486352031, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 22.304802405231783, "agent_1": 22.09401245828848}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6934784058214116, "mean_processing_ms": 3.0366074919489905, "mean_inference_ms": 1.9342770121753632}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1288, "num_steps_trained": 64661504, "num_steps_sampled": 44080896, "sample_throughput": 7270.142, "train_throughput": 7270.142, "num_weight_syncs": 47021, "num_samples_dropped": 205, "learner_queue": {"size_count": 149863, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.774, "replay_time_ms": 82.342, "update_priorities_time_ms": 52.091, "policy_agent_0": {"added_count": 5992448, "sampled_count": 8956160, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 5992448, "sampled_count": 8956160, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.340898513793945, "min_q": 8.191003799438477, "max_q": 8.63062858581543, "mean_td_error": 0.03139631077647209, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.3040189743042, "min_q": 8.010987281799316, "max_q": 8.57850170135498, "mean_td_error": 0.031861141324043274, "model": {}}}}, "timesteps_this_iter": 107776, "done": false, "timesteps_total": 44080896, "episodes_total": 440816, "training_iteration": 421, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-14-23", "timestamp": 1569672863, "time_this_iter_s": 30.594352960586548, "time_total_s": 12855.154872894287, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f8378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7022.946149110794, "timesteps_since_restore": 24075008, "iterations_since_restore": 230, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.80215182082515, "episode_reward_min": 43.1867390719684, "episode_reward_mean": 44.33688036642709, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 22.193962244714033, "agent_1": 22.142918121713052}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.693603009304416, "mean_processing_ms": 3.0362911719185495, "mean_inference_ms": 1.9339227649099398}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1291, "num_steps_trained": 64819968, "num_steps_sampled": 44188416, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 47231, "num_samples_dropped": 205, "learner_queue": {"size_count": 150482, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.881, "replay_time_ms": 90.299, "update_priorities_time_ms": 54.102, "policy_agent_0": {"added_count": 6016768, "sampled_count": 8995328, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6016768, "sampled_count": 8995328, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.332033157348633, "min_q": 8.164628028869629, "max_q": 8.722411155700684, "mean_td_error": 0.021763384342193604, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.287643432617188, "min_q": 8.190997123718262, "max_q": 8.301653861999512, "mean_td_error": 0.014780854806303978, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 44188416, "episodes_total": 441880, "training_iteration": 422, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-14-53", "timestamp": 1569672893, "time_this_iter_s": 30.46575665473938, "time_total_s": 12885.620629549026, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b401158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7053.411905765533, "timesteps_since_restore": 24182528, "iterations_since_restore": 231, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.53383354679276, "episode_reward_min": 42.50554710170052, "episode_reward_mean": 43.80101589525138, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 21.875198588921354, "agent_1": 21.925817306330035}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.693866121694163, "mean_processing_ms": 3.035786443771132, "mean_inference_ms": 1.9334739296319345}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1294, "num_steps_trained": 64979712, "num_steps_sampled": 44295424, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 47439, "num_samples_dropped": 205, "learner_queue": {"size_count": 151106, "size_mean": 0.16, "size_std": 0.41761226035642207, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.703, "replay_time_ms": 98.847, "update_priorities_time_ms": 51.943, "policy_agent_0": {"added_count": 6043904, "sampled_count": 9033728, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6043904, "sampled_count": 9033728, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.26577377319336, "min_q": 8.00954818725586, "max_q": 8.534582138061523, "mean_td_error": 0.024799445644021034, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.267515182495117, "min_q": 8.0707368850708, "max_q": 8.447166442871094, "mean_td_error": 0.028663059696555138, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 44295424, "episodes_total": 442960, "training_iteration": 423, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-15-24", "timestamp": 1569672924, "time_this_iter_s": 30.55476427078247, "time_total_s": 12916.175393819809, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b356598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7083.966670036316, "timesteps_since_restore": 24289536, "iterations_since_restore": 232, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.89084332586747, "episode_reward_min": 42.50554710170053, "episode_reward_mean": 44.5080601015769, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 22.397311137012846, "agent_1": 22.110748964564007}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6938071099607941, "mean_processing_ms": 3.0359662200951085, "mean_inference_ms": 1.9336670937164937}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1297, "num_steps_trained": 65136128, "num_steps_sampled": 44402176, "sample_throughput": 0.0, "train_throughput": 9696.236, "num_weight_syncs": 47649, "num_samples_dropped": 205, "learner_queue": {"size_count": 151717, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.642, "replay_time_ms": 95.02, "update_priorities_time_ms": 49.969, "policy_agent_0": {"added_count": 6067456, "sampled_count": 9072640, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6067456, "sampled_count": 9072640, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.277667999267578, "min_q": 8.086197853088379, "max_q": 8.514439582824707, "mean_td_error": 0.022454624995589256, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.25473690032959, "min_q": 8.02105712890625, "max_q": 8.418181419372559, "mean_td_error": 0.015552066266536713, "model": {}}}}, "timesteps_this_iter": 106752, "done": false, "timesteps_total": 44402176, "episodes_total": 444024, "training_iteration": 424, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-15-54", "timestamp": 1569672954, "time_this_iter_s": 30.47022819519043, "time_total_s": 12946.645622015, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3afb70>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7114.436898231506, "timesteps_since_restore": 24396288, "iterations_since_restore": 233, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.464209439283415, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 45.249451684768204, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 22.58671354444602, "agent_1": 22.662738140322187}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6939303544165651, "mean_processing_ms": 3.035901336590588, "mean_inference_ms": 1.933354669241299}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1301, "num_steps_trained": 65293312, "num_steps_sampled": 44510720, "sample_throughput": 0.0, "train_throughput": 38281.613, "num_weight_syncs": 47860, "num_samples_dropped": 205, "learner_queue": {"size_count": 152331, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.891, "replay_time_ms": 79.845, "update_priorities_time_ms": 44.4, "policy_agent_0": {"added_count": 6095616, "sampled_count": 9111552, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6095616, "sampled_count": 9111552, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.332511901855469, "min_q": 8.100192070007324, "max_q": 8.590970993041992, "mean_td_error": 0.003111196681857109, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.27193832397461, "min_q": 7.9969401359558105, "max_q": 8.473821640014648, "mean_td_error": 0.005141999572515488, "model": {}}}}, "timesteps_this_iter": 108544, "done": false, "timesteps_total": 44510720, "episodes_total": 445112, "training_iteration": 425, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-16-25", "timestamp": 1569672985, "time_this_iter_s": 30.533226490020752, "time_total_s": 12977.17884850502, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3cce18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7144.970124721527, "timesteps_since_restore": 24504832, "iterations_since_restore": 234, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.55329411683187, "episode_reward_min": 47.22448494406566, "episode_reward_mean": 47.33951284044502, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 23.67234913066422, "agent_1": 23.667163709780926}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6935131987077794, "mean_processing_ms": 3.034914495011004, "mean_inference_ms": 1.9327130178943492}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1304, "num_steps_trained": 65452288, "num_steps_sampled": 44619264, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 48072, "num_samples_dropped": 205, "learner_queue": {"size_count": 152952, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.942, "replay_time_ms": 94.343, "update_priorities_time_ms": 47.764, "policy_agent_0": {"added_count": 6124800, "sampled_count": 9151232, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6124800, "sampled_count": 9151232, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.524007797241211, "min_q": 8.189724922180176, "max_q": 8.666136741638184, "mean_td_error": 0.007646914571523666, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.408958435058594, "min_q": 8.063652038574219, "max_q": 8.603544235229492, "mean_td_error": -0.011346545070409775, "model": {}}}}, "timesteps_this_iter": 108544, "done": false, "timesteps_total": 44619264, "episodes_total": 446200, "training_iteration": 426, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-16-55", "timestamp": 1569673015, "time_this_iter_s": 30.494386434555054, "time_total_s": 13007.673234939575, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b39c0d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7175.464511156082, "timesteps_since_restore": 24613376, "iterations_since_restore": 235, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.55912948582098, "episode_reward_min": 47.22720008578375, "episode_reward_mean": 47.342488082167876, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 23.678694732147775, "agent_1": 23.66379335002023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6936474673372218, "mean_processing_ms": 3.035704066717657, "mean_inference_ms": 1.932818423063149}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1307, "num_steps_trained": 65612288, "num_steps_sampled": 44727040, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 48282, "num_samples_dropped": 205, "learner_queue": {"size_count": 153577, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.29, "replay_time_ms": 80.289, "update_priorities_time_ms": 48.415, "policy_agent_0": {"added_count": 6152448, "sampled_count": 9192704, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6152448, "sampled_count": 9192704, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.66514778137207, "min_q": 8.338324546813965, "max_q": 8.74139404296875, "mean_td_error": 0.009467337280511856, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.555933952331543, "min_q": 8.288522720336914, "max_q": 8.609729766845703, "mean_td_error": 0.04535356163978577, "model": {}}}}, "timesteps_this_iter": 107776, "done": false, "timesteps_total": 44727040, "episodes_total": 447272, "training_iteration": 427, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-17-26", "timestamp": 1569673046, "time_this_iter_s": 30.598228931427002, "time_total_s": 13038.271463871002, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4239d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7206.062740087509, "timesteps_since_restore": 24721152, "iterations_since_restore": 236, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.64705681481435, "episode_reward_min": 47.22720008578375, "episode_reward_mean": 47.34357478123629, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 23.675702441061347, "agent_1": 23.667872340175077}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6936522063475834, "mean_processing_ms": 3.0357503586179213, "mean_inference_ms": 1.932447956753261}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1310, "num_steps_trained": 65768704, "num_steps_sampled": 44836608, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 48496, "num_samples_dropped": 205, "learner_queue": {"size_count": 154188, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.737, "replay_time_ms": 96.781, "update_priorities_time_ms": 53.358, "policy_agent_0": {"added_count": 6184192, "sampled_count": 9231360, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6184192, "sampled_count": 9231360, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.730242729187012, "min_q": 8.584704399108887, "max_q": 8.782086372375488, "mean_td_error": 0.001913849264383316, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.626489639282227, "min_q": 8.428872108459473, "max_q": 8.632635116577148, "mean_td_error": 0.017407380044460297, "model": {}}}}, "timesteps_this_iter": 109568, "done": false, "timesteps_total": 44836608, "episodes_total": 448368, "training_iteration": 428, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-17-56", "timestamp": 1569673076, "time_this_iter_s": 30.518857955932617, "time_total_s": 13068.790321826935, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b42cc80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7236.581598043442, "timesteps_since_restore": 24830720, "iterations_since_restore": 237, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.65327269599247, "episode_reward_min": 46.21029108695784, "episode_reward_mean": 47.33273305650546, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 23.666135593865718, "agent_1": 23.666597462639867}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6937951038064265, "mean_processing_ms": 3.0347208364189076, "mean_inference_ms": 1.9320997337246109}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1313, "num_steps_trained": 65925888, "num_steps_sampled": 44945408, "sample_throughput": 0.0, "train_throughput": 24420.429, "num_weight_syncs": 48709, "num_samples_dropped": 205, "learner_queue": {"size_count": 154802, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.886, "replay_time_ms": 84.302, "update_priorities_time_ms": 50.138, "policy_agent_0": {"added_count": 6209536, "sampled_count": 9273344, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6209536, "sampled_count": 9273344, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.77746868133545, "min_q": 8.732900619506836, "max_q": 8.807195663452148, "mean_td_error": 0.029161106795072556, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.676636695861816, "min_q": 8.51921558380127, "max_q": 8.67885971069336, "mean_td_error": 0.01665298268198967, "model": {}}}}, "timesteps_this_iter": 108800, "done": false, "timesteps_total": 44945408, "episodes_total": 449448, "training_iteration": 429, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-18-27", "timestamp": 1569673107, "time_this_iter_s": 30.460280656814575, "time_total_s": 13099.25060248375, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b381c80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7267.041878700256, "timesteps_since_restore": 24939520, "iterations_since_restore": 238, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.574707896181, "episode_reward_min": 45.622537669150766, "episode_reward_mean": 46.764311252308, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 23.097764853853253, "agent_1": 23.666546398454763}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.693978495674745, "mean_processing_ms": 3.034155770304822, "mean_inference_ms": 1.9317104127924571}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1316, "num_steps_trained": 66085376, "num_steps_sampled": 45051648, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 48916, "num_samples_dropped": 205, "learner_queue": {"size_count": 155425, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.125, "replay_time_ms": 90.643, "update_priorities_time_ms": 56.742, "policy_agent_0": {"added_count": 6229760, "sampled_count": 9316352, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6229760, "sampled_count": 9316352, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.790225982666016, "min_q": 8.637198448181152, "max_q": 8.849620819091797, "mean_td_error": 0.035419292747974396, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.707367897033691, "min_q": 8.591126441955566, "max_q": 8.739127159118652, "mean_td_error": 0.005753248929977417, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 45051648, "episodes_total": 450528, "training_iteration": 430, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-18-57", "timestamp": 1569673137, "time_this_iter_s": 30.396244525909424, "time_total_s": 13129.646847009659, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b452400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7297.438123226166, "timesteps_since_restore": 25045760, "iterations_since_restore": 239, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.55820507685048, "episode_reward_min": 42.57622650054652, "episode_reward_mean": 46.76490128706755, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 23.3132016156986, "agent_1": 23.451699671369028}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6936765450009362, "mean_processing_ms": 3.033461358646234, "mean_inference_ms": 1.931575992071193}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1320, "num_steps_trained": 66247168, "num_steps_sampled": 45157120, "sample_throughput": 17492.923, "train_throughput": 0.0, "num_weight_syncs": 49122, "num_samples_dropped": 205, "learner_queue": {"size_count": 156057, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.278, "replay_time_ms": 93.459, "update_priorities_time_ms": 53.446, "policy_agent_0": {"added_count": 6257408, "sampled_count": 9359616, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6257408, "sampled_count": 9359616, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.777284622192383, "min_q": 8.469881057739258, "max_q": 8.837550163269043, "mean_td_error": 0.007338214665651321, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.749728202819824, "min_q": 8.6181001663208, "max_q": 8.783167839050293, "mean_td_error": 0.017351213842630386, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 45157120, "episodes_total": 451576, "training_iteration": 431, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-19-28", "timestamp": 1569673168, "time_this_iter_s": 30.514934301376343, "time_total_s": 13160.161781311035, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d8378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7327.953057527542, "timesteps_since_restore": 25151232, "iterations_since_restore": 240, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.57898304193865, "episode_reward_min": 47.22448494406567, "episode_reward_mean": 47.344471104418304, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 23.676939183253587, "agent_1": 23.66753192116485}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6934739155539922, "mean_processing_ms": 3.0335160450289127, "mean_inference_ms": 1.931560582682423}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1323, "num_steps_trained": 66409216, "num_steps_sampled": 45264384, "sample_throughput": 6299.435, "train_throughput": 6299.435, "num_weight_syncs": 49333, "num_samples_dropped": 205, "learner_queue": {"size_count": 156691, "size_mean": 0.22, "size_std": 0.45999999999999996, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.118, "replay_time_ms": 101.167, "update_priorities_time_ms": 63.14, "policy_agent_0": {"added_count": 6286336, "sampled_count": 9401344, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6286336, "sampled_count": 9401344, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.776496887207031, "min_q": 8.534939765930176, "max_q": 8.8193941116333, "mean_td_error": 0.02420375868678093, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.73951530456543, "min_q": 8.469436645507812, "max_q": 8.788739204406738, "mean_td_error": -0.01198313757777214, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 45264384, "episodes_total": 452640, "training_iteration": 432, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-19-58", "timestamp": 1569673198, "time_this_iter_s": 30.63775062561035, "time_total_s": 13190.799531936646, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae1bea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7358.5908081531525, "timesteps_since_restore": 25258496, "iterations_since_restore": 241, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.6059624309969, "episode_reward_min": 47.21075398289074, "episode_reward_mean": 47.34520144547556, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 23.682764327240392, "agent_1": 23.662437118235296}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6938615672857819, "mean_processing_ms": 3.033859479411052, "mean_inference_ms": 1.9319010463560435}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1326, "num_steps_trained": 66569728, "num_steps_sampled": 45370880, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 49541, "num_samples_dropped": 205, "learner_queue": {"size_count": 157318, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.413, "replay_time_ms": 91.807, "update_priorities_time_ms": 57.169, "policy_agent_0": {"added_count": 6310656, "sampled_count": 9442560, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6310656, "sampled_count": 9442560, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.814592361450195, "min_q": 8.540761947631836, "max_q": 8.831124305725098, "mean_td_error": 0.027067650109529495, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.7639799118042, "min_q": 8.4381685256958, "max_q": 8.804341316223145, "mean_td_error": 0.01438608393073082, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 45370880, "episodes_total": 453712, "training_iteration": 433, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-20-29", "timestamp": 1569673229, "time_this_iter_s": 30.558485746383667, "time_total_s": 13221.35801768303, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b102598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7389.149293899536, "timesteps_since_restore": 25364992, "iterations_since_restore": 242, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 48.81318554357841, "episode_reward_min": 47.22720008578374, "episode_reward_mean": 47.40433820982936, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 23.66596859357363, "agent_1": 23.738369616255852}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6932935841231882, "mean_processing_ms": 3.0340232112038397, "mean_inference_ms": 1.9312462945194286}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1329, "num_steps_trained": 66726656, "num_steps_sampled": 45478400, "sample_throughput": 0.0, "train_throughput": 25360.585, "num_weight_syncs": 49750, "num_samples_dropped": 205, "learner_queue": {"size_count": 157931, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 25.965, "replay_time_ms": 85.464, "update_priorities_time_ms": 46.613, "policy_agent_0": {"added_count": 6337280, "sampled_count": 9483264, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6337280, "sampled_count": 9483264, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.812342643737793, "min_q": 8.705302238464355, "max_q": 8.825020790100098, "mean_td_error": 0.0015370510518550873, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.779828071594238, "min_q": 8.697381973266602, "max_q": 8.852672576904297, "mean_td_error": 0.016169298440217972, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 45478400, "episodes_total": 454784, "training_iteration": 434, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-21-00", "timestamp": 1569673260, "time_this_iter_s": 30.589386224746704, "time_total_s": 13251.947403907776, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b102d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7419.738680124283, "timesteps_since_restore": 25472512, "iterations_since_restore": 243, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 49.94474005825527, "episode_reward_min": 47.24639556921703, "episode_reward_mean": 47.58399860122201, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 23.98965294237769, "agent_1": 23.594345658844446}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.693649835094541, "mean_processing_ms": 3.0341673975747865, "mean_inference_ms": 1.93174083849624}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1332, "num_steps_trained": 66887936, "num_steps_sampled": 45583104, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 49955, "num_samples_dropped": 205, "learner_queue": {"size_count": 158560, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.992, "replay_time_ms": 83.98, "update_priorities_time_ms": 52.517, "policy_agent_0": {"added_count": 6363648, "sampled_count": 9523200, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6363648, "sampled_count": 9523200, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.850090026855469, "min_q": 8.786296844482422, "max_q": 9.000654220581055, "mean_td_error": 0.02079916000366211, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.796829223632812, "min_q": 8.713090896606445, "max_q": 8.857192039489746, "mean_td_error": 0.022141635417938232, "model": {}}}}, "timesteps_this_iter": 104704, "done": false, "timesteps_total": 45583104, "episodes_total": 455832, "training_iteration": 435, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-21-30", "timestamp": 1569673290, "time_this_iter_s": 30.458433151245117, "time_total_s": 13282.405837059021, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344aae0bf8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7450.197113275528, "timesteps_since_restore": 25577216, "iterations_since_restore": 244, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.623464463105144, "episode_reward_min": 47.19155849945748, "episode_reward_mean": 47.34085596742985, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 23.671540372989252, "agent_1": 23.66931559444073}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6935048752469779, "mean_processing_ms": 3.033653206269149, "mean_inference_ms": 1.9314761748164697}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1336, "num_steps_trained": 67048960, "num_steps_sampled": 45690112, "sample_throughput": 7539.051, "train_throughput": 0.0, "num_weight_syncs": 50164, "num_samples_dropped": 205, "learner_queue": {"size_count": 159190, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.393, "replay_time_ms": 83.024, "update_priorities_time_ms": 43.07, "policy_agent_0": {"added_count": 6391552, "sampled_count": 9565184, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6391552, "sampled_count": 9565184, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.842430114746094, "min_q": 8.778066635131836, "max_q": 9.195831298828125, "mean_td_error": 0.016105063259601593, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.820852279663086, "min_q": 8.789374351501465, "max_q": 8.901240348815918, "mean_td_error": 0.034204237163066864, "model": {}}}}, "timesteps_this_iter": 107008, "done": false, "timesteps_total": 45690112, "episodes_total": 456904, "training_iteration": 436, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-22-01", "timestamp": 1569673321, "time_this_iter_s": 30.48482656478882, "time_total_s": 13312.89066362381, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a7de18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7480.681939840317, "timesteps_since_restore": 25684224, "iterations_since_restore": 245, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 48.790482377875236, "episode_reward_min": 47.22448494406566, "episode_reward_mean": 47.44184612846594, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 23.792100217849416, "agent_1": 23.64974591061664}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6937476897699691, "mean_processing_ms": 3.0328202367934223, "mean_inference_ms": 1.9309003177056536}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1339, "num_steps_trained": 67206656, "num_steps_sampled": 45798144, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 50375, "num_samples_dropped": 205, "learner_queue": {"size_count": 159805, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.166, "replay_time_ms": 97.493, "update_priorities_time_ms": 56.985, "policy_agent_0": {"added_count": 6414592, "sampled_count": 9606400, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6414592, "sampled_count": 9606400, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.851924896240234, "min_q": 8.706031799316406, "max_q": 9.310606956481934, "mean_td_error": 0.014867033809423447, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.792858123779297, "min_q": 8.689810752868652, "max_q": 8.836482048034668, "mean_td_error": 0.009562309831380844, "model": {}}}}, "timesteps_this_iter": 108032, "done": false, "timesteps_total": 45798144, "episodes_total": 457976, "training_iteration": 437, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-22-31", "timestamp": 1569673351, "time_this_iter_s": 30.481592655181885, "time_total_s": 13343.372256278992, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a0c378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7511.163532495499, "timesteps_since_restore": 25792256, "iterations_since_restore": 246, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 49.13670542228499, "episode_reward_min": 45.60334218571749, "episode_reward_mean": 47.28965756729545, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 23.608570253528846, "agent_1": 23.68108731376666}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6931053440477438, "mean_processing_ms": 3.0333062335667007, "mean_inference_ms": 1.930594429555671}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1342, "num_steps_trained": 67361280, "num_steps_sampled": 45907968, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 50589, "num_samples_dropped": 205, "learner_queue": {"size_count": 160409, "size_mean": 0.28, "size_std": 0.530659966456864, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.897, "replay_time_ms": 97.725, "update_priorities_time_ms": 52.979, "policy_agent_0": {"added_count": 6440704, "sampled_count": 9647616, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6440704, "sampled_count": 9647616, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.882145881652832, "min_q": 8.79023551940918, "max_q": 9.06505298614502, "mean_td_error": 0.01007051020860672, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.797810554504395, "min_q": 8.690450668334961, "max_q": 8.875269889831543, "mean_td_error": 0.005653735250234604, "model": {}}}}, "timesteps_this_iter": 109824, "done": false, "timesteps_total": 45907968, "episodes_total": 459080, "training_iteration": 438, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-23-02", "timestamp": 1569673382, "time_this_iter_s": 30.61427617073059, "time_total_s": 13373.986532449722, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a0cf28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7541.777808666229, "timesteps_since_restore": 25902080, "iterations_since_restore": 247, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 49.26112960494962, "episode_reward_min": 44.206293097004, "episode_reward_mean": 45.87008908028088, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 22.134518511711494, "agent_1": 23.735570568569234}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6932178755700771, "mean_processing_ms": 3.0331497864121175, "mean_inference_ms": 1.9310060846370827}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1345, "num_steps_trained": 67524352, "num_steps_sampled": 46013184, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 50794, "num_samples_dropped": 205, "learner_queue": {"size_count": 161046, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.39, "replay_time_ms": 94.47, "update_priorities_time_ms": 47.921, "policy_agent_0": {"added_count": 6463744, "sampled_count": 9689088, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6463744, "sampled_count": 9689088, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.809186935424805, "min_q": 8.621077537536621, "max_q": 9.09274959564209, "mean_td_error": 0.014036055654287338, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.859280586242676, "min_q": 8.804145812988281, "max_q": 9.1602201461792, "mean_td_error": 0.039422474801540375, "model": {}}}}, "timesteps_this_iter": 105216, "done": false, "timesteps_total": 46013184, "episodes_total": 460136, "training_iteration": 439, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-23-32", "timestamp": 1569673412, "time_this_iter_s": 30.483273029327393, "time_total_s": 13404.46980547905, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a24488>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7572.261081695557, "timesteps_since_restore": 26007296, "iterations_since_restore": 248, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.62965142100616, "episode_reward_min": 45.622537669150766, "episode_reward_mean": 46.997485106686895, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 23.26176565386855, "agent_1": 23.735719452818405}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6933536281689213, "mean_processing_ms": 3.0333161389439662, "mean_inference_ms": 1.9309353732820824}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1348, "num_steps_trained": 67684864, "num_steps_sampled": 46119424, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 51002, "num_samples_dropped": 205, "learner_queue": {"size_count": 161673, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.593, "replay_time_ms": 101.175, "update_priorities_time_ms": 52.958, "policy_agent_0": {"added_count": 6490368, "sampled_count": 9727488, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6490368, "sampled_count": 9727488, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.713706970214844, "min_q": 8.45549201965332, "max_q": 9.09227180480957, "mean_td_error": 0.029067467898130417, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.858139991760254, "min_q": 8.750045776367188, "max_q": 9.29377555847168, "mean_td_error": 0.03103819489479065, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 46119424, "episodes_total": 461200, "training_iteration": 440, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-24-03", "timestamp": 1569673443, "time_this_iter_s": 30.576011896133423, "time_total_s": 13435.045817375183, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a7d400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7602.83709359169, "timesteps_since_restore": 26113536, "iterations_since_restore": 249, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.56971075575458, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 45.77688571500115, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 22.54387367733734, "agent_1": 23.233012037663727}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6933761215042439, "mean_processing_ms": 3.0328975764048947, "mean_inference_ms": 1.9306929229325998}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1352, "num_steps_trained": 67847680, "num_steps_sampled": 46225920, "sample_throughput": 0.0, "train_throughput": 17143.114, "num_weight_syncs": 51210, "num_samples_dropped": 205, "learner_queue": {"size_count": 162309, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.808, "replay_time_ms": 65.353, "update_priorities_time_ms": 53.202, "policy_agent_0": {"added_count": 6522112, "sampled_count": 9769728, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6522112, "sampled_count": 9769728, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.65751838684082, "min_q": 8.4312744140625, "max_q": 8.836065292358398, "mean_td_error": -0.009752973914146423, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.856927871704102, "min_q": 8.607738494873047, "max_q": 9.256929397583008, "mean_td_error": 0.017409462481737137, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 46225920, "episodes_total": 462264, "training_iteration": 441, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-24-34", "timestamp": 1569673474, "time_this_iter_s": 30.50022292137146, "time_total_s": 13465.546040296555, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b102c80>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7633.3373165130615, "timesteps_since_restore": 26220032, "iterations_since_restore": 250, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.62881311190418, "episode_reward_min": 44.20629309700399, "episode_reward_mean": 46.26051374931035, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 23.246183891620994, "agent_1": 23.014329857689393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6932592899529496, "mean_processing_ms": 3.0330511332852086, "mean_inference_ms": 1.9304925130287303}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1355, "num_steps_trained": 68006400, "num_steps_sampled": 46334464, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 51421, "num_samples_dropped": 205, "learner_queue": {"size_count": 162929, "size_mean": 0.54, "size_std": 1.06226173799116, "size_quantiles": [0.0, 0.0, 0.0, 2.0, 5.0]}, "replay_shard_0": {"add_batch_time_ms": 32.892, "replay_time_ms": 90.887, "update_priorities_time_ms": 52.118, "policy_agent_0": {"added_count": 6550784, "sampled_count": 9809408, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6550784, "sampled_count": 9809408, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.715253829956055, "min_q": 8.45068073272705, "max_q": 8.825094223022461, "mean_td_error": 0.021941564977169037, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.793407440185547, "min_q": 8.594286918640137, "max_q": 8.873635292053223, "mean_td_error": 0.015919286757707596, "model": {}}}}, "timesteps_this_iter": 108544, "done": false, "timesteps_total": 46334464, "episodes_total": 463344, "training_iteration": 442, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-25-04", "timestamp": 1569673504, "time_this_iter_s": 30.611770153045654, "time_total_s": 13496.1578104496, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0ff268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7663.949086666107, "timesteps_since_restore": 26328576, "iterations_since_restore": 251, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.63406753347625, "episode_reward_min": 47.22720008578375, "episode_reward_mean": 47.33935717168018, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 23.672403759588093, "agent_1": 23.666953412092216}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6939001126277097, "mean_processing_ms": 3.032342002821904, "mean_inference_ms": 1.9302746665601425}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1358, "num_steps_trained": 68166912, "num_steps_sampled": 46443520, "sample_throughput": 8546.722, "train_throughput": 8546.722, "num_weight_syncs": 51635, "num_samples_dropped": 205, "learner_queue": {"size_count": 163557, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.86, "replay_time_ms": 105.878, "update_priorities_time_ms": 56.217, "policy_agent_0": {"added_count": 6579200, "sampled_count": 9849600, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6579200, "sampled_count": 9849600, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.712837219238281, "min_q": 8.3764009475708, "max_q": 8.813485145568848, "mean_td_error": 0.004809945821762085, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.809870719909668, "min_q": 8.473762512207031, "max_q": 9.05130672454834, "mean_td_error": 0.007394522428512573, "model": {}}}}, "timesteps_this_iter": 109056, "done": false, "timesteps_total": 46443520, "episodes_total": 464440, "training_iteration": 443, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-25-35", "timestamp": 1569673535, "time_this_iter_s": 30.68454909324646, "time_total_s": 13526.842359542847, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae1b9d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7694.633635759354, "timesteps_since_restore": 26437632, "iterations_since_restore": 252, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.51804538024353, "episode_reward_min": 47.22994946632402, "episode_reward_mean": 47.3388118830966, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 23.676974598550217, "agent_1": 23.66183728454651}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6930078838660576, "mean_processing_ms": 3.0316282098215557, "mean_inference_ms": 1.929865884281935}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1361, "num_steps_trained": 68322048, "num_steps_sampled": 46547200, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 51838, "num_samples_dropped": 205, "learner_queue": {"size_count": 164163, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.912, "replay_time_ms": 86.664, "update_priorities_time_ms": 38.736, "policy_agent_0": {"added_count": 6604288, "sampled_count": 9891072, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6604288, "sampled_count": 9891072, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.809761047363281, "min_q": 8.498701095581055, "max_q": 8.857431411743164, "mean_td_error": 0.025419551879167557, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.849761009216309, "min_q": 8.618514060974121, "max_q": 9.041064262390137, "mean_td_error": 0.010449294000864029, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 46547200, "episodes_total": 465480, "training_iteration": 444, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-26-05", "timestamp": 1569673565, "time_this_iter_s": 30.41295862197876, "time_total_s": 13557.255318164825, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ee730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7725.046594381332, "timesteps_since_restore": 26541312, "iterations_since_restore": 253, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.58853869670326, "episode_reward_min": 47.229949466324015, "episode_reward_mean": 47.340130011908236, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 23.666217464583692, "agent_1": 23.673912547324672}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6933447591653724, "mean_processing_ms": 3.031949640440594, "mean_inference_ms": 1.9299228389410752}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1364, "num_steps_trained": 68478720, "num_steps_sampled": 46656512, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 52051, "num_samples_dropped": 205, "learner_queue": {"size_count": 164774, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.888, "replay_time_ms": 96.357, "update_priorities_time_ms": 52.947, "policy_agent_0": {"added_count": 6634240, "sampled_count": 9931008, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6634240, "sampled_count": 9931008, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.822742462158203, "min_q": 8.722611427307129, "max_q": 8.845791816711426, "mean_td_error": 0.03498532250523567, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.84557819366455, "min_q": 8.741393089294434, "max_q": 8.852104187011719, "mean_td_error": 0.014817144721746445, "model": {}}}}, "timesteps_this_iter": 109312, "done": false, "timesteps_total": 46656512, "episodes_total": 466560, "training_iteration": 445, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-26-36", "timestamp": 1569673596, "time_this_iter_s": 30.45980668067932, "time_total_s": 13587.715124845505, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0da268>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7755.506401062012, "timesteps_since_restore": 26650624, "iterations_since_restore": 254, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.6384710505787, "episode_reward_min": 47.2163975748445, "episode_reward_mean": 47.33707310094777, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 23.668701376618134, "agent_1": 23.66837172432976}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6932939313809783, "mean_processing_ms": 3.0322909396860154, "mean_inference_ms": 1.9303061113681361}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1367, "num_steps_trained": 68636672, "num_steps_sampled": 46763776, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 52261, "num_samples_dropped": 205, "learner_queue": {"size_count": 165391, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.538, "replay_time_ms": 85.733, "update_priorities_time_ms": 50.546, "policy_agent_0": {"added_count": 6661120, "sampled_count": 9972480, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6661120, "sampled_count": 9972480, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.823850631713867, "min_q": 8.803338050842285, "max_q": 8.941763877868652, "mean_td_error": 0.00516587495803833, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.850727081298828, "min_q": 8.816814422607422, "max_q": 8.977377891540527, "mean_td_error": 0.03046223521232605, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 46763776, "episodes_total": 467648, "training_iteration": 446, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-27-06", "timestamp": 1569673626, "time_this_iter_s": 30.513237953186035, "time_total_s": 13618.22836279869, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d0d90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7786.019639015198, "timesteps_since_restore": 26757888, "iterations_since_restore": 255, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.61598305677813, "episode_reward_min": 47.22720008578374, "episode_reward_mean": 47.342192926414455, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 23.6780543217503, "agent_1": 23.66413860466428}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6934438169625657, "mean_processing_ms": 3.0315553254669196, "mean_inference_ms": 1.9302229169614933}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1370, "num_steps_trained": 68793344, "num_steps_sampled": 46871552, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 52472, "num_samples_dropped": 205, "learner_queue": {"size_count": 166003, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.277, "replay_time_ms": 87.317, "update_priorities_time_ms": 49.999, "policy_agent_0": {"added_count": 6686720, "sampled_count": 10013952, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6686720, "sampled_count": 10013952, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.822014808654785, "min_q": 8.709779739379883, "max_q": 8.879034996032715, "mean_td_error": 0.013333648443222046, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.861690521240234, "min_q": 8.783126831054688, "max_q": 8.988298416137695, "mean_td_error": 0.003072042018175125, "model": {}}}}, "timesteps_this_iter": 107776, "done": false, "timesteps_total": 46871552, "episodes_total": 468720, "training_iteration": 447, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-27-37", "timestamp": 1569673657, "time_this_iter_s": 30.528509855270386, "time_total_s": 13648.756872653961, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4239d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7816.548148870468, "timesteps_since_restore": 26865664, "iterations_since_restore": 256, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.58149192209281, "episode_reward_min": 47.22720008578375, "episode_reward_mean": 47.34075639602832, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 23.67599470790446, "agent_1": 23.664761688123985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6930266004934503, "mean_processing_ms": 3.03140996069679, "mean_inference_ms": 1.9302083647882495}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1374, "num_steps_trained": 68953600, "num_steps_sampled": 46979072, "sample_throughput": 0.0, "train_throughput": 15718.662, "num_weight_syncs": 52682, "num_samples_dropped": 205, "learner_queue": {"size_count": 166629, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.705, "replay_time_ms": 85.992, "update_priorities_time_ms": 45.49, "policy_agent_0": {"added_count": 6712576, "sampled_count": 10055936, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6712576, "sampled_count": 10055936, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.82685375213623, "min_q": 8.765837669372559, "max_q": 8.934802055358887, "mean_td_error": 0.012649890035390854, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.839696884155273, "min_q": 8.76190185546875, "max_q": 8.855321884155273, "mean_td_error": 0.012015867978334427, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 46979072, "episodes_total": 469784, "training_iteration": 448, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-28-07", "timestamp": 1569673687, "time_this_iter_s": 30.411866664886475, "time_total_s": 13679.168739318848, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4402f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7846.960015535355, "timesteps_since_restore": 26973184, "iterations_since_restore": 257, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.5985414208545, "episode_reward_min": 47.246395569217015, "episode_reward_mean": 47.34388486728931, "episode_len_mean": 100.0, "episodes_this_iter": 1112, "policy_reward_mean": {"agent_0": 23.679476038349556, "agent_1": 23.664408828939887}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6926526191126873, "mean_processing_ms": 3.030567624974857, "mean_inference_ms": 1.9294536410543368}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1377, "num_steps_trained": 69107712, "num_steps_sampled": 47090432, "sample_throughput": 14446.771, "train_throughput": 0.0, "num_weight_syncs": 52898, "num_samples_dropped": 205, "learner_queue": {"size_count": 167232, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.385, "replay_time_ms": 95.926, "update_priorities_time_ms": 46.448, "policy_agent_0": {"added_count": 6743808, "sampled_count": 10093568, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6743808, "sampled_count": 10093568, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.820697784423828, "min_q": 8.764602661132812, "max_q": 8.832197189331055, "mean_td_error": 0.010044027119874954, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.85383129119873, "min_q": 8.746230125427246, "max_q": 8.881001472473145, "mean_td_error": 0.005613408982753754, "model": {}}}}, "timesteps_this_iter": 111360, "done": false, "timesteps_total": 47090432, "episodes_total": 470896, "training_iteration": 449, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-28-38", "timestamp": 1569673718, "time_this_iter_s": 30.553683280944824, "time_total_s": 13709.722422599792, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b39c730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7877.513698816299, "timesteps_since_restore": 27084544, "iterations_since_restore": 258, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.6833202295, "episode_reward_min": 47.22720008578375, "episode_reward_mean": 47.33971229760078, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 23.67317954690021, "agent_1": 23.666532750700686}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6931462288346733, "mean_processing_ms": 3.0310457558551263, "mean_inference_ms": 1.9298274337230144}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1380, "num_steps_trained": 69269504, "num_steps_sampled": 47197184, "sample_throughput": 0.0, "train_throughput": 17957.351, "num_weight_syncs": 53107, "num_samples_dropped": 205, "learner_queue": {"size_count": 167863, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.7, "replay_time_ms": 86.955, "update_priorities_time_ms": 50.689, "policy_agent_0": {"added_count": 6772480, "sampled_count": 10135296, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6772480, "sampled_count": 10135296, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.810991287231445, "min_q": 8.76467227935791, "max_q": 8.828469276428223, "mean_td_error": 0.01797674596309662, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.849846839904785, "min_q": 8.821523666381836, "max_q": 8.857115745544434, "mean_td_error": 0.006256420165300369, "model": {}}}}, "timesteps_this_iter": 106752, "done": false, "timesteps_total": 47197184, "episodes_total": 471968, "training_iteration": 450, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-29-09", "timestamp": 1569673749, "time_this_iter_s": 30.613636255264282, "time_total_s": 13740.336058855057, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ccea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7908.127335071564, "timesteps_since_restore": 27191296, "iterations_since_restore": 259, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.565032048020285, "episode_reward_min": 47.22395027473549, "episode_reward_mean": 47.33829894419055, "episode_len_mean": 100.0, "episodes_this_iter": 1096, "policy_reward_mean": {"agent_0": 23.668594704707985, "agent_1": 23.669704239482694}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6930517689908346, "mean_processing_ms": 3.030574691295388, "mean_inference_ms": 1.9296033537471367}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1383, "num_steps_trained": 69426176, "num_steps_sampled": 47306752, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 53321, "num_samples_dropped": 205, "learner_queue": {"size_count": 168476, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.607, "replay_time_ms": 78.262, "update_priorities_time_ms": 48.725, "policy_agent_0": {"added_count": 6802944, "sampled_count": 10176000, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6802944, "sampled_count": 10176000, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.83143424987793, "min_q": 8.760899543762207, "max_q": 8.919851303100586, "mean_td_error": 0.0495942123234272, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.852465629577637, "min_q": 8.825740814208984, "max_q": 8.853689193725586, "mean_td_error": 0.013892363756895065, "model": {}}}}, "timesteps_this_iter": 109568, "done": false, "timesteps_total": 47306752, "episodes_total": 473064, "training_iteration": 451, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-29-39", "timestamp": 1569673779, "time_this_iter_s": 30.452630043029785, "time_total_s": 13770.788688898087, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b356158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7938.5799651145935, "timesteps_since_restore": 27300864, "iterations_since_restore": 260, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.76085253695385, "episode_reward_min": 45.591202369165316, "episode_reward_mean": 46.54850341082302, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 23.68398091401785, "agent_1": 22.86452249680514}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6933280248414342, "mean_processing_ms": 3.0300803092510233, "mean_inference_ms": 1.9294606904713902}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1386, "num_steps_trained": 69587456, "num_steps_sampled": 47413504, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 53529, "num_samples_dropped": 205, "learner_queue": {"size_count": 169105, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.993, "replay_time_ms": 80.409, "update_priorities_time_ms": 44.692, "policy_agent_0": {"added_count": 6830848, "sampled_count": 10217728, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6830848, "sampled_count": 10217728, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.831914901733398, "min_q": 8.766605377197266, "max_q": 8.938520431518555, "mean_td_error": 0.02435322478413582, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.846709251403809, "min_q": 8.714221954345703, "max_q": 8.889878273010254, "mean_td_error": 0.019991066306829453, "model": {}}}}, "timesteps_this_iter": 106752, "done": false, "timesteps_total": 47413504, "episodes_total": 474136, "training_iteration": 452, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-30-10", "timestamp": 1569673810, "time_this_iter_s": 30.46530270576477, "time_total_s": 13801.253991603851, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bca66a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7969.045267820358, "timesteps_since_restore": 27407616, "iterations_since_restore": 261, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.54146359722368, "episode_reward_min": 45.58903668498874, "episode_reward_mean": 46.1258023212019, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 23.683190643376037, "agent_1": 22.442611677825756}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6931346603791595, "mean_processing_ms": 3.029351036396525, "mean_inference_ms": 1.9292682543208708}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1389, "num_steps_trained": 69746432, "num_steps_sampled": 47518720, "sample_throughput": 8244.775, "train_throughput": 0.0, "num_weight_syncs": 53735, "num_samples_dropped": 205, "learner_queue": {"size_count": 169726, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.897, "replay_time_ms": 85.763, "update_priorities_time_ms": 41.795, "policy_agent_0": {"added_count": 6862336, "sampled_count": 10255872, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6862336, "sampled_count": 10255872, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.833593368530273, "min_q": 8.69563102722168, "max_q": 8.856033325195312, "mean_td_error": 0.0005637854337692261, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.746581077575684, "min_q": 8.576671600341797, "max_q": 8.874580383300781, "mean_td_error": 0.025079816579818726, "model": {}}}}, "timesteps_this_iter": 105216, "done": false, "timesteps_total": 47518720, "episodes_total": 475184, "training_iteration": 453, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-30-40", "timestamp": 1569673840, "time_this_iter_s": 30.55122947692871, "time_total_s": 13831.80522108078, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4019d8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7999.596497297287, "timesteps_since_restore": 27512832, "iterations_since_restore": 262, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.42618811630856, "episode_reward_min": 45.6203719849742, "episode_reward_mean": 46.01282295267209, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 23.667431130548685, "agent_1": 22.345391822123275}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6927914522603387, "mean_processing_ms": 3.030637147914498, "mean_inference_ms": 1.929679780024796}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1393, "num_steps_trained": 69907456, "num_steps_sampled": 47622912, "sample_throughput": 17259.123, "train_throughput": 0.0, "num_weight_syncs": 53938, "num_samples_dropped": 205, "learner_queue": {"size_count": 170355, "size_mean": 0.22, "size_std": 0.41424630354415964, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.454, "replay_time_ms": 95.49, "update_priorities_time_ms": 50.837, "policy_agent_0": {"added_count": 6889472, "sampled_count": 10297344, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6889472, "sampled_count": 10297344, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.845356941223145, "min_q": 8.762328147888184, "max_q": 8.884065628051758, "mean_td_error": 0.024052854627370834, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.635414123535156, "min_q": 8.468277931213379, "max_q": 8.820904731750488, "mean_td_error": 0.029620397835969925, "model": {}}}}, "timesteps_this_iter": 104192, "done": false, "timesteps_total": 47622912, "episodes_total": 476232, "training_iteration": 454, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-31-11", "timestamp": 1569673871, "time_this_iter_s": 30.56098985671997, "time_total_s": 13862.3662109375, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f88c8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8030.157487154007, "timesteps_since_restore": 27617024, "iterations_since_restore": 263, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.43090486050058, "episode_reward_min": 45.6033421857175, "episode_reward_mean": 46.55765092815769, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 23.658235793189448, "agent_1": 22.899415134968223}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6927927096256467, "mean_processing_ms": 3.0296495588659833, "mean_inference_ms": 1.929352343162706}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1396, "num_steps_trained": 70064128, "num_steps_sampled": 47731456, "sample_throughput": 7539.157, "train_throughput": 7539.157, "num_weight_syncs": 54151, "num_samples_dropped": 205, "learner_queue": {"size_count": 170968, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.979, "replay_time_ms": 83.158, "update_priorities_time_ms": 42.917, "policy_agent_0": {"added_count": 6918144, "sampled_count": 10336512, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6918144, "sampled_count": 10336512, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.852046012878418, "min_q": 8.738368034362793, "max_q": 8.951983451843262, "mean_td_error": 0.043075282126665115, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.585285186767578, "min_q": 8.422439575195312, "max_q": 8.786150932312012, "mean_td_error": 0.029799196869134903, "model": {}}}}, "timesteps_this_iter": 108544, "done": false, "timesteps_total": 47731456, "episodes_total": 477320, "training_iteration": 455, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-31-41", "timestamp": 1569673901, "time_this_iter_s": 30.517991304397583, "time_total_s": 13892.884202241898, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae44e18>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8060.6754784584045, "timesteps_since_restore": 27725568, "iterations_since_restore": 264, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 47.41623365051077, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 45.46126052925427, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 22.719560845059878, "agent_1": 22.741699684194355}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6930278559579846, "mean_processing_ms": 3.0296155285031094, "mean_inference_ms": 1.9293257089580205}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1399, "num_steps_trained": 70224640, "num_steps_sampled": 47838208, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 54359, "num_samples_dropped": 205, "learner_queue": {"size_count": 171594, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.979, "replay_time_ms": 83.055, "update_priorities_time_ms": 56.957, "policy_agent_0": {"added_count": 6949888, "sampled_count": 10376448, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6949888, "sampled_count": 10376448, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.84313678741455, "min_q": 8.591707229614258, "max_q": 8.864598274230957, "mean_td_error": 0.034974873065948486, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.603157043457031, "min_q": 8.359834671020508, "max_q": 8.932121276855469, "mean_td_error": 0.017478205263614655, "model": {}}}}, "timesteps_this_iter": 106752, "done": false, "timesteps_total": 47838208, "episodes_total": 478384, "training_iteration": 456, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-32-12", "timestamp": 1569673932, "time_this_iter_s": 30.62140727043152, "time_total_s": 13923.50560951233, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344aacb0d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8091.296885728836, "timesteps_since_restore": 27832320, "iterations_since_restore": 265, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 46.07255281920876, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 45.44035132891494, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 23.39709023505213, "agent_1": 22.043261093862643}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6928446503555409, "mean_processing_ms": 3.0295561978827883, "mean_inference_ms": 1.9292335255020745}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1402, "num_steps_trained": 70383616, "num_steps_sampled": 47944192, "sample_throughput": 23353.891, "train_throughput": 0.0, "num_weight_syncs": 54566, "num_samples_dropped": 205, "learner_queue": {"size_count": 172215, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.875, "replay_time_ms": 96.23, "update_priorities_time_ms": 47.423, "policy_agent_0": {"added_count": 6976000, "sampled_count": 10414848, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 6976000, "sampled_count": 10414848, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.834123611450195, "min_q": 8.472330093383789, "max_q": 8.875539779663086, "mean_td_error": 0.013349074870347977, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.569575309753418, "min_q": 8.336652755737305, "max_q": 8.77793025970459, "mean_td_error": 0.014518890529870987, "model": {}}}}, "timesteps_this_iter": 105984, "done": false, "timesteps_total": 47944192, "episodes_total": 479448, "training_iteration": 457, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-32-42", "timestamp": 1569673962, "time_this_iter_s": 30.486515998840332, "time_total_s": 13953.99212551117, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a8b7b8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8121.783401727676, "timesteps_since_restore": 27938304, "iterations_since_restore": 266, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.99376712117933, "episode_reward_min": 42.50554710170053, "episode_reward_mean": 44.17163041169411, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 22.155122621899206, "agent_1": 22.01650778979481}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6929781789685698, "mean_processing_ms": 3.029276208603602, "mean_inference_ms": 1.9288129910757863}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1405, "num_steps_trained": 70543872, "num_steps_sampled": 48050688, "sample_throughput": 0.0, "train_throughput": 12795.436, "num_weight_syncs": 54774, "num_samples_dropped": 205, "learner_queue": {"size_count": 172841, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.088, "replay_time_ms": 103.845, "update_priorities_time_ms": 52.331, "policy_agent_0": {"added_count": 7000320, "sampled_count": 10455296, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7000320, "sampled_count": 10455296, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.761393547058105, "min_q": 8.309211730957031, "max_q": 8.867097854614258, "mean_td_error": 0.03860286623239517, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.477583885192871, "min_q": 8.413872718811035, "max_q": 8.773404121398926, "mean_td_error": 0.03193529322743416, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 48050688, "episodes_total": 480512, "training_iteration": 458, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-33-13", "timestamp": 1569673993, "time_this_iter_s": 30.624910593032837, "time_total_s": 13984.617036104202, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a5b2f0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8152.408312320709, "timesteps_since_restore": 28044800, "iterations_since_restore": 267, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 43.106994353734606, "episode_reward_min": 42.50554710170052, "episode_reward_mean": 42.62520386644932, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 20.643906271857237, "agent_1": 21.98129759459209}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6927111673159184, "mean_processing_ms": 3.0296368312976663, "mean_inference_ms": 1.9284906000717923}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1408, "num_steps_trained": 70696960, "num_steps_sampled": 48161536, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 54990, "num_samples_dropped": 205, "learner_queue": {"size_count": 173439, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.176, "replay_time_ms": 103.995, "update_priorities_time_ms": 54.103, "policy_agent_0": {"added_count": 7028224, "sampled_count": 10493440, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7028224, "sampled_count": 10493440, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.547849655151367, "min_q": 8.273390769958496, "max_q": 8.838116645812988, "mean_td_error": 0.011417098343372345, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.421316146850586, "min_q": 8.318929672241211, "max_q": 8.619988441467285, "mean_td_error": 0.011534672230482101, "model": {}}}}, "timesteps_this_iter": 110848, "done": false, "timesteps_total": 48161536, "episodes_total": 481616, "training_iteration": 459, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-33-44", "timestamp": 1569674024, "time_this_iter_s": 30.542431116104126, "time_total_s": 14015.159467220306, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a64158>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8182.950743436813, "timesteps_since_restore": 28155648, "iterations_since_restore": 268, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 46.968193151428245, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 43.34106123024589, "episode_len_mean": 100.0, "episodes_this_iter": 1104, "policy_reward_mean": {"agent_0": 21.64684588385678, "agent_1": 21.694215346389104}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6924979225463967, "mean_processing_ms": 3.028910213969034, "mean_inference_ms": 1.9280118865438427}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1411, "num_steps_trained": 70855424, "num_steps_sampled": 48270848, "sample_throughput": 16749.867, "train_throughput": 0.0, "num_weight_syncs": 55204, "num_samples_dropped": 205, "learner_queue": {"size_count": 174059, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 47.92, "replay_time_ms": 107.708, "update_priorities_time_ms": 47.904, "policy_agent_0": {"added_count": 7053568, "sampled_count": 10532352, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7053568, "sampled_count": 10532352, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.35673713684082, "min_q": 8.144247055053711, "max_q": 8.834535598754883, "mean_td_error": 0.010687820613384247, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.366965293884277, "min_q": 8.169875144958496, "max_q": 8.414999961853027, "mean_td_error": 0.017295097932219505, "model": {}}}}, "timesteps_this_iter": 109312, "done": false, "timesteps_total": 48270848, "episodes_total": 482720, "training_iteration": 460, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-34-14", "timestamp": 1569674054, "time_this_iter_s": 30.57046341896057, "time_total_s": 14045.729930639267, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a22048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8213.521206855774, "timesteps_since_restore": 28264960, "iterations_since_restore": 269, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 46.13105069319672, "episode_reward_min": 43.89465786938159, "episode_reward_mean": 45.67016539675455, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 23.618485825781185, "agent_1": 22.051679570973175}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.692921992606824, "mean_processing_ms": 3.029445931944014, "mean_inference_ms": 1.9281086981083022}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1415, "num_steps_trained": 71016704, "num_steps_sampled": 48377088, "sample_throughput": 30763.597, "train_throughput": 0.0, "num_weight_syncs": 55411, "num_samples_dropped": 205, "learner_queue": {"size_count": 174688, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.141, "replay_time_ms": 71.375, "update_priorities_time_ms": 47.844, "policy_agent_0": {"added_count": 7081472, "sampled_count": 10572800, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7081472, "sampled_count": 10572800, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.477221488952637, "min_q": 8.040091514587402, "max_q": 8.861753463745117, "mean_td_error": 0.022837024182081223, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.341896057128906, "min_q": 8.059260368347168, "max_q": 8.627542495727539, "mean_td_error": 0.017362192273139954, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 48377088, "episodes_total": 483776, "training_iteration": 461, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-34-45", "timestamp": 1569674085, "time_this_iter_s": 30.5006582736969, "time_total_s": 14076.230588912964, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a22d90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8244.02186512947, "timesteps_since_restore": 28371200, "iterations_since_restore": 270, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 46.00344550076179, "episode_reward_min": 45.595012525852596, "episode_reward_mean": 45.70170689971405, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 23.65179199460489, "agent_1": 22.049914905108963}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6929165877461697, "mean_processing_ms": 3.028845650320711, "mean_inference_ms": 1.9276638636215653}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1418, "num_steps_trained": 71176704, "num_steps_sampled": 48484608, "sample_throughput": 8743.755, "train_throughput": 0.0, "num_weight_syncs": 55621, "num_samples_dropped": 205, "learner_queue": {"size_count": 175313, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.08, "replay_time_ms": 80.469, "update_priorities_time_ms": 45.665, "policy_agent_0": {"added_count": 7110400, "sampled_count": 10610688, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7110400, "sampled_count": 10610688, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.677339553833008, "min_q": 8.193754196166992, "max_q": 8.892416000366211, "mean_td_error": 0.014449357986450195, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.31311321258545, "min_q": 8.028600692749023, "max_q": 8.49576473236084, "mean_td_error": 0.007585754618048668, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 48484608, "episodes_total": 484848, "training_iteration": 462, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-35-15", "timestamp": 1569674115, "time_this_iter_s": 30.49508237838745, "time_total_s": 14106.725671291351, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a42378>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8274.516947507858, "timesteps_since_restore": 28478720, "iterations_since_restore": 271, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 49.982789979348226, "episode_reward_min": 45.58676406859611, "episode_reward_mean": 45.921590001795444, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 23.61673848987402, "agent_1": 22.304851511921257}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6929410530825566, "mean_processing_ms": 3.028242466655296, "mean_inference_ms": 1.9275058265598628}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1421, "num_steps_trained": 71337984, "num_steps_sampled": 48590848, "sample_throughput": 0.0, "train_throughput": 27351.602, "num_weight_syncs": 55829, "num_samples_dropped": 205, "learner_queue": {"size_count": 175943, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.176, "replay_time_ms": 96.589, "update_priorities_time_ms": 48.728, "policy_agent_0": {"added_count": 7135744, "sampled_count": 10650624, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7135744, "sampled_count": 10650624, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.828659057617188, "min_q": 8.742521286010742, "max_q": 8.930411338806152, "mean_td_error": 0.033452097326517105, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.34715461730957, "min_q": 8.200315475463867, "max_q": 8.680475234985352, "mean_td_error": 0.03326728194952011, "model": {}}}}, "timesteps_this_iter": 106240, "done": false, "timesteps_total": 48590848, "episodes_total": 485904, "training_iteration": 463, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-35-46", "timestamp": 1569674146, "time_this_iter_s": 30.50333857536316, "time_total_s": 14137.229009866714, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a65730>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8305.020286083221, "timesteps_since_restore": 28584960, "iterations_since_restore": 272, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 46.030796471669326, "episode_reward_min": 45.572006885732044, "episode_reward_mean": 45.70181351562364, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 23.64985349034423, "agent_1": 22.051960025279225}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6936038060623386, "mean_processing_ms": 3.0286007997658575, "mean_inference_ms": 1.9280411207389643}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1424, "num_steps_trained": 71498496, "num_steps_sampled": 48698368, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 56039, "num_samples_dropped": 205, "learner_queue": {"size_count": 176571, "size_mean": 0.1, "size_std": 0.36055512754639896, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.085, "replay_time_ms": 71.06, "update_priorities_time_ms": 42.233, "policy_agent_0": {"added_count": 7167488, "sampled_count": 10688768, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7167488, "sampled_count": 10688768, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.84766960144043, "min_q": 8.720196723937988, "max_q": 8.856181144714355, "mean_td_error": 0.016208522021770477, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.328231811523438, "min_q": 8.2994966506958, "max_q": 8.788445472717285, "mean_td_error": 0.013808274641633034, "model": {}}}}, "timesteps_this_iter": 107520, "done": false, "timesteps_total": 48698368, "episodes_total": 486984, "training_iteration": 464, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-36-16", "timestamp": 1569674176, "time_this_iter_s": 30.55435061454773, "time_total_s": 14167.783360481262, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f3449a77048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8335.57463669777, "timesteps_since_restore": 28692480, "iterations_since_restore": 273, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 46.0423541669724, "episode_reward_min": 45.593938949169186, "episode_reward_mean": 45.70180302716279, "episode_len_mean": 100.0, "episodes_this_iter": 1064, "policy_reward_mean": {"agent_0": 23.651045643996365, "agent_1": 22.050757383166236}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.693168742112398, "mean_processing_ms": 3.0287536422135095, "mean_inference_ms": 1.9278635955903904}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1427, "num_steps_trained": 71659008, "num_steps_sampled": 48805120, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 56248, "num_samples_dropped": 205, "learner_queue": {"size_count": 177197, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.581, "replay_time_ms": 93.196, "update_priorities_time_ms": 46.659, "policy_agent_0": {"added_count": 7194112, "sampled_count": 10729984, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7194112, "sampled_count": 10729984, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.861421585083008, "min_q": 8.834617614746094, "max_q": 8.973945617675781, "mean_td_error": 0.007940288633108139, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.328804969787598, "min_q": 8.252458572387695, "max_q": 8.833792686462402, "mean_td_error": 0.002072317525744438, "model": {}}}}, "timesteps_this_iter": 106752, "done": false, "timesteps_total": 48805120, "episodes_total": 488048, "training_iteration": 465, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-36-47", "timestamp": 1569674207, "time_this_iter_s": 30.46511960029602, "time_total_s": 14198.248480081558, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae44ea0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8366.039756298065, "timesteps_since_restore": 28799232, "iterations_since_restore": 274, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 46.005807418622304, "episode_reward_min": 45.57689686843656, "episode_reward_mean": 45.698286424261894, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 23.652601360812817, "agent_1": 22.045685063448897}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6927136853987543, "mean_processing_ms": 3.0276946016883803, "mean_inference_ms": 1.927315457610963}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1431, "num_steps_trained": 71818496, "num_steps_sampled": 48912384, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 56456, "num_samples_dropped": 205, "learner_queue": {"size_count": 177820, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.594, "replay_time_ms": 80.193, "update_priorities_time_ms": 42.67, "policy_agent_0": {"added_count": 7219968, "sampled_count": 10771712, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7219968, "sampled_count": 10771712, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.826811790466309, "min_q": 8.710975646972656, "max_q": 8.939802169799805, "mean_td_error": -0.002869516611099243, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.293255805969238, "min_q": 8.222285270690918, "max_q": 8.325594902038574, "mean_td_error": 0.03262940049171448, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 48912384, "episodes_total": 489128, "training_iteration": 466, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-37-18", "timestamp": 1569674238, "time_this_iter_s": 30.496676683425903, "time_total_s": 14228.745156764984, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344ae3cd08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8396.536432981491, "timesteps_since_restore": 28906496, "iterations_since_restore": 275, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.87995850197537, "episode_reward_min": 44.20629309700399, "episode_reward_mean": 44.92183521985543, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 22.821587406875654, "agent_1": 22.10024781297969}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6931248253338939, "mean_processing_ms": 3.029336485334524, "mean_inference_ms": 1.9282424638632616}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1434, "num_steps_trained": 71973632, "num_steps_sampled": 49017344, "sample_throughput": 0.0, "train_throughput": 22466.978, "num_weight_syncs": 56662, "num_samples_dropped": 205, "learner_queue": {"size_count": 178426, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.205, "replay_time_ms": 87.824, "update_priorities_time_ms": 49.585, "policy_agent_0": {"added_count": 7248640, "sampled_count": 10809600, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7248640, "sampled_count": 10809600, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.852609634399414, "min_q": 8.747060775756836, "max_q": 8.963359832763672, "mean_td_error": 0.02338988706469536, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.280113220214844, "min_q": 8.234599113464355, "max_q": 8.330558776855469, "mean_td_error": 0.02211190201342106, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 49017344, "episodes_total": 490176, "training_iteration": 467, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-37-48", "timestamp": 1569674268, "time_this_iter_s": 30.47780966758728, "time_total_s": 14259.222966432571, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f8400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8427.014242649078, "timesteps_since_restore": 29011456, "iterations_since_restore": 276, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.87190341087724, "episode_reward_min": 44.1892632977473, "episode_reward_mean": 44.42801090244966, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 22.28934900144713, "agent_1": 22.138661901002507}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6926132690774388, "mean_processing_ms": 3.0290158960668636, "mean_inference_ms": 1.9278951225051675}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1437, "num_steps_trained": 72131840, "num_steps_sampled": 49125632, "sample_throughput": 9345.174, "train_throughput": 0.0, "num_weight_syncs": 56874, "num_samples_dropped": 205, "learner_queue": {"size_count": 179045, "size_mean": 0.4, "size_std": 1.0198039027185568, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 5.0]}, "replay_shard_0": {"add_batch_time_ms": 30.987, "replay_time_ms": 82.299, "update_priorities_time_ms": 39.523, "policy_agent_0": {"added_count": 7280128, "sampled_count": 10848768, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7280128, "sampled_count": 10848768, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.769083023071289, "min_q": 8.659561157226562, "max_q": 8.871060371398926, "mean_td_error": 0.012416496872901917, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.28284740447998, "min_q": 8.19012451171875, "max_q": 8.307990074157715, "mean_td_error": 0.040608152747154236, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 49125632, "episodes_total": 491256, "training_iteration": 468, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-38-19", "timestamp": 1569674299, "time_this_iter_s": 30.585705757141113, "time_total_s": 14289.808672189713, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0f2d08>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8457.59994840622, "timesteps_since_restore": 29119744, "iterations_since_restore": 277, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.86798683158765, "episode_reward_min": 44.189263297747296, "episode_reward_mean": 44.587069336955665, "episode_len_mean": 100.0, "episodes_this_iter": 1080, "policy_reward_mean": {"agent_0": 22.454795858747755, "agent_1": 22.13227347820787}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6928470193025051, "mean_processing_ms": 3.028194908522757, "mean_inference_ms": 1.9273633800832142}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1440, "num_steps_trained": 72290048, "num_steps_sampled": 49232896, "sample_throughput": 5530.362, "train_throughput": 0.0, "num_weight_syncs": 57083, "num_samples_dropped": 205, "learner_queue": {"size_count": 179662, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.639, "replay_time_ms": 105.276, "update_priorities_time_ms": 49.714, "policy_agent_0": {"added_count": 7308800, "sampled_count": 10887168, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7308800, "sampled_count": 10887168, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.668885231018066, "min_q": 8.557405471801758, "max_q": 8.86406135559082, "mean_td_error": 0.03308809921145439, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.276342391967773, "min_q": 8.225433349609375, "max_q": 8.342844009399414, "mean_td_error": 0.016017308458685875, "model": {}}}}, "timesteps_this_iter": 107264, "done": false, "timesteps_total": 49232896, "episodes_total": 492336, "training_iteration": 469, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-38-49", "timestamp": 1569674329, "time_this_iter_s": 30.58940052986145, "time_total_s": 14320.398072719574, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4400d0>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8488.189348936081, "timesteps_since_restore": 29227008, "iterations_since_restore": 278, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 45.91149324724266, "episode_reward_min": 44.189263297747296, "episode_reward_mean": 44.711990065768624, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 22.373949366656205, "agent_1": 22.338040699112355}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6929501366933106, "mean_processing_ms": 3.0281716960509844, "mean_inference_ms": 1.927602276210604}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1443, "num_steps_trained": 72453632, "num_steps_sampled": 49339392, "sample_throughput": 0.0, "train_throughput": 18374.034, "num_weight_syncs": 57290, "num_samples_dropped": 205, "learner_queue": {"size_count": 180301, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.792, "replay_time_ms": 108.819, "update_priorities_time_ms": 54.161, "policy_agent_0": {"added_count": 7331584, "sampled_count": 10932224, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7331584, "sampled_count": 10932224, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.575716018676758, "min_q": 8.509100914001465, "max_q": 8.815077781677246, "mean_td_error": 0.03304346650838852, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.27890682220459, "min_q": 8.17841625213623, "max_q": 8.438081741333008, "mean_td_error": 0.018170977011322975, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 49339392, "episodes_total": 493392, "training_iteration": 470, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-39-20", "timestamp": 1569674360, "time_this_iter_s": 30.53443193435669, "time_total_s": 14350.93250465393, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b379048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8518.723780870438, "timesteps_since_restore": 29333504, "iterations_since_restore": 279, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.54867589616028, "episode_reward_min": 44.189263297747296, "episode_reward_mean": 44.28716802309191, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 22.14146044820491, "agent_1": 22.145707574887}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6925720711112614, "mean_processing_ms": 3.0278443778241746, "mean_inference_ms": 1.9271589292659446}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1446, "num_steps_trained": 72612352, "num_steps_sampled": 49444864, "sample_throughput": 0.0, "train_throughput": 10496.728, "num_weight_syncs": 57497, "num_samples_dropped": 205, "learner_queue": {"size_count": 180921, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.599, "replay_time_ms": 101.985, "update_priorities_time_ms": 54.329, "policy_agent_0": {"added_count": 7359744, "sampled_count": 10974976, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7359744, "sampled_count": 10974976, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.509764671325684, "min_q": 8.367011070251465, "max_q": 8.805398941040039, "mean_td_error": 0.01375175267457962, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.269951820373535, "min_q": 8.241957664489746, "max_q": 8.46649169921875, "mean_td_error": 0.017429988831281662, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 49444864, "episodes_total": 494448, "training_iteration": 471, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-39-50", "timestamp": 1569674390, "time_this_iter_s": 30.512635946273804, "time_total_s": 14381.445140600204, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b3ccf28>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8549.236416816711, "timesteps_since_restore": 29438976, "iterations_since_restore": 280, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.55541057782189, "episode_reward_min": 44.189263297747296, "episode_reward_mean": 44.286593683059834, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 22.139006017223014, "agent_1": 22.147587665836824}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6931882873482741, "mean_processing_ms": 3.028344712473333, "mean_inference_ms": 1.9273643796116635}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1450, "num_steps_trained": 72770560, "num_steps_sampled": 49553152, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 57709, "num_samples_dropped": 205, "learner_queue": {"size_count": 181539, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.974, "replay_time_ms": 91.84, "update_priorities_time_ms": 43.497, "policy_agent_0": {"added_count": 7382528, "sampled_count": 11015936, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7382528, "sampled_count": 11015936, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.43321418762207, "min_q": 8.295941352844238, "max_q": 8.737288475036621, "mean_td_error": -0.006813943386077881, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.282125473022461, "min_q": 8.197610855102539, "max_q": 8.307713508605957, "mean_td_error": 0.02714756317436695, "model": {}}}}, "timesteps_this_iter": 108288, "done": false, "timesteps_total": 49553152, "episodes_total": 495536, "training_iteration": 472, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-40-21", "timestamp": 1569674421, "time_this_iter_s": 30.416451454162598, "time_total_s": 14411.861592054367, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344bc9d048>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8579.652868270874, "timesteps_since_restore": 29547264, "iterations_since_restore": 281, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.592196055322994, "episode_reward_min": 44.189263297747296, "episode_reward_mean": 44.28545524601401, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 22.138422315155545, "agent_1": 22.14703293085846}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6930966830552042, "mean_processing_ms": 3.02743269632425, "mean_inference_ms": 1.9270044635955161}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1453, "num_steps_trained": 72929536, "num_steps_sampled": 49660928, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 57920, "num_samples_dropped": 205, "learner_queue": {"size_count": 182161, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 24.742, "replay_time_ms": 79.017, "update_priorities_time_ms": 44.907, "policy_agent_0": {"added_count": 7409152, "sampled_count": 11056640, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7409152, "sampled_count": 11056640, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.386879920959473, "min_q": 8.316500663757324, "max_q": 8.390852928161621, "mean_td_error": 0.01645795814692974, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.299736976623535, "min_q": 8.295663833618164, "max_q": 8.494479179382324, "mean_td_error": 0.017474494874477386, "model": {}}}}, "timesteps_this_iter": 107776, "done": false, "timesteps_total": 49660928, "episodes_total": 496608, "training_iteration": 473, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-40-51", "timestamp": 1569674451, "time_this_iter_s": 30.506357669830322, "time_total_s": 14442.367949724197, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b423598>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8610.159225940704, "timesteps_since_restore": 29655040, "iterations_since_restore": 282, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.57242204180247, "episode_reward_min": 44.204654656635384, "episode_reward_mean": 44.2863351058168, "episode_len_mean": 100.0, "episodes_this_iter": 1056, "policy_reward_mean": {"agent_0": 22.137714071859364, "agent_1": 22.148621033957433}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6932280575874424, "mean_processing_ms": 3.0278436960801516, "mean_inference_ms": 1.9271992374237439}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1456, "num_steps_trained": 73094144, "num_steps_sampled": 49766400, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 58125, "num_samples_dropped": 205, "learner_queue": {"size_count": 182804, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.327, "replay_time_ms": 82.882, "update_priorities_time_ms": 44.287, "policy_agent_0": {"added_count": 7435008, "sampled_count": 11100160, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7435008, "sampled_count": 11100160, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.356529235839844, "min_q": 8.258278846740723, "max_q": 8.569374084472656, "mean_td_error": 0.00984872505068779, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.287385940551758, "min_q": 8.23104476928711, "max_q": 8.2894868850708, "mean_td_error": 0.0033409837633371353, "model": {}}}}, "timesteps_this_iter": 105472, "done": false, "timesteps_total": 49766400, "episodes_total": 497664, "training_iteration": 474, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-41-22", "timestamp": 1569674482, "time_this_iter_s": 30.57052254676819, "time_total_s": 14472.938472270966, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b4376a8>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8640.729748487473, "timesteps_since_restore": 29760512, "iterations_since_restore": 283, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.59404825108505, "episode_reward_min": 42.50554710170052, "episode_reward_mean": 43.996121293338994, "episode_len_mean": 100.0, "episodes_this_iter": 1072, "policy_reward_mean": {"agent_0": 21.877581414248006, "agent_1": 22.118539879090992}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6927297960890053, "mean_processing_ms": 3.027940213512396, "mean_inference_ms": 1.9271639033023211}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1459, "num_steps_trained": 73253888, "num_steps_sampled": 49872896, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 58333, "num_samples_dropped": 205, "learner_queue": {"size_count": 183427, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.916, "replay_time_ms": 96.069, "update_priorities_time_ms": 50.223, "policy_agent_0": {"added_count": 7460096, "sampled_count": 11141376, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7460096, "sampled_count": 11141376, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.359161376953125, "min_q": 8.267762184143066, "max_q": 8.367700576782227, "mean_td_error": 0.022842662408947945, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.285187721252441, "min_q": 8.205289840698242, "max_q": 8.310462951660156, "mean_td_error": 0.010965051129460335, "model": {}}}}, "timesteps_this_iter": 106496, "done": false, "timesteps_total": 49872896, "episodes_total": 498736, "training_iteration": 475, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-41-52", "timestamp": 1569674512, "time_this_iter_s": 30.484557390213013, "time_total_s": 14503.423029661179, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b381840>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8671.214305877686, "timesteps_since_restore": 29867008, "iterations_since_restore": 284, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.65674929221947, "episode_reward_min": 44.189263297747296, "episode_reward_mean": 44.284589827935115, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 22.1356535993387, "agent_1": 22.148936228596416}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6925146869559449, "mean_processing_ms": 3.027746259586919, "mean_inference_ms": 1.9271433888418308}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1462, "num_steps_trained": 73416704, "num_steps_sampled": 49977856, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 58538, "num_samples_dropped": 205, "learner_queue": {"size_count": 184063, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.722, "replay_time_ms": 95.657, "update_priorities_time_ms": 54.075, "policy_agent_0": {"added_count": 7485696, "sampled_count": 11181568, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7485696, "sampled_count": 11181568, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.329071998596191, "min_q": 8.171809196472168, "max_q": 8.490399360656738, "mean_td_error": 0.020486410707235336, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.276179313659668, "min_q": 8.174942016601562, "max_q": 8.296483993530273, "mean_td_error": 0.0054700374603271484, "model": {}}}}, "timesteps_this_iter": 104960, "done": false, "timesteps_total": 49977856, "episodes_total": 499776, "training_iteration": 476, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-42-23", "timestamp": 1569674543, "time_this_iter_s": 30.519433736801147, "time_total_s": 14533.94246339798, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b452d90>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8701.733739614487, "timesteps_since_restore": 29971968, "iterations_since_restore": 285, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
{"episode_reward_max": 44.52568142595998, "episode_reward_min": 44.20629309700399, "episode_reward_mean": 44.28232479651852, "episode_len_mean": 100.0, "episodes_this_iter": 1088, "policy_reward_mean": {"agent_0": 22.14056780200674, "agent_1": 22.141756994511784}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.693458488585226, "mean_processing_ms": 3.02785986091896, "mean_inference_ms": 1.9272935115524223}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1466, "num_steps_trained": 73575936, "num_steps_sampled": 50086144, "sample_throughput": 8528.258, "train_throughput": 8528.258, "num_weight_syncs": 58750, "num_samples_dropped": 205, "learner_queue": {"size_count": 184685, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.139, "replay_time_ms": 97.969, "update_priorities_time_ms": 52.937, "policy_agent_0": {"added_count": 7516672, "sampled_count": 11220992, "est_size_bytes": 97727564, "num_entries": 75000}, "policy_agent_1": {"added_count": 7516672, "sampled_count": 11220992, "est_size_bytes": 97727564, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_q": 8.304929733276367, "min_q": 8.133106231689453, "max_q": 8.33426570892334, "mean_td_error": 0.0209012683480978, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_q": 8.280738830566406, "min_q": 8.177719116210938, "max_q": 8.419955253601074, "mean_td_error": 0.016243647783994675, "model": {}}}}, "timesteps_this_iter": 108288, "done": true, "timesteps_total": 50086144, "episodes_total": 500864, "training_iteration": 477, "experiment_id": "5a8c3f26378b4467aafb07332f1f86bd", "date": "2019-09-28_12-42-54", "timestamp": 1569674574, "time_this_iter_s": 30.48659634590149, "time_total_s": 14564.429059743881, "pid": 13510, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f344b0d8400>)", "policies_to_train": null}, "num_atoms": 1, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [32], "n_step": 3, "schedule_max_timesteps": 100000000, "exploration_fraction": 0.005, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.5, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8732.220335960388, "timesteps_since_restore": 30080256, "iterations_since_restore": 286, "num_healthy_workers": 4, "trial_id": "1c3a517a"}
