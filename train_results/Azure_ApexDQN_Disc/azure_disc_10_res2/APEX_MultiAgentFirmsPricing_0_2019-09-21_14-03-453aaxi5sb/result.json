{"episode_reward_max": 56.148525601630226, "episode_reward_min": 48.41987381181894, "episode_reward_mean": 53.3445077615162, "episode_len_mean": 100.0, "episodes_this_iter": 792, "policy_reward_mean": {"agent_0": 27.68915093966363, "agent_1": 25.655356821852557}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6203623386133053, "mean_processing_ms": 3.500440062115448, "mean_inference_ms": 2.031451276274683}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1470, "num_steps_trained": 73776128, "num_steps_sampled": 50149376, "sample_throughput": 0.0, "train_throughput": 23143.98, "num_weight_syncs": 153, "num_samples_dropped": 309, "learner_queue": {"size_count": 10116, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.104, "replay_time_ms": 110.362, "update_priorities_time_ms": 51.04, "policy_agent_0": {"added_count": 16896, "sampled_count": 24576, "est_size_bytes": 22016024, "num_entries": 16896}, "policy_agent_1": {"added_count": 16896, "sampled_count": 24576, "est_size_bytes": 22016024, "num_entries": 16896}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4088175296783447, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48802512884140015, "model": {}}}}, "timesteps_this_iter": 78592, "done": false, "timesteps_total": 50149376, "episodes_total": 501520, "training_iteration": 512, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-04-28", "timestamp": 1569074668, "time_this_iter_s": 30.566434383392334, "time_total_s": 15647.530169010162, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a4840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 30.566434383392334, "timesteps_since_restore": 78592, "iterations_since_restore": 1, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.05239744774796, "episode_reward_min": 43.77413681657424, "episode_reward_mean": 47.74189910475975, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 24.82945596158069, "agent_1": 22.912443143179075}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.616571972673785, "mean_processing_ms": 3.5021757173375896, "mean_inference_ms": 2.131407724773221}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1473, "num_steps_trained": 73926144, "num_steps_sampled": 50245632, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 341, "num_samples_dropped": 309, "learner_queue": {"size_count": 10702, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.295, "replay_time_ms": 106.542, "update_priorities_time_ms": 57.675, "policy_agent_0": {"added_count": 39424, "sampled_count": 60416, "est_size_bytes": 51370736, "num_entries": 39424}, "policy_agent_1": {"added_count": 39424, "sampled_count": 60416, "est_size_bytes": 51370736, "num_entries": 39424}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48344242572784424, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5760908126831055, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 50245632, "episodes_total": 502488, "training_iteration": 513, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-04-58", "timestamp": 1569074698, "time_this_iter_s": 30.53524351119995, "time_total_s": 15678.065412521362, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4b7950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 61.101677894592285, "timesteps_since_restore": 174848, "iterations_since_restore": 2, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.876730210509606, "episode_reward_min": 44.91859928033322, "episode_reward_mean": 53.76957666670484, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 30.932302141153208, "agent_1": 22.83727452555165}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6257653390243373, "mean_processing_ms": 3.4993957097496295, "mean_inference_ms": 2.1413056884906405}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1476, "num_steps_trained": 74076928, "num_steps_sampled": 50341376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 528, "num_samples_dropped": 309, "learner_queue": {"size_count": 11291, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.477, "replay_time_ms": 103.043, "update_priorities_time_ms": 54.26, "policy_agent_0": {"added_count": 61696, "sampled_count": 97536, "est_size_bytes": 80391692, "num_entries": 61696}, "policy_agent_1": {"added_count": 61696, "sampled_count": 97536, "est_size_bytes": 80391692, "num_entries": 61696}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46577316522598267, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6367763876914978, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 50341376, "episodes_total": 503440, "training_iteration": 514, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-05-29", "timestamp": 1569074729, "time_this_iter_s": 30.553410291671753, "time_total_s": 15708.618822813034, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c498e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 91.65508818626404, "timesteps_since_restore": 270592, "iterations_since_restore": 3, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.41787094730189, "episode_reward_min": 47.85371917931107, "episode_reward_mean": 54.41172073844221, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 32.06321106796224, "agent_1": 22.348509670480006}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6370446277150467, "mean_processing_ms": 3.514318993700559, "mean_inference_ms": 2.1303515716939585}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1478, "num_steps_trained": 74220544, "num_steps_sampled": 50438144, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 716, "num_samples_dropped": 309, "learner_queue": {"size_count": 11851, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.819, "replay_time_ms": 109.388, "update_priorities_time_ms": 53.081, "policy_agent_0": {"added_count": 86016, "sampled_count": 132608, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 86016, "sampled_count": 132608, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4402462840080261, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7038611769676208, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 50438144, "episodes_total": 504408, "training_iteration": 515, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-05-59", "timestamp": 1569074759, "time_this_iter_s": 30.572874069213867, "time_total_s": 15739.191696882248, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44fea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 122.2279622554779, "timesteps_since_restore": 367360, "iterations_since_restore": 4, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 52.1854375724492, "episode_reward_min": 48.47001943654116, "episode_reward_mean": 50.77792802168452, "episode_len_mean": 100.0, "episodes_this_iter": 920, "policy_reward_mean": {"agent_0": 32.41076870376826, "agent_1": 18.36715931791626}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6424595407702415, "mean_processing_ms": 3.5342933375535206, "mean_inference_ms": 2.157014792279809}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1481, "num_steps_trained": 74372608, "num_steps_sampled": 50530816, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 898, "num_samples_dropped": 309, "learner_queue": {"size_count": 12445, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 26.845, "replay_time_ms": 126.397, "update_priorities_time_ms": 54.916, "policy_agent_0": {"added_count": 107776, "sampled_count": 170496, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 107776, "sampled_count": 170496, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3327442407608032, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7860128283500671, "model": {}}}}, "timesteps_this_iter": 92672, "done": false, "timesteps_total": 50530816, "episodes_total": 505328, "training_iteration": 516, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-06-30", "timestamp": 1569074790, "time_this_iter_s": 30.57327938079834, "time_total_s": 15769.764976263046, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c461400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 152.80124163627625, "timesteps_since_restore": 460032, "iterations_since_restore": 5, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 51.18160021708656, "episode_reward_min": 46.539155722907104, "episode_reward_mean": 49.909556053422676, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 29.087172559729076, "agent_1": 20.822383493693632}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6445358307561752, "mean_processing_ms": 3.5319370978692906, "mean_inference_ms": 2.1470787052115505}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1484, "num_steps_trained": 74517760, "num_steps_sampled": 50627072, "sample_throughput": 9688.231, "train_throughput": 4844.116, "num_weight_syncs": 1086, "num_samples_dropped": 309, "learner_queue": {"size_count": 13012, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.525, "replay_time_ms": 110.552, "update_priorities_time_ms": 66.574, "policy_agent_0": {"added_count": 131584, "sampled_count": 204800, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 131584, "sampled_count": 204800, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30187052488327026, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8327842950820923, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 50627072, "episodes_total": 506288, "training_iteration": 517, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-07-01", "timestamp": 1569074821, "time_this_iter_s": 30.691812992095947, "time_total_s": 15800.456789255142, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 183.4930546283722, "timesteps_since_restore": 556288, "iterations_since_restore": 6, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.272832642382866, "episode_reward_min": 44.21109826435549, "episode_reward_mean": 50.02139950900576, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.45976694670993, "agent_1": 21.56163256229589}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.644082718829323, "mean_processing_ms": 3.519983810364967, "mean_inference_ms": 2.1284111256154237}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1487, "num_steps_trained": 74654976, "num_steps_sampled": 50726656, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1280, "num_samples_dropped": 309, "learner_queue": {"size_count": 13549, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.966, "replay_time_ms": 89.022, "update_priorities_time_ms": 49.793, "policy_agent_0": {"added_count": 159232, "sampled_count": 237312, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 159232, "sampled_count": 237312, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31213170289993286, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.860711932182312, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 50726656, "episodes_total": 507280, "training_iteration": 518, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-07-31", "timestamp": 1569074851, "time_this_iter_s": 30.4717276096344, "time_total_s": 15830.928516864777, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 213.9647822380066, "timesteps_since_restore": 655872, "iterations_since_restore": 7, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.84091967056634, "episode_reward_min": 46.59768233703526, "episode_reward_mean": 50.33450992056153, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.09506938506159, "agent_1": 23.239440535499963}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6467271250848332, "mean_processing_ms": 3.5245604916716347, "mean_inference_ms": 2.1283674141060045}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1490, "num_steps_trained": 74796288, "num_steps_sampled": 50823680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1469, "num_samples_dropped": 309, "learner_queue": {"size_count": 14100, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.565, "replay_time_ms": 117.705, "update_priorities_time_ms": 54.686, "policy_agent_0": {"added_count": 180480, "sampled_count": 273152, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 180480, "sampled_count": 273152, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36946043372154236, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8573983907699585, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 50823680, "episodes_total": 508264, "training_iteration": 519, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-08-02", "timestamp": 1569074882, "time_this_iter_s": 30.452929973602295, "time_total_s": 15861.381446838379, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c481158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 244.4177122116089, "timesteps_since_restore": 752896, "iterations_since_restore": 8, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 51.57533003375824, "episode_reward_min": 45.90465642200699, "episode_reward_mean": 47.19121874788397, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 25.333859874521703, "agent_1": 21.85735887336225}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6507088280519779, "mean_processing_ms": 3.529623867043564, "mean_inference_ms": 2.1296819037941495}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1493, "num_steps_trained": 74938624, "num_steps_sampled": 50918912, "sample_throughput": 0.0, "train_throughput": 16242.729, "num_weight_syncs": 1656, "num_samples_dropped": 309, "learner_queue": {"size_count": 14656, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.291, "replay_time_ms": 104.786, "update_priorities_time_ms": 54.225, "policy_agent_0": {"added_count": 203264, "sampled_count": 306688, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 203264, "sampled_count": 306688, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39955058693885803, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.843846321105957, "model": {}}}}, "timesteps_this_iter": 95232, "done": false, "timesteps_total": 50918912, "episodes_total": 509216, "training_iteration": 520, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-08-32", "timestamp": 1569074912, "time_this_iter_s": 30.59134817123413, "time_total_s": 15891.972795009613, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c40b620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 275.009060382843, "timesteps_since_restore": 848128, "iterations_since_restore": 9, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 50.06410590293912, "episode_reward_min": 46.653426537933825, "episode_reward_mean": 47.87994360883646, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 26.196298142784453, "agent_1": 21.683645466051985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6513092610891461, "mean_processing_ms": 3.5337092166957427, "mean_inference_ms": 2.129678158811202}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1496, "num_steps_trained": 75083520, "num_steps_sampled": 51014656, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1842, "num_samples_dropped": 309, "learner_queue": {"size_count": 15222, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.184, "replay_time_ms": 110.668, "update_priorities_time_ms": 55.148, "policy_agent_0": {"added_count": 230656, "sampled_count": 340992, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 230656, "sampled_count": 340992, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42772865295410156, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8320064544677734, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 51014656, "episodes_total": 510176, "training_iteration": 521, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-09-03", "timestamp": 1569074943, "time_this_iter_s": 30.593660593032837, "time_total_s": 15922.566455602646, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c429048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 305.60272097587585, "timesteps_since_restore": 943872, "iterations_since_restore": 10, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 51.29811894148694, "episode_reward_min": 45.43557749621119, "episode_reward_mean": 47.79081397388794, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 27.283125779303194, "agent_1": 20.507688194584787}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6516163346584517, "mean_processing_ms": 3.535974648295965, "mean_inference_ms": 2.125111355416734}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1498, "num_steps_trained": 75225856, "num_steps_sampled": 51110912, "sample_throughput": 9973.452, "train_throughput": 0.0, "num_weight_syncs": 2031, "num_samples_dropped": 309, "learner_queue": {"size_count": 15780, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.847, "replay_time_ms": 83.056, "update_priorities_time_ms": 44.369, "policy_agent_0": {"added_count": 255744, "sampled_count": 378368, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 255744, "sampled_count": 378368, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4465508460998535, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.84883713722229, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 51110912, "episodes_total": 511128, "training_iteration": 522, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-09-34", "timestamp": 1569074974, "time_this_iter_s": 30.500509023666382, "time_total_s": 15953.066964626312, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469f28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 336.10322999954224, "timesteps_since_restore": 1040128, "iterations_since_restore": 11, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.33015063562346, "episode_reward_min": 45.17475039860558, "episode_reward_mean": 47.89374524271146, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 25.872913594177344, "agent_1": 22.020831648534145}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6528282269025273, "mean_processing_ms": 3.5428741553513303, "mean_inference_ms": 2.131841087353161}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1501, "num_steps_trained": 75372800, "num_steps_sampled": 51205376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2215, "num_samples_dropped": 309, "learner_queue": {"size_count": 16352, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.98, "replay_time_ms": 107.839, "update_priorities_time_ms": 53.071, "policy_agent_0": {"added_count": 278272, "sampled_count": 413440, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 278272, "sampled_count": 413440, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43564456701278687, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8388475179672241, "model": {}}}}, "timesteps_this_iter": 94464, "done": false, "timesteps_total": 51205376, "episodes_total": 512088, "training_iteration": 523, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-10-04", "timestamp": 1569075004, "time_this_iter_s": 30.590065479278564, "time_total_s": 15983.65703010559, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4e82f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 366.6932954788208, "timesteps_since_restore": 1134592, "iterations_since_restore": 12, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.360576057244, "episode_reward_min": 44.45947536216782, "episode_reward_mean": 51.7260726931072, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.115532799018055, "agent_1": 23.610539894089296}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6529123547604034, "mean_processing_ms": 3.5420746388229216, "mean_inference_ms": 2.1252526973554873}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1504, "num_steps_trained": 75511552, "num_steps_sampled": 51303680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2407, "num_samples_dropped": 309, "learner_queue": {"size_count": 16894, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.545, "replay_time_ms": 99.384, "update_priorities_time_ms": 48.818, "policy_agent_0": {"added_count": 301568, "sampled_count": 450048, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 301568, "sampled_count": 450048, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43047666549682617, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8527472615242004, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 51303680, "episodes_total": 513064, "training_iteration": 524, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-10-35", "timestamp": 1569075035, "time_this_iter_s": 30.695409536361694, "time_total_s": 16014.352439641953, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4dec80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 397.3887050151825, "timesteps_since_restore": 1232896, "iterations_since_restore": 13, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.952568911733096, "episode_reward_min": 54.50814677881529, "episode_reward_mean": 55.296942940659086, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 30.31144845625196, "agent_1": 24.985494484407386}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6524915918985356, "mean_processing_ms": 3.5382875945559245, "mean_inference_ms": 2.1239445843921274}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1507, "num_steps_trained": 75651584, "num_steps_sampled": 51400192, "sample_throughput": 7534.29, "train_throughput": 0.0, "num_weight_syncs": 2596, "num_samples_dropped": 309, "learner_queue": {"size_count": 17442, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.214, "replay_time_ms": 107.84, "update_priorities_time_ms": 54.95, "policy_agent_0": {"added_count": 329216, "sampled_count": 484096, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 329216, "sampled_count": 484096, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41203993558883667, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8383153676986694, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 51400192, "episodes_total": 514024, "training_iteration": 525, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-11-06", "timestamp": 1569075066, "time_this_iter_s": 30.59818458557129, "time_total_s": 16044.950624227524, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c461a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 427.9868896007538, "timesteps_since_restore": 1329408, "iterations_since_restore": 14, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.70960769066687, "episode_reward_min": 54.743809162316374, "episode_reward_mean": 55.218671777993784, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 30.088375752152665, "agent_1": 25.130296025841382}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6528146319309222, "mean_processing_ms": 3.541250513318112, "mean_inference_ms": 2.124811088456469}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1510, "num_steps_trained": 75791616, "num_steps_sampled": 51496192, "sample_throughput": 10506.743, "train_throughput": 5253.371, "num_weight_syncs": 2783, "num_samples_dropped": 309, "learner_queue": {"size_count": 17989, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.251, "replay_time_ms": 112.164, "update_priorities_time_ms": 54.393, "policy_agent_0": {"added_count": 354560, "sampled_count": 516352, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 354560, "sampled_count": 516352, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3786112666130066, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7882299423217773, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 51496192, "episodes_total": 514992, "training_iteration": 526, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-11-36", "timestamp": 1569075096, "time_this_iter_s": 30.573863744735718, "time_total_s": 16075.52448797226, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c45b6a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 458.5607533454895, "timesteps_since_restore": 1425408, "iterations_since_restore": 15, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.48058817916317, "episode_reward_min": 52.591660755457504, "episode_reward_mean": 54.91724986934419, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 30.33160390866568, "agent_1": 24.58564596067868}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509604012261665, "mean_processing_ms": 3.537423844061892, "mean_inference_ms": 2.128661189914499}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1513, "num_steps_trained": 75933952, "num_steps_sampled": 51593472, "sample_throughput": 6326.847, "train_throughput": 6326.847, "num_weight_syncs": 2973, "num_samples_dropped": 309, "learner_queue": {"size_count": 18544, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.628, "replay_time_ms": 106.849, "update_priorities_time_ms": 53.558, "policy_agent_0": {"added_count": 376064, "sampled_count": 551168, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 376064, "sampled_count": 551168, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34798216819763184, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7368860244750977, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 51593472, "episodes_total": 515968, "training_iteration": 527, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-12-07", "timestamp": 1569075127, "time_this_iter_s": 30.60756230354309, "time_total_s": 16106.132050275803, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44fb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 489.1683156490326, "timesteps_since_restore": 1522688, "iterations_since_restore": 16, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.515504589949046, "episode_reward_min": 53.29267814646138, "episode_reward_mean": 60.87999745286256, "episode_len_mean": 100.0, "episodes_this_iter": 928, "policy_reward_mean": {"agent_0": 34.69277525817398, "agent_1": 26.187222194688605}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6524503819747017, "mean_processing_ms": 3.5421550046885217, "mean_inference_ms": 2.1323073922860596}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1515, "num_steps_trained": 76077312, "num_steps_sampled": 51687168, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3156, "num_samples_dropped": 309, "learner_queue": {"size_count": 19104, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.667, "replay_time_ms": 113.382, "update_priorities_time_ms": 59.147, "policy_agent_0": {"added_count": 399104, "sampled_count": 585728, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 399104, "sampled_count": 585728, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30936118960380554, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7179839611053467, "model": {}}}}, "timesteps_this_iter": 93696, "done": false, "timesteps_total": 51687168, "episodes_total": 516896, "training_iteration": 528, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-12-37", "timestamp": 1569075157, "time_this_iter_s": 30.617254972457886, "time_total_s": 16136.74930524826, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a27b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 519.7855706214905, "timesteps_since_restore": 1616384, "iterations_since_restore": 17, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.87335166248441, "episode_reward_min": 57.33426940813747, "episode_reward_mean": 61.226468509939295, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 32.91666104185125, "agent_1": 28.309807468088085}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6543019810215729, "mean_processing_ms": 3.5500495481104046, "mean_inference_ms": 2.1339195638271424}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1518, "num_steps_trained": 76222208, "num_steps_sampled": 51780608, "sample_throughput": 0.0, "train_throughput": 11509.35, "num_weight_syncs": 3339, "num_samples_dropped": 309, "learner_queue": {"size_count": 19670, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.874, "replay_time_ms": 108.555, "update_priorities_time_ms": 61.817, "policy_agent_0": {"added_count": 424448, "sampled_count": 620800, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 424448, "sampled_count": 620800, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.28332528471946716, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6398706436157227, "model": {}}}}, "timesteps_this_iter": 93440, "done": false, "timesteps_total": 51780608, "episodes_total": 517840, "training_iteration": 529, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-13-08", "timestamp": 1569075188, "time_this_iter_s": 30.5679452419281, "time_total_s": 16167.317250490189, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4b7c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 550.3535158634186, "timesteps_since_restore": 1709824, "iterations_since_restore": 18, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.472090426230515, "episode_reward_min": 49.179102130138105, "episode_reward_mean": 60.95794103338008, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 32.37971932623581, "agent_1": 28.578221707144326}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6537271079963802, "mean_processing_ms": 3.551603890037869, "mean_inference_ms": 2.133833437561133}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1521, "num_steps_trained": 76360960, "num_steps_sampled": 51877120, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3526, "num_samples_dropped": 309, "learner_queue": {"size_count": 20212, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.349, "replay_time_ms": 129.331, "update_priorities_time_ms": 65.633, "policy_agent_0": {"added_count": 449024, "sampled_count": 654592, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 449024, "sampled_count": 654592, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2631382644176483, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5760781764984131, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 51877120, "episodes_total": 518808, "training_iteration": 530, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-13-39", "timestamp": 1569075219, "time_this_iter_s": 30.66821575164795, "time_total_s": 16197.985466241837, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c49a8c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 581.0217316150665, "timesteps_since_restore": 1806336, "iterations_since_restore": 19, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.37256548875665, "episode_reward_min": 49.292089671026915, "episode_reward_mean": 60.29394755967385, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 31.84629974508485, "agent_1": 28.447647814589097}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6534115865014299, "mean_processing_ms": 3.5519408476340675, "mean_inference_ms": 2.1349708903148668}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1524, "num_steps_trained": 76501760, "num_steps_sampled": 51973632, "sample_throughput": 6326.567, "train_throughput": 3163.284, "num_weight_syncs": 3716, "num_samples_dropped": 309, "learner_queue": {"size_count": 20762, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 47.181, "replay_time_ms": 110.704, "update_priorities_time_ms": 56.922, "policy_agent_0": {"added_count": 471296, "sampled_count": 690944, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 471296, "sampled_count": 690944, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2622753083705902, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4972565472126007, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 51973632, "episodes_total": 519760, "training_iteration": 531, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-14-09", "timestamp": 1569075249, "time_this_iter_s": 30.55113434791565, "time_total_s": 16228.536600589752, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c430d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 611.5728659629822, "timesteps_since_restore": 1902848, "iterations_since_restore": 20, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.44570740094511, "episode_reward_min": 46.17403740050905, "episode_reward_mean": 56.84377250942817, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 30.42736900285424, "agent_1": 26.416403506573957}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526608530520122, "mean_processing_ms": 3.547031273104214, "mean_inference_ms": 2.1309407308259916}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1527, "num_steps_trained": 76639232, "num_steps_sampled": 52072704, "sample_throughput": 0.0, "train_throughput": 11924.105, "num_weight_syncs": 3909, "num_samples_dropped": 309, "learner_queue": {"size_count": 21300, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.481, "replay_time_ms": 104.67, "update_priorities_time_ms": 55.1, "policy_agent_0": {"added_count": 498944, "sampled_count": 725248, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 498944, "sampled_count": 725248, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2956133484840393, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47737210988998413, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 52072704, "episodes_total": 520752, "training_iteration": 532, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-14-40", "timestamp": 1569075280, "time_this_iter_s": 30.656585216522217, "time_total_s": 16259.193185806274, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43a9d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 642.2294511795044, "timesteps_since_restore": 2001920, "iterations_since_restore": 21, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.86979307266443, "episode_reward_min": 44.511529075468616, "episode_reward_mean": 56.492287358458846, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 30.295457593889235, "agent_1": 26.196829764569664}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526651149165057, "mean_processing_ms": 3.547550672801462, "mean_inference_ms": 2.1309609940796936}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1530, "num_steps_trained": 76784384, "num_steps_sampled": 52168704, "sample_throughput": 19074.84, "train_throughput": 0.0, "num_weight_syncs": 4096, "num_samples_dropped": 309, "learner_queue": {"size_count": 21866, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.958, "replay_time_ms": 119.75, "update_priorities_time_ms": 58.0, "policy_agent_0": {"added_count": 519936, "sampled_count": 762112, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 519936, "sampled_count": 762112, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31844234466552734, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4948843717575073, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 52168704, "episodes_total": 521712, "training_iteration": 533, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-15-11", "timestamp": 1569075311, "time_this_iter_s": 30.64593243598938, "time_total_s": 16289.839118242264, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43fea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 672.8753836154938, "timesteps_since_restore": 2097920, "iterations_since_restore": 22, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.408813618165496, "episode_reward_min": 54.78454722316321, "episode_reward_mean": 57.245128337045124, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 32.38825544603562, "agent_1": 24.856872891009523}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6535880468522476, "mean_processing_ms": 3.5503322225383087, "mean_inference_ms": 2.1330560108405088}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1532, "num_steps_trained": 76929280, "num_steps_sampled": 52263936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4283, "num_samples_dropped": 309, "learner_queue": {"size_count": 22432, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 27.907, "replay_time_ms": 118.548, "update_priorities_time_ms": 57.767, "policy_agent_0": {"added_count": 541440, "sampled_count": 798208, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 541440, "sampled_count": 798208, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3311837911605835, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5329221487045288, "model": {}}}}, "timesteps_this_iter": 95232, "done": false, "timesteps_total": 52263936, "episodes_total": 522664, "training_iteration": 534, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-15-41", "timestamp": 1569075341, "time_this_iter_s": 30.588156700134277, "time_total_s": 16320.427274942398, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c445ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 703.463540315628, "timesteps_since_restore": 2193152, "iterations_since_restore": 23, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.89645979372658, "episode_reward_min": 52.3651000284984, "episode_reward_mean": 57.429917846649765, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 32.21403333798413, "agent_1": 25.215884508665656}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653100351054112, "mean_processing_ms": 3.5468674333992194, "mean_inference_ms": 2.130410466524089}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1535, "num_steps_trained": 77068288, "num_steps_sampled": 52361984, "sample_throughput": 7191.841, "train_throughput": 7191.841, "num_weight_syncs": 4475, "num_samples_dropped": 309, "learner_queue": {"size_count": 22975, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.457, "replay_time_ms": 112.848, "update_priorities_time_ms": 53.641, "policy_agent_0": {"added_count": 565248, "sampled_count": 833280, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 565248, "sampled_count": 833280, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3122398853302002, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5663036704063416, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 52361984, "episodes_total": 523640, "training_iteration": 535, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-16-12", "timestamp": 1569075372, "time_this_iter_s": 30.607046365737915, "time_total_s": 16351.034321308136, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cf048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 734.070586681366, "timesteps_since_restore": 2291200, "iterations_since_restore": 24, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.33730376244559, "episode_reward_min": 50.20127676395586, "episode_reward_mean": 57.608630837218676, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 30.99538330348539, "agent_1": 26.613247533733283}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533730582106407, "mean_processing_ms": 3.547747822950628, "mean_inference_ms": 2.1262852227555604}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1538, "num_steps_trained": 77204992, "num_steps_sampled": 52460288, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4666, "num_samples_dropped": 309, "learner_queue": {"size_count": 23510, "size_mean": 0.2, "size_std": 0.4898979485566357, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.389, "replay_time_ms": 91.612, "update_priorities_time_ms": 53.231, "policy_agent_0": {"added_count": 586496, "sampled_count": 865024, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 586496, "sampled_count": 865024, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2877848744392395, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5743082761764526, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 52460288, "episodes_total": 524632, "training_iteration": 536, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-16-43", "timestamp": 1569075403, "time_this_iter_s": 30.57026720046997, "time_total_s": 16381.604588508606, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cfbf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 764.6408538818359, "timesteps_since_restore": 2389504, "iterations_since_restore": 25, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.339487436908264, "episode_reward_min": 56.37188016244682, "episode_reward_mean": 60.18347334003992, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 32.26318426287267, "agent_1": 27.92028907716726}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6534704877337799, "mean_processing_ms": 3.550137136914874, "mean_inference_ms": 2.1263375461893834}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1541, "num_steps_trained": 77348864, "num_steps_sampled": 52556544, "sample_throughput": 0.0, "train_throughput": 18200.556, "num_weight_syncs": 4854, "num_samples_dropped": 309, "learner_queue": {"size_count": 24071, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.575, "replay_time_ms": 113.711, "update_priorities_time_ms": 55.987, "policy_agent_0": {"added_count": 608256, "sampled_count": 900608, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 608256, "sampled_count": 900608, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2919125258922577, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5356038212776184, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 52556544, "episodes_total": 525592, "training_iteration": 537, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-17-13", "timestamp": 1569075433, "time_this_iter_s": 30.61548662185669, "time_total_s": 16412.220075130463, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f2158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 795.2563405036926, "timesteps_since_restore": 2485760, "iterations_since_restore": 26, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.318600788676044, "episode_reward_min": 55.7333960475977, "episode_reward_mean": 59.438932350132134, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 31.085843095298216, "agent_1": 28.35308925483395}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6531111396767745, "mean_processing_ms": 3.5469729339060074, "mean_inference_ms": 2.125455131062796}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1544, "num_steps_trained": 77488128, "num_steps_sampled": 52654336, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5045, "num_samples_dropped": 309, "learner_queue": {"size_count": 24615, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.003, "replay_time_ms": 96.024, "update_priorities_time_ms": 40.109, "policy_agent_0": {"added_count": 629248, "sampled_count": 937728, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 629248, "sampled_count": 937728, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.28214821219444275, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4782370626926422, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 52654336, "episodes_total": 526568, "training_iteration": 538, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-17-44", "timestamp": 1569075464, "time_this_iter_s": 30.54452633857727, "time_total_s": 16442.76460146904, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f2d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 825.8008668422699, "timesteps_since_restore": 2583552, "iterations_since_restore": 27, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.34290968570036, "episode_reward_min": 58.37897993470369, "episode_reward_mean": 60.30842537893526, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 31.78053876008104, "agent_1": 28.527886618854257}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6534982658656681, "mean_processing_ms": 3.5483690775978185, "mean_inference_ms": 2.1266712680686357}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1546, "num_steps_trained": 77630976, "num_steps_sampled": 52750080, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5232, "num_samples_dropped": 309, "learner_queue": {"size_count": 25175, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.371, "replay_time_ms": 96.185, "update_priorities_time_ms": 50.479, "policy_agent_0": {"added_count": 650496, "sampled_count": 973056, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 650496, "sampled_count": 973056, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2916944622993469, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4531519412994385, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 52750080, "episodes_total": 527520, "training_iteration": 539, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-18-14", "timestamp": 1569075494, "time_this_iter_s": 30.596558570861816, "time_total_s": 16473.3611600399, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c404268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 856.3974254131317, "timesteps_since_restore": 2679296, "iterations_since_restore": 28, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.9976026620978, "episode_reward_min": 58.150219840331225, "episode_reward_mean": 60.43784656164329, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 32.171083726341934, "agent_1": 28.26676283530139}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533386659570171, "mean_processing_ms": 3.548905922886891, "mean_inference_ms": 2.124202637522516}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1549, "num_steps_trained": 77770240, "num_steps_sampled": 52847872, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5423, "num_samples_dropped": 309, "learner_queue": {"size_count": 25717, "size_mean": 0.28, "size_std": 0.6645299090334459, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 47.039, "replay_time_ms": 104.836, "update_priorities_time_ms": 56.341, "policy_agent_0": {"added_count": 674560, "sampled_count": 1006080, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 674560, "sampled_count": 1006080, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2985309362411499, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4257509708404541, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 52847872, "episodes_total": 528512, "training_iteration": 540, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-18-45", "timestamp": 1569075525, "time_this_iter_s": 30.54247498512268, "time_total_s": 16503.903635025024, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c404e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 886.9399003982544, "timesteps_since_restore": 2777088, "iterations_since_restore": 29, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.9742194332801, "episode_reward_min": 57.807063582599156, "episode_reward_mean": 60.55919253289926, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 31.800945354779472, "agent_1": 28.758247178119856}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6530838951233162, "mean_processing_ms": 3.548702506961857, "mean_inference_ms": 2.124466243910528}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1552, "num_steps_trained": 77913088, "num_steps_sampled": 52943360, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5609, "num_samples_dropped": 309, "learner_queue": {"size_count": 26276, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.012, "replay_time_ms": 102.728, "update_priorities_time_ms": 54.862, "policy_agent_0": {"added_count": 699392, "sampled_count": 1043456, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 699392, "sampled_count": 1043456, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2917012572288513, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3906756341457367, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 52943360, "episodes_total": 529464, "training_iteration": 541, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-19-16", "timestamp": 1569075556, "time_this_iter_s": 30.64045262336731, "time_total_s": 16534.54408764839, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39fbf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 917.5803530216217, "timesteps_since_restore": 2872576, "iterations_since_restore": 30, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.39876279222443, "episode_reward_min": 58.24671364556101, "episode_reward_mean": 60.6337561570451, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 31.76676430568077, "agent_1": 28.866991851364407}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6529579337565916, "mean_processing_ms": 3.5499928495279494, "mean_inference_ms": 2.124283672995345}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1555, "num_steps_trained": 78056192, "num_steps_sampled": 53039360, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5798, "num_samples_dropped": 309, "learner_queue": {"size_count": 26835, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.47, "replay_time_ms": 102.408, "update_priorities_time_ms": 52.802, "policy_agent_0": {"added_count": 726272, "sampled_count": 1077504, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 726272, "sampled_count": 1077504, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2741595208644867, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.396908700466156, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 53039360, "episodes_total": 530424, "training_iteration": 542, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-19-46", "timestamp": 1569075586, "time_this_iter_s": 30.56597399711609, "time_total_s": 16565.110061645508, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ad1e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 948.1463270187378, "timesteps_since_restore": 2968576, "iterations_since_restore": 31, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.364967647058414, "episode_reward_min": 48.846910278309245, "episode_reward_mean": 60.31856771706841, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 31.664798543290782, "agent_1": 28.653769173777686}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6523756129956986, "mean_processing_ms": 3.5468435830829015, "mean_inference_ms": 2.122655845020333}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1558, "num_steps_trained": 78195456, "num_steps_sampled": 53138176, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5990, "num_samples_dropped": 309, "learner_queue": {"size_count": 27378, "size_mean": 0.26, "size_std": 0.626418390534633, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 31.133, "replay_time_ms": 100.346, "update_priorities_time_ms": 50.464, "policy_agent_0": {"added_count": 752640, "sampled_count": 1113088, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 752640, "sampled_count": 1113088, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29138556122779846, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3858295977115631, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 53138176, "episodes_total": 531400, "training_iteration": 543, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-20-17", "timestamp": 1569075617, "time_this_iter_s": 30.549467086791992, "time_total_s": 16595.6595287323, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b4048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 978.6957941055298, "timesteps_since_restore": 3067392, "iterations_since_restore": 32, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.37426271799181, "episode_reward_min": 54.54536068421501, "episode_reward_mean": 60.66518936533728, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 31.637745321464163, "agent_1": 29.027444043873192}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6524438650288262, "mean_processing_ms": 3.546511423388386, "mean_inference_ms": 2.1227741155725526}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1560, "num_steps_trained": 78337024, "num_steps_sampled": 53234176, "sample_throughput": 13859.562, "train_throughput": 0.0, "num_weight_syncs": 6177, "num_samples_dropped": 309, "learner_queue": {"size_count": 27931, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 26.903, "replay_time_ms": 94.442, "update_priorities_time_ms": 56.492, "policy_agent_0": {"added_count": 778752, "sampled_count": 1148416, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 778752, "sampled_count": 1148416, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2675328254699707, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3841288685798645, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 53234176, "episodes_total": 532368, "training_iteration": 544, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-20-48", "timestamp": 1569075648, "time_this_iter_s": 30.634955167770386, "time_total_s": 16626.29448390007, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1009.3307492733002, "timesteps_since_restore": 3163392, "iterations_since_restore": 33, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.345147633073495, "episode_reward_min": 48.40756072890762, "episode_reward_mean": 58.504557903295776, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 30.145224035570415, "agent_1": 28.35933386772542}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6529901467583472, "mean_processing_ms": 3.5464509227523857, "mean_inference_ms": 2.1217920917032047}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1563, "num_steps_trained": 78475520, "num_steps_sampled": 53331712, "sample_throughput": 0.0, "train_throughput": 31437.325, "num_weight_syncs": 6368, "num_samples_dropped": 309, "learner_queue": {"size_count": 28472, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.715, "replay_time_ms": 103.516, "update_priorities_time_ms": 56.628, "policy_agent_0": {"added_count": 801024, "sampled_count": 1183744, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 801024, "sampled_count": 1183744, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2956465482711792, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3849635720252991, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 53331712, "episodes_total": 533352, "training_iteration": 545, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-21-18", "timestamp": 1569075678, "time_this_iter_s": 30.5072660446167, "time_total_s": 16656.801749944687, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39f0d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1039.8380153179169, "timesteps_since_restore": 3260928, "iterations_since_restore": 34, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.336432898877554, "episode_reward_min": 53.44481545812607, "episode_reward_mean": 59.61816789502948, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 30.86229150550531, "agent_1": 28.755876389524122}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6528374226825708, "mean_processing_ms": 3.547882632141603, "mean_inference_ms": 2.1240403329488045}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1566, "num_steps_trained": 78617088, "num_steps_sampled": 53427456, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6555, "num_samples_dropped": 309, "learner_queue": {"size_count": 29026, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.614, "replay_time_ms": 111.332, "update_priorities_time_ms": 50.258, "policy_agent_0": {"added_count": 828160, "sampled_count": 1216768, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 828160, "sampled_count": 1216768, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2931947112083435, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3773730397224426, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 53427456, "episodes_total": 534304, "training_iteration": 546, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-21-49", "timestamp": 1569075709, "time_this_iter_s": 30.621665954589844, "time_total_s": 16687.423415899277, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3eaea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1070.4596812725067, "timesteps_since_restore": 3356672, "iterations_since_restore": 35, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.330506399752096, "episode_reward_min": 52.72354049124835, "episode_reward_mean": 59.4354411491324, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 30.66668375448887, "agent_1": 28.76875739464351}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6527679234759958, "mean_processing_ms": 3.5483451934115413, "mean_inference_ms": 2.1232005912925085}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1569, "num_steps_trained": 78756352, "num_steps_sampled": 53524480, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6745, "num_samples_dropped": 309, "learner_queue": {"size_count": 29569, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.485, "replay_time_ms": 106.669, "update_priorities_time_ms": 55.229, "policy_agent_0": {"added_count": 852224, "sampled_count": 1250048, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 852224, "sampled_count": 1250048, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.316897988319397, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4095710217952728, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 53524480, "episodes_total": 535272, "training_iteration": 547, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-22-19", "timestamp": 1569075739, "time_this_iter_s": 30.480318784713745, "time_total_s": 16717.90373468399, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1100.9400000572205, "timesteps_since_restore": 3453696, "iterations_since_restore": 36, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.420084529909104, "episode_reward_min": 46.44038844927527, "episode_reward_mean": 58.580323090054186, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 30.400474651146506, "agent_1": 28.179848438907687}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6523106958396401, "mean_processing_ms": 3.5473060629372077, "mean_inference_ms": 2.1225574742165807}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1572, "num_steps_trained": 78895872, "num_steps_sampled": 53622528, "sample_throughput": 35439.363, "train_throughput": 0.0, "num_weight_syncs": 6935, "num_samples_dropped": 309, "learner_queue": {"size_count": 30114, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.331, "replay_time_ms": 118.026, "update_priorities_time_ms": 58.053, "policy_agent_0": {"added_count": 872960, "sampled_count": 1285376, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 872960, "sampled_count": 1285376, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3290683627128601, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39051553606987, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 53622528, "episodes_total": 536248, "training_iteration": 548, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-22-50", "timestamp": 1569075770, "time_this_iter_s": 30.62069845199585, "time_total_s": 16748.524433135986, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4de620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1131.5606985092163, "timesteps_since_restore": 3551744, "iterations_since_restore": 37, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.97296471760535, "episode_reward_min": 51.630949107575006, "episode_reward_mean": 57.388529593088805, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 28.765684853316987, "agent_1": 28.622844739771793}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533205756181225, "mean_processing_ms": 3.5491701886022913, "mean_inference_ms": 2.123729541883073}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1574, "num_steps_trained": 79040000, "num_steps_sampled": 53717760, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7123, "num_samples_dropped": 309, "learner_queue": {"size_count": 30678, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.521, "replay_time_ms": 113.059, "update_priorities_time_ms": 60.052, "policy_agent_0": {"added_count": 896256, "sampled_count": 1322496, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 896256, "sampled_count": 1322496, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31510573625564575, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3855123221874237, "model": {}}}}, "timesteps_this_iter": 95232, "done": false, "timesteps_total": 53717760, "episodes_total": 537208, "training_iteration": 549, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-23-21", "timestamp": 1569075801, "time_this_iter_s": 30.534321069717407, "time_total_s": 16779.058754205704, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c481400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1162.0950195789337, "timesteps_since_restore": 3646976, "iterations_since_restore": 38, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.997597496601486, "episode_reward_min": 53.835171494490694, "episode_reward_mean": 59.30427980894125, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 30.445954595652253, "agent_1": 28.858325213289}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6527038403350894, "mean_processing_ms": 3.5470661712600626, "mean_inference_ms": 2.1226224853010294}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1577, "num_steps_trained": 79180288, "num_steps_sampled": 53816064, "sample_throughput": 6006.947, "train_throughput": 0.0, "num_weight_syncs": 7314, "num_samples_dropped": 309, "learner_queue": {"size_count": 31225, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.314, "replay_time_ms": 95.598, "update_priorities_time_ms": 44.343, "policy_agent_0": {"added_count": 921344, "sampled_count": 1355776, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 921344, "sampled_count": 1355776, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3496406674385071, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.383893758058548, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 53816064, "episodes_total": 538192, "training_iteration": 550, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-23-51", "timestamp": 1569075831, "time_this_iter_s": 30.530018091201782, "time_total_s": 16809.588772296906, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1192.6250376701355, "timesteps_since_restore": 3745280, "iterations_since_restore": 39, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.69143092303147, "episode_reward_min": 57.1018199565127, "episode_reward_mean": 58.44091934124252, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 29.420926970302357, "agent_1": 29.01999237094014}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.652853880265096, "mean_processing_ms": 3.5477821564281316, "mean_inference_ms": 2.1236575495376746}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1580, "num_steps_trained": 79322368, "num_steps_sampled": 53912064, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7502, "num_samples_dropped": 309, "learner_queue": {"size_count": 31782, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.169, "replay_time_ms": 98.686, "update_priorities_time_ms": 51.126, "policy_agent_0": {"added_count": 942080, "sampled_count": 1391360, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 942080, "sampled_count": 1391360, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33920881152153015, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36873316764831543, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 53912064, "episodes_total": 539144, "training_iteration": 551, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-24-22", "timestamp": 1569075862, "time_this_iter_s": 30.54803967475891, "time_total_s": 16840.136811971664, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4730d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1223.1730773448944, "timesteps_since_restore": 3841280, "iterations_since_restore": 40, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.166100657680836, "episode_reward_min": 51.117801411506015, "episode_reward_mean": 56.45320123710423, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 27.826567832232204, "agent_1": 28.626633404872013}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6530973248938784, "mean_processing_ms": 3.5482927350747704, "mean_inference_ms": 2.1228872934217824}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1583, "num_steps_trained": 79461376, "num_steps_sampled": 54009344, "sample_throughput": 6324.313, "train_throughput": 6324.313, "num_weight_syncs": 7692, "num_samples_dropped": 309, "learner_queue": {"size_count": 32324, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.848, "replay_time_ms": 128.393, "update_priorities_time_ms": 62.342, "policy_agent_0": {"added_count": 966656, "sampled_count": 1425664, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 966656, "sampled_count": 1425664, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35929983854293823, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36913377046585083, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 54009344, "episodes_total": 540112, "training_iteration": 552, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-24-52", "timestamp": 1569075892, "time_this_iter_s": 30.677486181259155, "time_total_s": 16870.814298152924, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1253.8505635261536, "timesteps_since_restore": 3938560, "iterations_since_restore": 41, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.34439396483794, "episode_reward_min": 49.202808809673485, "episode_reward_mean": 57.24413674114425, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.481111191836444, "agent_1": 28.763025549307795}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532292296032466, "mean_processing_ms": 3.5464797394859584, "mean_inference_ms": 2.1216198304918303}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1586, "num_steps_trained": 79599104, "num_steps_sampled": 54107392, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7883, "num_samples_dropped": 309, "learner_queue": {"size_count": 32862, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.877, "replay_time_ms": 137.4, "update_priorities_time_ms": 58.409, "policy_agent_0": {"added_count": 992512, "sampled_count": 1458688, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 992512, "sampled_count": 1458688, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3753916323184967, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36539459228515625, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 54107392, "episodes_total": 541096, "training_iteration": 553, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-25-23", "timestamp": 1569075923, "time_this_iter_s": 30.59754467010498, "time_total_s": 16901.41184282303, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1284.4481081962585, "timesteps_since_restore": 4036608, "iterations_since_restore": 42, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.35260647767394, "episode_reward_min": 48.39501590283497, "episode_reward_mean": 56.872267769337526, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.73464561004763, "agent_1": 28.137622159289904}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6536419846072404, "mean_processing_ms": 3.5474547809232386, "mean_inference_ms": 2.1195989303777867}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1588, "num_steps_trained": 79738368, "num_steps_sampled": 54205440, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8075, "num_samples_dropped": 309, "learner_queue": {"size_count": 33405, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.889, "replay_time_ms": 108.363, "update_priorities_time_ms": 47.917, "policy_agent_0": {"added_count": 1014784, "sampled_count": 1493504, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1014784, "sampled_count": 1493504, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38374629616737366, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36253032088279724, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 54205440, "episodes_total": 542080, "training_iteration": 554, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-25-54", "timestamp": 1569075954, "time_this_iter_s": 30.57371473312378, "time_total_s": 16931.985557556152, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c5f28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1315.0218229293823, "timesteps_since_restore": 4134656, "iterations_since_restore": 43, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.230575804667545, "episode_reward_min": 46.63423105450056, "episode_reward_mean": 51.41244263184412, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.8742782942742, "agent_1": 24.53816433756993}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6537500584321384, "mean_processing_ms": 3.546356042243485, "mean_inference_ms": 2.1183193476973123}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1591, "num_steps_trained": 79878144, "num_steps_sampled": 54303232, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8265, "num_samples_dropped": 309, "learner_queue": {"size_count": 33951, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.117, "replay_time_ms": 119.126, "update_priorities_time_ms": 54.071, "policy_agent_0": {"added_count": 1041920, "sampled_count": 1527552, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1041920, "sampled_count": 1527552, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41857612133026123, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4244541525840759, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 54303232, "episodes_total": 543056, "training_iteration": 555, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-26-24", "timestamp": 1569075984, "time_this_iter_s": 30.64575433731079, "time_total_s": 16962.631311893463, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c6b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1345.6675772666931, "timesteps_since_restore": 4232448, "iterations_since_restore": 44, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.623077123118804, "episode_reward_min": 46.815045184183305, "episode_reward_mean": 57.44321383198857, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.700092949496355, "agent_1": 27.743120882492285}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6534638454229502, "mean_processing_ms": 3.546526216588816, "mean_inference_ms": 2.1190674541179213}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1594, "num_steps_trained": 80016896, "num_steps_sampled": 54400512, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8455, "num_samples_dropped": 309, "learner_queue": {"size_count": 34494, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.641, "replay_time_ms": 119.648, "update_priorities_time_ms": 65.923, "policy_agent_0": {"added_count": 1067264, "sampled_count": 1562624, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1067264, "sampled_count": 1562624, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3926471769809723, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4562925100326538, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 54400512, "episodes_total": 544024, "training_iteration": 556, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-26-55", "timestamp": 1569076015, "time_this_iter_s": 30.674365997314453, "time_total_s": 16993.305677890778, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3d20d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1376.3419432640076, "timesteps_since_restore": 4329728, "iterations_since_restore": 45, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.49556831367589, "episode_reward_min": 56.36348246232663, "episode_reward_mean": 57.440671754795154, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 29.986594767618815, "agent_1": 27.454076987176457}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6539922859598449, "mean_processing_ms": 3.5460898066542503, "mean_inference_ms": 2.1178417078577256}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1597, "num_steps_trained": 80154880, "num_steps_sampled": 54497024, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8643, "num_samples_dropped": 309, "learner_queue": {"size_count": 35033, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.144, "replay_time_ms": 118.199, "update_priorities_time_ms": 64.662, "policy_agent_0": {"added_count": 1092352, "sampled_count": 1594368, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1092352, "sampled_count": 1594368, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37309032678604126, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4563996493816376, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 54497024, "episodes_total": 545000, "training_iteration": 557, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-27-26", "timestamp": 1569076046, "time_this_iter_s": 30.565409660339355, "time_total_s": 17023.871087551117, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3d2c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1406.907352924347, "timesteps_since_restore": 4426240, "iterations_since_restore": 46, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.183583117993074, "episode_reward_min": 56.379638096798175, "episode_reward_mean": 57.300849504844244, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 29.734763577888558, "agent_1": 27.566085926955882}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6536778306194508, "mean_processing_ms": 3.5459633213755724, "mean_inference_ms": 2.1188749192404375}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1600, "num_steps_trained": 80296704, "num_steps_sampled": 54593536, "sample_throughput": 8007.232, "train_throughput": 4003.616, "num_weight_syncs": 8833, "num_samples_dropped": 309, "learner_queue": {"size_count": 35587, "size_mean": 0.2, "size_std": 0.565685424949238, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 33.101, "replay_time_ms": 88.542, "update_priorities_time_ms": 45.576, "policy_agent_0": {"added_count": 1115648, "sampled_count": 1629184, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1115648, "sampled_count": 1629184, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3271329402923584, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3942449390888214, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 54593536, "episodes_total": 545960, "training_iteration": 558, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-27-56", "timestamp": 1569076076, "time_this_iter_s": 30.544671297073364, "time_total_s": 17054.41575884819, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c45f1e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1437.4520242214203, "timesteps_since_restore": 4522752, "iterations_since_restore": 47, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.166100657680836, "episode_reward_min": 55.065507666845654, "episode_reward_mean": 57.00142750773203, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 29.57013938040843, "agent_1": 27.431288127323796}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653546014948798, "mean_processing_ms": 3.5436585114570116, "mean_inference_ms": 2.1178534772460442}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1602, "num_steps_trained": 80434176, "num_steps_sampled": 54692352, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9025, "num_samples_dropped": 309, "learner_queue": {"size_count": 36123, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 48.742, "replay_time_ms": 110.98, "update_priorities_time_ms": 49.897, "policy_agent_0": {"added_count": 1143808, "sampled_count": 1659392, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1143808, "sampled_count": 1659392, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3253518342971802, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40381261706352234, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 54692352, "episodes_total": 546952, "training_iteration": 559, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-28-27", "timestamp": 1569076107, "time_this_iter_s": 30.449172258377075, "time_total_s": 17084.864931106567, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c45fd90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1467.9011964797974, "timesteps_since_restore": 4621568, "iterations_since_restore": 48, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.20415432084203, "episode_reward_min": 54.914498977054635, "episode_reward_mean": 57.15861911301106, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 30.067657744969583, "agent_1": 27.090961368041636}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6539793768259337, "mean_processing_ms": 3.545979223001269, "mean_inference_ms": 2.1174060828290586}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1605, "num_steps_trained": 80571904, "num_steps_sampled": 54789120, "sample_throughput": 8507.581, "train_throughput": 0.0, "num_weight_syncs": 9215, "num_samples_dropped": 309, "learner_queue": {"size_count": 36661, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.256, "replay_time_ms": 111.884, "update_priorities_time_ms": 57.296, "policy_agent_0": {"added_count": 1166848, "sampled_count": 1692928, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1166848, "sampled_count": 1692928, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3351593613624573, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42610642313957214, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 54789120, "episodes_total": 547912, "training_iteration": 560, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-28-57", "timestamp": 1569076137, "time_this_iter_s": 30.518268585205078, "time_total_s": 17115.383199691772, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a22f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1498.4194650650024, "timesteps_since_restore": 4718336, "iterations_since_restore": 49, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.91138779077443, "episode_reward_min": 55.017426092549854, "episode_reward_mean": 58.02086453551497, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 30.232986513195733, "agent_1": 27.7878780223193}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6536521372171616, "mean_processing_ms": 3.5443304211074182, "mean_inference_ms": 2.116535486657403}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1608, "num_steps_trained": 80713472, "num_steps_sampled": 54886656, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9405, "num_samples_dropped": 309, "learner_queue": {"size_count": 37215, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.019, "replay_time_ms": 93.973, "update_priorities_time_ms": 49.857, "policy_agent_0": {"added_count": 1190656, "sampled_count": 1728000, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1190656, "sampled_count": 1728000, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32356497645378113, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42081546783447266, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 54886656, "episodes_total": 548888, "training_iteration": 561, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-29-28", "timestamp": 1569076168, "time_this_iter_s": 30.545758485794067, "time_total_s": 17145.928958177567, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1528.9652235507965, "timesteps_since_restore": 4815872, "iterations_since_restore": 50, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.19992878840914, "episode_reward_min": 55.965705636072, "episode_reward_mean": 57.211565366842656, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.30559450775155, "agent_1": 27.905970859091248}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532075819666392, "mean_processing_ms": 3.5437910507721537, "mean_inference_ms": 2.1177122739907763}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1611, "num_steps_trained": 80852224, "num_steps_sampled": 54983680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9594, "num_samples_dropped": 309, "learner_queue": {"size_count": 37756, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.946, "replay_time_ms": 111.015, "update_priorities_time_ms": 52.361, "policy_agent_0": {"added_count": 1221120, "sampled_count": 1761792, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1221120, "sampled_count": 1761792, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31985774636268616, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4138106405735016, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 54983680, "episodes_total": 549856, "training_iteration": 562, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-29-58", "timestamp": 1569076198, "time_this_iter_s": 30.610100984573364, "time_total_s": 17176.53905916214, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43a400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1559.5753245353699, "timesteps_since_restore": 4912896, "iterations_since_restore": 51, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.51390052984922, "episode_reward_min": 53.08914901622591, "episode_reward_mean": 57.38029187629741, "episode_len_mean": 100.0, "episodes_this_iter": 936, "policy_reward_mean": {"agent_0": 28.814275584504024, "agent_1": 28.56601629179344}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532284439033215, "mean_processing_ms": 3.546066528395964, "mean_inference_ms": 2.119827437631762}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1614, "num_steps_trained": 80999168, "num_steps_sampled": 55077120, "sample_throughput": 15859.98, "train_throughput": 0.0, "num_weight_syncs": 9778, "num_samples_dropped": 309, "learner_queue": {"size_count": 38330, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.959, "replay_time_ms": 134.708, "update_priorities_time_ms": 67.555, "policy_agent_0": {"added_count": 1245696, "sampled_count": 1796096, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1245696, "sampled_count": 1796096, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32803094387054443, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40953347086906433, "model": {}}}}, "timesteps_this_iter": 93440, "done": false, "timesteps_total": 55077120, "episodes_total": 550792, "training_iteration": 563, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-30-29", "timestamp": 1569076229, "time_this_iter_s": 30.728501081466675, "time_total_s": 17207.267560243607, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c42c048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1590.3038256168365, "timesteps_since_restore": 5006336, "iterations_since_restore": 52, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.52752149852472, "episode_reward_min": 50.817595754630766, "episode_reward_mean": 57.06372692558234, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 29.355287921039796, "agent_1": 27.708439004542704}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6530231008520773, "mean_processing_ms": 3.5443301336580464, "mean_inference_ms": 2.119321617150502}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1616, "num_steps_trained": 81135616, "num_steps_sampled": 55176704, "sample_throughput": 10998.467, "train_throughput": 5499.233, "num_weight_syncs": 9972, "num_samples_dropped": 309, "learner_queue": {"size_count": 38863, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 50.693, "replay_time_ms": 92.57, "update_priorities_time_ms": 49.806, "policy_agent_0": {"added_count": 1271040, "sampled_count": 1829120, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1271040, "sampled_count": 1829120, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3485449552536011, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40128421783447266, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 55176704, "episodes_total": 551792, "training_iteration": 564, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-31-00", "timestamp": 1569076260, "time_this_iter_s": 30.527831077575684, "time_total_s": 17237.795391321182, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c34a510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1620.8316566944122, "timesteps_since_restore": 5105920, "iterations_since_restore": 53, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.22735385426243, "episode_reward_min": 53.80737854938197, "episode_reward_mean": 57.226516736900145, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 29.33111970978374, "agent_1": 27.895397027116534}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6534162480521346, "mean_processing_ms": 3.5449258680211173, "mean_inference_ms": 2.1193628705062175}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1619, "num_steps_trained": 81276672, "num_steps_sampled": 55272704, "sample_throughput": 8093.389, "train_throughput": 0.0, "num_weight_syncs": 10159, "num_samples_dropped": 309, "learner_queue": {"size_count": 39414, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.168, "replay_time_ms": 125.668, "update_priorities_time_ms": 61.834, "policy_agent_0": {"added_count": 1294848, "sampled_count": 1862400, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1294848, "sampled_count": 1862400, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35953259468078613, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40023431181907654, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 55272704, "episodes_total": 552752, "training_iteration": 565, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-31-30", "timestamp": 1569076290, "time_this_iter_s": 30.650479078292847, "time_total_s": 17268.445870399475, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c356158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1651.482135772705, "timesteps_since_restore": 5201920, "iterations_since_restore": 54, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.913593532820514, "episode_reward_min": 55.85734685946215, "episode_reward_mean": 57.04838120345618, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.46595821711118, "agent_1": 27.582422986345183}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6540152295686434, "mean_processing_ms": 3.54554166748562, "mean_inference_ms": 2.11856063076598}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1622, "num_steps_trained": 81415168, "num_steps_sampled": 55369984, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10349, "num_samples_dropped": 309, "learner_queue": {"size_count": 39955, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.201, "replay_time_ms": 105.941, "update_priorities_time_ms": 51.173, "policy_agent_0": {"added_count": 1324032, "sampled_count": 1895680, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1324032, "sampled_count": 1895680, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35886505246162415, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.421780526638031, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 55369984, "episodes_total": 553720, "training_iteration": 566, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-32-01", "timestamp": 1569076321, "time_this_iter_s": 30.515457153320312, "time_total_s": 17298.961327552795, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c353620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1681.9975929260254, "timesteps_since_restore": 5299200, "iterations_since_restore": 55, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.23007891053372, "episode_reward_min": 50.28600805056295, "episode_reward_mean": 57.64452927163774, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.425612509044225, "agent_1": 28.218916762593594}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6539460046370226, "mean_processing_ms": 3.5464737820360828, "mean_inference_ms": 2.1200026125315423}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1625, "num_steps_trained": 81554688, "num_steps_sampled": 55466752, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10538, "num_samples_dropped": 309, "learner_queue": {"size_count": 40500, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.7, "replay_time_ms": 116.283, "update_priorities_time_ms": 58.595, "policy_agent_0": {"added_count": 1349120, "sampled_count": 1929216, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1349120, "sampled_count": 1929216, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36489439010620117, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41200172901153564, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 55466752, "episodes_total": 554688, "training_iteration": 567, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-32-32", "timestamp": 1569076352, "time_this_iter_s": 30.619307279586792, "time_total_s": 17329.580634832382, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c368268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1712.6169002056122, "timesteps_since_restore": 5395968, "iterations_since_restore": 56, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.18486409310895, "episode_reward_min": 50.271946663444545, "episode_reward_mean": 57.422992076527514, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 29.483541883859086, "agent_1": 27.93945019266857}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6536464205025595, "mean_processing_ms": 3.545502078556689, "mean_inference_ms": 2.1203292830328353}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1627, "num_steps_trained": 81693184, "num_steps_sampled": 55564544, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10729, "num_samples_dropped": 309, "learner_queue": {"size_count": 41041, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.096, "replay_time_ms": 111.681, "update_priorities_time_ms": 53.27, "policy_agent_0": {"added_count": 1373696, "sampled_count": 1963008, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1373696, "sampled_count": 1963008, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.342532217502594, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4039723873138428, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 55564544, "episodes_total": 555664, "training_iteration": 568, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-33-02", "timestamp": 1569076382, "time_this_iter_s": 30.59513282775879, "time_total_s": 17360.17576766014, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c36a730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1743.212033033371, "timesteps_since_restore": 5493760, "iterations_since_restore": 57, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.60796441819649, "episode_reward_min": 54.827126171628784, "episode_reward_mean": 56.73905194182871, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 30.46284253089818, "agent_1": 26.27620941093066}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6537128989411486, "mean_processing_ms": 3.544929773736155, "mean_inference_ms": 2.1198901547710722}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1630, "num_steps_trained": 81835264, "num_steps_sampled": 55660032, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10915, "num_samples_dropped": 309, "learner_queue": {"size_count": 41596, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.295, "replay_time_ms": 117.625, "update_priorities_time_ms": 54.095, "policy_agent_0": {"added_count": 1396224, "sampled_count": 1998080, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1396224, "sampled_count": 1998080, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35086965560913086, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42040103673934937, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 55660032, "episodes_total": 556624, "training_iteration": 569, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-33-33", "timestamp": 1569076413, "time_this_iter_s": 30.64395499229431, "time_total_s": 17390.819722652435, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c34a620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1773.8559880256653, "timesteps_since_restore": 5589248, "iterations_since_restore": 58, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.82612748489468, "episode_reward_min": 52.903521115248296, "episode_reward_mean": 54.87494047998985, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.080683564511048, "agent_1": 26.794256915478886}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532997317918621, "mean_processing_ms": 3.544683431003045, "mean_inference_ms": 2.1196632489507086}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1633, "num_steps_trained": 81972224, "num_steps_sampled": 55758592, "sample_throughput": 6910.781, "train_throughput": 0.0, "num_weight_syncs": 11108, "num_samples_dropped": 309, "learner_queue": {"size_count": 42132, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.486, "replay_time_ms": 112.063, "update_priorities_time_ms": 53.008, "policy_agent_0": {"added_count": 1422848, "sampled_count": 2030336, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1422848, "sampled_count": 2030336, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3510611355304718, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44374194741249084, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 55758592, "episodes_total": 557608, "training_iteration": 570, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-34-04", "timestamp": 1569076444, "time_this_iter_s": 30.70948100090027, "time_total_s": 17421.529203653336, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a27b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1804.5654690265656, "timesteps_since_restore": 5687808, "iterations_since_restore": 59, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.2504374729829, "episode_reward_min": 51.56985516986521, "episode_reward_mean": 53.37597994086636, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.875028668438414, "agent_1": 26.50095127242798}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6535038096776679, "mean_processing_ms": 3.543510273328151, "mean_inference_ms": 2.1182642413629997}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1636, "num_steps_trained": 82110464, "num_steps_sampled": 55857408, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11301, "num_samples_dropped": 309, "learner_queue": {"size_count": 42671, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.443, "replay_time_ms": 115.591, "update_priorities_time_ms": 54.334, "policy_agent_0": {"added_count": 1444352, "sampled_count": 2064640, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1444352, "sampled_count": 2064640, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3677111268043518, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44391733407974243, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 55857408, "episodes_total": 558600, "training_iteration": 571, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-34-34", "timestamp": 1569076474, "time_this_iter_s": 30.552353620529175, "time_total_s": 17452.081557273865, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1835.1178226470947, "timesteps_since_restore": 5786624, "iterations_since_restore": 60, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.62674244933036, "episode_reward_min": 48.94751166746581, "episode_reward_mean": 54.41719305760112, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 28.330120544485883, "agent_1": 26.087072513115352}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538439433852624, "mean_processing_ms": 3.543336538850754, "mean_inference_ms": 2.1174683504574734}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1638, "num_steps_trained": 82252032, "num_steps_sampled": 55953408, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11489, "num_samples_dropped": 309, "learner_queue": {"size_count": 43224, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.912, "replay_time_ms": 109.14, "update_priorities_time_ms": 50.461, "policy_agent_0": {"added_count": 1468672, "sampled_count": 2098688, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1468672, "sampled_count": 2098688, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3800731599330902, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4665569067001343, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 55953408, "episodes_total": 559560, "training_iteration": 572, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-35-05", "timestamp": 1569076505, "time_this_iter_s": 30.626383066177368, "time_total_s": 17482.707940340042, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1865.744205713272, "timesteps_since_restore": 5882624, "iterations_since_restore": 61, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.14400658300946, "episode_reward_min": 51.34370611184812, "episode_reward_mean": 56.32558555393807, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.2727039892934, "agent_1": 27.052881564644863}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538945167812656, "mean_processing_ms": 3.543776672848097, "mean_inference_ms": 2.117627557548449}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1641, "num_steps_trained": 82389504, "num_steps_sampled": 56050432, "sample_throughput": 5623.128, "train_throughput": 5623.128, "num_weight_syncs": 11678, "num_samples_dropped": 309, "learner_queue": {"size_count": 43762, "size_mean": 0.1, "size_std": 0.3605551275463989, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.803, "replay_time_ms": 116.59, "update_priorities_time_ms": 50.95, "policy_agent_0": {"added_count": 1497856, "sampled_count": 2130944, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1497856, "sampled_count": 2130944, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3701890707015991, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48184722661972046, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 56050432, "episodes_total": 560528, "training_iteration": 573, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-35-36", "timestamp": 1569076536, "time_this_iter_s": 30.637718677520752, "time_total_s": 17513.345659017563, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1896.3819243907928, "timesteps_since_restore": 5979648, "iterations_since_restore": 62, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.208397468755784, "episode_reward_min": 47.19998313799196, "episode_reward_mean": 54.84490538686012, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.176207620154752, "agent_1": 26.668697766705527}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6541034697354897, "mean_processing_ms": 3.544484086942637, "mean_inference_ms": 2.116966790510464}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1644, "num_steps_trained": 82528512, "num_steps_sampled": 56147968, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11869, "num_samples_dropped": 309, "learner_queue": {"size_count": 44304, "size_mean": 0.14, "size_std": 0.40049968789001567, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.542, "replay_time_ms": 122.047, "update_priorities_time_ms": 55.334, "policy_agent_0": {"added_count": 1521408, "sampled_count": 2164736, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1521408, "sampled_count": 2164736, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36709514260292053, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4673362970352173, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 56147968, "episodes_total": 561504, "training_iteration": 574, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-36-06", "timestamp": 1569076566, "time_this_iter_s": 30.614850759506226, "time_total_s": 17543.96050977707, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c481268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1926.996775150299, "timesteps_since_restore": 6077184, "iterations_since_restore": 63, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.716988876158624, "episode_reward_min": 48.072361514134, "episode_reward_mean": 56.21085315850684, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.258566258695282, "agent_1": 26.952286899811785}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6542067066959906, "mean_processing_ms": 3.5445036496194793, "mean_inference_ms": 2.116872474812145}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1647, "num_steps_trained": 82667776, "num_steps_sampled": 56245248, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12058, "num_samples_dropped": 309, "learner_queue": {"size_count": 44848, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.037, "replay_time_ms": 98.189, "update_priorities_time_ms": 47.43, "policy_agent_0": {"added_count": 1547264, "sampled_count": 2198784, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1547264, "sampled_count": 2198784, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3742915093898773, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4625658690929413, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 56245248, "episodes_total": 562472, "training_iteration": 575, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-36-37", "timestamp": 1569076597, "time_this_iter_s": 30.63458013534546, "time_total_s": 17574.595089912415, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4dea60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1957.6313552856445, "timesteps_since_restore": 6174464, "iterations_since_restore": 64, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.1643691200424, "episode_reward_min": 54.195388925646476, "episode_reward_mean": 56.70334922222272, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 29.202945226770563, "agent_1": 27.500403995452352}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538986324608824, "mean_processing_ms": 3.5446297176704236, "mean_inference_ms": 2.116934367067817}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1650, "num_steps_trained": 82804992, "num_steps_sampled": 56342784, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12249, "num_samples_dropped": 309, "learner_queue": {"size_count": 45384, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.049, "replay_time_ms": 78.762, "update_priorities_time_ms": 45.571, "policy_agent_0": {"added_count": 1574400, "sampled_count": 2233856, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1574400, "sampled_count": 2233856, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3540465235710144, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45351412892341614, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 56342784, "episodes_total": 563456, "training_iteration": 576, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-37-07", "timestamp": 1569076627, "time_this_iter_s": 30.55408239364624, "time_total_s": 17605.14917230606, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cf268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1988.1854376792908, "timesteps_since_restore": 6272000, "iterations_since_restore": 65, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.20918871960951, "episode_reward_min": 55.06805693737494, "episode_reward_mean": 56.98259845921427, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 29.507350737524888, "agent_1": 27.475247721689573}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6537198695376051, "mean_processing_ms": 3.5431642933688887, "mean_inference_ms": 2.1153919411548556}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1652, "num_steps_trained": 82940928, "num_steps_sampled": 56440576, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12439, "num_samples_dropped": 309, "learner_queue": {"size_count": 45917, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.553, "replay_time_ms": 111.824, "update_priorities_time_ms": 58.976, "policy_agent_0": {"added_count": 1596416, "sampled_count": 2269184, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1596416, "sampled_count": 2269184, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3496972918510437, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4321904182434082, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 56440576, "episodes_total": 564432, "training_iteration": 577, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-37-38", "timestamp": 1569076658, "time_this_iter_s": 30.507306814193726, "time_total_s": 17635.656479120255, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2018.6927444934845, "timesteps_since_restore": 6369792, "iterations_since_restore": 66, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.204357489149174, "episode_reward_min": 55.92852174076269, "episode_reward_mean": 56.95416339371893, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 29.500825079827628, "agent_1": 27.453338313891518}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538176052072038, "mean_processing_ms": 3.543820663893515, "mean_inference_ms": 2.115922747636818}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1655, "num_steps_trained": 83081728, "num_steps_sampled": 56536320, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12627, "num_samples_dropped": 309, "learner_queue": {"size_count": 46465, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.881, "replay_time_ms": 97.902, "update_priorities_time_ms": 48.88, "policy_agent_0": {"added_count": 1619712, "sampled_count": 2304000, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1619712, "sampled_count": 2304000, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3400938808917999, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4073435962200165, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 56536320, "episodes_total": 565384, "training_iteration": 578, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-38-09", "timestamp": 1569076689, "time_this_iter_s": 30.543872833251953, "time_total_s": 17666.200351953506, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f29d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2049.2366173267365, "timesteps_since_restore": 6465536, "iterations_since_restore": 67, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.16786680395943, "episode_reward_min": 50.931158639934736, "episode_reward_mean": 55.43123644338291, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.53773558706672, "agent_1": 26.893500856316347}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6539297200084059, "mean_processing_ms": 3.5429750200920633, "mean_inference_ms": 2.1148939201738104}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1658, "num_steps_trained": 83219456, "num_steps_sampled": 56634112, "sample_throughput": 0.0, "train_throughput": 13670.751, "num_weight_syncs": 12819, "num_samples_dropped": 309, "learner_queue": {"size_count": 47003, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.046, "replay_time_ms": 114.938, "update_priorities_time_ms": 52.967, "policy_agent_0": {"added_count": 1647360, "sampled_count": 2337536, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1647360, "sampled_count": 2337536, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34680819511413574, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43274563550949097, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 56634112, "episodes_total": 566368, "training_iteration": 579, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-38-39", "timestamp": 1569076719, "time_this_iter_s": 30.644775867462158, "time_total_s": 17696.84512782097, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39f7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2079.8813931941986, "timesteps_since_restore": 6563328, "iterations_since_restore": 68, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.203142311794316, "episode_reward_min": 55.13681764712934, "episode_reward_mean": 57.34001190233259, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.197679080206097, "agent_1": 28.142332822126573}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653926603624979, "mean_processing_ms": 3.5438270674221974, "mean_inference_ms": 2.115371865020051}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1661, "num_steps_trained": 83359744, "num_steps_sampled": 56731136, "sample_throughput": 0.0, "train_throughput": 19490.331, "num_weight_syncs": 13008, "num_samples_dropped": 309, "learner_queue": {"size_count": 47551, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.597, "replay_time_ms": 108.168, "update_priorities_time_ms": 53.384, "policy_agent_0": {"added_count": 1665792, "sampled_count": 2373888, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1665792, "sampled_count": 2373888, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3538900315761566, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42740345001220703, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 56731136, "episodes_total": 567336, "training_iteration": 580, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-39-10", "timestamp": 1569076750, "time_this_iter_s": 30.670634746551514, "time_total_s": 17727.51576256752, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44f268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2110.55202794075, "timesteps_since_restore": 6660352, "iterations_since_restore": 69, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.8675282448611, "episode_reward_min": 52.312144199922095, "episode_reward_mean": 56.89906655553924, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.273966798862453, "agent_1": 27.62509975667696}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6542474377217664, "mean_processing_ms": 3.543598249582661, "mean_inference_ms": 2.115529339402097}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1663, "num_steps_trained": 83498240, "num_steps_sampled": 56827648, "sample_throughput": 3942.333, "train_throughput": 3942.333, "num_weight_syncs": 13196, "num_samples_dropped": 309, "learner_queue": {"size_count": 48093, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.837, "replay_time_ms": 113.028, "update_priorities_time_ms": 49.827, "policy_agent_0": {"added_count": 1687040, "sampled_count": 2408192, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1687040, "sampled_count": 2408192, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3535906672477722, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42192062735557556, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 56827648, "episodes_total": 568304, "training_iteration": 581, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-39-41", "timestamp": 1569076781, "time_this_iter_s": 30.633102416992188, "time_total_s": 17758.148864984512, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44fd90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2141.1851303577423, "timesteps_since_restore": 6756864, "iterations_since_restore": 70, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.166100657680836, "episode_reward_min": 56.32713147072906, "episode_reward_mean": 57.51516276641049, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.123343785947892, "agent_1": 28.39181898046276}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544178444030508, "mean_processing_ms": 3.544173596877473, "mean_inference_ms": 2.1159280583251094}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1666, "num_steps_trained": 83635456, "num_steps_sampled": 56924160, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13384, "num_samples_dropped": 309, "learner_queue": {"size_count": 48628, "size_mean": 0.2, "size_std": 0.447213595499958, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.865, "replay_time_ms": 129.035, "update_priorities_time_ms": 58.175, "policy_agent_0": {"added_count": 1714688, "sampled_count": 2441984, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1714688, "sampled_count": 2441984, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3678096532821655, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41467881202697754, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 56924160, "episodes_total": 569272, "training_iteration": 582, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-40-11", "timestamp": 1569076811, "time_this_iter_s": 30.584590196609497, "time_total_s": 17788.733455181122, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a8378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2171.769720554352, "timesteps_since_restore": 6853376, "iterations_since_restore": 71, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.223890434896084, "episode_reward_min": 55.904631427391536, "episode_reward_mean": 56.950571187175676, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.493632007364187, "agent_1": 27.456939179811698}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545581937549516, "mean_processing_ms": 3.545273662834868, "mean_inference_ms": 2.1156140943844877}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1669, "num_steps_trained": 83771648, "num_steps_sampled": 57021440, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13574, "num_samples_dropped": 309, "learner_queue": {"size_count": 49161, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.439, "replay_time_ms": 128.145, "update_priorities_time_ms": 68.522, "policy_agent_0": {"added_count": 1741824, "sampled_count": 2473216, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1741824, "sampled_count": 2473216, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35871320962905884, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4103742241859436, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 57021440, "episodes_total": 570240, "training_iteration": 583, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-40-42", "timestamp": 1569076842, "time_this_iter_s": 30.706631422042847, "time_total_s": 17819.440086603165, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a8f28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2202.4763519763947, "timesteps_since_restore": 6950656, "iterations_since_restore": 72, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.19051184755455, "episode_reward_min": 53.745126782329045, "episode_reward_mean": 57.22679905912583, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.285963912898715, "agent_1": 27.94083514622724}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546146809309311, "mean_processing_ms": 3.544245451310492, "mean_inference_ms": 2.114950716905588}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1672, "num_steps_trained": 83908608, "num_steps_sampled": 57118464, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13764, "num_samples_dropped": 309, "learner_queue": {"size_count": 49695, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.759, "replay_time_ms": 104.522, "update_priorities_time_ms": 52.466, "policy_agent_0": {"added_count": 1765376, "sampled_count": 2506752, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1765376, "sampled_count": 2506752, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34705954790115356, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4089483320713043, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 57118464, "episodes_total": 571208, "training_iteration": 584, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-41-13", "timestamp": 1569076873, "time_this_iter_s": 30.491015911102295, "time_total_s": 17849.931102514267, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c5488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2232.967367887497, "timesteps_since_restore": 7047680, "iterations_since_restore": 73, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.20703770164661, "episode_reward_min": 55.36025583998538, "episode_reward_mean": 56.767440600824585, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.220069366579942, "agent_1": 27.547371234244814}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547856245463652, "mean_processing_ms": 3.545472476622006, "mean_inference_ms": 2.1149333570186215}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1674, "num_steps_trained": 84047616, "num_steps_sampled": 57215488, "sample_throughput": 8753.636, "train_throughput": 17507.273, "num_weight_syncs": 13953, "num_samples_dropped": 309, "learner_queue": {"size_count": 50241, "size_mean": 1.74, "size_std": 2.876178019525217, "size_quantiles": [0.0, 0.0, 0.0, 6.100000000000001, 11.0]}, "replay_shard_0": {"add_batch_time_ms": 34.67, "replay_time_ms": 74.198, "update_priorities_time_ms": 46.553, "policy_agent_0": {"added_count": 1788928, "sampled_count": 2541312, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1788928, "sampled_count": 2541312, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3560890853404999, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4020162522792816, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 57215488, "episodes_total": 572176, "training_iteration": 585, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-41-43", "timestamp": 1569076903, "time_this_iter_s": 30.559503316879272, "time_total_s": 17880.490605831146, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3d10d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2263.526871204376, "timesteps_since_restore": 7144704, "iterations_since_restore": 74, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.283301945583425, "episode_reward_min": 55.175687961950956, "episode_reward_mean": 55.73581974904671, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 27.838219328214734, "agent_1": 27.897600420831985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545704876384822, "mean_processing_ms": 3.5442879673315626, "mean_inference_ms": 2.114794120925087}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1677, "num_steps_trained": 84188416, "num_steps_sampled": 57312768, "sample_throughput": 6201.582, "train_throughput": 0.0, "num_weight_syncs": 14144, "num_samples_dropped": 309, "learner_queue": {"size_count": 50788, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.565, "replay_time_ms": 101.846, "update_priorities_time_ms": 48.219, "policy_agent_0": {"added_count": 1810688, "sampled_count": 2576384, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1810688, "sampled_count": 2576384, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3654879629611969, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40170907974243164, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 57312768, "episodes_total": 573152, "training_iteration": 586, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-42-14", "timestamp": 1569076934, "time_this_iter_s": 30.635818243026733, "time_total_s": 17911.126424074173, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2294.162689447403, "timesteps_since_restore": 7241984, "iterations_since_restore": 75, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.89970244893787, "episode_reward_min": 52.95337007467537, "episode_reward_mean": 55.614560475675106, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 27.822612750652553, "agent_1": 27.79194772502256}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545418152431287, "mean_processing_ms": 3.5443232402596583, "mean_inference_ms": 2.11568533187536}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1680, "num_steps_trained": 84327680, "num_steps_sampled": 57407488, "sample_throughput": 9953.113, "train_throughput": 0.0, "num_weight_syncs": 14329, "num_samples_dropped": 309, "learner_queue": {"size_count": 51332, "size_mean": 0.22, "size_std": 0.41424630354415964, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 46.825, "replay_time_ms": 120.836, "update_priorities_time_ms": 64.24, "policy_agent_0": {"added_count": 1832704, "sampled_count": 2610176, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1832704, "sampled_count": 2610176, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35901039838790894, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4123953878879547, "model": {}}}}, "timesteps_this_iter": 94720, "done": false, "timesteps_total": 57407488, "episodes_total": 574096, "training_iteration": 587, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-42-44", "timestamp": 1569076964, "time_this_iter_s": 30.56335210800171, "time_total_s": 17941.689776182175, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4291e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2324.7260415554047, "timesteps_since_restore": 7336704, "iterations_since_restore": 76, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.015519070245034, "episode_reward_min": 52.80388074765765, "episode_reward_mean": 55.19219555469029, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.37773273896167, "agent_1": 27.814462815728632}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546808639775588, "mean_processing_ms": 3.5446748734466076, "mean_inference_ms": 2.115055380262789}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1683, "num_steps_trained": 84463616, "num_steps_sampled": 57505792, "sample_throughput": 7616.649, "train_throughput": 7616.649, "num_weight_syncs": 14520, "num_samples_dropped": 309, "learner_queue": {"size_count": 51863, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.094, "replay_time_ms": 99.287, "update_priorities_time_ms": 54.718, "policy_agent_0": {"added_count": 1857536, "sampled_count": 2643712, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1857536, "sampled_count": 2643712, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38430777192115784, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41320741176605225, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 57505792, "episodes_total": 575080, "training_iteration": 588, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-43-15", "timestamp": 1569076995, "time_this_iter_s": 30.516809463500977, "time_total_s": 17972.206585645676, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43f6a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2355.2428510189056, "timesteps_since_restore": 7435008, "iterations_since_restore": 77, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.79654203243388, "episode_reward_min": 51.58104997388854, "episode_reward_mean": 54.08563004742089, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.867858265859944, "agent_1": 27.217771781560995}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547693203401158, "mean_processing_ms": 3.5447557306010613, "mean_inference_ms": 2.1146485272473923}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1685, "num_steps_trained": 84603392, "num_steps_sampled": 57602816, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14711, "num_samples_dropped": 309, "learner_queue": {"size_count": 52409, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.619, "replay_time_ms": 127.561, "update_priorities_time_ms": 61.198, "policy_agent_0": {"added_count": 1880576, "sampled_count": 2678528, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1880576, "sampled_count": 2678528, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38489866256713867, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41059744358062744, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 57602816, "episodes_total": 576056, "training_iteration": 589, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-43-46", "timestamp": 1569077026, "time_this_iter_s": 30.63542604446411, "time_total_s": 18002.84201169014, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c36c2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2385.8782770633698, "timesteps_since_restore": 7532032, "iterations_since_restore": 78, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.89722253305317, "episode_reward_min": 48.41987381181893, "episode_reward_mean": 52.781711556932265, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 27.493198993315453, "agent_1": 25.288512563616827}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545659571664404, "mean_processing_ms": 3.5441891749201413, "mean_inference_ms": 2.114917615804841}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1688, "num_steps_trained": 84746240, "num_steps_sampled": 57698816, "sample_throughput": 20355.295, "train_throughput": 40710.59, "num_weight_syncs": 14897, "num_samples_dropped": 309, "learner_queue": {"size_count": 52967, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.937, "replay_time_ms": 107.307, "update_priorities_time_ms": 44.082, "policy_agent_0": {"added_count": 1901312, "sampled_count": 2712320, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1901312, "sampled_count": 2712320, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38444390892982483, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44032466411590576, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 57698816, "episodes_total": 577016, "training_iteration": 590, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-44-16", "timestamp": 1569077056, "time_this_iter_s": 30.582883834838867, "time_total_s": 18033.42489552498, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c37b7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2416.4611608982086, "timesteps_since_restore": 7628032, "iterations_since_restore": 79, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.273879503683034, "episode_reward_min": 48.36735589440815, "episode_reward_mean": 53.376385388484955, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 27.77205680872068, "agent_1": 25.60432857976427}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545383547807329, "mean_processing_ms": 3.544142610966799, "mean_inference_ms": 2.1151448079785142}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1691, "num_steps_trained": 84888576, "num_steps_sampled": 57795584, "sample_throughput": 30341.118, "train_throughput": 0.0, "num_weight_syncs": 15086, "num_samples_dropped": 309, "learner_queue": {"size_count": 53523, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.163, "replay_time_ms": 91.613, "update_priorities_time_ms": 43.943, "policy_agent_0": {"added_count": 1924096, "sampled_count": 2747392, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1924096, "sampled_count": 2747392, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.397029310464859, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4930315613746643, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 57795584, "episodes_total": 577984, "training_iteration": 591, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-44-47", "timestamp": 1569077087, "time_this_iter_s": 30.675451517105103, "time_total_s": 18064.100347042084, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c307400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2447.1366124153137, "timesteps_since_restore": 7724800, "iterations_since_restore": 80, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.822504826710606, "episode_reward_min": 48.311162685438724, "episode_reward_mean": 51.065902354567136, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 27.921762960408397, "agent_1": 23.144139394158756}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545135469317953, "mean_processing_ms": 3.5458089000666524, "mean_inference_ms": 2.116156422133358}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1694, "num_steps_trained": 85037568, "num_steps_sampled": 57891072, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15273, "num_samples_dropped": 309, "learner_queue": {"size_count": 54106, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.624, "replay_time_ms": 111.419, "update_priorities_time_ms": 49.46, "policy_agent_0": {"added_count": 1946880, "sampled_count": 2781184, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1946880, "sampled_count": 2781184, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39252710342407227, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5664408206939697, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 57891072, "episodes_total": 578928, "training_iteration": 592, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-45-18", "timestamp": 1569077118, "time_this_iter_s": 30.703365564346313, "time_total_s": 18094.80371260643, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c31b8c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2477.83997797966, "timesteps_since_restore": 7820288, "iterations_since_restore": 81, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.24201503470157, "episode_reward_min": 45.93648209015415, "episode_reward_mean": 48.64125315557574, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.37587860809895, "agent_1": 21.2653745474768}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.654415680454905, "mean_processing_ms": 3.5443564717005884, "mean_inference_ms": 2.1138032020156037}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1697, "num_steps_trained": 85172480, "num_steps_sampled": 57991936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15469, "num_samples_dropped": 309, "learner_queue": {"size_count": 54632, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.04, "replay_time_ms": 140.002, "update_priorities_time_ms": 63.578, "policy_agent_0": {"added_count": 1971968, "sampled_count": 2812160, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1971968, "sampled_count": 2812160, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41692614555358887, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6795308589935303, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 57991936, "episodes_total": 579944, "training_iteration": 593, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-45-48", "timestamp": 1569077148, "time_this_iter_s": 30.668949842453003, "time_total_s": 18125.472662448883, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43f7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2508.508927822113, "timesteps_since_restore": 7921152, "iterations_since_restore": 82, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.19477488027977, "episode_reward_min": 45.41639274862176, "episode_reward_mean": 54.024248951458596, "episode_len_mean": 100.0, "episodes_this_iter": 936, "policy_reward_mean": {"agent_0": 27.74951407211912, "agent_1": 26.274734879339462}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548711634542794, "mean_processing_ms": 3.5460515008654903, "mean_inference_ms": 2.113854992502945}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1700, "num_steps_trained": 85316352, "num_steps_sampled": 58086400, "sample_throughput": 12357.2, "train_throughput": 12357.2, "num_weight_syncs": 15654, "num_samples_dropped": 309, "learner_queue": {"size_count": 55194, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.208, "replay_time_ms": 107.138, "update_priorities_time_ms": 56.935, "policy_agent_0": {"added_count": 1992448, "sampled_count": 2847744, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 1992448, "sampled_count": 2847744, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41706010699272156, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7001518607139587, "model": {}}}}, "timesteps_this_iter": 94464, "done": false, "timesteps_total": 58086400, "episodes_total": 580880, "training_iteration": 594, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-46-19", "timestamp": 1569077179, "time_this_iter_s": 30.61531901359558, "time_total_s": 18156.08798146248, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44f730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2539.1242468357086, "timesteps_since_restore": 8015616, "iterations_since_restore": 83, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.21531540782183, "episode_reward_min": 56.05547519535892, "episode_reward_mean": 57.764008345435535, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.92652992361881, "agent_1": 28.837478421816712}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6549019107196016, "mean_processing_ms": 3.5449547396807195, "mean_inference_ms": 2.113112099085175}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1702, "num_steps_trained": 85457920, "num_steps_sampled": 58184448, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15846, "num_samples_dropped": 309, "learner_queue": {"size_count": 55747, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.421, "replay_time_ms": 114.746, "update_priorities_time_ms": 50.354, "policy_agent_0": {"added_count": 2014208, "sampled_count": 2882304, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2014208, "sampled_count": 2882304, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4028230309486389, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6358855366706848, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 58184448, "episodes_total": 581880, "training_iteration": 595, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-46-50", "timestamp": 1569077210, "time_this_iter_s": 30.630465030670166, "time_total_s": 18186.71844649315, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39f7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2569.754711866379, "timesteps_since_restore": 8113664, "iterations_since_restore": 84, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.28085365976788, "episode_reward_min": 56.13225608330062, "episode_reward_mean": 57.78607115766552, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.932121176699244, "agent_1": 28.853949980966263}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547892393230103, "mean_processing_ms": 3.5445404040489024, "mean_inference_ms": 2.1133775031437114}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1705, "num_steps_trained": 85602304, "num_steps_sampled": 58282240, "sample_throughput": 5960.729, "train_throughput": 0.0, "num_weight_syncs": 16037, "num_samples_dropped": 309, "learner_queue": {"size_count": 56312, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.872, "replay_time_ms": 133.598, "update_priorities_time_ms": 55.8, "policy_agent_0": {"added_count": 2037248, "sampled_count": 2917888, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2037248, "sampled_count": 2917888, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3861377239227295, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5317835211753845, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 58282240, "episodes_total": 582848, "training_iteration": 596, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-47-20", "timestamp": 1569077240, "time_this_iter_s": 30.616491556167603, "time_total_s": 18217.334938049316, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f27b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2600.3712034225464, "timesteps_since_restore": 8211456, "iterations_since_restore": 85, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.278685525482814, "episode_reward_min": 55.77823461869289, "episode_reward_mean": 57.8240471744523, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.947501059973412, "agent_1": 28.876546114478877}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6549590967654024, "mean_processing_ms": 3.544610182267045, "mean_inference_ms": 2.1129033679381344}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1708, "num_steps_trained": 85745664, "num_steps_sampled": 58379264, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16227, "num_samples_dropped": 309, "learner_queue": {"size_count": 56871, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.446, "replay_time_ms": 107.657, "update_priorities_time_ms": 53.436, "policy_agent_0": {"added_count": 2060288, "sampled_count": 2952704, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2060288, "sampled_count": 2952704, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36815690994262695, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46003255248069763, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 58379264, "episodes_total": 583816, "training_iteration": 597, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-47-51", "timestamp": 1569077271, "time_this_iter_s": 30.528708934783936, "time_total_s": 18247.8636469841, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2630.8999123573303, "timesteps_since_restore": 8308480, "iterations_since_restore": 86, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.166100657680836, "episode_reward_min": 49.54455768140901, "episode_reward_mean": 55.103484463383715, "episode_len_mean": 100.0, "episodes_this_iter": 928, "policy_reward_mean": {"agent_0": 27.440822155388677, "agent_1": 27.662662307995035}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.655268585967756, "mean_processing_ms": 3.54551214290712, "mean_inference_ms": 2.1139747864295875}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1711, "num_steps_trained": 85891328, "num_steps_sampled": 58472192, "sample_throughput": 14158.548, "train_throughput": 28317.097, "num_weight_syncs": 16408, "num_samples_dropped": 309, "learner_queue": {"size_count": 57440, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.307, "replay_time_ms": 118.16, "update_priorities_time_ms": 56.02, "policy_agent_0": {"added_count": 2082560, "sampled_count": 2987776, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2082560, "sampled_count": 2987776, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38456103205680847, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4446667730808258, "model": {}}}}, "timesteps_this_iter": 92928, "done": false, "timesteps_total": 58472192, "episodes_total": 584744, "training_iteration": 598, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-48-21", "timestamp": 1569077301, "time_this_iter_s": 30.548729181289673, "time_total_s": 18278.41237616539, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cf1e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2661.44864153862, "timesteps_since_restore": 8401408, "iterations_since_restore": 87, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.280968032045, "episode_reward_min": 48.4805459357919, "episode_reward_mean": 53.26112636845379, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 26.58261768689227, "agent_1": 26.6785086815615}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6553926194951465, "mean_processing_ms": 3.5466839986510577, "mean_inference_ms": 2.1152892921513775}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1714, "num_steps_trained": 86035200, "num_steps_sampled": 58567936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16595, "num_samples_dropped": 309, "learner_queue": {"size_count": 58002, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.156, "replay_time_ms": 108.265, "update_priorities_time_ms": 53.398, "policy_agent_0": {"added_count": 2106112, "sampled_count": 3022080, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2106112, "sampled_count": 3022080, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4082750082015991, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.451418399810791, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 58567936, "episodes_total": 585704, "training_iteration": 599, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-48-52", "timestamp": 1569077332, "time_this_iter_s": 30.584803819656372, "time_total_s": 18308.997179985046, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4de400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2692.0334453582764, "timesteps_since_restore": 8497152, "iterations_since_restore": 88, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.24624320213967, "episode_reward_min": 52.49272969293759, "episode_reward_mean": 57.92597312049099, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.998433584553304, "agent_1": 28.927539535937665}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6552408351890564, "mean_processing_ms": 3.5464774217417756, "mean_inference_ms": 2.115247237947943}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1717, "num_steps_trained": 86180864, "num_steps_sampled": 58665472, "sample_throughput": 27083.915, "train_throughput": 0.0, "num_weight_syncs": 16785, "num_samples_dropped": 309, "learner_queue": {"size_count": 58571, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.293, "replay_time_ms": 132.652, "update_priorities_time_ms": 58.267, "policy_agent_0": {"added_count": 2135296, "sampled_count": 3054592, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2135296, "sampled_count": 3054592, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3928814232349396, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4261801838874817, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 58665472, "episodes_total": 586680, "training_iteration": 600, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-49-23", "timestamp": 1569077363, "time_this_iter_s": 30.714049100875854, "time_total_s": 18339.711229085922, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4e8510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2722.747494459152, "timesteps_since_restore": 8594688, "iterations_since_restore": 89, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.24080563241824, "episode_reward_min": 56.54581292325761, "episode_reward_mean": 57.9553878381968, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 29.006353125892442, "agent_1": 28.949034712304336}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.655158278315987, "mean_processing_ms": 3.546762715007529, "mean_inference_ms": 2.115512623943276}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1720, "num_steps_trained": 86322688, "num_steps_sampled": 58763520, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16977, "num_samples_dropped": 309, "learner_queue": {"size_count": 59125, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.895, "replay_time_ms": 98.412, "update_priorities_time_ms": 48.161, "policy_agent_0": {"added_count": 2159360, "sampled_count": 3088384, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2159360, "sampled_count": 3088384, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4118461012840271, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4112476110458374, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 58763520, "episodes_total": 587664, "training_iteration": 601, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-49-54", "timestamp": 1569077394, "time_this_iter_s": 30.688626527786255, "time_total_s": 18370.39985561371, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2753.4361209869385, "timesteps_since_restore": 8692736, "iterations_since_restore": 90, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.9832833556221, "episode_reward_min": 49.52305332046673, "episode_reward_mean": 58.070619848684856, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 28.743564711697697, "agent_1": 29.32705513698713}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6551937915744604, "mean_processing_ms": 3.5462660391023815, "mean_inference_ms": 2.1152149365062995}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1723, "num_steps_trained": 86470656, "num_steps_sampled": 58859776, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17165, "num_samples_dropped": 309, "learner_queue": {"size_count": 59703, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.735, "replay_time_ms": 106.622, "update_priorities_time_ms": 52.472, "policy_agent_0": {"added_count": 2176256, "sampled_count": 3124480, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2176256, "sampled_count": 3124480, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3831019997596741, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4014908969402313, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 58859776, "episodes_total": 588624, "training_iteration": 602, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-50-24", "timestamp": 1569077424, "time_this_iter_s": 30.588265895843506, "time_total_s": 18400.988121509552, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2784.024386882782, "timesteps_since_restore": 8788992, "iterations_since_restore": 91, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.28549979630288, "episode_reward_min": 56.49063731803652, "episode_reward_mean": 57.86842301051201, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.909044998209907, "agent_1": 28.9593780123021}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6549618292408393, "mean_processing_ms": 3.5461669001734206, "mean_inference_ms": 2.116330841397615}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1725, "num_steps_trained": 86617600, "num_steps_sampled": 58956544, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17354, "num_samples_dropped": 309, "learner_queue": {"size_count": 60277, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.283, "replay_time_ms": 114.222, "update_priorities_time_ms": 53.655, "policy_agent_0": {"added_count": 2204672, "sampled_count": 3156736, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2204672, "sampled_count": 3156736, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3869286775588989, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3879286050796509, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 58956544, "episodes_total": 589592, "training_iteration": 603, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-50-55", "timestamp": 1569077455, "time_this_iter_s": 30.695255041122437, "time_total_s": 18431.683376550674, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2814.7196419239044, "timesteps_since_restore": 8885760, "iterations_since_restore": 92, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.18542992419652, "episode_reward_min": 57.007297769676015, "episode_reward_mean": 57.916254320890566, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.97016042045737, "agent_1": 28.946093900433183}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548964122376296, "mean_processing_ms": 3.5455866148311213, "mean_inference_ms": 2.1155702425591256}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1728, "num_steps_trained": 86762496, "num_steps_sampled": 59053568, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17543, "num_samples_dropped": 309, "learner_queue": {"size_count": 60843, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.76, "replay_time_ms": 116.71, "update_priorities_time_ms": 56.879, "policy_agent_0": {"added_count": 2227456, "sampled_count": 3193088, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2227456, "sampled_count": 3193088, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3669637143611908, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3775503635406494, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 59053568, "episodes_total": 590560, "training_iteration": 604, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-51-26", "timestamp": 1569077486, "time_this_iter_s": 30.542361974716187, "time_total_s": 18462.22573852539, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2845.2620038986206, "timesteps_since_restore": 8982784, "iterations_since_restore": 93, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.17256022286668, "episode_reward_min": 56.72027898716217, "episode_reward_mean": 57.896309129858935, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.94953415551514, "agent_1": 28.946774974343786}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547519483412788, "mean_processing_ms": 3.5443626705436637, "mean_inference_ms": 2.1147783495126906}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1731, "num_steps_trained": 86902784, "num_steps_sampled": 59152640, "sample_throughput": 0.0, "train_throughput": 12932.597, "num_weight_syncs": 17737, "num_samples_dropped": 309, "learner_queue": {"size_count": 61391, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.984, "replay_time_ms": 114.606, "update_priorities_time_ms": 52.07, "policy_agent_0": {"added_count": 2250240, "sampled_count": 3225600, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2250240, "sampled_count": 3225600, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37494540214538574, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3898354470729828, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 59152640, "episodes_total": 591544, "training_iteration": 605, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-51-56", "timestamp": 1569077516, "time_this_iter_s": 30.6174635887146, "time_total_s": 18492.843202114105, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c42c620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2875.879467487335, "timesteps_since_restore": 9081856, "iterations_since_restore": 94, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.20780933343081, "episode_reward_min": 56.695557996079785, "episode_reward_mean": 57.90606474778212, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.959507123227848, "agent_1": 28.946557624554252}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545648292970592, "mean_processing_ms": 3.5448377491875274, "mean_inference_ms": 2.1156304813227003}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1734, "num_steps_trained": 87048448, "num_steps_sampled": 59250176, "sample_throughput": 6822.39, "train_throughput": 6822.39, "num_weight_syncs": 17928, "num_samples_dropped": 309, "learner_queue": {"size_count": 61960, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.148, "replay_time_ms": 96.762, "update_priorities_time_ms": 49.213, "policy_agent_0": {"added_count": 2273280, "sampled_count": 3261440, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2273280, "sampled_count": 3261440, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36439409852027893, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3945960998535156, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 59250176, "episodes_total": 592520, "training_iteration": 606, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-52-27", "timestamp": 1569077547, "time_this_iter_s": 30.638173818588257, "time_total_s": 18523.481375932693, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c353158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2906.5176413059235, "timesteps_since_restore": 9179392, "iterations_since_restore": 95, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.2117164750727, "episode_reward_min": 56.76519341146978, "episode_reward_mean": 57.948630851769764, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 28.980942942687083, "agent_1": 28.967687909082667}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547028461958477, "mean_processing_ms": 3.5451100969536524, "mean_inference_ms": 2.1161118387853914}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1737, "num_steps_trained": 87198464, "num_steps_sampled": 59344640, "sample_throughput": 7302.776, "train_throughput": 0.0, "num_weight_syncs": 18112, "num_samples_dropped": 309, "learner_queue": {"size_count": 62547, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 28.658, "replay_time_ms": 96.648, "update_priorities_time_ms": 45.698, "policy_agent_0": {"added_count": 2293760, "sampled_count": 3297792, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2293760, "sampled_count": 3297792, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.372795969247818, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3909066319465637, "model": {}}}}, "timesteps_this_iter": 94464, "done": false, "timesteps_total": 59344640, "episodes_total": 593464, "training_iteration": 607, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-52-57", "timestamp": 1569077577, "time_this_iter_s": 30.49416160583496, "time_total_s": 18553.97553753853, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3d1158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2937.0118029117584, "timesteps_since_restore": 9273856, "iterations_since_restore": 96, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.18161765640284, "episode_reward_min": 56.32682580157869, "episode_reward_mean": 57.79575565617648, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.89033939867718, "agent_1": 28.905416257499287}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548179219956913, "mean_processing_ms": 3.5447252270513525, "mean_inference_ms": 2.1159019204899936}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1740, "num_steps_trained": 87343360, "num_steps_sampled": 59441408, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18301, "num_samples_dropped": 309, "learner_queue": {"size_count": 63112, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.951, "replay_time_ms": 118.889, "update_priorities_time_ms": 61.492, "policy_agent_0": {"added_count": 2316032, "sampled_count": 3332864, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2316032, "sampled_count": 3332864, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35912585258483887, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3761031925678253, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 59441408, "episodes_total": 594440, "training_iteration": 608, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-53-28", "timestamp": 1569077608, "time_this_iter_s": 30.551841020584106, "time_total_s": 18584.527378559113, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cc620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2967.5636439323425, "timesteps_since_restore": 9370624, "iterations_since_restore": 97, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.18618687052178, "episode_reward_min": 55.94021785212442, "episode_reward_mean": 57.844359348622746, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.918190882587556, "agent_1": 28.92616846603517}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547726390106176, "mean_processing_ms": 3.545779870092075, "mean_inference_ms": 2.115996071723941}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1743, "num_steps_trained": 87487488, "num_steps_sampled": 59538432, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18490, "num_samples_dropped": 309, "learner_queue": {"size_count": 63677, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.175, "replay_time_ms": 127.859, "update_priorities_time_ms": 67.411, "policy_agent_0": {"added_count": 2338048, "sampled_count": 3366144, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2338048, "sampled_count": 3366144, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37421590089797974, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3774932026863098, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 59538432, "episodes_total": 595408, "training_iteration": 609, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-53-59", "timestamp": 1569077639, "time_this_iter_s": 30.58352541923523, "time_total_s": 18615.110903978348, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a8268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2998.1471693515778, "timesteps_since_restore": 9467648, "iterations_since_restore": 98, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.166100657680836, "episode_reward_min": 56.77276955413902, "episode_reward_mean": 57.93764144513014, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.94117586685131, "agent_1": 28.996465578278816}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6549467946762755, "mean_processing_ms": 3.544180850034036, "mean_inference_ms": 2.1148943958353366}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1746, "num_steps_trained": 87635968, "num_steps_sampled": 59634944, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18679, "num_samples_dropped": 309, "learner_queue": {"size_count": 64255, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.601, "replay_time_ms": 106.4, "update_priorities_time_ms": 50.493, "policy_agent_0": {"added_count": 2357760, "sampled_count": 3401984, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2357760, "sampled_count": 3401984, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37340104579925537, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3704413175582886, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 59634944, "episodes_total": 596376, "training_iteration": 610, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-54-29", "timestamp": 1569077669, "time_this_iter_s": 30.539677381515503, "time_total_s": 18645.650581359863, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c45f730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3028.6868467330933, "timesteps_since_restore": 9564160, "iterations_since_restore": 99, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.166100657680836, "episode_reward_min": 56.00572535397834, "episode_reward_mean": 57.57444143228529, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.501870113188136, "agent_1": 29.0725713190972}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548734763918879, "mean_processing_ms": 3.5458769314733747, "mean_inference_ms": 2.1164645271007108}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1749, "num_steps_trained": 87781632, "num_steps_sampled": 59732224, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18868, "num_samples_dropped": 309, "learner_queue": {"size_count": 64824, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.339, "replay_time_ms": 99.111, "update_priorities_time_ms": 54.6, "policy_agent_0": {"added_count": 2385152, "sampled_count": 3435520, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2385152, "sampled_count": 3435520, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36595964431762695, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.378139853477478, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 59732224, "episodes_total": 597344, "training_iteration": 611, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-55-00", "timestamp": 1569077700, "time_this_iter_s": 30.62879705429077, "time_total_s": 18676.279378414154, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39c378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3059.315643787384, "timesteps_since_restore": 9661440, "iterations_since_restore": 100, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.171937063311006, "episode_reward_min": 52.41980459835875, "episode_reward_mean": 57.04553644545931, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 28.182194097538993, "agent_1": 28.863342347920387}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6549040542521063, "mean_processing_ms": 3.5473421037101214, "mean_inference_ms": 2.1166649597700213}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1752, "num_steps_trained": 87931136, "num_steps_sampled": 59828224, "sample_throughput": 0.0, "train_throughput": 20528.866, "num_weight_syncs": 19056, "num_samples_dropped": 309, "learner_queue": {"size_count": 65408, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.562, "replay_time_ms": 110.762, "update_priorities_time_ms": 51.357, "policy_agent_0": {"added_count": 2407936, "sampled_count": 3470592, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2407936, "sampled_count": 3470592, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37539345026016235, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3942841589450836, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 59828224, "episodes_total": 598304, "training_iteration": 612, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-55-30", "timestamp": 1569077730, "time_this_iter_s": 30.427682161331177, "time_total_s": 18706.707060575485, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3089.743325948715, "timesteps_since_restore": 9757440, "iterations_since_restore": 101, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.167524683925784, "episode_reward_min": 48.866035643097746, "episode_reward_mean": 55.65548178402635, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 27.657370673352293, "agent_1": 27.998111110674092}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6550472597591752, "mean_processing_ms": 3.5462104023917527, "mean_inference_ms": 2.1170217322821494}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1755, "num_steps_trained": 88081920, "num_steps_sampled": 59923968, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19243, "num_samples_dropped": 309, "learner_queue": {"size_count": 65997, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.949, "replay_time_ms": 78.628, "update_priorities_time_ms": 44.618, "policy_agent_0": {"added_count": 2433024, "sampled_count": 3508224, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2433024, "sampled_count": 3508224, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3772337734699249, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39923393726348877, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 59923968, "episodes_total": 599272, "training_iteration": 613, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-56-01", "timestamp": 1569077761, "time_this_iter_s": 30.527374982833862, "time_total_s": 18737.23443555832, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c31f488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3120.270700931549, "timesteps_since_restore": 9853184, "iterations_since_restore": 102, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.98960287980002, "episode_reward_min": 44.349925285804716, "episode_reward_mean": 52.51551505019147, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.883316531514687, "agent_1": 25.632198518676795}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.655241349770693, "mean_processing_ms": 3.544326686477494, "mean_inference_ms": 2.1158133925616194}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1758, "num_steps_trained": 88229632, "num_steps_sampled": 60022016, "sample_throughput": 9731.564, "train_throughput": 0.0, "num_weight_syncs": 19434, "num_samples_dropped": 309, "learner_queue": {"size_count": 66574, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.755, "replay_time_ms": 91.823, "update_priorities_time_ms": 50.4, "policy_agent_0": {"added_count": 2457856, "sampled_count": 3545600, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2457856, "sampled_count": 3545600, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4098743498325348, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42978888750076294, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 60022016, "episodes_total": 600248, "training_iteration": 614, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-56-31", "timestamp": 1569077791, "time_this_iter_s": 30.592801332473755, "time_total_s": 18767.827236890793, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c312950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3150.863502264023, "timesteps_since_restore": 9951232, "iterations_since_restore": 103, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.2009814721353, "episode_reward_min": 44.659079110609646, "episode_reward_mean": 47.014672814151524, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.264964150063392, "agent_1": 20.749708664088104}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6550538019433485, "mean_processing_ms": 3.5442930934051633, "mean_inference_ms": 2.116296119158512}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1761, "num_steps_trained": 88378112, "num_steps_sampled": 60120064, "sample_throughput": 8767.744, "train_throughput": 0.0, "num_weight_syncs": 19626, "num_samples_dropped": 309, "learner_queue": {"size_count": 67154, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.135, "replay_time_ms": 116.938, "update_priorities_time_ms": 61.501, "policy_agent_0": {"added_count": 2482688, "sampled_count": 3585536, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2482688, "sampled_count": 3585536, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4272799491882324, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5885345339775085, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 60120064, "episodes_total": 601224, "training_iteration": 615, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-57-02", "timestamp": 1569077822, "time_this_iter_s": 30.51925039291382, "time_total_s": 18798.346487283707, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c332598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3181.3827526569366, "timesteps_since_restore": 10049280, "iterations_since_restore": 104, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.83975898158007, "episode_reward_min": 44.63732626203481, "episode_reward_mean": 47.33772827821216, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.771766305755172, "agent_1": 21.565961972456954}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6549429956777323, "mean_processing_ms": 3.544513824872763, "mean_inference_ms": 2.11705188750576}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1764, "num_steps_trained": 88526848, "num_steps_sampled": 60217088, "sample_throughput": 8804.843, "train_throughput": 4402.422, "num_weight_syncs": 19816, "num_samples_dropped": 309, "learner_queue": {"size_count": 67735, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.91, "replay_time_ms": 102.935, "update_priorities_time_ms": 51.351, "policy_agent_0": {"added_count": 2506240, "sampled_count": 3623168, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2506240, "sampled_count": 3623168, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.437841534614563, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6980530619621277, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 60217088, "episodes_total": 602192, "training_iteration": 616, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-57-33", "timestamp": 1569077853, "time_this_iter_s": 30.523067951202393, "time_total_s": 18828.86955523491, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c33aa60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3211.905820608139, "timesteps_since_restore": 10146304, "iterations_since_restore": 105, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.21654770553302, "episode_reward_min": 45.12056148037513, "episode_reward_mean": 48.465486300986704, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.181562976214458, "agent_1": 22.283923324772207}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546107437896223, "mean_processing_ms": 3.5443318900229457, "mean_inference_ms": 2.117240542704928}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1766, "num_steps_trained": 88673536, "num_steps_sampled": 60315392, "sample_throughput": 0.0, "train_throughput": 7862.899, "num_weight_syncs": 20008, "num_samples_dropped": 309, "learner_queue": {"size_count": 68309, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.502, "replay_time_ms": 81.309, "update_priorities_time_ms": 43.823, "policy_agent_0": {"added_count": 2532608, "sampled_count": 3662080, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2532608, "sampled_count": 3662080, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4561782777309418, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7805618047714233, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 60315392, "episodes_total": 603176, "training_iteration": 617, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-58-03", "timestamp": 1569077883, "time_this_iter_s": 30.57212543487549, "time_total_s": 18859.441680669785, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3242.4779460430145, "timesteps_since_restore": 10244608, "iterations_since_restore": 106, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.24292172355601, "episode_reward_min": 45.87005298660073, "episode_reward_mean": 53.66715736195172, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 27.899970461843672, "agent_1": 25.76718690010803}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547033240028592, "mean_processing_ms": 3.54408140802215, "mean_inference_ms": 2.1170783783564375}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1769, "num_steps_trained": 88820480, "num_steps_sampled": 60411392, "sample_throughput": 6917.593, "train_throughput": 0.0, "num_weight_syncs": 20195, "num_samples_dropped": 309, "learner_queue": {"size_count": 68882, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.077, "replay_time_ms": 102.362, "update_priorities_time_ms": 51.153, "policy_agent_0": {"added_count": 2557440, "sampled_count": 3697664, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2557440, "sampled_count": 3697664, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4621751308441162, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.731322705745697, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 60411392, "episodes_total": 604136, "training_iteration": 618, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-58-34", "timestamp": 1569077914, "time_this_iter_s": 30.640079021453857, "time_total_s": 18890.08175969124, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c31bf28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3273.1180250644684, "timesteps_since_restore": 10340608, "iterations_since_restore": 107, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.224499573051624, "episode_reward_min": 55.79751483385491, "episode_reward_mean": 57.93932778389761, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 28.85582555775215, "agent_1": 29.08350222614545}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547938660409139, "mean_processing_ms": 3.5451833290758694, "mean_inference_ms": 2.1173624817152734}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1772, "num_steps_trained": 88971008, "num_steps_sampled": 60507392, "sample_throughput": 0.0, "train_throughput": 20377.701, "num_weight_syncs": 20383, "num_samples_dropped": 309, "learner_queue": {"size_count": 69470, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.418, "replay_time_ms": 121.119, "update_priorities_time_ms": 55.949, "policy_agent_0": {"added_count": 2584320, "sampled_count": 3734784, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2584320, "sampled_count": 3734784, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40896737575531006, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6591783165931702, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 60507392, "episodes_total": 605096, "training_iteration": 619, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-59-04", "timestamp": 1569077944, "time_this_iter_s": 30.508751392364502, "time_total_s": 18920.590511083603, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c353048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3303.626776456833, "timesteps_since_restore": 10436608, "iterations_since_restore": 108, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.215504922802296, "episode_reward_min": 53.899405942525384, "episode_reward_mean": 57.412156878263225, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.067822555105426, "agent_1": 29.344334323157845}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548688523672697, "mean_processing_ms": 3.5459879915868466, "mean_inference_ms": 2.117627017822444}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1775, "num_steps_trained": 89119744, "num_steps_sampled": 60605184, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20573, "num_samples_dropped": 309, "learner_queue": {"size_count": 70051, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.103, "replay_time_ms": 85.242, "update_priorities_time_ms": 47.045, "policy_agent_0": {"added_count": 2610944, "sampled_count": 3772928, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2610944, "sampled_count": 3772928, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4008036255836487, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5045948028564453, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 60605184, "episodes_total": 606080, "training_iteration": 620, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_14-59-35", "timestamp": 1569077975, "time_this_iter_s": 30.530141353607178, "time_total_s": 18951.12065243721, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c42c730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3334.15691781044, "timesteps_since_restore": 10534400, "iterations_since_restore": 109, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.20614524193857, "episode_reward_min": 55.69013816075078, "episode_reward_mean": 57.73927028116766, "episode_len_mean": 100.0, "episodes_this_iter": 928, "policy_reward_mean": {"agent_0": 28.71589681424824, "agent_1": 29.023373466919445}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6551064768274809, "mean_processing_ms": 3.545538014222931, "mean_inference_ms": 2.1176336822607746}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1778, "num_steps_trained": 89267456, "num_steps_sampled": 60699392, "sample_throughput": 7973.547, "train_throughput": 0.0, "num_weight_syncs": 20759, "num_samples_dropped": 309, "learner_queue": {"size_count": 70628, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.356, "replay_time_ms": 127.176, "update_priorities_time_ms": 63.692, "policy_agent_0": {"added_count": 2631680, "sampled_count": 3811072, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2631680, "sampled_count": 3811072, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3917164206504822, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4256882667541504, "model": {}}}}, "timesteps_this_iter": 94208, "done": false, "timesteps_total": 60699392, "episodes_total": 607008, "training_iteration": 621, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-00-06", "timestamp": 1569078006, "time_this_iter_s": 30.595582246780396, "time_total_s": 18981.71623468399, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3364.7525000572205, "timesteps_since_restore": 10628608, "iterations_since_restore": 110, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.18907789115847, "episode_reward_min": 52.41524481150038, "episode_reward_mean": 55.31911072823139, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 27.234794318032904, "agent_1": 28.084316410198543}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6550395273375526, "mean_processing_ms": 3.546417557483841, "mean_inference_ms": 2.118502981240787}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1781, "num_steps_trained": 89406464, "num_steps_sampled": 60794880, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20945, "num_samples_dropped": 309, "learner_queue": {"size_count": 71171, "size_mean": 0.7, "size_std": 1.4999999999999998, "size_quantiles": [0.0, 0.0, 0.0, 3.1000000000000014, 6.0]}, "replay_shard_0": {"add_batch_time_ms": 37.866, "replay_time_ms": 127.719, "update_priorities_time_ms": 51.723, "policy_agent_0": {"added_count": 2658560, "sampled_count": 3842560, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2658560, "sampled_count": 3842560, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4032236337661743, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.412059485912323, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 60794880, "episodes_total": 607968, "training_iteration": 622, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-00-36", "timestamp": 1569078036, "time_this_iter_s": 30.66638207435608, "time_total_s": 19012.382616758347, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b69d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3395.4188821315765, "timesteps_since_restore": 10724096, "iterations_since_restore": 111, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.21116024574486, "episode_reward_min": 55.29200062669443, "episode_reward_mean": 57.64574085636625, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 28.52869240493295, "agent_1": 29.117048451433366}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6556299625882523, "mean_processing_ms": 3.547020439360628, "mean_inference_ms": 2.1182495812476967}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1784, "num_steps_trained": 89561088, "num_steps_sampled": 60889344, "sample_throughput": 6706.066, "train_throughput": 0.0, "num_weight_syncs": 21129, "num_samples_dropped": 309, "learner_queue": {"size_count": 71775, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.742, "replay_time_ms": 78.359, "update_priorities_time_ms": 41.281, "policy_agent_0": {"added_count": 2679296, "sampled_count": 3882752, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2679296, "sampled_count": 3882752, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38604509830474854, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3949155807495117, "model": {}}}}, "timesteps_this_iter": 94464, "done": false, "timesteps_total": 60889344, "episodes_total": 608920, "training_iteration": 623, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-01-07", "timestamp": 1569078067, "time_this_iter_s": 30.545416116714478, "time_total_s": 19042.92803287506, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3425.964298248291, "timesteps_since_restore": 10818560, "iterations_since_restore": 112, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.19605219374568, "episode_reward_min": 49.07941316650049, "episode_reward_mean": 57.25951422931042, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 28.598360749963053, "agent_1": 28.66115347934736}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.655696278435577, "mean_processing_ms": 3.5479333821566104, "mean_inference_ms": 2.1186829016186715}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1787, "num_steps_trained": 89711872, "num_steps_sampled": 60985600, "sample_throughput": 6553.24, "train_throughput": 0.0, "num_weight_syncs": 21317, "num_samples_dropped": 309, "learner_queue": {"size_count": 72366, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.639, "replay_time_ms": 97.031, "update_priorities_time_ms": 50.21, "policy_agent_0": {"added_count": 2706432, "sampled_count": 3921152, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2706432, "sampled_count": 3921152, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.384441614151001, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3918706774711609, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 60985600, "episodes_total": 609872, "training_iteration": 624, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-01-37", "timestamp": 1569078097, "time_this_iter_s": 30.59092092514038, "time_total_s": 19073.5189538002, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4897b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3456.5552191734314, "timesteps_since_restore": 10914816, "iterations_since_restore": 113, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.031131768713145, "episode_reward_min": 57.117077278915374, "episode_reward_mean": 58.00560622415413, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.98105326998052, "agent_1": 29.024552954173586}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6557466492937482, "mean_processing_ms": 3.5474907032808543, "mean_inference_ms": 2.1182368137206455}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1790, "num_steps_trained": 89856256, "num_steps_sampled": 61085696, "sample_throughput": 0.0, "train_throughput": 37472.668, "num_weight_syncs": 21513, "num_samples_dropped": 309, "learner_queue": {"size_count": 72928, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.782, "replay_time_ms": 102.791, "update_priorities_time_ms": 50.233, "policy_agent_0": {"added_count": 2731264, "sampled_count": 3958784, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2731264, "sampled_count": 3958784, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3672635555267334, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38118261098861694, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 61085696, "episodes_total": 610880, "training_iteration": 625, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-02-08", "timestamp": 1569078128, "time_this_iter_s": 30.651672840118408, "time_total_s": 19104.17062664032, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4de620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3487.20689201355, "timesteps_since_restore": 11014912, "iterations_since_restore": 114, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.44328097200298, "episode_reward_min": 56.430512406336106, "episode_reward_mean": 57.876575399375604, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 29.172830630944734, "agent_1": 28.703744768430877}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6559183592075223, "mean_processing_ms": 3.547221452898521, "mean_inference_ms": 2.117690398964444}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1793, "num_steps_trained": 90003968, "num_steps_sampled": 61182976, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21703, "num_samples_dropped": 309, "learner_queue": {"size_count": 73505, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.79, "replay_time_ms": 107.809, "update_priorities_time_ms": 52.896, "policy_agent_0": {"added_count": 2753536, "sampled_count": 3998464, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2753536, "sampled_count": 3998464, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3654276728630066, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3803166151046753, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 61182976, "episodes_total": 611856, "training_iteration": 626, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-02-39", "timestamp": 1569078159, "time_this_iter_s": 30.352432250976562, "time_total_s": 19134.523058891296, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cf488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3517.5593242645264, "timesteps_since_restore": 11112192, "iterations_since_restore": 115, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.20591588536362, "episode_reward_min": 56.39434616522104, "episode_reward_mean": 57.50673614962303, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 29.234547897778064, "agent_1": 28.272188251845048}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6557224885029558, "mean_processing_ms": 3.547538355847582, "mean_inference_ms": 2.1177858127047355}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1796, "num_steps_trained": 90150656, "num_steps_sampled": 61281792, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21896, "num_samples_dropped": 309, "learner_queue": {"size_count": 74078, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.521, "replay_time_ms": 79.875, "update_priorities_time_ms": 44.303, "policy_agent_0": {"added_count": 2774016, "sampled_count": 4037632, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2774016, "sampled_count": 4037632, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3678414821624756, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37091895937919617, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 61281792, "episodes_total": 612840, "training_iteration": 627, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-03-09", "timestamp": 1569078189, "time_this_iter_s": 30.515698671340942, "time_total_s": 19165.038757562637, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3eaea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3548.0750229358673, "timesteps_since_restore": 11211008, "iterations_since_restore": 116, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.20219664949014, "episode_reward_min": 55.70049623321358, "episode_reward_mean": 56.91805005572064, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 29.49709863681057, "agent_1": 27.42095141891028}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6559460175836863, "mean_processing_ms": 3.546475226119998, "mean_inference_ms": 2.1167244129778195}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1799, "num_steps_trained": 90302976, "num_steps_sampled": 61377792, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22084, "num_samples_dropped": 309, "learner_queue": {"size_count": 74673, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.296, "replay_time_ms": 91.984, "update_priorities_time_ms": 43.787, "policy_agent_0": {"added_count": 2798080, "sampled_count": 4075776, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2798080, "sampled_count": 4075776, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3453287184238434, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3830230236053467, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 61377792, "episodes_total": 613800, "training_iteration": 628, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-03-40", "timestamp": 1569078220, "time_this_iter_s": 30.423412084579468, "time_total_s": 19195.462169647217, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f20d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3578.498435020447, "timesteps_since_restore": 11307008, "iterations_since_restore": 117, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.182570817416305, "episode_reward_min": 56.14716098400926, "episode_reward_mean": 56.851682424809134, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 29.55382655400543, "agent_1": 27.29785587080393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.655817649873402, "mean_processing_ms": 3.5470828484763484, "mean_inference_ms": 2.1177642566967267}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1802, "num_steps_trained": 90451456, "num_steps_sampled": 61475584, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22274, "num_samples_dropped": 309, "learner_queue": {"size_count": 75253, "size_mean": 0.26, "size_std": 0.5219195340279955, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.753, "replay_time_ms": 106.225, "update_priorities_time_ms": 52.094, "policy_agent_0": {"added_count": 2820096, "sampled_count": 4115968, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2820096, "sampled_count": 4115968, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3459444046020508, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38616853952407837, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 61475584, "episodes_total": 614776, "training_iteration": 629, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-04-10", "timestamp": 1569078250, "time_this_iter_s": 30.509378910064697, "time_total_s": 19225.97154855728, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39fae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3609.0078139305115, "timesteps_since_restore": 11404800, "iterations_since_restore": 118, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.15089112132072, "episode_reward_min": 51.46636368439622, "episode_reward_mean": 56.639590478870375, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 29.483427958096982, "agent_1": 27.156162520773613}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6555985470428901, "mean_processing_ms": 3.546520450947938, "mean_inference_ms": 2.118199875226663}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1805, "num_steps_trained": 90600960, "num_steps_sampled": 61573120, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22465, "num_samples_dropped": 309, "learner_queue": {"size_count": 75839, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.488, "replay_time_ms": 96.519, "update_priorities_time_ms": 55.942, "policy_agent_0": {"added_count": 2844160, "sampled_count": 4154880, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2844160, "sampled_count": 4154880, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35276857018470764, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41106554865837097, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 61573120, "episodes_total": 615760, "training_iteration": 630, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-04-41", "timestamp": 1569078281, "time_this_iter_s": 30.571401834487915, "time_total_s": 19256.54295039177, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44fd90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3639.5792157649994, "timesteps_since_restore": 11502336, "iterations_since_restore": 119, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.146151101313684, "episode_reward_min": 50.378453965886024, "episode_reward_mean": 55.537599681361925, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.50494819569993, "agent_1": 27.03265148566214}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6554929619221854, "mean_processing_ms": 3.546197130795548, "mean_inference_ms": 2.1182197307478643}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1808, "num_steps_trained": 90750208, "num_steps_sampled": 61671936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22658, "num_samples_dropped": 309, "learner_queue": {"size_count": 76420, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.288, "replay_time_ms": 119.144, "update_priorities_time_ms": 54.048, "policy_agent_0": {"added_count": 2870784, "sampled_count": 4189696, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2870784, "sampled_count": 4189696, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3383544087409973, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40885961055755615, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 61671936, "episodes_total": 616752, "training_iteration": 631, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-05-11", "timestamp": 1569078311, "time_this_iter_s": 30.50638175010681, "time_total_s": 19287.049332141876, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43f488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3670.085597515106, "timesteps_since_restore": 11601152, "iterations_since_restore": 120, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.00032115346207, "episode_reward_min": 44.659079110609646, "episode_reward_mean": 49.94897861073431, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.181589733643474, "agent_1": 23.7673888770909}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6553055889427247, "mean_processing_ms": 3.545916002853848, "mean_inference_ms": 2.1181863133253707}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1811, "num_steps_trained": 90897152, "num_steps_sampled": 61770752, "sample_throughput": 0.0, "train_throughput": 13027.527, "num_weight_syncs": 22850, "num_samples_dropped": 309, "learner_queue": {"size_count": 76994, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.077, "replay_time_ms": 99.005, "update_priorities_time_ms": 50.834, "policy_agent_0": {"added_count": 2896896, "sampled_count": 4226560, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2896896, "sampled_count": 4226560, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38118883967399597, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4454522728919983, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 61770752, "episodes_total": 617736, "training_iteration": 632, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-05-42", "timestamp": 1569078342, "time_this_iter_s": 30.50719666481018, "time_total_s": 19317.556528806686, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c37b510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3700.5927941799164, "timesteps_since_restore": 11699968, "iterations_since_restore": 121, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.265343621274305, "episode_reward_min": 44.52815507004721, "episode_reward_mean": 48.083158146494995, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.830119078205584, "agent_1": 21.253039068289432}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6551600790474693, "mean_processing_ms": 3.5444827711275457, "mean_inference_ms": 2.1167312504553446}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1814, "num_steps_trained": 91040512, "num_steps_sampled": 61872128, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23049, "num_samples_dropped": 309, "learner_queue": {"size_count": 77554, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.269, "replay_time_ms": 112.361, "update_priorities_time_ms": 48.501, "policy_agent_0": {"added_count": 2922752, "sampled_count": 4262656, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2922752, "sampled_count": 4262656, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4082241952419281, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5731638669967651, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 61872128, "episodes_total": 618752, "training_iteration": 633, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-06-12", "timestamp": 1569078372, "time_this_iter_s": 30.532315015792847, "time_total_s": 19348.08884382248, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3d1400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3731.1251091957092, "timesteps_since_restore": 11801344, "iterations_since_restore": 122, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.12787843485265, "episode_reward_min": 44.651038988036824, "episode_reward_mean": 48.427605479347136, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.988947230611128, "agent_1": 22.438658248736044}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6549659987154949, "mean_processing_ms": 3.543340739945346, "mean_inference_ms": 2.1164589420845163}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1817, "num_steps_trained": 91186432, "num_steps_sampled": 61971968, "sample_throughput": 9322.132, "train_throughput": 0.0, "num_weight_syncs": 23244, "num_samples_dropped": 309, "learner_queue": {"size_count": 78124, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.204, "replay_time_ms": 95.677, "update_priorities_time_ms": 45.989, "policy_agent_0": {"added_count": 2951168, "sampled_count": 4300288, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2951168, "sampled_count": 4300288, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4530288577079773, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7325049042701721, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 61971968, "episodes_total": 619744, "training_iteration": 634, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-06-43", "timestamp": 1569078403, "time_this_iter_s": 30.46707558631897, "time_total_s": 19378.5559194088, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3438c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3761.592184782028, "timesteps_since_restore": 11901184, "iterations_since_restore": 123, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.785600839374766, "episode_reward_min": 44.64946607858699, "episode_reward_mean": 48.07292137643088, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.470088873690173, "agent_1": 21.602832502740718}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548528627608894, "mean_processing_ms": 3.5435479340035334, "mean_inference_ms": 2.1168040568894373}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1819, "num_steps_trained": 91331328, "num_steps_sampled": 62071296, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23437, "num_samples_dropped": 309, "learner_queue": {"size_count": 78690, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.189, "replay_time_ms": 89.58, "update_priorities_time_ms": 54.186, "policy_agent_0": {"added_count": 2975232, "sampled_count": 4336384, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2975232, "sampled_count": 4336384, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45427700877189636, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7573365569114685, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 62071296, "episodes_total": 620736, "training_iteration": 635, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-07-13", "timestamp": 1569078433, "time_this_iter_s": 30.586226224899292, "time_total_s": 19409.142145633698, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c346510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3792.1784110069275, "timesteps_since_restore": 12000512, "iterations_since_restore": 124, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.783430118408994, "episode_reward_min": 45.74629772762103, "episode_reward_mean": 54.32523360133792, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 29.03917971542195, "agent_1": 25.286053885916147}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548366346203658, "mean_processing_ms": 3.5425250282561094, "mean_inference_ms": 2.1162340958344616}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1822, "num_steps_trained": 91479040, "num_steps_sampled": 62171648, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23633, "num_samples_dropped": 309, "learner_queue": {"size_count": 79267, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.391, "replay_time_ms": 89.789, "update_priorities_time_ms": 48.39, "policy_agent_0": {"added_count": 2999552, "sampled_count": 4373504, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 2999552, "sampled_count": 4373504, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4373161792755127, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7563791871070862, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 62171648, "episodes_total": 621744, "training_iteration": 636, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-07-44", "timestamp": 1569078464, "time_this_iter_s": 30.611180543899536, "time_total_s": 19439.753326177597, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3419d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3822.789591550827, "timesteps_since_restore": 12100864, "iterations_since_restore": 125, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.7949804364517, "episode_reward_min": 50.4352600058015, "episode_reward_mean": 56.810821240747245, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 29.88436345336961, "agent_1": 26.926457787377846}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.654934959623285, "mean_processing_ms": 3.5420935392125386, "mean_inference_ms": 2.116050832758409}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1825, "num_steps_trained": 91628032, "num_steps_sampled": 62269696, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23825, "num_samples_dropped": 309, "learner_queue": {"size_count": 79849, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.101, "replay_time_ms": 99.315, "update_priorities_time_ms": 50.918, "policy_agent_0": {"added_count": 3019776, "sampled_count": 4410368, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3019776, "sampled_count": 4410368, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39768344163894653, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6625030040740967, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 62269696, "episodes_total": 622720, "training_iteration": 637, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-08-15", "timestamp": 1569078495, "time_this_iter_s": 30.535545110702515, "time_total_s": 19470.2888712883, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c340620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3853.3251366615295, "timesteps_since_restore": 12198912, "iterations_since_restore": 126, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.22485235376072, "episode_reward_min": 53.00119208687847, "episode_reward_mean": 57.272930855794236, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 29.569239662578855, "agent_1": 27.703691193215494}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6549338908314744, "mean_processing_ms": 3.5418543890243313, "mean_inference_ms": 2.1157049161427084}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1828, "num_steps_trained": 91775488, "num_steps_sampled": 62369280, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24020, "num_samples_dropped": 309, "learner_queue": {"size_count": 80425, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.196, "replay_time_ms": 92.389, "update_priorities_time_ms": 43.571, "policy_agent_0": {"added_count": 3045888, "sampled_count": 4447488, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3045888, "sampled_count": 4447488, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3599478602409363, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5308953523635864, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 62369280, "episodes_total": 623712, "training_iteration": 638, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-08-45", "timestamp": 1569078525, "time_this_iter_s": 30.58151125907898, "time_total_s": 19500.87038254738, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2caae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3883.9066479206085, "timesteps_since_restore": 12298496, "iterations_since_restore": 127, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.80011671213157, "episode_reward_min": 53.372274161875886, "episode_reward_mean": 56.146005668273396, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 30.60708347492464, "agent_1": 25.538922193348853}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548222528547504, "mean_processing_ms": 3.542463064650062, "mean_inference_ms": 2.1160702743559288}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1831, "num_steps_trained": 91925248, "num_steps_sampled": 62467072, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24210, "num_samples_dropped": 309, "learner_queue": {"size_count": 81010, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.342, "replay_time_ms": 102.107, "update_priorities_time_ms": 53.803, "policy_agent_0": {"added_count": 3069952, "sampled_count": 4485376, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3069952, "sampled_count": 4485376, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.365312784910202, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5119834542274475, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 62467072, "episodes_total": 624696, "training_iteration": 639, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-09-16", "timestamp": 1569078556, "time_this_iter_s": 30.50006675720215, "time_total_s": 19531.37044930458, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ce730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3914.4067146778107, "timesteps_since_restore": 12396288, "iterations_since_restore": 128, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.78713044446798, "episode_reward_min": 46.32836887128034, "episode_reward_mean": 52.026348821144175, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 31.777277623253674, "agent_1": 20.24907119789049}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.654962476246242, "mean_processing_ms": 3.541168650423284, "mean_inference_ms": 2.1145860999199524}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1834, "num_steps_trained": 92073984, "num_steps_sampled": 62565632, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24403, "num_samples_dropped": 309, "learner_queue": {"size_count": 81592, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.654, "replay_time_ms": 107.779, "update_priorities_time_ms": 48.929, "policy_agent_0": {"added_count": 3093760, "sampled_count": 4525056, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3093760, "sampled_count": 4525056, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3356701135635376, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6285222172737122, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 62565632, "episodes_total": 625680, "training_iteration": 640, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-09-46", "timestamp": 1569078586, "time_this_iter_s": 30.538069248199463, "time_total_s": 19561.90851855278, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2dcbf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3944.94478392601, "timesteps_since_restore": 12494848, "iterations_since_restore": 129, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.739081954783366, "episode_reward_min": 46.507993497374756, "episode_reward_mean": 52.48553605058688, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 31.93459252465844, "agent_1": 20.55094352592845}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548114701716806, "mean_processing_ms": 3.5418703066629416, "mean_inference_ms": 2.1150523401282753}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1837, "num_steps_trained": 92219392, "num_steps_sampled": 62665984, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24599, "num_samples_dropped": 309, "learner_queue": {"size_count": 82159, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.138, "replay_time_ms": 99.866, "update_priorities_time_ms": 48.361, "policy_agent_0": {"added_count": 3117568, "sampled_count": 4562432, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3117568, "sampled_count": 4562432, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.322241872549057, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.77786785364151, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 62665984, "episodes_total": 626688, "training_iteration": 641, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-10-17", "timestamp": 1569078617, "time_this_iter_s": 30.449535131454468, "time_total_s": 19592.358053684235, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c341ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3975.3943190574646, "timesteps_since_restore": 12595200, "iterations_since_restore": 130, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.765006148771654, "episode_reward_min": 47.85085944377046, "episode_reward_mean": 53.11857745864235, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 31.397337605193176, "agent_1": 21.72123985344914}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546209993261628, "mean_processing_ms": 3.5423619612216166, "mean_inference_ms": 2.115852840349385}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1840, "num_steps_trained": 92365824, "num_steps_sampled": 62765312, "sample_throughput": 0.0, "train_throughput": 9045.464, "num_weight_syncs": 24793, "num_samples_dropped": 309, "learner_queue": {"size_count": 82732, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.366, "replay_time_ms": 95.099, "update_priorities_time_ms": 50.43, "policy_agent_0": {"added_count": 3148800, "sampled_count": 4598016, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3148800, "sampled_count": 4598016, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3008424639701843, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8343258500099182, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 62765312, "episodes_total": 627680, "training_iteration": 642, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-10-48", "timestamp": 1569078648, "time_this_iter_s": 30.580435037612915, "time_total_s": 19622.938488721848, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c346048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4005.9747540950775, "timesteps_since_restore": 12694528, "iterations_since_restore": 131, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.712264548586305, "episode_reward_min": 48.6675415963863, "episode_reward_mean": 51.52245487553023, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 30.311910876712542, "agent_1": 21.210543998817716}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.654555422366892, "mean_processing_ms": 3.5399679930603867, "mean_inference_ms": 2.1141059253993353}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1843, "num_steps_trained": 92513280, "num_steps_sampled": 62865920, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24990, "num_samples_dropped": 309, "learner_queue": {"size_count": 83307, "size_mean": 0.26, "size_std": 0.5219195340279956, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.39, "replay_time_ms": 102.672, "update_priorities_time_ms": 50.938, "policy_agent_0": {"added_count": 3175680, "sampled_count": 4634368, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3175680, "sampled_count": 4634368, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3023499548435211, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8543861508369446, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 62865920, "episodes_total": 628696, "training_iteration": 643, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-11-18", "timestamp": 1569078678, "time_this_iter_s": 30.65375304222107, "time_total_s": 19653.59224176407, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c37b2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4036.6285071372986, "timesteps_since_restore": 12795136, "iterations_since_restore": 132, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.060586604121134, "episode_reward_min": 47.608531669053065, "episode_reward_mean": 49.4965086909451, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.355836405451793, "agent_1": 22.14067228549336}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545089716680824, "mean_processing_ms": 3.5398304188078407, "mean_inference_ms": 2.1135920457826023}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1846, "num_steps_trained": 92655616, "num_steps_sampled": 62968320, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25189, "num_samples_dropped": 309, "learner_queue": {"size_count": 83863, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.424, "replay_time_ms": 97.871, "update_priorities_time_ms": 52.428, "policy_agent_0": {"added_count": 3202816, "sampled_count": 4669696, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3202816, "sampled_count": 4669696, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3137744963169098, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8259468674659729, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 62968320, "episodes_total": 629712, "training_iteration": 644, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-11-49", "timestamp": 1569078709, "time_this_iter_s": 30.562899589538574, "time_total_s": 19684.155141353607, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c429e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4067.191406726837, "timesteps_since_restore": 12897536, "iterations_since_restore": 133, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.076688863441646, "episode_reward_min": 50.01259285685724, "episode_reward_mean": 52.37100350556753, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.838132184083936, "agent_1": 23.532871321483693}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.654717008090223, "mean_processing_ms": 3.538511600665947, "mean_inference_ms": 2.112746652502781}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1849, "num_steps_trained": 92804608, "num_steps_sampled": 63067392, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25382, "num_samples_dropped": 309, "learner_queue": {"size_count": 84445, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.78, "replay_time_ms": 94.465, "update_priorities_time_ms": 44.963, "policy_agent_0": {"added_count": 3227392, "sampled_count": 4707328, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3227392, "sampled_count": 4707328, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3311983048915863, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.825512707233429, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 63067392, "episodes_total": 630704, "training_iteration": 645, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-12-19", "timestamp": 1569078739, "time_this_iter_s": 30.568912506103516, "time_total_s": 19714.72405385971, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44fe18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4097.760319232941, "timesteps_since_restore": 12996608, "iterations_since_restore": 134, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.122857432880146, "episode_reward_min": 46.82258835513251, "episode_reward_mean": 51.18906419126409, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 27.266550840433904, "agent_1": 23.92251335083034}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548392097004354, "mean_processing_ms": 3.538676697315201, "mean_inference_ms": 2.112422084045036}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1852, "num_steps_trained": 92955392, "num_steps_sampled": 63164416, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25572, "num_samples_dropped": 309, "learner_queue": {"size_count": 85034, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.52, "replay_time_ms": 102.885, "update_priorities_time_ms": 51.306, "policy_agent_0": {"added_count": 3249664, "sampled_count": 4745728, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3249664, "sampled_count": 4745728, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35983335971832275, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8146612644195557, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 63164416, "episodes_total": 631664, "training_iteration": 646, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-12-50", "timestamp": 1569078770, "time_this_iter_s": 30.609808683395386, "time_total_s": 19745.333862543106, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39f2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4128.370127916336, "timesteps_since_restore": 13093632, "iterations_since_restore": 135, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.04579225604736, "episode_reward_min": 47.53578562090277, "episode_reward_mean": 49.30453212107771, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.336509309442018, "agent_1": 22.968022811635876}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546019563917078, "mean_processing_ms": 3.538491627491743, "mean_inference_ms": 2.1124284256275154}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1855, "num_steps_trained": 93101312, "num_steps_sampled": 63265280, "sample_throughput": 6559.285, "train_throughput": 6559.285, "num_weight_syncs": 25769, "num_samples_dropped": 309, "learner_queue": {"size_count": 85604, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.722, "replay_time_ms": 101.345, "update_priorities_time_ms": 56.316, "policy_agent_0": {"added_count": 3273728, "sampled_count": 4779520, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3273728, "sampled_count": 4779520, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3672659993171692, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8163591623306274, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 63265280, "episodes_total": 632680, "training_iteration": 647, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-13-21", "timestamp": 1569078801, "time_this_iter_s": 30.54973006248474, "time_total_s": 19775.88359260559, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f2620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4158.919857978821, "timesteps_since_restore": 13194496, "iterations_since_restore": 136, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.49347624008491, "episode_reward_min": 46.5355286625355, "episode_reward_mean": 49.55108719080691, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.48265344288586, "agent_1": 23.068433747921226}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544809406628739, "mean_processing_ms": 3.5386243328288773, "mean_inference_ms": 2.112673205606869}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1858, "num_steps_trained": 93249536, "num_steps_sampled": 63364864, "sample_throughput": 7091.899, "train_throughput": 7091.899, "num_weight_syncs": 25964, "num_samples_dropped": 309, "learner_queue": {"size_count": 86183, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.567, "replay_time_ms": 109.025, "update_priorities_time_ms": 57.169, "policy_agent_0": {"added_count": 3301888, "sampled_count": 4815616, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3301888, "sampled_count": 4815616, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39729437232017517, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8040874600410461, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 63364864, "episodes_total": 633672, "training_iteration": 648, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-13-51", "timestamp": 1569078831, "time_this_iter_s": 30.548120498657227, "time_total_s": 19806.431713104248, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ead90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4189.467978477478, "timesteps_since_restore": 13294080, "iterations_since_restore": 137, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.04851622116967, "episode_reward_min": 46.52895125101323, "episode_reward_mean": 52.29074225233859, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.746783360597853, "agent_1": 24.5439588917407}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545675845862216, "mean_processing_ms": 3.538201079757844, "mean_inference_ms": 2.1119877044146085}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1861, "num_steps_trained": 93399296, "num_steps_sampled": 63463424, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26157, "num_samples_dropped": 309, "learner_queue": {"size_count": 86768, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.369, "replay_time_ms": 95.362, "update_priorities_time_ms": 46.004, "policy_agent_0": {"added_count": 3328768, "sampled_count": 4852992, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3328768, "sampled_count": 4852992, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42349156737327576, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7916737794876099, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 63463424, "episodes_total": 634656, "training_iteration": 649, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-14-22", "timestamp": 1569078862, "time_this_iter_s": 30.613471746444702, "time_total_s": 19837.045184850693, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cfae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4220.081450223923, "timesteps_since_restore": 13392640, "iterations_since_restore": 138, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.403882732531216, "episode_reward_min": 47.35695436342443, "episode_reward_mean": 54.16506285555115, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.334691546535705, "agent_1": 25.83037130901536}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546503274369491, "mean_processing_ms": 3.5367299943633705, "mean_inference_ms": 2.110602750863922}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1863, "num_steps_trained": 93541632, "num_steps_sampled": 63563008, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26351, "num_samples_dropped": 309, "learner_queue": {"size_count": 87324, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.13, "replay_time_ms": 101.431, "update_priorities_time_ms": 53.966, "policy_agent_0": {"added_count": 3353600, "sampled_count": 4888320, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3353600, "sampled_count": 4888320, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4011504054069519, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7667330503463745, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 63563008, "episodes_total": 635656, "training_iteration": 650, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-14-52", "timestamp": 1569078892, "time_this_iter_s": 30.273241996765137, "time_total_s": 19867.318426847458, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4e82f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4250.354692220688, "timesteps_since_restore": 13492224, "iterations_since_restore": 139, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.39808499013537, "episode_reward_min": 53.802791114875355, "episode_reward_mean": 54.251388237043535, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.32984284360821, "agent_1": 25.921545393435242}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545753876951106, "mean_processing_ms": 3.537221189467869, "mean_inference_ms": 2.1112695564158463}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1866, "num_steps_trained": 93691904, "num_steps_sampled": 63661824, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26544, "num_samples_dropped": 309, "learner_queue": {"size_count": 87912, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.035, "replay_time_ms": 97.803, "update_priorities_time_ms": 50.339, "policy_agent_0": {"added_count": 3380224, "sampled_count": 4926208, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3380224, "sampled_count": 4926208, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40255504846572876, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7105041146278381, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 63661824, "episodes_total": 636648, "training_iteration": 651, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-15-23", "timestamp": 1569078923, "time_this_iter_s": 30.554079294204712, "time_total_s": 19897.872506141663, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4280.908771514893, "timesteps_since_restore": 13591040, "iterations_since_restore": 140, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.64137561029252, "episode_reward_min": 53.663659149376926, "episode_reward_mean": 54.259685986477784, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.353274778041182, "agent_1": 25.906411208436523}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546083595179437, "mean_processing_ms": 3.5362202332321337, "mean_inference_ms": 2.1102955983204845}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1869, "num_steps_trained": 93841152, "num_steps_sampled": 63761920, "sample_throughput": 6021.736, "train_throughput": 6021.736, "num_weight_syncs": 26740, "num_samples_dropped": 309, "learner_queue": {"size_count": 88495, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.188, "replay_time_ms": 106.783, "update_priorities_time_ms": 54.0, "policy_agent_0": {"added_count": 3404544, "sampled_count": 4964096, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3404544, "sampled_count": 4964096, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3934803009033203, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6554412841796875, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 63761920, "episodes_total": 637640, "training_iteration": 652, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-15-53", "timestamp": 1569078953, "time_this_iter_s": 30.612836599349976, "time_total_s": 19928.485342741013, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4311.521608114243, "timesteps_since_restore": 13691136, "iterations_since_restore": 141, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.68641239813842, "episode_reward_min": 53.76921361727498, "episode_reward_mean": 54.294948642512615, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.40076206032805, "agent_1": 25.894186582184478}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547258117431014, "mean_processing_ms": 3.536211988751183, "mean_inference_ms": 2.109880239028933}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1872, "num_steps_trained": 93992448, "num_steps_sampled": 63859200, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26929, "num_samples_dropped": 309, "learner_queue": {"size_count": 89085, "size_mean": 0.28, "size_std": 0.6337191807101943, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 36.349, "replay_time_ms": 84.335, "update_priorities_time_ms": 45.939, "policy_agent_0": {"added_count": 3431424, "sampled_count": 5001216, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3431424, "sampled_count": 5001216, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38153570890426636, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6151679754257202, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 63859200, "episodes_total": 638616, "training_iteration": 653, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-16-24", "timestamp": 1569078984, "time_this_iter_s": 30.457833766937256, "time_total_s": 19958.94317650795, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4341.97944188118, "timesteps_since_restore": 13788416, "iterations_since_restore": 142, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.98278102666402, "episode_reward_min": 49.179102130138105, "episode_reward_mean": 54.230932383251506, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.34246458908137, "agent_1": 25.888467794170058}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546650316041587, "mean_processing_ms": 3.536024352125352, "mean_inference_ms": 2.1096531256388595}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1875, "num_steps_trained": 94137856, "num_steps_sampled": 63958784, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27124, "num_samples_dropped": 309, "learner_queue": {"size_count": 89653, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.908, "replay_time_ms": 98.837, "update_priorities_time_ms": 51.223, "policy_agent_0": {"added_count": 3458560, "sampled_count": 5039104, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3458560, "sampled_count": 5039104, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3668231666088104, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5943772196769714, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 63958784, "episodes_total": 639616, "training_iteration": 654, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-16-55", "timestamp": 1569079015, "time_this_iter_s": 30.61097025871277, "time_total_s": 19989.554146766663, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4372.590412139893, "timesteps_since_restore": 13888000, "iterations_since_restore": 143, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.36595965184898, "episode_reward_min": 52.344311259959966, "episode_reward_mean": 54.10773124957779, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 28.13102128156017, "agent_1": 25.976709968017527}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545952523590001, "mean_processing_ms": 3.5355056515744137, "mean_inference_ms": 2.110327848204998}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1878, "num_steps_trained": 94289408, "num_steps_sampled": 64055296, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27312, "num_samples_dropped": 309, "learner_queue": {"size_count": 90245, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.391, "replay_time_ms": 93.628, "update_priorities_time_ms": 53.83, "policy_agent_0": {"added_count": 3479808, "sampled_count": 5078272, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3479808, "sampled_count": 5078272, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3740782141685486, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.571129322052002, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 64055296, "episodes_total": 640568, "training_iteration": 655, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-17-25", "timestamp": 1569079045, "time_this_iter_s": 30.567227125167847, "time_total_s": 20020.12137389183, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c42cae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4403.15763926506, "timesteps_since_restore": 13984512, "iterations_since_restore": 144, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.3342536599237, "episode_reward_min": 48.51416496439007, "episode_reward_mean": 52.815940960234734, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.624183798580454, "agent_1": 26.191757161654234}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546654160307109, "mean_processing_ms": 3.535347537679404, "mean_inference_ms": 2.1101770790234844}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1881, "num_steps_trained": 94437632, "num_steps_sampled": 64154112, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27505, "num_samples_dropped": 309, "learner_queue": {"size_count": 90824, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.66, "replay_time_ms": 94.471, "update_priorities_time_ms": 46.07, "policy_agent_0": {"added_count": 3502336, "sampled_count": 5114112, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3502336, "sampled_count": 5114112, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40052345395088196, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5448495745658875, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 64154112, "episodes_total": 641568, "training_iteration": 656, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-17-56", "timestamp": 1569079076, "time_this_iter_s": 30.540780544281006, "time_total_s": 20050.66215443611, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39cae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4433.698419809341, "timesteps_since_restore": 14083328, "iterations_since_restore": 145, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.68641239813842, "episode_reward_min": 51.128170679731795, "episode_reward_mean": 52.28086579901548, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.776215801300562, "agent_1": 26.504649997714868}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545400290148455, "mean_processing_ms": 3.5347302162067185, "mean_inference_ms": 2.109699230233724}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1884, "num_steps_trained": 94582784, "num_steps_sampled": 64255488, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27704, "num_samples_dropped": 309, "learner_queue": {"size_count": 91392, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.25, "replay_time_ms": 95.318, "update_priorities_time_ms": 44.937, "policy_agent_0": {"added_count": 3522560, "sampled_count": 5154304, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3522560, "sampled_count": 5154304, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4248749315738678, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5134352445602417, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 64255488, "episodes_total": 642584, "training_iteration": 657, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-18-26", "timestamp": 1569079106, "time_this_iter_s": 30.499298572540283, "time_total_s": 20081.16145300865, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c47b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4464.197718381882, "timesteps_since_restore": 14184704, "iterations_since_restore": 146, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.728925736696006, "episode_reward_min": 50.93595192069014, "episode_reward_mean": 52.2139505321116, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.681217281590357, "agent_1": 26.532733250521197}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547412988312087, "mean_processing_ms": 3.53494041418961, "mean_inference_ms": 2.109975283493616}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1887, "num_steps_trained": 94733056, "num_steps_sampled": 64353536, "sample_throughput": 0.0, "train_throughput": 20749.837, "num_weight_syncs": 27895, "num_samples_dropped": 309, "learner_queue": {"size_count": 91978, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.538, "replay_time_ms": 101.161, "update_priorities_time_ms": 47.152, "policy_agent_0": {"added_count": 3549184, "sampled_count": 5191936, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3549184, "sampled_count": 5191936, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4478030800819397, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4897480905056, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 64353536, "episodes_total": 643568, "training_iteration": 658, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-18-57", "timestamp": 1569079137, "time_this_iter_s": 30.622656106948853, "time_total_s": 20111.7841091156, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c312840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4494.820374488831, "timesteps_since_restore": 14282752, "iterations_since_restore": 147, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.77072746999521, "episode_reward_min": 46.73480319315601, "episode_reward_mean": 51.15099984385321, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.45217974183627, "agent_1": 25.6988201020169}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547914306335563, "mean_processing_ms": 3.5336772550732323, "mean_inference_ms": 2.1088258976123226}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1890, "num_steps_trained": 94879488, "num_steps_sampled": 64454912, "sample_throughput": 0.0, "train_throughput": 18883.625, "num_weight_syncs": 28092, "num_samples_dropped": 309, "learner_queue": {"size_count": 92550, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.039, "replay_time_ms": 115.861, "update_priorities_time_ms": 53.925, "policy_agent_0": {"added_count": 3572736, "sampled_count": 5228544, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3572736, "sampled_count": 5228544, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46888434886932373, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5002202987670898, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 64454912, "episodes_total": 644568, "training_iteration": 659, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-19-27", "timestamp": 1569079167, "time_this_iter_s": 30.55533266067505, "time_total_s": 20142.339441776276, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3d16a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4525.375707149506, "timesteps_since_restore": 14384128, "iterations_since_restore": 148, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.773803292432866, "episode_reward_min": 47.32690195264085, "episode_reward_mean": 52.012052692567444, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.285088510721906, "agent_1": 26.7269641818455}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.654806032344488, "mean_processing_ms": 3.5335251001007344, "mean_inference_ms": 2.1088486572588496}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1893, "num_steps_trained": 95027968, "num_steps_sampled": 64554496, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28287, "num_samples_dropped": 309, "learner_queue": {"size_count": 93131, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.354, "replay_time_ms": 85.774, "update_priorities_time_ms": 50.288, "policy_agent_0": {"added_count": 3601408, "sampled_count": 5265408, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3601408, "sampled_count": 5265408, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4718402624130249, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5035436153411865, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 64554496, "episodes_total": 645576, "training_iteration": 660, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-19-58", "timestamp": 1569079198, "time_this_iter_s": 30.487613439559937, "time_total_s": 20172.827055215836, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ecb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4555.863320589066, "timesteps_since_restore": 14483712, "iterations_since_restore": 149, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.7795382593659, "episode_reward_min": 46.69484869088533, "episode_reward_mean": 47.81798547877726, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.31438268077873, "agent_1": 22.503602797998493}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.65465859335237, "mean_processing_ms": 3.533008384632364, "mean_inference_ms": 2.108682940564149}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1896, "num_steps_trained": 95173376, "num_steps_sampled": 64655104, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28484, "num_samples_dropped": 309, "learner_queue": {"size_count": 93699, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.918, "replay_time_ms": 117.665, "update_priorities_time_ms": 63.753, "policy_agent_0": {"added_count": 3629568, "sampled_count": 5302272, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3629568, "sampled_count": 5302272, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5016584396362305, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5708736777305603, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 64655104, "episodes_total": 646576, "training_iteration": 661, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-20-29", "timestamp": 1569079229, "time_this_iter_s": 30.649214267730713, "time_total_s": 20203.476269483566, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3d17b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4586.512534856796, "timesteps_since_restore": 14584320, "iterations_since_restore": 150, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.76095851725705, "episode_reward_min": 46.708833461222866, "episode_reward_mean": 47.83142976108636, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.003220989330995, "agent_1": 21.828208771755346}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547683539462416, "mean_processing_ms": 3.5327832681157565, "mean_inference_ms": 2.107703545383418}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1899, "num_steps_trained": 95317760, "num_steps_sampled": 64754176, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28678, "num_samples_dropped": 309, "learner_queue": {"size_count": 94262, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.543, "replay_time_ms": 109.428, "update_priorities_time_ms": 70.239, "policy_agent_0": {"added_count": 3655936, "sampled_count": 5337856, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3655936, "sampled_count": 5337856, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49032342433929443, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.679205596446991, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 64754176, "episodes_total": 647568, "training_iteration": 662, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-20-59", "timestamp": 1569079259, "time_this_iter_s": 30.386922359466553, "time_total_s": 20233.863191843033, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ed840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4616.899457216263, "timesteps_since_restore": 14683392, "iterations_since_restore": 151, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.82948534153583, "episode_reward_min": 46.72586326047956, "episode_reward_mean": 47.07783273707684, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.2013729163872, "agent_1": 21.8764598206896}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548701141024459, "mean_processing_ms": 3.5324398893094764, "mean_inference_ms": 2.1067233930496903}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1902, "num_steps_trained": 95466496, "num_steps_sampled": 64852480, "sample_throughput": 0.0, "train_throughput": 18695.555, "num_weight_syncs": 28869, "num_samples_dropped": 309, "learner_queue": {"size_count": 94843, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.397, "replay_time_ms": 120.552, "update_priorities_time_ms": 52.726, "policy_agent_0": {"added_count": 3680768, "sampled_count": 5376512, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3680768, "sampled_count": 5376512, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49763867259025574, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7821183204650879, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 64852480, "episodes_total": 648552, "training_iteration": 663, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-21-30", "timestamp": 1569079290, "time_this_iter_s": 30.645321369171143, "time_total_s": 20264.508513212204, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c306d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4647.544778585434, "timesteps_since_restore": 14781696, "iterations_since_restore": 152, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.85313821683983, "episode_reward_min": 46.708833461222866, "episode_reward_mean": 49.64369548041668, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.917477701616754, "agent_1": 23.726217778799906}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6547209163415395, "mean_processing_ms": 3.532442697603703, "mean_inference_ms": 2.1064245800349672}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1905, "num_steps_trained": 95611136, "num_steps_sampled": 64953344, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29066, "num_samples_dropped": 309, "learner_queue": {"size_count": 95409, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.263, "replay_time_ms": 115.747, "update_priorities_time_ms": 58.619, "policy_agent_0": {"added_count": 3705088, "sampled_count": 5413632, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3705088, "sampled_count": 5413632, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48506543040275574, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7758570909500122, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 64953344, "episodes_total": 649560, "training_iteration": 664, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-22-00", "timestamp": 1569079320, "time_this_iter_s": 30.621037244796753, "time_total_s": 20295.129550457, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3d1048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4678.165815830231, "timesteps_since_restore": 14882560, "iterations_since_restore": 153, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.85393691435038, "episode_reward_min": 47.87928293161146, "episode_reward_mean": 51.27325974542782, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.406127106143618, "agent_1": 24.867132639284144}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.654849532061223, "mean_processing_ms": 3.531674266666534, "mean_inference_ms": 2.1051385067296837}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1908, "num_steps_trained": 95757824, "num_steps_sampled": 65052416, "sample_throughput": 0.0, "train_throughput": 30856.423, "num_weight_syncs": 29260, "num_samples_dropped": 309, "learner_queue": {"size_count": 95981, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.726, "replay_time_ms": 93.447, "update_priorities_time_ms": 51.062, "policy_agent_0": {"added_count": 3728896, "sampled_count": 5451776, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3728896, "sampled_count": 5451776, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.479948490858078, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7784990072250366, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 65052416, "episodes_total": 650552, "training_iteration": 665, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-22-31", "timestamp": 1569079351, "time_this_iter_s": 30.498275756835938, "time_total_s": 20325.627826213837, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4708.664091587067, "timesteps_since_restore": 14981632, "iterations_since_restore": 154, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.88973068163007, "episode_reward_min": 49.29494211569004, "episode_reward_mean": 55.32036290559231, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.080621270300437, "agent_1": 27.23974163529187}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546907552647669, "mean_processing_ms": 3.5326920397342385, "mean_inference_ms": 2.1057510390721323}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1911, "num_steps_trained": 95905280, "num_steps_sampled": 65150976, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29453, "num_samples_dropped": 309, "learner_queue": {"size_count": 96557, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.493, "replay_time_ms": 121.333, "update_priorities_time_ms": 59.074, "policy_agent_0": {"added_count": 3755008, "sampled_count": 5490176, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3755008, "sampled_count": 5490176, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44779813289642334, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6872384548187256, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 65150976, "episodes_total": 651536, "training_iteration": 666, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-23-01", "timestamp": 1569079381, "time_this_iter_s": 30.437969207763672, "time_total_s": 20356.0657954216, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4739.10206079483, "timesteps_since_restore": 15080192, "iterations_since_restore": 155, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.788620849478534, "episode_reward_min": 54.395815280745396, "episode_reward_mean": 55.98192193124425, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.103522220898146, "agent_1": 27.87839971034609}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.654574322004296, "mean_processing_ms": 3.531456244635446, "mean_inference_ms": 2.1053553402493614}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1914, "num_steps_trained": 96054016, "num_steps_sampled": 65250048, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29647, "num_samples_dropped": 309, "learner_queue": {"size_count": 97138, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.205, "replay_time_ms": 99.898, "update_priorities_time_ms": 49.533, "policy_agent_0": {"added_count": 3777792, "sampled_count": 5528576, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3777792, "sampled_count": 5528576, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42339837551116943, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.551228404045105, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 65250048, "episodes_total": 652520, "training_iteration": 667, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-23-32", "timestamp": 1569079412, "time_this_iter_s": 30.594412565231323, "time_total_s": 20386.66020798683, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3326a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4769.696473360062, "timesteps_since_restore": 15179264, "iterations_since_restore": 156, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.347988410108904, "episode_reward_min": 54.44067712828322, "episode_reward_mean": 55.906084831524595, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.53312940012747, "agent_1": 27.37295543139712}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546219514360123, "mean_processing_ms": 3.5318333738040772, "mean_inference_ms": 2.1054286115466256}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1917, "num_steps_trained": 96204800, "num_steps_sampled": 65348352, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29838, "num_samples_dropped": 309, "learner_queue": {"size_count": 97728, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.477, "replay_time_ms": 111.376, "update_priorities_time_ms": 57.782, "policy_agent_0": {"added_count": 3801088, "sampled_count": 5565696, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3801088, "sampled_count": 5565696, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39965128898620605, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4761013686656952, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 65348352, "episodes_total": 653520, "training_iteration": 668, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-24-03", "timestamp": 1569079443, "time_this_iter_s": 30.65443515777588, "time_total_s": 20417.314643144608, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c42cd08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4800.3509085178375, "timesteps_since_restore": 15277568, "iterations_since_restore": 157, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.08594563434458, "episode_reward_min": 47.488945925095045, "episode_reward_mean": 55.08738468198586, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 30.347296096779083, "agent_1": 24.74008858520681}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545834520261257, "mean_processing_ms": 3.5316492620154554, "mean_inference_ms": 2.105534618007031}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1919, "num_steps_trained": 96350208, "num_steps_sampled": 65448192, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30033, "num_samples_dropped": 309, "learner_queue": {"size_count": 98295, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.271, "replay_time_ms": 92.238, "update_priorities_time_ms": 48.987, "policy_agent_0": {"added_count": 3825408, "sampled_count": 5602816, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3825408, "sampled_count": 5602816, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39731940627098083, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49541378021240234, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 65448192, "episodes_total": 654504, "training_iteration": 669, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-24-33", "timestamp": 1569079473, "time_this_iter_s": 30.570444583892822, "time_total_s": 20447.8850877285, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c368268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4830.92135310173, "timesteps_since_restore": 15377408, "iterations_since_restore": 158, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.07499199941224, "episode_reward_min": 46.587182682834545, "episode_reward_mean": 52.32485519895812, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.91938044661007, "agent_1": 23.405474752348095}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546373563480681, "mean_processing_ms": 3.531619033986938, "mean_inference_ms": 2.105383576882983}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1922, "num_steps_trained": 96500224, "num_steps_sampled": 65547008, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30226, "num_samples_dropped": 309, "learner_queue": {"size_count": 98881, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.649, "replay_time_ms": 96.941, "update_priorities_time_ms": 53.357, "policy_agent_0": {"added_count": 3853056, "sampled_count": 5639168, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3853056, "sampled_count": 5639168, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36431920528411865, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5434978008270264, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 65547008, "episodes_total": 655496, "training_iteration": 670, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-25-04", "timestamp": 1569079504, "time_this_iter_s": 30.593103885650635, "time_total_s": 20478.47819161415, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4861.514456987381, "timesteps_since_restore": 15476224, "iterations_since_restore": 159, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.99487831965667, "episode_reward_min": 48.09664061356652, "episode_reward_mean": 52.89910879754389, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.5846774360607, "agent_1": 26.314431361483262}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546656100027268, "mean_processing_ms": 3.5298594780863723, "mean_inference_ms": 2.1042934606066193}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1925, "num_steps_trained": 96648448, "num_steps_sampled": 65647616, "sample_throughput": 7604.099, "train_throughput": 2534.7, "num_weight_syncs": 30423, "num_samples_dropped": 309, "learner_queue": {"size_count": 99461, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.656, "replay_time_ms": 82.92, "update_priorities_time_ms": 44.646, "policy_agent_0": {"added_count": 3876608, "sampled_count": 5676800, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3876608, "sampled_count": 5676800, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35458919405937195, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6046903133392334, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 65647616, "episodes_total": 656496, "training_iteration": 671, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-25-35", "timestamp": 1569079535, "time_this_iter_s": 30.539769649505615, "time_total_s": 20509.017961263657, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4892.054226636887, "timesteps_since_restore": 15576832, "iterations_since_restore": 160, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.157267317018196, "episode_reward_min": 47.514688579324385, "episode_reward_mean": 53.322877144713324, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.981534711762347, "agent_1": 26.341342432951024}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546370865794102, "mean_processing_ms": 3.529951840899096, "mean_inference_ms": 2.104118018128462}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1928, "num_steps_trained": 96795392, "num_steps_sampled": 65748480, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30619, "num_samples_dropped": 309, "learner_queue": {"size_count": 100034, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.709, "replay_time_ms": 80.909, "update_priorities_time_ms": 46.321, "policy_agent_0": {"added_count": 3904000, "sampled_count": 5714176, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3904000, "sampled_count": 5714176, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3702866733074188, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5736777186393738, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 65748480, "episodes_total": 657512, "training_iteration": 672, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-26-05", "timestamp": 1569079565, "time_this_iter_s": 30.544025897979736, "time_total_s": 20539.561987161636, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4922.598252534866, "timesteps_since_restore": 15677696, "iterations_since_restore": 161, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.795059682949166, "episode_reward_min": 51.42383910938676, "episode_reward_mean": 54.82851126349418, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.606800198188346, "agent_1": 27.221711065305833}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6543931493945035, "mean_processing_ms": 3.529307688979626, "mean_inference_ms": 2.1038890156119345}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1931, "num_steps_trained": 96941056, "num_steps_sampled": 65849856, "sample_throughput": 0.0, "train_throughput": 12379.711, "num_weight_syncs": 30817, "num_samples_dropped": 309, "learner_queue": {"size_count": 100603, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.533, "replay_time_ms": 95.211, "update_priorities_time_ms": 49.275, "policy_agent_0": {"added_count": 3930112, "sampled_count": 5752576, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3930112, "sampled_count": 5752576, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3935099244117737, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49511802196502686, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 65849856, "episodes_total": 658520, "training_iteration": 673, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-26-36", "timestamp": 1569079596, "time_this_iter_s": 30.633636713027954, "time_total_s": 20570.195623874664, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4de0d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4953.231889247894, "timesteps_since_restore": 15779072, "iterations_since_restore": 162, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.85550234458153, "episode_reward_min": 47.667773408402944, "episode_reward_mean": 54.190058803443506, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.548849644476384, "agent_1": 26.64120915896713}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545522213477172, "mean_processing_ms": 3.528053371315543, "mean_inference_ms": 2.1026427197448108}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1934, "num_steps_trained": 97086976, "num_steps_sampled": 65949184, "sample_throughput": 10832.965, "train_throughput": 0.0, "num_weight_syncs": 31011, "num_samples_dropped": 309, "learner_queue": {"size_count": 101174, "size_mean": 0.82, "size_std": 1.872858777377515, "size_quantiles": [0.0, 0.0, 0.0, 3.1000000000000014, 8.0]}, "replay_shard_0": {"add_batch_time_ms": 36.741, "replay_time_ms": 102.782, "update_priorities_time_ms": 54.007, "policy_agent_0": {"added_count": 3952128, "sampled_count": 5790464, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3952128, "sampled_count": 5790464, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38699063658714294, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49091362953186035, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 65949184, "episodes_total": 659512, "training_iteration": 674, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-27-06", "timestamp": 1569079626, "time_this_iter_s": 30.598655939102173, "time_total_s": 20600.794279813766, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cf510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4983.8305451869965, "timesteps_since_restore": 15878400, "iterations_since_restore": 163, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.928416292673205, "episode_reward_min": 49.586166203099545, "episode_reward_mean": 55.5083522162273, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 27.7197120942457, "agent_1": 27.788640121981615}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544451694731952, "mean_processing_ms": 3.5273585362133173, "mean_inference_ms": 2.1023817876544824}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1937, "num_steps_trained": 97232128, "num_steps_sampled": 66051328, "sample_throughput": 15225.521, "train_throughput": 0.0, "num_weight_syncs": 31211, "num_samples_dropped": 309, "learner_queue": {"size_count": 101740, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.959, "replay_time_ms": 103.1, "update_priorities_time_ms": 52.318, "policy_agent_0": {"added_count": 3979264, "sampled_count": 5826304, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 3979264, "sampled_count": 5826304, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3871158957481384, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4695713222026825, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 66051328, "episodes_total": 660536, "training_iteration": 675, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-27-37", "timestamp": 1569079657, "time_this_iter_s": 30.61764645576477, "time_total_s": 20631.41192626953, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3eabf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5014.448191642761, "timesteps_since_restore": 15980544, "iterations_since_restore": 164, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.90037539493349, "episode_reward_min": 47.312888862449995, "episode_reward_mean": 54.41332957295224, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.194891048372188, "agent_1": 27.218438524580048}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6542975062073324, "mean_processing_ms": 3.5273242983215276, "mean_inference_ms": 2.1028405809274835}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1940, "num_steps_trained": 97380608, "num_steps_sampled": 66150656, "sample_throughput": 14990.951, "train_throughput": 0.0, "num_weight_syncs": 31405, "num_samples_dropped": 309, "learner_queue": {"size_count": 102320, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.267, "replay_time_ms": 127.696, "update_priorities_time_ms": 59.412, "policy_agent_0": {"added_count": 4003840, "sampled_count": 5864448, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4003840, "sampled_count": 5864448, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39784178137779236, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45040327310562134, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 66150656, "episodes_total": 661528, "training_iteration": 676, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-28-08", "timestamp": 1569079688, "time_this_iter_s": 30.64113974571228, "time_total_s": 20662.053066015244, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f20d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5045.0893313884735, "timesteps_since_restore": 16079872, "iterations_since_restore": 165, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.86549488205194, "episode_reward_min": 45.94318109826807, "episode_reward_mean": 52.84132803423789, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.55090120606372, "agent_1": 26.29042682817421}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6541635384601113, "mean_processing_ms": 3.5273034038069913, "mean_inference_ms": 2.102276550522599}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1943, "num_steps_trained": 97526272, "num_steps_sampled": 66252544, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31604, "num_samples_dropped": 309, "learner_queue": {"size_count": 102889, "size_mean": 0.2, "size_std": 0.447213595499958, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.559, "replay_time_ms": 97.297, "update_priorities_time_ms": 49.708, "policy_agent_0": {"added_count": 4027904, "sampled_count": 5902592, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4027904, "sampled_count": 5902592, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4075896441936493, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4626370668411255, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 66252544, "episodes_total": 662544, "training_iteration": 677, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-28-38", "timestamp": 1569079718, "time_this_iter_s": 30.538769960403442, "time_total_s": 20692.591835975647, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c307488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5075.628101348877, "timesteps_since_restore": 16181760, "iterations_since_restore": 166, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.837689316397125, "episode_reward_min": 50.24110639924228, "episode_reward_mean": 54.21511144715229, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 27.119826542953945, "agent_1": 27.095284904198458}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6541314850542088, "mean_processing_ms": 3.526949971338622, "mean_inference_ms": 2.1017764694614267}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1946, "num_steps_trained": 97673216, "num_steps_sampled": 66353920, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31801, "num_samples_dropped": 309, "learner_queue": {"size_count": 103464, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.371, "replay_time_ms": 93.034, "update_priorities_time_ms": 47.824, "policy_agent_0": {"added_count": 4052992, "sampled_count": 5938432, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4052992, "sampled_count": 5938432, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43489858508110046, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4562811553478241, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 66353920, "episodes_total": 663568, "training_iteration": 678, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-29-09", "timestamp": 1569079749, "time_this_iter_s": 30.613070726394653, "time_total_s": 20723.20490670204, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44fea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5106.241172075272, "timesteps_since_restore": 16283136, "iterations_since_restore": 167, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.35110312490064, "episode_reward_min": 55.018105176520216, "episode_reward_mean": 55.8421574479001, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.56401358149565, "agent_1": 28.27814386640452}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6541587131742829, "mean_processing_ms": 3.526240799877975, "mean_inference_ms": 2.1006360201720216}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1949, "num_steps_trained": 97820416, "num_steps_sampled": 66455040, "sample_throughput": 15234.594, "train_throughput": 0.0, "num_weight_syncs": 31999, "num_samples_dropped": 309, "learner_queue": {"size_count": 104039, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.826, "replay_time_ms": 93.711, "update_priorities_time_ms": 55.438, "policy_agent_0": {"added_count": 4078336, "sampled_count": 5976832, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4078336, "sampled_count": 5976832, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.413778156042099, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44508811831474304, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 66455040, "episodes_total": 664568, "training_iteration": 679, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-29-40", "timestamp": 1569079780, "time_this_iter_s": 30.689001083374023, "time_total_s": 20753.893907785416, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43fc80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5136.930173158646, "timesteps_since_restore": 16384256, "iterations_since_restore": 168, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.33084460339615, "episode_reward_min": 51.50197779194131, "episode_reward_mean": 54.970090461351006, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.146811214257998, "agent_1": 27.82327924709302}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6542482451177617, "mean_processing_ms": 3.5263308486510674, "mean_inference_ms": 2.1005603852778156}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1952, "num_steps_trained": 97969152, "num_steps_sampled": 66553856, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32193, "num_samples_dropped": 309, "learner_queue": {"size_count": 104619, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.066, "replay_time_ms": 85.679, "update_priorities_time_ms": 43.791, "policy_agent_0": {"added_count": 4102400, "sampled_count": 6012928, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4102400, "sampled_count": 6012928, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41630154848098755, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.407313734292984, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 66553856, "episodes_total": 665560, "training_iteration": 680, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-30-10", "timestamp": 1569079810, "time_this_iter_s": 30.554222583770752, "time_total_s": 20784.448130369186, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c37b268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5167.484395742416, "timesteps_since_restore": 16483072, "iterations_since_restore": 169, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.116715687471554, "episode_reward_min": 51.49692493316006, "episode_reward_mean": 55.06449764611337, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.121403509359922, "agent_1": 27.943094136753462}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544347720769398, "mean_processing_ms": 3.525853142106781, "mean_inference_ms": 2.0995772047536305}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1955, "num_steps_trained": 98114560, "num_steps_sampled": 66653952, "sample_throughput": 0.0, "train_throughput": 23063.942, "num_weight_syncs": 32389, "num_samples_dropped": 309, "learner_queue": {"size_count": 105187, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.247, "replay_time_ms": 91.595, "update_priorities_time_ms": 50.663, "policy_agent_0": {"added_count": 4126208, "sampled_count": 6050304, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4126208, "sampled_count": 6050304, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4324522018432617, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4191935360431671, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 66653952, "episodes_total": 666560, "training_iteration": 681, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-30-41", "timestamp": 1569079841, "time_this_iter_s": 30.511458158493042, "time_total_s": 20814.95958852768, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3462f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5197.995853900909, "timesteps_since_restore": 16583168, "iterations_since_restore": 170, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.82452873070913, "episode_reward_min": 49.46313999138082, "episode_reward_mean": 53.44137472599564, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.387049560886553, "agent_1": 27.054325165109166}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544017060439736, "mean_processing_ms": 3.525982650701758, "mean_inference_ms": 2.0992931246943183}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1957, "num_steps_trained": 98256128, "num_steps_sampled": 66755584, "sample_throughput": 0.0, "train_throughput": 12871.053, "num_weight_syncs": 32587, "num_samples_dropped": 309, "learner_queue": {"size_count": 105740, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.904, "replay_time_ms": 91.918, "update_priorities_time_ms": 54.361, "policy_agent_0": {"added_count": 4150272, "sampled_count": 6085888, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4150272, "sampled_count": 6085888, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4438328444957733, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4175933003425598, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 66755584, "episodes_total": 667592, "training_iteration": 682, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-31-11", "timestamp": 1569079871, "time_this_iter_s": 30.536006450653076, "time_total_s": 20845.495594978333, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c341510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5228.5318603515625, "timesteps_since_restore": 16684800, "iterations_since_restore": 171, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.714814182516264, "episode_reward_min": 51.34170129487313, "episode_reward_mean": 52.96329600513868, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.50709490045375, "agent_1": 26.45620110468501}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544830445386742, "mean_processing_ms": 3.5260507382768287, "mean_inference_ms": 2.099086723558543}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1960, "num_steps_trained": 98403072, "num_steps_sampled": 66854912, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32780, "num_samples_dropped": 309, "learner_queue": {"size_count": 106314, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.445, "replay_time_ms": 109.181, "update_priorities_time_ms": 53.519, "policy_agent_0": {"added_count": 4174592, "sampled_count": 6122752, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4174592, "sampled_count": 6122752, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44784483313560486, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4268568754196167, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 66854912, "episodes_total": 668568, "training_iteration": 683, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-31-42", "timestamp": 1569079902, "time_this_iter_s": 30.51770281791687, "time_total_s": 20876.01329779625, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c306d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5259.049563169479, "timesteps_since_restore": 16784128, "iterations_since_restore": 172, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.74054658612039, "episode_reward_min": 51.29174093172859, "episode_reward_mean": 52.49537987546453, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.870812228421613, "agent_1": 26.62456764704302}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545794602757364, "mean_processing_ms": 3.5255154332729997, "mean_inference_ms": 2.098939117502556}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1963, "num_steps_trained": 98553600, "num_steps_sampled": 66952960, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32971, "num_samples_dropped": 309, "learner_queue": {"size_count": 106902, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.719, "replay_time_ms": 77.562, "update_priorities_time_ms": 49.65, "policy_agent_0": {"added_count": 4200192, "sampled_count": 6161664, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4200192, "sampled_count": 6161664, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4671551287174225, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4485953152179718, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 66952960, "episodes_total": 669568, "training_iteration": 684, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-32-12", "timestamp": 1569079932, "time_this_iter_s": 30.41728401184082, "time_total_s": 20906.43058180809, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28e950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5289.46684718132, "timesteps_since_restore": 16882176, "iterations_since_restore": 173, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.41110915448563, "episode_reward_min": 51.35558650846003, "episode_reward_mean": 52.780611008125916, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.21456361075439, "agent_1": 26.566047397371662}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6543973477324171, "mean_processing_ms": 3.5250094219225048, "mean_inference_ms": 2.0990287940760544}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1966, "num_steps_trained": 98699008, "num_steps_sampled": 67053568, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33169, "num_samples_dropped": 309, "learner_queue": {"size_count": 107470, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.58, "replay_time_ms": 90.021, "update_priorities_time_ms": 51.97, "policy_agent_0": {"added_count": 4224768, "sampled_count": 6199040, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4224768, "sampled_count": 6199040, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4769590497016907, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43295228481292725, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 67053568, "episodes_total": 670560, "training_iteration": 685, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-32-43", "timestamp": 1569079963, "time_this_iter_s": 30.4547016620636, "time_total_s": 20936.885283470154, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c29be18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5319.921548843384, "timesteps_since_restore": 16982784, "iterations_since_restore": 174, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.051186157152856, "episode_reward_min": 50.990608634312544, "episode_reward_mean": 52.048760000876385, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.03749229982988, "agent_1": 27.01126770104652}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6543786552241185, "mean_processing_ms": 3.5244634418445155, "mean_inference_ms": 2.0980651446264633}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1969, "num_steps_trained": 98845184, "num_steps_sampled": 67153152, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33363, "num_samples_dropped": 309, "learner_queue": {"size_count": 108042, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.453, "replay_time_ms": 96.005, "update_priorities_time_ms": 57.62, "policy_agent_0": {"added_count": 4248064, "sampled_count": 6239232, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4248064, "sampled_count": 6239232, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4910232424736023, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45405417680740356, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 67153152, "episodes_total": 671552, "training_iteration": 686, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-33-13", "timestamp": 1569079993, "time_this_iter_s": 30.51457691192627, "time_total_s": 20967.39986038208, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2a1a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5350.43612575531, "timesteps_since_restore": 17082368, "iterations_since_restore": 175, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.72018066094946, "episode_reward_min": 51.098125673431674, "episode_reward_mean": 51.69648759242142, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 24.88868227920851, "agent_1": 26.807805313212874}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544533941542963, "mean_processing_ms": 3.5249070077424585, "mean_inference_ms": 2.097714526667249}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1972, "num_steps_trained": 98993152, "num_steps_sampled": 67251968, "sample_throughput": 0.0, "train_throughput": 16088.43, "num_weight_syncs": 33556, "num_samples_dropped": 309, "learner_queue": {"size_count": 108619, "size_mean": 0.26, "size_std": 0.48207883172775806, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.774, "replay_time_ms": 87.619, "update_priorities_time_ms": 53.668, "policy_agent_0": {"added_count": 4271360, "sampled_count": 6276608, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4271360, "sampled_count": 6276608, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5206700563430786, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4303065240383148, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 67251968, "episodes_total": 672544, "training_iteration": 687, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-33-44", "timestamp": 1569080024, "time_this_iter_s": 30.54171848297119, "time_total_s": 20997.94157886505, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2b0f28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5380.977844238281, "timesteps_since_restore": 17181184, "iterations_since_restore": 176, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.74690929126847, "episode_reward_min": 49.49125066133812, "episode_reward_mean": 51.72915420254816, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.035221617723593, "agent_1": 26.69393258482456}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.654312016290848, "mean_processing_ms": 3.524792103365201, "mean_inference_ms": 2.0979887744354957}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1975, "num_steps_trained": 99145728, "num_steps_sampled": 67350016, "sample_throughput": 8338.9, "train_throughput": 0.0, "num_weight_syncs": 33748, "num_samples_dropped": 309, "learner_queue": {"size_count": 109215, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.129, "replay_time_ms": 100.924, "update_priorities_time_ms": 48.815, "policy_agent_0": {"added_count": 4298496, "sampled_count": 6312960, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4298496, "sampled_count": 6312960, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5613403916358948, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43679630756378174, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 67350016, "episodes_total": 673528, "training_iteration": 688, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-34-15", "timestamp": 1569080055, "time_this_iter_s": 30.663033723831177, "time_total_s": 21028.604612588882, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c306d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5411.640877962112, "timesteps_since_restore": 17279232, "iterations_since_restore": 177, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.80417983285649, "episode_reward_min": 48.517927614609945, "episode_reward_mean": 51.634305662414846, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.68386091561753, "agent_1": 25.95044474679727}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544698350158282, "mean_processing_ms": 3.5241084374541165, "mean_inference_ms": 2.0970952166180594}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1978, "num_steps_trained": 99291392, "num_steps_sampled": 67450112, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33943, "num_samples_dropped": 309, "learner_queue": {"size_count": 109784, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.653, "replay_time_ms": 114.893, "update_priorities_time_ms": 59.833, "policy_agent_0": {"added_count": 4326912, "sampled_count": 6349824, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4326912, "sampled_count": 6349824, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5463006496429443, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4307819604873657, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 67450112, "episodes_total": 674528, "training_iteration": 689, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-34-45", "timestamp": 1569080085, "time_this_iter_s": 30.577749967575073, "time_total_s": 21059.182362556458, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c341378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5442.2186279296875, "timesteps_since_restore": 17379328, "iterations_since_restore": 178, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.813131579841574, "episode_reward_min": 44.71075250190342, "episode_reward_mean": 54.301196677751335, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.63726123775111, "agent_1": 26.663935440000195}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544380489763753, "mean_processing_ms": 3.524585495277402, "mean_inference_ms": 2.097364411760132}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1981, "num_steps_trained": 99438592, "num_steps_sampled": 67549696, "sample_throughput": 0.0, "train_throughput": 36799.075, "num_weight_syncs": 34138, "num_samples_dropped": 309, "learner_queue": {"size_count": 110359, "size_mean": 0.3, "size_std": 0.5385164807134504, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.662, "replay_time_ms": 96.357, "update_priorities_time_ms": 45.698, "policy_agent_0": {"added_count": 4346624, "sampled_count": 6389248, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4346624, "sampled_count": 6389248, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5219599008560181, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4408060610294342, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 67549696, "episodes_total": 675520, "training_iteration": 690, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-35-16", "timestamp": 1569080116, "time_this_iter_s": 30.568960905075073, "time_total_s": 21089.751323461533, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c346d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5472.787588834763, "timesteps_since_restore": 17478912, "iterations_since_restore": 179, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.794520198267136, "episode_reward_min": 44.63732626203481, "episode_reward_mean": 54.27161605777712, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.864024014437458, "agent_1": 26.407592043339623}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546689842584962, "mean_processing_ms": 3.524270625991657, "mean_inference_ms": 2.096663291563843}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1984, "num_steps_trained": 99588608, "num_steps_sampled": 67647488, "sample_throughput": 0.0, "train_throughput": 12142.005, "num_weight_syncs": 34329, "num_samples_dropped": 309, "learner_queue": {"size_count": 110945, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.322, "replay_time_ms": 104.124, "update_priorities_time_ms": 57.586, "policy_agent_0": {"added_count": 4367104, "sampled_count": 6427648, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4367104, "sampled_count": 6427648, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48263999819755554, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44693824648857117, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 67647488, "episodes_total": 676504, "training_iteration": 691, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-35-46", "timestamp": 1569080146, "time_this_iter_s": 30.4794020652771, "time_total_s": 21120.23072552681, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43ff28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5503.26699090004, "timesteps_since_restore": 17576704, "iterations_since_restore": 180, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.39229133157408, "episode_reward_min": 53.45216841065278, "episode_reward_mean": 54.303207113548005, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.24935558562948, "agent_1": 26.05385152791844}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548137527529251, "mean_processing_ms": 3.5239006934486286, "mean_inference_ms": 2.096124814423229}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1987, "num_steps_trained": 99736576, "num_steps_sampled": 67747072, "sample_throughput": 0.0, "train_throughput": 15257.866, "num_weight_syncs": 34524, "num_samples_dropped": 309, "learner_queue": {"size_count": 111523, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.897, "replay_time_ms": 116.501, "update_priorities_time_ms": 55.495, "policy_agent_0": {"added_count": 4390400, "sampled_count": 6465024, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4390400, "sampled_count": 6465024, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42478033900260925, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4503514766693115, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 67747072, "episodes_total": 677496, "training_iteration": 692, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-36-17", "timestamp": 1569080177, "time_this_iter_s": 30.585743188858032, "time_total_s": 21150.816468715668, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c429268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5533.852734088898, "timesteps_since_restore": 17676288, "iterations_since_restore": 181, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.78637131005697, "episode_reward_min": 52.78067921589387, "episode_reward_mean": 53.93881493413039, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.40958224925445, "agent_1": 26.529232684876025}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548057296010835, "mean_processing_ms": 3.5235481055776656, "mean_inference_ms": 2.0956290077329855}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1990, "num_steps_trained": 99880704, "num_steps_sampled": 67848704, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 34721, "num_samples_dropped": 309, "learner_queue": {"size_count": 112086, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 42.028, "replay_time_ms": 127.99, "update_priorities_time_ms": 61.079, "policy_agent_0": {"added_count": 4417536, "sampled_count": 6499840, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4417536, "sampled_count": 6499840, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42955783009529114, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4378420114517212, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 67848704, "episodes_total": 678512, "training_iteration": 693, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-36-48", "timestamp": 1569080208, "time_this_iter_s": 30.56241774559021, "time_total_s": 21181.378886461258, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39f620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5564.415151834488, "timesteps_since_restore": 17777920, "iterations_since_restore": 182, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.74520094309918, "episode_reward_min": 50.34391712139217, "episode_reward_mean": 53.05926575558418, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.52613260751099, "agent_1": 26.533133148073322}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545319895752819, "mean_processing_ms": 3.52349402502711, "mean_inference_ms": 2.095676534355445}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1993, "num_steps_trained": 100026112, "num_steps_sampled": 67950080, "sample_throughput": 0.0, "train_throughput": 23266.849, "num_weight_syncs": 34920, "num_samples_dropped": 309, "learner_queue": {"size_count": 112654, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.03, "replay_time_ms": 104.168, "update_priorities_time_ms": 51.339, "policy_agent_0": {"added_count": 4443648, "sampled_count": 6538240, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4443648, "sampled_count": 6538240, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4230886995792389, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45112931728363037, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 67950080, "episodes_total": 679528, "training_iteration": 694, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-37-18", "timestamp": 1569080238, "time_this_iter_s": 30.58007836341858, "time_total_s": 21211.958964824677, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f2400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5594.9952301979065, "timesteps_since_restore": 17879296, "iterations_since_restore": 183, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.85734174596409, "episode_reward_min": 49.267237043080414, "episode_reward_mean": 54.01921529194826, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.51965393041817, "agent_1": 26.4995613615301}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546873196547036, "mean_processing_ms": 3.5226148198136924, "mean_inference_ms": 2.0948589086471263}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1996, "num_steps_trained": 100172800, "num_steps_sampled": 68051200, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 35117, "num_samples_dropped": 309, "learner_queue": {"size_count": 113227, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.384, "replay_time_ms": 99.975, "update_priorities_time_ms": 53.709, "policy_agent_0": {"added_count": 4468992, "sampled_count": 6574080, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4468992, "sampled_count": 6574080, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43529075384140015, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4475984275341034, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 68051200, "episodes_total": 680544, "training_iteration": 695, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-37-49", "timestamp": 1569080269, "time_this_iter_s": 30.64269518852234, "time_total_s": 21242.6016600132, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ead08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5625.637925386429, "timesteps_since_restore": 17980416, "iterations_since_restore": 184, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.787986015939026, "episode_reward_min": 50.75151673793961, "episode_reward_mean": 55.59226679992603, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.74456267568783, "agent_1": 27.847704124238195}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546332646216899, "mean_processing_ms": 3.522626111832932, "mean_inference_ms": 2.094950136433551}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 1999, "num_steps_trained": 100317184, "num_steps_sampled": 68152320, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 35314, "num_samples_dropped": 309, "learner_queue": {"size_count": 113791, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.983, "replay_time_ms": 88.279, "update_priorities_time_ms": 47.926, "policy_agent_0": {"added_count": 4491776, "sampled_count": 6612480, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4491776, "sampled_count": 6612480, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42281895875930786, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45850297808647156, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 68152320, "episodes_total": 681552, "training_iteration": 696, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-38-20", "timestamp": 1569080300, "time_this_iter_s": 30.55680513381958, "time_total_s": 21273.15846514702, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cf620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5656.194730520248, "timesteps_since_restore": 18081536, "iterations_since_restore": 185, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.8355001309908, "episode_reward_min": 50.7158825604737, "episode_reward_mean": 54.392882318342366, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.750951792332984, "agent_1": 27.641930526009336}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546019241495781, "mean_processing_ms": 3.5219728634911824, "mean_inference_ms": 2.0946143516980786}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2001, "num_steps_trained": 100463616, "num_steps_sampled": 68251904, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 35509, "num_samples_dropped": 309, "learner_queue": {"size_count": 114364, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.821, "replay_time_ms": 105.318, "update_priorities_time_ms": 51.366, "policy_agent_0": {"added_count": 4514304, "sampled_count": 6650880, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4514304, "sampled_count": 6650880, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4151560664176941, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4499931335449219, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 68251904, "episodes_total": 682544, "training_iteration": 697, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-38-50", "timestamp": 1569080330, "time_this_iter_s": 30.505964517593384, "time_total_s": 21303.66442966461, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4e8048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5686.700695037842, "timesteps_since_restore": 18181120, "iterations_since_restore": 186, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.53028173386947, "episode_reward_min": 47.647562729491696, "episode_reward_mean": 54.002859477301435, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.008797624516912, "agent_1": 27.994061852784444}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6548076411387339, "mean_processing_ms": 3.5224572250874866, "mean_inference_ms": 2.094579572007219}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2004, "num_steps_trained": 100611072, "num_steps_sampled": 68351488, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 35703, "num_samples_dropped": 309, "learner_queue": {"size_count": 114939, "size_mean": 0.1, "size_std": 0.3605551275463989, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.688, "replay_time_ms": 109.368, "update_priorities_time_ms": 62.149, "policy_agent_0": {"added_count": 4542208, "sampled_count": 6686208, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4542208, "sampled_count": 6686208, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42782288789749146, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4134213328361511, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 68351488, "episodes_total": 683536, "training_iteration": 698, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-39-21", "timestamp": 1569080361, "time_this_iter_s": 30.60231065750122, "time_total_s": 21334.266740322113, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5717.303005695343, "timesteps_since_restore": 18280704, "iterations_since_restore": 187, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.54975056703192, "episode_reward_min": 47.66701649378949, "episode_reward_mean": 53.887336366498225, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.022346130128152, "agent_1": 27.86499023636999}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545626764843157, "mean_processing_ms": 3.52154488191596, "mean_inference_ms": 2.0943607187639133}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2007, "num_steps_trained": 100755968, "num_steps_sampled": 68453632, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 35903, "num_samples_dropped": 309, "learner_queue": {"size_count": 115506, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.706, "replay_time_ms": 91.976, "update_priorities_time_ms": 49.431, "policy_agent_0": {"added_count": 4565504, "sampled_count": 6723840, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4565504, "sampled_count": 6723840, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44244420528411865, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4259020686149597, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 68453632, "episodes_total": 684552, "training_iteration": 699, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-39-51", "timestamp": 1569080391, "time_this_iter_s": 30.55465269088745, "time_total_s": 21364.821393013, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5747.8576583862305, "timesteps_since_restore": 18382848, "iterations_since_restore": 188, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.46463212276879, "episode_reward_min": 47.67070495984151, "episode_reward_mean": 53.304426790186916, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.072638439023063, "agent_1": 27.23178835116379}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545981263487427, "mean_processing_ms": 3.5210924276741182, "mean_inference_ms": 2.0934494622155477}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2010, "num_steps_trained": 100898304, "num_steps_sampled": 68556032, "sample_throughput": 9494.242, "train_throughput": 0.0, "num_weight_syncs": 36103, "num_samples_dropped": 309, "learner_queue": {"size_count": 116061, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.758, "replay_time_ms": 91.524, "update_priorities_time_ms": 48.608, "policy_agent_0": {"added_count": 4593152, "sampled_count": 6758912, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4593152, "sampled_count": 6758912, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45868203043937683, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43558210134506226, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 68556032, "episodes_total": 685584, "training_iteration": 700, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-40-22", "timestamp": 1569080422, "time_this_iter_s": 30.499865531921387, "time_total_s": 21395.321258544922, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5778.357523918152, "timesteps_since_restore": 18485248, "iterations_since_restore": 189, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.81083394286178, "episode_reward_min": 47.93746345249048, "episode_reward_mean": 53.547548119870946, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.347790672612664, "agent_1": 27.199757447258214}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544677033696891, "mean_processing_ms": 3.520968626262101, "mean_inference_ms": 2.093628357273455}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2013, "num_steps_trained": 101046272, "num_steps_sampled": 68655360, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36296, "num_samples_dropped": 309, "learner_queue": {"size_count": 116639, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.702, "replay_time_ms": 85.836, "update_priorities_time_ms": 45.789, "policy_agent_0": {"added_count": 4620544, "sampled_count": 6793728, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4620544, "sampled_count": 6793728, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4708119034767151, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43573102355003357, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 68655360, "episodes_total": 686576, "training_iteration": 701, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-40-52", "timestamp": 1569080452, "time_this_iter_s": 30.47724676132202, "time_total_s": 21425.798505306244, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5808.834770679474, "timesteps_since_restore": 18584576, "iterations_since_restore": 190, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.88020531680877, "episode_reward_min": 49.14160671047697, "episode_reward_mean": 53.632303510119385, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.305473394564572, "agent_1": 27.326830115554742}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544289149231819, "mean_processing_ms": 3.5199103704386916, "mean_inference_ms": 2.09236062312646}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2016, "num_steps_trained": 101188096, "num_steps_sampled": 68757504, "sample_throughput": 7258.249, "train_throughput": 0.0, "num_weight_syncs": 36497, "num_samples_dropped": 309, "learner_queue": {"size_count": 117194, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.533, "replay_time_ms": 104.816, "update_priorities_time_ms": 54.466, "policy_agent_0": {"added_count": 4644608, "sampled_count": 6829568, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4644608, "sampled_count": 6829568, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48003488779067993, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4393652677536011, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 68757504, "episodes_total": 687600, "training_iteration": 702, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-41-23", "timestamp": 1569080483, "time_this_iter_s": 30.495229721069336, "time_total_s": 21456.293735027313, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c42c7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5839.330000400543, "timesteps_since_restore": 18686720, "iterations_since_restore": 191, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.53207702438639, "episode_reward_min": 46.76520931745279, "episode_reward_mean": 49.8767333373913, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.609321824024992, "agent_1": 23.267411513366273}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544228992595914, "mean_processing_ms": 3.520947872248091, "mean_inference_ms": 2.093307841412371}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2019, "num_steps_trained": 101337600, "num_steps_sampled": 68854784, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36686, "num_samples_dropped": 309, "learner_queue": {"size_count": 117777, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.543, "replay_time_ms": 106.993, "update_priorities_time_ms": 61.725, "policy_agent_0": {"added_count": 4667136, "sampled_count": 6868736, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4667136, "sampled_count": 6868736, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4681061804294586, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5113747119903564, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 68854784, "episodes_total": 688576, "training_iteration": 703, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-41-54", "timestamp": 1569080514, "time_this_iter_s": 30.59462881088257, "time_total_s": 21486.888363838196, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39ca60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5869.924629211426, "timesteps_since_restore": 18784000, "iterations_since_restore": 192, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.28138752129909, "episode_reward_min": 46.7652093174528, "episode_reward_mean": 51.33189717014504, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.90208963889808, "agent_1": 25.42980753124702}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6546429019475203, "mean_processing_ms": 3.520468810321111, "mean_inference_ms": 2.092681498158201}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2022, "num_steps_trained": 101490944, "num_steps_sampled": 68953600, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36880, "num_samples_dropped": 309, "learner_queue": {"size_count": 118376, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.178, "replay_time_ms": 102.154, "update_priorities_time_ms": 51.976, "policy_agent_0": {"added_count": 4695296, "sampled_count": 6907392, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4695296, "sampled_count": 6907392, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46224236488342285, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5502465963363647, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 68953600, "episodes_total": 689560, "training_iteration": 704, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-42-24", "timestamp": 1569080544, "time_this_iter_s": 30.670770406723022, "time_total_s": 21517.55913424492, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ed840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5900.595399618149, "timesteps_since_restore": 18882816, "iterations_since_restore": 193, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.38272836367589, "episode_reward_min": 47.59424206444165, "episode_reward_mean": 52.041041963344654, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.490529654152713, "agent_1": 25.550512309192076}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545661036898319, "mean_processing_ms": 3.5206819347341733, "mean_inference_ms": 2.0924163538817746}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2025, "num_steps_trained": 101639936, "num_steps_sampled": 69053696, "sample_throughput": 9727.508, "train_throughput": 9727.508, "num_weight_syncs": 37074, "num_samples_dropped": 309, "learner_queue": {"size_count": 118958, "size_mean": 0.22, "size_std": 0.4142463035441596, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.36, "replay_time_ms": 99.694, "update_priorities_time_ms": 57.47, "policy_agent_0": {"added_count": 4719360, "sampled_count": 6942976, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4719360, "sampled_count": 6942976, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46189573407173157, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6184993982315063, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 69053696, "episodes_total": 690568, "training_iteration": 705, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-42-55", "timestamp": 1569080575, "time_this_iter_s": 30.633501052856445, "time_total_s": 21548.192635297775, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c312268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5931.228900671005, "timesteps_since_restore": 18982912, "iterations_since_restore": 194, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.41201285553654, "episode_reward_min": 47.65068411921119, "episode_reward_mean": 52.372102223487495, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.51660392880775, "agent_1": 25.855498294679855}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6543248374768414, "mean_processing_ms": 3.520047869147118, "mean_inference_ms": 2.0924275592593977}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2028, "num_steps_trained": 101788672, "num_steps_sampled": 69153536, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 37270, "num_samples_dropped": 309, "learner_queue": {"size_count": 119539, "size_mean": 0.14, "size_std": 0.40049968789001567, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.137, "replay_time_ms": 73.624, "update_priorities_time_ms": 37.688, "policy_agent_0": {"added_count": 4744192, "sampled_count": 6979072, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4744192, "sampled_count": 6979072, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45427313446998596, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5886252522468567, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 69153536, "episodes_total": 691560, "training_iteration": 706, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-43-25", "timestamp": 1569080605, "time_this_iter_s": 30.46194624900818, "time_total_s": 21578.654581546783, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3d10d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5961.690846920013, "timesteps_since_restore": 19082752, "iterations_since_restore": 195, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 53.4001984339728, "episode_reward_min": 48.892840309015085, "episode_reward_mean": 52.97621091208505, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.595987889041005, "agent_1": 26.380223023044284}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544667250728944, "mean_processing_ms": 3.5194506609476512, "mean_inference_ms": 2.0917321986367026}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2031, "num_steps_trained": 101934080, "num_steps_sampled": 69253376, "sample_throughput": 0.0, "train_throughput": 22945.162, "num_weight_syncs": 37465, "num_samples_dropped": 309, "learner_queue": {"size_count": 120107, "size_mean": 0.14, "size_std": 0.40049968789001567, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.776, "replay_time_ms": 117.999, "update_priorities_time_ms": 54.837, "policy_agent_0": {"added_count": 4763648, "sampled_count": 7017216, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4763648, "sampled_count": 7017216, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46033674478530884, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5530938506126404, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 69253376, "episodes_total": 692560, "training_iteration": 707, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-43-56", "timestamp": 1569080636, "time_this_iter_s": 30.54220414161682, "time_total_s": 21609.1967856884, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ef158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5992.23305106163, "timesteps_since_restore": 19182592, "iterations_since_restore": 196, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.483959210079455, "episode_reward_min": 49.12992800772326, "episode_reward_mean": 53.58305834931537, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.990831098636452, "agent_1": 26.592227250678963}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545323312999233, "mean_processing_ms": 3.519605390780981, "mean_inference_ms": 2.0921301856252286}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2034, "num_steps_trained": 102083328, "num_steps_sampled": 69353216, "sample_throughput": 5786.089, "train_throughput": 5786.089, "num_weight_syncs": 37661, "num_samples_dropped": 309, "learner_queue": {"size_count": 120691, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.489, "replay_time_ms": 127.212, "update_priorities_time_ms": 60.201, "policy_agent_0": {"added_count": 4792576, "sampled_count": 7054592, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4792576, "sampled_count": 7054592, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4461309313774109, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5178235173225403, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 69353216, "episodes_total": 693552, "training_iteration": 708, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-44-27", "timestamp": 1569080667, "time_this_iter_s": 30.62370800971985, "time_total_s": 21639.82049369812, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2c0ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6022.85675907135, "timesteps_since_restore": 19282432, "iterations_since_restore": 197, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.40189811671645, "episode_reward_min": 48.84133426197036, "episode_reward_mean": 53.411327397995855, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.38642320203519, "agent_1": 27.024904195960687}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6545154236160207, "mean_processing_ms": 3.51865683874587, "mean_inference_ms": 2.0914173826142974}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2037, "num_steps_trained": 102231040, "num_steps_sampled": 69454080, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 37857, "num_samples_dropped": 309, "learner_queue": {"size_count": 121267, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.23, "replay_time_ms": 99.582, "update_priorities_time_ms": 51.111, "policy_agent_0": {"added_count": 4816384, "sampled_count": 7091456, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4816384, "sampled_count": 7091456, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45428696274757385, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5113509893417358, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 69454080, "episodes_total": 694568, "training_iteration": 709, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-44-57", "timestamp": 1569080697, "time_this_iter_s": 30.522573709487915, "time_total_s": 21670.343067407608, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2b4048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6053.379332780838, "timesteps_since_restore": 19383296, "iterations_since_restore": 198, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.52353770878136, "episode_reward_min": 45.413744378050296, "episode_reward_mean": 48.3418589186221, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.614213074307045, "agent_1": 19.727645844315056}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6544752885251203, "mean_processing_ms": 3.5186512365320426, "mean_inference_ms": 2.0913003873113887}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2040, "num_steps_trained": 102375680, "num_steps_sampled": 69554944, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38053, "num_samples_dropped": 309, "learner_queue": {"size_count": 121832, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.045, "replay_time_ms": 97.925, "update_priorities_time_ms": 48.297, "policy_agent_0": {"added_count": 4840960, "sampled_count": 7127296, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4840960, "sampled_count": 7127296, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43000590801239014, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6102608442306519, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 69554944, "episodes_total": 695568, "training_iteration": 710, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-45-28", "timestamp": 1569080728, "time_this_iter_s": 30.65903067588806, "time_total_s": 21701.002098083496, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2b4bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6084.038363456726, "timesteps_since_restore": 19484160, "iterations_since_restore": 199, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.57036422866194, "episode_reward_min": 48.10272853437916, "episode_reward_mean": 50.311393775964675, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 29.85908290135737, "agent_1": 20.452310874607335}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6543334813410147, "mean_processing_ms": 3.5180723222881176, "mean_inference_ms": 2.0910597268603337}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2042, "num_steps_trained": 102518272, "num_steps_sampled": 69657088, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38254, "num_samples_dropped": 309, "learner_queue": {"size_count": 122390, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.123, "replay_time_ms": 97.215, "update_priorities_time_ms": 60.121, "policy_agent_0": {"added_count": 4868096, "sampled_count": 7162112, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4868096, "sampled_count": 7162112, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40776878595352173, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.717326819896698, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 69657088, "episodes_total": 696592, "training_iteration": 711, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-45-59", "timestamp": 1569080759, "time_this_iter_s": 30.666430950164795, "time_total_s": 21731.66852903366, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c015158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6114.704794406891, "timesteps_since_restore": 19586304, "iterations_since_restore": 200, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 52.7726993029271, "episode_reward_min": 46.379349196291656, "episode_reward_mean": 49.42186998136013, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 29.163458752946205, "agent_1": 20.25841122841393}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.654338306890679, "mean_processing_ms": 3.5179626509951714, "mean_inference_ms": 2.0909302351464674}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2045, "num_steps_trained": 102663936, "num_steps_sampled": 69758976, "sample_throughput": 8984.949, "train_throughput": 4492.474, "num_weight_syncs": 38453, "num_samples_dropped": 309, "learner_queue": {"size_count": 122959, "size_mean": 0.26, "size_std": 0.5219195340279956, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.629, "replay_time_ms": 103.777, "update_priorities_time_ms": 54.749, "policy_agent_0": {"added_count": 4894976, "sampled_count": 7197952, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4894976, "sampled_count": 7197952, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3749767541885376, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8130348324775696, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 69758976, "episodes_total": 697608, "training_iteration": 712, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-46-29", "timestamp": 1569080789, "time_this_iter_s": 30.57748770713806, "time_total_s": 21762.2460167408, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3d1840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6145.282282114029, "timesteps_since_restore": 19688192, "iterations_since_restore": 201, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.61263562079158, "episode_reward_min": 46.79588438522266, "episode_reward_mean": 52.93454644191483, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 31.115093033283575, "agent_1": 21.819453408631283}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6542716922030148, "mean_processing_ms": 3.5175781699407014, "mean_inference_ms": 2.0906808204790956}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2048, "num_steps_trained": 102812160, "num_steps_sampled": 69859584, "sample_throughput": 5963.046, "train_throughput": 5963.046, "num_weight_syncs": 38649, "num_samples_dropped": 309, "learner_queue": {"size_count": 123538, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.418, "replay_time_ms": 107.106, "update_priorities_time_ms": 57.023, "policy_agent_0": {"added_count": 4918272, "sampled_count": 7235840, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4918272, "sampled_count": 7235840, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3707416355609894, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8395442962646484, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 69859584, "episodes_total": 698616, "training_iteration": 713, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-47-00", "timestamp": 1569080820, "time_this_iter_s": 30.537352800369263, "time_total_s": 21792.78336954117, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6175.819634914398, "timesteps_since_restore": 19788800, "iterations_since_restore": 202, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.63592923828469, "episode_reward_min": 47.34020327489109, "episode_reward_mean": 54.22609415525738, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 31.657460348529163, "agent_1": 22.56863380672824}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6542251323801572, "mean_processing_ms": 3.5171966843767617, "mean_inference_ms": 2.090573161091682}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2051, "num_steps_trained": 102961920, "num_steps_sampled": 69958400, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38841, "num_samples_dropped": 309, "learner_queue": {"size_count": 124122, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.536, "replay_time_ms": 91.305, "update_priorities_time_ms": 52.494, "policy_agent_0": {"added_count": 4940288, "sampled_count": 7274240, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4940288, "sampled_count": 7274240, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35949066281318665, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8403691053390503, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 69958400, "episodes_total": 699608, "training_iteration": 714, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-47-30", "timestamp": 1569080850, "time_this_iter_s": 30.513503074645996, "time_total_s": 21823.296872615814, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2edbf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6206.333137989044, "timesteps_since_restore": 19887616, "iterations_since_restore": 203, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.83424439772921, "episode_reward_min": 53.92589218583615, "episode_reward_mean": 54.411161591329105, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 31.66248012260191, "agent_1": 22.748681468727227}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6540288780565432, "mean_processing_ms": 3.5170012176535326, "mean_inference_ms": 2.090338849912723}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2054, "num_steps_trained": 103107840, "num_steps_sampled": 70060544, "sample_throughput": 11186.325, "train_throughput": 5593.163, "num_weight_syncs": 39042, "num_samples_dropped": 309, "learner_queue": {"size_count": 124692, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.078, "replay_time_ms": 107.79, "update_priorities_time_ms": 57.096, "policy_agent_0": {"added_count": 4965888, "sampled_count": 7311616, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4965888, "sampled_count": 7311616, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31661054491996765, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8347160816192627, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 70060544, "episodes_total": 700624, "training_iteration": 715, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-48-01", "timestamp": 1569080881, "time_this_iter_s": 30.667520761489868, "time_total_s": 21853.964393377304, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c332730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6237.000658750534, "timesteps_since_restore": 19989760, "iterations_since_restore": 204, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.71050580382787, "episode_reward_min": 54.039633007422005, "episode_reward_mean": 54.412637598654776, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 31.855430624271683, "agent_1": 22.557206974383124}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.654185189695222, "mean_processing_ms": 3.516587884595667, "mean_inference_ms": 2.0900255521001943}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2057, "num_steps_trained": 103256064, "num_steps_sampled": 70161152, "sample_throughput": 9579.568, "train_throughput": 0.0, "num_weight_syncs": 39239, "num_samples_dropped": 309, "learner_queue": {"size_count": 125271, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.077, "replay_time_ms": 106.556, "update_priorities_time_ms": 53.827, "policy_agent_0": {"added_count": 4992512, "sampled_count": 7349248, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 4992512, "sampled_count": 7349248, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30668336153030396, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8417041301727295, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 70161152, "episodes_total": 701632, "training_iteration": 716, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-48-32", "timestamp": 1569080912, "time_this_iter_s": 30.53164052963257, "time_total_s": 21884.496033906937, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c42cae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6267.532299280167, "timesteps_since_restore": 20090368, "iterations_since_restore": 205, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.67731456861687, "episode_reward_min": 53.64501624950538, "episode_reward_mean": 54.393569448740635, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 31.672135699815804, "agent_1": 22.721433748924856}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6539318455390686, "mean_processing_ms": 3.516551709456745, "mean_inference_ms": 2.090182821279801}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2060, "num_steps_trained": 103402240, "num_steps_sampled": 70262272, "sample_throughput": 6691.523, "train_throughput": 6691.523, "num_weight_syncs": 39436, "num_samples_dropped": 309, "learner_queue": {"size_count": 125843, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.994, "replay_time_ms": 122.685, "update_priorities_time_ms": 62.284, "policy_agent_0": {"added_count": 5019904, "sampled_count": 7385088, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5019904, "sampled_count": 7385088, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2793213725090027, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8358254432678223, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 70262272, "episodes_total": 702648, "training_iteration": 717, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-49-02", "timestamp": 1569080942, "time_this_iter_s": 30.671555042266846, "time_total_s": 21915.167588949203, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c368598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6298.2038543224335, "timesteps_since_restore": 20191488, "iterations_since_restore": 206, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.57335612699459, "episode_reward_min": 48.442615891776285, "episode_reward_mean": 53.6710321373583, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 32.30828412930229, "agent_1": 21.362748008056023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6539347047914176, "mean_processing_ms": 3.515753041651947, "mean_inference_ms": 2.089583201996741}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2063, "num_steps_trained": 103547136, "num_steps_sampled": 70363648, "sample_throughput": 3254.444, "train_throughput": 3254.444, "num_weight_syncs": 39633, "num_samples_dropped": 309, "learner_queue": {"size_count": 126408, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.959, "replay_time_ms": 94.784, "update_priorities_time_ms": 55.15, "policy_agent_0": {"added_count": 5046528, "sampled_count": 7420160, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5046528, "sampled_count": 7420160, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2831781208515167, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8351252675056458, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 70363648, "episodes_total": 703664, "training_iteration": 718, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-49-33", "timestamp": 1569080973, "time_this_iter_s": 30.674975872039795, "time_total_s": 21945.842564821243, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6328.878830194473, "timesteps_since_restore": 20292864, "iterations_since_restore": 207, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.014432803119284, "episode_reward_min": 47.34506161061606, "episode_reward_mean": 51.719513257529464, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 32.41689850234533, "agent_1": 19.302614755184145}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6540038738350306, "mean_processing_ms": 3.5152524466919868, "mean_inference_ms": 2.089068726649747}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2066, "num_steps_trained": 103692032, "num_steps_sampled": 70465024, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 39831, "num_samples_dropped": 309, "learner_queue": {"size_count": 126974, "size_mean": 0.2, "size_std": 0.48989794855663565, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.891, "replay_time_ms": 96.75, "update_priorities_time_ms": 47.679, "policy_agent_0": {"added_count": 5071872, "sampled_count": 7457280, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5071872, "sampled_count": 7457280, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.26739782094955444, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8542195558547974, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 70465024, "episodes_total": 704680, "training_iteration": 719, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-50-04", "timestamp": 1569081004, "time_this_iter_s": 30.515471935272217, "time_total_s": 21976.358036756516, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6359.3943021297455, "timesteps_since_restore": 20394240, "iterations_since_restore": 208, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.65121781308888, "episode_reward_min": 49.93443551666907, "episode_reward_mean": 53.977727913614224, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 32.93820906859247, "agent_1": 21.039518845021753}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6539301538262694, "mean_processing_ms": 3.515528475164985, "mean_inference_ms": 2.0894585234087173}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2069, "num_steps_trained": 103840256, "num_steps_sampled": 70564864, "sample_throughput": 28129.043, "train_throughput": 0.0, "num_weight_syncs": 40026, "num_samples_dropped": 309, "learner_queue": {"size_count": 127553, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.484, "replay_time_ms": 117.422, "update_priorities_time_ms": 61.479, "policy_agent_0": {"added_count": 5099776, "sampled_count": 7494144, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5099776, "sampled_count": 7494144, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.26885107159614563, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8665684461593628, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 70564864, "episodes_total": 705680, "training_iteration": 720, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-50-34", "timestamp": 1569081034, "time_this_iter_s": 30.545079231262207, "time_total_s": 22006.903115987778, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4dea60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6389.939381361008, "timesteps_since_restore": 20494080, "iterations_since_restore": 209, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.887182544011786, "episode_reward_min": 50.139230860895616, "episode_reward_mean": 54.406940847664394, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 34.942033419096894, "agent_1": 19.464907428567525}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538247065444335, "mean_processing_ms": 3.514840964216386, "mean_inference_ms": 2.088833086908307}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2072, "num_steps_trained": 103982592, "num_steps_sampled": 70667264, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 40227, "num_samples_dropped": 309, "learner_queue": {"size_count": 128109, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 44.084, "replay_time_ms": 110.603, "update_priorities_time_ms": 56.388, "policy_agent_0": {"added_count": 5123072, "sampled_count": 7528960, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5123072, "sampled_count": 7528960, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2609713077545166, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8800599575042725, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 70667264, "episodes_total": 706696, "training_iteration": 721, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-51-05", "timestamp": 1569081065, "time_this_iter_s": 30.572914838790894, "time_total_s": 22037.47603082657, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cf510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6420.512296199799, "timesteps_since_restore": 20596480, "iterations_since_restore": 210, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.47414356547035, "episode_reward_min": 44.38820931314864, "episode_reward_mean": 48.14374173382274, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.960343104238053, "agent_1": 21.183398629584737}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538961060373967, "mean_processing_ms": 3.513441655883274, "mean_inference_ms": 2.0876705385848453}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2074, "num_steps_trained": 104125952, "num_steps_sampled": 70769152, "sample_throughput": 12949.754, "train_throughput": 0.0, "num_weight_syncs": 40425, "num_samples_dropped": 309, "learner_queue": {"size_count": 128669, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.546, "replay_time_ms": 117.539, "update_priorities_time_ms": 55.495, "policy_agent_0": {"added_count": 5150464, "sampled_count": 7566336, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5150464, "sampled_count": 7566336, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2961771488189697, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8863271474838257, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 70769152, "episodes_total": 707720, "training_iteration": 722, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-51-35", "timestamp": 1569081095, "time_this_iter_s": 30.559889554977417, "time_total_s": 22068.035920381546, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6451.072185754776, "timesteps_since_restore": 20698368, "iterations_since_restore": 211, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.873167924524274, "episode_reward_min": 45.13746002665859, "episode_reward_mean": 46.718947559424755, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.345121592762077, "agent_1": 21.373825966662732}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6536478983971954, "mean_processing_ms": 3.5142024097207023, "mean_inference_ms": 2.0881540380079016}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2077, "num_steps_trained": 104270848, "num_steps_sampled": 70869760, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 40621, "num_samples_dropped": 309, "learner_queue": {"size_count": 129235, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.039, "replay_time_ms": 96.092, "update_priorities_time_ms": 44.223, "policy_agent_0": {"added_count": 5176576, "sampled_count": 7602176, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5176576, "sampled_count": 7602176, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3406778573989868, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8856755495071411, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 70869760, "episodes_total": 708728, "training_iteration": 723, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-52-06", "timestamp": 1569081126, "time_this_iter_s": 30.570096731185913, "time_total_s": 22098.606017112732, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39f0d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6481.642282485962, "timesteps_since_restore": 20798976, "iterations_since_restore": 212, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.88976930805113, "episode_reward_min": 48.39756235733423, "episode_reward_mean": 56.24695243764807, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.64171208694678, "agent_1": 28.605240350701518}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6537301052011834, "mean_processing_ms": 3.514324125817563, "mean_inference_ms": 2.0876958678166218}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2080, "num_steps_trained": 104417280, "num_steps_sampled": 70971136, "sample_throughput": 17797.809, "train_throughput": 0.0, "num_weight_syncs": 40819, "num_samples_dropped": 309, "learner_queue": {"size_count": 129807, "size_mean": 0.24, "size_std": 0.4270831300812525, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.838, "replay_time_ms": 107.112, "update_priorities_time_ms": 47.101, "policy_agent_0": {"added_count": 5203712, "sampled_count": 7639808, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5203712, "sampled_count": 7639808, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38984254002571106, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8756815195083618, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 70971136, "episodes_total": 709744, "training_iteration": 724, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-52-37", "timestamp": 1569081157, "time_this_iter_s": 30.594024419784546, "time_total_s": 22129.200041532516, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c307400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6512.2363069057465, "timesteps_since_restore": 20900352, "iterations_since_restore": 213, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.90421712431102, "episode_reward_min": 48.37015799385101, "episode_reward_mean": 56.327313550245364, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 27.188405031809214, "agent_1": 29.138908518436384}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538666274327898, "mean_processing_ms": 3.514049362605644, "mean_inference_ms": 2.0873808930114253}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2083, "num_steps_trained": 104567296, "num_steps_sampled": 71069696, "sample_throughput": 33343.948, "train_throughput": 0.0, "num_weight_syncs": 41012, "num_samples_dropped": 309, "learner_queue": {"size_count": 130393, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.031, "replay_time_ms": 107.396, "update_priorities_time_ms": 51.689, "policy_agent_0": {"added_count": 5226752, "sampled_count": 7677952, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5226752, "sampled_count": 7677952, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3894534707069397, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8208041191101074, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 71069696, "episodes_total": 710720, "training_iteration": 725, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-53-07", "timestamp": 1569081187, "time_this_iter_s": 30.527751684188843, "time_total_s": 22159.727793216705, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c429730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6542.764058589935, "timesteps_since_restore": 20998912, "iterations_since_restore": 214, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.93998037149766, "episode_reward_min": 55.97691022943643, "episode_reward_mean": 56.710128980626315, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.123507316240147, "agent_1": 29.586621664386417}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6539199991332095, "mean_processing_ms": 3.5136672882229916, "mean_inference_ms": 2.0868824453684613}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2086, "num_steps_trained": 104713472, "num_steps_sampled": 71169792, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 41209, "num_samples_dropped": 309, "learner_queue": {"size_count": 130964, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.401, "replay_time_ms": 105.849, "update_priorities_time_ms": 52.604, "policy_agent_0": {"added_count": 5253376, "sampled_count": 7715072, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5253376, "sampled_count": 7715072, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3976001441478729, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6926043033599854, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 71169792, "episodes_total": 711728, "training_iteration": 726, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-53-38", "timestamp": 1569081218, "time_this_iter_s": 30.512617826461792, "time_total_s": 22190.240411043167, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c37b268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6573.276676416397, "timesteps_since_restore": 21099008, "iterations_since_restore": 215, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.92516779771697, "episode_reward_min": 55.79803185701036, "episode_reward_mean": 56.6402667291819, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.113514868539752, "agent_1": 29.526751860642406}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538246976418894, "mean_processing_ms": 3.5131350100800978, "mean_inference_ms": 2.0865135670338035}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2089, "num_steps_trained": 104857856, "num_steps_sampled": 71271680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 41406, "num_samples_dropped": 309, "learner_queue": {"size_count": 131528, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.433, "replay_time_ms": 87.704, "update_priorities_time_ms": 42.961, "policy_agent_0": {"added_count": 5279232, "sampled_count": 7751680, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5279232, "sampled_count": 7751680, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38238856196403503, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5852343440055847, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 71271680, "episodes_total": 712736, "training_iteration": 727, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-54-08", "timestamp": 1569081248, "time_this_iter_s": 30.53544020652771, "time_total_s": 22220.775851249695, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3461e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6603.812116622925, "timesteps_since_restore": 21200896, "iterations_since_restore": 216, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.905547711688996, "episode_reward_min": 55.56140483475461, "episode_reward_mean": 56.60098267236297, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.12271027336868, "agent_1": 29.47827239899454}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6539078560483678, "mean_processing_ms": 3.513233855404858, "mean_inference_ms": 2.085994997181589}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2092, "num_steps_trained": 105002240, "num_steps_sampled": 71372288, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 41604, "num_samples_dropped": 309, "learner_queue": {"size_count": 132092, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.364, "replay_time_ms": 116.71, "update_priorities_time_ms": 56.965, "policy_agent_0": {"added_count": 5304576, "sampled_count": 7786496, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5304576, "sampled_count": 7786496, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4135773479938507, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.506140947341919, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 71372288, "episodes_total": 713752, "training_iteration": 728, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-54-39", "timestamp": 1569081279, "time_this_iter_s": 30.62628483772278, "time_total_s": 22251.402136087418, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c341950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6634.438401460648, "timesteps_since_restore": 21301504, "iterations_since_restore": 217, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.90811349337739, "episode_reward_min": 55.52299052607536, "episode_reward_mean": 56.61105505975321, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.119917346070878, "agent_1": 29.491137713682583}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538766105030318, "mean_processing_ms": 3.51330296263745, "mean_inference_ms": 2.086104625939389}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2095, "num_steps_trained": 105150720, "num_steps_sampled": 71471616, "sample_throughput": 6006.006, "train_throughput": 0.0, "num_weight_syncs": 41798, "num_samples_dropped": 309, "learner_queue": {"size_count": 132673, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.593, "replay_time_ms": 98.089, "update_priorities_time_ms": 51.934, "policy_agent_0": {"added_count": 5329920, "sampled_count": 7823616, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5329920, "sampled_count": 7823616, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41479477286338806, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45026805996894836, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 71471616, "episodes_total": 714752, "training_iteration": 729, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-55-10", "timestamp": 1569081310, "time_this_iter_s": 30.534417390823364, "time_total_s": 22281.93655347824, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ca9d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6664.972818851471, "timesteps_since_restore": 21400832, "iterations_since_restore": 218, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.91396024688989, "episode_reward_min": 55.63567054671505, "episode_reward_mean": 56.63740836866473, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.118620243942, "agent_1": 29.518788124722978}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538751606860099, "mean_processing_ms": 3.513075682285501, "mean_inference_ms": 2.085505607908257}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2098, "num_steps_trained": 105296896, "num_steps_sampled": 71572480, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 41994, "num_samples_dropped": 309, "learner_queue": {"size_count": 133243, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.363, "replay_time_ms": 118.103, "update_priorities_time_ms": 56.202, "policy_agent_0": {"added_count": 5358336, "sampled_count": 7858688, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5358336, "sampled_count": 7858688, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4217267632484436, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41945409774780273, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 71572480, "episodes_total": 715752, "training_iteration": 730, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-55-40", "timestamp": 1569081340, "time_this_iter_s": 30.616018056869507, "time_total_s": 22312.55257153511, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28ed08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6695.58883690834, "timesteps_since_restore": 21501696, "iterations_since_restore": 219, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.89343285542936, "episode_reward_min": 52.27671489043167, "episode_reward_mean": 56.02117904297593, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.3400253695447, "agent_1": 28.681153673431442}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653804500878564, "mean_processing_ms": 3.5128889572387996, "mean_inference_ms": 2.085416606519526}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2101, "num_steps_trained": 105443840, "num_steps_sampled": 71672576, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 42190, "num_samples_dropped": 309, "learner_queue": {"size_count": 133817, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.818, "replay_time_ms": 85.046, "update_priorities_time_ms": 47.586, "policy_agent_0": {"added_count": 5380864, "sampled_count": 7897088, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5380864, "sampled_count": 7897088, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4223968982696533, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3958856463432312, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 71672576, "episodes_total": 716752, "training_iteration": 731, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-56-11", "timestamp": 1569081371, "time_this_iter_s": 30.46389079093933, "time_total_s": 22343.01646232605, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c0240d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6726.05272769928, "timesteps_since_restore": 21601792, "iterations_since_restore": 220, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 52.836331451080596, "episode_reward_min": 50.12226439230313, "episode_reward_mean": 51.944507274975315, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.5861947268178, "agent_1": 24.358312548157535}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6537282617359662, "mean_processing_ms": 3.5126610887301597, "mean_inference_ms": 2.085478825127514}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2104, "num_steps_trained": 105588480, "num_steps_sampled": 71773696, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 42387, "num_samples_dropped": 309, "learner_queue": {"size_count": 134382, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.583, "replay_time_ms": 102.162, "update_priorities_time_ms": 49.296, "policy_agent_0": {"added_count": 5403904, "sampled_count": 7933696, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5403904, "sampled_count": 7933696, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40862172842025757, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4304405748844147, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 71773696, "episodes_total": 717768, "training_iteration": 732, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-56-41", "timestamp": 1569081401, "time_this_iter_s": 30.550509214401245, "time_total_s": 22373.56697154045, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6756.603236913681, "timesteps_since_restore": 21702912, "iterations_since_restore": 221, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.86386171575519, "episode_reward_min": 50.18896919210701, "episode_reward_mean": 51.07972870269042, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.6267085503085, "agent_1": 25.45302015238181}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538419888600673, "mean_processing_ms": 3.512148460389731, "mean_inference_ms": 2.0849962678148026}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2106, "num_steps_trained": 105736192, "num_steps_sampled": 71872768, "sample_throughput": 0.0, "train_throughput": 34726.45, "num_weight_syncs": 42581, "num_samples_dropped": 309, "learner_queue": {"size_count": 134959, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.952, "replay_time_ms": 120.946, "update_priorities_time_ms": 60.314, "policy_agent_0": {"added_count": 5431040, "sampled_count": 7969536, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5431040, "sampled_count": 7969536, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41754037141799927, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48294660449028015, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 71872768, "episodes_total": 718760, "training_iteration": 733, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-57-12", "timestamp": 1569081432, "time_this_iter_s": 30.626115083694458, "time_total_s": 22404.193086624146, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c0291e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6787.2293519973755, "timesteps_since_restore": 21801984, "iterations_since_restore": 222, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 51.809306240192285, "episode_reward_min": 47.29848325843629, "episode_reward_mean": 49.51753784069806, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.529702679706404, "agent_1": 23.98783516099158}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538668971394206, "mean_processing_ms": 3.5117995003267835, "mean_inference_ms": 2.08510415093337}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2109, "num_steps_trained": 105884928, "num_steps_sampled": 71971072, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 42773, "num_samples_dropped": 309, "learner_queue": {"size_count": 135540, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.615, "replay_time_ms": 105.8, "update_priorities_time_ms": 56.15, "policy_agent_0": {"added_count": 5454080, "sampled_count": 8006656, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5454080, "sampled_count": 8006656, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43191370368003845, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49260854721069336, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 71971072, "episodes_total": 719728, "training_iteration": 734, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-57-43", "timestamp": 1569081463, "time_this_iter_s": 30.561140775680542, "time_total_s": 22434.754227399826, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c029d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6817.790492773056, "timesteps_since_restore": 21900288, "iterations_since_restore": 223, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.848006365031175, "episode_reward_min": 46.40536351173107, "episode_reward_mean": 49.33886134708898, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 24.55715471808487, "agent_1": 24.781706629004074}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6537855777709246, "mean_processing_ms": 3.511188913225299, "mean_inference_ms": 2.084810789482531}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2112, "num_steps_trained": 106029568, "num_steps_sampled": 72071168, "sample_throughput": 6349.369, "train_throughput": 6349.369, "num_weight_syncs": 42968, "num_samples_dropped": 309, "learner_queue": {"size_count": 136106, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.806, "replay_time_ms": 115.314, "update_priorities_time_ms": 59.071, "policy_agent_0": {"added_count": 5476096, "sampled_count": 8042496, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5476096, "sampled_count": 8042496, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47289764881134033, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5504931211471558, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 72071168, "episodes_total": 720744, "training_iteration": 735, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-58-13", "timestamp": 1569081493, "time_this_iter_s": 30.580305337905884, "time_total_s": 22465.334532737732, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c0372f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6848.370798110962, "timesteps_since_restore": 22000384, "iterations_since_restore": 224, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.366538896409786, "episode_reward_min": 48.2534708230464, "episode_reward_mean": 53.44027469926547, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.480822908816165, "agent_1": 27.959451790449265}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6537324636584899, "mean_processing_ms": 3.5117329229365626, "mean_inference_ms": 2.085086581756125}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2115, "num_steps_trained": 106173952, "num_steps_sampled": 72170752, "sample_throughput": 6742.577, "train_throughput": 0.0, "num_weight_syncs": 43163, "num_samples_dropped": 309, "learner_queue": {"size_count": 136669, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.505, "replay_time_ms": 106.35, "update_priorities_time_ms": 56.968, "policy_agent_0": {"added_count": 5501184, "sampled_count": 8077056, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5501184, "sampled_count": 8077056, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4808315932750702, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5505871176719666, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 72170752, "episodes_total": 721736, "training_iteration": 736, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-58-44", "timestamp": 1569081524, "time_this_iter_s": 30.57692527770996, "time_total_s": 22495.911458015442, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6878.947723388672, "timesteps_since_restore": 22099968, "iterations_since_restore": 225, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.327311855212265, "episode_reward_min": 43.734324625809066, "episode_reward_mean": 51.52131124519777, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 23.798962869960782, "agent_1": 27.722348375237033}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6538236236123826, "mean_processing_ms": 3.5118234939505, "mean_inference_ms": 2.084820297768338}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2118, "num_steps_trained": 106323456, "num_steps_sampled": 72267776, "sample_throughput": 0.0, "train_throughput": 11510.708, "num_weight_syncs": 43352, "num_samples_dropped": 309, "learner_queue": {"size_count": 137254, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.486, "replay_time_ms": 100.631, "update_priorities_time_ms": 58.167, "policy_agent_0": {"added_count": 5524480, "sampled_count": 8115712, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5524480, "sampled_count": 8115712, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5098382830619812, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5078946948051453, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 72267776, "episodes_total": 722712, "training_iteration": 737, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-59-14", "timestamp": 1569081554, "time_this_iter_s": 30.497628450393677, "time_total_s": 22526.409086465836, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28e378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6909.445351839066, "timesteps_since_restore": 22196992, "iterations_since_restore": 226, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.383655108637385, "episode_reward_min": 45.48798791733514, "episode_reward_mean": 52.01091453274035, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 23.95005149275145, "agent_1": 28.0608630399889}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6537007193136669, "mean_processing_ms": 3.5115576446483976, "mean_inference_ms": 2.0852240268056303}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2121, "num_steps_trained": 106470912, "num_steps_sampled": 72366592, "sample_throughput": 0.0, "train_throughput": 31196.195, "num_weight_syncs": 43545, "num_samples_dropped": 309, "learner_queue": {"size_count": 137829, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.037, "replay_time_ms": 89.067, "update_priorities_time_ms": 46.185, "policy_agent_0": {"added_count": 5552384, "sampled_count": 8153856, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5552384, "sampled_count": 8153856, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5597270131111145, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47840264439582825, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 72366592, "episodes_total": 723696, "training_iteration": 738, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_15-59-45", "timestamp": 1569081585, "time_this_iter_s": 30.586946964263916, "time_total_s": 22556.9960334301, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ca268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6940.0322988033295, "timesteps_since_restore": 22295808, "iterations_since_restore": 227, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.49347624008491, "episode_reward_min": 48.90563412631771, "episode_reward_mean": 53.32006953830107, "episode_len_mean": 100.0, "episodes_this_iter": 920, "policy_reward_mean": {"agent_0": 24.842367370712612, "agent_1": 28.47770216758845}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6537724541836144, "mean_processing_ms": 3.5122911680990607, "mean_inference_ms": 2.0861486195222843}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2124, "num_steps_trained": 106606336, "num_steps_sampled": 72459264, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 43726, "num_samples_dropped": 309, "learner_queue": {"size_count": 138358, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.821, "replay_time_ms": 103.667, "update_priorities_time_ms": 55.55, "policy_agent_0": {"added_count": 5574144, "sampled_count": 8188928, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5574144, "sampled_count": 8188928, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6206941604614258, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4429168105125427, "model": {}}}}, "timesteps_this_iter": 92672, "done": false, "timesteps_total": 72459264, "episodes_total": 724616, "training_iteration": 739, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-00-15", "timestamp": 1569081615, "time_this_iter_s": 30.536982774734497, "time_total_s": 22587.533016204834, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2a1a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6970.569281578064, "timesteps_since_restore": 22388480, "iterations_since_restore": 228, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.09690027277272, "episode_reward_min": 47.42435042860558, "episode_reward_mean": 54.55741530327813, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.21499132373148, "agent_1": 29.342423979546624}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653660238146037, "mean_processing_ms": 3.511845101148142, "mean_inference_ms": 2.086083357480828}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2127, "num_steps_trained": 106757632, "num_steps_sampled": 72557824, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 43919, "num_samples_dropped": 309, "learner_queue": {"size_count": 138949, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.058, "replay_time_ms": 73.692, "update_priorities_time_ms": 36.152, "policy_agent_0": {"added_count": 5596160, "sampled_count": 8227584, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5596160, "sampled_count": 8227584, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5958044528961182, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43772754073143005, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 72557824, "episodes_total": 725600, "training_iteration": 740, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-00-46", "timestamp": 1569081646, "time_this_iter_s": 30.486804723739624, "time_total_s": 22618.019820928574, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c346048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7001.056086301804, "timesteps_since_restore": 22487040, "iterations_since_restore": 229, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.68599442433007, "episode_reward_min": 53.95336116139977, "episode_reward_mean": 54.91036223922444, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 25.250617185061063, "agent_1": 29.659745054163338}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6536332337540587, "mean_processing_ms": 3.5115108787410807, "mean_inference_ms": 2.085910644945119}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2130, "num_steps_trained": 106903296, "num_steps_sampled": 72658688, "sample_throughput": 3049.606, "train_throughput": 9148.818, "num_weight_syncs": 44117, "num_samples_dropped": 309, "learner_queue": {"size_count": 139518, "size_mean": 0.12, "size_std": 0.3815756805667783, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.311, "replay_time_ms": 100.05, "update_priorities_time_ms": 45.731, "policy_agent_0": {"added_count": 5619968, "sampled_count": 8266752, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5619968, "sampled_count": 8266752, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5445796847343445, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4082721769809723, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 72658688, "episodes_total": 726624, "training_iteration": 741, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-01-17", "timestamp": 1569081677, "time_this_iter_s": 30.569000959396362, "time_total_s": 22648.58882188797, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43f840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7031.6250872612, "timesteps_since_restore": 22587904, "iterations_since_restore": 230, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.224290959752466, "episode_reward_min": 46.67496545764487, "episode_reward_mean": 54.399035765542564, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.650457575024273, "agent_1": 28.748578190518224}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6536068844224919, "mean_processing_ms": 3.5109905028192774, "mean_inference_ms": 2.0853927678116984}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2133, "num_steps_trained": 107047424, "num_steps_sampled": 72758784, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 44311, "num_samples_dropped": 309, "learner_queue": {"size_count": 140081, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.951, "replay_time_ms": 94.846, "update_priorities_time_ms": 47.113, "policy_agent_0": {"added_count": 5643776, "sampled_count": 8304128, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5643776, "sampled_count": 8304128, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5228047370910645, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39089682698249817, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 72758784, "episodes_total": 727616, "training_iteration": 742, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-01-47", "timestamp": 1569081707, "time_this_iter_s": 30.45438838005066, "time_total_s": 22679.04321026802, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c429048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7062.079475641251, "timesteps_since_restore": 22688000, "iterations_since_restore": 231, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.453728089868484, "episode_reward_min": 48.80765472779466, "episode_reward_mean": 54.19915660462361, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.926530626710445, "agent_1": 28.272625977913087}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6536294672163299, "mean_processing_ms": 3.5114771916026006, "mean_inference_ms": 2.08539152394944}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2136, "num_steps_trained": 107195648, "num_steps_sampled": 72858368, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 44506, "num_samples_dropped": 309, "learner_queue": {"size_count": 140660, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.403, "replay_time_ms": 90.543, "update_priorities_time_ms": 45.711, "policy_agent_0": {"added_count": 5667584, "sampled_count": 8343040, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5667584, "sampled_count": 8343040, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49732306599617004, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3709656596183777, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 72858368, "episodes_total": 728616, "training_iteration": 743, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-02-18", "timestamp": 1569081738, "time_this_iter_s": 30.49735927581787, "time_total_s": 22709.54056954384, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39f730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7092.5768349170685, "timesteps_since_restore": 22787584, "iterations_since_restore": 232, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.491234999651724, "episode_reward_min": 49.35794862260303, "episode_reward_mean": 54.23849096586694, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.950724850120874, "agent_1": 28.287766115745985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653716046100749, "mean_processing_ms": 3.510453377503981, "mean_inference_ms": 2.0847305507960012}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2139, "num_steps_trained": 107342336, "num_steps_sampled": 72958464, "sample_throughput": 15589.492, "train_throughput": 0.0, "num_weight_syncs": 44702, "num_samples_dropped": 309, "learner_queue": {"size_count": 141233, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.491, "replay_time_ms": 122.581, "update_priorities_time_ms": 62.619, "policy_agent_0": {"added_count": 5690112, "sampled_count": 8380160, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5690112, "sampled_count": 8380160, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5030093193054199, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36541181802749634, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 72958464, "episodes_total": 729608, "training_iteration": 744, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-02-48", "timestamp": 1569081768, "time_this_iter_s": 30.63293981552124, "time_total_s": 22740.17350935936, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f2598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7123.20977473259, "timesteps_since_restore": 22887680, "iterations_since_restore": 233, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.45814513160622, "episode_reward_min": 47.25345859717445, "episode_reward_mean": 53.77116465251172, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.98077396351848, "agent_1": 27.790390688993163}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6535948883461961, "mean_processing_ms": 3.511216896587409, "mean_inference_ms": 2.0855109818320456}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2141, "num_steps_trained": 107492096, "num_steps_sampled": 73057536, "sample_throughput": 5800.906, "train_throughput": 5800.906, "num_weight_syncs": 44896, "num_samples_dropped": 309, "learner_queue": {"size_count": 141820, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.388, "replay_time_ms": 105.508, "update_priorities_time_ms": 51.024, "policy_agent_0": {"added_count": 5715968, "sampled_count": 8418560, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5715968, "sampled_count": 8418560, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5000103116035461, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37319886684417725, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 73057536, "episodes_total": 730600, "training_iteration": 745, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-03-19", "timestamp": 1569081799, "time_this_iter_s": 30.48466968536377, "time_total_s": 22770.658179044724, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7153.6944444179535, "timesteps_since_restore": 22986752, "iterations_since_restore": 234, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.505670422174546, "episode_reward_min": 44.695627828074954, "episode_reward_mean": 53.165271139403856, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.872916600461558, "agent_1": 27.292354538942227}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6537255020893067, "mean_processing_ms": 3.5108925638815625, "mean_inference_ms": 2.08460858173448}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2144, "num_steps_trained": 107636992, "num_steps_sampled": 73157376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 45090, "num_samples_dropped": 309, "learner_queue": {"size_count": 142384, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.249, "replay_time_ms": 92.181, "update_priorities_time_ms": 53.177, "policy_agent_0": {"added_count": 5742336, "sampled_count": 8455936, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5742336, "sampled_count": 8455936, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4951940178871155, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39802947640419006, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 73157376, "episodes_total": 731600, "training_iteration": 746, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-03-49", "timestamp": 1569081829, "time_this_iter_s": 30.49772834777832, "time_total_s": 22801.155907392502, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cfb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7184.192172765732, "timesteps_since_restore": 23086592, "iterations_since_restore": 235, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.50683971496748, "episode_reward_min": 51.15620380914273, "episode_reward_mean": 54.213961467449764, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.93795919694027, "agent_1": 28.27600227050942}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653673101934687, "mean_processing_ms": 3.510738378521692, "mean_inference_ms": 2.084571872674727}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2147, "num_steps_trained": 107783168, "num_steps_sampled": 73257984, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 45287, "num_samples_dropped": 309, "learner_queue": {"size_count": 142955, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.996, "replay_time_ms": 81.617, "update_priorities_time_ms": 44.006, "policy_agent_0": {"added_count": 5768704, "sampled_count": 8490240, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5768704, "sampled_count": 8490240, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4951355755329132, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4106593728065491, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 73257984, "episodes_total": 732608, "training_iteration": 747, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-04-20", "timestamp": 1569081860, "time_this_iter_s": 30.498314142227173, "time_total_s": 22831.65422153473, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7214.690486907959, "timesteps_since_restore": 23187200, "iterations_since_restore": 236, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.457874099523295, "episode_reward_min": 53.568125468977975, "episode_reward_mean": 54.23646146288902, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.958529229409525, "agent_1": 28.27793223347942}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653582561143508, "mean_processing_ms": 3.51010028655215, "mean_inference_ms": 2.083936365317349}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2150, "num_steps_trained": 107927040, "num_steps_sampled": 73360128, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 45486, "num_samples_dropped": 309, "learner_queue": {"size_count": 143517, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.118, "replay_time_ms": 94.618, "update_priorities_time_ms": 49.79, "policy_agent_0": {"added_count": 5795840, "sampled_count": 8525568, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5795840, "sampled_count": 8525568, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49895092844963074, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39829450845718384, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 73360128, "episodes_total": 733624, "training_iteration": 748, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-04-51", "timestamp": 1569081891, "time_this_iter_s": 30.642181634902954, "time_total_s": 22862.296403169632, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7245.332668542862, "timesteps_since_restore": 23289344, "iterations_since_restore": 237, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.247677169492434, "episode_reward_min": 46.41638201703141, "episode_reward_mean": 52.765138078279946, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.900943692256607, "agent_1": 26.864194386023275}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6535340603278118, "mean_processing_ms": 3.509918027658651, "mean_inference_ms": 2.0840828095019295}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2153, "num_steps_trained": 108075776, "num_steps_sampled": 73459712, "sample_throughput": 7578.266, "train_throughput": 3789.133, "num_weight_syncs": 45681, "num_samples_dropped": 309, "learner_queue": {"size_count": 144100, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.864, "replay_time_ms": 109.421, "update_priorities_time_ms": 63.082, "policy_agent_0": {"added_count": 5823488, "sampled_count": 8561920, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5823488, "sampled_count": 8561920, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4840136170387268, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40878647565841675, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 73459712, "episodes_total": 734616, "training_iteration": 749, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-05-21", "timestamp": 1569081921, "time_this_iter_s": 30.5804123878479, "time_total_s": 22892.87681555748, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7275.91308093071, "timesteps_since_restore": 23388928, "iterations_since_restore": 238, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.4236031283449, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 52.586603147781794, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.82879036057788, "agent_1": 26.757812787203864}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6535686319117626, "mean_processing_ms": 3.5094296816795247, "mean_inference_ms": 2.0835911736963353}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2156, "num_steps_trained": 108224768, "num_steps_sampled": 73558016, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 45872, "num_samples_dropped": 309, "learner_queue": {"size_count": 144680, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.293, "replay_time_ms": 107.26, "update_priorities_time_ms": 46.469, "policy_agent_0": {"added_count": 5849600, "sampled_count": 8598784, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5849600, "sampled_count": 8598784, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48311442136764526, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4440877437591553, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 73558016, "episodes_total": 735608, "training_iteration": 750, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-05-52", "timestamp": 1569081952, "time_this_iter_s": 30.54066753387451, "time_total_s": 22923.417483091354, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c42cb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7306.453748464584, "timesteps_since_restore": 23487232, "iterations_since_restore": 239, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.4702638435415, "episode_reward_min": 45.98321130569838, "episode_reward_mean": 54.00285283695582, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.97668664546485, "agent_1": 28.026166191490898}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6535147400777457, "mean_processing_ms": 3.5097580157783557, "mean_inference_ms": 2.0835253010295625}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2159, "num_steps_trained": 108370688, "num_steps_sampled": 73659136, "sample_throughput": 6322.749, "train_throughput": 0.0, "num_weight_syncs": 46070, "num_samples_dropped": 309, "learner_queue": {"size_count": 145251, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.514, "replay_time_ms": 88.727, "update_priorities_time_ms": 56.066, "policy_agent_0": {"added_count": 5870848, "sampled_count": 8636160, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5870848, "sampled_count": 8636160, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48601990938186646, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4370149075984955, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 73659136, "episodes_total": 736624, "training_iteration": 751, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-06-22", "timestamp": 1569081982, "time_this_iter_s": 30.632993936538696, "time_total_s": 22954.050477027893, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39ca60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7337.086742401123, "timesteps_since_restore": 23588352, "iterations_since_restore": 240, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.4216392490013, "episode_reward_min": 52.84031510553406, "episode_reward_mean": 54.13110258371474, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.977549003347345, "agent_1": 28.153553580367316}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533403168895431, "mean_processing_ms": 3.5098026299397764, "mean_inference_ms": 2.083529989945598}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2162, "num_steps_trained": 108517888, "num_steps_sampled": 73760768, "sample_throughput": 6364.876, "train_throughput": 6364.876, "num_weight_syncs": 46268, "num_samples_dropped": 309, "learner_queue": {"size_count": 145825, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.862, "replay_time_ms": 119.715, "update_priorities_time_ms": 64.589, "policy_agent_0": {"added_count": 5894144, "sampled_count": 8671488, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5894144, "sampled_count": 8671488, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4764662981033325, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4639725387096405, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 73760768, "episodes_total": 737632, "training_iteration": 752, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-06-53", "timestamp": 1569082013, "time_this_iter_s": 30.748244762420654, "time_total_s": 22984.798721790314, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ed8c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7367.834987163544, "timesteps_since_restore": 23689984, "iterations_since_restore": 241, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.42197583551803, "episode_reward_min": 53.4121748888544, "episode_reward_mean": 54.13334344651577, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 25.9812881535898, "agent_1": 28.152055292925883}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533495432074065, "mean_processing_ms": 3.5089518356746585, "mean_inference_ms": 2.082820747452686}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2165, "num_steps_trained": 108656640, "num_steps_sampled": 73863680, "sample_throughput": 4903.244, "train_throughput": 0.0, "num_weight_syncs": 46470, "num_samples_dropped": 309, "learner_queue": {"size_count": 146368, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.1, "replay_time_ms": 100.862, "update_priorities_time_ms": 55.036, "policy_agent_0": {"added_count": 5919744, "sampled_count": 8707072, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5919744, "sampled_count": 8707072, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4784233868122101, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4251686632633209, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 73863680, "episodes_total": 738664, "training_iteration": 753, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-07-24", "timestamp": 1569082044, "time_this_iter_s": 30.566632986068726, "time_total_s": 23015.365354776382, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3127b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7398.401620149612, "timesteps_since_restore": 23792896, "iterations_since_restore": 242, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.42475291785712, "episode_reward_min": 53.10703753268053, "episode_reward_mean": 54.12733641452809, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.976470344552435, "agent_1": 28.150866069975574}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533178263400599, "mean_processing_ms": 3.509456435298202, "mean_inference_ms": 2.0829195815801373}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2168, "num_steps_trained": 108803328, "num_steps_sampled": 73963520, "sample_throughput": 18860.076, "train_throughput": 0.0, "num_weight_syncs": 46664, "num_samples_dropped": 309, "learner_queue": {"size_count": 146940, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.683, "replay_time_ms": 87.896, "update_priorities_time_ms": 53.596, "policy_agent_0": {"added_count": 5950464, "sampled_count": 8743168, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5950464, "sampled_count": 8743168, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4919549822807312, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41649818420410156, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 73963520, "episodes_total": 739672, "training_iteration": 754, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-07-54", "timestamp": 1569082074, "time_this_iter_s": 30.5695960521698, "time_total_s": 23045.934950828552, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3d1620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7428.971216201782, "timesteps_since_restore": 23892736, "iterations_since_restore": 243, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.972190717634014, "episode_reward_min": 53.105864844631164, "episode_reward_mean": 54.20655904050757, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.929772067163697, "agent_1": 28.27678697334383}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6534479427616597, "mean_processing_ms": 3.509023338203461, "mean_inference_ms": 2.08232396757814}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2171, "num_steps_trained": 108949760, "num_steps_sampled": 74064640, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 46861, "num_samples_dropped": 309, "learner_queue": {"size_count": 147512, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 25.522, "replay_time_ms": 77.489, "update_priorities_time_ms": 42.981, "policy_agent_0": {"added_count": 5977600, "sampled_count": 8780032, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 5977600, "sampled_count": 8780032, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4942881762981415, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4111853241920471, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 74064640, "episodes_total": 740672, "training_iteration": 755, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-08-25", "timestamp": 1569082105, "time_this_iter_s": 30.52466344833374, "time_total_s": 23076.459614276886, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ef620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7459.495879650116, "timesteps_since_restore": 23993856, "iterations_since_restore": 244, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.954270101332106, "episode_reward_min": 53.30966866712882, "episode_reward_mean": 54.423554759258124, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.748225407107462, "agent_1": 28.67532935215069}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653324934232258, "mean_processing_ms": 3.50860886852557, "mean_inference_ms": 2.0822407629326345}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2173, "num_steps_trained": 109096448, "num_steps_sampled": 74165760, "sample_throughput": 7020.88, "train_throughput": 3510.44, "num_weight_syncs": 47060, "num_samples_dropped": 309, "learner_queue": {"size_count": 148087, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.946, "replay_time_ms": 114.087, "update_priorities_time_ms": 53.15, "policy_agent_0": {"added_count": 6001152, "sampled_count": 8818432, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6001152, "sampled_count": 8818432, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4827832579612732, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4153016209602356, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 74165760, "episodes_total": 741680, "training_iteration": 756, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-08-56", "timestamp": 1569082136, "time_this_iter_s": 30.54911184310913, "time_total_s": 23107.008726119995, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c037e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7490.044991493225, "timesteps_since_restore": 24094976, "iterations_since_restore": 245, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.03001627917538, "episode_reward_min": 46.87684153053087, "episode_reward_mean": 54.20338509825567, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 25.836633614541224, "agent_1": 28.3667514837144}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653447307809071, "mean_processing_ms": 3.508534030704929, "mean_inference_ms": 2.0819335488502464}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2176, "num_steps_trained": 109247488, "num_steps_sampled": 74264064, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 47252, "num_samples_dropped": 309, "learner_queue": {"size_count": 148675, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.983, "replay_time_ms": 115.838, "update_priorities_time_ms": 59.004, "policy_agent_0": {"added_count": 6026752, "sampled_count": 8856576, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6026752, "sampled_count": 8856576, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47050607204437256, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.410224050283432, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 74264064, "episodes_total": 742656, "training_iteration": 757, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-09-26", "timestamp": 1569082166, "time_this_iter_s": 30.491455793380737, "time_total_s": 23137.500181913376, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077bf378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7520.536447286606, "timesteps_since_restore": 24193280, "iterations_since_restore": 246, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.42111056096528, "episode_reward_min": 45.48288441735286, "episode_reward_mean": 53.89093584525724, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.97040799911637, "agent_1": 27.920527846140793}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532707797901202, "mean_processing_ms": 3.509132313502709, "mean_inference_ms": 2.082340144259396}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2179, "num_steps_trained": 109395712, "num_steps_sampled": 74363904, "sample_throughput": 0.0, "train_throughput": 11156.918, "num_weight_syncs": 47447, "num_samples_dropped": 309, "learner_queue": {"size_count": 149255, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.99, "replay_time_ms": 116.894, "update_priorities_time_ms": 51.326, "policy_agent_0": {"added_count": 6050048, "sampled_count": 8897280, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6050048, "sampled_count": 8897280, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.494209349155426, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40159064531326294, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 74363904, "episodes_total": 743664, "training_iteration": 758, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-09-57", "timestamp": 1569082197, "time_this_iter_s": 30.62502145767212, "time_total_s": 23168.125203371048, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077bff28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7551.161468744278, "timesteps_since_restore": 24293120, "iterations_since_restore": 247, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.40506714122424, "episode_reward_min": 47.61569663554788, "episode_reward_mean": 53.635078184049135, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.819487307455788, "agent_1": 27.81559087659328}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533186230123703, "mean_processing_ms": 3.5087058779599847, "mean_inference_ms": 2.08174851891307}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2182, "num_steps_trained": 109541376, "num_steps_sampled": 74465024, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 47643, "num_samples_dropped": 309, "learner_queue": {"size_count": 149823, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.673, "replay_time_ms": 110.027, "update_priorities_time_ms": 56.798, "policy_agent_0": {"added_count": 6075392, "sampled_count": 8934400, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6075392, "sampled_count": 8934400, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48285508155822754, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3949114680290222, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 74465024, "episodes_total": 744672, "training_iteration": 759, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-10-27", "timestamp": 1569082227, "time_this_iter_s": 30.63028836250305, "time_total_s": 23198.75549173355, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077d6488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7581.791757106781, "timesteps_since_restore": 24394240, "iterations_since_restore": 248, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.89734087553676, "episode_reward_min": 53.057442578446086, "episode_reward_mean": 54.19746542223064, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.92064097733893, "agent_1": 28.27682444489165}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533610883473691, "mean_processing_ms": 3.5079405828254675, "mean_inference_ms": 2.0810403955963617}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2185, "num_steps_trained": 109687040, "num_steps_sampled": 74566912, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 47844, "num_samples_dropped": 309, "learner_queue": {"size_count": 150392, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.92, "replay_time_ms": 98.694, "update_priorities_time_ms": 55.419, "policy_agent_0": {"added_count": 6100480, "sampled_count": 8973568, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6100480, "sampled_count": 8973568, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4921845495700836, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3897884786128998, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 74566912, "episodes_total": 745688, "training_iteration": 760, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-10-58", "timestamp": 1569082258, "time_this_iter_s": 30.55945611000061, "time_total_s": 23229.31494784355, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c0372f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7612.351213216782, "timesteps_since_restore": 24496128, "iterations_since_restore": 249, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.51331729253303, "episode_reward_min": 53.27763416225966, "episode_reward_mean": 54.14138998809727, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 25.95955628549258, "agent_1": 28.18183370260462}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533505368601354, "mean_processing_ms": 3.5078387581811254, "mean_inference_ms": 2.0806944570650536}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2188, "num_steps_trained": 109829632, "num_steps_sampled": 74668544, "sample_throughput": 0.0, "train_throughput": 26952.704, "num_weight_syncs": 48041, "num_samples_dropped": 309, "learner_queue": {"size_count": 150949, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.659, "replay_time_ms": 108.849, "update_priorities_time_ms": 55.836, "policy_agent_0": {"added_count": 6125824, "sampled_count": 9009152, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6125824, "sampled_count": 9009152, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4991614818572998, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39311912655830383, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 74668544, "episodes_total": 746712, "training_iteration": 761, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-11-29", "timestamp": 1569082289, "time_this_iter_s": 30.580771684646606, "time_total_s": 23259.8957195282, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2dcc80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7642.931984901428, "timesteps_since_restore": 24597760, "iterations_since_restore": 250, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.51955812162458, "episode_reward_min": 53.0124377190995, "episode_reward_mean": 54.171657146782735, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.965721116598683, "agent_1": 28.205936030183977}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533219940047069, "mean_processing_ms": 3.5074637631712036, "mean_inference_ms": 2.0803879010380633}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2191, "num_steps_trained": 109973504, "num_steps_sampled": 74770688, "sample_throughput": 5353.639, "train_throughput": 0.0, "num_weight_syncs": 48242, "num_samples_dropped": 309, "learner_queue": {"size_count": 151513, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 27.292, "replay_time_ms": 93.649, "update_priorities_time_ms": 51.823, "policy_agent_0": {"added_count": 6152704, "sampled_count": 9043200, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6152704, "sampled_count": 9043200, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48825323581695557, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39702779054641724, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 74770688, "episodes_total": 747728, "training_iteration": 762, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-11-59", "timestamp": 1569082319, "time_this_iter_s": 30.589433431625366, "time_total_s": 23290.485152959824, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7673.521418333054, "timesteps_since_restore": 24699904, "iterations_since_restore": 251, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.4487682951895, "episode_reward_min": 51.74526509834316, "episode_reward_mean": 54.120905685383896, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.966238189280382, "agent_1": 28.154667496103443}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532210331028575, "mean_processing_ms": 3.5074210698797903, "mean_inference_ms": 2.0805654356531234}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2194, "num_steps_trained": 110123264, "num_steps_sampled": 74870016, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 48435, "num_samples_dropped": 309, "learner_queue": {"size_count": 152096, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.647, "replay_time_ms": 102.316, "update_priorities_time_ms": 50.613, "policy_agent_0": {"added_count": 6175488, "sampled_count": 9080576, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6175488, "sampled_count": 9080576, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4784218668937683, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40438494086265564, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 74870016, "episodes_total": 748720, "training_iteration": 763, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-12-30", "timestamp": 1569082350, "time_this_iter_s": 30.564248085021973, "time_total_s": 23321.049401044846, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2edb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7704.085666418076, "timesteps_since_restore": 24799232, "iterations_since_restore": 252, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.107432119087115, "episode_reward_min": 53.239235160945945, "episode_reward_mean": 54.28817500502087, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.226949267062153, "agent_1": 28.061225737958626}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533409624951633, "mean_processing_ms": 3.507389810507034, "mean_inference_ms": 2.080412119055649}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2197, "num_steps_trained": 110270464, "num_steps_sampled": 74970112, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 48630, "num_samples_dropped": 309, "learner_queue": {"size_count": 152671, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.212, "replay_time_ms": 86.834, "update_priorities_time_ms": 45.331, "policy_agent_0": {"added_count": 6199296, "sampled_count": 9118720, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6199296, "sampled_count": 9118720, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4863632321357727, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40509775280952454, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 74970112, "episodes_total": 749720, "training_iteration": 764, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-13-00", "timestamp": 1569082380, "time_this_iter_s": 30.47487759590149, "time_total_s": 23351.524278640747, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c332598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7734.560544013977, "timesteps_since_restore": 24899328, "iterations_since_restore": 253, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.07929386239324, "episode_reward_min": 53.513997199416806, "episode_reward_mean": 54.965466653381945, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.30940481172882, "agent_1": 27.656061841653024}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6531949102738388, "mean_processing_ms": 3.507451398615223, "mean_inference_ms": 2.080380755903228}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2200, "num_steps_trained": 110416384, "num_steps_sampled": 75071232, "sample_throughput": 0.0, "train_throughput": 27049.8, "num_weight_syncs": 48828, "num_samples_dropped": 309, "learner_queue": {"size_count": 153241, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.307, "replay_time_ms": 86.524, "update_priorities_time_ms": 40.443, "policy_agent_0": {"added_count": 6225664, "sampled_count": 9154048, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6225664, "sampled_count": 9154048, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4883338212966919, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39550256729125977, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 75071232, "episodes_total": 750736, "training_iteration": 765, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-13-31", "timestamp": 1569082411, "time_this_iter_s": 30.551777839660645, "time_total_s": 23382.076056480408, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c42cd90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7765.112321853638, "timesteps_since_restore": 25000448, "iterations_since_restore": 254, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.420574193536844, "episode_reward_min": 49.602491227474815, "episode_reward_mean": 53.986310434386475, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.015042576266296, "agent_1": 27.9712678581201}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533480938951011, "mean_processing_ms": 3.507257216998993, "mean_inference_ms": 2.0800326493114207}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2203, "num_steps_trained": 110564352, "num_steps_sampled": 75170560, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 49022, "num_samples_dropped": 309, "learner_queue": {"size_count": 153819, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.156, "replay_time_ms": 101.288, "update_priorities_time_ms": 52.853, "policy_agent_0": {"added_count": 6244864, "sampled_count": 9192704, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6244864, "sampled_count": 9192704, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46844884753227234, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40350350737571716, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 75170560, "episodes_total": 751728, "training_iteration": 766, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-14-02", "timestamp": 1569082442, "time_this_iter_s": 30.503153562545776, "time_total_s": 23412.579210042953, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7795.6154754161835, "timesteps_since_restore": 25099776, "iterations_since_restore": 255, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.423688337038655, "episode_reward_min": 53.338105894529114, "episode_reward_mean": 54.132999335603, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.026611332410944, "agent_1": 28.10638800319198}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653323121575846, "mean_processing_ms": 3.506754598075066, "mean_inference_ms": 2.079777054678488}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2206, "num_steps_trained": 110711808, "num_steps_sampled": 75270656, "sample_throughput": 0.0, "train_throughput": 23891.723, "num_weight_syncs": 49218, "num_samples_dropped": 309, "learner_queue": {"size_count": 154396, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.513, "replay_time_ms": 94.458, "update_priorities_time_ms": 53.52, "policy_agent_0": {"added_count": 6271232, "sampled_count": 9231872, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6271232, "sampled_count": 9231872, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46914058923721313, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40519261360168457, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 75270656, "episodes_total": 752736, "training_iteration": 767, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-14-32", "timestamp": 1569082472, "time_this_iter_s": 30.61602520942688, "time_total_s": 23443.19523525238, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4739d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7826.23150062561, "timesteps_since_restore": 25199872, "iterations_since_restore": 256, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.39312108729974, "episode_reward_min": 53.20644058355744, "episode_reward_mean": 54.075168039348064, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.96699751312586, "agent_1": 28.10817052622212}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6531893465840944, "mean_processing_ms": 3.5064394440360966, "mean_inference_ms": 2.079480409293392}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2209, "num_steps_trained": 110856192, "num_steps_sampled": 75371264, "sample_throughput": 5901.788, "train_throughput": 5901.788, "num_weight_syncs": 49414, "num_samples_dropped": 309, "learner_queue": {"size_count": 154959, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.287, "replay_time_ms": 123.715, "update_priorities_time_ms": 59.351, "policy_agent_0": {"added_count": 6297344, "sampled_count": 9268480, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6297344, "sampled_count": 9268480, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.470960408449173, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4077776074409485, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 75371264, "episodes_total": 753736, "training_iteration": 768, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-15-03", "timestamp": 1569082503, "time_this_iter_s": 30.576382637023926, "time_total_s": 23473.771617889404, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4de488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7856.807883262634, "timesteps_since_restore": 25300480, "iterations_since_restore": 257, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.41145049281781, "episode_reward_min": 53.40870494003624, "episode_reward_mean": 54.07602702091404, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.968970878268312, "agent_1": 28.107056142645646}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6531518068260763, "mean_processing_ms": 3.506510725903826, "mean_inference_ms": 2.0794175581210057}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2211, "num_steps_trained": 111001856, "num_steps_sampled": 75471360, "sample_throughput": 0.0, "train_throughput": 25228.896, "num_weight_syncs": 49610, "num_samples_dropped": 309, "learner_queue": {"size_count": 155528, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.179, "replay_time_ms": 109.066, "update_priorities_time_ms": 59.935, "policy_agent_0": {"added_count": 6323200, "sampled_count": 9303040, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6323200, "sampled_count": 9303040, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4771665930747986, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41043078899383545, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 75471360, "episodes_total": 754728, "training_iteration": 769, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-15-33", "timestamp": 1569082533, "time_this_iter_s": 30.52213215827942, "time_total_s": 23504.293750047684, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cf7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7887.330015420914, "timesteps_since_restore": 25400576, "iterations_since_restore": 258, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.37851076223025, "episode_reward_min": 53.045434497737254, "episode_reward_mean": 54.074946973431764, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 25.992819644350266, "agent_1": 28.082127329081413}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6534403603951373, "mean_processing_ms": 3.506294679141849, "mean_inference_ms": 2.0793726263424808}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2214, "num_steps_trained": 111153920, "num_steps_sampled": 75567616, "sample_throughput": 8352.1, "train_throughput": 4176.05, "num_weight_syncs": 49798, "num_samples_dropped": 309, "learner_queue": {"size_count": 156123, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.627, "replay_time_ms": 112.494, "update_priorities_time_ms": 54.338, "policy_agent_0": {"added_count": 6345728, "sampled_count": 9341696, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6345728, "sampled_count": 9341696, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4815352261066437, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.406049907207489, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 75567616, "episodes_total": 755704, "training_iteration": 770, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-16-04", "timestamp": 1569082564, "time_this_iter_s": 30.61953067779541, "time_total_s": 23534.91328072548, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3eab70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7917.949546098709, "timesteps_since_restore": 25496832, "iterations_since_restore": 259, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.394091078352155, "episode_reward_min": 53.24170540813157, "episode_reward_mean": 54.05131119817114, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.97811367141336, "agent_1": 28.073197526757703}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6533051673707163, "mean_processing_ms": 3.5063308520890115, "mean_inference_ms": 2.079587911121758}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2217, "num_steps_trained": 111301120, "num_steps_sampled": 75667968, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 49993, "num_samples_dropped": 309, "learner_queue": {"size_count": 156697, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.476, "replay_time_ms": 110.581, "update_priorities_time_ms": 57.631, "policy_agent_0": {"added_count": 6371072, "sampled_count": 9379328, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6371072, "sampled_count": 9379328, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4937138557434082, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3913033902645111, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 75667968, "episodes_total": 756704, "training_iteration": 771, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-16-35", "timestamp": 1569082595, "time_this_iter_s": 30.562865257263184, "time_total_s": 23565.476145982742, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f2bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7948.512411355972, "timesteps_since_restore": 25597184, "iterations_since_restore": 260, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.40324490175329, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 52.63187732806479, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.583501124563615, "agent_1": 27.048376203501117}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.653275190769296, "mean_processing_ms": 3.5064626381417194, "mean_inference_ms": 2.079360826991269}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2220, "num_steps_trained": 111448832, "num_steps_sampled": 75768320, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 50189, "num_samples_dropped": 309, "learner_queue": {"size_count": 157274, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.608, "replay_time_ms": 109.833, "update_priorities_time_ms": 52.124, "policy_agent_0": {"added_count": 6395136, "sampled_count": 9414912, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6395136, "sampled_count": 9414912, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48921066522598267, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41033169627189636, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 75768320, "episodes_total": 757704, "training_iteration": 772, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-17-05", "timestamp": 1569082625, "time_this_iter_s": 30.521040678024292, "time_total_s": 23595.997186660767, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44f840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 7979.033452033997, "timesteps_since_restore": 25697536, "iterations_since_restore": 261, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.396236908726856, "episode_reward_min": 53.15359790347153, "episode_reward_mean": 54.059215115030845, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.004531428596188, "agent_1": 28.054683686434576}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532794093375901, "mean_processing_ms": 3.5057654965306573, "mean_inference_ms": 2.079056741349825}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2223, "num_steps_trained": 111594752, "num_steps_sampled": 75867904, "sample_throughput": 6147.33, "train_throughput": 6147.33, "num_weight_syncs": 50384, "num_samples_dropped": 309, "learner_queue": {"size_count": 157844, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.388, "replay_time_ms": 103.692, "update_priorities_time_ms": 51.363, "policy_agent_0": {"added_count": 6417408, "sampled_count": 9451264, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6417408, "sampled_count": 9451264, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5046161413192749, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42199113965034485, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 75867904, "episodes_total": 758704, "training_iteration": 773, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-17-36", "timestamp": 1569082656, "time_this_iter_s": 30.678351640701294, "time_total_s": 23626.675538301468, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4299d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8009.711803674698, "timesteps_since_restore": 25797120, "iterations_since_restore": 262, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.26760855673175, "episode_reward_min": 53.122933087909026, "episode_reward_mean": 54.08470078337426, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.985702854575575, "agent_1": 28.098997928798614}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532519785188391, "mean_processing_ms": 3.506832755487873, "mean_inference_ms": 2.079236852136303}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2226, "num_steps_trained": 111742464, "num_steps_sampled": 75967488, "sample_throughput": 0.0, "train_throughput": 14275.255, "num_weight_syncs": 50578, "num_samples_dropped": 309, "learner_queue": {"size_count": 158421, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.804, "replay_time_ms": 109.501, "update_priorities_time_ms": 54.477, "policy_agent_0": {"added_count": 6444544, "sampled_count": 9487360, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6444544, "sampled_count": 9487360, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49512597918510437, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4098165035247803, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 75967488, "episodes_total": 759696, "training_iteration": 774, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-18-07", "timestamp": 1569082687, "time_this_iter_s": 30.610671281814575, "time_total_s": 23657.286209583282, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c37b268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8040.322474956512, "timesteps_since_restore": 25896704, "iterations_since_restore": 263, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.2891828101424, "episode_reward_min": 53.15693914154164, "episode_reward_mean": 54.28743694897007, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 25.814234672405494, "agent_1": 28.473202276564578}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532332702205632, "mean_processing_ms": 3.5057851341616564, "mean_inference_ms": 2.0787356608701493}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2229, "num_steps_trained": 111889408, "num_steps_sampled": 76068864, "sample_throughput": 13704.66, "train_throughput": 0.0, "num_weight_syncs": 50777, "num_samples_dropped": 309, "learner_queue": {"size_count": 158997, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.424, "replay_time_ms": 95.823, "update_priorities_time_ms": 50.847, "policy_agent_0": {"added_count": 6466304, "sampled_count": 9523968, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6466304, "sampled_count": 9523968, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48982301354408264, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4137882888317108, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 76068864, "episodes_total": 760720, "training_iteration": 775, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-18-37", "timestamp": 1569082717, "time_this_iter_s": 30.610098361968994, "time_total_s": 23687.89630794525, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2a1bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8070.932573318481, "timesteps_since_restore": 25998080, "iterations_since_restore": 264, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.25186594129576, "episode_reward_min": 48.766550859422416, "episode_reward_mean": 53.81394710153154, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.944704707765354, "agent_1": 27.869242393766136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6531883237255274, "mean_processing_ms": 3.5061985680155394, "mean_inference_ms": 2.0788418162185773}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2232, "num_steps_trained": 112035840, "num_steps_sampled": 76169984, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 50974, "num_samples_dropped": 309, "learner_queue": {"size_count": 159567, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.228, "replay_time_ms": 108.656, "update_priorities_time_ms": 48.955, "policy_agent_0": {"added_count": 6491136, "sampled_count": 9562624, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6491136, "sampled_count": 9562624, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4954760670661926, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39355871081352234, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 76169984, "episodes_total": 761728, "training_iteration": 776, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-19-08", "timestamp": 1569082748, "time_this_iter_s": 30.55885410308838, "time_total_s": 23718.45516204834, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ca378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8101.49142742157, "timesteps_since_restore": 26099200, "iterations_since_restore": 265, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.25789263418178, "episode_reward_min": 53.13318104739541, "episode_reward_mean": 54.146474865426086, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.939996675150596, "agent_1": 28.20647819027543}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532720982224025, "mean_processing_ms": 3.505383294618947, "mean_inference_ms": 2.0781893876432154}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2235, "num_steps_trained": 112183296, "num_steps_sampled": 76270080, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 51170, "num_samples_dropped": 309, "learner_queue": {"size_count": 160144, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.233, "replay_time_ms": 92.417, "update_priorities_time_ms": 57.113, "policy_agent_0": {"added_count": 6515200, "sampled_count": 9600512, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6515200, "sampled_count": 9600512, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4862803518772125, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40067973732948303, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 76270080, "episodes_total": 762720, "training_iteration": 777, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-19-38", "timestamp": 1569082778, "time_this_iter_s": 30.696370840072632, "time_total_s": 23749.151532888412, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28e400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8132.1877982616425, "timesteps_since_restore": 26199296, "iterations_since_restore": 266, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.36627291800939, "episode_reward_min": 48.573251417293314, "episode_reward_mean": 52.63236215622122, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.04025437037094, "agent_1": 26.59210778585023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532656014201517, "mean_processing_ms": 3.505159125974194, "mean_inference_ms": 2.078027163898517}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2238, "num_steps_trained": 112327936, "num_steps_sampled": 76371712, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 51368, "num_samples_dropped": 309, "learner_queue": {"size_count": 160708, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.542, "replay_time_ms": 99.669, "update_priorities_time_ms": 56.569, "policy_agent_0": {"added_count": 6539008, "sampled_count": 9640704, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6539008, "sampled_count": 9640704, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48390480875968933, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4328625798225403, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 76371712, "episodes_total": 763736, "training_iteration": 778, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-20-09", "timestamp": 1569082809, "time_this_iter_s": 30.607465028762817, "time_total_s": 23779.758997917175, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8162.795263290405, "timesteps_since_restore": 26300928, "iterations_since_restore": 267, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.25186594129576, "episode_reward_min": 47.61238327874004, "episode_reward_mean": 52.2930715689465, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 25.9537590660961, "agent_1": 26.33931250285038}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6531088397281647, "mean_processing_ms": 3.506246448709251, "mean_inference_ms": 2.078527139892961}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2241, "num_steps_trained": 112478976, "num_steps_sampled": 76469504, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 51559, "num_samples_dropped": 309, "learner_queue": {"size_count": 161298, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.437, "replay_time_ms": 120.961, "update_priorities_time_ms": 50.973, "policy_agent_0": {"added_count": 6564096, "sampled_count": 9677568, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6564096, "sampled_count": 9677568, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48372215032577515, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4474886357784271, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 76469504, "episodes_total": 764712, "training_iteration": 779, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-20-40", "timestamp": 1569082840, "time_this_iter_s": 30.562700033187866, "time_total_s": 23810.321697950363, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024f28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8193.357963323593, "timesteps_since_restore": 26398720, "iterations_since_restore": 268, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.51183919627593, "episode_reward_min": 48.56955567901591, "episode_reward_mean": 53.36504874896774, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.96225073892184, "agent_1": 27.402798010045846}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6532393229042426, "mean_processing_ms": 3.505935319940829, "mean_inference_ms": 2.077992022558109}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2244, "num_steps_trained": 112629504, "num_steps_sampled": 76568576, "sample_throughput": 5182.702, "train_throughput": 10365.404, "num_weight_syncs": 51753, "num_samples_dropped": 309, "learner_queue": {"size_count": 161886, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.981, "replay_time_ms": 109.35, "update_priorities_time_ms": 52.112, "policy_agent_0": {"added_count": 6589184, "sampled_count": 9715456, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6589184, "sampled_count": 9715456, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5130282640457153, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46102675795555115, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 76568576, "episodes_total": 765704, "training_iteration": 780, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-21-10", "timestamp": 1569082870, "time_this_iter_s": 30.492872714996338, "time_total_s": 23840.81457066536, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077df488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8223.85083603859, "timesteps_since_restore": 26497792, "iterations_since_restore": 269, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.72372572021452, "episode_reward_min": 53.14909444165386, "episode_reward_mean": 54.348046548925936, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.249153493985627, "agent_1": 28.098893054940252}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6531507001266672, "mean_processing_ms": 3.50540739887655, "mean_inference_ms": 2.07781094341453}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2247, "num_steps_trained": 112770816, "num_steps_sampled": 76670208, "sample_throughput": 17900.829, "train_throughput": 0.0, "num_weight_syncs": 51951, "num_samples_dropped": 309, "learner_queue": {"size_count": 162443, "size_mean": 0.26, "size_std": 0.7696752561957543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 4.0]}, "replay_shard_0": {"add_batch_time_ms": 33.796, "replay_time_ms": 106.241, "update_priorities_time_ms": 55.824, "policy_agent_0": {"added_count": 6616320, "sampled_count": 9754112, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6616320, "sampled_count": 9754112, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4880618155002594, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.453562468290329, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 76670208, "episodes_total": 766736, "training_iteration": 781, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-21-41", "timestamp": 1569082901, "time_this_iter_s": 30.44579243659973, "time_total_s": 23871.26036310196, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c029ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8254.29662847519, "timesteps_since_restore": 26599424, "iterations_since_restore": 270, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.83754667735826, "episode_reward_min": 53.562184972749925, "episode_reward_mean": 55.32627154784181, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.45020911873943, "agent_1": 27.876062429102387}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6530025036802816, "mean_processing_ms": 3.5050283089105427, "mean_inference_ms": 2.077640899275187}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2250, "num_steps_trained": 112918016, "num_steps_sampled": 76772096, "sample_throughput": 5458.501, "train_throughput": 5458.501, "num_weight_syncs": 52150, "num_samples_dropped": 309, "learner_queue": {"size_count": 163013, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.559, "replay_time_ms": 86.393, "update_priorities_time_ms": 53.217, "policy_agent_0": {"added_count": 6638592, "sampled_count": 9791488, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6638592, "sampled_count": 9791488, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4834669828414917, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4312242567539215, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 76772096, "episodes_total": 767744, "training_iteration": 782, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-22-11", "timestamp": 1569082931, "time_this_iter_s": 30.54869318008423, "time_total_s": 23901.809056282043, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077f9158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8284.845321655273, "timesteps_since_restore": 26701312, "iterations_since_restore": 271, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.668005546451596, "episode_reward_min": 52.90883668974475, "episode_reward_mean": 54.041144422286386, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.9361596921173, "agent_1": 28.10498473016901}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6529918252422837, "mean_processing_ms": 3.505122966524586, "mean_inference_ms": 2.0774406303324477}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2252, "num_steps_trained": 113061632, "num_steps_sampled": 76872704, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 52347, "num_samples_dropped": 309, "learner_queue": {"size_count": 163574, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.38, "replay_time_ms": 82.177, "update_priorities_time_ms": 45.496, "policy_agent_0": {"added_count": 6661632, "sampled_count": 9828096, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6661632, "sampled_count": 9828096, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48956453800201416, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42381736636161804, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 76872704, "episodes_total": 768752, "training_iteration": 783, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-22-42", "timestamp": 1569082962, "time_this_iter_s": 30.44517493247986, "time_total_s": 23932.254231214523, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0777f620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8315.290496587753, "timesteps_since_restore": 26801920, "iterations_since_restore": 272, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.17441721785995, "episode_reward_min": 50.549487187993755, "episode_reward_mean": 54.146274239290626, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.864041074036074, "agent_1": 28.282233165254507}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6529875915179851, "mean_processing_ms": 3.5044039567813203, "mean_inference_ms": 2.0772154724959266}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2255, "num_steps_trained": 113207552, "num_steps_sampled": 76973312, "sample_throughput": 0.0, "train_throughput": 25637.31, "num_weight_syncs": 52544, "num_samples_dropped": 309, "learner_queue": {"size_count": 164144, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.12, "replay_time_ms": 102.73, "update_priorities_time_ms": 50.758, "policy_agent_0": {"added_count": 6688256, "sampled_count": 9866240, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6688256, "sampled_count": 9866240, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47802478075027466, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.422918438911438, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 76973312, "episodes_total": 769760, "training_iteration": 784, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-23-12", "timestamp": 1569082992, "time_this_iter_s": 30.621846675872803, "time_total_s": 23962.876077890396, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2a1e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8345.912343263626, "timesteps_since_restore": 26902528, "iterations_since_restore": 273, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.87661962610063, "episode_reward_min": 53.174363925044204, "episode_reward_mean": 54.15924254310704, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.888400966739347, "agent_1": 28.27084157636764}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6530381522595876, "mean_processing_ms": 3.504967200228135, "mean_inference_ms": 2.077421495699129}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2258, "num_steps_trained": 113355008, "num_steps_sampled": 77073408, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 52739, "num_samples_dropped": 309, "learner_queue": {"size_count": 164721, "size_mean": 1.74, "size_std": 3.2112925746496535, "size_quantiles": [0.0, 0.0, 0.0, 8.0, 11.0]}, "replay_shard_0": {"add_batch_time_ms": 24.301, "replay_time_ms": 106.52, "update_priorities_time_ms": 49.572, "policy_agent_0": {"added_count": 6710528, "sampled_count": 9903104, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6710528, "sampled_count": 9903104, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4890115261077881, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4096844792366028, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 77073408, "episodes_total": 770760, "training_iteration": 785, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-23-43", "timestamp": 1569083023, "time_this_iter_s": 30.630149126052856, "time_total_s": 23993.50622701645, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c0157b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8376.542492389679, "timesteps_since_restore": 27002624, "iterations_since_restore": 274, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.87919319520663, "episode_reward_min": 53.3685095432992, "episode_reward_mean": 54.86070221176962, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.37199522516754, "agent_1": 28.488706986602118}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6528732156349882, "mean_processing_ms": 3.503962733185436, "mean_inference_ms": 2.077042285916568}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2261, "num_steps_trained": 113504000, "num_steps_sampled": 77173760, "sample_throughput": 20178.186, "train_throughput": 0.0, "num_weight_syncs": 52934, "num_samples_dropped": 309, "learner_queue": {"size_count": 165302, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.97, "replay_time_ms": 106.588, "update_priorities_time_ms": 51.056, "policy_agent_0": {"added_count": 6734592, "sampled_count": 9941248, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6734592, "sampled_count": 9941248, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4839748442173004, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4038701057434082, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 77173760, "episodes_total": 771768, "training_iteration": 786, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-24-14", "timestamp": 1569083054, "time_this_iter_s": 30.511547565460205, "time_total_s": 24024.01777458191, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28e950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8407.05403995514, "timesteps_since_restore": 27102976, "iterations_since_restore": 275, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.097376597903505, "episode_reward_min": 54.891309186608034, "episode_reward_mean": 56.18728580111982, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.692924022070034, "agent_1": 29.494361779049992}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6529280911517713, "mean_processing_ms": 3.504258184972433, "mean_inference_ms": 2.0773706449607943}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2264, "num_steps_trained": 113653248, "num_steps_sampled": 77272320, "sample_throughput": 0.0, "train_throughput": 28360.102, "num_weight_syncs": 53127, "num_samples_dropped": 309, "learner_queue": {"size_count": 165885, "size_mean": 0.24, "size_std": 0.4270831300812525, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.753, "replay_time_ms": 113.793, "update_priorities_time_ms": 53.842, "policy_agent_0": {"added_count": 6759424, "sampled_count": 9980928, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6759424, "sampled_count": 9980928, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4686463177204132, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3872263729572296, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 77272320, "episodes_total": 772752, "training_iteration": 787, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-24-44", "timestamp": 1569083084, "time_this_iter_s": 30.63656759262085, "time_total_s": 24054.65434217453, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c341c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8437.69060754776, "timesteps_since_restore": 27201536, "iterations_since_restore": 276, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.23136229372513, "episode_reward_min": 53.40199300101887, "episode_reward_mean": 55.85302822914578, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.549645389917686, "agent_1": 29.3033828392283}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.652710229536794, "mean_processing_ms": 3.5040473202432576, "mean_inference_ms": 2.077241733934434}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2267, "num_steps_trained": 113797632, "num_steps_sampled": 77373696, "sample_throughput": 4515.637, "train_throughput": 9031.275, "num_weight_syncs": 53326, "num_samples_dropped": 309, "learner_queue": {"size_count": 166450, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.159, "replay_time_ms": 100.914, "update_priorities_time_ms": 47.867, "policy_agent_0": {"added_count": 6786304, "sampled_count": 10018304, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6786304, "sampled_count": 10018304, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46436700224876404, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37961217761039734, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 77373696, "episodes_total": 773760, "training_iteration": 788, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-25-15", "timestamp": 1569083115, "time_this_iter_s": 30.485023736953735, "time_total_s": 24085.139365911484, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ce8c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8468.175631284714, "timesteps_since_restore": 27302912, "iterations_since_restore": 277, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.79477198241124, "episode_reward_min": 45.55419539536394, "episode_reward_mean": 54.71506031547591, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 24.800662606530416, "agent_1": 29.91439770894569}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6527824597115731, "mean_processing_ms": 3.504361959415615, "mean_inference_ms": 2.0773340299038763}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2270, "num_steps_trained": 113944576, "num_steps_sampled": 77472000, "sample_throughput": 0.0, "train_throughput": 14445.605, "num_weight_syncs": 53517, "num_samples_dropped": 309, "learner_queue": {"size_count": 167023, "size_mean": 0.6, "size_std": 1.296148139681572, "size_quantiles": [0.0, 0.0, 0.0, 2.0, 6.0]}, "replay_shard_0": {"add_batch_time_ms": 24.657, "replay_time_ms": 98.649, "update_priorities_time_ms": 54.2, "policy_agent_0": {"added_count": 6810624, "sampled_count": 10055424, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6810624, "sampled_count": 10055424, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4859774708747864, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37039607763290405, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 77472000, "episodes_total": 774744, "training_iteration": 789, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-25-45", "timestamp": 1569083145, "time_this_iter_s": 30.51816964149475, "time_total_s": 24115.65753555298, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43f598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8498.693800926208, "timesteps_since_restore": 27401216, "iterations_since_restore": 278, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.30580609712713, "episode_reward_min": 52.95810372045182, "episode_reward_mean": 54.67486608127082, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 24.669280923681168, "agent_1": 30.00558515758984}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6527903170424051, "mean_processing_ms": 3.5045573359096074, "mean_inference_ms": 2.0774875893199103}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2273, "num_steps_trained": 114093824, "num_steps_sampled": 77569536, "sample_throughput": 0.0, "train_throughput": 21263.478, "num_weight_syncs": 53708, "num_samples_dropped": 309, "learner_queue": {"size_count": 167606, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.815, "replay_time_ms": 110.253, "update_priorities_time_ms": 53.186, "policy_agent_0": {"added_count": 6833408, "sampled_count": 10093824, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6833408, "sampled_count": 10093824, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5143762826919556, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34457215666770935, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 77569536, "episodes_total": 775720, "training_iteration": 790, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-26-16", "timestamp": 1569083176, "time_this_iter_s": 30.606558799743652, "time_total_s": 24146.264094352722, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44f840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8529.300359725952, "timesteps_since_restore": 27498752, "iterations_since_restore": 279, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.95514508095619, "episode_reward_min": 53.095379863019375, "episode_reward_mean": 56.07091661318727, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.049961388215984, "agent_1": 30.020955224971345}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6528423108379082, "mean_processing_ms": 3.5040247978015873, "mean_inference_ms": 2.077163283504491}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2276, "num_steps_trained": 114239488, "num_steps_sampled": 77670912, "sample_throughput": 0.0, "train_throughput": 35872.706, "num_weight_syncs": 53905, "num_samples_dropped": 309, "learner_queue": {"size_count": 168175, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.823, "replay_time_ms": 103.425, "update_priorities_time_ms": 49.663, "policy_agent_0": {"added_count": 6856960, "sampled_count": 10129664, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6856960, "sampled_count": 10129664, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5364094376564026, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35344815254211426, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 77670912, "episodes_total": 776736, "training_iteration": 791, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-26-47", "timestamp": 1569083207, "time_this_iter_s": 30.639047861099243, "time_total_s": 24176.90314221382, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39fa60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8559.939407587051, "timesteps_since_restore": 27600128, "iterations_since_restore": 280, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.43370569473882, "episode_reward_min": 56.211250858611706, "episode_reward_mean": 57.59227842307492, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.98143868572168, "agent_1": 31.61083973735325}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526794536040026, "mean_processing_ms": 3.503459582385858, "mean_inference_ms": 2.0769429252033924}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2279, "num_steps_trained": 114386176, "num_steps_sampled": 77771776, "sample_throughput": 7534.396, "train_throughput": 0.0, "num_weight_syncs": 54102, "num_samples_dropped": 309, "learner_queue": {"size_count": 168748, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.454, "replay_time_ms": 94.936, "update_priorities_time_ms": 48.87, "policy_agent_0": {"added_count": 6884352, "sampled_count": 10167552, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6884352, "sampled_count": 10167552, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4974457323551178, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3433084189891815, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 77771776, "episodes_total": 777736, "training_iteration": 792, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-27-17", "timestamp": 1569083237, "time_this_iter_s": 30.54784917831421, "time_total_s": 24207.450991392136, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f2510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8590.487256765366, "timesteps_since_restore": 27700992, "iterations_since_restore": 281, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.43226185681567, "episode_reward_min": 56.75682494120465, "episode_reward_mean": 58.11591380713436, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.306835906161997, "agent_1": 32.80907790097243}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526333133938598, "mean_processing_ms": 3.5035611418658514, "mean_inference_ms": 2.076899303789805}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2282, "num_steps_trained": 114531584, "num_steps_sampled": 77872640, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 54299, "num_samples_dropped": 309, "learner_queue": {"size_count": 169316, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.144, "replay_time_ms": 83.581, "update_priorities_time_ms": 40.209, "policy_agent_0": {"added_count": 6908672, "sampled_count": 10203392, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6908672, "sampled_count": 10203392, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47856879234313965, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30652791261672974, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 77872640, "episodes_total": 778752, "training_iteration": 793, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-27-48", "timestamp": 1569083268, "time_this_iter_s": 30.548102378845215, "time_total_s": 24237.99909377098, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3eae18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8621.03535914421, "timesteps_since_restore": 27801856, "iterations_since_restore": 282, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.42718610455092, "episode_reward_min": 54.95875113331755, "episode_reward_mean": 57.29538531027238, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.533417463437065, "agent_1": 31.761967846835454}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526799385321692, "mean_processing_ms": 3.5033856513845403, "mean_inference_ms": 2.076605733451996}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2285, "num_steps_trained": 114679040, "num_steps_sampled": 77972736, "sample_throughput": 0.0, "train_throughput": 12209.659, "num_weight_syncs": 54495, "num_samples_dropped": 309, "learner_queue": {"size_count": 169892, "size_mean": 0.18, "size_std": 0.43312815655415426, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.046, "replay_time_ms": 113.21, "update_priorities_time_ms": 62.753, "policy_agent_0": {"added_count": 6932736, "sampled_count": 10239488, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6932736, "sampled_count": 10239488, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47053006291389465, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2874985337257385, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 77972736, "episodes_total": 779752, "training_iteration": 794, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-28-19", "timestamp": 1569083299, "time_this_iter_s": 30.65138339996338, "time_total_s": 24268.650477170944, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cfae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8651.686742544174, "timesteps_since_restore": 27901952, "iterations_since_restore": 283, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.41491464852447, "episode_reward_min": 54.26863777426285, "episode_reward_mean": 57.166447261210195, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.838232904285025, "agent_1": 31.328214356925315}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526466080957514, "mean_processing_ms": 3.5037320802195766, "mean_inference_ms": 2.0766208337293572}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2288, "num_steps_trained": 114823424, "num_steps_sampled": 78074112, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 54693, "num_samples_dropped": 309, "learner_queue": {"size_count": 170456, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.384, "replay_time_ms": 111.565, "update_priorities_time_ms": 52.551, "policy_agent_0": {"added_count": 6958336, "sampled_count": 10274816, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6958336, "sampled_count": 10274816, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4816889464855194, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29038313031196594, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 78074112, "episodes_total": 780760, "training_iteration": 795, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-28-49", "timestamp": 1569083329, "time_this_iter_s": 30.566231966018677, "time_total_s": 24299.216709136963, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8682.252974510193, "timesteps_since_restore": 28003328, "iterations_since_restore": 284, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.327365776187506, "episode_reward_min": 55.02128386558435, "episode_reward_mean": 56.384675632198764, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.62267557818347, "agent_1": 29.762000054015544}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526375489607655, "mean_processing_ms": 3.503123497938625, "mean_inference_ms": 2.075997046550138}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2290, "num_steps_trained": 114970112, "num_steps_sampled": 78175744, "sample_throughput": 6514.91, "train_throughput": 6514.91, "num_weight_syncs": 54892, "num_samples_dropped": 309, "learner_queue": {"size_count": 171029, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.521, "replay_time_ms": 107.711, "update_priorities_time_ms": 55.572, "policy_agent_0": {"added_count": 6986240, "sampled_count": 10310400, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 6986240, "sampled_count": 10310400, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46502652764320374, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30111128091812134, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 78175744, "episodes_total": 781784, "training_iteration": 796, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-29-20", "timestamp": 1569083360, "time_this_iter_s": 30.56727886199951, "time_total_s": 24329.783987998962, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8712.820253372192, "timesteps_since_restore": 28104960, "iterations_since_restore": 285, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.41243285934648, "episode_reward_min": 49.275668215561204, "episode_reward_mean": 54.85837505515271, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 23.928549855559044, "agent_1": 30.929825199593846}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526952652160455, "mean_processing_ms": 3.5032471768548685, "mean_inference_ms": 2.0763189582615302}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2294, "num_steps_trained": 115122688, "num_steps_sampled": 78274816, "sample_throughput": 12292.83, "train_throughput": 12292.83, "num_weight_syncs": 55085, "num_samples_dropped": 309, "learner_queue": {"size_count": 171625, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.695, "replay_time_ms": 109.21, "update_priorities_time_ms": 53.536, "policy_agent_0": {"added_count": 7012352, "sampled_count": 10349056, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7012352, "sampled_count": 10349056, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48261964321136475, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3109860420227051, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 78274816, "episodes_total": 782776, "training_iteration": 797, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-29-50", "timestamp": 1569083390, "time_this_iter_s": 30.60004425048828, "time_total_s": 24360.38403224945, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8743.42029762268, "timesteps_since_restore": 28204032, "iterations_since_restore": 286, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.486250525678635, "episode_reward_min": 49.30378118946652, "episode_reward_mean": 52.654630850438835, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 19.994273641249965, "agent_1": 32.66035720918901}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6525640095503906, "mean_processing_ms": 3.502665577031368, "mean_inference_ms": 2.076042714349407}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2296, "num_steps_trained": 115271168, "num_steps_sampled": 78376448, "sample_throughput": 10375.52, "train_throughput": 0.0, "num_weight_syncs": 55283, "num_samples_dropped": 309, "learner_queue": {"size_count": 172206, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.135, "replay_time_ms": 86.037, "update_priorities_time_ms": 44.638, "policy_agent_0": {"added_count": 7036416, "sampled_count": 10387456, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7036416, "sampled_count": 10387456, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6095510125160217, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3055824339389801, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 78376448, "episodes_total": 783792, "training_iteration": 798, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-30-21", "timestamp": 1569083421, "time_this_iter_s": 30.455503225326538, "time_total_s": 24390.839535474777, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c353158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8773.875800848007, "timesteps_since_restore": 28305664, "iterations_since_restore": 287, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.06340637930302, "episode_reward_min": 49.25612249435359, "episode_reward_mean": 52.699207305763075, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 20.171981351328906, "agent_1": 32.52722595443426}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.65265065854448, "mean_processing_ms": 3.5017807781473267, "mean_inference_ms": 2.075362029380899}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2299, "num_steps_trained": 115417600, "num_steps_sampled": 78478080, "sample_throughput": 7462.604, "train_throughput": 7462.604, "num_weight_syncs": 55482, "num_samples_dropped": 309, "learner_queue": {"size_count": 172777, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.51, "replay_time_ms": 99.271, "update_priorities_time_ms": 50.899, "policy_agent_0": {"added_count": 7064320, "sampled_count": 10425088, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7064320, "sampled_count": 10425088, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7468458414077759, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27508851885795593, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 78478080, "episodes_total": 784800, "training_iteration": 799, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-30-51", "timestamp": 1569083451, "time_this_iter_s": 30.519673585891724, "time_total_s": 24421.35920906067, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39c950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8804.395474433899, "timesteps_since_restore": 28407296, "iterations_since_restore": 288, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.220111233064905, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 47.722131040776524, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 20.94542820472049, "agent_1": 26.776702836056142}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.652599470168607, "mean_processing_ms": 3.502094802708821, "mean_inference_ms": 2.0754697464813257}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2302, "num_steps_trained": 115572480, "num_steps_sampled": 78577408, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 55676, "num_samples_dropped": 309, "learner_queue": {"size_count": 173382, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.456, "replay_time_ms": 112.739, "update_priorities_time_ms": 56.944, "policy_agent_0": {"added_count": 7087104, "sampled_count": 10463232, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7087104, "sampled_count": 10463232, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8051003217697144, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2990399897098541, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 78577408, "episodes_total": 785792, "training_iteration": 800, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-31-22", "timestamp": 1569083482, "time_this_iter_s": 30.50145936012268, "time_total_s": 24451.86066842079, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ed840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8834.896933794022, "timesteps_since_restore": 28506624, "iterations_since_restore": 289, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.09002159689581, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 46.305163624021084, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 24.357265197726896, "agent_1": 21.94789842629426}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6525763610421694, "mean_processing_ms": 3.502150795562135, "mean_inference_ms": 2.0756840844654896}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2305, "num_steps_trained": 115723008, "num_steps_sampled": 78677248, "sample_throughput": 7362.692, "train_throughput": 3681.346, "num_weight_syncs": 55872, "num_samples_dropped": 309, "learner_queue": {"size_count": 173970, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.971, "replay_time_ms": 94.036, "update_priorities_time_ms": 48.48, "policy_agent_0": {"added_count": 7113728, "sampled_count": 10500096, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7113728, "sampled_count": 10500096, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7709233164787292, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4681044816970825, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 78677248, "episodes_total": 786800, "training_iteration": 801, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-31-53", "timestamp": 1569083513, "time_this_iter_s": 30.515167951583862, "time_total_s": 24482.375836372375, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8865.412101745605, "timesteps_since_restore": 28606464, "iterations_since_restore": 290, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.08619826824862, "episode_reward_min": 52.57686757857711, "episode_reward_mean": 54.30977680296, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.148084246172477, "agent_1": 28.161692556787475}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526334289536961, "mean_processing_ms": 3.5025483898714067, "mean_inference_ms": 2.075571535027582}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2308, "num_steps_trained": 115873280, "num_steps_sampled": 78776320, "sample_throughput": 7360.193, "train_throughput": 0.0, "num_weight_syncs": 56064, "num_samples_dropped": 309, "learner_queue": {"size_count": 174557, "size_mean": 0.18, "size_std": 0.43312815655415426, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.508, "replay_time_ms": 90.556, "update_priorities_time_ms": 46.964, "policy_agent_0": {"added_count": 7141120, "sampled_count": 10538752, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7141120, "sampled_count": 10538752, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7271651029586792, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5590909719467163, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 78776320, "episodes_total": 787792, "training_iteration": 802, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-32-23", "timestamp": 1569083543, "time_this_iter_s": 30.61211848258972, "time_total_s": 24512.987954854965, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2dcf28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8896.024220228195, "timesteps_since_restore": 28705536, "iterations_since_restore": 291, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.47491416113443, "episode_reward_min": 52.468462784023885, "episode_reward_mean": 53.93964783641727, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.61116719090499, "agent_1": 28.32848064551224}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6525265310087163, "mean_processing_ms": 3.5025354399889865, "mean_inference_ms": 2.075767393929642}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2312, "num_steps_trained": 116026624, "num_steps_sampled": 78876416, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 56260, "num_samples_dropped": 309, "learner_queue": {"size_count": 175156, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.488, "replay_time_ms": 101.342, "update_priorities_time_ms": 46.241, "policy_agent_0": {"added_count": 7165184, "sampled_count": 10575360, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7165184, "sampled_count": 10575360, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6654070019721985, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5174980163574219, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 78876416, "episodes_total": 788784, "training_iteration": 803, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-32-54", "timestamp": 1569083574, "time_this_iter_s": 30.481277227401733, "time_total_s": 24543.469232082367, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c037bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8926.505497455597, "timesteps_since_restore": 28805632, "iterations_since_restore": 292, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.06318451740846, "episode_reward_min": 52.43268287382215, "episode_reward_mean": 54.22639233978202, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 25.963620029264764, "agent_1": 28.26277231051719}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6525900401580949, "mean_processing_ms": 3.502130650632512, "mean_inference_ms": 2.0755313256582433}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2314, "num_steps_trained": 116173056, "num_steps_sampled": 78979072, "sample_throughput": 7949.227, "train_throughput": 3974.613, "num_weight_syncs": 56461, "num_samples_dropped": 309, "learner_queue": {"size_count": 175729, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.967, "replay_time_ms": 85.131, "update_priorities_time_ms": 53.64, "policy_agent_0": {"added_count": 7190784, "sampled_count": 10610432, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7190784, "sampled_count": 10610432, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6061438918113708, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41778257489204407, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 78979072, "episodes_total": 789816, "training_iteration": 804, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-33-24", "timestamp": 1569083604, "time_this_iter_s": 30.577413320541382, "time_total_s": 24574.04664540291, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077bff28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8957.082910776138, "timesteps_since_restore": 28908288, "iterations_since_restore": 293, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.13868962386969, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 53.32761101995962, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.12020633672247, "agent_1": 27.207404683237097}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6524614085379807, "mean_processing_ms": 3.502188314699198, "mean_inference_ms": 2.0755804966377283}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2318, "num_steps_trained": 116327424, "num_steps_sampled": 79077120, "sample_throughput": 14413.706, "train_throughput": 0.0, "num_weight_syncs": 56652, "num_samples_dropped": 309, "learner_queue": {"size_count": 176332, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.903, "replay_time_ms": 96.357, "update_priorities_time_ms": 51.259, "policy_agent_0": {"added_count": 7216128, "sampled_count": 10647552, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7216128, "sampled_count": 10647552, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5690219402313232, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41893619298934937, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 79077120, "episodes_total": 790800, "training_iteration": 805, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-33-55", "timestamp": 1569083635, "time_this_iter_s": 30.616975784301758, "time_total_s": 24604.66362118721, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077896a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 8987.69988656044, "timesteps_since_restore": 29006336, "iterations_since_restore": 294, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.65007283154035, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 55.014980057743735, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.322846119953017, "agent_1": 27.692133937790665}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.652599440875942, "mean_processing_ms": 3.50173410187451, "mean_inference_ms": 2.0750788521284904}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2320, "num_steps_trained": 116473600, "num_steps_sampled": 79178496, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 56851, "num_samples_dropped": 309, "learner_queue": {"size_count": 176902, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.984, "replay_time_ms": 104.866, "update_priorities_time_ms": 51.533, "policy_agent_0": {"added_count": 7238144, "sampled_count": 10684160, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7238144, "sampled_count": 10684160, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5601828098297119, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.422060489654541, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 79178496, "episodes_total": 791808, "training_iteration": 806, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-34-26", "timestamp": 1569083666, "time_this_iter_s": 30.58801245689392, "time_total_s": 24635.251633644104, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0779d2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9018.287899017334, "timesteps_since_restore": 29107712, "iterations_since_restore": 295, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.61422521436367, "episode_reward_min": 52.3461304126478, "episode_reward_mean": 54.52576748001291, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.565395571172825, "agent_1": 27.960371908840024}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526112737795066, "mean_processing_ms": 3.5015901401005443, "mean_inference_ms": 2.0747870307736407}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2323, "num_steps_trained": 116619776, "num_steps_sampled": 79279872, "sample_throughput": 0.0, "train_throughput": 22844.599, "num_weight_syncs": 57048, "num_samples_dropped": 309, "learner_queue": {"size_count": 177473, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.013, "replay_time_ms": 106.766, "update_priorities_time_ms": 54.024, "policy_agent_0": {"added_count": 7265024, "sampled_count": 10717952, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7265024, "sampled_count": 10717952, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5346269607543945, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4187784194946289, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 79279872, "episodes_total": 792824, "training_iteration": 807, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-34-56", "timestamp": 1569083696, "time_this_iter_s": 30.403299570083618, "time_total_s": 24665.654933214188, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077a07b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9048.691198587418, "timesteps_since_restore": 29209088, "iterations_since_restore": 296, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.048064096003685, "episode_reward_min": 51.48901357409169, "episode_reward_mean": 53.38867084098361, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.765037588748434, "agent_1": 26.62363325223513}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.652820851226369, "mean_processing_ms": 3.5019375310742844, "mean_inference_ms": 2.074710992807552}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2326, "num_steps_trained": 116770816, "num_steps_sampled": 79378432, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 57241, "num_samples_dropped": 309, "learner_queue": {"size_count": 178063, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 28.244, "replay_time_ms": 98.731, "update_priorities_time_ms": 47.552, "policy_agent_0": {"added_count": 7288320, "sampled_count": 10755840, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7288320, "sampled_count": 10755840, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5128157138824463, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4365655779838562, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 79378432, "episodes_total": 793816, "training_iteration": 808, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-35-27", "timestamp": 1569083727, "time_this_iter_s": 30.566209077835083, "time_total_s": 24696.221142292023, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0777fd08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9079.257407665253, "timesteps_since_restore": 29307648, "iterations_since_restore": 297, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.67996288432178, "episode_reward_min": 50.99813624835904, "episode_reward_mean": 52.23300666880123, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.713606522502538, "agent_1": 24.51940014629868}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6527398323184989, "mean_processing_ms": 3.5020628081620258, "mean_inference_ms": 2.0747510073135453}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2329, "num_steps_trained": 116924160, "num_steps_sampled": 79477248, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 57434, "num_samples_dropped": 309, "learner_queue": {"size_count": 178663, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.198, "replay_time_ms": 87.619, "update_priorities_time_ms": 51.146, "policy_agent_0": {"added_count": 7316736, "sampled_count": 10792960, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7316736, "sampled_count": 10792960, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4893520772457123, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47370266914367676, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 79477248, "episodes_total": 794808, "training_iteration": 809, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-35-57", "timestamp": 1569083757, "time_this_iter_s": 30.513886213302612, "time_total_s": 24726.735028505325, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ef598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9109.771293878555, "timesteps_since_restore": 29406464, "iterations_since_restore": 298, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.32135653144803, "episode_reward_min": 51.40432274134193, "episode_reward_mean": 54.26799207111693, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.934640707228034, "agent_1": 25.333351363888998}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.65272041842996, "mean_processing_ms": 3.501666234374498, "mean_inference_ms": 2.0745741078347564}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2332, "num_steps_trained": 117076736, "num_steps_sampled": 79576064, "sample_throughput": 5449.304, "train_throughput": 0.0, "num_weight_syncs": 57627, "num_samples_dropped": 309, "learner_queue": {"size_count": 179259, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.985, "replay_time_ms": 88.959, "update_priorities_time_ms": 48.012, "policy_agent_0": {"added_count": 7340032, "sampled_count": 10831360, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7340032, "sampled_count": 10831360, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4584639370441437, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5029527544975281, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 79576064, "episodes_total": 795792, "training_iteration": 810, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-36-28", "timestamp": 1569083788, "time_this_iter_s": 30.527363538742065, "time_total_s": 24757.262392044067, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2b4c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9140.298657417297, "timesteps_since_restore": 29505280, "iterations_since_restore": 299, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.50884984829989, "episode_reward_min": 46.42760458690168, "episode_reward_mean": 56.064192226838244, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 30.779406271444817, "agent_1": 25.28478595539352}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526305033188512, "mean_processing_ms": 3.5015375619670377, "mean_inference_ms": 2.0746423636331865}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2335, "num_steps_trained": 117226240, "num_steps_sampled": 79676928, "sample_throughput": 0.0, "train_throughput": 17855.027, "num_weight_syncs": 57824, "num_samples_dropped": 309, "learner_queue": {"size_count": 179842, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.024, "replay_time_ms": 103.252, "update_priorities_time_ms": 52.419, "policy_agent_0": {"added_count": 7366912, "sampled_count": 10869760, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7366912, "sampled_count": 10869760, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4224429428577423, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5004078149795532, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 79676928, "episodes_total": 796792, "training_iteration": 811, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-36-58", "timestamp": 1569083818, "time_this_iter_s": 30.631987810134888, "time_total_s": 24787.894379854202, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9170.930645227432, "timesteps_since_restore": 29606144, "iterations_since_restore": 300, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.444675845246195, "episode_reward_min": 46.4293372023683, "episode_reward_mean": 56.50859368371392, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 30.29089450840861, "agent_1": 26.217699175305253}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6525868365037958, "mean_processing_ms": 3.501229806538856, "mean_inference_ms": 2.074468037219275}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2338, "num_steps_trained": 117373440, "num_steps_sampled": 79779584, "sample_throughput": 0.0, "train_throughput": 13073.527, "num_weight_syncs": 58024, "num_samples_dropped": 309, "learner_queue": {"size_count": 180417, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.275, "replay_time_ms": 96.14, "update_priorities_time_ms": 47.382, "policy_agent_0": {"added_count": 7391488, "sampled_count": 10906624, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7391488, "sampled_count": 10906624, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3846624195575714, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5114415287971497, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 79779584, "episodes_total": 797824, "training_iteration": 812, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-37-29", "timestamp": 1569083849, "time_this_iter_s": 30.602844715118408, "time_total_s": 24818.49722456932, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39ce18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9201.53348994255, "timesteps_since_restore": 29708800, "iterations_since_restore": 301, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.909153300650836, "episode_reward_min": 43.58970267170254, "episode_reward_mean": 56.08845184361348, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 30.20933076545563, "agent_1": 25.87912107815781}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6525300711210303, "mean_processing_ms": 3.501211113955825, "mean_inference_ms": 2.074559860543686}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2341, "num_steps_trained": 117525248, "num_steps_sampled": 79878656, "sample_throughput": 0.0, "train_throughput": 17659.937, "num_weight_syncs": 58218, "num_samples_dropped": 309, "learner_queue": {"size_count": 181011, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.413, "replay_time_ms": 107.032, "update_priorities_time_ms": 52.89, "policy_agent_0": {"added_count": 7418112, "sampled_count": 10944512, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7418112, "sampled_count": 10944512, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3418761193752289, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49894076585769653, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 79878656, "episodes_total": 798816, "training_iteration": 813, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-38-00", "timestamp": 1569083880, "time_this_iter_s": 30.686919689178467, "time_total_s": 24849.1841442585, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c42cea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9232.22040963173, "timesteps_since_restore": 29807872, "iterations_since_restore": 302, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.857568655098106, "episode_reward_min": 49.01224698115161, "episode_reward_mean": 54.79462035202025, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 28.613633648402576, "agent_1": 26.180986703617673}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.652509256417075, "mean_processing_ms": 3.5009616385943505, "mean_inference_ms": 2.074306388694016}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2344, "num_steps_trained": 117673984, "num_steps_sampled": 79980032, "sample_throughput": 0.0, "train_throughput": 19528.615, "num_weight_syncs": 58415, "num_samples_dropped": 309, "learner_queue": {"size_count": 181591, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.925, "replay_time_ms": 88.939, "update_priorities_time_ms": 44.606, "policy_agent_0": {"added_count": 7439360, "sampled_count": 10981376, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7439360, "sampled_count": 10981376, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3271593749523163, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47714340686798096, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 79980032, "episodes_total": 799832, "training_iteration": 814, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-38-30", "timestamp": 1569083910, "time_this_iter_s": 30.4938063621521, "time_total_s": 24879.67795062065, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9262.714215993881, "timesteps_since_restore": 29909248, "iterations_since_restore": 303, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.841280257170226, "episode_reward_min": 48.11185511454721, "episode_reward_mean": 55.05525819446631, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.1165195716271, "agent_1": 26.938738622839228}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526245318190478, "mean_processing_ms": 3.500313893674934, "mean_inference_ms": 2.073954656347849}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2347, "num_steps_trained": 117822208, "num_steps_sampled": 80081664, "sample_throughput": 0.0, "train_throughput": 9076.738, "num_weight_syncs": 58614, "num_samples_dropped": 309, "learner_queue": {"size_count": 182172, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.64, "replay_time_ms": 93.413, "update_priorities_time_ms": 50.665, "policy_agent_0": {"added_count": 7461120, "sampled_count": 11019776, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7461120, "sampled_count": 11019776, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3386539816856384, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4676987826824188, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 80081664, "episodes_total": 800840, "training_iteration": 815, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-39-01", "timestamp": 1569083941, "time_this_iter_s": 30.49010443687439, "time_total_s": 24910.168055057526, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9293.204320430756, "timesteps_since_restore": 30010880, "iterations_since_restore": 304, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.428587241885104, "episode_reward_min": 51.86630894579429, "episode_reward_mean": 55.795229244331814, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 28.051385079417802, "agent_1": 27.74384416491401}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6524742922979291, "mean_processing_ms": 3.500237834988347, "mean_inference_ms": 2.0738511119115195}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2350, "num_steps_trained": 117971200, "num_steps_sampled": 80183296, "sample_throughput": 9266.327, "train_throughput": 3088.776, "num_weight_syncs": 58813, "num_samples_dropped": 309, "learner_queue": {"size_count": 182753, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.668, "replay_time_ms": 111.164, "update_priorities_time_ms": 59.326, "policy_agent_0": {"added_count": 7487232, "sampled_count": 11057408, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7487232, "sampled_count": 11057408, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36097776889801025, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4440039396286011, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 80183296, "episodes_total": 801864, "training_iteration": 816, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-39-31", "timestamp": 1569083971, "time_this_iter_s": 30.697330236434937, "time_total_s": 24940.86538529396, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4696a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9323.90165066719, "timesteps_since_restore": 30112512, "iterations_since_restore": 305, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.742648404739114, "episode_reward_min": 55.44711347270012, "episode_reward_mean": 55.95001130077289, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.82320109397112, "agent_1": 28.126810206801768}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6525762151594103, "mean_processing_ms": 3.500406349424641, "mean_inference_ms": 2.0737666714152057}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2353, "num_steps_trained": 118118912, "num_steps_sampled": 80284160, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 59009, "num_samples_dropped": 309, "learner_queue": {"size_count": 183329, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.592, "replay_time_ms": 109.375, "update_priorities_time_ms": 57.899, "policy_agent_0": {"added_count": 7511552, "sampled_count": 11093248, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7511552, "sampled_count": 11093248, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38576069474220276, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4286010265350342, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 80284160, "episodes_total": 802864, "training_iteration": 817, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-40-02", "timestamp": 1569084002, "time_this_iter_s": 30.645320177078247, "time_total_s": 24971.51070547104, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cf950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9354.546970844269, "timesteps_since_restore": 30213376, "iterations_since_restore": 306, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.78486932065471, "episode_reward_min": 51.28975078510927, "episode_reward_mean": 56.523158786102016, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.88683367165047, "agent_1": 27.63632511445156}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6525891062341009, "mean_processing_ms": 3.50047955616434, "mean_inference_ms": 2.0736242120024895}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2356, "num_steps_trained": 118267136, "num_steps_sampled": 80385280, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 59206, "num_samples_dropped": 309, "learner_queue": {"size_count": 183908, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.987, "replay_time_ms": 76.195, "update_priorities_time_ms": 41.82, "policy_agent_0": {"added_count": 7535616, "sampled_count": 11131136, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7535616, "sampled_count": 11131136, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3831017017364502, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41388100385665894, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 80385280, "episodes_total": 803872, "training_iteration": 818, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-40-33", "timestamp": 1569084033, "time_this_iter_s": 30.46177649497986, "time_total_s": 25001.97248196602, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9385.008747339249, "timesteps_since_restore": 30314496, "iterations_since_restore": 307, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.20332311172598, "episode_reward_min": 51.167312572308816, "episode_reward_mean": 55.656904700787216, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.6382357925868, "agent_1": 28.01866890820042}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6526453981728664, "mean_processing_ms": 3.49963050259238, "mean_inference_ms": 2.0732835571872394}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2359, "num_steps_trained": 118417664, "num_steps_sampled": 80485376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 59403, "num_samples_dropped": 309, "learner_queue": {"size_count": 184497, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.81, "replay_time_ms": 95.847, "update_priorities_time_ms": 58.173, "policy_agent_0": {"added_count": 7557120, "sampled_count": 11169024, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7557120, "sampled_count": 11169024, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39259210228919983, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4246068596839905, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 80485376, "episodes_total": 804880, "training_iteration": 819, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-41-03", "timestamp": 1569084063, "time_this_iter_s": 30.587900400161743, "time_total_s": 25032.56038236618, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39f378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9415.59664773941, "timesteps_since_restore": 30414592, "iterations_since_restore": 308, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.61713197841397, "episode_reward_min": 50.566299456353676, "episode_reward_mean": 51.28887052652585, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 22.16736009646862, "agent_1": 29.12151043005726}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.652651496525658, "mean_processing_ms": 3.5006104790684582, "mean_inference_ms": 2.073830115209254}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2362, "num_steps_trained": 118566912, "num_steps_sampled": 80585728, "sample_throughput": 0.0, "train_throughput": 27027.331, "num_weight_syncs": 59598, "num_samples_dropped": 309, "learner_queue": {"size_count": 185079, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 25.254, "replay_time_ms": 83.091, "update_priorities_time_ms": 44.631, "policy_agent_0": {"added_count": 7581696, "sampled_count": 11207168, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7581696, "sampled_count": 11207168, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5198336839675903, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3944355547428131, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 80585728, "episodes_total": 805880, "training_iteration": 820, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-41-34", "timestamp": 1569084094, "time_this_iter_s": 30.489177227020264, "time_total_s": 25063.0495595932, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c307620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9446.08582496643, "timesteps_since_restore": 30514944, "iterations_since_restore": 309, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.58281586151048, "episode_reward_min": 50.57627873915342, "episode_reward_mean": 50.81863068244746, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 22.41689512498622, "agent_1": 28.401735557461272}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6527031012162271, "mean_processing_ms": 3.5000062004766748, "mean_inference_ms": 2.073720026426344}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2365, "num_steps_trained": 118721536, "num_steps_sampled": 80683008, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 59789, "num_samples_dropped": 309, "learner_queue": {"size_count": 185684, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.028, "replay_time_ms": 105.595, "update_priorities_time_ms": 54.117, "policy_agent_0": {"added_count": 7601664, "sampled_count": 11247616, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7601664, "sampled_count": 11247616, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6261532306671143, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36018216609954834, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 80683008, "episodes_total": 806856, "training_iteration": 821, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-42-04", "timestamp": 1569084124, "time_this_iter_s": 30.478280067443848, "time_total_s": 25093.527839660645, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c429ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9476.564105033875, "timesteps_since_restore": 30612224, "iterations_since_restore": 310, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 51.70152766712814, "episode_reward_min": 46.19736245878326, "episode_reward_mean": 50.03782314101641, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 23.01038838500625, "agent_1": 27.027434756010194}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6524721082307489, "mean_processing_ms": 3.5002278803425892, "mean_inference_ms": 2.0738679667646474}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2368, "num_steps_trained": 118869504, "num_steps_sampled": 80783616, "sample_throughput": 8243.615, "train_throughput": 2747.872, "num_weight_syncs": 59985, "num_samples_dropped": 309, "learner_queue": {"size_count": 186262, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.615, "replay_time_ms": 100.915, "update_priorities_time_ms": 52.513, "policy_agent_0": {"added_count": 7628288, "sampled_count": 11284224, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7628288, "sampled_count": 11284224, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7488104104995728, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3583706319332123, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 80783616, "episodes_total": 807864, "training_iteration": 822, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-42-35", "timestamp": 1569084155, "time_this_iter_s": 30.515041828155518, "time_total_s": 25124.0428814888, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43f488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9507.07914686203, "timesteps_since_restore": 30712832, "iterations_since_restore": 311, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.68641239813842, "episode_reward_min": 46.1323365731982, "episode_reward_mean": 48.655384110843855, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 24.402898384723336, "agent_1": 24.252485726120558}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6524074544572085, "mean_processing_ms": 3.4997366896489575, "mean_inference_ms": 2.0736227952783883}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2371, "num_steps_trained": 119022592, "num_steps_sampled": 80883456, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 60180, "num_samples_dropped": 309, "learner_queue": {"size_count": 186860, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.401, "replay_time_ms": 85.305, "update_priorities_time_ms": 45.412, "policy_agent_0": {"added_count": 7653632, "sampled_count": 11320064, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7653632, "sampled_count": 11320064, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7311439514160156, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4236302375793457, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 80883456, "episodes_total": 808864, "training_iteration": 823, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-43-05", "timestamp": 1569084185, "time_this_iter_s": 30.44752812385559, "time_total_s": 25154.490409612656, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c341a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9537.526674985886, "timesteps_since_restore": 30812672, "iterations_since_restore": 312, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 50.8507433902284, "episode_reward_min": 45.18916447665936, "episode_reward_mean": 48.58205621217513, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 24.619836911931223, "agent_1": 23.962219300243948}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6525596257214694, "mean_processing_ms": 3.4993829607514035, "mean_inference_ms": 2.0731838280122385}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2374, "num_steps_trained": 119169536, "num_steps_sampled": 80984576, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 60378, "num_samples_dropped": 309, "learner_queue": {"size_count": 187433, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.271, "replay_time_ms": 82.611, "update_priorities_time_ms": 50.229, "policy_agent_0": {"added_count": 7678720, "sampled_count": 11356928, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7678720, "sampled_count": 11356928, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7035166025161743, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5017900466918945, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 80984576, "episodes_total": 809880, "training_iteration": 824, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-43-36", "timestamp": 1569084216, "time_this_iter_s": 30.49427366256714, "time_total_s": 25184.984683275223, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ca0d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9568.020948648453, "timesteps_since_restore": 30913792, "iterations_since_restore": 313, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.45517499856035, "episode_reward_min": 46.53750307370345, "episode_reward_mean": 49.82969355903578, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.38143417331772, "agent_1": 24.44825938571808}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6525502617333937, "mean_processing_ms": 3.4999071319322277, "mean_inference_ms": 2.073452551064438}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2377, "num_steps_trained": 119319040, "num_steps_sampled": 81083904, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 60572, "num_samples_dropped": 309, "learner_queue": {"size_count": 188017, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.567, "replay_time_ms": 95.488, "update_priorities_time_ms": 54.14, "policy_agent_0": {"added_count": 7705856, "sampled_count": 11393792, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7705856, "sampled_count": 11393792, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6825427412986755, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5660039782524109, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 81083904, "episodes_total": 810864, "training_iteration": 825, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-44-06", "timestamp": 1569084246, "time_this_iter_s": 30.527236938476562, "time_total_s": 25215.5119202137, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077f9268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9598.54818558693, "timesteps_since_restore": 31013120, "iterations_since_restore": 314, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.58077889473388, "episode_reward_min": 47.09885080424204, "episode_reward_mean": 53.447055191671744, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.63984690983131, "agent_1": 24.807208281840488}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6525791184715728, "mean_processing_ms": 3.499526537148791, "mean_inference_ms": 2.0731209557866483}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2380, "num_steps_trained": 119468800, "num_steps_sampled": 81183744, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 60766, "num_samples_dropped": 309, "learner_queue": {"size_count": 188602, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.871, "replay_time_ms": 92.822, "update_priorities_time_ms": 46.683, "policy_agent_0": {"added_count": 7731712, "sampled_count": 11429888, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7731712, "sampled_count": 11429888, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6468321084976196, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.580564022064209, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 81183744, "episodes_total": 811856, "training_iteration": 826, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-44-37", "timestamp": 1569084277, "time_this_iter_s": 30.504371404647827, "time_total_s": 25246.016291618347, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c015ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9629.052556991577, "timesteps_since_restore": 31112960, "iterations_since_restore": 315, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.544132118599556, "episode_reward_min": 47.10647278082648, "episode_reward_mean": 56.13060371560991, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 31.107629983628694, "agent_1": 25.02297373198127}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6524848695077858, "mean_processing_ms": 3.4998448590500675, "mean_inference_ms": 2.073317942424762}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2383, "num_steps_trained": 119616512, "num_steps_sampled": 81284608, "sample_throughput": 9412.843, "train_throughput": 0.0, "num_weight_syncs": 60963, "num_samples_dropped": 309, "learner_queue": {"size_count": 189180, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.829, "replay_time_ms": 104.305, "update_priorities_time_ms": 57.773, "policy_agent_0": {"added_count": 7755520, "sampled_count": 11467776, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7755520, "sampled_count": 11467776, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5570032000541687, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5769187211990356, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 81284608, "episodes_total": 812872, "training_iteration": 827, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-45-08", "timestamp": 1569084308, "time_this_iter_s": 30.573660612106323, "time_total_s": 25276.589952230453, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2a1a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9659.626217603683, "timesteps_since_restore": 31213824, "iterations_since_restore": 316, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.89062204336196, "episode_reward_min": 56.52047350325045, "episode_reward_mean": 57.88709817484411, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 31.460966259192485, "agent_1": 26.42613191565175}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6524090330122145, "mean_processing_ms": 3.4991706897750396, "mean_inference_ms": 2.07295675312643}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2386, "num_steps_trained": 119764736, "num_steps_sampled": 81386496, "sample_throughput": 0.0, "train_throughput": 15365.73, "num_weight_syncs": 61162, "num_samples_dropped": 309, "learner_queue": {"size_count": 189758, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 26.419, "replay_time_ms": 87.925, "update_priorities_time_ms": 43.24, "policy_agent_0": {"added_count": 7780864, "sampled_count": 11505408, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7780864, "sampled_count": 11505408, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4476712644100189, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5475465655326843, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 81386496, "episodes_total": 813888, "training_iteration": 828, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-45-38", "timestamp": 1569084338, "time_this_iter_s": 30.623396396636963, "time_total_s": 25307.21334862709, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077dfd08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9690.24961400032, "timesteps_since_restore": 31315712, "iterations_since_restore": 317, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.292936515948305, "episode_reward_min": 56.6485737457831, "episode_reward_mean": 58.198978636405734, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.737975235527905, "agent_1": 29.46100340087801}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6523050616460836, "mean_processing_ms": 3.4986363996157492, "mean_inference_ms": 2.0728006552625886}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2389, "num_steps_trained": 119915776, "num_steps_sampled": 81486336, "sample_throughput": 16476.772, "train_throughput": 0.0, "num_weight_syncs": 61357, "num_samples_dropped": 309, "learner_queue": {"size_count": 190348, "size_mean": 0.1, "size_std": 0.3605551275463989, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 43.827, "replay_time_ms": 82.276, "update_priorities_time_ms": 51.511, "policy_agent_0": {"added_count": 7803392, "sampled_count": 11545344, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7803392, "sampled_count": 11545344, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3783525824546814, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4966716170310974, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 81486336, "episodes_total": 814888, "training_iteration": 829, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-46-09", "timestamp": 1569084369, "time_this_iter_s": 30.528125047683716, "time_total_s": 25337.741473674774, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077b0840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9720.777739048004, "timesteps_since_restore": 31415552, "iterations_since_restore": 318, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.76830521830717, "episode_reward_min": 55.532475161981, "episode_reward_mean": 57.479976495808515, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 29.131726870434132, "agent_1": 28.3482496253746}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6523146911975575, "mean_processing_ms": 3.498585383784043, "mean_inference_ms": 2.0725697081935155}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2392, "num_steps_trained": 120066560, "num_steps_sampled": 81586944, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 61554, "num_samples_dropped": 309, "learner_queue": {"size_count": 190937, "size_mean": 0.24, "size_std": 0.4270831300812525, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.011, "replay_time_ms": 87.743, "update_priorities_time_ms": 46.211, "policy_agent_0": {"added_count": 7832320, "sampled_count": 11581952, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7832320, "sampled_count": 11581952, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3683844208717346, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4382501244544983, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 81586944, "episodes_total": 815896, "training_iteration": 830, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-46-39", "timestamp": 1569084399, "time_this_iter_s": 30.55405616760254, "time_total_s": 25368.295529842377, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077bd488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9751.331795215607, "timesteps_since_restore": 31516160, "iterations_since_restore": 319, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.90928126774426, "episode_reward_min": 51.28096984522901, "episode_reward_mean": 54.83021508757903, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.746341176211637, "agent_1": 28.08387391136754}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6523344682731419, "mean_processing_ms": 3.499040278060551, "mean_inference_ms": 2.0727129858790447}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2395, "num_steps_trained": 120216064, "num_steps_sampled": 81687552, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 61751, "num_samples_dropped": 309, "learner_queue": {"size_count": 191521, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.102, "replay_time_ms": 106.921, "update_priorities_time_ms": 50.767, "policy_agent_0": {"added_count": 7861248, "sampled_count": 11617536, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7861248, "sampled_count": 11617536, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39175596833229065, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41845184564590454, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 81687552, "episodes_total": 816896, "training_iteration": 831, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-47-10", "timestamp": 1569084430, "time_this_iter_s": 30.517140865325928, "time_total_s": 25398.812670707703, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07749950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9781.848936080933, "timesteps_since_restore": 31616768, "iterations_since_restore": 320, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.891620562040124, "episode_reward_min": 50.03795085152316, "episode_reward_mean": 53.99014374031135, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 25.61801635490763, "agent_1": 28.372127385403843}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6522956181492484, "mean_processing_ms": 3.498585893655468, "mean_inference_ms": 2.07249595358269}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2398, "num_steps_trained": 120365056, "num_steps_sampled": 81788928, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 61949, "num_samples_dropped": 309, "learner_queue": {"size_count": 192103, "size_mean": 0.2, "size_std": 0.565685424949238, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 31.566, "replay_time_ms": 91.514, "update_priorities_time_ms": 49.138, "policy_agent_0": {"added_count": 7887872, "sampled_count": 11653120, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7887872, "sampled_count": 11653120, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42901134490966797, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41576966643333435, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 81788928, "episodes_total": 817920, "training_iteration": 832, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-47-41", "timestamp": 1569084461, "time_this_iter_s": 30.560775756835938, "time_total_s": 25429.37344646454, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077a0d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9812.409711837769, "timesteps_since_restore": 31718144, "iterations_since_restore": 321, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.90574978810506, "episode_reward_min": 47.72637740714774, "episode_reward_mean": 53.60884698510667, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.44047383340606, "agent_1": 27.16837315170078}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6523692655125094, "mean_processing_ms": 3.4987532017050373, "mean_inference_ms": 2.07249916672829}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2401, "num_steps_trained": 120517376, "num_steps_sampled": 81888256, "sample_throughput": 14830.995, "train_throughput": 0.0, "num_weight_syncs": 62142, "num_samples_dropped": 309, "learner_queue": {"size_count": 192698, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.98, "replay_time_ms": 99.153, "update_priorities_time_ms": 45.698, "policy_agent_0": {"added_count": 7914496, "sampled_count": 11691264, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7914496, "sampled_count": 11691264, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.481574684381485, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39711248874664307, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 81888256, "episodes_total": 818904, "training_iteration": 833, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-48-11", "timestamp": 1569084491, "time_this_iter_s": 30.50636577606201, "time_total_s": 25459.8798122406, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9842.91607761383, "timesteps_since_restore": 31817472, "iterations_since_restore": 322, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.86892764473069, "episode_reward_min": 46.56422801076711, "episode_reward_mean": 51.61456322356845, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.008803982061288, "agent_1": 26.605759241507293}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6522352569430094, "mean_processing_ms": 3.497895407528483, "mean_inference_ms": 2.071949754518994}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2404, "num_steps_trained": 120666880, "num_steps_sampled": 81989376, "sample_throughput": 22990.361, "train_throughput": 0.0, "num_weight_syncs": 62340, "num_samples_dropped": 309, "learner_queue": {"size_count": 193282, "size_mean": 0.24, "size_std": 0.5499090833947008, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.211, "replay_time_ms": 108.005, "update_priorities_time_ms": 57.934, "policy_agent_0": {"added_count": 7940096, "sampled_count": 11726336, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7940096, "sampled_count": 11726336, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5376087427139282, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40843310952186584, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 81989376, "episodes_total": 819920, "training_iteration": 834, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-48-42", "timestamp": 1569084522, "time_this_iter_s": 30.59528613090515, "time_total_s": 25490.475098371506, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c015510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9873.511363744736, "timesteps_since_restore": 31918592, "iterations_since_restore": 323, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 52.641095319863716, "episode_reward_min": 46.579029656787576, "episode_reward_mean": 48.82487570278536, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 22.587062815510322, "agent_1": 26.2378128872751}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6523732408130375, "mean_processing_ms": 3.4982394139349804, "mean_inference_ms": 2.0720457366685103}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2407, "num_steps_trained": 120820224, "num_steps_sampled": 82088704, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 62534, "num_samples_dropped": 309, "learner_queue": {"size_count": 193881, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.681, "replay_time_ms": 100.371, "update_priorities_time_ms": 61.735, "policy_agent_0": {"added_count": 7966208, "sampled_count": 11763456, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7966208, "sampled_count": 11763456, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6107653379440308, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.414145827293396, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 82088704, "episodes_total": 820912, "training_iteration": 835, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-49-12", "timestamp": 1569084552, "time_this_iter_s": 30.49774718284607, "time_total_s": 25520.97284555435, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28e950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9904.009110927582, "timesteps_since_restore": 32017920, "iterations_since_restore": 324, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.87246797427338, "episode_reward_min": 46.57902965678758, "episode_reward_mean": 52.874918204830706, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.08957783795902, "agent_1": 26.785340366871864}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6521619522972362, "mean_processing_ms": 3.4979381068218176, "mean_inference_ms": 2.0718277383775727}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2410, "num_steps_trained": 120967936, "num_steps_sampled": 82191104, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 62734, "num_samples_dropped": 309, "learner_queue": {"size_count": 194458, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 27.875, "replay_time_ms": 98.724, "update_priorities_time_ms": 53.783, "policy_agent_0": {"added_count": 7992576, "sampled_count": 11800320, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 7992576, "sampled_count": 11800320, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.658983051776886, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41894400119781494, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 82191104, "episodes_total": 821936, "training_iteration": 836, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-49-43", "timestamp": 1569084583, "time_this_iter_s": 30.59383726119995, "time_total_s": 25551.56668281555, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ca950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9934.602948188782, "timesteps_since_restore": 32120320, "iterations_since_restore": 325, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.90968805552929, "episode_reward_min": 46.92084643382044, "episode_reward_mean": 55.62432052004095, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 28.589231349054632, "agent_1": 27.035089170986534}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6522316602687322, "mean_processing_ms": 3.497545092435762, "mean_inference_ms": 2.0716147362681063}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2413, "num_steps_trained": 121118208, "num_steps_sampled": 82292480, "sample_throughput": 5282.785, "train_throughput": 5282.785, "num_weight_syncs": 62932, "num_samples_dropped": 309, "learner_queue": {"size_count": 195045, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.249, "replay_time_ms": 95.507, "update_priorities_time_ms": 54.379, "policy_agent_0": {"added_count": 8013568, "sampled_count": 11838976, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8013568, "sampled_count": 11838976, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6653922200202942, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44295990467071533, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 82292480, "episodes_total": 822952, "training_iteration": 837, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-50-13", "timestamp": 1569084613, "time_this_iter_s": 30.59486198425293, "time_total_s": 25582.161544799805, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2cea60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9965.197810173035, "timesteps_since_restore": 32221696, "iterations_since_restore": 326, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.86627903149222, "episode_reward_min": 47.2820371555433, "episode_reward_mean": 55.47662635548706, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.620981971104605, "agent_1": 26.855644384382675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6521924585548137, "mean_processing_ms": 3.497651415676615, "mean_inference_ms": 2.0716543882144416}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2416, "num_steps_trained": 121266432, "num_steps_sampled": 82392832, "sample_throughput": 9253.204, "train_throughput": 0.0, "num_weight_syncs": 63128, "num_samples_dropped": 309, "learner_queue": {"size_count": 195625, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.412, "replay_time_ms": 114.066, "update_priorities_time_ms": 61.395, "policy_agent_0": {"added_count": 8034816, "sampled_count": 11877888, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8034816, "sampled_count": 11877888, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5400657653808594, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4332675337791443, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 82392832, "episodes_total": 823952, "training_iteration": 838, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-50-44", "timestamp": 1569084644, "time_this_iter_s": 30.65579319000244, "time_total_s": 25612.817337989807, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43f488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 9995.853603363037, "timesteps_since_restore": 32322048, "iterations_since_restore": 327, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.86707547469581, "episode_reward_min": 48.91871460974873, "episode_reward_mean": 56.17386006479706, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 29.19110111994559, "agent_1": 26.982758944851714}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6521517380033771, "mean_processing_ms": 3.4980475928663126, "mean_inference_ms": 2.0718821341814944}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2419, "num_steps_trained": 121420544, "num_steps_sampled": 82491648, "sample_throughput": 0.0, "train_throughput": 13166.023, "num_weight_syncs": 63321, "num_samples_dropped": 309, "learner_queue": {"size_count": 196226, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.829, "replay_time_ms": 83.567, "update_priorities_time_ms": 43.241, "policy_agent_0": {"added_count": 8061952, "sampled_count": 11917824, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8061952, "sampled_count": 11917824, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49568691849708557, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43268048763275146, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 82491648, "episodes_total": 824936, "training_iteration": 839, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-51-15", "timestamp": 1569084675, "time_this_iter_s": 30.49918508529663, "time_total_s": 25643.316523075104, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44f8c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10026.352788448334, "timesteps_since_restore": 32420864, "iterations_since_restore": 328, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.86707547469581, "episode_reward_min": 55.54382429979438, "episode_reward_mean": 56.547396066902444, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 29.507273018946535, "agent_1": 27.04012304795616}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6520054962631736, "mean_processing_ms": 3.497715115405192, "mean_inference_ms": 2.071980696529775}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2422, "num_steps_trained": 121568512, "num_steps_sampled": 82593792, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 63521, "num_samples_dropped": 309, "learner_queue": {"size_count": 196804, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.287, "replay_time_ms": 105.822, "update_priorities_time_ms": 56.381, "policy_agent_0": {"added_count": 8087296, "sampled_count": 11953152, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8087296, "sampled_count": 11953152, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44260546565055847, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4414258897304535, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 82593792, "episodes_total": 825968, "training_iteration": 840, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-51-45", "timestamp": 1569084705, "time_this_iter_s": 30.63150954246521, "time_total_s": 25673.94803261757, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39fa60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10056.984297990799, "timesteps_since_restore": 32523008, "iterations_since_restore": 329, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.845846521717135, "episode_reward_min": 55.704020513431885, "episode_reward_mean": 56.55656724259982, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 29.513617175870582, "agent_1": 27.042950066729496}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519905641174792, "mean_processing_ms": 3.496492302950833, "mean_inference_ms": 2.071192613193404}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2425, "num_steps_trained": 121718272, "num_steps_sampled": 82695168, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 63718, "num_samples_dropped": 309, "learner_queue": {"size_count": 197389, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.463, "replay_time_ms": 95.883, "update_priorities_time_ms": 51.881, "policy_agent_0": {"added_count": 8114944, "sampled_count": 11989760, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8114944, "sampled_count": 11989760, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41255509853363037, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45543399453163147, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 82695168, "episodes_total": 826976, "training_iteration": 841, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-52-16", "timestamp": 1569084736, "time_this_iter_s": 30.455977201461792, "time_total_s": 25704.40400981903, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10087.44027519226, "timesteps_since_restore": 32624384, "iterations_since_restore": 330, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.86829065205065, "episode_reward_min": 50.410795219745644, "episode_reward_mean": 55.23027933857192, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 28.885375265404424, "agent_1": 26.34490407316771}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519683852298843, "mean_processing_ms": 3.4967267463682723, "mean_inference_ms": 2.0712158842507}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2428, "num_steps_trained": 121865728, "num_steps_sampled": 82797056, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 63918, "num_samples_dropped": 309, "learner_queue": {"size_count": 197965, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.129, "replay_time_ms": 100.09, "update_priorities_time_ms": 51.332, "policy_agent_0": {"added_count": 8137984, "sampled_count": 12027648, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8137984, "sampled_count": 12027648, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3795408010482788, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4488169848918915, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 82797056, "episodes_total": 827992, "training_iteration": 842, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-52-46", "timestamp": 1569084766, "time_this_iter_s": 30.5577335357666, "time_total_s": 25734.961743354797, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cfae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10117.998008728027, "timesteps_since_restore": 32726272, "iterations_since_restore": 331, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.83498885553159, "episode_reward_min": 48.60655832337366, "episode_reward_mean": 53.378105834535525, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.95415940699533, "agent_1": 26.42394642754038}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519540441519696, "mean_processing_ms": 3.496732585437895, "mean_inference_ms": 2.0714745969016177}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2431, "num_steps_trained": 122015744, "num_steps_sampled": 82896128, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 64111, "num_samples_dropped": 309, "learner_queue": {"size_count": 198551, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.659, "replay_time_ms": 116.846, "update_priorities_time_ms": 57.445, "policy_agent_0": {"added_count": 8163328, "sampled_count": 12065792, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8163328, "sampled_count": 12065792, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38704901933670044, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45965784788131714, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 82896128, "episodes_total": 828984, "training_iteration": 843, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-53-17", "timestamp": 1569084797, "time_this_iter_s": 30.518866777420044, "time_total_s": 25765.480610132217, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10148.516875505447, "timesteps_since_restore": 32825344, "iterations_since_restore": 332, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.83498885553159, "episode_reward_min": 48.26944098403454, "episode_reward_mean": 52.5991515067723, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.32485093012045, "agent_1": 26.274300576651978}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6518927956043089, "mean_processing_ms": 3.4965329046933893, "mean_inference_ms": 2.071323830302315}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2434, "num_steps_trained": 122164224, "num_steps_sampled": 82997504, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 64309, "num_samples_dropped": 309, "learner_queue": {"size_count": 199131, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.097, "replay_time_ms": 99.799, "update_priorities_time_ms": 50.432, "policy_agent_0": {"added_count": 8191488, "sampled_count": 12103680, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8191488, "sampled_count": 12103680, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44307687878608704, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45850062370300293, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 82997504, "episodes_total": 830000, "training_iteration": 844, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-53-48", "timestamp": 1569084828, "time_this_iter_s": 30.46012234687805, "time_total_s": 25795.940732479095, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10178.976997852325, "timesteps_since_restore": 32926720, "iterations_since_restore": 333, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.8349888555316, "episode_reward_min": 43.66117048788683, "episode_reward_mean": 49.52165943010272, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 24.97420480623646, "agent_1": 24.547454623866347}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6520131197699746, "mean_processing_ms": 3.497072288783171, "mean_inference_ms": 2.0716282944552113}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2437, "num_steps_trained": 122315264, "num_steps_sampled": 83095808, "sample_throughput": 6537.798, "train_throughput": 0.0, "num_weight_syncs": 64501, "num_samples_dropped": 309, "learner_queue": {"size_count": 199721, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.044, "replay_time_ms": 92.56, "update_priorities_time_ms": 49.668, "policy_agent_0": {"added_count": 8216832, "sampled_count": 12141312, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8216832, "sampled_count": 12141312, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49384286999702454, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4980962872505188, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 83095808, "episodes_total": 830984, "training_iteration": 845, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-54-18", "timestamp": 1569084858, "time_this_iter_s": 30.54736828804016, "time_total_s": 25826.488100767136, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a29d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10209.524366140366, "timesteps_since_restore": 33025024, "iterations_since_restore": 334, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.841490603811714, "episode_reward_min": 43.734324625809066, "episode_reward_mean": 46.782707952426065, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 23.415460880655388, "agent_1": 23.36724707177076}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6517893420412066, "mean_processing_ms": 3.496810164615964, "mean_inference_ms": 2.0715084062127573}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2440, "num_steps_trained": 122463232, "num_steps_sampled": 83196928, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 64699, "num_samples_dropped": 309, "learner_queue": {"size_count": 200300, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.042, "replay_time_ms": 74.203, "update_priorities_time_ms": 44.468, "policy_agent_0": {"added_count": 8246272, "sampled_count": 12177664, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8246272, "sampled_count": 12177664, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5668065547943115, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.554743230342865, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 83196928, "episodes_total": 831992, "training_iteration": 846, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-54-49", "timestamp": 1569084889, "time_this_iter_s": 30.618706703186035, "time_total_s": 25857.10680747032, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c353510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10240.143072843552, "timesteps_since_restore": 33126144, "iterations_since_restore": 335, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.90139082351151, "episode_reward_min": 47.39354266856761, "episode_reward_mean": 54.38308799588318, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.949561382264836, "agent_1": 26.433526613618533}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519064954723592, "mean_processing_ms": 3.496658673527329, "mean_inference_ms": 2.0714074120048127}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2443, "num_steps_trained": 122614528, "num_steps_sampled": 83296512, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 64893, "num_samples_dropped": 309, "learner_queue": {"size_count": 200890, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.475, "replay_time_ms": 93.635, "update_priorities_time_ms": 45.623, "policy_agent_0": {"added_count": 8276992, "sampled_count": 12211200, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8276992, "sampled_count": 12211200, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5776598453521729, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5677606463432312, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 83296512, "episodes_total": 832992, "training_iteration": 847, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-55-19", "timestamp": 1569084919, "time_this_iter_s": 30.52916193008423, "time_total_s": 25887.635969400406, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077d30d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10270.672234773636, "timesteps_since_restore": 33225728, "iterations_since_restore": 336, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.90742850007805, "episode_reward_min": 55.84406555389771, "episode_reward_mean": 56.673936398405395, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 29.56317606578531, "agent_1": 27.11076033262034}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519029874540838, "mean_processing_ms": 3.4964852325957154, "mean_inference_ms": 2.07115192683257}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2446, "num_steps_trained": 122762752, "num_steps_sampled": 83396864, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 65089, "num_samples_dropped": 309, "learner_queue": {"size_count": 201469, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.246, "replay_time_ms": 110.801, "update_priorities_time_ms": 48.95, "policy_agent_0": {"added_count": 8301824, "sampled_count": 12247040, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8301824, "sampled_count": 12247040, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4964263439178467, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5233954191207886, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 83396864, "episodes_total": 833992, "training_iteration": 848, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-55-50", "timestamp": 1569084950, "time_this_iter_s": 30.606570720672607, "time_total_s": 25918.24254012108, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10301.278805494308, "timesteps_since_restore": 33326080, "iterations_since_restore": 337, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.87932692658644, "episode_reward_min": 46.01394867753418, "episode_reward_mean": 56.56595117109326, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 29.455453464522055, "agent_1": 27.11049770657146}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519626531809496, "mean_processing_ms": 3.4962925633483684, "mean_inference_ms": 2.071112481961059}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2449, "num_steps_trained": 122915840, "num_steps_sampled": 83494912, "sample_throughput": 0.0, "train_throughput": 18440.301, "num_weight_syncs": 65280, "num_samples_dropped": 309, "learner_queue": {"size_count": 202067, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.418, "replay_time_ms": 88.228, "update_priorities_time_ms": 59.527, "policy_agent_0": {"added_count": 8325376, "sampled_count": 12285184, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8325376, "sampled_count": 12285184, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44054853916168213, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4703172445297241, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 83494912, "episodes_total": 834968, "training_iteration": 849, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-56-21", "timestamp": 1569084981, "time_this_iter_s": 30.590698719024658, "time_total_s": 25948.833238840103, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ecea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10331.869504213333, "timesteps_since_restore": 33424128, "iterations_since_restore": 338, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.88620118823307, "episode_reward_min": 48.30691053074311, "episode_reward_mean": 55.00002769953407, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.380357881762322, "agent_1": 26.619669817771946}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519131104982103, "mean_processing_ms": 3.496660941722453, "mean_inference_ms": 2.071303506345244}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2452, "num_steps_trained": 123070464, "num_steps_sampled": 83592960, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 65471, "num_samples_dropped": 309, "learner_queue": {"size_count": 202671, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.139, "replay_time_ms": 91.643, "update_priorities_time_ms": 49.662, "policy_agent_0": {"added_count": 8348928, "sampled_count": 12322560, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8348928, "sampled_count": 12322560, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3892267644405365, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44956788420677185, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 83592960, "episodes_total": 835952, "training_iteration": 850, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-56-51", "timestamp": 1569085011, "time_this_iter_s": 30.611905813217163, "time_total_s": 25979.44514465332, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c037488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10362.48141002655, "timesteps_since_restore": 33522176, "iterations_since_restore": 339, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.29784030667437, "episode_reward_min": 48.28421853572114, "episode_reward_mean": 52.21003182975083, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.71832473752905, "agent_1": 26.4917070922219}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.651988257353248, "mean_processing_ms": 3.4965405095762154, "mean_inference_ms": 2.070985081560264}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2455, "num_steps_trained": 123222272, "num_steps_sampled": 83693824, "sample_throughput": 6078.461, "train_throughput": 6078.461, "num_weight_syncs": 65669, "num_samples_dropped": 309, "learner_queue": {"size_count": 203264, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.955, "replay_time_ms": 104.69, "update_priorities_time_ms": 43.188, "policy_agent_0": {"added_count": 8374784, "sampled_count": 12358400, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8374784, "sampled_count": 12358400, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44827860593795776, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45486223697662354, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 83693824, "episodes_total": 836968, "training_iteration": 851, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-57-22", "timestamp": 1569085042, "time_this_iter_s": 30.55828356742859, "time_total_s": 26010.00342822075, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0777ff28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10393.039693593979, "timesteps_since_restore": 33623040, "iterations_since_restore": 340, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.82612748489468, "episode_reward_min": 44.84023650844092, "episode_reward_mean": 49.24377182220284, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 24.100967143328543, "agent_1": 25.142804678874352}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6520132529260181, "mean_processing_ms": 3.4958329119750804, "mean_inference_ms": 2.070843882567717}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2458, "num_steps_trained": 123375104, "num_steps_sampled": 83792896, "sample_throughput": 19049.459, "train_throughput": 0.0, "num_weight_syncs": 65862, "num_samples_dropped": 309, "learner_queue": {"size_count": 203861, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.923, "replay_time_ms": 98.324, "update_priorities_time_ms": 52.939, "policy_agent_0": {"added_count": 8399616, "sampled_count": 12396544, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8399616, "sampled_count": 12396544, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5488375425338745, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4691530168056488, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 83792896, "episodes_total": 837960, "training_iteration": 852, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-57-52", "timestamp": 1569085072, "time_this_iter_s": 30.647839307785034, "time_total_s": 26040.651267528534, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0779d598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10423.687532901764, "timesteps_since_restore": 33722112, "iterations_since_restore": 341, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.90395113494025, "episode_reward_min": 45.18586050692815, "episode_reward_mean": 49.97783883876282, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 24.833739060175354, "agent_1": 25.14409977858759}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519799884990578, "mean_processing_ms": 3.49622490699513, "mean_inference_ms": 2.071035192382398}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2461, "num_steps_trained": 123526656, "num_steps_sampled": 83892480, "sample_throughput": 0.0, "train_throughput": 10750.534, "num_weight_syncs": 66057, "num_samples_dropped": 309, "learner_queue": {"size_count": 204453, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.675, "replay_time_ms": 106.121, "update_priorities_time_ms": 64.189, "policy_agent_0": {"added_count": 8422912, "sampled_count": 12433408, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8422912, "sampled_count": 12433408, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6134844422340393, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.500942587852478, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 83892480, "episodes_total": 838952, "training_iteration": 853, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-58-23", "timestamp": 1569085103, "time_this_iter_s": 30.541733741760254, "time_total_s": 26071.193001270294, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0775b9d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10454.229266643524, "timesteps_since_restore": 33821696, "iterations_since_restore": 342, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.85469255491889, "episode_reward_min": 45.46711835234627, "episode_reward_mean": 46.50437393180905, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 23.010259874619358, "agent_1": 23.494114057189783}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519144445354036, "mean_processing_ms": 3.4963297039984447, "mean_inference_ms": 2.0711622320264924}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2464, "num_steps_trained": 123677696, "num_steps_sampled": 83992064, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 66251, "num_samples_dropped": 309, "learner_queue": {"size_count": 205044, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.513, "replay_time_ms": 101.222, "update_priorities_time_ms": 57.127, "policy_agent_0": {"added_count": 8446976, "sampled_count": 12468992, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8446976, "sampled_count": 12468992, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.657373309135437, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5694931149482727, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 83992064, "episodes_total": 839952, "training_iteration": 854, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-58-54", "timestamp": 1569085134, "time_this_iter_s": 30.509520769119263, "time_total_s": 26101.702522039413, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07765620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10484.738787412643, "timesteps_since_restore": 33921280, "iterations_since_restore": 343, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.961868311252246, "episode_reward_min": 44.717347792210916, "episode_reward_mean": 50.740652493860864, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 24.527472551425685, "agent_1": 26.213179942435342}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519223447096684, "mean_processing_ms": 3.496299279283127, "mean_inference_ms": 2.0710637159250767}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2467, "num_steps_trained": 123823104, "num_steps_sampled": 84094976, "sample_throughput": 6817.885, "train_throughput": 6817.885, "num_weight_syncs": 66452, "num_samples_dropped": 309, "learner_queue": {"size_count": 205611, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.743, "replay_time_ms": 102.031, "update_priorities_time_ms": 52.052, "policy_agent_0": {"added_count": 8477184, "sampled_count": 12504064, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8477184, "sampled_count": 12504064, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6731364130973816, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6116433143615723, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 84094976, "episodes_total": 840976, "training_iteration": 855, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-59-24", "timestamp": 1569085164, "time_this_iter_s": 30.57203197479248, "time_total_s": 26132.274554014206, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07769ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10515.310819387436, "timesteps_since_restore": 34024192, "iterations_since_restore": 344, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.99603031255404, "episode_reward_min": 50.64538938676297, "episode_reward_mean": 56.64869922326922, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.098606708375016, "agent_1": 29.55009251489445}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6518709902133593, "mean_processing_ms": 3.4961174240457145, "mean_inference_ms": 2.0708154984867857}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2470, "num_steps_trained": 123973376, "num_steps_sampled": 84194816, "sample_throughput": 0.0, "train_throughput": 13563.169, "num_weight_syncs": 66647, "num_samples_dropped": 309, "learner_queue": {"size_count": 206198, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.693, "replay_time_ms": 118.966, "update_priorities_time_ms": 50.773, "policy_agent_0": {"added_count": 8499968, "sampled_count": 12540160, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8499968, "sampled_count": 12540160, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6350866556167603, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5809571743011475, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 84194816, "episodes_total": 841968, "training_iteration": 856, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_16-59-55", "timestamp": 1569085195, "time_this_iter_s": 30.51057505607605, "time_total_s": 26162.785129070282, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07749a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10545.821394443512, "timesteps_since_restore": 34124032, "iterations_since_restore": 345, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.92713980973024, "episode_reward_min": 56.01698720226721, "episode_reward_mean": 56.83752994504361, "episode_len_mean": 100.0, "episodes_this_iter": 928, "policy_reward_mean": {"agent_0": 26.791302820751405, "agent_1": 30.04622712429246}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6518481582361018, "mean_processing_ms": 3.4961278456405216, "mean_inference_ms": 2.0713488897329175}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2473, "num_steps_trained": 124116992, "num_steps_sampled": 84286976, "sample_throughput": 7585.387, "train_throughput": 0.0, "num_weight_syncs": 66828, "num_samples_dropped": 309, "learner_queue": {"size_count": 206761, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.729, "replay_time_ms": 93.926, "update_priorities_time_ms": 45.258, "policy_agent_0": {"added_count": 8523776, "sampled_count": 12575488, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8523776, "sampled_count": 12575488, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5604129433631897, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48212528228759766, "model": {}}}}, "timesteps_this_iter": 92160, "done": false, "timesteps_total": 84286976, "episodes_total": 842896, "training_iteration": 857, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-00-25", "timestamp": 1569085225, "time_this_iter_s": 30.51555871963501, "time_total_s": 26193.300687789917, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0777f840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10576.336953163147, "timesteps_since_restore": 34216192, "iterations_since_restore": 346, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.15352640859201, "episode_reward_min": 55.87992214597667, "episode_reward_mean": 56.71140418537019, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.847144338781938, "agent_1": 28.864259846588443}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519044994384591, "mean_processing_ms": 3.4963922863897587, "mean_inference_ms": 2.0714646043017573}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2476, "num_steps_trained": 124268032, "num_steps_sampled": 84386816, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 67022, "num_samples_dropped": 309, "learner_queue": {"size_count": 207349, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.578, "replay_time_ms": 100.895, "update_priorities_time_ms": 44.378, "policy_agent_0": {"added_count": 8546560, "sampled_count": 12612096, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8546560, "sampled_count": 12612096, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4724503755569458, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38833531737327576, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 84386816, "episodes_total": 843896, "training_iteration": 858, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-00-56", "timestamp": 1569085256, "time_this_iter_s": 30.479223012924194, "time_total_s": 26223.77991080284, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c037598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10606.816176176071, "timesteps_since_restore": 34316032, "iterations_since_restore": 347, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.49989240462707, "episode_reward_min": 52.46289665145088, "episode_reward_mean": 56.560204817458974, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.33004213693763, "agent_1": 29.2301626805214}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6519564062078801, "mean_processing_ms": 3.495748450666101, "mean_inference_ms": 2.0708364406771054}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2479, "num_steps_trained": 124416768, "num_steps_sampled": 84488192, "sample_throughput": 6103.233, "train_throughput": 6103.233, "num_weight_syncs": 67221, "num_samples_dropped": 309, "learner_queue": {"size_count": 207931, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 48.431, "replay_time_ms": 102.609, "update_priorities_time_ms": 48.489, "policy_agent_0": {"added_count": 8567552, "sampled_count": 12648448, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8567552, "sampled_count": 12648448, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.475374311208725, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3823045790195465, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 84488192, "episodes_total": 844912, "training_iteration": 859, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-01-26", "timestamp": 1569085286, "time_this_iter_s": 30.554242372512817, "time_total_s": 26254.334153175354, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c312488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10637.370418548584, "timesteps_since_restore": 34417408, "iterations_since_restore": 348, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.93191213402648, "episode_reward_min": 50.93885618736513, "episode_reward_mean": 56.63623554845228, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.472269728934616, "agent_1": 29.16396581951772}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6518626723994702, "mean_processing_ms": 3.4965016769538373, "mean_inference_ms": 2.0713184288098794}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2482, "num_steps_trained": 124567296, "num_steps_sampled": 84588288, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 67416, "num_samples_dropped": 309, "learner_queue": {"size_count": 208518, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.497, "replay_time_ms": 95.282, "update_priorities_time_ms": 49.14, "policy_agent_0": {"added_count": 8590848, "sampled_count": 12685824, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8590848, "sampled_count": 12685824, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43238988518714905, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3652684986591339, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 84588288, "episodes_total": 845904, "training_iteration": 860, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-01-57", "timestamp": 1569085317, "time_this_iter_s": 30.44229030609131, "time_total_s": 26284.776443481445, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10667.812708854675, "timesteps_since_restore": 34517504, "iterations_since_restore": 349, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.415832021091276, "episode_reward_min": 55.73173404492866, "episode_reward_mean": 56.47099924546373, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.67551902685522, "agent_1": 28.795480218608624}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.651911405711809, "mean_processing_ms": 3.495700940132319, "mean_inference_ms": 2.0709136504153713}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2485, "num_steps_trained": 124716032, "num_steps_sampled": 84687360, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 67610, "num_samples_dropped": 309, "learner_queue": {"size_count": 209099, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.972, "replay_time_ms": 97.868, "update_priorities_time_ms": 54.576, "policy_agent_0": {"added_count": 8616960, "sampled_count": 12723200, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8616960, "sampled_count": 12723200, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43108078837394714, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3805546462535858, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 84687360, "episodes_total": 846896, "training_iteration": 861, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-02-27", "timestamp": 1569085347, "time_this_iter_s": 30.583549737930298, "time_total_s": 26315.359993219376, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c31bbf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10698.396258592606, "timesteps_since_restore": 34616576, "iterations_since_restore": 350, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.551143953493565, "episode_reward_min": 48.804854915226194, "episode_reward_mean": 54.64552007547557, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.598399618439455, "agent_1": 29.04712045703624}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6517560087824096, "mean_processing_ms": 3.495911772976466, "mean_inference_ms": 2.0710797788400734}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2488, "num_steps_trained": 124869888, "num_steps_sampled": 84786176, "sample_throughput": 0.0, "train_throughput": 15113.12, "num_weight_syncs": 67802, "num_samples_dropped": 309, "learner_queue": {"size_count": 209700, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.091, "replay_time_ms": 114.122, "update_priorities_time_ms": 52.436, "policy_agent_0": {"added_count": 8640768, "sampled_count": 12762368, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8640768, "sampled_count": 12762368, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4462445080280304, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3616710901260376, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 84786176, "episodes_total": 847888, "training_iteration": 862, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-02-58", "timestamp": 1569085378, "time_this_iter_s": 30.53616714477539, "time_total_s": 26345.89616036415, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c353048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10728.932425737381, "timesteps_since_restore": 34715392, "iterations_since_restore": 351, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.1172680274087, "episode_reward_min": 56.17450744184987, "episode_reward_mean": 57.07653452459366, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.586327826533385, "agent_1": 29.490206698060398}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.651806628260577, "mean_processing_ms": 3.495888724915813, "mean_inference_ms": 2.0711189829331356}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2491, "num_steps_trained": 125021952, "num_steps_sampled": 84886272, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 67999, "num_samples_dropped": 309, "learner_queue": {"size_count": 210294, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.072, "replay_time_ms": 100.311, "update_priorities_time_ms": 55.689, "policy_agent_0": {"added_count": 8666368, "sampled_count": 12800512, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8666368, "sampled_count": 12800512, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46091175079345703, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37059682607650757, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 84886272, "episodes_total": 848888, "training_iteration": 863, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-03-29", "timestamp": 1569085409, "time_this_iter_s": 30.630333185195923, "time_total_s": 26376.526493549347, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a22f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10759.562758922577, "timesteps_since_restore": 34815488, "iterations_since_restore": 352, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.89328347096461, "episode_reward_min": 54.393683133548784, "episode_reward_mean": 56.839070997504145, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.829643754546417, "agent_1": 30.009427242957653}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6517351519221383, "mean_processing_ms": 3.4956608429362492, "mean_inference_ms": 2.0708065125807065}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2494, "num_steps_trained": 125170432, "num_steps_sampled": 84987904, "sample_throughput": 13600.104, "train_throughput": 0.0, "num_weight_syncs": 68196, "num_samples_dropped": 309, "learner_queue": {"size_count": 210874, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.137, "replay_time_ms": 118.197, "update_priorities_time_ms": 61.149, "policy_agent_0": {"added_count": 8694272, "sampled_count": 12834560, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8694272, "sampled_count": 12834560, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44951197504997253, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3553783893585205, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 84987904, "episodes_total": 849904, "training_iteration": 864, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-03-59", "timestamp": 1569085439, "time_this_iter_s": 30.614802598953247, "time_total_s": 26407.1412961483, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b67b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10790.17756152153, "timesteps_since_restore": 34917120, "iterations_since_restore": 353, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.869005317376256, "episode_reward_min": 48.83438075807011, "episode_reward_mean": 56.75816167251036, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.00615790252711, "agent_1": 30.752003769983254}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6518078875214776, "mean_processing_ms": 3.4957721225432845, "mean_inference_ms": 2.070755826874048}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2497, "num_steps_trained": 125317376, "num_steps_sampled": 85089280, "sample_throughput": 8341.168, "train_throughput": 8341.168, "num_weight_syncs": 68395, "num_samples_dropped": 309, "learner_queue": {"size_count": 211448, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.705, "replay_time_ms": 106.242, "update_priorities_time_ms": 54.72, "policy_agent_0": {"added_count": 8717312, "sampled_count": 12870912, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8717312, "sampled_count": 12870912, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4278312623500824, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3393089473247528, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 85089280, "episodes_total": 850920, "training_iteration": 865, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-04-30", "timestamp": 1569085470, "time_this_iter_s": 30.6292622089386, "time_total_s": 26437.77055835724, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4de950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10820.806823730469, "timesteps_since_restore": 35018496, "iterations_since_restore": 354, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.62487340063637, "episode_reward_min": 46.8888943316291, "episode_reward_mean": 56.43519285586212, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.144282104488397, "agent_1": 30.29091075137376}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.651721059155134, "mean_processing_ms": 3.49500421048454, "mean_inference_ms": 2.0706107802411493}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2500, "num_steps_trained": 125469440, "num_steps_sampled": 85188096, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 68587, "num_samples_dropped": 309, "learner_queue": {"size_count": 212042, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.782, "replay_time_ms": 91.458, "update_priorities_time_ms": 47.386, "policy_agent_0": {"added_count": 8741120, "sampled_count": 12906752, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8741120, "sampled_count": 12906752, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43005314469337463, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33098897337913513, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 85188096, "episodes_total": 851904, "training_iteration": 866, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-05-00", "timestamp": 1569085500, "time_this_iter_s": 30.451443910598755, "time_total_s": 26468.222002267838, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cf7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10851.258267641068, "timesteps_since_restore": 35117312, "iterations_since_restore": 355, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.80503399856789, "episode_reward_min": 45.06875699373869, "episode_reward_mean": 56.16577370009895, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.972340361519596, "agent_1": 30.19343333857939}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6516953271969818, "mean_processing_ms": 3.495153882339798, "mean_inference_ms": 2.070584882625733}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2503, "num_steps_trained": 125616896, "num_steps_sampled": 85288960, "sample_throughput": 0.0, "train_throughput": 31187.134, "num_weight_syncs": 68784, "num_samples_dropped": 309, "learner_queue": {"size_count": 212619, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.904, "replay_time_ms": 113.266, "update_priorities_time_ms": 61.185, "policy_agent_0": {"added_count": 8765696, "sampled_count": 12942336, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8765696, "sampled_count": 12942336, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4487183094024658, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3171297311782837, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 85288960, "episodes_total": 852920, "training_iteration": 867, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-05-31", "timestamp": 1569085531, "time_this_iter_s": 30.597055673599243, "time_total_s": 26498.819057941437, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea0d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10881.855323314667, "timesteps_since_restore": 35218176, "iterations_since_restore": 356, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.8176370557894, "episode_reward_min": 56.621752707946655, "episode_reward_mean": 57.33303384821129, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.49768439570914, "agent_1": 30.83534945250219}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6516457155620667, "mean_processing_ms": 3.4950765349224704, "mean_inference_ms": 2.070566372043143}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2506, "num_steps_trained": 125766912, "num_steps_sampled": 85389312, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 68980, "num_samples_dropped": 309, "learner_queue": {"size_count": 213204, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.763, "replay_time_ms": 105.848, "update_priorities_time_ms": 51.11, "policy_agent_0": {"added_count": 8791552, "sampled_count": 12979968, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8791552, "sampled_count": 12979968, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4610383212566376, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30293214321136475, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 85389312, "episodes_total": 853920, "training_iteration": 868, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-06-02", "timestamp": 1569085562, "time_this_iter_s": 30.44297432899475, "time_total_s": 26529.26203227043, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44f730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10912.298297643661, "timesteps_since_restore": 35318528, "iterations_since_restore": 357, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.21830270370227, "episode_reward_min": 56.823992428669776, "episode_reward_mean": 57.38982028225818, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.891520060554473, "agent_1": 30.498300221703747}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6517919705882161, "mean_processing_ms": 3.495187641770411, "mean_inference_ms": 2.0707022702971227}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2509, "num_steps_trained": 125916672, "num_steps_sampled": 85488896, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 69175, "num_samples_dropped": 309, "learner_queue": {"size_count": 213789, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.025, "replay_time_ms": 80.12, "update_priorities_time_ms": 42.425, "policy_agent_0": {"added_count": 8814336, "sampled_count": 13018112, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8814336, "sampled_count": 13018112, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45435288548469543, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32026949524879456, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 85488896, "episodes_total": 854912, "training_iteration": 869, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-06-32", "timestamp": 1569085592, "time_this_iter_s": 30.469801902770996, "time_total_s": 26559.731834173203, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c37b268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10942.768099546432, "timesteps_since_restore": 35418112, "iterations_since_restore": 358, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.40548292750555, "episode_reward_min": 50.88556934590586, "episode_reward_mean": 56.882668475877665, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.70918751676839, "agent_1": 31.173480959109277}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6516330344854205, "mean_processing_ms": 3.4951043125877064, "mean_inference_ms": 2.070331610723415}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2512, "num_steps_trained": 126065152, "num_steps_sampled": 85589504, "sample_throughput": 14222.311, "train_throughput": 0.0, "num_weight_syncs": 69371, "num_samples_dropped": 309, "learner_queue": {"size_count": 214369, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.769, "replay_time_ms": 106.778, "update_priorities_time_ms": 56.778, "policy_agent_0": {"added_count": 8838144, "sampled_count": 13054464, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8838144, "sampled_count": 13054464, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48216569423675537, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31173041462898254, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 85589504, "episodes_total": 855920, "training_iteration": 870, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-07-03", "timestamp": 1569085623, "time_this_iter_s": 30.547397136688232, "time_total_s": 26590.27923130989, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ce8c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 10973.31549668312, "timesteps_since_restore": 35518720, "iterations_since_restore": 359, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.546951178908465, "episode_reward_min": 51.193191730532675, "episode_reward_mean": 52.98004223971376, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 20.33864906433115, "agent_1": 32.641393175382724}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6516899681662444, "mean_processing_ms": 3.4947319122364315, "mean_inference_ms": 2.0702016256842675}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2514, "num_steps_trained": 126213632, "num_steps_sampled": 85690880, "sample_throughput": 0.0, "train_throughput": 12848.412, "num_weight_syncs": 69570, "num_samples_dropped": 309, "learner_queue": {"size_count": 214949, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.333, "replay_time_ms": 95.455, "update_priorities_time_ms": 52.843, "policy_agent_0": {"added_count": 8861440, "sampled_count": 13093888, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8861440, "sampled_count": 13093888, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5856043696403503, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3058969974517822, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 85690880, "episodes_total": 856928, "training_iteration": 871, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-07-33", "timestamp": 1569085653, "time_this_iter_s": 30.62887978553772, "time_total_s": 26620.90811109543, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ca7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11003.944376468658, "timesteps_since_restore": 35620096, "iterations_since_restore": 360, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.322112800155885, "episode_reward_min": 51.707839423359374, "episode_reward_mean": 54.25854972823792, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 21.066219844983205, "agent_1": 33.19232988325481}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6514925298635971, "mean_processing_ms": 3.4945177056842964, "mean_inference_ms": 2.0698577908063833}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2517, "num_steps_trained": 126359040, "num_steps_sampled": 85793536, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 69770, "num_samples_dropped": 309, "learner_queue": {"size_count": 215517, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.159, "replay_time_ms": 99.352, "update_priorities_time_ms": 48.896, "policy_agent_0": {"added_count": 8884992, "sampled_count": 13130240, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8884992, "sampled_count": 13130240, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6830059885978699, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2632753551006317, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 85793536, "episodes_total": 857960, "training_iteration": 872, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-08-04", "timestamp": 1569085684, "time_this_iter_s": 30.464381217956543, "time_total_s": 26651.372492313385, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28e158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11034.408757686615, "timesteps_since_restore": 35722752, "iterations_since_restore": 361, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.37176780648999, "episode_reward_min": 51.904693341138724, "episode_reward_mean": 55.110640864984674, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 22.234891484351884, "agent_1": 32.875749380632946}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515914045316431, "mean_processing_ms": 3.494589861018025, "mean_inference_ms": 2.069900636454673}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2520, "num_steps_trained": 126510336, "num_steps_sampled": 85892864, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 69964, "num_samples_dropped": 309, "learner_queue": {"size_count": 216108, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.278, "replay_time_ms": 102.946, "update_priorities_time_ms": 58.357, "policy_agent_0": {"added_count": 8911104, "sampled_count": 13167616, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8911104, "sampled_count": 13167616, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8015965819358826, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2806064486503601, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 85892864, "episodes_total": 858960, "training_iteration": 873, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-08-34", "timestamp": 1569085714, "time_this_iter_s": 30.575753450393677, "time_total_s": 26681.94824576378, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11064.984511137009, "timesteps_since_restore": 35822080, "iterations_since_restore": 362, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.37133777449966, "episode_reward_min": 52.60693835591405, "episode_reward_mean": 55.45684508300687, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 22.257301537939444, "agent_1": 33.199543545067556}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515254363799257, "mean_processing_ms": 3.494427607081816, "mean_inference_ms": 2.069820131844145}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2523, "num_steps_trained": 126662400, "num_steps_sampled": 85992192, "sample_throughput": 0.0, "train_throughput": 15672.775, "num_weight_syncs": 70159, "num_samples_dropped": 309, "learner_queue": {"size_count": 216702, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.795, "replay_time_ms": 86.171, "update_priorities_time_ms": 42.554, "policy_agent_0": {"added_count": 8934656, "sampled_count": 13207040, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8934656, "sampled_count": 13207040, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.806310772895813, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27124807238578796, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 85992192, "episodes_total": 859944, "training_iteration": 874, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-09-05", "timestamp": 1569085745, "time_this_iter_s": 30.587055444717407, "time_total_s": 26712.535301208496, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024f28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11095.571566581726, "timesteps_since_restore": 35921408, "iterations_since_restore": 363, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.183583117993074, "episode_reward_min": 51.16171262553512, "episode_reward_mean": 54.1724255525816, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 21.327932113199928, "agent_1": 32.84449343938175}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6516518638525396, "mean_processing_ms": 3.494354275895691, "mean_inference_ms": 2.0696502762550284}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2526, "num_steps_trained": 126811904, "num_steps_sampled": 86092032, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 70353, "num_samples_dropped": 309, "learner_queue": {"size_count": 217286, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.405, "replay_time_ms": 82.534, "update_priorities_time_ms": 48.731, "policy_agent_0": {"added_count": 8960256, "sampled_count": 13244928, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8960256, "sampled_count": 13244928, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8251233100891113, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2713000178337097, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 86092032, "episodes_total": 860952, "training_iteration": 875, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-09-36", "timestamp": 1569085776, "time_this_iter_s": 30.49081540107727, "time_total_s": 26743.026116609573, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077a0ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11126.062381982803, "timesteps_since_restore": 36021248, "iterations_since_restore": 364, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.33092714240669, "episode_reward_min": 52.768189056855526, "episode_reward_mean": 54.28333344867193, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 21.826757953585528, "agent_1": 32.45657549508651}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515600132783514, "mean_processing_ms": 3.4945129266328103, "mean_inference_ms": 2.069773573691589}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2529, "num_steps_trained": 126962688, "num_steps_sampled": 86192128, "sample_throughput": 12035.44, "train_throughput": 0.0, "num_weight_syncs": 70548, "num_samples_dropped": 309, "learner_queue": {"size_count": 217876, "size_mean": 0.2, "size_std": 0.4898979485566357, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.869, "replay_time_ms": 66.511, "update_priorities_time_ms": 37.321, "policy_agent_0": {"added_count": 8990720, "sampled_count": 13281536, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 8990720, "sampled_count": 13281536, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8313879370689392, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.25230395793914795, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 86192128, "episodes_total": 861952, "training_iteration": 876, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-10-06", "timestamp": 1569085806, "time_this_iter_s": 30.58412528038025, "time_total_s": 26773.610241889954, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077b0840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11156.646507263184, "timesteps_since_restore": 36121344, "iterations_since_restore": 365, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.18976409277408, "episode_reward_min": 47.58169347263052, "episode_reward_mean": 54.25750113042004, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.501888713040877, "agent_1": 28.75561241737928}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515878332645699, "mean_processing_ms": 3.494574573383019, "mean_inference_ms": 2.06956302842431}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2532, "num_steps_trained": 127109888, "num_steps_sampled": 86292992, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 70746, "num_samples_dropped": 309, "learner_queue": {"size_count": 218450, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.503, "replay_time_ms": 98.362, "update_priorities_time_ms": 53.595, "policy_agent_0": {"added_count": 9013248, "sampled_count": 13318656, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9013248, "sampled_count": 13318656, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8317914009094238, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27853861451148987, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 86292992, "episodes_total": 862960, "training_iteration": 877, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-10-37", "timestamp": 1569085837, "time_this_iter_s": 30.539536476135254, "time_total_s": 26804.14977836609, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0776fb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11187.186043739319, "timesteps_since_restore": 36222208, "iterations_since_restore": 366, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.264282044283654, "episode_reward_min": 49.70636600393574, "episode_reward_mean": 50.76486758023482, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 24.18828794134328, "agent_1": 26.57657963889161}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6516552712620746, "mean_processing_ms": 3.4948737582915617, "mean_inference_ms": 2.069798882887395}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2535, "num_steps_trained": 127260928, "num_steps_sampled": 86392576, "sample_throughput": 0.0, "train_throughput": 23817.529, "num_weight_syncs": 70940, "num_samples_dropped": 309, "learner_queue": {"size_count": 219040, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.416, "replay_time_ms": 98.454, "update_priorities_time_ms": 48.003, "policy_agent_0": {"added_count": 9044736, "sampled_count": 13352192, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9044736, "sampled_count": 13352192, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8104468584060669, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30262887477874756, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 86392576, "episodes_total": 863952, "training_iteration": 878, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-11-07", "timestamp": 1569085867, "time_this_iter_s": 30.662320852279663, "time_total_s": 26834.81209921837, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077057b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11217.848364591599, "timesteps_since_restore": 36321792, "iterations_since_restore": 367, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 52.678785408794646, "episode_reward_min": 46.415053412982246, "episode_reward_mean": 48.80778662423266, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 24.033942596227295, "agent_1": 24.77384402800542}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515372445212001, "mean_processing_ms": 3.4942075357090734, "mean_inference_ms": 2.06960309228562}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2538, "num_steps_trained": 127416576, "num_steps_sampled": 86490624, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 71132, "num_samples_dropped": 309, "learner_queue": {"size_count": 219649, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.845, "replay_time_ms": 105.731, "update_priorities_time_ms": 55.469, "policy_agent_0": {"added_count": 9070592, "sampled_count": 13389312, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9070592, "sampled_count": 13389312, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7811510562896729, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3573749363422394, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 86490624, "episodes_total": 864920, "training_iteration": 879, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-11-38", "timestamp": 1569085898, "time_this_iter_s": 30.62359309196472, "time_total_s": 26865.435692310333, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0770fc80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11248.471957683563, "timesteps_since_restore": 36419840, "iterations_since_restore": 368, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.80577256610873, "episode_reward_min": 45.42181905582195, "episode_reward_mean": 50.650255046049445, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 23.765770473741735, "agent_1": 26.884484572307752}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6513407819910912, "mean_processing_ms": 3.4944873649062353, "mean_inference_ms": 2.0699104480942774}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2541, "num_steps_trained": 127556608, "num_steps_sampled": 86590208, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 71326, "num_samples_dropped": 309, "learner_queue": {"size_count": 220195, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.148, "replay_time_ms": 101.275, "update_priorities_time_ms": 51.881, "policy_agent_0": {"added_count": 9099264, "sampled_count": 13424896, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9099264, "sampled_count": 13424896, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7768489122390747, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42206257581710815, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 86590208, "episodes_total": 865928, "training_iteration": 880, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-12-09", "timestamp": 1569085929, "time_this_iter_s": 30.61686396598816, "time_total_s": 26896.05255627632, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07769bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11279.088821649551, "timesteps_since_restore": 36519424, "iterations_since_restore": 369, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.22781434348453, "episode_reward_min": 44.18297389291391, "episode_reward_mean": 49.51941546791637, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 24.15295429220324, "agent_1": 25.366461175713198}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.651679159457481, "mean_processing_ms": 3.4948234188623832, "mean_inference_ms": 2.0699798989583362}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2544, "num_steps_trained": 127709440, "num_steps_sampled": 86687488, "sample_throughput": 11870.322, "train_throughput": 0.0, "num_weight_syncs": 71516, "num_samples_dropped": 309, "learner_queue": {"size_count": 220793, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.128, "replay_time_ms": 88.727, "update_priorities_time_ms": 44.064, "policy_agent_0": {"added_count": 9126656, "sampled_count": 13460736, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9126656, "sampled_count": 13460736, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7724666595458984, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4725567698478699, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 86687488, "episodes_total": 866896, "training_iteration": 881, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-12-39", "timestamp": 1569085959, "time_this_iter_s": 30.51134967803955, "time_total_s": 26926.56390595436, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077dff28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11309.600171327591, "timesteps_since_restore": 36616704, "iterations_since_restore": 370, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.24037136376201, "episode_reward_min": 47.85845642771063, "episode_reward_mean": 57.33617278121141, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.568873242045086, "agent_1": 28.767299539166324}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515531495758231, "mean_processing_ms": 3.4947897118017104, "mean_inference_ms": 2.0700130513357857}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2547, "num_steps_trained": 127858944, "num_steps_sampled": 86786560, "sample_throughput": 0.0, "train_throughput": 18717.064, "num_weight_syncs": 71709, "num_samples_dropped": 309, "learner_queue": {"size_count": 221377, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.276, "replay_time_ms": 110.7, "update_priorities_time_ms": 60.112, "policy_agent_0": {"added_count": 9152000, "sampled_count": 13495552, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9152000, "sampled_count": 13495552, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7370126843452454, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4516240954399109, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 86786560, "episodes_total": 867888, "training_iteration": 882, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-13-10", "timestamp": 1569085990, "time_this_iter_s": 30.539047241210938, "time_total_s": 26957.102953195572, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11340.139218568802, "timesteps_since_restore": 36715776, "iterations_since_restore": 371, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.424031696135046, "episode_reward_min": 46.24047117742998, "episode_reward_mean": 57.58853616624879, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.721561422635357, "agent_1": 28.866974743613437}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515356154212338, "mean_processing_ms": 3.4947259231649976, "mean_inference_ms": 2.0698766370328254}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2550, "num_steps_trained": 128006912, "num_steps_sampled": 86886912, "sample_throughput": 0.0, "train_throughput": 17101.612, "num_weight_syncs": 71905, "num_samples_dropped": 309, "learner_queue": {"size_count": 221954, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.971, "replay_time_ms": 104.33, "update_priorities_time_ms": 58.643, "policy_agent_0": {"added_count": 9177856, "sampled_count": 13531392, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9177856, "sampled_count": 13531392, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6702734231948853, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41914892196655273, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 86886912, "episodes_total": 868888, "training_iteration": 883, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-13-40", "timestamp": 1569086020, "time_this_iter_s": 30.527275562286377, "time_total_s": 26987.63022875786, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c0151e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11370.666494131088, "timesteps_since_restore": 36816128, "iterations_since_restore": 372, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.3098466005817, "episode_reward_min": 46.28244330223938, "episode_reward_mean": 57.85076486647226, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.84838725771157, "agent_1": 29.00237760876068}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6516173840330235, "mean_processing_ms": 3.494852169301956, "mean_inference_ms": 2.0697892371698905}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2553, "num_steps_trained": 128160256, "num_steps_sampled": 86985728, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 72098, "num_samples_dropped": 309, "learner_queue": {"size_count": 222554, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.268, "replay_time_ms": 101.507, "update_priorities_time_ms": 53.687, "policy_agent_0": {"added_count": 9202944, "sampled_count": 13568512, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9202944, "sampled_count": 13568512, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5485092401504517, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37539997696876526, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 86985728, "episodes_total": 869880, "training_iteration": 884, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-14-11", "timestamp": 1569086051, "time_this_iter_s": 30.570777654647827, "time_total_s": 27018.201006412506, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28e2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11401.237271785736, "timesteps_since_restore": 36914944, "iterations_since_restore": 373, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.29608429772834, "episode_reward_min": 57.301463137401086, "episode_reward_mean": 58.035690800948885, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.971027811780054, "agent_1": 29.0646629891688}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515878799415225, "mean_processing_ms": 3.4944233502186277, "mean_inference_ms": 2.069635932731918}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2556, "num_steps_trained": 128311808, "num_steps_sampled": 87085568, "sample_throughput": 30579.609, "train_throughput": 0.0, "num_weight_syncs": 72294, "num_samples_dropped": 309, "learner_queue": {"size_count": 223145, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 25.44, "replay_time_ms": 107.871, "update_priorities_time_ms": 52.423, "policy_agent_0": {"added_count": 9224960, "sampled_count": 13605120, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9224960, "sampled_count": 13605120, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4832994341850281, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36988985538482666, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 87085568, "episodes_total": 870880, "training_iteration": 885, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-14-42", "timestamp": 1569086082, "time_this_iter_s": 30.68891978263855, "time_total_s": 27048.889926195145, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ca1e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11431.926191568375, "timesteps_since_restore": 37014784, "iterations_since_restore": 374, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.03298133488745, "episode_reward_min": 57.0086068022694, "episode_reward_mean": 58.09661966608262, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 28.846103959891185, "agent_1": 29.250515706191404}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.651592125247164, "mean_processing_ms": 3.4944524628453904, "mean_inference_ms": 2.0693851964528944}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2559, "num_steps_trained": 128457472, "num_steps_sampled": 87188224, "sample_throughput": 0.0, "train_throughput": 17184.818, "num_weight_syncs": 72494, "num_samples_dropped": 309, "learner_queue": {"size_count": 223714, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.417, "replay_time_ms": 113.358, "update_priorities_time_ms": 56.702, "policy_agent_0": {"added_count": 9250816, "sampled_count": 13640192, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9250816, "sampled_count": 13640192, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43923714756965637, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38083314895629883, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 87188224, "episodes_total": 871904, "training_iteration": 886, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-15-12", "timestamp": 1569086112, "time_this_iter_s": 30.618163585662842, "time_total_s": 27079.508089780807, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c33ab70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11462.544355154037, "timesteps_since_restore": 37117440, "iterations_since_restore": 375, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.29033819509492, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 57.034677163814976, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.14039073257871, "agent_1": 28.894286431236303}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6516353421234726, "mean_processing_ms": 3.4949481182135753, "mean_inference_ms": 2.0694680086217}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2562, "num_steps_trained": 128606464, "num_steps_sampled": 87288320, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 72689, "num_samples_dropped": 309, "learner_queue": {"size_count": 224298, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.307, "replay_time_ms": 90.209, "update_priorities_time_ms": 44.687, "policy_agent_0": {"added_count": 9273856, "sampled_count": 13679616, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9273856, "sampled_count": 13679616, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4157376289367676, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3803861141204834, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 87288320, "episodes_total": 872904, "training_iteration": 887, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-15-43", "timestamp": 1569086143, "time_this_iter_s": 30.61626887321472, "time_total_s": 27110.124358654022, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43fae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11493.160624027252, "timesteps_since_restore": 37217536, "iterations_since_restore": 376, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.008063641323965, "episode_reward_min": 56.37894990482182, "episode_reward_mean": 56.96974205028349, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.219864478545606, "agent_1": 29.749877571738114}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6516442724970808, "mean_processing_ms": 3.4943592895747404, "mean_inference_ms": 2.0692315582954435}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2565, "num_steps_trained": 128759040, "num_steps_sampled": 87388160, "sample_throughput": 5793.331, "train_throughput": 5793.331, "num_weight_syncs": 72885, "num_samples_dropped": 309, "learner_queue": {"size_count": 224892, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.057, "replay_time_ms": 107.403, "update_priorities_time_ms": 50.916, "policy_agent_0": {"added_count": 9296896, "sampled_count": 13717504, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9296896, "sampled_count": 13717504, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4321787357330322, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38326114416122437, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 87388160, "episodes_total": 873912, "training_iteration": 888, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-16-14", "timestamp": 1569086174, "time_this_iter_s": 30.542853593826294, "time_total_s": 27140.66721224785, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f2510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11523.703477621078, "timesteps_since_restore": 37317376, "iterations_since_restore": 377, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.62051261461678, "episode_reward_min": 56.26907517476436, "episode_reward_mean": 57.00286929622664, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.46178675081578, "agent_1": 29.54108254541107}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.651590689595152, "mean_processing_ms": 3.494505360969269, "mean_inference_ms": 2.06939939786205}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2568, "num_steps_trained": 128913152, "num_steps_sampled": 87486976, "sample_throughput": 8929.691, "train_throughput": 0.0, "num_weight_syncs": 73077, "num_samples_dropped": 309, "learner_queue": {"size_count": 225494, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.39, "replay_time_ms": 109.125, "update_priorities_time_ms": 53.947, "policy_agent_0": {"added_count": 9322240, "sampled_count": 13755392, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9322240, "sampled_count": 13755392, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44638150930404663, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3578346371650696, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 87486976, "episodes_total": 874904, "training_iteration": 889, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-16-44", "timestamp": 1569086204, "time_this_iter_s": 30.633529901504517, "time_total_s": 27171.300742149353, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3eaf28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11554.337007522583, "timesteps_since_restore": 37416192, "iterations_since_restore": 378, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.87315877330553, "episode_reward_min": 56.162156540745926, "episode_reward_mean": 57.01958709127418, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.488450271370873, "agent_1": 29.531136819903512}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6516197591499803, "mean_processing_ms": 3.4944778986002887, "mean_inference_ms": 2.0692484731657808}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2571, "num_steps_trained": 129062400, "num_steps_sampled": 87587072, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 73273, "num_samples_dropped": 309, "learner_queue": {"size_count": 226078, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.234, "replay_time_ms": 102.54, "update_priorities_time_ms": 54.916, "policy_agent_0": {"added_count": 9349632, "sampled_count": 13792768, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9349632, "sampled_count": 13792768, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4476606547832489, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35449865460395813, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 87587072, "episodes_total": 875896, "training_iteration": 890, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-17-15", "timestamp": 1569086235, "time_this_iter_s": 30.553093433380127, "time_total_s": 27201.853835582733, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c42cea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11584.890100955963, "timesteps_since_restore": 37516288, "iterations_since_restore": 379, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.66565173286274, "episode_reward_min": 49.10372390547716, "episode_reward_mean": 57.14214066194591, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.854500523684006, "agent_1": 29.287640138262056}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515026889382587, "mean_processing_ms": 3.494173495229758, "mean_inference_ms": 2.069151702180864}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2574, "num_steps_trained": 129215232, "num_steps_sampled": 87686400, "sample_throughput": 25642.208, "train_throughput": 25642.208, "num_weight_syncs": 73467, "num_samples_dropped": 309, "learner_queue": {"size_count": 226674, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.134, "replay_time_ms": 94.659, "update_priorities_time_ms": 50.566, "policy_agent_0": {"added_count": 9372416, "sampled_count": 13832704, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9372416, "sampled_count": 13832704, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42796969413757324, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3434257209300995, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 87686400, "episodes_total": 876888, "training_iteration": 891, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-17-45", "timestamp": 1569086265, "time_this_iter_s": 30.52484154701233, "time_total_s": 27232.378677129745, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4de378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11615.414942502975, "timesteps_since_restore": 37615616, "iterations_since_restore": 380, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.19791236179955, "episode_reward_min": 56.143113866429566, "episode_reward_mean": 56.94271278677045, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.420557570177685, "agent_1": 29.522155216592974}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6517378984736967, "mean_processing_ms": 3.4944277607982146, "mean_inference_ms": 2.0691582248660008}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2577, "num_steps_trained": 129366272, "num_steps_sampled": 87785728, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 73661, "num_samples_dropped": 309, "learner_queue": {"size_count": 227264, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.374, "replay_time_ms": 114.936, "update_priorities_time_ms": 48.749, "policy_agent_0": {"added_count": 9393152, "sampled_count": 13870336, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9393152, "sampled_count": 13870336, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43947187066078186, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3522633910179138, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 87785728, "episodes_total": 877888, "training_iteration": 892, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-18-16", "timestamp": 1569086296, "time_this_iter_s": 30.54530167579651, "time_total_s": 27262.923978805542, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b68c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11645.960244178772, "timesteps_since_restore": 37714944, "iterations_since_restore": 381, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.19866621095297, "episode_reward_min": 55.89677024700552, "episode_reward_mean": 56.82575223766744, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 27.26021438645624, "agent_1": 29.565537851211435}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.65162830763015, "mean_processing_ms": 3.4945534767983055, "mean_inference_ms": 2.0693204151900293}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2580, "num_steps_trained": 129521152, "num_steps_sampled": 87883776, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 73853, "num_samples_dropped": 309, "learner_queue": {"size_count": 227869, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.457, "replay_time_ms": 120.48, "update_priorities_time_ms": 55.636, "policy_agent_0": {"added_count": 9417984, "sampled_count": 13908480, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9417984, "sampled_count": 13908480, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4402652382850647, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3304843008518219, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 87883776, "episodes_total": 878864, "training_iteration": 893, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-18-47", "timestamp": 1569086327, "time_this_iter_s": 30.637061595916748, "time_total_s": 27293.56104040146, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11676.597305774689, "timesteps_since_restore": 37812992, "iterations_since_restore": 382, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.763540057278945, "episode_reward_min": 53.467539936087384, "episode_reward_mean": 56.79996604558642, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.177338820944552, "agent_1": 29.62262722464211}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6514803398439833, "mean_processing_ms": 3.4944297208447797, "mean_inference_ms": 2.0695107201539362}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2583, "num_steps_trained": 129673216, "num_steps_sampled": 87983616, "sample_throughput": 12548.111, "train_throughput": 12548.111, "num_weight_syncs": 74047, "num_samples_dropped": 309, "learner_queue": {"size_count": 228463, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.842, "replay_time_ms": 102.996, "update_priorities_time_ms": 62.727, "policy_agent_0": {"added_count": 9442048, "sampled_count": 13945856, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9442048, "sampled_count": 13945856, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42107218503952026, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3269030749797821, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 87983616, "episodes_total": 879864, "training_iteration": 894, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-19-17", "timestamp": 1569086357, "time_this_iter_s": 30.611210346221924, "time_total_s": 27324.17225074768, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c332950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11707.20851612091, "timesteps_since_restore": 37912832, "iterations_since_restore": 383, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.05687049900416, "episode_reward_min": 47.84056556957627, "episode_reward_mean": 56.368684636329235, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.786025094200784, "agent_1": 29.58265954212869}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515776048941385, "mean_processing_ms": 3.4943341133084367, "mean_inference_ms": 2.0694675066735337}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2586, "num_steps_trained": 129825536, "num_steps_sampled": 88082688, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 74240, "num_samples_dropped": 309, "learner_queue": {"size_count": 229059, "size_mean": 0.26, "size_std": 0.4386342439892262, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.024, "replay_time_ms": 86.041, "update_priorities_time_ms": 55.466, "policy_agent_0": {"added_count": 9466112, "sampled_count": 13982976, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9466112, "sampled_count": 13982976, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44904202222824097, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35803142189979553, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 88082688, "episodes_total": 880856, "training_iteration": 895, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-19-48", "timestamp": 1569086388, "time_this_iter_s": 30.606791019439697, "time_total_s": 27354.77904176712, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c39c950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11737.81530714035, "timesteps_since_restore": 38011904, "iterations_since_restore": 384, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.04349524477567, "episode_reward_min": 54.907320896176294, "episode_reward_mean": 56.710242091286624, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.05895766709638, "agent_1": 29.651284424190496}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6514392088522994, "mean_processing_ms": 3.4946556180175308, "mean_inference_ms": 2.0695307537898597}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2589, "num_steps_trained": 129973760, "num_steps_sampled": 88183296, "sample_throughput": 0.0, "train_throughput": 12575.298, "num_weight_syncs": 74437, "num_samples_dropped": 309, "learner_queue": {"size_count": 229637, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.66, "replay_time_ms": 81.671, "update_priorities_time_ms": 39.739, "policy_agent_0": {"added_count": 9488384, "sampled_count": 14021120, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9488384, "sampled_count": 14021120, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44881922006607056, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34421178698539734, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 88183296, "episodes_total": 881856, "training_iteration": 896, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-20-19", "timestamp": 1569086419, "time_this_iter_s": 30.574379444122314, "time_total_s": 27385.353421211243, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2b4bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11768.389686584473, "timesteps_since_restore": 38112512, "iterations_since_restore": 385, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.21171647507269, "episode_reward_min": 56.05623570548609, "episode_reward_mean": 57.14951324256259, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.727910747747, "agent_1": 29.42160249481576}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515459383884276, "mean_processing_ms": 3.4937252666162566, "mean_inference_ms": 2.068997734647018}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2592, "num_steps_trained": 130121472, "num_steps_sampled": 88284416, "sample_throughput": 0.0, "train_throughput": 20940.437, "num_weight_syncs": 74635, "num_samples_dropped": 309, "learner_queue": {"size_count": 230215, "size_mean": 0.24, "size_std": 0.4270831300812525, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.256, "replay_time_ms": 112.054, "update_priorities_time_ms": 57.484, "policy_agent_0": {"added_count": 9515008, "sampled_count": 14056960, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9515008, "sampled_count": 14056960, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44131118059158325, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35497355461120605, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 88284416, "episodes_total": 882864, "training_iteration": 897, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-20-49", "timestamp": 1569086449, "time_this_iter_s": 30.587703704833984, "time_total_s": 27415.941124916077, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ef488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11798.977390289307, "timesteps_since_restore": 38213632, "iterations_since_restore": 386, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.1825708174163, "episode_reward_min": 56.10498891114063, "episode_reward_mean": 56.88005909424145, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.289064262842782, "agent_1": 29.59099483139891}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6514099333231984, "mean_processing_ms": 3.4940537862206074, "mean_inference_ms": 2.0691532793577965}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2595, "num_steps_trained": 130272000, "num_steps_sampled": 88384000, "sample_throughput": 7326.895, "train_throughput": 0.0, "num_weight_syncs": 74830, "num_samples_dropped": 309, "learner_queue": {"size_count": 230803, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.68, "replay_time_ms": 91.028, "update_priorities_time_ms": 49.626, "policy_agent_0": {"added_count": 9539840, "sampled_count": 14093824, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9539840, "sampled_count": 14093824, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4399264454841614, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3560839593410492, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 88384000, "episodes_total": 883864, "training_iteration": 898, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-21-20", "timestamp": 1569086480, "time_this_iter_s": 30.57953119277954, "time_total_s": 27446.520656108856, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0777fe18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11829.556921482086, "timesteps_since_restore": 38313216, "iterations_since_restore": 387, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.10937888125639, "episode_reward_min": 56.11079058669317, "episode_reward_mean": 56.78220963151567, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 27.085645726971574, "agent_1": 29.69656390454434}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.651485729197244, "mean_processing_ms": 3.494023735742466, "mean_inference_ms": 2.068946262528674}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2598, "num_steps_trained": 130417920, "num_steps_sampled": 88486144, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 75029, "num_samples_dropped": 309, "learner_queue": {"size_count": 231372, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.897, "replay_time_ms": 105.175, "update_priorities_time_ms": 55.004, "policy_agent_0": {"added_count": 9563136, "sampled_count": 14128640, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9563136, "sampled_count": 14128640, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41659602522850037, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3379742205142975, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 88486144, "episodes_total": 884888, "training_iteration": 899, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-21-50", "timestamp": 1569086510, "time_this_iter_s": 30.563072204589844, "time_total_s": 27477.083728313446, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077bf268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11860.119993686676, "timesteps_since_restore": 38415360, "iterations_since_restore": 388, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.08652153429145, "episode_reward_min": 55.851294239295534, "episode_reward_mean": 56.765493846923505, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.110598471496715, "agent_1": 29.65489537542705}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6515651746378747, "mean_processing_ms": 3.4939845026060694, "mean_inference_ms": 2.0686520840377374}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2601, "num_steps_trained": 130568192, "num_steps_sampled": 88586496, "sample_throughput": 0.0, "train_throughput": 14610.72, "num_weight_syncs": 75226, "num_samples_dropped": 309, "learner_queue": {"size_count": 231959, "size_mean": 2.0, "size_std": 3.340658617698013, "size_quantiles": [0.0, 0.0, 0.0, 8.0, 12.0]}, "replay_shard_0": {"add_batch_time_ms": 36.417, "replay_time_ms": 81.661, "update_priorities_time_ms": 57.143, "policy_agent_0": {"added_count": 9587456, "sampled_count": 14165504, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9587456, "sampled_count": 14165504, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4347686767578125, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33497747778892517, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 88586496, "episodes_total": 885888, "training_iteration": 900, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-22-21", "timestamp": 1569086541, "time_this_iter_s": 30.597663164138794, "time_total_s": 27507.681391477585, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0770fc80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11890.717656850815, "timesteps_since_restore": 38515712, "iterations_since_restore": 389, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.37770512665996, "episode_reward_min": 49.12027979598748, "episode_reward_mean": 56.14909792073692, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.282518191353095, "agent_1": 29.86657972938405}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6513720927882539, "mean_processing_ms": 3.4936648858407375, "mean_inference_ms": 2.06859016905104}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2604, "num_steps_trained": 130719744, "num_steps_sampled": 88685568, "sample_throughput": 6029.852, "train_throughput": 6029.852, "num_weight_syncs": 75419, "num_samples_dropped": 309, "learner_queue": {"size_count": 232552, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.337, "replay_time_ms": 102.041, "update_priorities_time_ms": 68.234, "policy_agent_0": {"added_count": 9609472, "sampled_count": 14202368, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9609472, "sampled_count": 14202368, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46210646629333496, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3345029354095459, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 88685568, "episodes_total": 886880, "training_iteration": 901, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-22-52", "timestamp": 1569086572, "time_this_iter_s": 30.55639123916626, "time_total_s": 27538.23778271675, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07769bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11921.274048089981, "timesteps_since_restore": 38614784, "iterations_since_restore": 390, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.20303460328133, "episode_reward_min": 51.29035101631659, "episode_reward_mean": 55.51728815412487, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.666788316542885, "agent_1": 29.85049983758222}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6513574722139737, "mean_processing_ms": 3.4935258897474997, "mean_inference_ms": 2.0684736798378154}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2607, "num_steps_trained": 130870528, "num_steps_sampled": 88785920, "sample_throughput": 31725.272, "train_throughput": 0.0, "num_weight_syncs": 75614, "num_samples_dropped": 309, "learner_queue": {"size_count": 233140, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.188, "replay_time_ms": 107.096, "update_priorities_time_ms": 56.051, "policy_agent_0": {"added_count": 9631744, "sampled_count": 14242560, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9631744, "sampled_count": 14242560, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4561901390552521, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3309398591518402, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 88785920, "episodes_total": 887888, "training_iteration": 902, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-23-22", "timestamp": 1569086602, "time_this_iter_s": 30.604588747024536, "time_total_s": 27568.842371463776, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07722950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11951.878636837006, "timesteps_since_restore": 38715136, "iterations_since_restore": 391, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.1826720662484, "episode_reward_min": 50.94616635637795, "episode_reward_mean": 55.879756115438724, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.063766137461947, "agent_1": 29.815989977976994}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6512918155558082, "mean_processing_ms": 3.4936209749237483, "mean_inference_ms": 2.0684718381836524}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2610, "num_steps_trained": 131015936, "num_steps_sampled": 88889088, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 75816, "num_samples_dropped": 309, "learner_queue": {"size_count": 233708, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.855, "replay_time_ms": 96.174, "update_priorities_time_ms": 54.714, "policy_agent_0": {"added_count": 9655296, "sampled_count": 14279936, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9655296, "sampled_count": 14279936, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45446690917015076, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34076717495918274, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 88889088, "episodes_total": 888920, "training_iteration": 903, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-23-53", "timestamp": 1569086633, "time_this_iter_s": 30.539283514022827, "time_total_s": 27599.3816549778, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07737e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 11982.417920351028, "timesteps_since_restore": 38818304, "iterations_since_restore": 392, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.988014081801346, "episode_reward_min": 50.636553904039694, "episode_reward_mean": 55.765139889275616, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.897880042822642, "agent_1": 29.86725984645322}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6512585922453512, "mean_processing_ms": 3.4935493357031993, "mean_inference_ms": 2.0686547790122325}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2613, "num_steps_trained": 131164928, "num_steps_sampled": 88989952, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 76013, "num_samples_dropped": 309, "learner_queue": {"size_count": 234290, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.186, "replay_time_ms": 105.823, "update_priorities_time_ms": 52.214, "policy_agent_0": {"added_count": 9679872, "sampled_count": 14317824, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9679872, "sampled_count": 14317824, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47441917657852173, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3432062864303589, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 88989952, "episodes_total": 889928, "training_iteration": 904, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-24-23", "timestamp": 1569086663, "time_this_iter_s": 30.571587324142456, "time_total_s": 27629.95324230194, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077bf048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12012.98950767517, "timesteps_since_restore": 38919168, "iterations_since_restore": 393, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.66529164001586, "episode_reward_min": 49.41242823051597, "episode_reward_mean": 53.91523738906867, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 23.389410315810174, "agent_1": 30.52582707325858}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6513356324313176, "mean_processing_ms": 3.4932960695820174, "mean_inference_ms": 2.068378496907976}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2616, "num_steps_trained": 131315968, "num_steps_sampled": 89090304, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 76209, "num_samples_dropped": 309, "learner_queue": {"size_count": 234880, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.642, "replay_time_ms": 111.858, "update_priorities_time_ms": 52.79, "policy_agent_0": {"added_count": 9701632, "sampled_count": 14356736, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9701632, "sampled_count": 14356736, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.522061824798584, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33113163709640503, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 89090304, "episodes_total": 890928, "training_iteration": 905, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-24-54", "timestamp": 1569086694, "time_this_iter_s": 30.487486124038696, "time_total_s": 27660.44072842598, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07765620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12043.47699379921, "timesteps_since_restore": 39019520, "iterations_since_restore": 394, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.09434890455645, "episode_reward_min": 50.562605393406066, "episode_reward_mean": 53.525101776448885, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 23.164276784662444, "agent_1": 30.360824991786455}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6512281293137742, "mean_processing_ms": 3.493360236258645, "mean_inference_ms": 2.068360574177712}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2619, "num_steps_trained": 131466496, "num_steps_sampled": 89191168, "sample_throughput": 15534.235, "train_throughput": 0.0, "num_weight_syncs": 76406, "num_samples_dropped": 309, "learner_queue": {"size_count": 235468, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.661, "replay_time_ms": 100.984, "update_priorities_time_ms": 57.354, "policy_agent_0": {"added_count": 9726976, "sampled_count": 14392320, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9726976, "sampled_count": 14392320, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5863113403320312, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3123445212841034, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 89191168, "episodes_total": 891944, "training_iteration": 906, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-25-25", "timestamp": 1569086725, "time_this_iter_s": 30.598294258117676, "time_total_s": 27691.039022684097, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c037e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12074.075288057327, "timesteps_since_restore": 39120384, "iterations_since_restore": 395, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 53.941365049915845, "episode_reward_min": 49.129385525209436, "episode_reward_mean": 53.41099227530592, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 23.254523786027388, "agent_1": 30.156468489278527}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6512042512028999, "mean_processing_ms": 3.493340583015657, "mean_inference_ms": 2.068262919639989}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2622, "num_steps_trained": 131613184, "num_steps_sampled": 89292800, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 76604, "num_samples_dropped": 309, "learner_queue": {"size_count": 236041, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.651, "replay_time_ms": 90.98, "update_priorities_time_ms": 48.845, "policy_agent_0": {"added_count": 9752320, "sampled_count": 14427136, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9752320, "sampled_count": 14427136, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.679340124130249, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3316648006439209, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 89292800, "episodes_total": 892960, "training_iteration": 907, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-25-55", "timestamp": 1569086755, "time_this_iter_s": 30.58366322517395, "time_total_s": 27721.62268590927, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12104.658951282501, "timesteps_since_restore": 39222016, "iterations_since_restore": 396, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.92320829012506, "episode_reward_min": 50.82085200399381, "episode_reward_mean": 53.59420592087079, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 23.07412942130157, "agent_1": 30.52007649956929}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.651231251880461, "mean_processing_ms": 3.4927567152813794, "mean_inference_ms": 2.0680081939706425}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2625, "num_steps_trained": 131766016, "num_steps_sampled": 89391104, "sample_throughput": 13319.545, "train_throughput": 0.0, "num_weight_syncs": 76796, "num_samples_dropped": 309, "learner_queue": {"size_count": 236639, "size_mean": 0.18, "size_std": 0.3841874542459709, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.407, "replay_time_ms": 105.288, "update_priorities_time_ms": 51.658, "policy_agent_0": {"added_count": 9774848, "sampled_count": 14467328, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9774848, "sampled_count": 14467328, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7200899124145508, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31042709946632385, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 89391104, "episodes_total": 893944, "training_iteration": 908, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-26-26", "timestamp": 1569086786, "time_this_iter_s": 30.538090467453003, "time_total_s": 27752.160776376724, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077d3378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12135.197041749954, "timesteps_since_restore": 39320320, "iterations_since_restore": 397, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.07963266892512, "episode_reward_min": 50.17230044414671, "episode_reward_mean": 53.208884504673705, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 22.931996648530546, "agent_1": 30.27688785614316}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6512596277829523, "mean_processing_ms": 3.493045387054589, "mean_inference_ms": 2.0680969038981853}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2628, "num_steps_trained": 131917312, "num_steps_sampled": 89490944, "sample_throughput": 6437.108, "train_throughput": 12874.216, "num_weight_syncs": 76992, "num_samples_dropped": 309, "learner_queue": {"size_count": 237230, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.785, "replay_time_ms": 93.497, "update_priorities_time_ms": 49.143, "policy_agent_0": {"added_count": 9800192, "sampled_count": 14502912, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9800192, "sampled_count": 14502912, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7413502335548401, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3079759478569031, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 89490944, "episodes_total": 894936, "training_iteration": 909, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-26-56", "timestamp": 1569086816, "time_this_iter_s": 30.542999744415283, "time_total_s": 27782.70377612114, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2dcc80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12165.74004149437, "timesteps_since_restore": 39420160, "iterations_since_restore": 398, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.148361014516965, "episode_reward_min": 52.93087761022496, "episode_reward_mean": 53.91709887987285, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 24.039331064286912, "agent_1": 29.87776781558592}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6512727890598207, "mean_processing_ms": 3.4927500727721075, "mean_inference_ms": 2.06807598896185}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2631, "num_steps_trained": 132062464, "num_steps_sampled": 89593856, "sample_throughput": 9778.58, "train_throughput": 0.0, "num_weight_syncs": 77193, "num_samples_dropped": 309, "learner_queue": {"size_count": 237797, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.153, "replay_time_ms": 119.892, "update_priorities_time_ms": 60.991, "policy_agent_0": {"added_count": 9827072, "sampled_count": 14538240, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9827072, "sampled_count": 14538240, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7529171705245972, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31127679347991943, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 89593856, "episodes_total": 895960, "training_iteration": 910, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-27-27", "timestamp": 1569086847, "time_this_iter_s": 30.638844966888428, "time_total_s": 27813.342621088028, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12196.378886461258, "timesteps_since_restore": 39523072, "iterations_since_restore": 399, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.0949307254034, "episode_reward_min": 52.67536603340604, "episode_reward_mean": 54.67984696887893, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 24.749103338670302, "agent_1": 29.930743630208703}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6512035182550912, "mean_processing_ms": 3.492436664709227, "mean_inference_ms": 2.067987180209197}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2634, "num_steps_trained": 132207616, "num_steps_sampled": 89696000, "sample_throughput": 12062.821, "train_throughput": 0.0, "num_weight_syncs": 77392, "num_samples_dropped": 309, "learner_queue": {"size_count": 238364, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.3, "replay_time_ms": 93.187, "update_priorities_time_ms": 50.126, "policy_agent_0": {"added_count": 9855232, "sampled_count": 14576128, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9855232, "sampled_count": 14576128, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7586463689804077, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3282334804534912, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 89696000, "episodes_total": 896992, "training_iteration": 911, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-27-58", "timestamp": 1569086878, "time_this_iter_s": 30.559406518936157, "time_total_s": 27843.902027606964, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c473ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12226.938292980194, "timesteps_since_restore": 39625216, "iterations_since_restore": 400, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.93912191523355, "episode_reward_min": 46.771852841351475, "episode_reward_mean": 52.49282812055796, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 23.61700393388921, "agent_1": 28.875824186668794}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6511304527717109, "mean_processing_ms": 3.492604775251985, "mean_inference_ms": 2.06803350918201}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2637, "num_steps_trained": 132358144, "num_steps_sampled": 89795328, "sample_throughput": 0.0, "train_throughput": 18833.776, "num_weight_syncs": 77585, "num_samples_dropped": 309, "learner_queue": {"size_count": 238951, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.886, "replay_time_ms": 87.511, "update_priorities_time_ms": 49.432, "policy_agent_0": {"added_count": 9879808, "sampled_count": 14614528, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9879808, "sampled_count": 14614528, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7505533695220947, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34388959407806396, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 89795328, "episodes_total": 897976, "training_iteration": 912, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-28-28", "timestamp": 1569086908, "time_this_iter_s": 30.601751565933228, "time_total_s": 27874.503779172897, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12257.540044546127, "timesteps_since_restore": 39724544, "iterations_since_restore": 401, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.4955193208648, "episode_reward_min": 44.834203769615904, "episode_reward_mean": 57.0572089493999, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.309496689173887, "agent_1": 30.747712260226187}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6511424548375716, "mean_processing_ms": 3.492539422747685, "mean_inference_ms": 2.067850477774649}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2640, "num_steps_trained": 132509440, "num_steps_sampled": 89895936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 77783, "num_samples_dropped": 309, "learner_queue": {"size_count": 239542, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.635, "replay_time_ms": 105.596, "update_priorities_time_ms": 52.077, "policy_agent_0": {"added_count": 9903872, "sampled_count": 14651904, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9903872, "sampled_count": 14651904, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7105066180229187, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35147520899772644, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 89895936, "episodes_total": 898984, "training_iteration": 913, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-28-59", "timestamp": 1569086939, "time_this_iter_s": 30.649608612060547, "time_total_s": 27905.153387784958, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b4378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12288.189653158188, "timesteps_since_restore": 39825152, "iterations_since_restore": 402, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.41557191258834, "episode_reward_min": 52.54179767332853, "episode_reward_mean": 57.29806980731235, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.449025346866303, "agent_1": 30.84904446044602}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6511083522115352, "mean_processing_ms": 3.4918195718692764, "mean_inference_ms": 2.067653991619398}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2643, "num_steps_trained": 132658688, "num_steps_sampled": 89997056, "sample_throughput": 0.0, "train_throughput": 22731.43, "num_weight_syncs": 77980, "num_samples_dropped": 309, "learner_queue": {"size_count": 240125, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.774, "replay_time_ms": 107.9, "update_priorities_time_ms": 54.217, "policy_agent_0": {"added_count": 9927680, "sampled_count": 14688256, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9927680, "sampled_count": 14688256, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6618833541870117, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33606287837028503, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 89997056, "episodes_total": 899992, "training_iteration": 914, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-29-30", "timestamp": 1569086970, "time_this_iter_s": 30.6765615940094, "time_total_s": 27935.829949378967, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12318.866214752197, "timesteps_since_restore": 39926272, "iterations_since_restore": 403, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.89317898092091, "episode_reward_min": 51.5108549823556, "episode_reward_mean": 57.441036848300556, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.230689969165486, "agent_1": 31.210346879134992}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.651121659855116, "mean_processing_ms": 3.4925857248302568, "mean_inference_ms": 2.0680598925526676}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2646, "num_steps_trained": 132809728, "num_steps_sampled": 90097664, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 78177, "num_samples_dropped": 309, "learner_queue": {"size_count": 240715, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 28.668, "replay_time_ms": 92.208, "update_priorities_time_ms": 49.364, "policy_agent_0": {"added_count": 9948416, "sampled_count": 14726912, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9948416, "sampled_count": 14726912, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6132234334945679, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3153585195541382, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 90097664, "episodes_total": 901000, "training_iteration": 915, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-30-00", "timestamp": 1569087000, "time_this_iter_s": 30.510688066482544, "time_total_s": 27966.34063744545, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44f2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12349.37690281868, "timesteps_since_restore": 40026880, "iterations_since_restore": 404, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.63891144762458, "episode_reward_min": 45.79787616431336, "episode_reward_mean": 56.23991538339648, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.682635221338693, "agent_1": 29.557280162058024}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509908215874171, "mean_processing_ms": 3.4920630036194935, "mean_inference_ms": 2.06802982198002}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2649, "num_steps_trained": 132962560, "num_steps_sampled": 90196480, "sample_throughput": 18373.72, "train_throughput": 18373.72, "num_weight_syncs": 78370, "num_samples_dropped": 309, "learner_queue": {"size_count": 241312, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 26.762, "replay_time_ms": 94.583, "update_priorities_time_ms": 44.005, "policy_agent_0": {"added_count": 9974528, "sampled_count": 14765056, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 9974528, "sampled_count": 14765056, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5438069105148315, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3452925682067871, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 90196480, "episodes_total": 901984, "training_iteration": 916, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-30-31", "timestamp": 1569087031, "time_this_iter_s": 30.545926094055176, "time_total_s": 27996.886563539505, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4290d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12379.922828912735, "timesteps_since_restore": 40125696, "iterations_since_restore": 405, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.3395675830116, "episode_reward_min": 52.01633120866406, "episode_reward_mean": 57.032423152189445, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 27.227769466708303, "agent_1": 29.80465368548129}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509144125256177, "mean_processing_ms": 3.491664425623787, "mean_inference_ms": 2.0676208244519416}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2652, "num_steps_trained": 133107456, "num_steps_sampled": 90298624, "sample_throughput": 5996.146, "train_throughput": 0.0, "num_weight_syncs": 78569, "num_samples_dropped": 309, "learner_queue": {"size_count": 241881, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.26, "replay_time_ms": 109.188, "update_priorities_time_ms": 66.196, "policy_agent_0": {"added_count": 10000896, "sampled_count": 14799872, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10000896, "sampled_count": 14799872, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5327484011650085, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34209808707237244, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 90298624, "episodes_total": 903016, "training_iteration": 917, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-31-01", "timestamp": 1569087061, "time_this_iter_s": 30.58614158630371, "time_total_s": 28027.47270512581, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ce7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12410.508970499039, "timesteps_since_restore": 40227840, "iterations_since_restore": 406, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.33069820425154, "episode_reward_min": 54.86695099731647, "episode_reward_mean": 57.732200390084756, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.207621336993622, "agent_1": 30.524579053091202}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6510004399691875, "mean_processing_ms": 3.4920376876152286, "mean_inference_ms": 2.0677541756630724}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2655, "num_steps_trained": 133257472, "num_steps_sampled": 90397696, "sample_throughput": 27446.687, "train_throughput": 0.0, "num_weight_syncs": 78762, "num_samples_dropped": 309, "learner_queue": {"size_count": 242464, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.723, "replay_time_ms": 91.724, "update_priorities_time_ms": 51.11, "policy_agent_0": {"added_count": 10029312, "sampled_count": 14836224, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10029312, "sampled_count": 14836224, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5195164084434509, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3383048176765442, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 90397696, "episodes_total": 904000, "training_iteration": 918, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-31-32", "timestamp": 1569087092, "time_this_iter_s": 30.548601865768433, "time_total_s": 28058.021306991577, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ca1e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12441.057572364807, "timesteps_since_restore": 40326912, "iterations_since_restore": 407, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.851419179866156, "episode_reward_min": 52.193848092278046, "episode_reward_mean": 55.262980937122045, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 24.45629642307735, "agent_1": 30.80668451404471}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509613993855567, "mean_processing_ms": 3.4914293996450154, "mean_inference_ms": 2.06767070442633}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2658, "num_steps_trained": 133405696, "num_steps_sampled": 90499584, "sample_throughput": 0.0, "train_throughput": 12502.961, "num_weight_syncs": 78961, "num_samples_dropped": 309, "learner_queue": {"size_count": 243043, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.758, "replay_time_ms": 112.77, "update_priorities_time_ms": 53.384, "policy_agent_0": {"added_count": 10054656, "sampled_count": 14872576, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10054656, "sampled_count": 14872576, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5378521680831909, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3375520408153534, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 90499584, "episodes_total": 905016, "training_iteration": 919, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-32-03", "timestamp": 1569087123, "time_this_iter_s": 30.60726261138916, "time_total_s": 28088.628569602966, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28e1e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12471.664834976196, "timesteps_since_restore": 40428800, "iterations_since_restore": 408, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.03450427336024, "episode_reward_min": 46.35794855501998, "episode_reward_mean": 53.88950712071796, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 23.270104418816288, "agent_1": 30.61940270190171}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6508742919990348, "mean_processing_ms": 3.4915609096615157, "mean_inference_ms": 2.067616867326368}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2661, "num_steps_trained": 133555200, "num_steps_sampled": 90599424, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 79157, "num_samples_dropped": 309, "learner_queue": {"size_count": 243627, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.667, "replay_time_ms": 103.871, "update_priorities_time_ms": 51.966, "policy_agent_0": {"added_count": 10080256, "sampled_count": 14907392, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10080256, "sampled_count": 14907392, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5867327451705933, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3322303593158722, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 90599424, "episodes_total": 906016, "training_iteration": 920, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-32-33", "timestamp": 1569087153, "time_this_iter_s": 30.57675838470459, "time_total_s": 28119.20532798767, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c015158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12502.2415933609, "timesteps_since_restore": 40528640, "iterations_since_restore": 409, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.88923991575398, "episode_reward_min": 46.4293372023683, "episode_reward_mean": 54.278805691304605, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 22.05403702800339, "agent_1": 32.22476866330125}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.650783924937384, "mean_processing_ms": 3.4916878124149324, "mean_inference_ms": 2.0676881791105903}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2664, "num_steps_trained": 133704960, "num_steps_sampled": 90699264, "sample_throughput": 16718.701, "train_throughput": 0.0, "num_weight_syncs": 79351, "num_samples_dropped": 309, "learner_queue": {"size_count": 244213, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.183, "replay_time_ms": 93.102, "update_priorities_time_ms": 52.897, "policy_agent_0": {"added_count": 10106624, "sampled_count": 14944256, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10106624, "sampled_count": 14944256, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6769784092903137, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3006049394607544, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 90699264, "episodes_total": 907008, "training_iteration": 921, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-33-04", "timestamp": 1569087184, "time_this_iter_s": 30.675862550735474, "time_total_s": 28149.881190538406, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12532.917455911636, "timesteps_since_restore": 40628480, "iterations_since_restore": 410, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 54.51004424916066, "episode_reward_min": 43.75332540196929, "episode_reward_mean": 52.560145468175946, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 22.286117675361258, "agent_1": 30.274027792814728}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6508532347581382, "mean_processing_ms": 3.491739266211105, "mean_inference_ms": 2.067645334333043}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2667, "num_steps_trained": 133850112, "num_steps_sampled": 90797824, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 79543, "num_samples_dropped": 309, "learner_queue": {"size_count": 244779, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.056, "replay_time_ms": 115.718, "update_priorities_time_ms": 56.073, "policy_agent_0": {"added_count": 10132736, "sampled_count": 14978048, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10132736, "sampled_count": 14978048, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7373101711273193, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29252681136131287, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 90797824, "episodes_total": 908008, "training_iteration": 922, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-33-34", "timestamp": 1569087214, "time_this_iter_s": 30.42401146888733, "time_total_s": 28180.305202007294, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077dfea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12563.341467380524, "timesteps_since_restore": 40727040, "iterations_since_restore": 411, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.72577428989286, "episode_reward_min": 46.45315983280025, "episode_reward_mean": 50.727228003905914, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 22.742458619924765, "agent_1": 27.984769383981178}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6508732735326969, "mean_processing_ms": 3.4917001516265342, "mean_inference_ms": 2.0675813004986563}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2670, "num_steps_trained": 133998592, "num_steps_sampled": 90898176, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 79739, "num_samples_dropped": 309, "learner_queue": {"size_count": 245360, "size_mean": 0.2, "size_std": 0.447213595499958, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.563, "replay_time_ms": 105.958, "update_priorities_time_ms": 62.276, "policy_agent_0": {"added_count": 10157568, "sampled_count": 15016704, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10157568, "sampled_count": 15016704, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7727935910224915, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3358817398548126, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 90898176, "episodes_total": 909008, "training_iteration": 923, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-34-05", "timestamp": 1569087245, "time_this_iter_s": 30.651198863983154, "time_total_s": 28210.956400871277, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07769e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12593.992666244507, "timesteps_since_restore": 40827392, "iterations_since_restore": 412, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.735492661364795, "episode_reward_min": 46.4293372023683, "episode_reward_mean": 51.11870669026707, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 22.362505208552225, "agent_1": 28.756201481714893}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6508789961196029, "mean_processing_ms": 3.4914274546871336, "mean_inference_ms": 2.0673351458417257}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2673, "num_steps_trained": 134145024, "num_steps_sampled": 90998272, "sample_throughput": 9481.583, "train_throughput": 0.0, "num_weight_syncs": 79935, "num_samples_dropped": 309, "learner_queue": {"size_count": 245931, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.169, "replay_time_ms": 92.971, "update_priorities_time_ms": 45.784, "policy_agent_0": {"added_count": 10179584, "sampled_count": 15053824, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10179584, "sampled_count": 15053824, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7848315834999084, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3427734076976776, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 90998272, "episodes_total": 910008, "training_iteration": 924, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-34-36", "timestamp": 1569087276, "time_this_iter_s": 30.553871631622314, "time_total_s": 28241.5102725029, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0776f488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12624.54653787613, "timesteps_since_restore": 40927488, "iterations_since_restore": 413, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.92560487629057, "episode_reward_min": 49.813107853065006, "episode_reward_mean": 57.03783723561533, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.789997723132096, "agent_1": 31.247839512483115}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509102294765569, "mean_processing_ms": 3.4917011828423483, "mean_inference_ms": 2.067574188720635}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2676, "num_steps_trained": 134299136, "num_steps_sampled": 91097088, "sample_throughput": 0.0, "train_throughput": 24874.136, "num_weight_syncs": 80129, "num_samples_dropped": 309, "learner_queue": {"size_count": 246533, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.854, "replay_time_ms": 94.037, "update_priorities_time_ms": 45.466, "policy_agent_0": {"added_count": 10204928, "sampled_count": 15092480, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10204928, "sampled_count": 15092480, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7600461840629578, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33937785029411316, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 91097088, "episodes_total": 911008, "training_iteration": 925, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-35-06", "timestamp": 1569087306, "time_this_iter_s": 30.477413654327393, "time_total_s": 28271.987686157227, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076caea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12655.023951530457, "timesteps_since_restore": 41026304, "iterations_since_restore": 414, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.87318616974934, "episode_reward_min": 56.07380787284566, "episode_reward_mean": 57.57675238744434, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.11500664214746, "agent_1": 31.46174574529675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509432718394971, "mean_processing_ms": 3.4916941496434495, "mean_inference_ms": 2.067586949670884}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2679, "num_steps_trained": 134450688, "num_steps_sampled": 91197184, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 80323, "num_samples_dropped": 309, "learner_queue": {"size_count": 247125, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.529, "replay_time_ms": 69.942, "update_priorities_time_ms": 44.052, "policy_agent_0": {"added_count": 10233088, "sampled_count": 15132160, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10233088, "sampled_count": 15132160, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.68654465675354, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30622291564941406, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 91197184, "episodes_total": 912000, "training_iteration": 926, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-35-37", "timestamp": 1569087337, "time_this_iter_s": 30.455327033996582, "time_total_s": 28302.443013191223, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076d1ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12685.479278564453, "timesteps_since_restore": 41126400, "iterations_since_restore": 415, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.95382917695776, "episode_reward_min": 57.049202498058136, "episode_reward_mean": 57.656356517894146, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.158285600956244, "agent_1": 31.498070916937777}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6511098391654028, "mean_processing_ms": 3.491637145484374, "mean_inference_ms": 2.0674369719077275}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2682, "num_steps_trained": 134603776, "num_steps_sampled": 91295232, "sample_throughput": 0.0, "train_throughput": 12133.361, "num_weight_syncs": 80516, "num_samples_dropped": 309, "learner_queue": {"size_count": 247724, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.997, "replay_time_ms": 82.243, "update_priorities_time_ms": 39.341, "policy_agent_0": {"added_count": 10260736, "sampled_count": 15172864, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10260736, "sampled_count": 15172864, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.624527633190155, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30278950929641724, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 91295232, "episodes_total": 912976, "training_iteration": 927, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-36-07", "timestamp": 1569087367, "time_this_iter_s": 30.483383655548096, "time_total_s": 28332.92639684677, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076de048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12715.962662220001, "timesteps_since_restore": 41224448, "iterations_since_restore": 416, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.99259899961658, "episode_reward_min": 56.742780062099555, "episode_reward_mean": 57.658867114106236, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.15281969656587, "agent_1": 31.506047417540234}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509891733407192, "mean_processing_ms": 3.4914282560789225, "mean_inference_ms": 2.0674505508304577}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2685, "num_steps_trained": 134755840, "num_steps_sampled": 91394816, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 80710, "num_samples_dropped": 309, "learner_queue": {"size_count": 248317, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.142, "replay_time_ms": 111.666, "update_priorities_time_ms": 61.217, "policy_agent_0": {"added_count": 10289664, "sampled_count": 15210752, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10289664, "sampled_count": 15210752, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5884706974029541, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3092048168182373, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 91394816, "episodes_total": 913976, "training_iteration": 928, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-36-38", "timestamp": 1569087398, "time_this_iter_s": 30.643611431121826, "time_total_s": 28363.570008277893, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07769b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12746.606273651123, "timesteps_since_restore": 41324032, "iterations_since_restore": 417, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.16388634285207, "episode_reward_min": 54.81950688289299, "episode_reward_mean": 58.51641899075182, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.000441042937375, "agent_1": 31.515977947814463}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6510954019754079, "mean_processing_ms": 3.491536971423798, "mean_inference_ms": 2.06754997774072}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2688, "num_steps_trained": 134905856, "num_steps_sampled": 91495680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 80907, "num_samples_dropped": 309, "learner_queue": {"size_count": 248903, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.062, "replay_time_ms": 115.417, "update_priorities_time_ms": 54.719, "policy_agent_0": {"added_count": 10313216, "sampled_count": 15247616, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10313216, "sampled_count": 15247616, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5641449093818665, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.299643337726593, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 91495680, "episodes_total": 914976, "training_iteration": 929, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-37-09", "timestamp": 1569087429, "time_this_iter_s": 30.6616108417511, "time_total_s": 28394.231619119644, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077dfb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12777.267884492874, "timesteps_since_restore": 41424896, "iterations_since_restore": 418, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.390404749482144, "episode_reward_min": 53.97311176659652, "episode_reward_mean": 58.08302391157527, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 27.119079815277008, "agent_1": 30.963944096298277}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6510670267824303, "mean_processing_ms": 3.490912510469142, "mean_inference_ms": 2.0670522063431047}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2691, "num_steps_trained": 135051264, "num_steps_sampled": 91599104, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 81109, "num_samples_dropped": 309, "learner_queue": {"size_count": 249471, "size_mean": 0.18, "size_std": 0.43312815655415426, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.637, "replay_time_ms": 92.957, "update_priorities_time_ms": 52.964, "policy_agent_0": {"added_count": 10340096, "sampled_count": 15283456, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10340096, "sampled_count": 15283456, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.526422381401062, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3132273852825165, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 91599104, "episodes_total": 916024, "training_iteration": 930, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-37-39", "timestamp": 1569087459, "time_this_iter_s": 30.617570161819458, "time_total_s": 28424.849189281464, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12807.885454654694, "timesteps_since_restore": 41528320, "iterations_since_restore": 419, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.22471655790771, "episode_reward_min": 56.10291846201801, "episode_reward_mean": 58.54440707886589, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.21609023408675, "agent_1": 32.32831684477914}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509531920108973, "mean_processing_ms": 3.4913817667730376, "mean_inference_ms": 2.06712346850858}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2694, "num_steps_trained": 135195904, "num_steps_sampled": 91702528, "sample_throughput": 0.0, "train_throughput": 21972.289, "num_weight_syncs": 81311, "num_samples_dropped": 309, "learner_queue": {"size_count": 250036, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.827, "replay_time_ms": 106.184, "update_priorities_time_ms": 61.168, "policy_agent_0": {"added_count": 10364672, "sampled_count": 15319808, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10364672, "sampled_count": 15319808, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5346375703811646, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29432976245880127, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 91702528, "episodes_total": 917048, "training_iteration": 931, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-38-10", "timestamp": 1569087490, "time_this_iter_s": 30.573948621749878, "time_total_s": 28455.423137903214, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28e0d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12838.459403276443, "timesteps_since_restore": 41631744, "iterations_since_restore": 420, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.94173821552685, "episode_reward_min": 50.25922475056903, "episode_reward_mean": 58.26963816633932, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.184996506539168, "agent_1": 31.084641659800205}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509051473409242, "mean_processing_ms": 3.4909093680774625, "mean_inference_ms": 2.0669466874136773}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2697, "num_steps_trained": 135346688, "num_steps_sampled": 91802368, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 81506, "num_samples_dropped": 309, "learner_queue": {"size_count": 250625, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.24, "replay_time_ms": 95.44, "update_priorities_time_ms": 53.772, "policy_agent_0": {"added_count": 10391040, "sampled_count": 15356160, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10391040, "sampled_count": 15356160, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5380952954292297, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2797221541404724, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 91802368, "episodes_total": 918056, "training_iteration": 932, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-38-40", "timestamp": 1569087520, "time_this_iter_s": 30.461904764175415, "time_total_s": 28485.88504266739, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ca9d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12868.921308040619, "timesteps_since_restore": 41731584, "iterations_since_restore": 421, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.2229182963239, "episode_reward_min": 50.57114516996283, "episode_reward_mean": 57.493466395647765, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.809821396265512, "agent_1": 30.683644999382338}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.650931687806885, "mean_processing_ms": 3.4909900073211464, "mean_inference_ms": 2.0668070223056683}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2699, "num_steps_trained": 135495936, "num_steps_sampled": 91903232, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 81702, "num_samples_dropped": 309, "learner_queue": {"size_count": 251208, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.538, "replay_time_ms": 95.389, "update_priorities_time_ms": 53.64, "policy_agent_0": {"added_count": 10420992, "sampled_count": 15391744, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10420992, "sampled_count": 15391744, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5354867577552795, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.28360116481781006, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 91903232, "episodes_total": 919056, "training_iteration": 933, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-39-11", "timestamp": 1569087551, "time_this_iter_s": 30.600648164749146, "time_total_s": 28516.485690832138, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c33ac80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12899.521956205368, "timesteps_since_restore": 41832448, "iterations_since_restore": 422, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.96856267855945, "episode_reward_min": 51.00722732023352, "episode_reward_mean": 59.03743276659973, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.934081202227397, "agent_1": 31.103351564372463}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6508584848217186, "mean_processing_ms": 3.490682461920214, "mean_inference_ms": 2.066798304959946}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2703, "num_steps_trained": 135649024, "num_steps_sampled": 92002048, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 81897, "num_samples_dropped": 309, "learner_queue": {"size_count": 251806, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.404, "replay_time_ms": 91.493, "update_priorities_time_ms": 47.568, "policy_agent_0": {"added_count": 10445312, "sampled_count": 15428096, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10445312, "sampled_count": 15428096, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5114439725875854, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2933669984340668, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 92002048, "episodes_total": 920048, "training_iteration": 934, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-39-42", "timestamp": 1569087582, "time_this_iter_s": 30.578864812850952, "time_total_s": 28547.06455564499, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4297b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12930.100821018219, "timesteps_since_restore": 41931264, "iterations_since_restore": 423, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.470962256948276, "episode_reward_min": 50.242237052612445, "episode_reward_mean": 58.72350512372904, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 29.097964474679504, "agent_1": 29.62554064904964}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6510532827032727, "mean_processing_ms": 3.490512825445348, "mean_inference_ms": 2.066740560545697}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2706, "num_steps_trained": 135803136, "num_steps_sampled": 92101632, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 82090, "num_samples_dropped": 309, "learner_queue": {"size_count": 252408, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.875, "replay_time_ms": 118.951, "update_priorities_time_ms": 51.34, "policy_agent_0": {"added_count": 10468352, "sampled_count": 15466496, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10468352, "sampled_count": 15466496, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4906091094017029, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3004285991191864, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 92101632, "episodes_total": 921040, "training_iteration": 935, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-40-12", "timestamp": 1569087612, "time_this_iter_s": 30.488067626953125, "time_total_s": 28577.552623271942, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f26a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12960.588888645172, "timesteps_since_restore": 42030848, "iterations_since_restore": 424, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.72583871598496, "episode_reward_min": 52.23821174772026, "episode_reward_mean": 59.00321607122187, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 30.035979697430566, "agent_1": 28.967236373791383}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6511422280945764, "mean_processing_ms": 3.491232046426393, "mean_inference_ms": 2.0670119779784137}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2709, "num_steps_trained": 135960064, "num_steps_sampled": 92199168, "sample_throughput": 0.0, "train_throughput": 7903.122, "num_weight_syncs": 82281, "num_samples_dropped": 309, "learner_queue": {"size_count": 253021, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.87, "replay_time_ms": 92.128, "update_priorities_time_ms": 50.759, "policy_agent_0": {"added_count": 10493952, "sampled_count": 15506688, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10493952, "sampled_count": 15506688, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4383140504360199, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30565786361694336, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 92199168, "episodes_total": 922008, "training_iteration": 936, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-40-43", "timestamp": 1569087643, "time_this_iter_s": 30.61579942703247, "time_total_s": 28608.168422698975, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 12991.204688072205, "timesteps_since_restore": 42128384, "iterations_since_restore": 425, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.35698616007439, "episode_reward_min": 56.9404341950785, "episode_reward_mean": 59.026401914659495, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 27.32006105934086, "agent_1": 31.70634085531872}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6511690942977038, "mean_processing_ms": 3.491268848058935, "mean_inference_ms": 2.0670744270898247}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2712, "num_steps_trained": 136115456, "num_steps_sampled": 92296448, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 82471, "num_samples_dropped": 309, "learner_queue": {"size_count": 253629, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.467, "replay_time_ms": 96.313, "update_priorities_time_ms": 48.565, "policy_agent_0": {"added_count": 10514688, "sampled_count": 15546112, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10514688, "sampled_count": 15546112, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4132334589958191, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3097672462463379, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 92296448, "episodes_total": 922984, "training_iteration": 937, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-41-13", "timestamp": 1569087673, "time_this_iter_s": 30.620404481887817, "time_total_s": 28638.788827180862, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4de048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13021.825092554092, "timesteps_since_restore": 42225664, "iterations_since_restore": 426, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.359109263751485, "episode_reward_min": 49.5734180852763, "episode_reward_mean": 57.53268748752653, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.03375043050735, "agent_1": 31.49893705701933}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6511231304144428, "mean_processing_ms": 3.4912215507523907, "mean_inference_ms": 2.067128387057274}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2715, "num_steps_trained": 136266496, "num_steps_sampled": 92395520, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 82664, "num_samples_dropped": 309, "learner_queue": {"size_count": 254218, "size_mean": 0.16, "size_std": 0.41761226035642207, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.046, "replay_time_ms": 68.728, "update_priorities_time_ms": 43.096, "policy_agent_0": {"added_count": 10536704, "sampled_count": 15585280, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10536704, "sampled_count": 15585280, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41802987456321716, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30631357431411743, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 92395520, "episodes_total": 923984, "training_iteration": 938, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-41-44", "timestamp": 1569087704, "time_this_iter_s": 30.436866283416748, "time_total_s": 28669.22569346428, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13052.26195883751, "timesteps_since_restore": 42324736, "iterations_since_restore": 427, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.37836643364166, "episode_reward_min": 54.34119394002908, "episode_reward_mean": 57.64116068122444, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.944907664368596, "agent_1": 31.696253016855966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6510949535737137, "mean_processing_ms": 3.4910867948872153, "mean_inference_ms": 2.0670190535033486}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2718, "num_steps_trained": 136418304, "num_steps_sampled": 92495104, "sample_throughput": 0.0, "train_throughput": 32769.0, "num_weight_syncs": 82859, "num_samples_dropped": 309, "learner_queue": {"size_count": 254811, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.113, "replay_time_ms": 128.377, "update_priorities_time_ms": 63.519, "policy_agent_0": {"added_count": 10559488, "sampled_count": 15624192, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10559488, "sampled_count": 15624192, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4518638253211975, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.290205180644989, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 92495104, "episodes_total": 924968, "training_iteration": 939, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-42-15", "timestamp": 1569087735, "time_this_iter_s": 30.6223247051239, "time_total_s": 28699.848018169403, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13082.884283542633, "timesteps_since_restore": 42424320, "iterations_since_restore": 428, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.887346143139474, "episode_reward_min": 56.72110709756226, "episode_reward_mean": 57.65697856252459, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.037442706056147, "agent_1": 31.61953585646859}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6511354059984051, "mean_processing_ms": 3.4904633893950114, "mean_inference_ms": 2.066895727880172}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2721, "num_steps_trained": 136566016, "num_steps_sampled": 92595968, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 83056, "num_samples_dropped": 309, "learner_queue": {"size_count": 255390, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.435, "replay_time_ms": 84.285, "update_priorities_time_ms": 40.153, "policy_agent_0": {"added_count": 10585600, "sampled_count": 15658752, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10585600, "sampled_count": 15658752, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.460384726524353, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30776071548461914, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 92595968, "episodes_total": 925992, "training_iteration": 940, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-42-45", "timestamp": 1569087765, "time_this_iter_s": 30.434076070785522, "time_total_s": 28730.28209424019, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13113.318359613419, "timesteps_since_restore": 42525184, "iterations_since_restore": 429, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.33970271985529, "episode_reward_min": 57.0552067335903, "episode_reward_mean": 57.8896450430013, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.247320603961768, "agent_1": 31.642324439039665}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509626092944734, "mean_processing_ms": 3.490949790684454, "mean_inference_ms": 2.0671737967235506}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2724, "num_steps_trained": 136714240, "num_steps_sampled": 92696064, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 83252, "num_samples_dropped": 309, "learner_queue": {"size_count": 255968, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 28.267, "replay_time_ms": 94.348, "update_priorities_time_ms": 52.616, "policy_agent_0": {"added_count": 10610176, "sampled_count": 15695104, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10610176, "sampled_count": 15695104, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44920703768730164, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2926003038883209, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 92696064, "episodes_total": 926984, "training_iteration": 941, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-43-16", "timestamp": 1569087796, "time_this_iter_s": 30.652207612991333, "time_total_s": 28760.93430185318, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3326a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13143.97056722641, "timesteps_since_restore": 42625280, "iterations_since_restore": 430, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.34916899332764, "episode_reward_min": 56.31723569874762, "episode_reward_mean": 57.787081753588204, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.315207161465107, "agent_1": 31.471874592123207}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6507477151233271, "mean_processing_ms": 3.4905256372072233, "mean_inference_ms": 2.066863944926371}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2727, "num_steps_trained": 136867072, "num_steps_sampled": 92794880, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 83445, "num_samples_dropped": 309, "learner_queue": {"size_count": 256564, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.283, "replay_time_ms": 88.868, "update_priorities_time_ms": 49.152, "policy_agent_0": {"added_count": 10632448, "sampled_count": 15732992, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10632448, "sampled_count": 15732992, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4719044268131256, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.28856948018074036, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 92794880, "episodes_total": 927976, "training_iteration": 942, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-43-46", "timestamp": 1569087826, "time_this_iter_s": 30.534942865371704, "time_total_s": 28791.46924471855, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077d3048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13174.505510091782, "timesteps_since_restore": 42724096, "iterations_since_restore": 431, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.33069820425155, "episode_reward_min": 52.414345473070874, "episode_reward_mean": 57.94308254209763, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.223005816650645, "agent_1": 31.720076725446905}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509726486103257, "mean_processing_ms": 3.490362288456773, "mean_inference_ms": 2.0667326424659445}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2730, "num_steps_trained": 137011456, "num_steps_sampled": 92898304, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 83646, "num_samples_dropped": 309, "learner_queue": {"size_count": 257128, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.17, "replay_time_ms": 104.11, "update_priorities_time_ms": 53.42, "policy_agent_0": {"added_count": 10659584, "sampled_count": 15768320, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10659584, "sampled_count": 15768320, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44759705662727356, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31241077184677124, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 92898304, "episodes_total": 929008, "training_iteration": 943, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-44-17", "timestamp": 1569087857, "time_this_iter_s": 30.59899592399597, "time_total_s": 28822.068240642548, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ecb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13205.104506015778, "timesteps_since_restore": 42827520, "iterations_since_restore": 432, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.08431745328798, "episode_reward_min": 44.94366463706634, "episode_reward_mean": 56.78187536508959, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.82749679413485, "agent_1": 30.954378570954738}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6509999286484159, "mean_processing_ms": 3.4902725761655105, "mean_inference_ms": 2.066757951458587}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2733, "num_steps_trained": 137160448, "num_steps_sampled": 92998912, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 83843, "num_samples_dropped": 309, "learner_queue": {"size_count": 257711, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.721, "replay_time_ms": 95.992, "update_priorities_time_ms": 63.992, "policy_agent_0": {"added_count": 10683392, "sampled_count": 15806976, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10683392, "sampled_count": 15806976, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45466265082359314, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30857202410697937, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 92998912, "episodes_total": 930016, "training_iteration": 944, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-44-47", "timestamp": 1569087887, "time_this_iter_s": 30.54608702659607, "time_total_s": 28852.614327669144, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c0376a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13235.650593042374, "timesteps_since_restore": 42928128, "iterations_since_restore": 433, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.85250823834681, "episode_reward_min": 46.18737848649271, "episode_reward_mean": 57.15854860054979, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.106840320989686, "agent_1": 31.051708279560014}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6508766082151306, "mean_processing_ms": 3.4902154339768763, "mean_inference_ms": 2.066572204039028}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2736, "num_steps_trained": 137303296, "num_steps_sampled": 93102848, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 84046, "num_samples_dropped": 309, "learner_queue": {"size_count": 258268, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 46.666, "replay_time_ms": 114.176, "update_priorities_time_ms": 67.904, "policy_agent_0": {"added_count": 10705408, "sampled_count": 15841024, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10705408, "sampled_count": 15841024, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4716348946094513, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31544163823127747, "model": {}}}}, "timesteps_this_iter": 103936, "done": false, "timesteps_total": 93102848, "episodes_total": 931048, "training_iteration": 945, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-45-18", "timestamp": 1569087918, "time_this_iter_s": 30.599063396453857, "time_total_s": 28883.213391065598, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0777f9d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13266.249656438828, "timesteps_since_restore": 43032064, "iterations_since_restore": 434, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.84433551908028, "episode_reward_min": 45.73411733371258, "episode_reward_mean": 57.197402145377026, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.2629893830788, "agent_1": 30.934412762298162}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6508893414585637, "mean_processing_ms": 3.4897923552974754, "mean_inference_ms": 2.0662201072105106}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2738, "num_steps_trained": 137453312, "num_steps_sampled": 93203712, "sample_throughput": 7662.251, "train_throughput": 0.0, "num_weight_syncs": 84244, "num_samples_dropped": 309, "learner_queue": {"size_count": 258854, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 47.136, "replay_time_ms": 103.926, "update_priorities_time_ms": 60.205, "policy_agent_0": {"added_count": 10728960, "sampled_count": 15877120, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10728960, "sampled_count": 15877120, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4680008292198181, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29614701867103577, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 93203712, "episodes_total": 932056, "training_iteration": 946, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-45-49", "timestamp": 1569087949, "time_this_iter_s": 30.58936882019043, "time_total_s": 28913.802759885788, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077bf048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13296.839025259018, "timesteps_since_restore": 43132928, "iterations_since_restore": 435, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.878592273321246, "episode_reward_min": 56.86049074626197, "episode_reward_mean": 57.467483711646906, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.32819203768686, "agent_1": 31.139291673959967}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6508654416955691, "mean_processing_ms": 3.4893183758225046, "mean_inference_ms": 2.0659708092916444}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2741, "num_steps_trained": 137600768, "num_steps_sampled": 93306112, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 84443, "num_samples_dropped": 309, "learner_queue": {"size_count": 259430, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.282, "replay_time_ms": 81.627, "update_priorities_time_ms": 49.487, "policy_agent_0": {"added_count": 10753536, "sampled_count": 15915264, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10753536, "sampled_count": 15915264, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46461641788482666, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3200339078903198, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 93306112, "episodes_total": 933080, "training_iteration": 947, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-46-19", "timestamp": 1569087979, "time_this_iter_s": 30.45660376548767, "time_total_s": 28944.259363651276, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07722bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13327.295629024506, "timesteps_since_restore": 43235328, "iterations_since_restore": 436, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.35803837208769, "episode_reward_min": 56.85397323316937, "episode_reward_mean": 59.33601287937681, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.19224763755678, "agent_1": 31.143765241820013}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6507066011401955, "mean_processing_ms": 3.489063300883128, "mean_inference_ms": 2.065882031672471}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2744, "num_steps_trained": 137748736, "num_steps_sampled": 93406464, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 84639, "num_samples_dropped": 309, "learner_queue": {"size_count": 260009, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.291, "replay_time_ms": 93.732, "update_priorities_time_ms": 49.899, "policy_agent_0": {"added_count": 10778112, "sampled_count": 15951616, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10778112, "sampled_count": 15951616, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4619600474834442, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3178752362728119, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 93406464, "episodes_total": 934088, "training_iteration": 948, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-46-50", "timestamp": 1569088010, "time_this_iter_s": 30.52126979827881, "time_total_s": 28974.780633449554, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076e6b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13357.816898822784, "timesteps_since_restore": 43335680, "iterations_since_restore": 437, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.36807409221257, "episode_reward_min": 57.79607533241436, "episode_reward_mean": 60.92534883660841, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 29.61044192592908, "agent_1": 31.314906910679326}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6506398362191708, "mean_processing_ms": 3.489537745118519, "mean_inference_ms": 2.0660609165728925}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2747, "num_steps_trained": 137897216, "num_steps_sampled": 93507072, "sample_throughput": 0.0, "train_throughput": 33909.421, "num_weight_syncs": 84835, "num_samples_dropped": 309, "learner_queue": {"size_count": 260588, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.951, "replay_time_ms": 95.121, "update_priorities_time_ms": 57.643, "policy_agent_0": {"added_count": 10802688, "sampled_count": 15986944, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10802688, "sampled_count": 15986944, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4446563720703125, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30864688754081726, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 93507072, "episodes_total": 935096, "training_iteration": 949, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-47-20", "timestamp": 1569088040, "time_this_iter_s": 30.553765773773193, "time_total_s": 29005.334399223328, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076f30d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13388.370664596558, "timesteps_since_restore": 43436288, "iterations_since_restore": 438, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.37786687269472, "episode_reward_min": 57.81207932601739, "episode_reward_mean": 60.56467875793479, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 29.148646196867865, "agent_1": 31.41603256106696}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6507006298706873, "mean_processing_ms": 3.4893662347851206, "mean_inference_ms": 2.0661305555365557}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2750, "num_steps_trained": 138049536, "num_steps_sampled": 93607936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 85033, "num_samples_dropped": 309, "learner_queue": {"size_count": 261183, "size_mean": 0.24, "size_std": 0.5851495535331117, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 37.132, "replay_time_ms": 95.995, "update_priorities_time_ms": 46.107, "policy_agent_0": {"added_count": 10827520, "sampled_count": 16024064, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10827520, "sampled_count": 16024064, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40093740820884705, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.311877578496933, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 93607936, "episodes_total": 936112, "training_iteration": 950, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-47-51", "timestamp": 1569088071, "time_this_iter_s": 30.571553230285645, "time_total_s": 29035.905952453613, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076f3c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13418.942217826843, "timesteps_since_restore": 43537152, "iterations_since_restore": 439, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.35817350893138, "episode_reward_min": 47.72121522566337, "episode_reward_mean": 58.432465088604424, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.798052588977, "agent_1": 31.634412499627363}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.650618897910442, "mean_processing_ms": 3.4893188129285626, "mean_inference_ms": 2.066090911718974}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2753, "num_steps_trained": 138198784, "num_steps_sampled": 93708800, "sample_throughput": 9972.526, "train_throughput": 0.0, "num_weight_syncs": 85229, "num_samples_dropped": 309, "learner_queue": {"size_count": 261766, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.864, "replay_time_ms": 100.69, "update_priorities_time_ms": 48.086, "policy_agent_0": {"added_count": 10852096, "sampled_count": 16062208, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10852096, "sampled_count": 16062208, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39680036902427673, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29012903571128845, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 93708800, "episodes_total": 937112, "training_iteration": 951, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-48-22", "timestamp": 1569088102, "time_this_iter_s": 30.56330680847168, "time_total_s": 29066.469259262085, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076851e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13449.505524635315, "timesteps_since_restore": 43638016, "iterations_since_restore": 440, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.356522329067744, "episode_reward_min": 55.75148209286252, "episode_reward_mean": 58.88625683064737, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.27220888462745, "agent_1": 30.614047946019912}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6506824194175881, "mean_processing_ms": 3.4888691365921414, "mean_inference_ms": 2.065909962201002}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2756, "num_steps_trained": 138348544, "num_steps_sampled": 93809408, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 85427, "num_samples_dropped": 309, "learner_queue": {"size_count": 262351, "size_mean": 0.06, "size_std": 0.31048349392520047, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.155, "replay_time_ms": 114.154, "update_priorities_time_ms": 54.73, "policy_agent_0": {"added_count": 10877952, "sampled_count": 16100864, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10877952, "sampled_count": 16100864, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39950329065322876, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29788246750831604, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 93809408, "episodes_total": 938120, "training_iteration": 952, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-48-52", "timestamp": 1569088132, "time_this_iter_s": 30.59706735610962, "time_total_s": 29097.066326618195, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0770fd90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13480.102591991425, "timesteps_since_restore": 43738624, "iterations_since_restore": 441, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.3410856991696, "episode_reward_min": 45.934082913422756, "episode_reward_mean": 57.091372785409796, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.105217589194496, "agent_1": 29.986155196215332}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6505948058711448, "mean_processing_ms": 3.4887382960102418, "mean_inference_ms": 2.0659968851618777}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2759, "num_steps_trained": 138495744, "num_steps_sampled": 93910784, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 85624, "num_samples_dropped": 309, "learner_queue": {"size_count": 262927, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "replay_shard_0": {"add_batch_time_ms": 29.515, "replay_time_ms": 104.317, "update_priorities_time_ms": 52.706, "policy_agent_0": {"added_count": 10904576, "sampled_count": 16135936, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10904576, "sampled_count": 16135936, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4319155514240265, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3024960160255432, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 93910784, "episodes_total": 939128, "training_iteration": 953, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-49-23", "timestamp": 1569088163, "time_this_iter_s": 30.53433871269226, "time_total_s": 29127.600665330887, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077657b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13510.636930704117, "timesteps_since_restore": 43840000, "iterations_since_restore": 442, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.35817350893138, "episode_reward_min": 55.14343282200704, "episode_reward_mean": 60.67569243272221, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.879043851344097, "agent_1": 29.796648581378108}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6506840466396673, "mean_processing_ms": 3.4890440259175697, "mean_inference_ms": 2.0660581778105063}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2762, "num_steps_trained": 138647552, "num_steps_sampled": 94011392, "sample_throughput": 5603.934, "train_throughput": 11207.869, "num_weight_syncs": 85821, "num_samples_dropped": 309, "learner_queue": {"size_count": 263519, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.428, "replay_time_ms": 108.683, "update_priorities_time_ms": 62.344, "policy_agent_0": {"added_count": 10928896, "sampled_count": 16172288, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10928896, "sampled_count": 16172288, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.394980788230896, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3202078640460968, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 94011392, "episodes_total": 940136, "training_iteration": 954, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-49-53", "timestamp": 1569088193, "time_this_iter_s": 30.484591722488403, "time_total_s": 29158.085257053375, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c0379d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13541.121522426605, "timesteps_since_restore": 43940608, "iterations_since_restore": 443, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 62.36737365499245, "episode_reward_min": 52.60039117273807, "episode_reward_mean": 59.41891193236565, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 30.508576012047108, "agent_1": 28.91033592031857}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6507636539734483, "mean_processing_ms": 3.4885091462378592, "mean_inference_ms": 2.065776038949968}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2765, "num_steps_trained": 138799872, "num_steps_sampled": 94110720, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 86015, "num_samples_dropped": 309, "learner_queue": {"size_count": 264115, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.89, "replay_time_ms": 121.33, "update_priorities_time_ms": 57.533, "policy_agent_0": {"added_count": 10952960, "sampled_count": 16211456, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10952960, "sampled_count": 16211456, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3637211322784424, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34413251280784607, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 94110720, "episodes_total": 941136, "training_iteration": 955, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-50-24", "timestamp": 1569088224, "time_this_iter_s": 30.560494422912598, "time_total_s": 29188.645751476288, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3c4ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13571.682016849518, "timesteps_since_restore": 44039936, "iterations_since_restore": 444, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.301489734361546, "episode_reward_min": 46.412694077352135, "episode_reward_mean": 57.11351060099464, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 28.691230078001066, "agent_1": 28.42228052299364}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6506268372540612, "mean_processing_ms": 3.488934491589052, "mean_inference_ms": 2.0658574439163773}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2768, "num_steps_trained": 138947584, "num_steps_sampled": 94212096, "sample_throughput": 13009.06, "train_throughput": 0.0, "num_weight_syncs": 86213, "num_samples_dropped": 309, "learner_queue": {"size_count": 264691, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.771, "replay_time_ms": 101.007, "update_priorities_time_ms": 51.84, "policy_agent_0": {"added_count": 10980608, "sampled_count": 16246528, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 10980608, "sampled_count": 16246528, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3607470393180847, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3478364050388336, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 94212096, "episodes_total": 942152, "training_iteration": 956, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-50-54", "timestamp": 1569088254, "time_this_iter_s": 30.5649311542511, "time_total_s": 29219.21068263054, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077d32f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13602.246948003769, "timesteps_since_restore": 44141312, "iterations_since_restore": 445, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 61.29549645063068, "episode_reward_min": 54.915283043637054, "episode_reward_mean": 57.468428286750196, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 30.354090758010425, "agent_1": 27.114337528739824}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.650658407206864, "mean_processing_ms": 3.4888167498170732, "mean_inference_ms": 2.065739568962611}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2771, "num_steps_trained": 139096832, "num_steps_sampled": 94313728, "sample_throughput": 4652.039, "train_throughput": 0.0, "num_weight_syncs": 86411, "num_samples_dropped": 309, "learner_queue": {"size_count": 265274, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.029, "replay_time_ms": 100.283, "update_priorities_time_ms": 52.276, "policy_agent_0": {"added_count": 11006464, "sampled_count": 16284160, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11006464, "sampled_count": 16284160, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3419470489025116, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37125417590141296, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 94313728, "episodes_total": 943168, "training_iteration": 957, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-51-25", "timestamp": 1569088285, "time_this_iter_s": 30.5317120552063, "time_total_s": 29249.742394685745, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2dcd90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13632.778660058975, "timesteps_since_restore": 44242944, "iterations_since_restore": 446, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.34934455785369, "episode_reward_min": 55.010779097867584, "episode_reward_mean": 57.62522444999296, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 31.30598886669563, "agent_1": 26.319235583297214}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6506807839684294, "mean_processing_ms": 3.48890804462071, "mean_inference_ms": 2.065914268570377}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2774, "num_steps_trained": 139250432, "num_steps_sampled": 94411520, "sample_throughput": 25115.593, "train_throughput": 0.0, "num_weight_syncs": 86601, "num_samples_dropped": 309, "learner_queue": {"size_count": 265874, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 28.62, "replay_time_ms": 88.84, "update_priorities_time_ms": 50.418, "policy_agent_0": {"added_count": 11030272, "sampled_count": 16323584, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11030272, "sampled_count": 16323584, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3404919505119324, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40618449449539185, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 94411520, "episodes_total": 944144, "training_iteration": 958, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-51-56", "timestamp": 1569088316, "time_this_iter_s": 30.57356595993042, "time_total_s": 29280.315960645676, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13663.352226018906, "timesteps_since_restore": 44340736, "iterations_since_restore": 447, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.37074409363263, "episode_reward_min": 57.297879004643235, "episode_reward_mean": 57.911095535713756, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 31.29812838785104, "agent_1": 26.6129671478626}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6507559506871187, "mean_processing_ms": 3.488889425950479, "mean_inference_ms": 2.065905460793654}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2777, "num_steps_trained": 139400704, "num_steps_sampled": 94511872, "sample_throughput": 8177.339, "train_throughput": 8177.339, "num_weight_syncs": 86798, "num_samples_dropped": 309, "learner_queue": {"size_count": 266461, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.919, "replay_time_ms": 102.281, "update_priorities_time_ms": 48.798, "policy_agent_0": {"added_count": 11052032, "sampled_count": 16361728, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11052032, "sampled_count": 16361728, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3184744715690613, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41842401027679443, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 94511872, "episodes_total": 945136, "training_iteration": 959, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-52-26", "timestamp": 1569088346, "time_this_iter_s": 30.491974592208862, "time_total_s": 29310.807935237885, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13693.844200611115, "timesteps_since_restore": 44441088, "iterations_since_restore": 448, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.798554927273344, "episode_reward_min": 55.643444730756656, "episode_reward_mean": 57.64169099553949, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 30.828334580296364, "agent_1": 26.81335641524307}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.650678653879068, "mean_processing_ms": 3.4884705680624135, "mean_inference_ms": 2.0658404954356007}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2780, "num_steps_trained": 139554304, "num_steps_sampled": 94609920, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 86990, "num_samples_dropped": 309, "learner_queue": {"size_count": 267061, "size_mean": 0.36, "size_std": 0.6248199740725323, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 36.84, "replay_time_ms": 105.355, "update_priorities_time_ms": 48.68, "policy_agent_0": {"added_count": 11076096, "sampled_count": 16402944, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11076096, "sampled_count": 16402944, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30758169293403625, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43903541564941406, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 94609920, "episodes_total": 946120, "training_iteration": 960, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-52-57", "timestamp": 1569088377, "time_this_iter_s": 30.502548933029175, "time_total_s": 29341.310484170914, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4de378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13724.346749544144, "timesteps_since_restore": 44539136, "iterations_since_restore": 449, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.449772907908574, "episode_reward_min": 51.12987426740182, "episode_reward_mean": 56.40959603737168, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 29.31970718286813, "agent_1": 27.08988885450356}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.650636590234048, "mean_processing_ms": 3.488994214501864, "mean_inference_ms": 2.0660925053296957}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2783, "num_steps_trained": 139704576, "num_steps_sampled": 94708992, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 87182, "num_samples_dropped": 309, "learner_queue": {"size_count": 267649, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.161, "replay_time_ms": 103.183, "update_priorities_time_ms": 48.688, "policy_agent_0": {"added_count": 11102976, "sampled_count": 16439808, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11102976, "sampled_count": 16439808, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30201590061187744, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43018582463264465, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 94708992, "episodes_total": 947120, "training_iteration": 961, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-53-27", "timestamp": 1569088407, "time_this_iter_s": 30.509408712387085, "time_total_s": 29371.8198928833, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea8c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13754.85615825653, "timesteps_since_restore": 44638208, "iterations_since_restore": 450, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.82238656101918, "episode_reward_min": 50.691854919948085, "episode_reward_mean": 53.65138147280311, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.244739194409565, "agent_1": 23.40664227839352}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6506686494869806, "mean_processing_ms": 3.488458227637918, "mean_inference_ms": 2.0659831524451437}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2786, "num_steps_trained": 139853568, "num_steps_sampled": 94811392, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 87384, "num_samples_dropped": 309, "learner_queue": {"size_count": 268230, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.698, "replay_time_ms": 99.575, "update_priorities_time_ms": 49.285, "policy_agent_0": {"added_count": 11129344, "sampled_count": 16474624, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11129344, "sampled_count": 16474624, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3152316212654114, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49306654930114746, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 94811392, "episodes_total": 948128, "training_iteration": 962, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-53-58", "timestamp": 1569088438, "time_this_iter_s": 30.495497226715088, "time_total_s": 29402.315390110016, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f2bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13785.351655483246, "timesteps_since_restore": 44740608, "iterations_since_restore": 451, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.917237448142046, "episode_reward_min": 49.54371334553934, "episode_reward_mean": 55.23140951204264, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 29.77773053999741, "agent_1": 25.45367897204523}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6506643265844982, "mean_processing_ms": 3.48897253068976, "mean_inference_ms": 2.0661168447919054}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2789, "num_steps_trained": 140004096, "num_steps_sampled": 94910464, "sample_throughput": 7121.107, "train_throughput": 0.0, "num_weight_syncs": 87577, "num_samples_dropped": 309, "learner_queue": {"size_count": 268818, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.287, "replay_time_ms": 106.582, "update_priorities_time_ms": 51.444, "policy_agent_0": {"added_count": 11153408, "sampled_count": 16514048, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11153408, "sampled_count": 16514048, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30925342440605164, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5208410620689392, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 94910464, "episodes_total": 949128, "training_iteration": 963, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-54-28", "timestamp": 1569088468, "time_this_iter_s": 30.58489441871643, "time_total_s": 29432.900284528732, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c37b1e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13815.936549901962, "timesteps_since_restore": 44839680, "iterations_since_restore": 452, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.78061459330506, "episode_reward_min": 49.70029465705424, "episode_reward_mean": 55.74992765061774, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 29.83049872484227, "agent_1": 25.919428925775613}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6506525328969252, "mean_processing_ms": 3.4882896459567982, "mean_inference_ms": 2.06580491017651}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2792, "num_steps_trained": 140152320, "num_steps_sampled": 95012864, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 87777, "num_samples_dropped": 309, "learner_queue": {"size_count": 269397, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.573, "replay_time_ms": 93.128, "update_priorities_time_ms": 46.31, "policy_agent_0": {"added_count": 11177472, "sampled_count": 16552192, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11177472, "sampled_count": 16552192, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3231358826160431, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5668331980705261, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 95012864, "episodes_total": 950152, "training_iteration": 964, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-54-59", "timestamp": 1569088499, "time_this_iter_s": 30.54990530014038, "time_total_s": 29463.450189828873, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ce840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13846.486455202103, "timesteps_since_restore": 44942080, "iterations_since_restore": 453, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.872931122678054, "episode_reward_min": 45.64985619955983, "episode_reward_mean": 53.79687755242138, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 28.081474237756964, "agent_1": 25.715403314664457}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6505126365702651, "mean_processing_ms": 3.4882117437615467, "mean_inference_ms": 2.065631663936859}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2795, "num_steps_trained": 140302848, "num_steps_sampled": 95114240, "sample_throughput": 7016.025, "train_throughput": 2338.675, "num_weight_syncs": 87975, "num_samples_dropped": 309, "learner_queue": {"size_count": 269985, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.407, "replay_time_ms": 97.323, "update_priorities_time_ms": 43.918, "policy_agent_0": {"added_count": 11203072, "sampled_count": 16589056, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11203072, "sampled_count": 16589056, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34537070989608765, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5322298407554626, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 95114240, "episodes_total": 951176, "training_iteration": 965, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-55-30", "timestamp": 1569088530, "time_this_iter_s": 30.55757164955139, "time_total_s": 29494.007761478424, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c306e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13877.044026851654, "timesteps_since_restore": 45043456, "iterations_since_restore": 454, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.86723775694671, "episode_reward_min": 48.67157937592855, "episode_reward_mean": 57.108566025418426, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.522099576428424, "agent_1": 26.586466448990052}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6504419452515315, "mean_processing_ms": 3.4880633261341165, "mean_inference_ms": 2.065711501226869}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2798, "num_steps_trained": 140452096, "num_steps_sampled": 95215616, "sample_throughput": 8110.323, "train_throughput": 0.0, "num_weight_syncs": 88173, "num_samples_dropped": 309, "learner_queue": {"size_count": 270569, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.162, "replay_time_ms": 85.715, "update_priorities_time_ms": 52.837, "policy_agent_0": {"added_count": 11228160, "sampled_count": 16626432, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11228160, "sampled_count": 16626432, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35998719930648804, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5146148204803467, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 95215616, "episodes_total": 952184, "training_iteration": 966, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-56-00", "timestamp": 1569088560, "time_this_iter_s": 30.58645796775818, "time_total_s": 29524.594219446182, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28e1e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13907.630484819412, "timesteps_since_restore": 45144832, "iterations_since_restore": 455, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.063238679242154, "episode_reward_min": 55.93539768343799, "episode_reward_mean": 56.811525031076876, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 29.92566236854801, "agent_1": 26.885862662529078}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6504347821401799, "mean_processing_ms": 3.4874877572521936, "mean_inference_ms": 2.0654254216734556}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2801, "num_steps_trained": 140603904, "num_steps_sampled": 95316224, "sample_throughput": 6462.018, "train_throughput": 0.0, "num_weight_syncs": 88369, "num_samples_dropped": 309, "learner_queue": {"size_count": 271162, "size_mean": 0.14, "size_std": 0.34698703145794935, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.083, "replay_time_ms": 86.594, "update_priorities_time_ms": 45.312, "policy_agent_0": {"added_count": 11255552, "sampled_count": 16661760, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11255552, "sampled_count": 16661760, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3585363030433655, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.491119384765625, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 95316224, "episodes_total": 953184, "training_iteration": 967, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-56-31", "timestamp": 1569088591, "time_this_iter_s": 30.55836033821106, "time_total_s": 29555.152579784393, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13938.188845157623, "timesteps_since_restore": 45245440, "iterations_since_restore": 456, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.91423663503251, "episode_reward_min": 54.08313989513261, "episode_reward_mean": 56.8754808957994, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 31.225496733567272, "agent_1": 25.649984162232208}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.650337640022452, "mean_processing_ms": 3.4875819097161265, "mean_inference_ms": 2.0653612933500454}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2804, "num_steps_trained": 140753408, "num_steps_sampled": 95417344, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 88566, "num_samples_dropped": 309, "learner_queue": {"size_count": 271745, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.789, "replay_time_ms": 93.833, "update_priorities_time_ms": 47.014, "policy_agent_0": {"added_count": 11281920, "sampled_count": 16696832, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11281920, "sampled_count": 16696832, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3417276442050934, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47647207975387573, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 95417344, "episodes_total": 954192, "training_iteration": 968, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-57-01", "timestamp": 1569088621, "time_this_iter_s": 30.606910228729248, "time_total_s": 29585.759490013123, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077dfbf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13968.795755386353, "timesteps_since_restore": 45346560, "iterations_since_restore": 457, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.35309220448102, "episode_reward_min": 50.235959119477684, "episode_reward_mean": 54.767038932113515, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 32.358808047182194, "agent_1": 22.40823088493136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6504162726163346, "mean_processing_ms": 3.487777525026887, "mean_inference_ms": 2.065400217102756}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2807, "num_steps_trained": 140904192, "num_steps_sampled": 95518464, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 88764, "num_samples_dropped": 309, "learner_queue": {"size_count": 272335, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.268, "replay_time_ms": 78.667, "update_priorities_time_ms": 46.705, "policy_agent_0": {"added_count": 11306496, "sampled_count": 16734208, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11306496, "sampled_count": 16734208, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3035087585449219, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5477378368377686, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 95518464, "episodes_total": 955208, "training_iteration": 969, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-57-32", "timestamp": 1569088652, "time_this_iter_s": 30.458213806152344, "time_total_s": 29616.217703819275, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077b0620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 13999.253969192505, "timesteps_since_restore": 45447680, "iterations_since_restore": 458, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.712264548586305, "episode_reward_min": 47.79223513193524, "episode_reward_mean": 53.172445596271366, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 29.78993499232737, "agent_1": 23.382510603944}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501987994967432, "mean_processing_ms": 3.4878191672217485, "mean_inference_ms": 2.065327950366526}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2810, "num_steps_trained": 141055488, "num_steps_sampled": 95617024, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 88956, "num_samples_dropped": 309, "learner_queue": {"size_count": 272925, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.237, "replay_time_ms": 98.368, "update_priorities_time_ms": 45.065, "policy_agent_0": {"added_count": 11329280, "sampled_count": 16771840, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11329280, "sampled_count": 16771840, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2874000370502472, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6338785886764526, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 95617024, "episodes_total": 956200, "training_iteration": 970, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-58-02", "timestamp": 1569088682, "time_this_iter_s": 30.41893744468689, "time_total_s": 29646.63664126396, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0776f488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14029.672906637192, "timesteps_since_restore": 45546240, "iterations_since_restore": 459, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.86733500405641, "episode_reward_min": 45.639567468407456, "episode_reward_mean": 51.40027784505267, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.96581315642608, "agent_1": 23.434464688626537}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6503966029837017, "mean_processing_ms": 3.4878935265955007, "mean_inference_ms": 2.065522452034287}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2813, "num_steps_trained": 141207808, "num_steps_sampled": 95716352, "sample_throughput": 14248.166, "train_throughput": 28496.333, "num_weight_syncs": 89151, "num_samples_dropped": 309, "learner_queue": {"size_count": 273520, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.933, "replay_time_ms": 94.04, "update_priorities_time_ms": 51.475, "policy_agent_0": {"added_count": 11351808, "sampled_count": 16811008, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11351808, "sampled_count": 16811008, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32084378600120544, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7203277349472046, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 95716352, "episodes_total": 957192, "training_iteration": 971, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-58-33", "timestamp": 1569088713, "time_this_iter_s": 30.563488960266113, "time_total_s": 29677.200130224228, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07687158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14060.236395597458, "timesteps_since_restore": 45645568, "iterations_since_restore": 460, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.83263400330764, "episode_reward_min": 52.748863773064166, "episode_reward_mean": 54.14510894558322, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.281664666173963, "agent_1": 23.86344427940923}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6504131696039057, "mean_processing_ms": 3.4871648293979756, "mean_inference_ms": 2.065101482469218}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2816, "num_steps_trained": 141358336, "num_steps_sampled": 95817728, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 89348, "num_samples_dropped": 309, "learner_queue": {"size_count": 274110, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.167, "replay_time_ms": 94.724, "update_priorities_time_ms": 55.668, "policy_agent_0": {"added_count": 11378688, "sampled_count": 16849152, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11378688, "sampled_count": 16849152, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33268868923187256, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7273856401443481, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 95817728, "episodes_total": 958200, "training_iteration": 972, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-59-03", "timestamp": 1569088743, "time_this_iter_s": 30.470159769058228, "time_total_s": 29707.670289993286, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07687d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14090.706555366516, "timesteps_since_restore": 45746944, "iterations_since_restore": 461, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.881541825091006, "episode_reward_min": 50.643222351755554, "episode_reward_mean": 55.52212665265299, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 30.801670797291226, "agent_1": 24.7204558553617}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.650149136884075, "mean_processing_ms": 3.4876899734718605, "mean_inference_ms": 2.065376597837097}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2819, "num_steps_trained": 141507584, "num_steps_sampled": 95917568, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 89544, "num_samples_dropped": 309, "learner_queue": {"size_count": 274692, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.697, "replay_time_ms": 87.494, "update_priorities_time_ms": 45.622, "policy_agent_0": {"added_count": 11405568, "sampled_count": 16885248, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11405568, "sampled_count": 16885248, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34520357847213745, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7304363250732422, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 95917568, "episodes_total": 959192, "training_iteration": 973, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_17-59-34", "timestamp": 1569088774, "time_this_iter_s": 30.52018141746521, "time_total_s": 29738.19047141075, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07689268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14121.226736783981, "timesteps_since_restore": 45846784, "iterations_since_restore": 462, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.855296314354206, "episode_reward_min": 49.09397284495469, "episode_reward_mean": 53.545917592645885, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.78050053424059, "agent_1": 24.76541705840517}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6502481470009135, "mean_processing_ms": 3.4877823228532936, "mean_inference_ms": 2.0653990298684546}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2822, "num_steps_trained": 141655040, "num_steps_sampled": 96016896, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 89737, "num_samples_dropped": 309, "learner_queue": {"size_count": 275267, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.477, "replay_time_ms": 107.577, "update_priorities_time_ms": 56.772, "policy_agent_0": {"added_count": 11428864, "sampled_count": 16922624, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11428864, "sampled_count": 16922624, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3238868713378906, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6894510984420776, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 96016896, "episodes_total": 960184, "training_iteration": 974, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-00-05", "timestamp": 1569088805, "time_this_iter_s": 30.6305730342865, "time_total_s": 29768.821044445038, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07689e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14151.857309818268, "timesteps_since_restore": 45946112, "iterations_since_restore": 463, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.890769672261825, "episode_reward_min": 55.6097886138286, "episode_reward_mean": 57.42796086562697, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 30.966893088741024, "agent_1": 26.4610677768859}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6503699249354479, "mean_processing_ms": 3.4879181201829312, "mean_inference_ms": 2.0655240873298646}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2825, "num_steps_trained": 141793792, "num_steps_sampled": 96114688, "sample_throughput": 0.0, "train_throughput": 23769.023, "num_weight_syncs": 89929, "num_samples_dropped": 309, "learner_queue": {"size_count": 275809, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.827, "replay_time_ms": 96.696, "update_priorities_time_ms": 43.415, "policy_agent_0": {"added_count": 11453184, "sampled_count": 16957952, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11453184, "sampled_count": 16957952, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32905247807502747, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.639685869216919, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 96114688, "episodes_total": 961168, "training_iteration": 975, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-00-35", "timestamp": 1569088835, "time_this_iter_s": 30.55619168281555, "time_total_s": 29799.377236127853, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076a4378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14182.413501501083, "timesteps_since_restore": 46043904, "iterations_since_restore": 464, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 60.92092646500756, "episode_reward_min": 56.49453491980469, "episode_reward_mean": 57.744549540429304, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 29.826100311640168, "agent_1": 27.918449228789303}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6503020364669401, "mean_processing_ms": 3.487670009492394, "mean_inference_ms": 2.0655175749639274}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2828, "num_steps_trained": 141946880, "num_steps_sampled": 96213760, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 90122, "num_samples_dropped": 309, "learner_queue": {"size_count": 276407, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.087, "replay_time_ms": 85.914, "update_priorities_time_ms": 50.872, "policy_agent_0": {"added_count": 11480832, "sampled_count": 16995328, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11480832, "sampled_count": 16995328, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30879947543144226, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5857663750648499, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 96213760, "episodes_total": 962168, "training_iteration": 976, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-01-06", "timestamp": 1569088866, "time_this_iter_s": 30.445172786712646, "time_total_s": 29829.822408914566, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076871e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14212.858674287796, "timesteps_since_restore": 46142976, "iterations_since_restore": 465, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.95514508095619, "episode_reward_min": 54.9368640028203, "episode_reward_mean": 57.753481751728415, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 31.020493948198162, "agent_1": 26.73298780353034}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501567121331011, "mean_processing_ms": 3.487916936592197, "mean_inference_ms": 2.0655515454600306}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2831, "num_steps_trained": 142094336, "num_steps_sampled": 96315648, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 90321, "num_samples_dropped": 309, "learner_queue": {"size_count": 276983, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.804, "replay_time_ms": 89.199, "update_priorities_time_ms": 48.853, "policy_agent_0": {"added_count": 11507456, "sampled_count": 17032192, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11507456, "sampled_count": 17032192, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32152992486953735, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5307852625846863, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 96315648, "episodes_total": 963192, "training_iteration": 977, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-01-36", "timestamp": 1569088896, "time_this_iter_s": 30.594562768936157, "time_total_s": 29860.416971683502, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0776f268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14243.453237056732, "timesteps_since_restore": 46244864, "iterations_since_restore": 466, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.964802894796705, "episode_reward_min": 49.33213505363657, "episode_reward_mean": 57.21114504453624, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 30.255074191839018, "agent_1": 26.956070852697206}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.650267381161873, "mean_processing_ms": 3.4870944208076553, "mean_inference_ms": 2.065105777066843}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2834, "num_steps_trained": 142243072, "num_steps_sampled": 96417280, "sample_throughput": 0.0, "train_throughput": 10896.507, "num_weight_syncs": 90519, "num_samples_dropped": 309, "learner_queue": {"size_count": 277564, "size_mean": 0.14, "size_std": 0.40049968789001567, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.88, "replay_time_ms": 111.804, "update_priorities_time_ms": 50.918, "policy_agent_0": {"added_count": 11532288, "sampled_count": 17069312, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11532288, "sampled_count": 17069312, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3080660402774811, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49681758880615234, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 96417280, "episodes_total": 964200, "training_iteration": 978, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-02-07", "timestamp": 1569088927, "time_this_iter_s": 30.594454050064087, "time_total_s": 29891.011425733566, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077b0378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14274.047691106796, "timesteps_since_restore": 46346496, "iterations_since_restore": 467, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.95514508095619, "episode_reward_min": 47.67720887234977, "episode_reward_mean": 54.21552214980153, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.382272544581415, "agent_1": 25.833249605220143}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501649834560977, "mean_processing_ms": 3.487591760434118, "mean_inference_ms": 2.0656085444508197}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2837, "num_steps_trained": 142396672, "num_steps_sampled": 96514816, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 90710, "num_samples_dropped": 309, "learner_queue": {"size_count": 278167, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.661, "replay_time_ms": 109.327, "update_priorities_time_ms": 56.8, "policy_agent_0": {"added_count": 11554560, "sampled_count": 17107712, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11554560, "sampled_count": 17107712, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35803911089897156, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4829041659832001, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 96514816, "episodes_total": 965168, "training_iteration": 979, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-02-38", "timestamp": 1569088958, "time_this_iter_s": 30.56874966621399, "time_total_s": 29921.58017539978, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076d1d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14304.61644077301, "timesteps_since_restore": 46444032, "iterations_since_restore": 468, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.95514508095619, "episode_reward_min": 47.8493747192007, "episode_reward_mean": 58.16203445287829, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 31.786902280402437, "agent_1": 26.375132172475848}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501945308595122, "mean_processing_ms": 3.4875470883556514, "mean_inference_ms": 2.0654980005245034}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2840, "num_steps_trained": 142548480, "num_steps_sampled": 96613120, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 90902, "num_samples_dropped": 309, "learner_queue": {"size_count": 278757, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.016, "replay_time_ms": 110.823, "update_priorities_time_ms": 51.693, "policy_agent_0": {"added_count": 11581952, "sampled_count": 17144320, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11581952, "sampled_count": 17144320, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39289093017578125, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47468841075897217, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 96613120, "episodes_total": 966160, "training_iteration": 980, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-03-08", "timestamp": 1569088988, "time_this_iter_s": 30.631991386413574, "time_total_s": 29952.212166786194, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c024510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14335.248432159424, "timesteps_since_restore": 46542336, "iterations_since_restore": 469, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.881180934672294, "episode_reward_min": 47.67684670485746, "episode_reward_mean": 55.728826088449075, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 31.0382677252651, "agent_1": 24.69055836318414}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6502518268940966, "mean_processing_ms": 3.4870883507199144, "mean_inference_ms": 2.0651329015289597}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2843, "num_steps_trained": 142697472, "num_steps_sampled": 96713472, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 91097, "num_samples_dropped": 309, "learner_queue": {"size_count": 279339, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.11, "replay_time_ms": 103.63, "update_priorities_time_ms": 43.99, "policy_agent_0": {"added_count": 11612160, "sampled_count": 17181696, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11612160, "sampled_count": 17181696, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3948456346988678, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4974193274974823, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 96713472, "episodes_total": 967152, "training_iteration": 981, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-03-39", "timestamp": 1569089019, "time_this_iter_s": 30.601134300231934, "time_total_s": 29982.813301086426, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c28e488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14365.849566459656, "timesteps_since_restore": 46642688, "iterations_since_restore": 470, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.168158749528395, "episode_reward_min": 47.69329280775047, "episode_reward_mean": 53.374031857859244, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.98837586675732, "agent_1": 25.385655991102066}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6502831766656538, "mean_processing_ms": 3.487283328954518, "mean_inference_ms": 2.0651623161991}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2846, "num_steps_trained": 142846208, "num_steps_sampled": 96814848, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 91296, "num_samples_dropped": 309, "learner_queue": {"size_count": 279920, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.091, "replay_time_ms": 80.491, "update_priorities_time_ms": 45.97, "policy_agent_0": {"added_count": 11636736, "sampled_count": 17219328, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11636736, "sampled_count": 17219328, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40483295917510986, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49996376037597656, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 96814848, "episodes_total": 968168, "training_iteration": 982, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-04-10", "timestamp": 1569089050, "time_this_iter_s": 30.56318688392639, "time_total_s": 30013.376487970352, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2caae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14396.412753343582, "timesteps_since_restore": 46744064, "iterations_since_restore": 471, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.22427635031693, "episode_reward_min": 49.36847072595034, "episode_reward_mean": 53.64922618071713, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.469149565723562, "agent_1": 26.180076614993663}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501337402125743, "mean_processing_ms": 3.4870760458913184, "mean_inference_ms": 2.064935766441489}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2849, "num_steps_trained": 142996480, "num_steps_sampled": 96916736, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 91495, "num_samples_dropped": 309, "learner_queue": {"size_count": 280507, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.761, "replay_time_ms": 102.398, "update_priorities_time_ms": 49.409, "policy_agent_0": {"added_count": 11659520, "sampled_count": 17258752, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11659520, "sampled_count": 17258752, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4231908917427063, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5179198384284973, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 96916736, "episodes_total": 969184, "training_iteration": 983, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-04-40", "timestamp": 1569089080, "time_this_iter_s": 30.52629518508911, "time_total_s": 30043.90278315544, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c33ab70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14426.939048528671, "timesteps_since_restore": 46845952, "iterations_since_restore": 472, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.21399898163488, "episode_reward_min": 48.36847651918875, "episode_reward_mean": 54.83504203589899, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 28.605263904300013, "agent_1": 26.229778131599105}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500065886933486, "mean_processing_ms": 3.4870341350302536, "mean_inference_ms": 2.064864182171914}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2852, "num_steps_trained": 143148544, "num_steps_sampled": 97016832, "sample_throughput": 0.0, "train_throughput": 14328.402, "num_weight_syncs": 91690, "num_samples_dropped": 309, "learner_queue": {"size_count": 281102, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.316, "replay_time_ms": 78.371, "update_priorities_time_ms": 41.287, "policy_agent_0": {"added_count": 11682560, "sampled_count": 17299200, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11682560, "sampled_count": 17299200, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45989686250686646, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5095612406730652, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 97016832, "episodes_total": 970200, "training_iteration": 984, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-05-11", "timestamp": 1569089111, "time_this_iter_s": 30.599681854248047, "time_total_s": 30074.50246500969, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c429d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14457.53873038292, "timesteps_since_restore": 46946048, "iterations_since_restore": 473, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.280693052517336, "episode_reward_min": 51.27942459948093, "episode_reward_mean": 57.08418434107013, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 29.21104924707943, "agent_1": 27.87313509399076}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501400669497314, "mean_processing_ms": 3.486799113786033, "mean_inference_ms": 2.064849370010117}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2855, "num_steps_trained": 143301376, "num_steps_sampled": 97116416, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 91885, "num_samples_dropped": 309, "learner_queue": {"size_count": 281699, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.291, "replay_time_ms": 106.347, "update_priorities_time_ms": 53.408, "policy_agent_0": {"added_count": 11707904, "sampled_count": 17337856, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11707904, "sampled_count": 17337856, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39574477076530457, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4781838059425354, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 97116416, "episodes_total": 971200, "training_iteration": 985, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-05-41", "timestamp": 1569089141, "time_this_iter_s": 30.621167182922363, "time_total_s": 30105.12363219261, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3f2620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14488.159897565842, "timesteps_since_restore": 47045632, "iterations_since_restore": 474, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.57419292944812, "episode_reward_min": 55.26760855673175, "episode_reward_mean": 58.34575794982989, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.439969507128886, "agent_1": 29.905788442700985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501607241508929, "mean_processing_ms": 3.4870842383920837, "mean_inference_ms": 2.0649531531308187}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2858, "num_steps_trained": 143447040, "num_steps_sampled": 97218560, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 92085, "num_samples_dropped": 309, "learner_queue": {"size_count": 282267, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.881, "replay_time_ms": 107.216, "update_priorities_time_ms": 56.768, "policy_agent_0": {"added_count": 11737600, "sampled_count": 17373184, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11737600, "sampled_count": 17373184, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38100773096084595, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4593425989151001, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 97218560, "episodes_total": 972208, "training_iteration": 986, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-06-12", "timestamp": 1569089172, "time_this_iter_s": 30.580084562301636, "time_total_s": 30135.703716754913, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea6a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14518.739982128143, "timesteps_since_restore": 47147776, "iterations_since_restore": 475, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.20193001964032, "episode_reward_min": 55.41052980684078, "episode_reward_mean": 57.84019900199156, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.754785802016706, "agent_1": 29.08541319997484}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6502225020279684, "mean_processing_ms": 3.4869819463694776, "mean_inference_ms": 2.0650399719997545}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2861, "num_steps_trained": 143597312, "num_steps_sampled": 97318656, "sample_throughput": 0.0, "train_throughput": 15723.496, "num_weight_syncs": 92280, "num_samples_dropped": 309, "learner_queue": {"size_count": 282854, "size_mean": 1.48, "size_std": 2.851245341951478, "size_quantiles": [0.0, 0.0, 0.0, 6.100000000000001, 11.0]}, "replay_shard_0": {"add_batch_time_ms": 39.294, "replay_time_ms": 90.497, "update_priorities_time_ms": 47.565, "policy_agent_0": {"added_count": 11766016, "sampled_count": 17408768, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11766016, "sampled_count": 17408768, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36185628175735474, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3941861391067505, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 97318656, "episodes_total": 973208, "training_iteration": 987, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-06-42", "timestamp": 1569089202, "time_this_iter_s": 30.49884033203125, "time_total_s": 30166.202557086945, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c469a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14549.238822460175, "timesteps_since_restore": 47247872, "iterations_since_restore": 476, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.17494645313614, "episode_reward_min": 55.01183014909199, "episode_reward_mean": 56.31890182871418, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 26.185043717997, "agent_1": 30.13385811071735}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6502929017374823, "mean_processing_ms": 3.487265075951313, "mean_inference_ms": 2.064968562122366}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2864, "num_steps_trained": 143746048, "num_steps_sampled": 97420544, "sample_throughput": 5197.076, "train_throughput": 10394.151, "num_weight_syncs": 92479, "num_samples_dropped": 309, "learner_queue": {"size_count": 283436, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.516, "replay_time_ms": 98.516, "update_priorities_time_ms": 51.579, "policy_agent_0": {"added_count": 11789568, "sampled_count": 17446400, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11789568, "sampled_count": 17446400, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38977885246276855, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3741149306297302, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 97420544, "episodes_total": 974232, "training_iteration": 988, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-07-13", "timestamp": 1569089233, "time_this_iter_s": 30.59153413772583, "time_total_s": 30196.79409122467, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14579.8303565979, "timesteps_since_restore": 47349760, "iterations_since_restore": 477, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.75453506964109, "episode_reward_min": 54.91734334204481, "episode_reward_mean": 55.27756752833922, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.223796761865913, "agent_1": 30.053770766473576}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500423305990476, "mean_processing_ms": 3.4866080117574207, "mean_inference_ms": 2.0646096353742402}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2867, "num_steps_trained": 143896064, "num_steps_sampled": 97522176, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 92677, "num_samples_dropped": 309, "learner_queue": {"size_count": 284021, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.83, "replay_time_ms": 91.988, "update_priorities_time_ms": 41.584, "policy_agent_0": {"added_count": 11812864, "sampled_count": 17485056, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11812864, "sampled_count": 17485056, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42156845331192017, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3555070459842682, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 97522176, "episodes_total": 975248, "training_iteration": 989, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-07-44", "timestamp": 1569089264, "time_this_iter_s": 30.558928966522217, "time_total_s": 30227.353020191193, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c353510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14610.389285564423, "timesteps_since_restore": 47451392, "iterations_since_restore": 478, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.76031597504994, "episode_reward_min": 54.83048089239307, "episode_reward_mean": 55.27284965572659, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 25.269966143522947, "agent_1": 30.00288351220391}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500799402747148, "mean_processing_ms": 3.4866434220227065, "mean_inference_ms": 2.064485907544425}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2870, "num_steps_trained": 144043776, "num_steps_sampled": 97623808, "sample_throughput": 0.0, "train_throughput": 13720.713, "num_weight_syncs": 92876, "num_samples_dropped": 309, "learner_queue": {"size_count": 284598, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.443, "replay_time_ms": 121.227, "update_priorities_time_ms": 53.874, "policy_agent_0": {"added_count": 11840512, "sampled_count": 17519616, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11840512, "sampled_count": 17519616, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46741166710853577, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3619143068790436, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 97623808, "episodes_total": 976272, "training_iteration": 990, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-08-14", "timestamp": 1569089294, "time_this_iter_s": 30.612045288085938, "time_total_s": 30257.96506547928, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077d30d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14641.001330852509, "timesteps_since_restore": 47553024, "iterations_since_restore": 479, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.82530746353118, "episode_reward_min": 53.384136009987806, "episode_reward_mean": 55.17644909272562, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 25.47593025473499, "agent_1": 29.70051883799087}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501186545778693, "mean_processing_ms": 3.4863768434289995, "mean_inference_ms": 2.0642854971323605}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2873, "num_steps_trained": 144187648, "num_steps_sampled": 97726464, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 93076, "num_samples_dropped": 309, "learner_queue": {"size_count": 285160, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 24.954, "replay_time_ms": 100.073, "update_priorities_time_ms": 48.803, "policy_agent_0": {"added_count": 11867648, "sampled_count": 17556224, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11867648, "sampled_count": 17556224, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48834511637687683, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35090693831443787, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 97726464, "episodes_total": 977296, "training_iteration": 991, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-08-45", "timestamp": 1569089325, "time_this_iter_s": 30.553682804107666, "time_total_s": 30288.518748283386, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ecd90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14671.555013656616, "timesteps_since_restore": 47655680, "iterations_since_restore": 480, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.75184671534727, "episode_reward_min": 50.44359767074964, "episode_reward_mean": 55.18544154862339, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.14756560165836, "agent_1": 30.03787594696529}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500686160929529, "mean_processing_ms": 3.4869198255432527, "mean_inference_ms": 2.06457187460587}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2876, "num_steps_trained": 144340480, "num_steps_sampled": 97825792, "sample_throughput": 4577.841, "train_throughput": 4577.841, "num_weight_syncs": 93271, "num_samples_dropped": 309, "learner_queue": {"size_count": 285757, "size_mean": 0.28, "size_std": 0.4915282290977803, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.162, "replay_time_ms": 116.251, "update_priorities_time_ms": 56.067, "policy_agent_0": {"added_count": 11893760, "sampled_count": 17594368, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11893760, "sampled_count": 17594368, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5124842524528503, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3450857698917389, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 97825792, "episodes_total": 978288, "training_iteration": 992, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-09-16", "timestamp": 1569089356, "time_this_iter_s": 30.582846641540527, "time_total_s": 30319.101594924927, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c037620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14702.137860298157, "timesteps_since_restore": 47755008, "iterations_since_restore": 481, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 55.673735161514585, "episode_reward_min": 54.42496536855398, "episode_reward_mean": 55.221805214092896, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.172940177085284, "agent_1": 30.048865037007875}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501420412371063, "mean_processing_ms": 3.486465011194518, "mean_inference_ms": 2.064392424680123}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2879, "num_steps_trained": 144494848, "num_steps_sampled": 97924864, "sample_throughput": 12949.442, "train_throughput": 0.0, "num_weight_syncs": 93464, "num_samples_dropped": 309, "learner_queue": {"size_count": 286360, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.806, "replay_time_ms": 97.865, "update_priorities_time_ms": 54.169, "policy_agent_0": {"added_count": 11917056, "sampled_count": 17633792, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11917056, "sampled_count": 17633792, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5026943683624268, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33077746629714966, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 97924864, "episodes_total": 979272, "training_iteration": 993, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-09-46", "timestamp": 1569089386, "time_this_iter_s": 30.533812284469604, "time_total_s": 30349.635407209396, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0777f7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14732.671672582626, "timesteps_since_restore": 47854080, "iterations_since_restore": 482, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.14270092595298, "episode_reward_min": 52.15344753043166, "episode_reward_mean": 54.2173014895648, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 24.377954438984517, "agent_1": 29.839347050580447}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500460852842461, "mean_processing_ms": 3.486712212686996, "mean_inference_ms": 2.0645178220160063}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2882, "num_steps_trained": 144644608, "num_steps_sampled": 98025984, "sample_throughput": 6934.122, "train_throughput": 13868.244, "num_weight_syncs": 93662, "num_samples_dropped": 309, "learner_queue": {"size_count": 286946, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.918, "replay_time_ms": 94.844, "update_priorities_time_ms": 48.438, "policy_agent_0": {"added_count": 11941120, "sampled_count": 17668864, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11941120, "sampled_count": 17668864, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.533644437789917, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34837713837623596, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 98025984, "episodes_total": 980288, "training_iteration": 994, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-10-17", "timestamp": 1569089417, "time_this_iter_s": 30.532203435897827, "time_total_s": 30380.167610645294, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077896a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14763.203876018524, "timesteps_since_restore": 47955200, "iterations_since_restore": 483, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.39950562386827, "episode_reward_min": 53.848068772470306, "episode_reward_mean": 55.43957068300935, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.21780196782035, "agent_1": 30.221768715189224}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6503006994670875, "mean_processing_ms": 3.486716807396963, "mean_inference_ms": 2.064419485390934}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2885, "num_steps_trained": 144794624, "num_steps_sampled": 98125824, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 93856, "num_samples_dropped": 309, "learner_queue": {"size_count": 287531, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.926, "replay_time_ms": 92.283, "update_priorities_time_ms": 48.506, "policy_agent_0": {"added_count": 11968000, "sampled_count": 17707264, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11968000, "sampled_count": 17707264, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5424457788467407, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33451908826828003, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 98125824, "episodes_total": 981280, "training_iteration": 995, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-10-47", "timestamp": 1569089447, "time_this_iter_s": 30.68273425102234, "time_total_s": 30410.850344896317, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076f30d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14793.886610269547, "timesteps_since_restore": 48055040, "iterations_since_restore": 484, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 59.38761357746513, "episode_reward_min": 54.65728187997325, "episode_reward_mean": 56.98494436613365, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.05379769334807, "agent_1": 29.9311466727857}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501777828219898, "mean_processing_ms": 3.486712397071531, "mean_inference_ms": 2.064372484550879}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2888, "num_steps_trained": 144943104, "num_steps_sampled": 98226688, "sample_throughput": 0.0, "train_throughput": 20567.009, "num_weight_syncs": 94053, "num_samples_dropped": 309, "learner_queue": {"size_count": 288112, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.327, "replay_time_ms": 102.254, "update_priorities_time_ms": 51.089, "policy_agent_0": {"added_count": 11993344, "sampled_count": 17744384, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 11993344, "sampled_count": 17744384, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5482988953590393, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3359113037586212, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 98226688, "episodes_total": 982296, "training_iteration": 996, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-11-18", "timestamp": 1569089478, "time_this_iter_s": 30.55924367904663, "time_total_s": 30441.409588575363, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076a4ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14824.445853948593, "timesteps_since_restore": 48155904, "iterations_since_restore": 485, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.1737855081962, "episode_reward_min": 51.559405391787436, "episode_reward_mean": 54.40117492969663, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 24.677693362542882, "agent_1": 29.723481567153904}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500840533910166, "mean_processing_ms": 3.486406426592104, "mean_inference_ms": 2.0642322201588423}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2891, "num_steps_trained": 145099008, "num_steps_sampled": 98324480, "sample_throughput": 0.0, "train_throughput": 27007.617, "num_weight_syncs": 94245, "num_samples_dropped": 309, "learner_queue": {"size_count": 288720, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.383, "replay_time_ms": 103.873, "update_priorities_time_ms": 52.06, "policy_agent_0": {"added_count": 12018432, "sampled_count": 17782016, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12018432, "sampled_count": 17782016, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5652058124542236, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3307602107524872, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 98324480, "episodes_total": 983272, "training_iteration": 997, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-11-49", "timestamp": 1569089509, "time_this_iter_s": 30.526137351989746, "time_total_s": 30471.935725927353, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076b5400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14854.971991300583, "timesteps_since_restore": 48253696, "iterations_since_restore": 486, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.1807830646269, "episode_reward_min": 50.86505345049839, "episode_reward_mean": 54.98345465999689, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.27162238788059, "agent_1": 29.711832272116503}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501839040200559, "mean_processing_ms": 3.486842391107607, "mean_inference_ms": 2.064447810071187}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2894, "num_steps_trained": 145250048, "num_steps_sampled": 98424576, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 94439, "num_samples_dropped": 309, "learner_queue": {"size_count": 289310, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.224, "replay_time_ms": 108.546, "update_priorities_time_ms": 56.235, "policy_agent_0": {"added_count": 12045056, "sampled_count": 17819392, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12045056, "sampled_count": 17819392, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5706533193588257, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3393501937389374, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 98424576, "episodes_total": 984272, "training_iteration": 998, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-12-19", "timestamp": 1569089539, "time_this_iter_s": 30.627781867980957, "time_total_s": 30502.563507795334, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e0763f048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14885.599773168564, "timesteps_since_restore": 48353792, "iterations_since_restore": 487, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.211042695117236, "episode_reward_min": 54.071893851043846, "episode_reward_mean": 56.15475834906452, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 26.31495528941987, "agent_1": 29.839803059644886}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501237164940312, "mean_processing_ms": 3.48635666987644, "mean_inference_ms": 2.064258054451265}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2897, "num_steps_trained": 145401344, "num_steps_sampled": 98524672, "sample_throughput": 18600.34, "train_throughput": 0.0, "num_weight_syncs": 94635, "num_samples_dropped": 309, "learner_queue": {"size_count": 289901, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.932, "replay_time_ms": 92.176, "update_priorities_time_ms": 44.327, "policy_agent_0": {"added_count": 12066816, "sampled_count": 17858048, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12066816, "sampled_count": 17858048, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5926987528800964, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35118037462234497, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 98524672, "episodes_total": 985272, "training_iteration": 999, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-12-50", "timestamp": 1569089570, "time_this_iter_s": 30.563302040100098, "time_total_s": 30533.126809835434, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07644510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14916.163075208664, "timesteps_since_restore": 48453888, "iterations_since_restore": 488, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.9521682437791, "episode_reward_min": 54.87195163187603, "episode_reward_mean": 55.84016802996362, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.92881650623617, "agent_1": 29.91135152372771}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501530560077315, "mean_processing_ms": 3.4868830563898205, "mean_inference_ms": 2.0645445377053027}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2900, "num_steps_trained": 145556224, "num_steps_sampled": 98623744, "sample_throughput": 33682.848, "train_throughput": 0.0, "num_weight_syncs": 94829, "num_samples_dropped": 309, "learner_queue": {"size_count": 290506, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.145, "replay_time_ms": 104.104, "update_priorities_time_ms": 54.216, "policy_agent_0": {"added_count": 12088320, "sampled_count": 17898752, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12088320, "sampled_count": 17898752, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5682433247566223, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32773834466934204, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 98623744, "episodes_total": 986264, "training_iteration": 1000, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-13-20", "timestamp": 1569089600, "time_this_iter_s": 30.504934310913086, "time_total_s": 30563.631744146347, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076a4488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14946.668009519577, "timesteps_since_restore": 48552960, "iterations_since_restore": 489, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.0120319358194, "episode_reward_min": 55.01494319785254, "episode_reward_mean": 55.56986226597188, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.50232653319172, "agent_1": 30.067535732780406}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501267502501705, "mean_processing_ms": 3.4860717238126444, "mean_inference_ms": 2.064163082266033}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2903, "num_steps_trained": 145709312, "num_steps_sampled": 98723840, "sample_throughput": 23576.958, "train_throughput": 0.0, "num_weight_syncs": 95024, "num_samples_dropped": 309, "learner_queue": {"size_count": 291104, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.102, "replay_time_ms": 109.766, "update_priorities_time_ms": 57.379, "policy_agent_0": {"added_count": 12117248, "sampled_count": 17934592, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12117248, "sampled_count": 17934592, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5397949814796448, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3619464933872223, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 98723840, "episodes_total": 987264, "training_iteration": 1001, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-13-51", "timestamp": 1569089631, "time_this_iter_s": 30.592115879058838, "time_total_s": 30594.223860025406, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e077891e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 14977.260125398636, "timesteps_since_restore": 48653056, "iterations_since_restore": 490, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.89273053747836, "episode_reward_min": 52.6676482434935, "episode_reward_mean": 54.742806012520205, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 24.733065639467487, "agent_1": 30.009740373052832}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500940565912471, "mean_processing_ms": 3.4860687191911084, "mean_inference_ms": 2.064176026325936}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2906, "num_steps_trained": 145859584, "num_steps_sampled": 98823424, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 95219, "num_samples_dropped": 309, "learner_queue": {"size_count": 291691, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.319, "replay_time_ms": 104.989, "update_priorities_time_ms": 55.288, "policy_agent_0": {"added_count": 12137728, "sampled_count": 17973248, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12137728, "sampled_count": 17973248, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5542702674865723, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34003889560699463, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 98823424, "episodes_total": 988264, "training_iteration": 1002, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-14-22", "timestamp": 1569089662, "time_this_iter_s": 30.53204584121704, "time_total_s": 30624.755905866623, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e076ee048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15007.792171239853, "timesteps_since_restore": 48752640, "iterations_since_restore": 491, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.196933639799596, "episode_reward_min": 50.028632880583, "episode_reward_mean": 55.22212515209037, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.496228135554244, "agent_1": 29.72589701653626}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500514056364262, "mean_processing_ms": 3.4862354649817986, "mean_inference_ms": 2.064278308905976}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2909, "num_steps_trained": 146009344, "num_steps_sampled": 98924544, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 95416, "num_samples_dropped": 309, "learner_queue": {"size_count": 292276, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.748, "replay_time_ms": 98.273, "update_priorities_time_ms": 52.123, "policy_agent_0": {"added_count": 12163072, "sampled_count": 18010624, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12163072, "sampled_count": 18010624, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.560663104057312, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3223263621330261, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 98924544, "episodes_total": 989272, "training_iteration": 1003, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-14-52", "timestamp": 1569089692, "time_this_iter_s": 30.519446849822998, "time_total_s": 30655.275352716446, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c037598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15038.311618089676, "timesteps_since_restore": 48853760, "iterations_since_restore": 492, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.00191747619522, "episode_reward_min": 52.56231524729928, "episode_reward_mean": 55.726726939360184, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 26.004519760692304, "agent_1": 29.722207178668103}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501036201508303, "mean_processing_ms": 3.4856673176401674, "mean_inference_ms": 2.0640034051200957}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2912, "num_steps_trained": 146159616, "num_steps_sampled": 99024640, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 95612, "num_samples_dropped": 309, "learner_queue": {"size_count": 292864, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.595, "replay_time_ms": 107.545, "update_priorities_time_ms": 58.437, "policy_agent_0": {"added_count": 12188928, "sampled_count": 18047744, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12188928, "sampled_count": 18047744, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5685372948646545, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3487570881843567, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 99024640, "episodes_total": 990264, "training_iteration": 1004, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-15-23", "timestamp": 1569089723, "time_this_iter_s": 30.4973623752594, "time_total_s": 30685.772715091705, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c312510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15068.808980464935, "timesteps_since_restore": 48953856, "iterations_since_restore": 493, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.480307766219354, "episode_reward_min": 52.014681370792765, "episode_reward_mean": 55.513362625921, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.506556655352817, "agent_1": 30.006805970568323}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501088732541441, "mean_processing_ms": 3.486242054373633, "mean_inference_ms": 2.06438370302024}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2915, "num_steps_trained": 146313472, "num_steps_sampled": 99123968, "sample_throughput": 5786.4, "train_throughput": 5786.4, "num_weight_syncs": 95806, "num_samples_dropped": 309, "learner_queue": {"size_count": 293465, "size_mean": 0.16, "size_std": 0.41761226035642207, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.777, "replay_time_ms": 89.698, "update_priorities_time_ms": 50.894, "policy_agent_0": {"added_count": 12212992, "sampled_count": 18086656, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12212992, "sampled_count": 18086656, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5662240982055664, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3242010176181793, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 99123968, "episodes_total": 991264, "training_iteration": 1005, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-15-53", "timestamp": 1569089753, "time_this_iter_s": 30.481287956237793, "time_total_s": 30716.254003047943, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c31bae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15099.290268421173, "timesteps_since_restore": 49053184, "iterations_since_restore": 494, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.024384150178285, "episode_reward_min": 54.85266768329548, "episode_reward_mean": 56.008943964193485, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 26.03851603125831, "agent_1": 29.970427932935387}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500161607926062, "mean_processing_ms": 3.4860448261155774, "mean_inference_ms": 2.064055045126724}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2918, "num_steps_trained": 146459392, "num_steps_sampled": 99226880, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 96007, "num_samples_dropped": 309, "learner_queue": {"size_count": 294036, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.916, "replay_time_ms": 72.264, "update_priorities_time_ms": 39.496, "policy_agent_0": {"added_count": 12236544, "sampled_count": 18124544, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12236544, "sampled_count": 18124544, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5410441756248474, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34022969007492065, "model": {}}}}, "timesteps_this_iter": 102912, "done": false, "timesteps_total": 99226880, "episodes_total": 992296, "training_iteration": 1006, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-16-24", "timestamp": 1569089784, "time_this_iter_s": 30.538373470306396, "time_total_s": 30746.79237651825, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c4a2950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15129.82864189148, "timesteps_since_restore": 49156096, "iterations_since_restore": 495, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 58.57156661023436, "episode_reward_min": 54.84114619299269, "episode_reward_mean": 56.25746347790031, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.88479607145309, "agent_1": 29.37266740644728}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500271538237827, "mean_processing_ms": 3.4859561503396703, "mean_inference_ms": 2.0639635673430914}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2921, "num_steps_trained": 146616064, "num_steps_sampled": 99325440, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 96199, "num_samples_dropped": 309, "learner_queue": {"size_count": 294646, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 43.447, "replay_time_ms": 102.184, "update_priorities_time_ms": 50.642, "policy_agent_0": {"added_count": 12261376, "sampled_count": 18164736, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12261376, "sampled_count": 18164736, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.536115825176239, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3241066634654999, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 99325440, "episodes_total": 993280, "training_iteration": 1007, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-16-54", "timestamp": 1569089814, "time_this_iter_s": 30.62847399711609, "time_total_s": 30777.420850515366, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3b6950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15160.457115888596, "timesteps_since_restore": 49254656, "iterations_since_restore": 496, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.50482471847194, "episode_reward_min": 50.38968773268605, "episode_reward_mean": 55.65227110488322, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.735433207855014, "agent_1": 29.916837897028255}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.650113270122103, "mean_processing_ms": 3.48589214317582, "mean_inference_ms": 2.0639092914755794}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2924, "num_steps_trained": 146766592, "num_steps_sampled": 99427072, "sample_throughput": 12576.034, "train_throughput": 0.0, "num_weight_syncs": 96398, "num_samples_dropped": 309, "learner_queue": {"size_count": 295234, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.903, "replay_time_ms": 83.342, "update_priorities_time_ms": 48.487, "policy_agent_0": {"added_count": 12286464, "sampled_count": 18201600, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12286464, "sampled_count": 18201600, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5219547748565674, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33817416429519653, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 99427072, "episodes_total": 994296, "training_iteration": 1008, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-17-25", "timestamp": 1569089845, "time_this_iter_s": 30.5295352935791, "time_total_s": 30807.950385808945, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3cf9d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15190.986651182175, "timesteps_since_restore": 49356288, "iterations_since_restore": 497, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.24273135134489, "episode_reward_min": 54.887117520886896, "episode_reward_mean": 55.620827293115674, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 25.719755531044406, "agent_1": 29.901071762071368}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500906509856911, "mean_processing_ms": 3.4854840390492208, "mean_inference_ms": 2.06362301612012}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2927, "num_steps_trained": 146910720, "num_steps_sampled": 99530496, "sample_throughput": 9532.932, "train_throughput": 0.0, "num_weight_syncs": 96600, "num_samples_dropped": 309, "learner_queue": {"size_count": 295798, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.693, "replay_time_ms": 92.325, "update_priorities_time_ms": 46.674, "policy_agent_0": {"added_count": 12313088, "sampled_count": 18236928, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12313088, "sampled_count": 18236928, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5036634802818298, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.348663866519928, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 99530496, "episodes_total": 995328, "training_iteration": 1009, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-17-56", "timestamp": 1569089876, "time_this_iter_s": 30.657243728637695, "time_total_s": 30838.607629537582, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c3ea598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15221.643894910812, "timesteps_since_restore": 49459712, "iterations_since_restore": 498, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.272515937920424, "episode_reward_min": 54.65362198948155, "episode_reward_mean": 55.4987255385241, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.35885530846549, "agent_1": 30.139870230058765}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6499885225804583, "mean_processing_ms": 3.48566893755782, "mean_inference_ms": 2.0636451758901146}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2930, "num_steps_trained": 147058176, "num_steps_sampled": 99632640, "sample_throughput": 0.0, "train_throughput": 13236.626, "num_weight_syncs": 96800, "num_samples_dropped": 309, "learner_queue": {"size_count": 296373, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.982, "replay_time_ms": 91.14, "update_priorities_time_ms": 49.415, "policy_agent_0": {"added_count": 12335616, "sampled_count": 18275584, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12335616, "sampled_count": 18275584, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5115453004837036, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33342522382736206, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 99632640, "episodes_total": 996344, "training_iteration": 1010, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-18-26", "timestamp": 1569089906, "time_this_iter_s": 30.588924169540405, "time_total_s": 30869.196553707123, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c44f840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15252.232819080353, "timesteps_since_restore": 49561856, "iterations_since_restore": 499, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.09017255133454, "episode_reward_min": 51.38859858582057, "episode_reward_mean": 54.1833577759011, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.17543632399215, "agent_1": 29.00792145190914}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6501069259331304, "mean_processing_ms": 3.485588762409373, "mean_inference_ms": 2.0637113289454527}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2933, "num_steps_trained": 147209216, "num_steps_sampled": 99732736, "sample_throughput": 0.0, "train_throughput": 27887.225, "num_weight_syncs": 96995, "num_samples_dropped": 309, "learner_queue": {"size_count": 296963, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.017, "replay_time_ms": 112.714, "update_priorities_time_ms": 52.619, "policy_agent_0": {"added_count": 12359936, "sampled_count": 18312448, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12359936, "sampled_count": 18312448, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5036611557006836, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3272625207901001, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 99732736, "episodes_total": 997344, "training_iteration": 1011, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-18-57", "timestamp": 1569089937, "time_this_iter_s": 30.589980125427246, "time_total_s": 30899.78653383255, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c43ff28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15282.82279920578, "timesteps_since_restore": 49661952, "iterations_since_restore": 500, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 56.560053345500826, "episode_reward_min": 49.61780237268092, "episode_reward_mean": 55.10083238006451, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.219271880321596, "agent_1": 29.88156049974318}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6499080964593152, "mean_processing_ms": 3.4859876977297346, "mean_inference_ms": 2.0636403207972576}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2936, "num_steps_trained": 147361792, "num_steps_sampled": 99831552, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 97188, "num_samples_dropped": 309, "learner_queue": {"size_count": 297559, "size_mean": 0.18, "size_std": 0.43312815655415426, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.546, "replay_time_ms": 90.551, "update_priorities_time_ms": 47.731, "policy_agent_0": {"added_count": 12383232, "sampled_count": 18349056, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12383232, "sampled_count": 18349056, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5113697648048401, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33733969926834106, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 99831552, "episodes_total": 998344, "training_iteration": 1012, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-19-27", "timestamp": 1569089967, "time_this_iter_s": 30.529202461242676, "time_total_s": 30930.315736293793, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c341950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15313.352001667023, "timesteps_since_restore": 49760768, "iterations_since_restore": 501, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.42073641427623, "episode_reward_min": 54.54046012606984, "episode_reward_mean": 55.89406312369661, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.93882440243439, "agent_1": 29.955238721262475}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6500196382820016, "mean_processing_ms": 3.4860358209357454, "mean_inference_ms": 2.0637805402492493}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2939, "num_steps_trained": 147511296, "num_steps_sampled": 99931392, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 97383, "num_samples_dropped": 309, "learner_queue": {"size_count": 298144, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.927, "replay_time_ms": 96.952, "update_priorities_time_ms": 56.639, "policy_agent_0": {"added_count": 12410880, "sampled_count": 18384896, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12410880, "sampled_count": 18384896, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5173143148422241, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32030510902404785, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 99931392, "episodes_total": 999344, "training_iteration": 1013, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-19-58", "timestamp": 1569089998, "time_this_iter_s": 30.526702165603638, "time_total_s": 30960.842438459396, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e1c2ca400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15343.878703832626, "timesteps_since_restore": 49860608, "iterations_since_restore": 502, "num_healthy_workers": 4, "trial_id": "a05df94a"}
{"episode_reward_max": 57.347622860392775, "episode_reward_min": 53.343428533054734, "episode_reward_mean": 56.517615705237674, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.641699027175488, "agent_1": 29.875916678062346}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.649878602927515, "mean_processing_ms": 3.4856190780022502, "mean_inference_ms": 2.0634616834335073}, "off_policy_estimator": {}, "info": {"min_exploration": 0.010000000000000009, "max_exploration": 0.010000000000000009, "num_target_updates": 2942, "num_steps_trained": 147658752, "num_steps_sampled": 100033024, "sample_throughput": 9175.869, "train_throughput": 0.0, "num_weight_syncs": 97581, "num_samples_dropped": 309, "learner_queue": {"size_count": 298719, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.601, "replay_time_ms": 97.814, "update_priorities_time_ms": 56.189, "policy_agent_0": {"added_count": 12436992, "sampled_count": 18420992, "est_size_bytes": 97727228, "num_entries": 75000}, "policy_agent_1": {"added_count": 12436992, "sampled_count": 18420992, "est_size_bytes": 97727228, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49793732166290283, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3261283338069916, "model": {}}}}, "timesteps_this_iter": 101632, "done": true, "timesteps_total": 100033024, "episodes_total": 1000360, "training_iteration": 1014, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_18-20-29", "timestamp": 1569090029, "time_this_iter_s": 30.614543437957764, "time_total_s": 30991.456981897354, "pid": 44982, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f2e07705950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 15374.493247270584, "timesteps_since_restore": 49962240, "iterations_since_restore": 503, "num_healthy_workers": 4, "trial_id": "a05df94a"}
