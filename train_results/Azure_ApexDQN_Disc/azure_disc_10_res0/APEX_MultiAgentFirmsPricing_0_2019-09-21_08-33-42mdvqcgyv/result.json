{"episode_reward_max": 57.91768597716818, "episode_reward_min": 53.35878084500213, "episode_reward_mean": 55.93021358893285, "episode_len_mean": 100.0, "episodes_this_iter": 736, "policy_reward_mean": {"agent_0": 27.98126569687265, "agent_1": 27.94894789206023}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6479684169419874, "mean_processing_ms": 3.55547825885715, "mean_inference_ms": 2.097688900968842}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1, "num_steps_trained": 81664, "num_steps_sampled": 72960, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 141, "num_samples_dropped": 599, "learner_queue": {"size_count": 10660, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.898, "replay_time_ms": 95.963, "update_priorities_time_ms": 54.39, "policy_agent_0": {"added_count": 22784, "sampled_count": 25088, "est_size_bytes": 29688308, "num_entries": 22784}, "policy_agent_1": {"added_count": 22784, "sampled_count": 25088, "est_size_bytes": 29688308, "num_entries": 22784}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 2.2658989429473877, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 2.232356071472168, "model": {}}}}, "timesteps_this_iter": 72960, "done": false, "timesteps_total": 72960, "episodes_total": 736, "training_iteration": 1, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-35-03", "timestamp": 1569054903, "time_this_iter_s": 30.550490379333496, "time_total_s": 30.550490379333496, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36747a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 30.550490379333496, "timesteps_since_restore": 72960, "iterations_since_restore": 1, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 57.58146975718409, "episode_reward_min": 53.028529538683166, "episode_reward_mean": 55.10791891478578, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 27.87628033499764, "agent_1": 27.231638579788164}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6621129166574041, "mean_processing_ms": 3.5826512893920635, "mean_inference_ms": 2.0718081916937554}, "off_policy_estimator": {}, "info": {"min_exploration": 0.8599168, "max_exploration": 0.8599168, "num_target_updates": 4, "num_steps_trained": 231168, "num_steps_sampled": 170240, "sample_throughput": 0.0, "train_throughput": 12910.827, "num_weight_syncs": 331, "num_samples_dropped": 599, "learner_queue": {"size_count": 11244, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.721, "replay_time_ms": 105.295, "update_priorities_time_ms": 57.218, "policy_agent_0": {"added_count": 46336, "sampled_count": 62464, "est_size_bytes": 60377280, "num_entries": 46336}, "policy_agent_1": {"added_count": 46336, "sampled_count": 62464, "est_size_bytes": 60377280, "num_entries": 46336}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 2.139495372772217, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 2.0785560607910156, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 170240, "episodes_total": 1712, "training_iteration": 2, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-35-34", "timestamp": 1569054934, "time_this_iter_s": 30.512407302856445, "time_total_s": 61.06289768218994, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3675c048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 61.06289768218994, "timesteps_since_restore": 170240, "iterations_since_restore": 2, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 57.2376182899468, "episode_reward_min": 51.73673325780367, "episode_reward_mean": 53.95280500826806, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 27.04311480084993, "agent_1": 26.909690207418148}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6715473372913011, "mean_processing_ms": 3.581209113216525, "mean_inference_ms": 2.098469480596818}, "off_policy_estimator": {}, "info": {"min_exploration": 0.6731392, "max_exploration": 0.6731392, "num_target_updates": 7, "num_steps_trained": 382464, "num_steps_sampled": 266752, "sample_throughput": 5319.556, "train_throughput": 5319.556, "num_weight_syncs": 520, "num_samples_dropped": 599, "learner_queue": {"size_count": 11836, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.72, "replay_time_ms": 102.054, "update_priorities_time_ms": 55.735, "policy_agent_0": {"added_count": 70656, "sampled_count": 101632, "est_size_bytes": 92067052, "num_entries": 70656}, "policy_agent_1": {"added_count": 70656, "sampled_count": 101632, "est_size_bytes": 92067052, "num_entries": 70656}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.9632536172866821, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.900043249130249, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 266752, "episodes_total": 2664, "training_iteration": 3, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-36-04", "timestamp": 1569054964, "time_this_iter_s": 30.551060914993286, "time_total_s": 91.61395859718323, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366ea510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 91.61395859718323, "timesteps_since_restore": 266752, "iterations_since_restore": 3, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.16983509703967, "episode_reward_min": 50.94172314270262, "episode_reward_mean": 53.10056655758793, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.323910561743592, "agent_1": 26.776655995844358}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6745098373780437, "mean_processing_ms": 3.5767449678329033, "mean_inference_ms": 2.092340448519381}, "off_policy_estimator": {}, "info": {"min_exploration": 0.4878361600000001, "max_exploration": 0.4878361600000001, "num_target_updates": 10, "num_steps_trained": 528128, "num_steps_sampled": 364544, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 710, "num_samples_dropped": 599, "learner_queue": {"size_count": 12404, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.776, "replay_time_ms": 108.755, "update_priorities_time_ms": 50.519, "policy_agent_0": {"added_count": 100096, "sampled_count": 134656, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 100096, "sampled_count": 134656, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.786061406135559, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.720801591873169, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 364544, "episodes_total": 3648, "training_iteration": 4, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-36-35", "timestamp": 1569054995, "time_this_iter_s": 30.643155813217163, "time_total_s": 122.25711441040039, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366f5158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 122.25711441040039, "timesteps_since_restore": 364544, "iterations_since_restore": 4, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.33543081280377, "episode_reward_min": 48.0578828515445, "episode_reward_mean": 51.84635166496569, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.76692526298998, "agent_1": 26.079426401975734}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6747716286070713, "mean_processing_ms": 3.5791603414086164, "mean_inference_ms": 2.097113465825355}, "off_policy_estimator": {}, "info": {"min_exploration": 0.30007552000000004, "max_exploration": 0.30007552000000004, "num_target_updates": 13, "num_steps_trained": 674048, "num_steps_sampled": 460800, "sample_throughput": 0.0, "train_throughput": 20639.355, "num_weight_syncs": 899, "num_samples_dropped": 599, "learner_queue": {"size_count": 12974, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.71, "replay_time_ms": 93.082, "update_priorities_time_ms": 48.878, "policy_agent_0": {"added_count": 127232, "sampled_count": 169472, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 127232, "sampled_count": 169472, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.6162467002868652, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.5480414628982544, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 460800, "episodes_total": 4616, "training_iteration": 5, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-37-06", "timestamp": 1569055026, "time_this_iter_s": 30.514114379882812, "time_total_s": 152.7712287902832, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366ff620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 152.7712287902832, "timesteps_since_restore": 460800, "iterations_since_restore": 5, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.331621412869076, "episode_reward_min": 49.105196840997294, "episode_reward_mean": 51.54883671909399, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 25.93758301689927, "agent_1": 25.611253702194727}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6728663252967102, "mean_processing_ms": 3.575741197828769, "mean_inference_ms": 2.11667677711974}, "off_policy_estimator": {}, "info": {"min_exploration": 0.11526400000000003, "max_exploration": 0.11526400000000003, "num_target_updates": 16, "num_steps_trained": 819968, "num_steps_sampled": 557824, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1088, "num_samples_dropped": 599, "learner_queue": {"size_count": 13544, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.923, "replay_time_ms": 104.389, "update_priorities_time_ms": 52.966, "policy_agent_0": {"added_count": 149248, "sampled_count": 207360, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 149248, "sampled_count": 207360, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.4601471424102783, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.3924565315246582, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 557824, "episodes_total": 5592, "training_iteration": 6, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-37-36", "timestamp": 1569055056, "time_this_iter_s": 30.619824171066284, "time_total_s": 183.3910529613495, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3670a268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 183.3910529613495, "timesteps_since_restore": 557824, "iterations_since_restore": 6, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.69062881254369, "episode_reward_min": 46.53140502773569, "episode_reward_mean": 51.326200802450664, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.52721546299292, "agent_1": 25.798985339457786}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6733705448105222, "mean_processing_ms": 3.564001148062368, "mean_inference_ms": 2.108773555115547}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 19, "num_steps_trained": 964096, "num_steps_sampled": 655616, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1279, "num_samples_dropped": 599, "learner_queue": {"size_count": 14109, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.12, "replay_time_ms": 118.211, "update_priorities_time_ms": 56.771, "policy_agent_0": {"added_count": 175872, "sampled_count": 244224, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 175872, "sampled_count": 244224, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.3172848224639893, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.2504639625549316, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 655616, "episodes_total": 6560, "training_iteration": 7, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-38-07", "timestamp": 1569055087, "time_this_iter_s": 30.645171880722046, "time_total_s": 214.03622484207153, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3670c730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 214.03622484207153, "timesteps_since_restore": 655616, "iterations_since_restore": 7, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.31625644562023, "episode_reward_min": 50.314085654726384, "episode_reward_mean": 52.56893298384568, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 26.265473819279013, "agent_1": 26.30345916456684}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6761604400207476, "mean_processing_ms": 3.5718316745128074, "mean_inference_ms": 2.110554032331359}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 22, "num_steps_trained": 1110272, "num_steps_sampled": 751872, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1468, "num_samples_dropped": 599, "learner_queue": {"size_count": 14678, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.755, "replay_time_ms": 99.934, "update_priorities_time_ms": 53.108, "policy_agent_0": {"added_count": 200192, "sampled_count": 281344, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 200192, "sampled_count": 281344, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.1893328428268433, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.115365743637085, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 751872, "episodes_total": 7528, "training_iteration": 8, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-38-38", "timestamp": 1569055118, "time_this_iter_s": 30.52435851097107, "time_total_s": 244.5605833530426, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3671e378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 244.5605833530426, "timesteps_since_restore": 751872, "iterations_since_restore": 8, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.25321561687484, "episode_reward_min": 50.70523924981311, "episode_reward_mean": 52.6373665882347, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 26.09200712604694, "agent_1": 26.545359462187964}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6813152184137375, "mean_processing_ms": 3.578762447818789, "mean_inference_ms": 2.1105972371762496}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 25, "num_steps_trained": 1256192, "num_steps_sampled": 847360, "sample_throughput": 7103.957, "train_throughput": 0.0, "num_weight_syncs": 1654, "num_samples_dropped": 599, "learner_queue": {"size_count": 15249, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.624, "replay_time_ms": 104.777, "update_priorities_time_ms": 51.279, "policy_agent_0": {"added_count": 222464, "sampled_count": 315392, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 222464, "sampled_count": 315392, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.0721869468688965, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.000433087348938, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 847360, "episodes_total": 8480, "training_iteration": 9, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-39-08", "timestamp": 1569055148, "time_this_iter_s": 30.63561987876892, "time_total_s": 275.1962032318115, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366a7840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 275.1962032318115, "timesteps_since_restore": 847360, "iterations_since_restore": 9, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.2100894611047, "episode_reward_min": 50.30960597045743, "episode_reward_mean": 52.16398645346562, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 25.60726320535568, "agent_1": 26.5567232481101}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6793040234950507, "mean_processing_ms": 3.5744464140261654, "mean_inference_ms": 2.1084452589587}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 27, "num_steps_trained": 1400576, "num_steps_sampled": 945152, "sample_throughput": 7659.955, "train_throughput": 7659.955, "num_weight_syncs": 1845, "num_samples_dropped": 599, "learner_queue": {"size_count": 15812, "size_mean": 0.1, "size_std": 0.36055512754639896, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.794, "replay_time_ms": 91.293, "update_priorities_time_ms": 48.204, "policy_agent_0": {"added_count": 250880, "sampled_count": 350208, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 250880, "sampled_count": 350208, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.000938057899475, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.9275635480880737, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 945152, "episodes_total": 9456, "training_iteration": 10, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-39-39", "timestamp": 1569055179, "time_this_iter_s": 30.517761707305908, "time_total_s": 305.71396493911743, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366b4488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 305.71396493911743, "timesteps_since_restore": 945152, "iterations_since_restore": 10, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.194514626180215, "episode_reward_min": 50.112941161259194, "episode_reward_mean": 51.5115338267544, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 24.880417821955007, "agent_1": 26.631116004799523}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6797541922030975, "mean_processing_ms": 3.581471424500828, "mean_inference_ms": 2.1138496571800847}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 30, "num_steps_trained": 1547008, "num_steps_sampled": 1040640, "sample_throughput": 15982.582, "train_throughput": 0.0, "num_weight_syncs": 2032, "num_samples_dropped": 599, "learner_queue": {"size_count": 16385, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.19, "replay_time_ms": 112.25, "update_priorities_time_ms": 55.264, "policy_agent_0": {"added_count": 275968, "sampled_count": 386816, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 275968, "sampled_count": 386816, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.9159955978393555, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8303719162940979, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 1040640, "episodes_total": 10416, "training_iteration": 11, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-40-09", "timestamp": 1569055209, "time_this_iter_s": 30.648274183273315, "time_total_s": 336.36223912239075, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366bb950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 336.36223912239075, "timesteps_since_restore": 1040640, "iterations_since_restore": 11, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.16710200023152, "episode_reward_min": 47.91000129586947, "episode_reward_mean": 51.39861152462984, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 24.83740297741431, "agent_1": 26.56120854721565}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6796418052270561, "mean_processing_ms": 3.5806015045054327, "mean_inference_ms": 2.1166897070835593}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 33, "num_steps_trained": 1694208, "num_steps_sampled": 1135872, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2218, "num_samples_dropped": 599, "learner_queue": {"size_count": 16959, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.272, "replay_time_ms": 123.917, "update_priorities_time_ms": 61.507, "policy_agent_0": {"added_count": 298496, "sampled_count": 423680, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 298496, "sampled_count": 423680, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8535380363464355, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7523111701011658, "model": {}}}}, "timesteps_this_iter": 95232, "done": false, "timesteps_total": 1135872, "episodes_total": 11368, "training_iteration": 12, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-40-40", "timestamp": 1569055240, "time_this_iter_s": 30.563347101211548, "time_total_s": 366.9255862236023, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366cb598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 366.9255862236023, "timesteps_since_restore": 1135872, "iterations_since_restore": 12, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.31958730165139, "episode_reward_min": 50.254959767370096, "episode_reward_mean": 52.577128305067816, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 25.404641533704073, "agent_1": 27.172486771363804}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6817294689782897, "mean_processing_ms": 3.584719719525393, "mean_inference_ms": 2.1120658517415327}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 36, "num_steps_trained": 1837824, "num_steps_sampled": 1231872, "sample_throughput": 0.0, "train_throughput": 9979.941, "num_weight_syncs": 2405, "num_samples_dropped": 599, "learner_queue": {"size_count": 17520, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.882, "replay_time_ms": 116.075, "update_priorities_time_ms": 55.827, "policy_agent_0": {"added_count": 318976, "sampled_count": 460800, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 318976, "sampled_count": 460800, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8007746934890747, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.681114912033081, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 1231872, "episodes_total": 12328, "training_iteration": 13, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-41-11", "timestamp": 1569055271, "time_this_iter_s": 30.65805721282959, "time_total_s": 397.5836434364319, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366d3a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 397.5836434364319, "timesteps_since_restore": 1231872, "iterations_since_restore": 13, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.33620207175516, "episode_reward_min": 51.331811539598114, "episode_reward_mean": 53.65804725358555, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 25.571769290988257, "agent_1": 28.08627796259725}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6811403053108694, "mean_processing_ms": 3.5787372769287753, "mean_inference_ms": 2.105310996711333}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 39, "num_steps_trained": 1977344, "num_steps_sampled": 1330432, "sample_throughput": 6863.163, "train_throughput": 0.0, "num_weight_syncs": 2597, "num_samples_dropped": 599, "learner_queue": {"size_count": 18066, "size_mean": 0.1, "size_std": 0.3605551275463989, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 42.019, "replay_time_ms": 108.563, "update_priorities_time_ms": 48.515, "policy_agent_0": {"added_count": 345088, "sampled_count": 494080, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 345088, "sampled_count": 494080, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7394691705703735, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6210190057754517, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 1330432, "episodes_total": 13304, "training_iteration": 14, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-41-41", "timestamp": 1569055301, "time_this_iter_s": 30.63060688972473, "time_total_s": 428.2142503261566, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366a79d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 428.2142503261566, "timesteps_since_restore": 1330432, "iterations_since_restore": 14, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.36543996751701, "episode_reward_min": 53.16552208816577, "episode_reward_mean": 53.94674171847957, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 25.775179661546332, "agent_1": 28.17156205693317}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6799795919479665, "mean_processing_ms": 3.576493075513598, "mean_inference_ms": 2.1106346995319316}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 42, "num_steps_trained": 2121984, "num_steps_sampled": 1427712, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2788, "num_samples_dropped": 599, "learner_queue": {"size_count": 18630, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.789, "replay_time_ms": 117.084, "update_priorities_time_ms": 62.248, "policy_agent_0": {"added_count": 368384, "sampled_count": 530176, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 368384, "sampled_count": 530176, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6828569173812866, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5654750466346741, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 1427712, "episodes_total": 14280, "training_iteration": 15, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-42-12", "timestamp": 1569055332, "time_this_iter_s": 30.666130542755127, "time_total_s": 458.88038086891174, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3672cc80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 458.88038086891174, "timesteps_since_restore": 1427712, "iterations_since_restore": 15, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.33027651257977, "episode_reward_min": 51.862735921376746, "episode_reward_mean": 53.81185327420539, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.63691813251846, "agent_1": 28.17493514168687}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6792844173962702, "mean_processing_ms": 3.574362027920262, "mean_inference_ms": 2.1108201751391076}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 45, "num_steps_trained": 2263296, "num_steps_sampled": 1526272, "sample_throughput": 6168.537, "train_throughput": 3084.269, "num_weight_syncs": 2980, "num_samples_dropped": 599, "learner_queue": {"size_count": 19183, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.929, "replay_time_ms": 112.812, "update_priorities_time_ms": 53.164, "policy_agent_0": {"added_count": 393984, "sampled_count": 564992, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 393984, "sampled_count": 564992, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.642158567905426, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5088592171669006, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 1526272, "episodes_total": 15272, "training_iteration": 16, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-42-43", "timestamp": 1569055363, "time_this_iter_s": 30.616308450698853, "time_total_s": 489.4966893196106, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36f886a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 489.4966893196106, "timesteps_since_restore": 1526272, "iterations_since_restore": 16, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.38510831638954, "episode_reward_min": 49.975054040416246, "episode_reward_mean": 52.83571625959009, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 24.75142206489013, "agent_1": 28.084294194699922}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6787353827593822, "mean_processing_ms": 3.5744799435728645, "mean_inference_ms": 2.111896332439143}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 47, "num_steps_trained": 2406144, "num_steps_sampled": 1623040, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3170, "num_samples_dropped": 599, "learner_queue": {"size_count": 19740, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.873, "replay_time_ms": 122.237, "update_priorities_time_ms": 56.848, "policy_agent_0": {"added_count": 419840, "sampled_count": 600576, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 419840, "sampled_count": 600576, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6233575344085693, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48168107867240906, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 1623040, "episodes_total": 16240, "training_iteration": 17, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-43-13", "timestamp": 1569055393, "time_this_iter_s": 30.633403539657593, "time_total_s": 520.1300928592682, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d367449d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 520.1300928592682, "timesteps_since_restore": 1623040, "iterations_since_restore": 17, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.32978995575828, "episode_reward_min": 50.49010987353005, "episode_reward_mean": 52.330110536434496, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 24.123031906322588, "agent_1": 28.207078630111898}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6787030506700822, "mean_processing_ms": 3.579815959822811, "mean_inference_ms": 2.113734651535962}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 50, "num_steps_trained": 2552064, "num_steps_sampled": 1718016, "sample_throughput": 0.0, "train_throughput": 13553.752, "num_weight_syncs": 3354, "num_samples_dropped": 599, "learner_queue": {"size_count": 20310, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.915, "replay_time_ms": 118.758, "update_priorities_time_ms": 57.511, "policy_agent_0": {"added_count": 443392, "sampled_count": 637696, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 443392, "sampled_count": 637696, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6366446018218994, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4540480077266693, "model": {}}}}, "timesteps_this_iter": 94976, "done": false, "timesteps_total": 1718016, "episodes_total": 17192, "training_iteration": 18, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-43-44", "timestamp": 1569055424, "time_this_iter_s": 30.65418553352356, "time_total_s": 550.7842783927917, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36f7f620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 550.7842783927917, "timesteps_since_restore": 1718016, "iterations_since_restore": 18, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.53116413608598, "episode_reward_min": 50.37526442995428, "episode_reward_mean": 52.42869326244419, "episode_len_mean": 100.0, "episodes_this_iter": 928, "policy_reward_mean": {"agent_0": 23.97528721718274, "agent_1": 28.453406045261463}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6790190011211269, "mean_processing_ms": 3.585837354189102, "mean_inference_ms": 2.1187576841628695}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 53, "num_steps_trained": 2699008, "num_steps_sampled": 1811456, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3536, "num_samples_dropped": 599, "learner_queue": {"size_count": 20884, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.927, "replay_time_ms": 140.13, "update_priorities_time_ms": 66.918, "policy_agent_0": {"added_count": 468224, "sampled_count": 674560, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 468224, "sampled_count": 674560, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6481058597564697, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4525304436683655, "model": {}}}}, "timesteps_this_iter": 93440, "done": false, "timesteps_total": 1811456, "episodes_total": 18120, "training_iteration": 19, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-44-15", "timestamp": 1569055455, "time_this_iter_s": 30.592875003814697, "time_total_s": 581.3771533966064, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3673eae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 581.3771533966064, "timesteps_since_restore": 1811456, "iterations_since_restore": 19, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.893093823475276, "episode_reward_min": 48.52651338208013, "episode_reward_mean": 51.65244587054195, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 22.683653452099904, "agent_1": 28.968792418442053}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6809155872602473, "mean_processing_ms": 3.5893621152282273, "mean_inference_ms": 2.1210825085779677}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 56, "num_steps_trained": 2846464, "num_steps_sampled": 1905664, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3720, "num_samples_dropped": 599, "learner_queue": {"size_count": 21460, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.782, "replay_time_ms": 113.95, "update_priorities_time_ms": 59.561, "policy_agent_0": {"added_count": 493056, "sampled_count": 711680, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 493056, "sampled_count": 711680, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6749247312545776, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43549516797065735, "model": {}}}}, "timesteps_this_iter": 94208, "done": false, "timesteps_total": 1905664, "episodes_total": 19072, "training_iteration": 20, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-44-45", "timestamp": 1569055485, "time_this_iter_s": 30.592368841171265, "time_total_s": 611.9695222377777, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36737730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 611.9695222377777, "timesteps_since_restore": 1905664, "iterations_since_restore": 20, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.49238233147651, "episode_reward_min": 45.614575203493594, "episode_reward_mean": 51.592110367649596, "episode_len_mean": 100.0, "episodes_this_iter": 936, "policy_reward_mean": {"agent_0": 23.242657886791754, "agent_1": 28.349452480857884}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6813566620765171, "mean_processing_ms": 3.5946297840594332, "mean_inference_ms": 2.122659556555745}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 59, "num_steps_trained": 2992128, "num_steps_sampled": 2000384, "sample_throughput": 0.0, "train_throughput": 15669.116, "num_weight_syncs": 3905, "num_samples_dropped": 599, "learner_queue": {"size_count": 22029, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.652, "replay_time_ms": 118.502, "update_priorities_time_ms": 55.991, "policy_agent_0": {"added_count": 517120, "sampled_count": 749056, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 517120, "sampled_count": 749056, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7098195552825928, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42350906133651733, "model": {}}}}, "timesteps_this_iter": 94720, "done": false, "timesteps_total": 2000384, "episodes_total": 20008, "training_iteration": 21, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-45-16", "timestamp": 1569055516, "time_this_iter_s": 30.604997634887695, "time_total_s": 642.5745198726654, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36757598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 642.5745198726654, "timesteps_since_restore": 2000384, "iterations_since_restore": 21, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 50.05615300249048, "episode_reward_min": 44.994868942582784, "episode_reward_mean": 46.934790672799465, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 23.58983998179339, "agent_1": 23.344950691006005}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6797539481114339, "mean_processing_ms": 3.589162312402892, "mean_inference_ms": 2.1210899053452397}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 62, "num_steps_trained": 3135232, "num_steps_sampled": 2097408, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4095, "num_samples_dropped": 599, "learner_queue": {"size_count": 22588, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.345, "replay_time_ms": 116.55, "update_priorities_time_ms": 60.512, "policy_agent_0": {"added_count": 539904, "sampled_count": 784896, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 539904, "sampled_count": 784896, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7329797148704529, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46646466851234436, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 2097408, "episodes_total": 20984, "training_iteration": 22, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-45-47", "timestamp": 1569055547, "time_this_iter_s": 30.53619074821472, "time_total_s": 673.1107106208801, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366bc8c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 673.1107106208801, "timesteps_since_restore": 2097408, "iterations_since_restore": 22, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.71355974023646, "episode_reward_min": 46.419880010220275, "episode_reward_mean": 49.624361938324604, "episode_len_mean": 100.0, "episodes_this_iter": 920, "policy_reward_mean": {"agent_0": 25.373391322027086, "agent_1": 24.25097061629745}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6802569390468702, "mean_processing_ms": 3.5959087047384153, "mean_inference_ms": 2.1251527036735514}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 65, "num_steps_trained": 3276032, "num_steps_sampled": 2190080, "sample_throughput": 0.0, "train_throughput": 14373.092, "num_weight_syncs": 4277, "num_samples_dropped": 599, "learner_queue": {"size_count": 23138, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.722, "replay_time_ms": 116.184, "update_priorities_time_ms": 56.766, "policy_agent_0": {"added_count": 560384, "sampled_count": 820224, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 560384, "sampled_count": 820224, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7282447218894958, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5376285314559937, "model": {}}}}, "timesteps_this_iter": 92672, "done": false, "timesteps_total": 2190080, "episodes_total": 21904, "training_iteration": 23, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-46-17", "timestamp": 1569055577, "time_this_iter_s": 30.579429149627686, "time_total_s": 703.6901397705078, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366fbd90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 703.6901397705078, "timesteps_since_restore": 2190080, "iterations_since_restore": 23, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 50.442037739655206, "episode_reward_min": 42.726628534126306, "episode_reward_mean": 48.60867926092167, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 24.522675564655295, "agent_1": 24.08600369626633}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6805896666561484, "mean_processing_ms": 3.596527166543259, "mean_inference_ms": 2.124211589402842}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 68, "num_steps_trained": 3422464, "num_steps_sampled": 2285056, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4462, "num_samples_dropped": 599, "learner_queue": {"size_count": 23711, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.826, "replay_time_ms": 119.226, "update_priorities_time_ms": 64.212, "policy_agent_0": {"added_count": 587776, "sampled_count": 854528, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 587776, "sampled_count": 854528, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7265428900718689, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5946031808853149, "model": {}}}}, "timesteps_this_iter": 94976, "done": false, "timesteps_total": 2285056, "episodes_total": 22856, "training_iteration": 24, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-46-48", "timestamp": 1569055608, "time_this_iter_s": 30.655308961868286, "time_total_s": 734.3454487323761, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366ee9d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 734.3454487323761, "timesteps_since_restore": 2285056, "iterations_since_restore": 24, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 50.61243155030634, "episode_reward_min": 46.43829864738381, "episode_reward_mean": 48.82623211702678, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 24.372349371206408, "agent_1": 24.453882745820287}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6795239111331783, "mean_processing_ms": 3.5937285569569983, "mean_inference_ms": 2.1219646176954905}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 70, "num_steps_trained": 3561984, "num_steps_sampled": 2382080, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4651, "num_samples_dropped": 599, "learner_queue": {"size_count": 24256, "size_mean": 1.94, "size_std": 3.107474859109885, "size_quantiles": [0.0, 0.0, 0.0, 7.100000000000001, 11.0]}, "replay_shard_0": {"add_batch_time_ms": 41.904, "replay_time_ms": 120.707, "update_priorities_time_ms": 58.912, "policy_agent_0": {"added_count": 609792, "sampled_count": 887296, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 609792, "sampled_count": 887296, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7014753818511963, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5892114043235779, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 2382080, "episodes_total": 23824, "training_iteration": 25, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-47-18", "timestamp": 1569055638, "time_this_iter_s": 30.477805852890015, "time_total_s": 764.8232545852661, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366e8ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 764.8232545852661, "timesteps_since_restore": 2382080, "iterations_since_restore": 25, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.446275153198265, "episode_reward_min": 46.89374523358472, "episode_reward_mean": 47.993066277610204, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 24.20220216978701, "agent_1": 23.790864107823094}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6794986231225718, "mean_processing_ms": 3.594266930264186, "mean_inference_ms": 2.122265214548934}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 73, "num_steps_trained": 3702272, "num_steps_sampled": 2478336, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4840, "num_samples_dropped": 599, "learner_queue": {"size_count": 24803, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.95, "replay_time_ms": 110.462, "update_priorities_time_ms": 58.462, "policy_agent_0": {"added_count": 633088, "sampled_count": 922880, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 633088, "sampled_count": 922880, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.693601667881012, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6022167801856995, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 2478336, "episodes_total": 24784, "training_iteration": 26, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-47-49", "timestamp": 1569055669, "time_this_iter_s": 30.490431785583496, "time_total_s": 795.3136863708496, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36669ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 795.3136863708496, "timesteps_since_restore": 2478336, "iterations_since_restore": 26, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 52.16304757068482, "episode_reward_min": 46.295420707693175, "episode_reward_mean": 48.24841399851842, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 24.2068053305203, "agent_1": 24.04160866799807}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6789697882239033, "mean_processing_ms": 3.5952335368063073, "mean_inference_ms": 2.1216458084737506}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 76, "num_steps_trained": 3844352, "num_steps_sampled": 2575104, "sample_throughput": 9779.515, "train_throughput": 3259.838, "num_weight_syncs": 5029, "num_samples_dropped": 599, "learner_queue": {"size_count": 25358, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.771, "replay_time_ms": 101.378, "update_priorities_time_ms": 42.897, "policy_agent_0": {"added_count": 653312, "sampled_count": 959744, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 653312, "sampled_count": 959744, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6929628849029541, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6309234499931335, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 2575104, "episodes_total": 25760, "training_iteration": 27, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-48-19", "timestamp": 1569055699, "time_this_iter_s": 30.564985275268555, "time_total_s": 825.8786716461182, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36677048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 825.8786716461182, "timesteps_since_restore": 2575104, "iterations_since_restore": 27, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 51.473369598052535, "episode_reward_min": 47.11104984560424, "episode_reward_mean": 48.420376643452364, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 24.3805471804808, "agent_1": 24.03982946297152}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.678859356887156, "mean_processing_ms": 3.596938446057593, "mean_inference_ms": 2.1232580563640564}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 79, "num_steps_trained": 3989504, "num_steps_sampled": 2670848, "sample_throughput": 0.0, "train_throughput": 25760.324, "num_weight_syncs": 5215, "num_samples_dropped": 599, "learner_queue": {"size_count": 25926, "size_mean": 0.34, "size_std": 0.6514598989960932, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 34.565, "replay_time_ms": 116.084, "update_priorities_time_ms": 58.871, "policy_agent_0": {"added_count": 675840, "sampled_count": 995072, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 675840, "sampled_count": 995072, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7012877464294434, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6584030389785767, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 2670848, "episodes_total": 26712, "training_iteration": 28, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-48-50", "timestamp": 1569055730, "time_this_iter_s": 30.667207717895508, "time_total_s": 856.5458793640137, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36677bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 856.5458793640137, "timesteps_since_restore": 2670848, "iterations_since_restore": 28, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.942986069891205, "episode_reward_min": 45.12063434225381, "episode_reward_mean": 47.74766572577923, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 23.79271990336354, "agent_1": 23.954945822415656}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6781132896650062, "mean_processing_ms": 3.595343021411985, "mean_inference_ms": 2.1229263758712373}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 82, "num_steps_trained": 4132096, "num_steps_sampled": 2768128, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5405, "num_samples_dropped": 599, "learner_queue": {"size_count": 26482, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.025, "replay_time_ms": 106.852, "update_priorities_time_ms": 51.539, "policy_agent_0": {"added_count": 698880, "sampled_count": 1028608, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 698880, "sampled_count": 1028608, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6990929841995239, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6773641109466553, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 2768128, "episodes_total": 27688, "training_iteration": 29, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-49-21", "timestamp": 1569055761, "time_this_iter_s": 30.580320596694946, "time_total_s": 887.1261999607086, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3668d158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 887.1261999607086, "timesteps_since_restore": 2768128, "iterations_since_restore": 29, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.10390696315229, "episode_reward_min": 44.103892076660784, "episode_reward_mean": 47.2630757878561, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 23.91327702657744, "agent_1": 23.34979876127865}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.677819247337252, "mean_processing_ms": 3.5936635612790306, "mean_inference_ms": 2.1236987823434426}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 85, "num_steps_trained": 4276224, "num_steps_sampled": 2864384, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5594, "num_samples_dropped": 599, "learner_queue": {"size_count": 27045, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.998, "replay_time_ms": 111.071, "update_priorities_time_ms": 54.385, "policy_agent_0": {"added_count": 722944, "sampled_count": 1066496, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 722944, "sampled_count": 1066496, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7077299356460571, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6953390836715698, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 2864384, "episodes_total": 28640, "training_iteration": 30, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-49-51", "timestamp": 1569055791, "time_this_iter_s": 30.552746057510376, "time_total_s": 917.678946018219, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3668dd08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 917.678946018219, "timesteps_since_restore": 2864384, "iterations_since_restore": 30, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.15431536935796, "episode_reward_min": 45.69904588294191, "episode_reward_mean": 47.191813101702486, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 24.10196398062114, "agent_1": 23.089849121081347}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6769835548685601, "mean_processing_ms": 3.5918704495725726, "mean_inference_ms": 2.123403339901065}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 88, "num_steps_trained": 4418560, "num_steps_sampled": 2960896, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5782, "num_samples_dropped": 599, "learner_queue": {"size_count": 27601, "size_mean": 0.22, "size_std": 0.45999999999999996, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.947, "replay_time_ms": 104.679, "update_priorities_time_ms": 56.763, "policy_agent_0": {"added_count": 745728, "sampled_count": 1104128, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 745728, "sampled_count": 1104128, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7145222425460815, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7172784805297852, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 2960896, "episodes_total": 29616, "training_iteration": 31, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-50-22", "timestamp": 1569055822, "time_this_iter_s": 30.496309518814087, "time_total_s": 948.1752555370331, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3669e268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 948.1752555370331, "timesteps_since_restore": 2960896, "iterations_since_restore": 31, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 50.68415703251018, "episode_reward_min": 44.51859182937225, "episode_reward_mean": 46.42618278168492, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 22.737080944702956, "agent_1": 23.689101836981955}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6782799972952558, "mean_processing_ms": 3.594422273611383, "mean_inference_ms": 2.122426729177311}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 90, "num_steps_trained": 4559616, "num_steps_sampled": 3056640, "sample_throughput": 6663.41, "train_throughput": 6663.41, "num_weight_syncs": 5970, "num_samples_dropped": 599, "learner_queue": {"size_count": 28152, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.895, "replay_time_ms": 103.597, "update_priorities_time_ms": 54.512, "policy_agent_0": {"added_count": 768256, "sampled_count": 1140224, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 768256, "sampled_count": 1140224, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.731585681438446, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7212196588516235, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 3056640, "episodes_total": 30568, "training_iteration": 32, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-50-53", "timestamp": 1569055853, "time_this_iter_s": 30.598357439041138, "time_total_s": 978.7736129760742, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3669ee18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 978.7736129760742, "timesteps_since_restore": 3056640, "iterations_since_restore": 32, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 52.35074494616944, "episode_reward_min": 43.81161289634032, "episode_reward_mean": 46.183197338721314, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 22.36570445556074, "agent_1": 23.817492883160565}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6779015120462333, "mean_processing_ms": 3.596452771755213, "mean_inference_ms": 2.1240910653142655}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 93, "num_steps_trained": 4702976, "num_steps_sampled": 3152640, "sample_throughput": 7156.275, "train_throughput": 0.0, "num_weight_syncs": 6156, "num_samples_dropped": 599, "learner_queue": {"size_count": 28712, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.354, "replay_time_ms": 108.925, "update_priorities_time_ms": 52.886, "policy_agent_0": {"added_count": 791808, "sampled_count": 1177344, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 791808, "sampled_count": 1177344, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7510938048362732, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7365472912788391, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 3152640, "episodes_total": 31528, "training_iteration": 33, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-51-23", "timestamp": 1569055883, "time_this_iter_s": 30.604846954345703, "time_total_s": 1009.3784599304199, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3663c378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1009.3784599304199, "timesteps_since_restore": 3152640, "iterations_since_restore": 33, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.11574546528433, "episode_reward_min": 44.44002068440237, "episode_reward_mean": 50.43353089433097, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.337218765069448, "agent_1": 24.096312129261573}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6776502665742826, "mean_processing_ms": 3.5959695165618255, "mean_inference_ms": 2.1219152894369615}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 96, "num_steps_trained": 4844544, "num_steps_sampled": 3249152, "sample_throughput": 7977.339, "train_throughput": 0.0, "num_weight_syncs": 6345, "num_samples_dropped": 599, "learner_queue": {"size_count": 29266, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.597, "replay_time_ms": 126.223, "update_priorities_time_ms": 64.192, "policy_agent_0": {"added_count": 816128, "sampled_count": 1211648, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 816128, "sampled_count": 1211648, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.745994508266449, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7377642393112183, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 3249152, "episodes_total": 32504, "training_iteration": 34, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-51-54", "timestamp": 1569055914, "time_this_iter_s": 30.622583150863647, "time_total_s": 1040.0010430812836, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3663cf28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1040.0010430812836, "timesteps_since_restore": 3249152, "iterations_since_restore": 34, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.738626629767474, "episode_reward_min": 52.10082217491706, "episode_reward_mean": 53.242506397160284, "episode_len_mean": 100.0, "episodes_this_iter": 936, "policy_reward_mean": {"agent_0": 27.983011416844537, "agent_1": 25.259494980315825}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6786466741764193, "mean_processing_ms": 3.601693410190021, "mean_inference_ms": 2.1233219857322663}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 99, "num_steps_trained": 4987904, "num_steps_sampled": 3343616, "sample_throughput": 0.0, "train_throughput": 13586.337, "num_weight_syncs": 6529, "num_samples_dropped": 599, "learner_queue": {"size_count": 29826, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.115, "replay_time_ms": 87.56, "update_priorities_time_ms": 42.192, "policy_agent_0": {"added_count": 836608, "sampled_count": 1248512, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 836608, "sampled_count": 1248512, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6915568709373474, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.716374397277832, "model": {}}}}, "timesteps_this_iter": 94464, "done": false, "timesteps_total": 3343616, "episodes_total": 33440, "training_iteration": 35, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-52-24", "timestamp": 1569055944, "time_this_iter_s": 30.573161840438843, "time_total_s": 1070.5742049217224, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36651488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1070.5742049217224, "timesteps_since_restore": 3343616, "iterations_since_restore": 35, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.92382410768733, "episode_reward_min": 52.42839365048934, "episode_reward_mean": 54.4958622676564, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.80122182330617, "agent_1": 25.694640444350238}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6794125225089461, "mean_processing_ms": 3.601305198691288, "mean_inference_ms": 2.1211284592234714}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 102, "num_steps_trained": 5128448, "num_steps_sampled": 3439872, "sample_throughput": 5016.665, "train_throughput": 5016.665, "num_weight_syncs": 6718, "num_samples_dropped": 599, "learner_queue": {"size_count": 30376, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.412, "replay_time_ms": 115.295, "update_priorities_time_ms": 61.125, "policy_agent_0": {"added_count": 860416, "sampled_count": 1283328, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 860416, "sampled_count": 1283328, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5982321500778198, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6881259083747864, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 3439872, "episodes_total": 34408, "training_iteration": 36, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-52-55", "timestamp": 1569055975, "time_this_iter_s": 30.673091650009155, "time_total_s": 1101.2472965717316, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3669e400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1101.2472965717316, "timesteps_since_restore": 3439872, "iterations_since_restore": 36, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.819564357895146, "episode_reward_min": 49.882505330837965, "episode_reward_mean": 54.24834915501807, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 27.999044454289024, "agent_1": 26.249304700729027}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6793502013600132, "mean_processing_ms": 3.5993981173681706, "mean_inference_ms": 2.1195664159635834}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 105, "num_steps_trained": 5273088, "num_steps_sampled": 3536384, "sample_throughput": 0.0, "train_throughput": 18611.947, "num_weight_syncs": 6906, "num_samples_dropped": 599, "learner_queue": {"size_count": 30940, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.627, "replay_time_ms": 96.749, "update_priorities_time_ms": 55.3, "policy_agent_0": {"added_count": 886528, "sampled_count": 1318400, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 886528, "sampled_count": 1318400, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5390790104866028, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6501518487930298, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 3536384, "episodes_total": 35376, "training_iteration": 37, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-53-26", "timestamp": 1569056006, "time_this_iter_s": 30.59859800338745, "time_total_s": 1131.845894575119, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3668dae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1131.845894575119, "timesteps_since_restore": 3536384, "iterations_since_restore": 37, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.58004352138479, "episode_reward_min": 47.84725903874229, "episode_reward_mean": 49.41476169883224, "episode_len_mean": 100.0, "episodes_this_iter": 928, "policy_reward_mean": {"agent_0": 22.540354780671773, "agent_1": 26.874406918160496}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6806151783129806, "mean_processing_ms": 3.60227445907822, "mean_inference_ms": 2.120008426005176}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 107, "num_steps_trained": 5419264, "num_steps_sampled": 3630848, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7090, "num_samples_dropped": 599, "learner_queue": {"size_count": 31510, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.173, "replay_time_ms": 109.094, "update_priorities_time_ms": 54.845, "policy_agent_0": {"added_count": 910336, "sampled_count": 1352960, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 910336, "sampled_count": 1352960, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5504937171936035, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6085845232009888, "model": {}}}}, "timesteps_this_iter": 94464, "done": false, "timesteps_total": 3630848, "episodes_total": 36304, "training_iteration": 38, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-53-56", "timestamp": 1569056036, "time_this_iter_s": 30.66800284385681, "time_total_s": 1162.5138974189758, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36737b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1162.5138974189758, "timesteps_since_restore": 3630848, "iterations_since_restore": 38, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.2712280056136, "episode_reward_min": 44.2346322900849, "episode_reward_mean": 51.315308329124264, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.687760691976944, "agent_1": 25.627547637147327}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6812672305666567, "mean_processing_ms": 3.604709130907937, "mean_inference_ms": 2.11963800253932}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 110, "num_steps_trained": 5560832, "num_steps_sampled": 3726592, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7278, "num_samples_dropped": 599, "learner_queue": {"size_count": 32063, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.497, "replay_time_ms": 117.754, "update_priorities_time_ms": 65.034, "policy_agent_0": {"added_count": 935936, "sampled_count": 1388800, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 935936, "sampled_count": 1388800, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5762360095977783, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5890390872955322, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 3726592, "episodes_total": 37272, "training_iteration": 39, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-54-27", "timestamp": 1569056067, "time_this_iter_s": 30.66016936302185, "time_total_s": 1193.1740667819977, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36744ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1193.1740667819977, "timesteps_since_restore": 3726592, "iterations_since_restore": 39, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.39372256500297, "episode_reward_min": 45.447399600952444, "episode_reward_mean": 48.8775455773457, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.83491774393514, "agent_1": 21.042627833410577}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6802483615324548, "mean_processing_ms": 3.601937051038906, "mean_inference_ms": 2.1188965678853213}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 113, "num_steps_trained": 5702144, "num_steps_sampled": 3824896, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7469, "num_samples_dropped": 599, "learner_queue": {"size_count": 32615, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.995, "replay_time_ms": 117.351, "update_priorities_time_ms": 54.707, "policy_agent_0": {"added_count": 961024, "sampled_count": 1424640, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 961024, "sampled_count": 1424640, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.583168625831604, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6220370531082153, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 3824896, "episodes_total": 38256, "training_iteration": 40, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-54-58", "timestamp": 1569056098, "time_this_iter_s": 30.504851818084717, "time_total_s": 1223.6789186000824, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366d3b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1223.6789186000824, "timesteps_since_restore": 3824896, "iterations_since_restore": 40, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.28095780647848, "episode_reward_min": 45.71021332789212, "episode_reward_mean": 48.36519905994293, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 26.484071418326646, "agent_1": 21.881127641616313}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6812608566948692, "mean_processing_ms": 3.603575397013455, "mean_inference_ms": 2.117663453369073}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 116, "num_steps_trained": 5847296, "num_steps_sampled": 3920896, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7657, "num_samples_dropped": 599, "learner_queue": {"size_count": 33182, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.025, "replay_time_ms": 107.597, "update_priorities_time_ms": 60.702, "policy_agent_0": {"added_count": 985088, "sampled_count": 1458688, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 985088, "sampled_count": 1458688, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5441887378692627, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6892893314361572, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 3920896, "episodes_total": 39216, "training_iteration": 41, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-55-28", "timestamp": 1569056128, "time_this_iter_s": 30.732548236846924, "time_total_s": 1254.4114668369293, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3672cb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1254.4114668369293, "timesteps_since_restore": 3920896, "iterations_since_restore": 41, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.85545789289479, "episode_reward_min": 46.48092775913913, "episode_reward_mean": 52.10430783944261, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 27.422322116082622, "agent_1": 24.68198572335997}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681458406606121, "mean_processing_ms": 3.6052330198850657, "mean_inference_ms": 2.117103030514446}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 119, "num_steps_trained": 5989120, "num_steps_sampled": 4017664, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7846, "num_samples_dropped": 599, "learner_queue": {"size_count": 33736, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.518, "replay_time_ms": 113.937, "update_priorities_time_ms": 54.296, "policy_agent_0": {"added_count": 1011200, "sampled_count": 1491968, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1011200, "sampled_count": 1491968, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5081321597099304, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7390133142471313, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 4017664, "episodes_total": 40184, "training_iteration": 42, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-55-59", "timestamp": 1569056159, "time_this_iter_s": 30.628846168518066, "time_total_s": 1285.0403130054474, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3671e8c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1285.0403130054474, "timesteps_since_restore": 4017664, "iterations_since_restore": 42, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.80792400363267, "episode_reward_min": 48.786017792755075, "episode_reward_mean": 54.492200315251075, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.20950246597696, "agent_1": 26.28269784927408}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6814083055172451, "mean_processing_ms": 3.605813756919199, "mean_inference_ms": 2.115840344899701}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 122, "num_steps_trained": 6132736, "num_steps_sampled": 4114176, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8034, "num_samples_dropped": 599, "learner_queue": {"size_count": 34297, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 45.543, "replay_time_ms": 127.404, "update_priorities_time_ms": 56.387, "policy_agent_0": {"added_count": 1036032, "sampled_count": 1526528, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1036032, "sampled_count": 1526528, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48377105593681335, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7060091495513916, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 4114176, "episodes_total": 41152, "training_iteration": 43, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-56-30", "timestamp": 1569056190, "time_this_iter_s": 30.601619720458984, "time_total_s": 1315.6419327259064, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366bb7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1315.6419327259064, "timesteps_since_restore": 4114176, "iterations_since_restore": 43, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.85271573933246, "episode_reward_min": 52.64010619703869, "episode_reward_mean": 54.810136449139236, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.31509981605979, "agent_1": 26.495036633079426}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6815068293585055, "mean_processing_ms": 3.6063524078121705, "mean_inference_ms": 2.1144714161142333}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 125, "num_steps_trained": 6273792, "num_steps_sampled": 4211712, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8225, "num_samples_dropped": 599, "learner_queue": {"size_count": 34848, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.014, "replay_time_ms": 107.807, "update_priorities_time_ms": 57.668, "policy_agent_0": {"added_count": 1056512, "sampled_count": 1562368, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1056512, "sampled_count": 1562368, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4433709383010864, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6558756828308105, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 4211712, "episodes_total": 42120, "training_iteration": 44, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-57-00", "timestamp": 1569056220, "time_this_iter_s": 30.51735830307007, "time_total_s": 1346.1592910289764, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36651a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1346.1592910289764, "timesteps_since_restore": 4211712, "iterations_since_restore": 44, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.739436309020476, "episode_reward_min": 46.5217556508838, "episode_reward_mean": 51.69583123909339, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 25.03234556341289, "agent_1": 26.663485675680395}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6812009217773362, "mean_processing_ms": 3.605994089215399, "mean_inference_ms": 2.11613901116132}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 127, "num_steps_trained": 6420480, "num_steps_sampled": 4307456, "sample_throughput": 4626.104, "train_throughput": 4626.104, "num_weight_syncs": 8412, "num_samples_dropped": 599, "learner_queue": {"size_count": 35421, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.39, "replay_time_ms": 118.038, "update_priorities_time_ms": 60.369, "policy_agent_0": {"added_count": 1080576, "sampled_count": 1596672, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1080576, "sampled_count": 1596672, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44985464215278625, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6084623336791992, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 4307456, "episodes_total": 43080, "training_iteration": 45, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-57-31", "timestamp": 1569056251, "time_this_iter_s": 30.660222053527832, "time_total_s": 1376.8195130825043, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36f7ff28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1376.8195130825043, "timesteps_since_restore": 4307456, "iterations_since_restore": 45, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.48259711318282, "episode_reward_min": 51.54970742946795, "episode_reward_mean": 53.67176350222271, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 25.878114654046776, "agent_1": 27.793648848175796}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.682338764733452, "mean_processing_ms": 3.6105357009159307, "mean_inference_ms": 2.116525729020363}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 130, "num_steps_trained": 6565376, "num_steps_sampled": 4403200, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8600, "num_samples_dropped": 599, "learner_queue": {"size_count": 35987, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.959, "replay_time_ms": 105.641, "update_priorities_time_ms": 54.931, "policy_agent_0": {"added_count": 1102336, "sampled_count": 1630720, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1102336, "sampled_count": 1630720, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44912731647491455, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5685616135597229, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 4403200, "episodes_total": 44040, "training_iteration": 46, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-58-02", "timestamp": 1569056282, "time_this_iter_s": 30.643354892730713, "time_total_s": 1407.462867975235, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3675cb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1407.462867975235, "timesteps_since_restore": 4403200, "iterations_since_restore": 46, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.11355441068524, "episode_reward_min": 47.92943373634603, "episode_reward_mean": 51.81282735045888, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.747342986186897, "agent_1": 26.06548436427192}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6813659950971653, "mean_processing_ms": 3.60632873258897, "mean_inference_ms": 2.1159269069568802}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 133, "num_steps_trained": 6711296, "num_steps_sampled": 4499712, "sample_throughput": 0.0, "train_throughput": 14926.349, "num_weight_syncs": 8787, "num_samples_dropped": 599, "learner_queue": {"size_count": 36557, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.709, "replay_time_ms": 112.46, "update_priorities_time_ms": 54.867, "policy_agent_0": {"added_count": 1125376, "sampled_count": 1665280, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1125376, "sampled_count": 1665280, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48136451840400696, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5369285941123962, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 4499712, "episodes_total": 45008, "training_iteration": 47, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-58-32", "timestamp": 1569056312, "time_this_iter_s": 30.59977436065674, "time_total_s": 1438.0626423358917, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366e10d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1438.0626423358917, "timesteps_since_restore": 4499712, "iterations_since_restore": 47, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.57464733246267, "episode_reward_min": 47.816594000864086, "episode_reward_mean": 50.70603136175315, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 25.565499120433824, "agent_1": 25.14053224131929}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6815057044664092, "mean_processing_ms": 3.6072732328529344, "mean_inference_ms": 2.117646126317323}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 136, "num_steps_trained": 6859008, "num_steps_sampled": 4595456, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8975, "num_samples_dropped": 599, "learner_queue": {"size_count": 37134, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.503, "replay_time_ms": 94.279, "update_priorities_time_ms": 45.34, "policy_agent_0": {"added_count": 1150464, "sampled_count": 1700864, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1150464, "sampled_count": 1700864, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47439903020858765, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5127771496772766, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 4595456, "episodes_total": 45952, "training_iteration": 48, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-59-03", "timestamp": 1569056343, "time_this_iter_s": 30.57513928413391, "time_total_s": 1468.6377816200256, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366e1c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1468.6377816200256, "timesteps_since_restore": 4595456, "iterations_since_restore": 48, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.97480888515692, "episode_reward_min": 49.23733474888272, "episode_reward_mean": 51.8505234284092, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.90227902804004, "agent_1": 25.94824440036909}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6817251611836943, "mean_processing_ms": 3.6071150332326396, "mean_inference_ms": 2.117895499427186}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 139, "num_steps_trained": 7005696, "num_steps_sampled": 4691712, "sample_throughput": 15638.535, "train_throughput": 0.0, "num_weight_syncs": 9162, "num_samples_dropped": 599, "learner_queue": {"size_count": 37707, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.329, "replay_time_ms": 97.625, "update_priorities_time_ms": 45.096, "policy_agent_0": {"added_count": 1172480, "sampled_count": 1735168, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1172480, "sampled_count": 1735168, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49608662724494934, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5245805978775024, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 4691712, "episodes_total": 46920, "training_iteration": 49, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_08-59-33", "timestamp": 1569056373, "time_this_iter_s": 30.565277338027954, "time_total_s": 1499.2030589580536, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366ed1e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1499.2030589580536, "timesteps_since_restore": 4691712, "iterations_since_restore": 49, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.95102826047273, "episode_reward_min": 49.7583324344114, "episode_reward_mean": 51.18938196853435, "episode_len_mean": 100.0, "episodes_this_iter": 936, "policy_reward_mean": {"agent_0": 25.637627036377495, "agent_1": 25.551754932156804}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6825084930388178, "mean_processing_ms": 3.6087294007204345, "mean_inference_ms": 2.1179457330798686}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 142, "num_steps_trained": 7153152, "num_steps_sampled": 4785664, "sample_throughput": 19203.452, "train_throughput": 0.0, "num_weight_syncs": 9346, "num_samples_dropped": 599, "learner_queue": {"size_count": 38284, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 48.262, "replay_time_ms": 109.124, "update_priorities_time_ms": 51.958, "policy_agent_0": {"added_count": 1193472, "sampled_count": 1773568, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1193472, "sampled_count": 1773568, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5027344226837158, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5313586592674255, "model": {}}}}, "timesteps_this_iter": 93952, "done": false, "timesteps_total": 4785664, "episodes_total": 47856, "training_iteration": 50, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-00-04", "timestamp": 1569056404, "time_this_iter_s": 30.64072322845459, "time_total_s": 1529.8437821865082, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366edd90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1529.8437821865082, "timesteps_since_restore": 4785664, "iterations_since_restore": 50, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.105954750799675, "episode_reward_min": 48.785536736926375, "episode_reward_mean": 51.595551066534284, "episode_len_mean": 100.0, "episodes_this_iter": 888, "policy_reward_mean": {"agent_0": 25.17008903364629, "agent_1": 26.42546203288794}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6826126997213449, "mean_processing_ms": 3.6138012916886195, "mean_inference_ms": 2.123099192099767}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 145, "num_steps_trained": 7293184, "num_steps_sampled": 4873472, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9518, "num_samples_dropped": 599, "learner_queue": {"size_count": 38830, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.792, "replay_time_ms": 95.244, "update_priorities_time_ms": 54.085, "policy_agent_0": {"added_count": 1215488, "sampled_count": 1808896, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1215488, "sampled_count": 1808896, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5116989612579346, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5055856108665466, "model": {}}}}, "timesteps_this_iter": 87808, "done": false, "timesteps_total": 4873472, "episodes_total": 48744, "training_iteration": 51, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-00-35", "timestamp": 1569056435, "time_this_iter_s": 30.585634469985962, "time_total_s": 1560.4294166564941, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366752f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1560.4294166564941, "timesteps_since_restore": 4873472, "iterations_since_restore": 51, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.95099491342114, "episode_reward_min": 48.69021723355906, "episode_reward_mean": 51.03146130356672, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 24.59298727141161, "agent_1": 26.438474032155035}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6821402422945064, "mean_processing_ms": 3.6139006864674985, "mean_inference_ms": 2.1227848034708034}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 148, "num_steps_trained": 7435008, "num_steps_sampled": 4971520, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9708, "num_samples_dropped": 599, "learner_queue": {"size_count": 39384, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.79, "replay_time_ms": 106.914, "update_priorities_time_ms": 58.088, "policy_agent_0": {"added_count": 1239040, "sampled_count": 1844736, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1239040, "sampled_count": 1844736, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5107540488243103, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5009017586708069, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 4971520, "episodes_total": 49720, "training_iteration": 52, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-01-05", "timestamp": 1569056465, "time_this_iter_s": 30.471015453338623, "time_total_s": 1590.9004321098328, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36675ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1590.9004321098328, "timesteps_since_restore": 4971520, "iterations_since_restore": 52, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.580107805408076, "episode_reward_min": 47.841587891937515, "episode_reward_mean": 49.8158477373899, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 23.220300109467274, "agent_1": 26.59554762792257}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6827281479005421, "mean_processing_ms": 3.612976892067728, "mean_inference_ms": 2.1235694271693326}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 151, "num_steps_trained": 7581696, "num_steps_sampled": 5065984, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9894, "num_samples_dropped": 599, "learner_queue": {"size_count": 39958, "size_mean": 0.12, "size_std": 0.3815756805667782, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.453, "replay_time_ms": 102.797, "update_priorities_time_ms": 52.527, "policy_agent_0": {"added_count": 1258752, "sampled_count": 1882368, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1258752, "sampled_count": 1882368, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5704382061958313, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4942883551120758, "model": {}}}}, "timesteps_this_iter": 94464, "done": false, "timesteps_total": 5065984, "episodes_total": 50672, "training_iteration": 53, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-01-36", "timestamp": 1569056496, "time_this_iter_s": 30.506006479263306, "time_total_s": 1621.406438589096, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36672400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1621.406438589096, "timesteps_since_restore": 5065984, "iterations_since_restore": 53, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.90018176021508, "episode_reward_min": 46.81087074200777, "episode_reward_mean": 50.408582958246065, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 23.879050026913568, "agent_1": 26.52953293133241}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6819644498928246, "mean_processing_ms": 3.609594024482709, "mean_inference_ms": 2.1228268543746474}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 153, "num_steps_trained": 7727360, "num_steps_sampled": 5163264, "sample_throughput": 6805.224, "train_throughput": 0.0, "num_weight_syncs": 10083, "num_samples_dropped": 599, "learner_queue": {"size_count": 40526, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.252, "replay_time_ms": 121.395, "update_priorities_time_ms": 57.064, "policy_agent_0": {"added_count": 1282048, "sampled_count": 1918464, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1282048, "sampled_count": 1918464, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6048583388328552, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4967591464519501, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 5163264, "episodes_total": 51640, "training_iteration": 54, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-02-06", "timestamp": 1569056526, "time_this_iter_s": 30.646852493286133, "time_total_s": 1652.0532910823822, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3664f048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1652.0532910823822, "timesteps_since_restore": 5163264, "iterations_since_restore": 54, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.583822496235825, "episode_reward_min": 47.300323942533105, "episode_reward_mean": 51.87157554909282, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 24.30538276582501, "agent_1": 27.56619278326785}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6816321583429267, "mean_processing_ms": 3.609364321444516, "mean_inference_ms": 2.1244977431856347}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 156, "num_steps_trained": 7875072, "num_steps_sampled": 5259776, "sample_throughput": 6495.087, "train_throughput": 0.0, "num_weight_syncs": 10272, "num_samples_dropped": 599, "learner_queue": {"size_count": 41103, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.962, "replay_time_ms": 104.179, "update_priorities_time_ms": 51.717, "policy_agent_0": {"added_count": 1306112, "sampled_count": 1954560, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1306112, "sampled_count": 1954560, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.639514684677124, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49874892830848694, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 5259776, "episodes_total": 52608, "training_iteration": 55, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-02-37", "timestamp": 1569056557, "time_this_iter_s": 30.54103374481201, "time_total_s": 1682.5943248271942, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36657510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1682.5943248271942, "timesteps_since_restore": 5259776, "iterations_since_restore": 55, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.22949467061357, "episode_reward_min": 49.08795933159526, "episode_reward_mean": 51.975902903638435, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 24.15768008721876, "agent_1": 27.818222816419738}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6826929312028028, "mean_processing_ms": 3.6118739125818897, "mean_inference_ms": 2.1239270293821995}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 159, "num_steps_trained": 8016128, "num_steps_sampled": 5357824, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10463, "num_samples_dropped": 599, "learner_queue": {"size_count": 41655, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.486, "replay_time_ms": 127.501, "update_priorities_time_ms": 63.225, "policy_agent_0": {"added_count": 1328640, "sampled_count": 1990144, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1328640, "sampled_count": 1990144, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6565337777137756, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47200506925582886, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 5357824, "episodes_total": 53592, "training_iteration": 56, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-03-08", "timestamp": 1569056588, "time_this_iter_s": 30.695162057876587, "time_total_s": 1713.2894868850708, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365ec158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1713.2894868850708, "timesteps_since_restore": 5357824, "iterations_since_restore": 56, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.41157754567572, "episode_reward_min": 49.87634197502457, "episode_reward_mean": 52.280417639497195, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 24.38626527784039, "agent_1": 27.894152361656854}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6834513527916775, "mean_processing_ms": 3.6111647839368337, "mean_inference_ms": 2.122725039711528}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 162, "num_steps_trained": 8159488, "num_steps_sampled": 5455360, "sample_throughput": 16976.29, "train_throughput": 0.0, "num_weight_syncs": 10654, "num_samples_dropped": 599, "learner_queue": {"size_count": 42215, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.234, "replay_time_ms": 134.484, "update_priorities_time_ms": 62.713, "policy_agent_0": {"added_count": 1351424, "sampled_count": 2024448, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1351424, "sampled_count": 2024448, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6632829308509827, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4553581476211548, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 5455360, "episodes_total": 54560, "training_iteration": 57, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-03-38", "timestamp": 1569056618, "time_this_iter_s": 30.69077754020691, "time_total_s": 1743.9802644252777, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365ef620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1743.9802644252777, "timesteps_since_restore": 5455360, "iterations_since_restore": 57, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 51.74591651750421, "episode_reward_min": 47.17812867586914, "episode_reward_mean": 48.40157886174021, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 24.711510136123064, "agent_1": 23.690068725617085}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828043965299002, "mean_processing_ms": 3.6096249131947356, "mean_inference_ms": 2.1217846290852007}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 165, "num_steps_trained": 8302592, "num_steps_sampled": 5552128, "sample_throughput": 8064.152, "train_throughput": 0.0, "num_weight_syncs": 10844, "num_samples_dropped": 599, "learner_queue": {"size_count": 42773, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.428, "replay_time_ms": 117.697, "update_priorities_time_ms": 49.948, "policy_agent_0": {"added_count": 1373952, "sampled_count": 2061568, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1373952, "sampled_count": 2061568, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6563042402267456, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49261927604675293, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 5552128, "episodes_total": 55520, "training_iteration": 58, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-04-09", "timestamp": 1569056649, "time_this_iter_s": 30.45487689971924, "time_total_s": 1774.435141324997, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365f7268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1774.435141324997, "timesteps_since_restore": 5552128, "iterations_since_restore": 58, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.853878494692914, "episode_reward_min": 47.09004021244566, "episode_reward_mean": 50.55166688487174, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.85873571167045, "agent_1": 24.692931173201266}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828002332595087, "mean_processing_ms": 3.608899516067241, "mean_inference_ms": 2.1217966904937797}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 168, "num_steps_trained": 8443136, "num_steps_sampled": 5650176, "sample_throughput": 8063.425, "train_throughput": 0.0, "num_weight_syncs": 11035, "num_samples_dropped": 599, "learner_queue": {"size_count": 43322, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.67, "replay_time_ms": 130.659, "update_priorities_time_ms": 64.872, "policy_agent_0": {"added_count": 1399552, "sampled_count": 2096384, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1399552, "sampled_count": 2096384, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6425250768661499, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5195392966270447, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 5650176, "episodes_total": 56512, "training_iteration": 59, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-04-40", "timestamp": 1569056680, "time_this_iter_s": 30.61490821838379, "time_total_s": 1805.0500495433807, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36609730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1805.0500495433807, "timesteps_since_restore": 5650176, "iterations_since_restore": 59, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 52.33296326366837, "episode_reward_min": 51.224012243041614, "episode_reward_mean": 51.900928222142284, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 27.381444658391107, "agent_1": 24.519483563751187}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6827701193795593, "mean_processing_ms": 3.609613475839885, "mean_inference_ms": 2.1211710111507114}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 171, "num_steps_trained": 8587264, "num_steps_sampled": 5747200, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11224, "num_samples_dropped": 599, "learner_queue": {"size_count": 43886, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.337, "replay_time_ms": 98.126, "update_priorities_time_ms": 57.279, "policy_agent_0": {"added_count": 1423104, "sampled_count": 2132736, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1423104, "sampled_count": 2132736, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5912576913833618, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5622140169143677, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 5747200, "episodes_total": 57480, "training_iteration": 60, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-05-10", "timestamp": 1569056710, "time_this_iter_s": 30.637747049331665, "time_total_s": 1835.6877965927124, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366576a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1835.6877965927124, "timesteps_since_restore": 5747200, "iterations_since_restore": 60, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 52.23738232302073, "episode_reward_min": 50.98514654089362, "episode_reward_mean": 51.734265099317994, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 27.137252043098364, "agent_1": 24.597013056219634}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828814051892537, "mean_processing_ms": 3.60857269837282, "mean_inference_ms": 2.120066470050542}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 173, "num_steps_trained": 8730368, "num_steps_sampled": 5843968, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11412, "num_samples_dropped": 599, "learner_queue": {"size_count": 44444, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.623, "replay_time_ms": 92.447, "update_priorities_time_ms": 50.438, "policy_agent_0": {"added_count": 1447424, "sampled_count": 2167808, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1447424, "sampled_count": 2167808, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5537593364715576, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5613492131233215, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 5843968, "episodes_total": 58440, "training_iteration": 61, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-05-41", "timestamp": 1569056741, "time_this_iter_s": 30.586543798446655, "time_total_s": 1866.274340391159, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36651ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1866.274340391159, "timesteps_since_restore": 5843968, "iterations_since_restore": 61, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 51.997030038665145, "episode_reward_min": 49.064415555276575, "episode_reward_mean": 51.46537838925666, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.59950501807094, "agent_1": 24.865873371185682}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6834531115172563, "mean_processing_ms": 3.612161875567598, "mean_inference_ms": 2.1209403664061637}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 176, "num_steps_trained": 8875008, "num_steps_sampled": 5940736, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11602, "num_samples_dropped": 599, "learner_queue": {"size_count": 45010, "size_mean": 1.56, "size_std": 2.9062690859588347, "size_quantiles": [0.0, 0.0, 0.0, 6.100000000000001, 11.0]}, "replay_shard_0": {"add_batch_time_ms": 37.759, "replay_time_ms": 106.338, "update_priorities_time_ms": 46.989, "policy_agent_0": {"added_count": 1469696, "sampled_count": 2201856, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1469696, "sampled_count": 2201856, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5094660520553589, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.57880699634552, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 5940736, "episodes_total": 59416, "training_iteration": 62, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-06-12", "timestamp": 1569056772, "time_this_iter_s": 30.64008092880249, "time_total_s": 1896.9144213199615, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366a7a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1896.9144213199615, "timesteps_since_restore": 5940736, "iterations_since_restore": 62, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 51.6690428938497, "episode_reward_min": 47.457242190871476, "episode_reward_mean": 48.585635734856965, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 23.446952137739764, "agent_1": 25.13868359711711}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.683436570315481, "mean_processing_ms": 3.610927096812473, "mean_inference_ms": 2.1215425886633317}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 179, "num_steps_trained": 9021440, "num_steps_sampled": 6034944, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11786, "num_samples_dropped": 599, "learner_queue": {"size_count": 45581, "size_mean": 0.2, "size_std": 0.48989794855663565, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.146, "replay_time_ms": 110.541, "update_priorities_time_ms": 51.528, "policy_agent_0": {"added_count": 1493760, "sampled_count": 2235392, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1493760, "sampled_count": 2235392, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5318825840950012, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5763370990753174, "model": {}}}}, "timesteps_this_iter": 94208, "done": false, "timesteps_total": 6034944, "episodes_total": 60360, "training_iteration": 63, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-06-42", "timestamp": 1569056802, "time_this_iter_s": 30.452120304107666, "time_total_s": 1927.3665416240692, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366a72f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1927.3665416240692, "timesteps_since_restore": 6034944, "iterations_since_restore": 63, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 51.003511242577545, "episode_reward_min": 46.691402842737894, "episode_reward_mean": 48.53107155580883, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 23.028278935607727, "agent_1": 25.502792620201028}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6827197044610805, "mean_processing_ms": 3.606717837480464, "mean_inference_ms": 2.1206127801683885}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 182, "num_steps_trained": 9169152, "num_steps_sampled": 6130944, "sample_throughput": 0.0, "train_throughput": 18720.654, "num_weight_syncs": 11973, "num_samples_dropped": 599, "learner_queue": {"size_count": 46159, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.024, "replay_time_ms": 92.954, "update_priorities_time_ms": 52.857, "policy_agent_0": {"added_count": 1514752, "sampled_count": 2270976, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1514752, "sampled_count": 2270976, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5848680734634399, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5771709084510803, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 6130944, "episodes_total": 61312, "training_iteration": 64, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-07-13", "timestamp": 1569056833, "time_this_iter_s": 30.659403324127197, "time_total_s": 1958.0259449481964, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366cb7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1958.0259449481964, "timesteps_since_restore": 6130944, "iterations_since_restore": 64, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.415898762478264, "episode_reward_min": 46.21394585929104, "episode_reward_mean": 49.08423443987141, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 23.235964572072305, "agent_1": 25.848269867799058}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6831129880123448, "mean_processing_ms": 3.610177895285157, "mean_inference_ms": 2.1223738714712774}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 185, "num_steps_trained": 9314560, "num_steps_sampled": 6226944, "sample_throughput": 7944.639, "train_throughput": 0.0, "num_weight_syncs": 12161, "num_samples_dropped": 599, "learner_queue": {"size_count": 46728, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.811, "replay_time_ms": 100.214, "update_priorities_time_ms": 56.361, "policy_agent_0": {"added_count": 1538048, "sampled_count": 2307328, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1538048, "sampled_count": 2307328, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.655867338180542, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5586459040641785, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 6226944, "episodes_total": 62280, "training_iteration": 65, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-07-43", "timestamp": 1569056863, "time_this_iter_s": 30.610888481140137, "time_total_s": 1988.6368334293365, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36f882f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1988.6368334293365, "timesteps_since_restore": 6226944, "iterations_since_restore": 65, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.72389280526633, "episode_reward_min": 47.750474742727455, "episode_reward_mean": 52.46971498944822, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.90883322320494, "agent_1": 26.560881766243284}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6826139951446519, "mean_processing_ms": 3.608624350822942, "mean_inference_ms": 2.1224495119801654}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 188, "num_steps_trained": 9457408, "num_steps_sampled": 6324736, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12352, "num_samples_dropped": 599, "learner_queue": {"size_count": 47285, "size_mean": 0.16, "size_std": 0.5425863986500215, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 34.901, "replay_time_ms": 122.262, "update_priorities_time_ms": 54.237, "policy_agent_0": {"added_count": 1559808, "sampled_count": 2342400, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1559808, "sampled_count": 2342400, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6863640546798706, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5355725288391113, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 6324736, "episodes_total": 63248, "training_iteration": 66, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-08-14", "timestamp": 1569056894, "time_this_iter_s": 30.566506147384644, "time_total_s": 2019.2033395767212, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3673eae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2019.2033395767212, "timesteps_since_restore": 6324736, "iterations_since_restore": 66, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.60062147105976, "episode_reward_min": 49.59209155901466, "episode_reward_mean": 53.568575817841314, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.936202983837276, "agent_1": 26.63237283400398}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6832011475448174, "mean_processing_ms": 3.6119733811067616, "mean_inference_ms": 2.1218313599497827}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 191, "num_steps_trained": 9597696, "num_steps_sampled": 6421760, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12542, "num_samples_dropped": 599, "learner_queue": {"size_count": 47832, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.536, "replay_time_ms": 102.624, "update_priorities_time_ms": 51.493, "policy_agent_0": {"added_count": 1585408, "sampled_count": 2376448, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1585408, "sampled_count": 2376448, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6654373407363892, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5193793773651123, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 6421760, "episodes_total": 64224, "training_iteration": 67, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-08-45", "timestamp": 1569056925, "time_this_iter_s": 30.49440622329712, "time_total_s": 2049.6977458000183, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3664a2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2049.6977458000183, "timesteps_since_restore": 6421760, "iterations_since_restore": 67, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.203867705888726, "episode_reward_min": 50.65930856210122, "episode_reward_mean": 53.26859184692898, "episode_len_mean": 100.0, "episodes_this_iter": 936, "policy_reward_mean": {"agent_0": 26.502713535573132, "agent_1": 26.765878311355813}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6833170438711352, "mean_processing_ms": 3.6127591419495655, "mean_inference_ms": 2.1227453481514376}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 194, "num_steps_trained": 9746944, "num_steps_sampled": 6515456, "sample_throughput": 6689.688, "train_throughput": 6689.688, "num_weight_syncs": 12725, "num_samples_dropped": 599, "learner_queue": {"size_count": 48416, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.775, "replay_time_ms": 106.091, "update_priorities_time_ms": 56.904, "policy_agent_0": {"added_count": 1606400, "sampled_count": 2413568, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1606400, "sampled_count": 2413568, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6114567518234253, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5038965344429016, "model": {}}}}, "timesteps_this_iter": 93696, "done": false, "timesteps_total": 6515456, "episodes_total": 65160, "training_iteration": 68, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-09-15", "timestamp": 1569056955, "time_this_iter_s": 30.5329430103302, "time_total_s": 2080.2306888103485, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36697ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2080.2306888103485, "timesteps_since_restore": 6515456, "iterations_since_restore": 68, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.11948972315949, "episode_reward_min": 49.23457431345056, "episode_reward_mean": 50.996000761173086, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 23.970269620910166, "agent_1": 27.025731140262877}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6832957010184586, "mean_processing_ms": 3.6121409287949144, "mean_inference_ms": 2.121712487974942}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 197, "num_steps_trained": 9885440, "num_steps_sampled": 6614272, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12918, "num_samples_dropped": 599, "learner_queue": {"size_count": 48956, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.92, "replay_time_ms": 91.368, "update_priorities_time_ms": 58.756, "policy_agent_0": {"added_count": 1631488, "sampled_count": 2446336, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1631488, "sampled_count": 2446336, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5800294876098633, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49318256974220276, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 6614272, "episodes_total": 66152, "training_iteration": 69, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-09-46", "timestamp": 1569056986, "time_this_iter_s": 30.655110359191895, "time_total_s": 2110.8857991695404, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3669e9d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2110.8857991695404, "timesteps_since_restore": 6614272, "iterations_since_restore": 69, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.75874683475556, "episode_reward_min": 49.1713895251819, "episode_reward_mean": 51.42661562412756, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 24.302247956574814, "agent_1": 27.12436766755269}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828894322561078, "mean_processing_ms": 3.608815683350083, "mean_inference_ms": 2.1199208986452662}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 199, "num_steps_trained": 10026496, "num_steps_sampled": 6712576, "sample_throughput": 9096.501, "train_throughput": 0.0, "num_weight_syncs": 13109, "num_samples_dropped": 599, "learner_queue": {"size_count": 49507, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.782, "replay_time_ms": 101.296, "update_priorities_time_ms": 45.345, "policy_agent_0": {"added_count": 1651712, "sampled_count": 2481152, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1651712, "sampled_count": 2481152, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6072016954421997, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47539693117141724, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 6712576, "episodes_total": 67136, "training_iteration": 70, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-10-16", "timestamp": 1569057016, "time_this_iter_s": 30.57962965965271, "time_total_s": 2141.465428829193, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366521e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2141.465428829193, "timesteps_since_restore": 6712576, "iterations_since_restore": 70, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.034830207868396, "episode_reward_min": 51.09363017966683, "episode_reward_mean": 55.11053621924279, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 27.49941188543315, "agent_1": 27.61112433380964}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6833066312140356, "mean_processing_ms": 3.610359474497171, "mean_inference_ms": 2.1198515416602386}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 202, "num_steps_trained": 10170368, "num_steps_sampled": 6808576, "sample_throughput": 6505.2, "train_throughput": 3252.6, "num_weight_syncs": 13297, "num_samples_dropped": 599, "learner_queue": {"size_count": 50069, "size_mean": 0.24, "size_std": 0.6183849933496123, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 36.132, "replay_time_ms": 111.968, "update_priorities_time_ms": 52.06, "policy_agent_0": {"added_count": 1674240, "sampled_count": 2516480, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1674240, "sampled_count": 2516480, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6086487770080566, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4570186138153076, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 6808576, "episodes_total": 68088, "training_iteration": 71, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-10-47", "timestamp": 1569057047, "time_this_iter_s": 30.654647827148438, "time_total_s": 2172.1200766563416, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36652d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2172.1200766563416, "timesteps_since_restore": 6808576, "iterations_since_restore": 71, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.095288571400054, "episode_reward_min": 50.67447749937104, "episode_reward_mean": 56.192347008618206, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 28.134177797498566, "agent_1": 28.058169211119665}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6834049579249478, "mean_processing_ms": 3.611147092163986, "mean_inference_ms": 2.119672844776666}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 205, "num_steps_trained": 10314240, "num_steps_sampled": 6904320, "sample_throughput": 0.0, "train_throughput": 18049.418, "num_weight_syncs": 13483, "num_samples_dropped": 599, "learner_queue": {"size_count": 50631, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.404, "replay_time_ms": 107.291, "update_priorities_time_ms": 61.22, "policy_agent_0": {"added_count": 1700096, "sampled_count": 2552064, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1700096, "sampled_count": 2552064, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5734968781471252, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4377705752849579, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 6904320, "episodes_total": 69048, "training_iteration": 72, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-11-18", "timestamp": 1569057078, "time_this_iter_s": 30.58184003829956, "time_total_s": 2202.701916694641, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366542f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2202.701916694641, "timesteps_since_restore": 6904320, "iterations_since_restore": 72, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.041902487225, "episode_reward_min": 52.62338334865174, "episode_reward_mean": 56.28820762201683, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.449909962050075, "agent_1": 27.838297659966774}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6829909387443106, "mean_processing_ms": 3.6092955357312255, "mean_inference_ms": 2.119098473995313}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 208, "num_steps_trained": 10457856, "num_steps_sampled": 7001088, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13673, "num_samples_dropped": 599, "learner_queue": {"size_count": 51192, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.401, "replay_time_ms": 111.04, "update_priorities_time_ms": 53.411, "policy_agent_0": {"added_count": 1723392, "sampled_count": 2587648, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1723392, "sampled_count": 2587648, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.530870258808136, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43875059485435486, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 7001088, "episodes_total": 70016, "training_iteration": 73, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-11-48", "timestamp": 1569057108, "time_this_iter_s": 30.669718742370605, "time_total_s": 2233.3716354370117, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36654ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2233.3716354370117, "timesteps_since_restore": 7001088, "iterations_since_restore": 73, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.10401815918326, "episode_reward_min": 52.937904592975194, "episode_reward_mean": 57.06526451149309, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 29.230842685857347, "agent_1": 27.834421825635822}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6837471136832699, "mean_processing_ms": 3.6102584943126135, "mean_inference_ms": 2.1184268084968365}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 211, "num_steps_trained": 10600192, "num_steps_sampled": 7099136, "sample_throughput": 0.0, "train_throughput": 14220.051, "num_weight_syncs": 13865, "num_samples_dropped": 599, "learner_queue": {"size_count": 51749, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.747, "replay_time_ms": 112.162, "update_priorities_time_ms": 57.34, "policy_agent_0": {"added_count": 1749248, "sampled_count": 2622720, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1749248, "sampled_count": 2622720, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48117879033088684, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41377896070480347, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 7099136, "episodes_total": 71000, "training_iteration": 74, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-12-19", "timestamp": 1569057139, "time_this_iter_s": 30.689345359802246, "time_total_s": 2264.060980796814, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366d5400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2264.060980796814, "timesteps_since_restore": 7099136, "iterations_since_restore": 74, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.10752996801287, "episode_reward_min": 54.209201540109866, "episode_reward_mean": 57.70289155070448, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 29.931814383660637, "agent_1": 27.771077167043916}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6825933259917675, "mean_processing_ms": 3.608158064801118, "mean_inference_ms": 2.118063324246833}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 214, "num_steps_trained": 10741248, "num_steps_sampled": 7198464, "sample_throughput": 0.0, "train_throughput": 20548.313, "num_weight_syncs": 14058, "num_samples_dropped": 599, "learner_queue": {"size_count": 52300, "size_mean": 0.26, "size_std": 0.5219195340279955, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.387, "replay_time_ms": 98.01, "update_priorities_time_ms": 48.861, "policy_agent_0": {"added_count": 1772032, "sampled_count": 2658816, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1772032, "sampled_count": 2658816, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4494572877883911, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41168367862701416, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 7198464, "episodes_total": 71992, "training_iteration": 75, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-12-50", "timestamp": 1569057170, "time_this_iter_s": 30.67766833305359, "time_total_s": 2294.7386491298676, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366b0048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2294.7386491298676, "timesteps_since_restore": 7198464, "iterations_since_restore": 75, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.03065298467001, "episode_reward_min": 52.300528192944405, "episode_reward_mean": 54.964280297672154, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 27.370433821495002, "agent_1": 27.593846476177166}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6829509805611712, "mean_processing_ms": 3.6074086249971993, "mean_inference_ms": 2.118607094202622}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 217, "num_steps_trained": 10890240, "num_steps_sampled": 7293184, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14243, "num_samples_dropped": 599, "learner_queue": {"size_count": 52881, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.459, "replay_time_ms": 86.755, "update_priorities_time_ms": 50.238, "policy_agent_0": {"added_count": 1794304, "sampled_count": 2695936, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1794304, "sampled_count": 2695936, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4187820553779602, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4118708372116089, "model": {}}}}, "timesteps_this_iter": 94720, "done": false, "timesteps_total": 7293184, "episodes_total": 72936, "training_iteration": 76, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-13-20", "timestamp": 1569057200, "time_this_iter_s": 30.58565616607666, "time_total_s": 2325.324305295944, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3670c510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2325.324305295944, "timesteps_since_restore": 7293184, "iterations_since_restore": 76, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.199000416529586, "episode_reward_min": 52.477363489939236, "episode_reward_mean": 56.47911699633134, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.56649977725718, "agent_1": 27.912617219074196}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.682769167124608, "mean_processing_ms": 3.6085352780646893, "mean_inference_ms": 2.1189383664610397}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 219, "num_steps_trained": 11031552, "num_steps_sampled": 7390208, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14433, "num_samples_dropped": 599, "learner_queue": {"size_count": 53434, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.427, "replay_time_ms": 100.999, "update_priorities_time_ms": 53.245, "policy_agent_0": {"added_count": 1818624, "sampled_count": 2730240, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1818624, "sampled_count": 2730240, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41507193446159363, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4075600802898407, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 7390208, "episodes_total": 73904, "training_iteration": 77, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-13-51", "timestamp": 1569057231, "time_this_iter_s": 30.491493940353394, "time_total_s": 2355.8157992362976, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366f9158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2355.8157992362976, "timesteps_since_restore": 7390208, "iterations_since_restore": 77, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.07679488264089, "episode_reward_min": 48.26060900838982, "episode_reward_mean": 55.25904290712704, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.927968882520407, "agent_1": 27.331074024606664}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6822618552794255, "mean_processing_ms": 3.6055659319179774, "mean_inference_ms": 2.1189171509923272}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 222, "num_steps_trained": 11173888, "num_steps_sampled": 7487744, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14623, "num_samples_dropped": 599, "learner_queue": {"size_count": 53990, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.814, "replay_time_ms": 91.193, "update_priorities_time_ms": 46.797, "policy_agent_0": {"added_count": 1840896, "sampled_count": 2767360, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1840896, "sampled_count": 2767360, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42229652404785156, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41080328822135925, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 7487744, "episodes_total": 74888, "training_iteration": 78, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-14-22", "timestamp": 1569057262, "time_this_iter_s": 30.586214542388916, "time_total_s": 2386.4020137786865, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36739620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2386.4020137786865, "timesteps_since_restore": 7487744, "iterations_since_restore": 78, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.090734357370906, "episode_reward_min": 56.60183097358473, "episode_reward_mean": 58.20080658137875, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.967535851984287, "agent_1": 28.233270729394533}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6830956746788432, "mean_processing_ms": 3.6090199448691043, "mean_inference_ms": 2.119779703780894}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 225, "num_steps_trained": 11314944, "num_steps_sampled": 7584768, "sample_throughput": 0.0, "train_throughput": 17286.91, "num_weight_syncs": 14813, "num_samples_dropped": 599, "learner_queue": {"size_count": 54540, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.282, "replay_time_ms": 83.012, "update_priorities_time_ms": 46.308, "policy_agent_0": {"added_count": 1864192, "sampled_count": 2801664, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1864192, "sampled_count": 2801664, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.403876930475235, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40109845995903015, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 7584768, "episodes_total": 75856, "training_iteration": 79, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-14-52", "timestamp": 1569057292, "time_this_iter_s": 30.533385038375854, "time_total_s": 2416.9353988170624, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3660f268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2416.9353988170624, "timesteps_since_restore": 7584768, "iterations_since_restore": 79, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.027026255848895, "episode_reward_min": 55.82136573394334, "episode_reward_mean": 57.889123081793, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 29.51347009866602, "agent_1": 28.37565298312702}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828815909622193, "mean_processing_ms": 3.608430870490736, "mean_inference_ms": 2.120692540574477}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 228, "num_steps_trained": 11460352, "num_steps_sampled": 7680000, "sample_throughput": 0.0, "train_throughput": 29685.978, "num_weight_syncs": 14999, "num_samples_dropped": 599, "learner_queue": {"size_count": 55108, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.571, "replay_time_ms": 99.086, "update_priorities_time_ms": 50.728, "policy_agent_0": {"added_count": 1886720, "sampled_count": 2837760, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1886720, "sampled_count": 2837760, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3799539804458618, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39364105463027954, "model": {}}}}, "timesteps_this_iter": 95232, "done": false, "timesteps_total": 7680000, "episodes_total": 76800, "training_iteration": 80, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-15-23", "timestamp": 1569057323, "time_this_iter_s": 30.640382051467896, "time_total_s": 2447.5757808685303, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36612730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2447.5757808685303, "timesteps_since_restore": 7680000, "iterations_since_restore": 80, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 58.98563052424856, "episode_reward_min": 53.580617337366405, "episode_reward_mean": 56.3880296825813, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.115342659174516, "agent_1": 28.272687023406792}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6819533668375273, "mean_processing_ms": 3.6062620120442874, "mean_inference_ms": 2.120062199244966}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 231, "num_steps_trained": 11601408, "num_steps_sampled": 7778816, "sample_throughput": 0.0, "train_throughput": 15651.985, "num_weight_syncs": 15192, "num_samples_dropped": 599, "learner_queue": {"size_count": 55660, "size_mean": 0.1, "size_std": 0.36055512754639896, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 42.524, "replay_time_ms": 95.097, "update_priorities_time_ms": 55.018, "policy_agent_0": {"added_count": 1911552, "sampled_count": 2871552, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1911552, "sampled_count": 2871552, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3610079288482666, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3907691538333893, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 7778816, "episodes_total": 77792, "training_iteration": 81, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-15-53", "timestamp": 1569057353, "time_this_iter_s": 30.62004852294922, "time_total_s": 2478.1958293914795, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3661c0d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2478.1958293914795, "timesteps_since_restore": 7778816, "iterations_since_restore": 81, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 58.536713113611796, "episode_reward_min": 47.41197980180911, "episode_reward_mean": 55.73693788460696, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.620033916187584, "agent_1": 28.116903968419376}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6817941621680057, "mean_processing_ms": 3.6052341469475526, "mean_inference_ms": 2.1195350868367426}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 233, "num_steps_trained": 11740160, "num_steps_sampled": 7877376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15385, "num_samples_dropped": 599, "learner_queue": {"size_count": 56201, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.838, "replay_time_ms": 103.772, "update_priorities_time_ms": 52.403, "policy_agent_0": {"added_count": 1936640, "sampled_count": 2905088, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1936640, "sampled_count": 2905088, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36697664856910706, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3954041302204132, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 7877376, "episodes_total": 78784, "training_iteration": 82, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-16-24", "timestamp": 1569057384, "time_this_iter_s": 30.585959434509277, "time_total_s": 2508.7817888259888, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365a9620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2508.7817888259888, "timesteps_since_restore": 7877376, "iterations_since_restore": 82, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 58.53049049274332, "episode_reward_min": 53.8390487834308, "episode_reward_mean": 57.26645010253831, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 28.602192089823106, "agent_1": 28.664258012715187}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681682391010651, "mean_processing_ms": 3.6040715209984375, "mean_inference_ms": 2.1185260514706976}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 236, "num_steps_trained": 11885312, "num_steps_sampled": 7974144, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15574, "num_samples_dropped": 599, "learner_queue": {"size_count": 56768, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.37, "replay_time_ms": 132.088, "update_priorities_time_ms": 56.986, "policy_agent_0": {"added_count": 1966080, "sampled_count": 2939904, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1966080, "sampled_count": 2939904, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37230581045150757, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3822599947452545, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 7974144, "episodes_total": 79744, "training_iteration": 83, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-16-55", "timestamp": 1569057415, "time_this_iter_s": 30.56514310836792, "time_total_s": 2539.3469319343567, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36739378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2539.3469319343567, "timesteps_since_restore": 7974144, "iterations_since_restore": 83, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 58.13313359181411, "episode_reward_min": 49.797969233338534, "episode_reward_mean": 56.149002477802675, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 27.715471130978607, "agent_1": 28.433531346824058}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6822493980616875, "mean_processing_ms": 3.6060783330997377, "mean_inference_ms": 2.118872927319119}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 239, "num_steps_trained": 12028416, "num_steps_sampled": 8070400, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15761, "num_samples_dropped": 599, "learner_queue": {"size_count": 57327, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 48.015, "replay_time_ms": 121.038, "update_priorities_time_ms": 67.35, "policy_agent_0": {"added_count": 1990400, "sampled_count": 2975488, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 1990400, "sampled_count": 2975488, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.383208692073822, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39155641198158264, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 8070400, "episodes_total": 80712, "training_iteration": 84, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-17-25", "timestamp": 1569057445, "time_this_iter_s": 30.631348133087158, "time_total_s": 2569.978280067444, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366097b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2569.978280067444, "timesteps_since_restore": 8070400, "iterations_since_restore": 84, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 58.114860925353064, "episode_reward_min": 52.48122372758015, "episode_reward_mean": 56.10094303918549, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 27.490898843097835, "agent_1": 28.610044196087685}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681639129437292, "mean_processing_ms": 3.605088011570259, "mean_inference_ms": 2.1195909234095223}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 242, "num_steps_trained": 12171520, "num_steps_sampled": 8168448, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15953, "num_samples_dropped": 599, "learner_queue": {"size_count": 57886, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.737, "replay_time_ms": 104.267, "update_priorities_time_ms": 44.336, "policy_agent_0": {"added_count": 2015232, "sampled_count": 3010560, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2015232, "sampled_count": 3010560, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40739721059799194, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39421457052230835, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 8168448, "episodes_total": 81688, "training_iteration": 85, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-17-56", "timestamp": 1569057476, "time_this_iter_s": 30.538055658340454, "time_total_s": 2600.5163357257843, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3669ef28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2600.5163357257843, "timesteps_since_restore": 8168448, "iterations_since_restore": 85, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 58.08587583581526, "episode_reward_min": 49.954689323530225, "episode_reward_mean": 55.073084947250905, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 28.4786210145453, "agent_1": 26.594463932705636}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6815754860665929, "mean_processing_ms": 3.6045910039988405, "mean_inference_ms": 2.1194165365452085}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 245, "num_steps_trained": 12314112, "num_steps_sampled": 8265216, "sample_throughput": 7533.55, "train_throughput": 0.0, "num_weight_syncs": 16142, "num_samples_dropped": 599, "learner_queue": {"size_count": 58445, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.231, "replay_time_ms": 110.322, "update_priorities_time_ms": 55.184, "policy_agent_0": {"added_count": 2038272, "sampled_count": 3044352, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2038272, "sampled_count": 3044352, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40255677700042725, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3936101198196411, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 8265216, "episodes_total": 82648, "training_iteration": 86, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-18-27", "timestamp": 1569057507, "time_this_iter_s": 30.684694051742554, "time_total_s": 2631.201029777527, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3668d400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2631.201029777527, "timesteps_since_restore": 8265216, "iterations_since_restore": 86, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.828321185583334, "episode_reward_min": 51.70272800169155, "episode_reward_mean": 54.257083728746444, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.107342095231374, "agent_1": 27.149741633515102}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6822285548491916, "mean_processing_ms": 3.6049891058630514, "mean_inference_ms": 2.1187906066328055}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 248, "num_steps_trained": 12456448, "num_steps_sampled": 8363520, "sample_throughput": 0.0, "train_throughput": 39514.3, "num_weight_syncs": 16334, "num_samples_dropped": 599, "learner_queue": {"size_count": 58999, "size_mean": 0.14, "size_std": 0.40049968789001567, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.801, "replay_time_ms": 90.698, "update_priorities_time_ms": 42.836, "policy_agent_0": {"added_count": 2062336, "sampled_count": 3080192, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2062336, "sampled_count": 3080192, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42781639099121094, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4127269387245178, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 8363520, "episodes_total": 83640, "training_iteration": 87, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-18-57", "timestamp": 1569057537, "time_this_iter_s": 30.59244990348816, "time_total_s": 2661.793479681015, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3664a378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2661.793479681015, "timesteps_since_restore": 8363520, "iterations_since_restore": 87, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.64870808126838, "episode_reward_min": 51.85420695317598, "episode_reward_mean": 53.05627003034108, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.764979903675346, "agent_1": 27.29129012666577}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6818114307730592, "mean_processing_ms": 3.605387020250735, "mean_inference_ms": 2.11922388743324}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 251, "num_steps_trained": 12600576, "num_steps_sampled": 8461056, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16525, "num_samples_dropped": 599, "learner_queue": {"size_count": 59562, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.638, "replay_time_ms": 104.58, "update_priorities_time_ms": 52.081, "policy_agent_0": {"added_count": 2087680, "sampled_count": 3117312, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2087680, "sampled_count": 3117312, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42697542905807495, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40931084752082825, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 8461056, "episodes_total": 84624, "training_iteration": 88, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-19-28", "timestamp": 1569057568, "time_this_iter_s": 30.57585072517395, "time_total_s": 2692.369330406189, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3673e730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2692.369330406189, "timesteps_since_restore": 8461056, "iterations_since_restore": 88, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.04172854114346, "episode_reward_min": 51.81760931065446, "episode_reward_mean": 52.82027538046386, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.146873740777462, "agent_1": 27.673401639686432}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6816406239841861, "mean_processing_ms": 3.603148387927665, "mean_inference_ms": 2.118948650945}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 253, "num_steps_trained": 12743680, "num_steps_sampled": 8558336, "sample_throughput": 0.0, "train_throughput": 16256.5, "num_weight_syncs": 16715, "num_samples_dropped": 599, "learner_queue": {"size_count": 60121, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.02, "replay_time_ms": 102.997, "update_priorities_time_ms": 57.789, "policy_agent_0": {"added_count": 2112512, "sampled_count": 3154688, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2112512, "sampled_count": 3154688, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4345487952232361, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41083043813705444, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 8558336, "episodes_total": 85592, "training_iteration": 89, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-19-59", "timestamp": 1569057599, "time_this_iter_s": 30.704786777496338, "time_total_s": 2723.0741171836853, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36f880d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2723.0741171836853, "timesteps_since_restore": 8558336, "iterations_since_restore": 89, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.034315342111306, "episode_reward_min": 49.625048614844665, "episode_reward_mean": 51.66010656522705, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 25.37688017609353, "agent_1": 26.283226389133517}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6823357338456275, "mean_processing_ms": 3.605471706829831, "mean_inference_ms": 2.118201626725817}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 256, "num_steps_trained": 12883712, "num_steps_sampled": 8656128, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16905, "num_samples_dropped": 599, "learner_queue": {"size_count": 60668, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.563, "replay_time_ms": 110.013, "update_priorities_time_ms": 60.702, "policy_agent_0": {"added_count": 2135040, "sampled_count": 3188736, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2135040, "sampled_count": 3188736, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4598747491836548, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40824517607688904, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 8656128, "episodes_total": 86568, "training_iteration": 90, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-20-29", "timestamp": 1569057629, "time_this_iter_s": 30.662967920303345, "time_total_s": 2753.7370851039886, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3671e048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2753.7370851039886, "timesteps_since_restore": 8656128, "iterations_since_restore": 90, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.8349888555316, "episode_reward_min": 47.309156563878936, "episode_reward_mean": 52.2738448901574, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 24.841209378218135, "agent_1": 27.432635511939324}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.681516191901639, "mean_processing_ms": 3.6017482952373463, "mean_inference_ms": 2.116936290375792}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 259, "num_steps_trained": 13029888, "num_steps_sampled": 8751360, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17092, "num_samples_dropped": 599, "learner_queue": {"size_count": 61239, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.735, "replay_time_ms": 103.116, "update_priorities_time_ms": 61.667, "policy_agent_0": {"added_count": 2159872, "sampled_count": 3225856, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2159872, "sampled_count": 3225856, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49775803089141846, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41901350021362305, "model": {}}}}, "timesteps_this_iter": 95232, "done": false, "timesteps_total": 8751360, "episodes_total": 87520, "training_iteration": 91, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-21-00", "timestamp": 1569057660, "time_this_iter_s": 30.55751872062683, "time_total_s": 2784.2946038246155, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365f7510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2784.2946038246155, "timesteps_since_restore": 8751360, "iterations_since_restore": 91, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.95040729528933, "episode_reward_min": 50.35950456535447, "episode_reward_mean": 55.58723483775006, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.53283834034019, "agent_1": 29.05439649741005}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6826914050682295, "mean_processing_ms": 3.6051107677279774, "mean_inference_ms": 2.1169482009464238}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 262, "num_steps_trained": 13171200, "num_steps_sampled": 8848896, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17282, "num_samples_dropped": 599, "learner_queue": {"size_count": 61792, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.527, "replay_time_ms": 118.019, "update_priorities_time_ms": 57.197, "policy_agent_0": {"added_count": 2187520, "sampled_count": 3260416, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2187520, "sampled_count": 3260416, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49636316299438477, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4093943238258362, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 8848896, "episodes_total": 88496, "training_iteration": 92, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-21-30", "timestamp": 1569057690, "time_this_iter_s": 30.603053331375122, "time_total_s": 2814.8976571559906, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366bb598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2814.8976571559906, "timesteps_since_restore": 8848896, "iterations_since_restore": 92, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.91525479906838, "episode_reward_min": 53.137422734153795, "episode_reward_mean": 55.736638298100154, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 27.46763769633576, "agent_1": 28.269000601764446}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828998784578978, "mean_processing_ms": 3.6062093691798704, "mean_inference_ms": 2.1175503759424092}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 265, "num_steps_trained": 13317632, "num_steps_sampled": 8944896, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17469, "num_samples_dropped": 599, "learner_queue": {"size_count": 62363, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.566, "replay_time_ms": 92.29, "update_priorities_time_ms": 49.766, "policy_agent_0": {"added_count": 2208512, "sampled_count": 3298048, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2208512, "sampled_count": 3298048, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46769386529922485, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40677952766418457, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 8944896, "episodes_total": 89456, "training_iteration": 93, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-22-01", "timestamp": 1569057721, "time_this_iter_s": 30.500932216644287, "time_total_s": 2845.398589372635, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366519d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2845.398589372635, "timesteps_since_restore": 8944896, "iterations_since_restore": 93, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 57.80794871609451, "episode_reward_min": 54.81114973473315, "episode_reward_mean": 55.77601216414207, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 27.519304901897833, "agent_1": 28.25670726224422}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6827350354230304, "mean_processing_ms": 3.6043736633435373, "mean_inference_ms": 2.116272915733673}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 268, "num_steps_trained": 13459712, "num_steps_sampled": 9041408, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17659, "num_samples_dropped": 599, "learner_queue": {"size_count": 62918, "size_mean": 0.16, "size_std": 0.463033476111609, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.19, "replay_time_ms": 101.505, "update_priorities_time_ms": 54.476, "policy_agent_0": {"added_count": 2236416, "sampled_count": 3331584, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2236416, "sampled_count": 3331584, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4680463671684265, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39023274183273315, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 9041408, "episodes_total": 90416, "training_iteration": 94, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-22-32", "timestamp": 1569057752, "time_this_iter_s": 30.575091123580933, "time_total_s": 2875.973680496216, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366572f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2875.973680496216, "timesteps_since_restore": 9041408, "iterations_since_restore": 94, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 65.13235409804385, "episode_reward_min": 52.306327620065886, "episode_reward_mean": 55.612617145288674, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.702255315779762, "agent_1": 28.910361829508926}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6832100562729846, "mean_processing_ms": 3.6059555907831307, "mean_inference_ms": 2.116122613027402}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 271, "num_steps_trained": 13601792, "num_steps_sampled": 9139200, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17849, "num_samples_dropped": 599, "learner_queue": {"size_count": 63473, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.091, "replay_time_ms": 106.384, "update_priorities_time_ms": 55.924, "policy_agent_0": {"added_count": 2257920, "sampled_count": 3366912, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2257920, "sampled_count": 3366912, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46972477436065674, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38282984495162964, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 9139200, "episodes_total": 91392, "training_iteration": 95, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-23-02", "timestamp": 1569057782, "time_this_iter_s": 30.6142680644989, "time_total_s": 2906.5879485607147, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365ef488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2906.5879485607147, "timesteps_since_restore": 9139200, "iterations_since_restore": 95, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 63.17941668718711, "episode_reward_min": 51.03658152918279, "episode_reward_mean": 54.62727873707647, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.872770856061102, "agent_1": 27.75450788101539}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6835920124577579, "mean_processing_ms": 3.608086433941909, "mean_inference_ms": 2.116835790783471}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 273, "num_steps_trained": 13745664, "num_steps_sampled": 9235968, "sample_throughput": 8095.677, "train_throughput": 0.0, "num_weight_syncs": 18039, "num_samples_dropped": 599, "learner_queue": {"size_count": 64035, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.384, "replay_time_ms": 112.122, "update_priorities_time_ms": 54.168, "policy_agent_0": {"added_count": 2284288, "sampled_count": 3402240, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2284288, "sampled_count": 3402240, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4611632525920868, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37306299805641174, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 9235968, "episodes_total": 92368, "training_iteration": 96, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-23-33", "timestamp": 1569057813, "time_this_iter_s": 30.552114009857178, "time_total_s": 2937.140062570572, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36753510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2937.140062570572, "timesteps_since_restore": 9235968, "iterations_since_restore": 96, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 62.44943958903385, "episode_reward_min": 49.98120495456322, "episode_reward_mean": 52.12905598370617, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 24.662169067383964, "agent_1": 27.46688691632222}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6825955347765227, "mean_processing_ms": 3.6041636520621823, "mean_inference_ms": 2.115037597376988}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 276, "num_steps_trained": 13882368, "num_steps_sampled": 9335808, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18233, "num_samples_dropped": 599, "learner_queue": {"size_count": 64569, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.101, "replay_time_ms": 109.684, "update_priorities_time_ms": 52.159, "policy_agent_0": {"added_count": 2311168, "sampled_count": 3436544, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2311168, "sampled_count": 3436544, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5018165111541748, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3676068186759949, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 9335808, "episodes_total": 93368, "training_iteration": 97, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-24-03", "timestamp": 1569057843, "time_this_iter_s": 30.548970699310303, "time_total_s": 2967.689033269882, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366e8158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2967.689033269882, "timesteps_since_restore": 9335808, "iterations_since_restore": 97, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 63.160900036918925, "episode_reward_min": 49.974376658306845, "episode_reward_mean": 55.57697102669288, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.155187610055446, "agent_1": 28.421783416637414}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6815841878960898, "mean_processing_ms": 3.59935106718407, "mean_inference_ms": 2.1130639209059607}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 279, "num_steps_trained": 14019328, "num_steps_sampled": 9434368, "sample_throughput": 6877.141, "train_throughput": 0.0, "num_weight_syncs": 18426, "num_samples_dropped": 599, "learner_queue": {"size_count": 65104, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.304, "replay_time_ms": 95.58, "update_priorities_time_ms": 57.996, "policy_agent_0": {"added_count": 2334720, "sampled_count": 3471360, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2334720, "sampled_count": 3471360, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5151470303535461, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40221983194351196, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 9434368, "episodes_total": 94352, "training_iteration": 98, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-24-34", "timestamp": 1569057874, "time_this_iter_s": 30.65149688720703, "time_total_s": 2998.3405301570892, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36677620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2998.3405301570892, "timesteps_since_restore": 9434368, "iterations_since_restore": 98, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 62.75536031974035, "episode_reward_min": 50.12677567034399, "episode_reward_mean": 57.22131514321793, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 26.2076639796078, "agent_1": 31.013651163610053}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828246534037969, "mean_processing_ms": 3.6043678187916117, "mean_inference_ms": 2.11482647121176}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 282, "num_steps_trained": 14164736, "num_steps_sampled": 9529856, "sample_throughput": 0.0, "train_throughput": 10421.744, "num_weight_syncs": 18612, "num_samples_dropped": 599, "learner_queue": {"size_count": 65672, "size_mean": 0.08, "size_std": 0.3370459909270544, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.813, "replay_time_ms": 91.031, "update_priorities_time_ms": 45.922, "policy_agent_0": {"added_count": 2360064, "sampled_count": 3504896, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2360064, "sampled_count": 3504896, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5404674410820007, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36586499214172363, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 9529856, "episodes_total": 95304, "training_iteration": 99, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-25-05", "timestamp": 1569057905, "time_this_iter_s": 30.49818444252014, "time_total_s": 3028.8387145996094, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366b0268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3028.8387145996094, "timesteps_since_restore": 9529856, "iterations_since_restore": 99, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 60.16369627917394, "episode_reward_min": 57.36728078305081, "episode_reward_mean": 59.498497057702345, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 27.24721821846711, "agent_1": 32.251278839235106}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6826633957330138, "mean_processing_ms": 3.6035236595028084, "mean_inference_ms": 2.114356634146089}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 285, "num_steps_trained": 14307840, "num_steps_sampled": 9627648, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18804, "num_samples_dropped": 599, "learner_queue": {"size_count": 66231, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.662, "replay_time_ms": 140.226, "update_priorities_time_ms": 61.72, "policy_agent_0": {"added_count": 2385920, "sampled_count": 3538176, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2385920, "sampled_count": 3538176, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47551995515823364, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35234734416007996, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 9627648, "episodes_total": 96280, "training_iteration": 100, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-25-35", "timestamp": 1569057935, "time_this_iter_s": 30.58255934715271, "time_total_s": 3059.421273946762, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366dc730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3059.421273946762, "timesteps_since_restore": 9627648, "iterations_since_restore": 100, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 58.51123473218805, "episode_reward_min": 56.94610655509397, "episode_reward_mean": 57.95801400654705, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.961308808284908, "agent_1": 28.996705198262127}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828670397100108, "mean_processing_ms": 3.6027430876976076, "mean_inference_ms": 2.112568454176944}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 287, "num_steps_trained": 14450944, "num_steps_sampled": 9725184, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18993, "num_samples_dropped": 599, "learner_queue": {"size_count": 66790, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.809, "replay_time_ms": 91.891, "update_priorities_time_ms": 46.278, "policy_agent_0": {"added_count": 2411776, "sampled_count": 3574528, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2411776, "sampled_count": 3574528, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44290831685066223, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3360599875450134, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 9725184, "episodes_total": 97256, "training_iteration": 101, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-26-06", "timestamp": 1569057966, "time_this_iter_s": 30.57031536102295, "time_total_s": 3089.991589307785, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366532f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3089.991589307785, "timesteps_since_restore": 9725184, "iterations_since_restore": 101, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 60.12077096648525, "episode_reward_min": 50.71809139762604, "episode_reward_mean": 56.95360814478305, "episode_len_mean": 100.0, "episodes_this_iter": 896, "policy_reward_mean": {"agent_0": 27.095369988094195, "agent_1": 29.85823815668883}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6829325775197802, "mean_processing_ms": 3.6064700147040156, "mean_inference_ms": 2.1156932423706536}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 290, "num_steps_trained": 14579200, "num_steps_sampled": 9814528, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19168, "num_samples_dropped": 599, "learner_queue": {"size_count": 67291, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.261, "replay_time_ms": 122.609, "update_priorities_time_ms": 52.693, "policy_agent_0": {"added_count": 2435584, "sampled_count": 3604992, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2435584, "sampled_count": 3604992, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.425346314907074, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32794004678726196, "model": {}}}}, "timesteps_this_iter": 89344, "done": false, "timesteps_total": 9814528, "episodes_total": 98152, "training_iteration": 102, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-26-36", "timestamp": 1569057996, "time_this_iter_s": 30.61944842338562, "time_total_s": 3120.6110377311707, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365b2840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3120.6110377311707, "timesteps_since_restore": 9814528, "iterations_since_restore": 102, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.6143653980729, "episode_reward_min": 50.525342706017256, "episode_reward_mean": 52.73150816646225, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 23.20764817643404, "agent_1": 29.52385999002823}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6826308058459319, "mean_processing_ms": 3.6037312429186468, "mean_inference_ms": 2.1142531217834177}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 293, "num_steps_trained": 14719488, "num_steps_sampled": 9912064, "sample_throughput": 7635.932, "train_throughput": 0.0, "num_weight_syncs": 19358, "num_samples_dropped": 599, "learner_queue": {"size_count": 67839, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.148, "replay_time_ms": 136.892, "update_priorities_time_ms": 58.706, "policy_agent_0": {"added_count": 2464512, "sampled_count": 3637248, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2464512, "sampled_count": 3637248, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47947001457214355, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3479834198951721, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 9912064, "episodes_total": 99120, "training_iteration": 103, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-27-07", "timestamp": 1569058027, "time_this_iter_s": 30.587036609649658, "time_total_s": 3151.1980743408203, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365bd488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3151.1980743408203, "timesteps_since_restore": 9912064, "iterations_since_restore": 103, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 58.54964813859123, "episode_reward_min": 47.669771511990746, "episode_reward_mean": 52.23399470514069, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 24.212196999275605, "agent_1": 28.02179770586507}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6829493083882671, "mean_processing_ms": 3.6050799259265878, "mean_inference_ms": 2.1154872623881755}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 296, "num_steps_trained": 14866176, "num_steps_sampled": 10007808, "sample_throughput": 0.0, "train_throughput": 10741.5, "num_weight_syncs": 19545, "num_samples_dropped": 599, "learner_queue": {"size_count": 68412, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.958, "replay_time_ms": 101.593, "update_priorities_time_ms": 52.894, "policy_agent_0": {"added_count": 2491648, "sampled_count": 3671296, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2491648, "sampled_count": 3671296, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5668026208877563, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3582374155521393, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 10007808, "episodes_total": 100080, "training_iteration": 104, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-27-38", "timestamp": 1569058058, "time_this_iter_s": 30.521921157836914, "time_total_s": 3181.719995498657, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365cc950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3181.719995498657, "timesteps_since_restore": 10007808, "iterations_since_restore": 104, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 60.0244381342311, "episode_reward_min": 49.77857660372583, "episode_reward_mean": 52.708175768895245, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 24.980624675884997, "agent_1": 27.72755109301026}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6830302607754732, "mean_processing_ms": 3.6029345393798606, "mean_inference_ms": 2.1138685366365366}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 299, "num_steps_trained": 15006720, "num_steps_sampled": 10105856, "sample_throughput": 0.0, "train_throughput": 16559.357, "num_weight_syncs": 19737, "num_samples_dropped": 599, "learner_queue": {"size_count": 68962, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.458, "replay_time_ms": 117.554, "update_priorities_time_ms": 58.585, "policy_agent_0": {"added_count": 2515456, "sampled_count": 3703040, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2515456, "sampled_count": 3703040, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5884442329406738, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36372941732406616, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 10105856, "episodes_total": 101072, "training_iteration": 105, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-28-08", "timestamp": 1569058088, "time_this_iter_s": 30.560518980026245, "time_total_s": 3212.2805144786835, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365c9598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3212.2805144786835, "timesteps_since_restore": 10105856, "iterations_since_restore": 105, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.98063460703775, "episode_reward_min": 48.16174319311801, "episode_reward_mean": 52.119807457513964, "episode_len_mean": 100.0, "episodes_this_iter": 928, "policy_reward_mean": {"agent_0": 23.791323412546745, "agent_1": 28.3284840449672}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6832049872675997, "mean_processing_ms": 3.606416135033209, "mean_inference_ms": 2.1158158232235724}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 301, "num_steps_trained": 15155456, "num_steps_sampled": 10200320, "sample_throughput": 9445.301, "train_throughput": 0.0, "num_weight_syncs": 19922, "num_samples_dropped": 599, "learner_queue": {"size_count": 69542, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.333, "replay_time_ms": 97.581, "update_priorities_time_ms": 46.312, "policy_agent_0": {"added_count": 2537216, "sampled_count": 3738624, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2537216, "sampled_count": 3738624, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5884525775909424, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39510586857795715, "model": {}}}}, "timesteps_this_iter": 94464, "done": false, "timesteps_total": 10200320, "episodes_total": 102000, "training_iteration": 106, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-28-39", "timestamp": 1569058119, "time_this_iter_s": 30.51930522918701, "time_total_s": 3242.7998197078705, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365dca60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3242.7998197078705, "timesteps_since_restore": 10200320, "iterations_since_restore": 106, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 58.17685228316626, "episode_reward_min": 44.98044675816898, "episode_reward_mean": 50.71879516511452, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 23.94931021761781, "agent_1": 26.769484947496736}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6833559892619211, "mean_processing_ms": 3.606485920249031, "mean_inference_ms": 2.1154065720687627}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 304, "num_steps_trained": 15302656, "num_steps_sampled": 10295808, "sample_throughput": 7234.921, "train_throughput": 4823.281, "num_weight_syncs": 20109, "num_samples_dropped": 599, "learner_queue": {"size_count": 70117, "size_mean": 1.28, "size_std": 2.3752052542885633, "size_quantiles": [0.0, 0.0, 0.0, 5.100000000000001, 8.0]}, "replay_shard_0": {"add_batch_time_ms": 35.245, "replay_time_ms": 111.377, "update_priorities_time_ms": 52.847, "policy_agent_0": {"added_count": 2562304, "sampled_count": 3775232, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2562304, "sampled_count": 3775232, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6329811215400696, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4101056456565857, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 10295808, "episodes_total": 102960, "training_iteration": 107, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-29-09", "timestamp": 1569058149, "time_this_iter_s": 30.660988569259644, "time_total_s": 3273.46080827713, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365b2950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3273.46080827713, "timesteps_since_restore": 10295808, "iterations_since_restore": 107, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 60.49117475391626, "episode_reward_min": 46.05828259320722, "episode_reward_mean": 56.73719447874258, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.604746450988117, "agent_1": 31.132448027754542}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6838940484123462, "mean_processing_ms": 3.605681175133466, "mean_inference_ms": 2.115525599448144}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 307, "num_steps_trained": 15447808, "num_steps_sampled": 10392576, "sample_throughput": 8171.209, "train_throughput": 0.0, "num_weight_syncs": 20298, "num_samples_dropped": 599, "learner_queue": {"size_count": 70685, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.334, "replay_time_ms": 126.126, "update_priorities_time_ms": 67.578, "policy_agent_0": {"added_count": 2585344, "sampled_count": 3812864, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2585344, "sampled_count": 3812864, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6374927163124084, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40282151103019714, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 10392576, "episodes_total": 103928, "training_iteration": 108, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-29-40", "timestamp": 1569058180, "time_this_iter_s": 30.73820209503174, "time_total_s": 3304.199010372162, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366dcb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3304.199010372162, "timesteps_since_restore": 10392576, "iterations_since_restore": 108, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 58.07816302073008, "episode_reward_min": 56.19869480110701, "episode_reward_mean": 57.489076019321, "episode_len_mean": 100.0, "episodes_this_iter": 896, "policy_reward_mean": {"agent_0": 26.125587383237246, "agent_1": 31.36348863608368}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6831574940778804, "mean_processing_ms": 3.606112720431836, "mean_inference_ms": 2.117110859679358}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 310, "num_steps_trained": 15573248, "num_steps_sampled": 10481408, "sample_throughput": 7938.002, "train_throughput": 0.0, "num_weight_syncs": 20471, "num_samples_dropped": 599, "learner_queue": {"size_count": 71175, "size_mean": 0.1, "size_std": 0.3605551275463989, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.419, "replay_time_ms": 115.947, "update_priorities_time_ms": 58.979, "policy_agent_0": {"added_count": 2610688, "sampled_count": 3839744, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2610688, "sampled_count": 3839744, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5934146642684937, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3791965842247009, "model": {}}}}, "timesteps_this_iter": 88832, "done": false, "timesteps_total": 10481408, "episodes_total": 104824, "training_iteration": 109, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-30-11", "timestamp": 1569058211, "time_this_iter_s": 30.61779499053955, "time_total_s": 3334.8168053627014, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366b01e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3334.8168053627014, "timesteps_since_restore": 10481408, "iterations_since_restore": 109, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 58.923229258536395, "episode_reward_min": 56.72685726811433, "episode_reward_mean": 57.46986578102764, "episode_len_mean": 100.0, "episodes_this_iter": 872, "policy_reward_mean": {"agent_0": 26.414464947855485, "agent_1": 31.055400833172083}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6848586148796164, "mean_processing_ms": 3.6113565816243662, "mean_inference_ms": 2.1195897828176533}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 313, "num_steps_trained": 15710720, "num_steps_sampled": 10568448, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20640, "num_samples_dropped": 599, "learner_queue": {"size_count": 71711, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.72, "replay_time_ms": 108.318, "update_priorities_time_ms": 61.477, "policy_agent_0": {"added_count": 2632960, "sampled_count": 3872512, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2632960, "sampled_count": 3872512, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5425070524215698, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33144378662109375, "model": {}}}}, "timesteps_this_iter": 87040, "done": false, "timesteps_total": 10568448, "episodes_total": 105696, "training_iteration": 110, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-30-42", "timestamp": 1569058242, "time_this_iter_s": 30.73038601875305, "time_total_s": 3365.5471913814545, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36657840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3365.5471913814545, "timesteps_since_restore": 10568448, "iterations_since_restore": 110, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 62.21782974007071, "episode_reward_min": 55.66932809801407, "episode_reward_mean": 57.603245550201876, "episode_len_mean": 100.0, "episodes_this_iter": 880, "policy_reward_mean": {"agent_0": 27.173872835933345, "agent_1": 30.429372714268514}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6849129200882714, "mean_processing_ms": 3.6140292071435423, "mean_inference_ms": 2.122499710821945}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 315, "num_steps_trained": 15853312, "num_steps_sampled": 10656256, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20812, "num_samples_dropped": 599, "learner_queue": {"size_count": 72268, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.184, "replay_time_ms": 96.804, "update_priorities_time_ms": 61.257, "policy_agent_0": {"added_count": 2653184, "sampled_count": 3906048, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2653184, "sampled_count": 3906048, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5316945314407349, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32128196954727173, "model": {}}}}, "timesteps_this_iter": 87808, "done": false, "timesteps_total": 10656256, "episodes_total": 106576, "training_iteration": 111, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-31-12", "timestamp": 1569058272, "time_this_iter_s": 30.488873958587646, "time_total_s": 3396.036065340042, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366570d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3396.036065340042, "timesteps_since_restore": 10656256, "iterations_since_restore": 111, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 61.301927763424025, "episode_reward_min": 55.014121774972125, "episode_reward_mean": 57.692819025094714, "episode_len_mean": 100.0, "episodes_this_iter": 800, "policy_reward_mean": {"agent_0": 27.179408454187655, "agent_1": 30.513410570907055}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.685214435603983, "mean_processing_ms": 3.6186515541518385, "mean_inference_ms": 2.127162718388856}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 318, "num_steps_trained": 15976448, "num_steps_sampled": 10736640, "sample_throughput": 0.0, "train_throughput": 11702.207, "num_weight_syncs": 20968, "num_samples_dropped": 599, "learner_queue": {"size_count": 72749, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 64.401, "replay_time_ms": 156.322, "update_priorities_time_ms": 84.774, "policy_agent_0": {"added_count": 2671616, "sampled_count": 3936256, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2671616, "sampled_count": 3936256, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4995734393596649, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30762243270874023, "model": {}}}}, "timesteps_this_iter": 80384, "done": false, "timesteps_total": 10736640, "episodes_total": 107376, "training_iteration": 112, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-31-43", "timestamp": 1569058303, "time_this_iter_s": 30.997350931167603, "time_total_s": 3427.0334162712097, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36651488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3427.0334162712097, "timesteps_since_restore": 10736640, "iterations_since_restore": 112, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 61.36689363917053, "episode_reward_min": 55.451855649620455, "episode_reward_mean": 60.378468694810095, "episode_len_mean": 100.0, "episodes_this_iter": 584, "policy_reward_mean": {"agent_0": 28.90312058452733, "agent_1": 31.475348110282862}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6860209159696191, "mean_processing_ms": 3.629141005834588, "mean_inference_ms": 2.13971061618601}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 320, "num_steps_trained": 16065024, "num_steps_sampled": 10794752, "sample_throughput": 7131.228, "train_throughput": 7131.228, "num_weight_syncs": 21083, "num_samples_dropped": 599, "learner_queue": {"size_count": 73095, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 49.946, "replay_time_ms": 113.561, "update_priorities_time_ms": 57.603, "policy_agent_0": {"added_count": 2685696, "sampled_count": 3958528, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2685696, "sampled_count": 3958528, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47575077414512634, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2974946200847626, "model": {}}}}, "timesteps_this_iter": 58112, "done": false, "timesteps_total": 10794752, "episodes_total": 107960, "training_iteration": 113, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-32-14", "timestamp": 1569058334, "time_this_iter_s": 30.612968921661377, "time_total_s": 3457.646385192871, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366bb2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3457.646385192871, "timesteps_since_restore": 10794752, "iterations_since_restore": 113, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 63.00751117715275, "episode_reward_min": 47.67630866694436, "episode_reward_mean": 59.09333693121523, "episode_len_mean": 100.0, "episodes_this_iter": 896, "policy_reward_mean": {"agent_0": 28.852212939596175, "agent_1": 30.24112399161914}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6859320508682659, "mean_processing_ms": 3.6284088740885707, "mean_inference_ms": 2.1400096191421154}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 322, "num_steps_trained": 16202240, "num_steps_sampled": 10885376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21259, "num_samples_dropped": 599, "learner_queue": {"size_count": 73631, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.351, "replay_time_ms": 83.478, "update_priorities_time_ms": 52.065, "policy_agent_0": {"added_count": 2708736, "sampled_count": 3993344, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2708736, "sampled_count": 3993344, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4497096538543701, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2914963960647583, "model": {}}}}, "timesteps_this_iter": 90624, "done": false, "timesteps_total": 10885376, "episodes_total": 108856, "training_iteration": 114, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-32-44", "timestamp": 1569058364, "time_this_iter_s": 30.576922178268433, "time_total_s": 3488.2233073711395, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3671e048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3488.2233073711395, "timesteps_since_restore": 10885376, "iterations_since_restore": 114, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 61.413222508230604, "episode_reward_min": 53.76893839426587, "episode_reward_mean": 60.32835888068384, "episode_len_mean": 100.0, "episodes_this_iter": 904, "policy_reward_mean": {"agent_0": 28.85427681470946, "agent_1": 31.47408206597447}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6864397235836069, "mean_processing_ms": 3.6309086520588862, "mean_inference_ms": 2.142087445742159}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 325, "num_steps_trained": 16338944, "num_steps_sampled": 10975744, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21436, "num_samples_dropped": 599, "learner_queue": {"size_count": 74166, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.115, "replay_time_ms": 102.205, "update_priorities_time_ms": 56.445, "policy_agent_0": {"added_count": 2731776, "sampled_count": 4027136, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2731776, "sampled_count": 4027136, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4355034828186035, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30455726385116577, "model": {}}}}, "timesteps_this_iter": 90368, "done": false, "timesteps_total": 10975744, "episodes_total": 109760, "training_iteration": 115, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-33-15", "timestamp": 1569058395, "time_this_iter_s": 30.574738025665283, "time_total_s": 3518.798045396805, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3672cb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3518.798045396805, "timesteps_since_restore": 10975744, "iterations_since_restore": 115, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 61.56500705356417, "episode_reward_min": 58.13626178926193, "episode_reward_mean": 60.120330606816516, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 29.276821967535316, "agent_1": 30.84350863928131}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6868659758731793, "mean_processing_ms": 3.631529448240099, "mean_inference_ms": 2.1415968811588444}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 328, "num_steps_trained": 16483840, "num_steps_sampled": 11072512, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21625, "num_samples_dropped": 599, "learner_queue": {"size_count": 74731, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.75, "replay_time_ms": 103.111, "update_priorities_time_ms": 52.768, "policy_agent_0": {"added_count": 2758400, "sampled_count": 4063232, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2758400, "sampled_count": 4063232, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3936459720134735, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3044208288192749, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 11072512, "episodes_total": 110736, "training_iteration": 116, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-33-46", "timestamp": 1569058426, "time_this_iter_s": 30.606663703918457, "time_total_s": 3549.4047091007233, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36f88598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3549.4047091007233, "timesteps_since_restore": 11072512, "iterations_since_restore": 116, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 62.31825437057936, "episode_reward_min": 48.174832387555966, "episode_reward_mean": 59.72560162570607, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 29.784914871198705, "agent_1": 29.940686754507418}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.686328906653126, "mean_processing_ms": 3.629544891040997, "mean_inference_ms": 2.1404475401893617}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 331, "num_steps_trained": 16633344, "num_steps_sampled": 11169280, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21814, "num_samples_dropped": 599, "learner_queue": {"size_count": 75315, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.093, "replay_time_ms": 100.338, "update_priorities_time_ms": 55.151, "policy_agent_0": {"added_count": 2780672, "sampled_count": 4103424, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2780672, "sampled_count": 4103424, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3745085895061493, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3257206976413727, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 11169280, "episodes_total": 111688, "training_iteration": 117, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-34-16", "timestamp": 1569058456, "time_this_iter_s": 30.6974778175354, "time_total_s": 3580.1021869182587, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3673e6a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3580.1021869182587, "timesteps_since_restore": 11169280, "iterations_since_restore": 117, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 60.26629031234174, "episode_reward_min": 53.1906700106038, "episode_reward_mean": 57.79959495843908, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.789505794009905, "agent_1": 30.010089164429218}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6859528517170881, "mean_processing_ms": 3.6284542095781713, "mean_inference_ms": 2.1392715731636973}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 334, "num_steps_trained": 16777216, "num_steps_sampled": 11266816, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22005, "num_samples_dropped": 599, "learner_queue": {"size_count": 75878, "size_mean": 0.14, "size_std": 0.40049968789001567, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.085, "replay_time_ms": 96.379, "update_priorities_time_ms": 53.214, "policy_agent_0": {"added_count": 2801408, "sampled_count": 4142080, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2801408, "sampled_count": 4142080, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3920883238315582, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31798648834228516, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 11266816, "episodes_total": 112672, "training_iteration": 118, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-34-47", "timestamp": 1569058487, "time_this_iter_s": 30.593618869781494, "time_total_s": 3610.69580578804, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3668d2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3610.69580578804, "timesteps_since_restore": 11266816, "iterations_since_restore": 118, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.04139046936893, "episode_reward_min": 51.97723131726479, "episode_reward_mean": 56.82058169243539, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 29.29924210959668, "agent_1": 27.52133958283873}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6862775238007232, "mean_processing_ms": 3.6284202142817166, "mean_inference_ms": 2.139243474048651}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 337, "num_steps_trained": 16926464, "num_steps_sampled": 11363328, "sample_throughput": 7375.006, "train_throughput": 0.0, "num_weight_syncs": 22193, "num_samples_dropped": 599, "learner_queue": {"size_count": 76461, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.062, "replay_time_ms": 84.321, "update_priorities_time_ms": 45.501, "policy_agent_0": {"added_count": 2829312, "sampled_count": 4180736, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2829312, "sampled_count": 4180736, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37209704518318176, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3310214579105377, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 11363328, "episodes_total": 113648, "training_iteration": 119, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-35-18", "timestamp": 1569058518, "time_this_iter_s": 30.512579441070557, "time_total_s": 3641.2083852291107, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36697620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3641.2083852291107, "timesteps_since_restore": 11363328, "iterations_since_restore": 119, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 59.39258793074426, "episode_reward_min": 49.14098383706883, "episode_reward_mean": 54.03037128721533, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 27.157028235138693, "agent_1": 26.873343052076677}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6862883328088392, "mean_processing_ms": 3.629259080466084, "mean_inference_ms": 2.13915441891463}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 340, "num_steps_trained": 17072128, "num_steps_sampled": 11460096, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22382, "num_samples_dropped": 599, "learner_queue": {"size_count": 77029, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.405, "replay_time_ms": 103.123, "update_priorities_time_ms": 49.366, "policy_agent_0": {"added_count": 2854400, "sampled_count": 4219904, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2854400, "sampled_count": 4219904, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37772172689437866, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37341228127479553, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 11460096, "episodes_total": 114608, "training_iteration": 120, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-35-48", "timestamp": 1569058548, "time_this_iter_s": 30.537849187850952, "time_total_s": 3671.7462344169617, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3669e7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3671.7462344169617, "timesteps_since_restore": 11460096, "iterations_since_restore": 120, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 57.35873049304723, "episode_reward_min": 49.03795304106025, "episode_reward_mean": 53.019703646509186, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.567898343684202, "agent_1": 26.451805302825022}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6863976486653827, "mean_processing_ms": 3.6295667419993065, "mean_inference_ms": 2.138891258093013}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 343, "num_steps_trained": 17218048, "num_steps_sampled": 11558400, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22574, "num_samples_dropped": 599, "learner_queue": {"size_count": 77599, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 47.163, "replay_time_ms": 91.769, "update_priorities_time_ms": 49.351, "policy_agent_0": {"added_count": 2876928, "sampled_count": 4257536, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2876928, "sampled_count": 4257536, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40941131114959717, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3977782726287842, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 11558400, "episodes_total": 115592, "training_iteration": 121, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-36-19", "timestamp": 1569058579, "time_this_iter_s": 30.48817539215088, "time_total_s": 3702.2344098091125, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36609bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3702.2344098091125, "timesteps_since_restore": 11558400, "iterations_since_restore": 121, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 57.06165087818909, "episode_reward_min": 45.52768050723598, "episode_reward_mean": 53.242482371571775, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 27.036425310799462, "agent_1": 26.206057060772327}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6863013040890172, "mean_processing_ms": 3.6292539381573286, "mean_inference_ms": 2.1385512475572725}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 345, "num_steps_trained": 17363712, "num_steps_sampled": 11656448, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22766, "num_samples_dropped": 599, "learner_queue": {"size_count": 78169, "size_mean": 0.22, "size_std": 0.45999999999999996, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.478, "replay_time_ms": 86.771, "update_priorities_time_ms": 47.732, "policy_agent_0": {"added_count": 2903296, "sampled_count": 4293120, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2903296, "sampled_count": 4293120, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42313438653945923, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41505634784698486, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 11656448, "episodes_total": 116568, "training_iteration": 122, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-36-49", "timestamp": 1569058609, "time_this_iter_s": 30.593014001846313, "time_total_s": 3732.827423810959, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36739268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3732.827423810959, "timesteps_since_restore": 11656448, "iterations_since_restore": 122, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.00820937159576, "episode_reward_min": 42.93419841639147, "episode_reward_mean": 49.590975063463, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.988083079603896, "agent_1": 23.60289198385913}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.686545793106936, "mean_processing_ms": 3.6292118170356256, "mean_inference_ms": 2.138141847959991}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 348, "num_steps_trained": 17506816, "num_steps_sampled": 11757312, "sample_throughput": 6715.587, "train_throughput": 0.0, "num_weight_syncs": 22963, "num_samples_dropped": 599, "learner_queue": {"size_count": 78728, "size_mean": 0.1, "size_std": 0.36055512754639896, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.163, "replay_time_ms": 96.896, "update_priorities_time_ms": 52.429, "policy_agent_0": {"added_count": 2929920, "sampled_count": 4327936, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2929920, "sampled_count": 4327936, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4536212086677551, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44925254583358765, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 11757312, "episodes_total": 117584, "training_iteration": 123, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-37-20", "timestamp": 1569058640, "time_this_iter_s": 30.572819709777832, "time_total_s": 3763.4002435207367, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36739ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3763.4002435207367, "timesteps_since_restore": 11757312, "iterations_since_restore": 123, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.3746998689277, "episode_reward_min": 44.20598421984932, "episode_reward_mean": 48.03285211995446, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.007959021000442, "agent_1": 20.02489309895407}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6863568482519433, "mean_processing_ms": 3.6284530103993813, "mean_inference_ms": 2.13802616243639}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 351, "num_steps_trained": 17653248, "num_steps_sampled": 11856128, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23155, "num_samples_dropped": 599, "learner_queue": {"size_count": 79299, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.185, "replay_time_ms": 109.101, "update_priorities_time_ms": 47.467, "policy_agent_0": {"added_count": 2956032, "sampled_count": 4366080, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2956032, "sampled_count": 4366080, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4448027014732361, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5728716850280762, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 11856128, "episodes_total": 118568, "training_iteration": 124, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-37-51", "timestamp": 1569058671, "time_this_iter_s": 30.528517723083496, "time_total_s": 3793.92876124382, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366e58c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3793.92876124382, "timesteps_since_restore": 11856128, "iterations_since_restore": 124, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.63256704728517, "episode_reward_min": 41.234498784293514, "episode_reward_mean": 46.1060851849556, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.20225344616726, "agent_1": 20.903831738788412}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6863206206254747, "mean_processing_ms": 3.6275116970605104, "mean_inference_ms": 2.1372147954891525}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 354, "num_steps_trained": 17797120, "num_steps_sampled": 11954944, "sample_throughput": 0.0, "train_throughput": 11888.985, "num_weight_syncs": 23348, "num_samples_dropped": 599, "learner_queue": {"size_count": 79861, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.448, "replay_time_ms": 104.52, "update_priorities_time_ms": 51.67, "policy_agent_0": {"added_count": 2980352, "sampled_count": 4402688, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 2980352, "sampled_count": 4402688, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4561105966567993, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6963292360305786, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 11954944, "episodes_total": 119560, "training_iteration": 125, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-38-21", "timestamp": 1569058701, "time_this_iter_s": 30.662712574005127, "time_total_s": 3824.5914738178253, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365e4510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3824.5914738178253, "timesteps_since_restore": 11954944, "iterations_since_restore": 125, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 52.51084894823646, "episode_reward_min": 43.9272074369542, "episode_reward_mean": 49.32824097690188, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.513943480026946, "agent_1": 21.814297496874953}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6861562931610702, "mean_processing_ms": 3.6262854564803684, "mean_inference_ms": 2.1355133895609044}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 357, "num_steps_trained": 17939456, "num_steps_sampled": 12055296, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23544, "num_samples_dropped": 599, "learner_queue": {"size_count": 80417, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.624, "replay_time_ms": 93.653, "update_priorities_time_ms": 51.1, "policy_agent_0": {"added_count": 3002368, "sampled_count": 4438528, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3002368, "sampled_count": 4438528, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47526004910469055, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.775945246219635, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 12055296, "episodes_total": 120560, "training_iteration": 126, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-38-52", "timestamp": 1569058732, "time_this_iter_s": 30.57142925262451, "time_total_s": 3855.16290307045, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365e39d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3855.16290307045, "timesteps_since_restore": 12055296, "iterations_since_restore": 126, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 50.79947416657881, "episode_reward_min": 45.85625186560049, "episode_reward_mean": 48.46203825996809, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.56409742322364, "agent_1": 22.897940836744514}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6856118373080586, "mean_processing_ms": 3.6252135520705266, "mean_inference_ms": 2.134990554295213}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 360, "num_steps_trained": 18085120, "num_steps_sampled": 12154624, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23739, "num_samples_dropped": 599, "learner_queue": {"size_count": 80986, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.021, "replay_time_ms": 80.6, "update_priorities_time_ms": 45.539, "policy_agent_0": {"added_count": 3025408, "sampled_count": 4477696, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3025408, "sampled_count": 4477696, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48594987392425537, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8161051869392395, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 12154624, "episodes_total": 121544, "training_iteration": 127, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-39-22", "timestamp": 1569058762, "time_this_iter_s": 30.52236318588257, "time_total_s": 3885.6852662563324, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365d3620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3885.6852662563324, "timesteps_since_restore": 12154624, "iterations_since_restore": 127, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 52.87002301364949, "episode_reward_min": 47.964197323815476, "episode_reward_mean": 50.92093760489922, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.190858291954164, "agent_1": 23.730079312945136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6856964659832112, "mean_processing_ms": 3.625119926504218, "mean_inference_ms": 2.134577288259581}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 363, "num_steps_trained": 18232576, "num_steps_sampled": 12252928, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23931, "num_samples_dropped": 599, "learner_queue": {"size_count": 81562, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.314, "replay_time_ms": 121.311, "update_priorities_time_ms": 56.372, "policy_agent_0": {"added_count": 3046912, "sampled_count": 4514304, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3046912, "sampled_count": 4514304, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4968735873699188, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8056867122650146, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 12252928, "episodes_total": 122528, "training_iteration": 128, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-39-53", "timestamp": 1569058793, "time_this_iter_s": 30.57517719268799, "time_total_s": 3916.2604434490204, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3656dae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3916.2604434490204, "timesteps_since_restore": 12252928, "iterations_since_restore": 128, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.39690912798038, "episode_reward_min": 49.406046808070855, "episode_reward_mean": 52.435038088082734, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.244157444238446, "agent_1": 24.190880643844345}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6853046171635473, "mean_processing_ms": 3.624541279704704, "mean_inference_ms": 2.1345358948485336}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 366, "num_steps_trained": 18377728, "num_steps_sampled": 12350208, "sample_throughput": 8068.394, "train_throughput": 0.0, "num_weight_syncs": 24121, "num_samples_dropped": 599, "learner_queue": {"size_count": 82129, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.97, "replay_time_ms": 111.45, "update_priorities_time_ms": 51.338, "policy_agent_0": {"added_count": 3069440, "sampled_count": 4549632, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3069440, "sampled_count": 4549632, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4724198579788208, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7960612177848816, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 12350208, "episodes_total": 123512, "training_iteration": 129, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-40-24", "timestamp": 1569058824, "time_this_iter_s": 30.55089807510376, "time_total_s": 3946.811341524124, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36572730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3946.811341524124, "timesteps_since_restore": 12350208, "iterations_since_restore": 129, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 52.89813039378527, "episode_reward_min": 49.331555707317285, "episode_reward_mean": 51.99919175758235, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.682134973350994, "agent_1": 24.317056784231422}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6858316814129494, "mean_processing_ms": 3.6259201001939134, "mean_inference_ms": 2.1343671691723314}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 369, "num_steps_trained": 18520320, "num_steps_sampled": 12449024, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24313, "num_samples_dropped": 599, "learner_queue": {"size_count": 82686, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 26.872, "replay_time_ms": 77.622, "update_priorities_time_ms": 44.856, "policy_agent_0": {"added_count": 3096320, "sampled_count": 4586752, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3096320, "sampled_count": 4586752, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4455530643463135, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7794557809829712, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 12449024, "episodes_total": 124496, "training_iteration": 130, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-40-54", "timestamp": 1569058854, "time_this_iter_s": 30.48536252975464, "time_total_s": 3977.296704053879, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36578bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3977.296704053879, "timesteps_since_restore": 12449024, "iterations_since_restore": 130, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 50.666052777165454, "episode_reward_min": 46.78492289717211, "episode_reward_mean": 47.80423377684859, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 22.6601618101018, "agent_1": 25.144071966746772}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6858916777970415, "mean_processing_ms": 3.6263861660705117, "mean_inference_ms": 2.1338728047658764}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 371, "num_steps_trained": 18663936, "num_steps_sampled": 12546560, "sample_throughput": 0.0, "train_throughput": 12990.646, "num_weight_syncs": 24504, "num_samples_dropped": 599, "learner_queue": {"size_count": 83247, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.486, "replay_time_ms": 105.515, "update_priorities_time_ms": 55.828, "policy_agent_0": {"added_count": 3121408, "sampled_count": 4622592, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3121408, "sampled_count": 4622592, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4696575403213501, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7524887919425964, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 12546560, "episodes_total": 125472, "training_iteration": 131, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-41-25", "timestamp": 1569058885, "time_this_iter_s": 30.47349452972412, "time_total_s": 4007.770198583603, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365e3b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4007.770198583603, "timesteps_since_restore": 12546560, "iterations_since_restore": 131, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.41692638367046, "episode_reward_min": 45.876971233307785, "episode_reward_mean": 47.2742669792605, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 21.89829370099791, "agent_1": 25.375973278262556}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6856787930265891, "mean_processing_ms": 3.625932000868106, "mean_inference_ms": 2.1332133695903432}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 374, "num_steps_trained": 18805760, "num_steps_sampled": 12646656, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24700, "num_samples_dropped": 599, "learner_queue": {"size_count": 83802, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.132, "replay_time_ms": 122.644, "update_priorities_time_ms": 66.347, "policy_agent_0": {"added_count": 3149568, "sampled_count": 4658688, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3149568, "sampled_count": 4658688, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5696569681167603, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7115846872329712, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 12646656, "episodes_total": 126472, "training_iteration": 132, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-41-55", "timestamp": 1569058915, "time_this_iter_s": 30.568288803100586, "time_total_s": 4038.3384873867035, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365e4048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4038.3384873867035, "timesteps_since_restore": 12646656, "iterations_since_restore": 132, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.37932002248304, "episode_reward_min": 45.73180948764497, "episode_reward_mean": 47.23838723284844, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 22.007963865119972, "agent_1": 25.23042336772844}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6862888379165121, "mean_processing_ms": 3.6280648622943414, "mean_inference_ms": 2.1343995231116017}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 377, "num_steps_trained": 18956288, "num_steps_sampled": 12742912, "sample_throughput": 14529.463, "train_throughput": 0.0, "num_weight_syncs": 24887, "num_samples_dropped": 599, "learner_queue": {"size_count": 84389, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.101, "replay_time_ms": 98.582, "update_priorities_time_ms": 53.337, "policy_agent_0": {"added_count": 3173632, "sampled_count": 4698368, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3173632, "sampled_count": 4698368, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6936759948730469, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6720816493034363, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 12742912, "episodes_total": 127432, "training_iteration": 133, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-42-26", "timestamp": 1569058946, "time_this_iter_s": 30.56801152229309, "time_total_s": 4068.9064989089966, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36739bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4068.9064989089966, "timesteps_since_restore": 12742912, "iterations_since_restore": 133, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.84019356332233, "episode_reward_min": 45.90485279481132, "episode_reward_mean": 47.36034910571566, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 22.210759237725284, "agent_1": 25.14958986799034}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6857269359695105, "mean_processing_ms": 3.625724308885079, "mean_inference_ms": 2.1332393498502475}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 380, "num_steps_trained": 19101184, "num_steps_sampled": 12841472, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25080, "num_samples_dropped": 599, "learner_queue": {"size_count": 84956, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.176, "replay_time_ms": 83.25, "update_priorities_time_ms": 43.306, "policy_agent_0": {"added_count": 3202816, "sampled_count": 4733952, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3202816, "sampled_count": 4733952, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7505243420600891, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.645055890083313, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 12841472, "episodes_total": 128416, "training_iteration": 134, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-42-56", "timestamp": 1569058976, "time_this_iter_s": 30.46468210220337, "time_total_s": 4099.3711810112, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366f9b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4099.3711810112, "timesteps_since_restore": 12841472, "iterations_since_restore": 134, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.39040136229625, "episode_reward_min": 45.929093578187725, "episode_reward_mean": 47.374860651308026, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 22.417081825729284, "agent_1": 24.957778825578707}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6852480048375973, "mean_processing_ms": 3.6246330365786426, "mean_inference_ms": 2.133150182872412}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 383, "num_steps_trained": 19253760, "num_steps_sampled": 12938240, "sample_throughput": 15048.096, "train_throughput": 0.0, "num_weight_syncs": 25268, "num_samples_dropped": 599, "learner_queue": {"size_count": 85551, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.19, "replay_time_ms": 107.798, "update_priorities_time_ms": 54.659, "policy_agent_0": {"added_count": 3228416, "sampled_count": 4773632, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3228416, "sampled_count": 4773632, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7730798721313477, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6364086270332336, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 12938240, "episodes_total": 129392, "training_iteration": 135, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-43-27", "timestamp": 1569059007, "time_this_iter_s": 30.538641691207886, "time_total_s": 4129.909822702408, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36609b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4129.909822702408, "timesteps_since_restore": 12938240, "iterations_since_restore": 135, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.28446894669057, "episode_reward_min": 45.810978029306796, "episode_reward_mean": 47.00081154745436, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 22.13111233657481, "agent_1": 24.869699210879503}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6855432878255547, "mean_processing_ms": 3.6231885804300976, "mean_inference_ms": 2.132388761422794}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 386, "num_steps_trained": 19400448, "num_steps_sampled": 13037312, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25462, "num_samples_dropped": 599, "learner_queue": {"size_count": 86124, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.527, "replay_time_ms": 89.337, "update_priorities_time_ms": 48.053, "policy_agent_0": {"added_count": 3251968, "sampled_count": 4809984, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3251968, "sampled_count": 4809984, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7989100217819214, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6255751848220825, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 13037312, "episodes_total": 130384, "training_iteration": 136, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-43-57", "timestamp": 1569059037, "time_this_iter_s": 30.613044023513794, "time_total_s": 4160.522866725922, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3668d488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4160.522866725922, "timesteps_since_restore": 13037312, "iterations_since_restore": 136, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.035862129098405, "episode_reward_min": 45.76919283836475, "episode_reward_mean": 47.02680479046239, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 21.539608136369303, "agent_1": 25.487196654093072}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6852050485291307, "mean_processing_ms": 3.622482251871752, "mean_inference_ms": 2.1322170369758022}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 389, "num_steps_trained": 19545344, "num_steps_sampled": 13135616, "sample_throughput": 0.0, "train_throughput": 11938.424, "num_weight_syncs": 25654, "num_samples_dropped": 599, "learner_queue": {"size_count": 86690, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.787, "replay_time_ms": 100.738, "update_priorities_time_ms": 50.565, "policy_agent_0": {"added_count": 3276800, "sampled_count": 4844032, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3276800, "sampled_count": 4844032, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8152623176574707, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6059545278549194, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 13135616, "episodes_total": 131360, "training_iteration": 137, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-44-28", "timestamp": 1569059068, "time_this_iter_s": 30.564831256866455, "time_total_s": 4191.087697982788, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3664a048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4191.087697982788, "timesteps_since_restore": 13135616, "iterations_since_restore": 137, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.11603782523851, "episode_reward_min": 44.98209155167459, "episode_reward_mean": 46.73948181960695, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 20.72272031114991, "agent_1": 26.016761508457073}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6850047716015335, "mean_processing_ms": 3.621113469764965, "mean_inference_ms": 2.1317753819898697}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 392, "num_steps_trained": 19697920, "num_steps_sampled": 13231616, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25842, "num_samples_dropped": 599, "learner_queue": {"size_count": 87286, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.123, "replay_time_ms": 91.331, "update_priorities_time_ms": 49.82, "policy_agent_0": {"added_count": 3301888, "sampled_count": 4884480, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3301888, "sampled_count": 4884480, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8256627917289734, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5923796892166138, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 13231616, "episodes_total": 132320, "training_iteration": 138, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-44-59", "timestamp": 1569059099, "time_this_iter_s": 30.51011896133423, "time_total_s": 4221.597816944122, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3673e0d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4221.597816944122, "timesteps_since_restore": 13231616, "iterations_since_restore": 138, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 47.02754122170216, "episode_reward_min": 44.86923824826013, "episode_reward_mean": 46.03724188361527, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 20.211006988501083, "agent_1": 25.826234895114233}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.684765199753015, "mean_processing_ms": 3.620867469551465, "mean_inference_ms": 2.1311249763116846}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 395, "num_steps_trained": 19844096, "num_steps_sampled": 13330944, "sample_throughput": 14543.041, "train_throughput": 0.0, "num_weight_syncs": 26037, "num_samples_dropped": 599, "learner_queue": {"size_count": 87858, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.203, "replay_time_ms": 87.465, "update_priorities_time_ms": 48.302, "policy_agent_0": {"added_count": 3329024, "sampled_count": 4922624, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3329024, "sampled_count": 4922624, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8362702131271362, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5812665224075317, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 13330944, "episodes_total": 133320, "training_iteration": 139, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-45-29", "timestamp": 1569059129, "time_this_iter_s": 30.55020523071289, "time_total_s": 4252.148022174835, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36f880d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4252.148022174835, "timesteps_since_restore": 13330944, "iterations_since_restore": 139, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.357899611221185, "episode_reward_min": 45.204262677444326, "episode_reward_mean": 47.03929714805815, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 20.895018406228242, "agent_1": 26.144278741829922}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6851716932463628, "mean_processing_ms": 3.623084107942647, "mean_inference_ms": 2.1318722589845063}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 398, "num_steps_trained": 19994624, "num_steps_sampled": 13427712, "sample_throughput": 0.0, "train_throughput": 22357.977, "num_weight_syncs": 26224, "num_samples_dropped": 599, "learner_queue": {"size_count": 88446, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.936, "replay_time_ms": 92.493, "update_priorities_time_ms": 54.819, "policy_agent_0": {"added_count": 3352064, "sampled_count": 4960768, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3352064, "sampled_count": 4960768, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.838471531867981, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5624265670776367, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 13427712, "episodes_total": 134288, "training_iteration": 140, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-46-00", "timestamp": 1569059160, "time_this_iter_s": 30.518067598342896, "time_total_s": 4282.666089773178, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3671e8c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4282.666089773178, "timesteps_since_restore": 13427712, "iterations_since_restore": 140, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.53126650678318, "episode_reward_min": 45.66048491462587, "episode_reward_mean": 47.77437193672576, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 21.353416837552082, "agent_1": 26.420955099173685}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6848288478034491, "mean_processing_ms": 3.6208917095659614, "mean_inference_ms": 2.1310871114470316}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 401, "num_steps_trained": 20141312, "num_steps_sampled": 13526016, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26416, "num_samples_dropped": 599, "learner_queue": {"size_count": 89018, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.894, "replay_time_ms": 104.531, "update_priorities_time_ms": 64.154, "policy_agent_0": {"added_count": 3373568, "sampled_count": 4999168, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3373568, "sampled_count": 4999168, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8256591558456421, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5521504878997803, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 13526016, "episodes_total": 135264, "training_iteration": 141, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-46-30", "timestamp": 1569059190, "time_this_iter_s": 30.507055521011353, "time_total_s": 4313.173145294189, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365f7510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4313.173145294189, "timesteps_since_restore": 13526016, "iterations_since_restore": 141, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.39806852881434, "episode_reward_min": 47.48270676357472, "episode_reward_mean": 47.84109502988211, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 21.39063699712002, "agent_1": 26.45045803276209}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.684526877563989, "mean_processing_ms": 3.619550595272688, "mean_inference_ms": 2.1301168054850526}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 404, "num_steps_trained": 20289024, "num_steps_sampled": 13624576, "sample_throughput": 9822.367, "train_throughput": 0.0, "num_weight_syncs": 26610, "num_samples_dropped": 599, "learner_queue": {"size_count": 89596, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.159, "replay_time_ms": 97.295, "update_priorities_time_ms": 52.891, "policy_agent_0": {"added_count": 3393536, "sampled_count": 5039616, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3393536, "sampled_count": 5039616, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.830575168132782, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5282477736473083, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 13624576, "episodes_total": 136256, "training_iteration": 142, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-47-01", "timestamp": 1569059221, "time_this_iter_s": 30.609251976013184, "time_total_s": 4343.782397270203, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366bb510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4343.782397270203, "timesteps_since_restore": 13624576, "iterations_since_restore": 142, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.23349555230415, "episode_reward_min": 47.01685583234911, "episode_reward_mean": 47.74253767010429, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 21.387069188239497, "agent_1": 26.355468481864804}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6852991851494115, "mean_processing_ms": 3.6217204939716456, "mean_inference_ms": 2.1296597826165677}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 407, "num_steps_trained": 20433408, "num_steps_sampled": 13724416, "sample_throughput": 16737.986, "train_throughput": 0.0, "num_weight_syncs": 26804, "num_samples_dropped": 599, "learner_queue": {"size_count": 90160, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.876, "replay_time_ms": 111.182, "update_priorities_time_ms": 55.202, "policy_agent_0": {"added_count": 3416064, "sampled_count": 5076480, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3416064, "sampled_count": 5076480, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8268890976905823, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5110660791397095, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 13724416, "episodes_total": 137248, "training_iteration": 143, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-47-32", "timestamp": 1569059252, "time_this_iter_s": 30.667976140975952, "time_total_s": 4374.450373411179, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36651598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4374.450373411179, "timesteps_since_restore": 13724416, "iterations_since_restore": 143, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.22902532637948, "episode_reward_min": 47.22263883553687, "episode_reward_mean": 47.723247290052676, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 21.350539777542988, "agent_1": 26.372707512509702}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6851520254179833, "mean_processing_ms": 3.6213906246879097, "mean_inference_ms": 2.129004896754009}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 410, "num_steps_trained": 20581120, "num_steps_sampled": 13824768, "sample_throughput": 0.0, "train_throughput": 16304.389, "num_weight_syncs": 27000, "num_samples_dropped": 599, "learner_queue": {"size_count": 90736, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.064, "replay_time_ms": 98.215, "update_priorities_time_ms": 49.758, "policy_agent_0": {"added_count": 3440640, "sampled_count": 5113856, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3440640, "sampled_count": 5113856, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8227359652519226, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5037980079650879, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 13824768, "episodes_total": 138248, "training_iteration": 144, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-48-02", "timestamp": 1569059282, "time_this_iter_s": 30.518468856811523, "time_total_s": 4404.96884226799, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36657488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4404.96884226799, "timesteps_since_restore": 13824768, "iterations_since_restore": 144, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.103923820581436, "episode_reward_min": 46.083232280261356, "episode_reward_mean": 47.686915991268194, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 21.32614620031067, "agent_1": 26.36076979095753}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6854210986256616, "mean_processing_ms": 3.6210293558075617, "mean_inference_ms": 2.1286798301970298}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 413, "num_steps_trained": 20729600, "num_steps_sampled": 13924096, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27194, "num_samples_dropped": 599, "learner_queue": {"size_count": 91316, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.382, "replay_time_ms": 105.178, "update_priorities_time_ms": 51.691, "policy_agent_0": {"added_count": 3462912, "sampled_count": 5150464, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3462912, "sampled_count": 5150464, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.832966148853302, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49800819158554077, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 13924096, "episodes_total": 139248, "training_iteration": 145, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-48-33", "timestamp": 1569059313, "time_this_iter_s": 30.57041096687317, "time_total_s": 4435.539253234863, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365ef048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4435.539253234863, "timesteps_since_restore": 13924096, "iterations_since_restore": 145, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.428955335275866, "episode_reward_min": 47.22119583383314, "episode_reward_mean": 47.82324470084429, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 21.341739601095693, "agent_1": 26.481505099748603}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6855231539103137, "mean_processing_ms": 3.621103534201402, "mean_inference_ms": 2.1284416533408526}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 415, "num_steps_trained": 20875520, "num_steps_sampled": 14025728, "sample_throughput": 15865.917, "train_throughput": 0.0, "num_weight_syncs": 27392, "num_samples_dropped": 599, "learner_queue": {"size_count": 91886, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.367, "replay_time_ms": 125.105, "update_priorities_time_ms": 62.559, "policy_agent_0": {"added_count": 3489280, "sampled_count": 5186816, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3489280, "sampled_count": 5186816, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8318728804588318, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4891406297683716, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 14025728, "episodes_total": 140264, "training_iteration": 146, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-49-03", "timestamp": 1569059343, "time_this_iter_s": 30.605354070663452, "time_total_s": 4466.144607305527, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365c9840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4466.144607305527, "timesteps_since_restore": 14025728, "iterations_since_restore": 146, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.495930681162285, "episode_reward_min": 46.805409261205874, "episode_reward_mean": 47.89487160168151, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 21.369402685219487, "agent_1": 26.525468916462014}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6848889325641447, "mean_processing_ms": 3.6173005084506844, "mean_inference_ms": 2.126760699239867}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 418, "num_steps_trained": 21022976, "num_steps_sampled": 14124800, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27586, "num_samples_dropped": 599, "learner_queue": {"size_count": 92463, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.267, "replay_time_ms": 94.252, "update_priorities_time_ms": 48.389, "policy_agent_0": {"added_count": 3513344, "sampled_count": 5224704, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3513344, "sampled_count": 5224704, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8212041854858398, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4804457426071167, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 14124800, "episodes_total": 141248, "training_iteration": 147, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-49-34", "timestamp": 1569059374, "time_this_iter_s": 30.550789833068848, "time_total_s": 4496.695397138596, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366dcf28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4496.695397138596, "timesteps_since_restore": 14124800, "iterations_since_restore": 147, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.49681376897166, "episode_reward_min": 45.76034172646635, "episode_reward_mean": 47.73196733719774, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 21.627131591802915, "agent_1": 26.104835745394812}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6844910317658179, "mean_processing_ms": 3.617055356210249, "mean_inference_ms": 2.126720624980761}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 421, "num_steps_trained": 21169152, "num_steps_sampled": 14225408, "sample_throughput": 6864.918, "train_throughput": 6864.918, "num_weight_syncs": 27783, "num_samples_dropped": 599, "learner_queue": {"size_count": 93035, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.756, "replay_time_ms": 103.272, "update_priorities_time_ms": 58.14, "policy_agent_0": {"added_count": 3538944, "sampled_count": 5261824, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3538944, "sampled_count": 5261824, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8301148414611816, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4733051657676697, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 14225408, "episodes_total": 142264, "training_iteration": 148, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-50-05", "timestamp": 1569059405, "time_this_iter_s": 30.677751541137695, "time_total_s": 4527.373148679733, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365b22f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4527.373148679733, "timesteps_since_restore": 14225408, "iterations_since_restore": 148, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 47.45417297120918, "episode_reward_min": 43.9995355778796, "episode_reward_mean": 45.58241527341975, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 21.715296426870793, "agent_1": 23.867118846548976}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.684273229818999, "mean_processing_ms": 3.614091006881902, "mean_inference_ms": 2.1252328913390675}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 424, "num_steps_trained": 21313792, "num_steps_sampled": 14326784, "sample_throughput": 0.0, "train_throughput": 20440.156, "num_weight_syncs": 27981, "num_samples_dropped": 599, "learner_queue": {"size_count": 93598, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.937, "replay_time_ms": 103.415, "update_priorities_time_ms": 55.008, "policy_agent_0": {"added_count": 3565824, "sampled_count": 5298688, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3565824, "sampled_count": 5298688, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8406856656074524, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5131534337997437, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 14326784, "episodes_total": 143280, "training_iteration": 149, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-50-35", "timestamp": 1569059435, "time_this_iter_s": 30.526402235031128, "time_total_s": 4557.899550914764, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365cc950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4557.899550914764, "timesteps_since_restore": 14326784, "iterations_since_restore": 149, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 46.91535682970072, "episode_reward_min": 44.44076889664553, "episode_reward_mean": 45.40928655261122, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 21.48717657006378, "agent_1": 23.922109982547457}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6845339310445441, "mean_processing_ms": 3.6159178553974685, "mean_inference_ms": 2.12552871952546}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 427, "num_steps_trained": 21462528, "num_steps_sampled": 14425344, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28173, "num_samples_dropped": 599, "learner_queue": {"size_count": 94179, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.099, "replay_time_ms": 71.45, "update_priorities_time_ms": 43.918, "policy_agent_0": {"added_count": 3592192, "sampled_count": 5335552, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3592192, "sampled_count": 5335552, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8424099683761597, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5480464696884155, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 14425344, "episodes_total": 144264, "training_iteration": 150, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-51-06", "timestamp": 1569059466, "time_this_iter_s": 30.505394220352173, "time_total_s": 4588.404945135117, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3658cb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4588.404945135117, "timesteps_since_restore": 14425344, "iterations_since_restore": 150, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 47.134704374005096, "episode_reward_min": 42.82884912118459, "episode_reward_mean": 46.01940744495847, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 21.723930021900376, "agent_1": 24.295477423058085}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.685137489160186, "mean_processing_ms": 3.6183091082384085, "mean_inference_ms": 2.1253171971830356}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 430, "num_steps_trained": 21608192, "num_steps_sampled": 14525440, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28369, "num_samples_dropped": 599, "learner_queue": {"size_count": 94748, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.397, "replay_time_ms": 106.142, "update_priorities_time_ms": 53.668, "policy_agent_0": {"added_count": 3617280, "sampled_count": 5373184, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3617280, "sampled_count": 5373184, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8398067951202393, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5961825847625732, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 14525440, "episodes_total": 145256, "training_iteration": 151, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-51-36", "timestamp": 1569059496, "time_this_iter_s": 30.469645261764526, "time_total_s": 4618.874590396881, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3658b7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4618.874590396881, "timesteps_since_restore": 14525440, "iterations_since_restore": 151, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 47.39320155808135, "episode_reward_min": 43.12561848982863, "episode_reward_mean": 46.66482655674701, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 21.783191125919778, "agent_1": 24.88163543082721}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6850453978885213, "mean_processing_ms": 3.6154638380753106, "mean_inference_ms": 2.124427672226542}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 433, "num_steps_trained": 21754368, "num_steps_sampled": 14624000, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28562, "num_samples_dropped": 599, "learner_queue": {"size_count": 95319, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.073, "replay_time_ms": 116.007, "update_priorities_time_ms": 54.633, "policy_agent_0": {"added_count": 3642368, "sampled_count": 5410048, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3642368, "sampled_count": 5410048, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8478797674179077, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6137904524803162, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 14624000, "episodes_total": 146240, "training_iteration": 152, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-52-07", "timestamp": 1569059527, "time_this_iter_s": 30.670111656188965, "time_total_s": 4649.54470205307, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36592c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4649.54470205307, "timesteps_since_restore": 14624000, "iterations_since_restore": 152, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 47.43877703620547, "episode_reward_min": 46.35408648536113, "episode_reward_mean": 46.90669324895616, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 21.849149724099032, "agent_1": 25.057543524857095}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6842098480384483, "mean_processing_ms": 3.611980966930194, "mean_inference_ms": 2.123264768921191}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 436, "num_steps_trained": 21901312, "num_steps_sampled": 14723840, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28756, "num_samples_dropped": 599, "learner_queue": {"size_count": 95894, "size_mean": 0.2, "size_std": 0.48989794855663565, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.874, "replay_time_ms": 99.168, "update_priorities_time_ms": 54.89, "policy_agent_0": {"added_count": 3666944, "sampled_count": 5448192, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3666944, "sampled_count": 5448192, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8418384790420532, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.597333550453186, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 14723840, "episodes_total": 147240, "training_iteration": 153, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-52-38", "timestamp": 1569059558, "time_this_iter_s": 30.69967007637024, "time_total_s": 4680.24437212944, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365a18c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4680.24437212944, "timesteps_since_restore": 14723840, "iterations_since_restore": 153, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 47.419983454384514, "episode_reward_min": 46.57100075331764, "episode_reward_mean": 46.968699256300646, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 21.827890289231895, "agent_1": 25.140808967068708}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6843882925318195, "mean_processing_ms": 3.612924702474898, "mean_inference_ms": 2.1236817990754426}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 439, "num_steps_trained": 22054656, "num_steps_sampled": 14820096, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28944, "num_samples_dropped": 599, "learner_queue": {"size_count": 96492, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.719, "replay_time_ms": 98.54, "update_priorities_time_ms": 55.824, "policy_agent_0": {"added_count": 3687936, "sampled_count": 5487872, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3687936, "sampled_count": 5487872, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8477941155433655, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5782065391540527, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 14820096, "episodes_total": 148208, "training_iteration": 154, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-53-08", "timestamp": 1569059588, "time_this_iter_s": 30.60227131843567, "time_total_s": 4710.846643447876, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365a5d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4710.846643447876, "timesteps_since_restore": 14820096, "iterations_since_restore": 154, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 47.41805893628429, "episode_reward_min": 46.58012143615462, "episode_reward_mean": 46.97111293491469, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 21.8299303115982, "agent_1": 25.141182623316457}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6841111681954126, "mean_processing_ms": 3.611648497632371, "mean_inference_ms": 2.123239810750909}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 442, "num_steps_trained": 22202880, "num_steps_sampled": 14919424, "sample_throughput": 5617.068, "train_throughput": 5617.068, "num_weight_syncs": 29139, "num_samples_dropped": 599, "learner_queue": {"size_count": 97072, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.812, "replay_time_ms": 94.774, "update_priorities_time_ms": 52.372, "policy_agent_0": {"added_count": 3712000, "sampled_count": 5528320, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3712000, "sampled_count": 5528320, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8563421368598938, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5782987475395203, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 14919424, "episodes_total": 149200, "training_iteration": 155, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-53-39", "timestamp": 1569059619, "time_this_iter_s": 30.65181827545166, "time_total_s": 4741.498461723328, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3658cbf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4741.498461723328, "timesteps_since_restore": 14919424, "iterations_since_restore": 155, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 47.33091533350009, "episode_reward_min": 46.58460917896186, "episode_reward_mean": 46.91943810550696, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 21.84479193640454, "agent_1": 25.074646169102387}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6842190586961633, "mean_processing_ms": 3.612739224645976, "mean_inference_ms": 2.1240097862443057}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 445, "num_steps_trained": 22352128, "num_steps_sampled": 15016704, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29328, "num_samples_dropped": 599, "learner_queue": {"size_count": 97654, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.108, "replay_time_ms": 99.491, "update_priorities_time_ms": 53.04, "policy_agent_0": {"added_count": 3737088, "sampled_count": 5567232, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3737088, "sampled_count": 5567232, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8520733714103699, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5763006210327148, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 15016704, "episodes_total": 150168, "training_iteration": 156, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-54-10", "timestamp": 1569059650, "time_this_iter_s": 30.580052375793457, "time_total_s": 4772.078514099121, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36612730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4772.078514099121, "timesteps_since_restore": 15016704, "iterations_since_restore": 156, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 47.32699476388022, "episode_reward_min": 45.30373756301242, "episode_reward_mean": 46.8992180603797, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 21.839895640038623, "agent_1": 25.059322420341037}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6841970093120743, "mean_processing_ms": 3.6126300794595974, "mean_inference_ms": 2.123677325563439}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 448, "num_steps_trained": 22497792, "num_steps_sampled": 15116800, "sample_throughput": 6974.569, "train_throughput": 0.0, "num_weight_syncs": 29525, "num_samples_dropped": 599, "learner_queue": {"size_count": 98223, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.602, "replay_time_ms": 124.11, "update_priorities_time_ms": 55.634, "policy_agent_0": {"added_count": 3764736, "sampled_count": 5602560, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3764736, "sampled_count": 5602560, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8521474003791809, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5561782717704773, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 15116800, "episodes_total": 151160, "training_iteration": 157, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-54-40", "timestamp": 1569059680, "time_this_iter_s": 30.686590671539307, "time_total_s": 4802.76510477066, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365b2488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4802.76510477066, "timesteps_since_restore": 15116800, "iterations_since_restore": 157, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 47.25867480572161, "episode_reward_min": 42.557749742387465, "episode_reward_mean": 46.81312484097722, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 21.82073472550413, "agent_1": 24.992390115473054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6840404696747128, "mean_processing_ms": 3.611531693512024, "mean_inference_ms": 2.1229400074446465}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 451, "num_steps_trained": 22642688, "num_steps_sampled": 15216896, "sample_throughput": 5305.311, "train_throughput": 10610.621, "num_weight_syncs": 29720, "num_samples_dropped": 599, "learner_queue": {"size_count": 98789, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.969, "replay_time_ms": 102.794, "update_priorities_time_ms": 51.826, "policy_agent_0": {"added_count": 3789312, "sampled_count": 5639680, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3789312, "sampled_count": 5639680, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8522765636444092, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5606415867805481, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 15216896, "episodes_total": 152176, "training_iteration": 158, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-55-11", "timestamp": 1569059711, "time_this_iter_s": 30.602060556411743, "time_total_s": 4833.367165327072, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366dcd08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4833.367165327072, "timesteps_since_restore": 15216896, "iterations_since_restore": 158, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 47.38487811005418, "episode_reward_min": 43.546409226398936, "episode_reward_mean": 46.113195950704686, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 21.79099555558937, "agent_1": 24.32220039511529}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6840733157912571, "mean_processing_ms": 3.612034552595662, "mean_inference_ms": 2.1225761226275655}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 454, "num_steps_trained": 22786304, "num_steps_sampled": 15317504, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29916, "num_samples_dropped": 599, "learner_queue": {"size_count": 99350, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.186, "replay_time_ms": 104.524, "update_priorities_time_ms": 56.641, "policy_agent_0": {"added_count": 3815680, "sampled_count": 5675776, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3815680, "sampled_count": 5675776, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8496326208114624, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5810723900794983, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 15317504, "episodes_total": 153176, "training_iteration": 159, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-55-42", "timestamp": 1569059742, "time_this_iter_s": 30.677698612213135, "time_total_s": 4864.044863939285, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366b0488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4864.044863939285, "timesteps_since_restore": 15317504, "iterations_since_restore": 159, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 50.20847976767111, "episode_reward_min": 43.30383582143594, "episode_reward_mean": 45.643097986199976, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 22.219318145144936, "agent_1": 23.423779841055012}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6839823315606234, "mean_processing_ms": 3.6106315748434676, "mean_inference_ms": 2.122092181307856}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 456, "num_steps_trained": 22931200, "num_steps_sampled": 15417856, "sample_throughput": 12776.405, "train_throughput": 0.0, "num_weight_syncs": 30112, "num_samples_dropped": 599, "learner_queue": {"size_count": 99916, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.67, "replay_time_ms": 108.958, "update_priorities_time_ms": 53.666, "policy_agent_0": {"added_count": 3842560, "sampled_count": 5711616, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3842560, "sampled_count": 5711616, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8591946959495544, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6130044460296631, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 15417856, "episodes_total": 154192, "training_iteration": 160, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-56-12", "timestamp": 1569059772, "time_this_iter_s": 30.6580331325531, "time_total_s": 4894.702897071838, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36657c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4894.702897071838, "timesteps_since_restore": 15417856, "iterations_since_restore": 160, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 50.368767414755105, "episode_reward_min": 43.52472207152842, "episode_reward_mean": 48.27501292794586, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 24.12978500597948, "agent_1": 24.145227921966328}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6836583014158228, "mean_processing_ms": 3.61172833197822, "mean_inference_ms": 2.1220664146271195}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 459, "num_steps_trained": 23077632, "num_steps_sampled": 15517184, "sample_throughput": 24399.342, "train_throughput": 0.0, "num_weight_syncs": 30306, "num_samples_dropped": 599, "learner_queue": {"size_count": 100488, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.367, "replay_time_ms": 102.191, "update_priorities_time_ms": 60.083, "policy_agent_0": {"added_count": 3870976, "sampled_count": 5747712, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3870976, "sampled_count": 5747712, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8543133735656738, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6403610706329346, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 15517184, "episodes_total": 155176, "training_iteration": 161, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-56-43", "timestamp": 1569059803, "time_this_iter_s": 30.546523332595825, "time_total_s": 4925.249420404434, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366570d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4925.249420404434, "timesteps_since_restore": 15517184, "iterations_since_restore": 161, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 50.640604513757246, "episode_reward_min": 49.587938883321115, "episode_reward_mean": 50.08527121928222, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 25.25383059543771, "agent_1": 24.831440623844493}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.683437177729833, "mean_processing_ms": 3.6089869145036757, "mean_inference_ms": 2.120807147089059}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 462, "num_steps_trained": 23228160, "num_steps_sampled": 15615232, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30497, "num_samples_dropped": 599, "learner_queue": {"size_count": 101076, "size_mean": 0.28, "size_std": 0.530659966456864, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 28.994, "replay_time_ms": 72.207, "update_priorities_time_ms": 42.002, "policy_agent_0": {"added_count": 3895808, "sampled_count": 5787136, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3895808, "sampled_count": 5787136, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8614540696144104, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6519010066986084, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 15615232, "episodes_total": 156168, "training_iteration": 162, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-57-14", "timestamp": 1569059834, "time_this_iter_s": 30.52931547164917, "time_total_s": 4955.778735876083, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366519d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4955.778735876083, "timesteps_since_restore": 15615232, "iterations_since_restore": 162, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.99157291028438, "episode_reward_min": 47.77664599738369, "episode_reward_mean": 49.93610188601797, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 24.86390927501962, "agent_1": 25.07219261099833}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6832113956237257, "mean_processing_ms": 3.60742525500789, "mean_inference_ms": 2.1203643879969727}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 465, "num_steps_trained": 23374080, "num_steps_sampled": 15715840, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30694, "num_samples_dropped": 599, "learner_queue": {"size_count": 101646, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.675, "replay_time_ms": 93.922, "update_priorities_time_ms": 58.271, "policy_agent_0": {"added_count": 3921152, "sampled_count": 5822208, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3921152, "sampled_count": 5822208, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8380435705184937, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6545965671539307, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 15715840, "episodes_total": 157160, "training_iteration": 163, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-57-44", "timestamp": 1569059864, "time_this_iter_s": 30.53348445892334, "time_total_s": 4986.312220335007, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366bb1e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4986.312220335007, "timesteps_since_restore": 15715840, "iterations_since_restore": 163, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.17899713659992, "episode_reward_min": 44.386404121010806, "episode_reward_mean": 49.956355923440604, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.03719182733574, "agent_1": 24.919164096104836}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6834106244041525, "mean_processing_ms": 3.608191420832333, "mean_inference_ms": 2.119931608131214}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 468, "num_steps_trained": 23517952, "num_steps_sampled": 15815680, "sample_throughput": 0.0, "train_throughput": 14758.526, "num_weight_syncs": 30889, "num_samples_dropped": 599, "learner_queue": {"size_count": 102208, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.651, "replay_time_ms": 99.638, "update_priorities_time_ms": 49.562, "policy_agent_0": {"added_count": 3945216, "sampled_count": 5860864, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3945216, "sampled_count": 5860864, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8006347417831421, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6387405395507812, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 15815680, "episodes_total": 158168, "training_iteration": 164, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-58-15", "timestamp": 1569059895, "time_this_iter_s": 30.6345534324646, "time_total_s": 5016.946773767471, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365f7400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5016.946773767471, "timesteps_since_restore": 15815680, "iterations_since_restore": 164, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.305543834044094, "episode_reward_min": 46.52535240587802, "episode_reward_mean": 50.35149130401042, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.14205535432526, "agent_1": 25.20943594968513}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6832367552145894, "mean_processing_ms": 3.6069691350091446, "mean_inference_ms": 2.1195750338686823}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 471, "num_steps_trained": 23666176, "num_steps_sampled": 15914496, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31082, "num_samples_dropped": 599, "learner_queue": {"size_count": 102788, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.711, "replay_time_ms": 89.213, "update_priorities_time_ms": 50.444, "policy_agent_0": {"added_count": 3970304, "sampled_count": 5899264, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3970304, "sampled_count": 5899264, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7561102509498596, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.612893283367157, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 15914496, "episodes_total": 159152, "training_iteration": 165, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-58-45", "timestamp": 1569059925, "time_this_iter_s": 30.530219078063965, "time_total_s": 5047.476992845535, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36f882f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5047.476992845535, "timesteps_since_restore": 15914496, "iterations_since_restore": 165, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.44054698008942, "episode_reward_min": 45.282054272534005, "episode_reward_mean": 52.87674446504947, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.258274880968727, "agent_1": 25.618469584080675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6827940376785108, "mean_processing_ms": 3.6056188875386526, "mean_inference_ms": 2.1187354134521876}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 474, "num_steps_trained": 23808512, "num_steps_sampled": 16017152, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31282, "num_samples_dropped": 599, "learner_queue": {"size_count": 103343, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.469, "replay_time_ms": 92.735, "update_priorities_time_ms": 48.975, "policy_agent_0": {"added_count": 3996672, "sampled_count": 5934336, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 3996672, "sampled_count": 5934336, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7071738839149475, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6008862257003784, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 16017152, "episodes_total": 160168, "training_iteration": 166, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-59-16", "timestamp": 1569059956, "time_this_iter_s": 30.52082657814026, "time_total_s": 5077.9978194236755, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d37025e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5077.9978194236755, "timesteps_since_restore": 16017152, "iterations_since_restore": 166, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.48003185349831, "episode_reward_min": 50.200871577693114, "episode_reward_mean": 53.18009634915744, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.492801228004428, "agent_1": 25.68729512115291}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6830303696625015, "mean_processing_ms": 3.605553595384993, "mean_inference_ms": 2.1183274155261373}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 477, "num_steps_trained": 23953920, "num_steps_sampled": 16117504, "sample_throughput": 15739.284, "train_throughput": 7869.642, "num_weight_syncs": 31478, "num_samples_dropped": 599, "learner_queue": {"size_count": 103911, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.102, "replay_time_ms": 112.55, "update_priorities_time_ms": 55.646, "policy_agent_0": {"added_count": 4023552, "sampled_count": 5970688, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4023552, "sampled_count": 5970688, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6107724905014038, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5796919465065002, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 16117504, "episodes_total": 161168, "training_iteration": 167, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_09-59-46", "timestamp": 1569059986, "time_this_iter_s": 30.58333659172058, "time_total_s": 5108.581156015396, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3664a2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5108.581156015396, "timesteps_since_restore": 16117504, "iterations_since_restore": 167, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.41520930575667, "episode_reward_min": 46.731401427831535, "episode_reward_mean": 52.931551044493474, "episode_len_mean": 100.0, "episodes_this_iter": 936, "policy_reward_mean": {"agent_0": 27.746901466003955, "agent_1": 25.184649578489456}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6832632000383208, "mean_processing_ms": 3.607129718086621, "mean_inference_ms": 2.1194531038075906}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 480, "num_steps_trained": 24090624, "num_steps_sampled": 16210176, "sample_throughput": 19998.544, "train_throughput": 0.0, "num_weight_syncs": 31659, "num_samples_dropped": 599, "learner_queue": {"size_count": 104445, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.02, "replay_time_ms": 104.881, "update_priorities_time_ms": 56.549, "policy_agent_0": {"added_count": 4046336, "sampled_count": 6006528, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4046336, "sampled_count": 6006528, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5468990802764893, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5640543699264526, "model": {}}}}, "timesteps_this_iter": 92672, "done": false, "timesteps_total": 16210176, "episodes_total": 162104, "training_iteration": 168, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-00-17", "timestamp": 1569060017, "time_this_iter_s": 30.512957334518433, "time_total_s": 5139.094113349915, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3669e840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5139.094113349915, "timesteps_since_restore": 16210176, "iterations_since_restore": 168, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.235686516619204, "episode_reward_min": 46.56588556812196, "episode_reward_mean": 52.74926897732996, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.849686482555715, "agent_1": 24.899582494774208}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.683547619320662, "mean_processing_ms": 3.608453361086984, "mean_inference_ms": 2.119127447936444}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 482, "num_steps_trained": 24234496, "num_steps_sampled": 16311040, "sample_throughput": 8610.738, "train_throughput": 0.0, "num_weight_syncs": 31857, "num_samples_dropped": 599, "learner_queue": {"size_count": 105007, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.272, "replay_time_ms": 102.547, "update_priorities_time_ms": 48.667, "policy_agent_0": {"added_count": 4074496, "sampled_count": 6041600, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4074496, "sampled_count": 6041600, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5151945352554321, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5757202506065369, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 16311040, "episodes_total": 163120, "training_iteration": 169, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-00-48", "timestamp": 1569060048, "time_this_iter_s": 30.56643009185791, "time_total_s": 5169.6605434417725, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36609f28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5169.6605434417725, "timesteps_since_restore": 16311040, "iterations_since_restore": 169, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.42618653767774, "episode_reward_min": 50.082577150988875, "episode_reward_mean": 51.38056259959272, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.698113458679416, "agent_1": 24.68244914091326}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.682537314815113, "mean_processing_ms": 3.604197297828845, "mean_inference_ms": 2.118054241596442}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 485, "num_steps_trained": 24383744, "num_steps_sampled": 16410112, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32050, "num_samples_dropped": 599, "learner_queue": {"size_count": 105590, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.923, "replay_time_ms": 81.553, "update_priorities_time_ms": 43.055, "policy_agent_0": {"added_count": 4094208, "sampled_count": 6082816, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4094208, "sampled_count": 6082816, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47625717520713806, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5680148601531982, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 16410112, "episodes_total": 164104, "training_iteration": 170, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-01-18", "timestamp": 1569060078, "time_this_iter_s": 30.471463680267334, "time_total_s": 5200.13200712204, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36739950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5200.13200712204, "timesteps_since_restore": 16410112, "iterations_since_restore": 170, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.37858530216432, "episode_reward_min": 48.58453024078756, "episode_reward_mean": 52.11748925088642, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.308204348238107, "agent_1": 24.80928490264826}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6833055830329697, "mean_processing_ms": 3.6059049126878198, "mean_inference_ms": 2.117825094129962}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 488, "num_steps_trained": 24532224, "num_steps_sampled": 16509952, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32244, "num_samples_dropped": 599, "learner_queue": {"size_count": 106171, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.725, "replay_time_ms": 87.3, "update_priorities_time_ms": 48.207, "policy_agent_0": {"added_count": 4119296, "sampled_count": 6121216, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4119296, "sampled_count": 6121216, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47360658645629883, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.57817143201828, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 16509952, "episodes_total": 165104, "training_iteration": 171, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-01-49", "timestamp": 1569060109, "time_this_iter_s": 30.539857864379883, "time_total_s": 5230.67186498642, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36739b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5230.67186498642, "timesteps_since_restore": 16509952, "iterations_since_restore": 171, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.85997964776689, "episode_reward_min": 44.89941836712423, "episode_reward_mean": 51.448930050772226, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.773713433816738, "agent_1": 23.675216616955485}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6827851248378602, "mean_processing_ms": 3.6033848873008973, "mean_inference_ms": 2.1170896990630137}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 491, "num_steps_trained": 24678656, "num_steps_sampled": 16610560, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32441, "num_samples_dropped": 599, "learner_queue": {"size_count": 106743, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.873, "replay_time_ms": 84.354, "update_priorities_time_ms": 50.012, "policy_agent_0": {"added_count": 4141824, "sampled_count": 6158848, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4141824, "sampled_count": 6158848, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4628896415233612, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6221529245376587, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 16610560, "episodes_total": 166112, "training_iteration": 172, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-02-19", "timestamp": 1569060139, "time_this_iter_s": 30.48009705543518, "time_total_s": 5261.151962041855, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365e42f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5261.151962041855, "timesteps_since_restore": 16610560, "iterations_since_restore": 172, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.30740723218675, "episode_reward_min": 53.35154224195807, "episode_reward_mean": 54.54091834333946, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 29.238110852163405, "agent_1": 25.30280749117618}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828455606018176, "mean_processing_ms": 3.6042734385268766, "mean_inference_ms": 2.117477062735332}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 494, "num_steps_trained": 24827392, "num_steps_sampled": 16709120, "sample_throughput": 9558.518, "train_throughput": 4779.259, "num_weight_syncs": 32634, "num_samples_dropped": 599, "learner_queue": {"size_count": 107323, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.383, "replay_time_ms": 88.704, "update_priorities_time_ms": 55.453, "policy_agent_0": {"added_count": 4164096, "sampled_count": 6199552, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4164096, "sampled_count": 6199552, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41298389434814453, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5978512763977051, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 16709120, "episodes_total": 167096, "training_iteration": 173, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-02-50", "timestamp": 1569060170, "time_this_iter_s": 30.48422360420227, "time_total_s": 5291.636185646057, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365e3620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5291.636185646057, "timesteps_since_restore": 16709120, "iterations_since_restore": 173, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.23342046083429, "episode_reward_min": 49.46296265884037, "episode_reward_mean": 53.40511576634706, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 29.020709659538046, "agent_1": 24.384406106809035}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6830526682794356, "mean_processing_ms": 3.6048003686761887, "mean_inference_ms": 2.116908388763803}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 497, "num_steps_trained": 24973056, "num_steps_sampled": 16808448, "sample_throughput": 0.0, "train_throughput": 12664.141, "num_weight_syncs": 32828, "num_samples_dropped": 599, "learner_queue": {"size_count": 107892, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.537, "replay_time_ms": 102.528, "update_priorities_time_ms": 51.18, "policy_agent_0": {"added_count": 4188416, "sampled_count": 6238208, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4188416, "sampled_count": 6238208, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.398477166891098, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5831862688064575, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 16808448, "episodes_total": 168088, "training_iteration": 174, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-03-20", "timestamp": 1569060200, "time_this_iter_s": 30.512773990631104, "time_total_s": 5322.148959636688, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3656da60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5322.148959636688, "timesteps_since_restore": 16808448, "iterations_since_restore": 174, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.425067904921626, "episode_reward_min": 49.67081289544918, "episode_reward_mean": 52.04273340135686, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.788111078144833, "agent_1": 23.254622323212033}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6830824199003455, "mean_processing_ms": 3.6044007377964316, "mean_inference_ms": 2.116359071752282}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 500, "num_steps_trained": 25121792, "num_steps_sampled": 16907520, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33021, "num_samples_dropped": 599, "learner_queue": {"size_count": 108474, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.232, "replay_time_ms": 95.724, "update_priorities_time_ms": 55.092, "policy_agent_0": {"added_count": 4214016, "sampled_count": 6275584, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4214016, "sampled_count": 6275584, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39394277334213257, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6087826490402222, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 16907520, "episodes_total": 169080, "training_iteration": 175, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-03-51", "timestamp": 1569060231, "time_this_iter_s": 30.54194164276123, "time_total_s": 5352.6909012794495, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36534950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5352.6909012794495, "timesteps_since_restore": 16907520, "iterations_since_restore": 175, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.72103393317267, "episode_reward_min": 49.58489979450233, "episode_reward_mean": 51.21279516893868, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.039696440097053, "agent_1": 23.17309872884159}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6826312358650036, "mean_processing_ms": 3.6029280220302877, "mean_inference_ms": 2.11594597207842}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 503, "num_steps_trained": 25271552, "num_steps_sampled": 17004544, "sample_throughput": 8846.847, "train_throughput": 0.0, "num_weight_syncs": 33211, "num_samples_dropped": 599, "learner_queue": {"size_count": 109059, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.46, "replay_time_ms": 106.915, "update_priorities_time_ms": 57.655, "policy_agent_0": {"added_count": 4238336, "sampled_count": 6313728, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4238336, "sampled_count": 6313728, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3718926012516022, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6480497717857361, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 17004544, "episodes_total": 170056, "training_iteration": 176, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-04-21", "timestamp": 1569060261, "time_this_iter_s": 30.55081534385681, "time_total_s": 5383.241716623306, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3652be18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5383.241716623306, "timesteps_since_restore": 17004544, "iterations_since_restore": 176, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.27104559863927, "episode_reward_min": 46.483223355916905, "episode_reward_mean": 50.47249134149892, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.152329240857213, "agent_1": 22.320162100641703}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6834406750786071, "mean_processing_ms": 3.6043878437095542, "mean_inference_ms": 2.115990513125565}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 506, "num_steps_trained": 25420800, "num_steps_sampled": 17103104, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33404, "num_samples_dropped": 599, "learner_queue": {"size_count": 109642, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.878, "replay_time_ms": 84.168, "update_priorities_time_ms": 41.962, "policy_agent_0": {"added_count": 4262912, "sampled_count": 6353664, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4262912, "sampled_count": 6353664, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3817098140716553, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7271585464477539, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 17103104, "episodes_total": 171032, "training_iteration": 177, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-04-52", "timestamp": 1569060292, "time_this_iter_s": 30.475103855133057, "time_total_s": 5413.716820478439, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3653ca60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5413.716820478439, "timesteps_since_restore": 17103104, "iterations_since_restore": 177, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 51.84229048937133, "episode_reward_min": 46.18253479828265, "episode_reward_mean": 47.86001218660511, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 23.664044055215165, "agent_1": 24.19596813138985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.682652955285983, "mean_processing_ms": 3.6012918486757837, "mean_inference_ms": 2.114767146145978}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 509, "num_steps_trained": 25569024, "num_steps_sampled": 17202688, "sample_throughput": 0.0, "train_throughput": 21922.941, "num_weight_syncs": 33598, "num_samples_dropped": 599, "learner_queue": {"size_count": 110220, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.181, "replay_time_ms": 103.555, "update_priorities_time_ms": 55.401, "policy_agent_0": {"added_count": 4286976, "sampled_count": 6390784, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4286976, "sampled_count": 6390784, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4541979134082794, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7406326532363892, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 17202688, "episodes_total": 172040, "training_iteration": 178, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-05-23", "timestamp": 1569060323, "time_this_iter_s": 30.610952615737915, "time_total_s": 5444.327773094177, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36545f28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5444.327773094177, "timesteps_since_restore": 17202688, "iterations_since_restore": 178, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 50.71450526265776, "episode_reward_min": 45.329434078768585, "episode_reward_mean": 47.85355157305315, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 23.22905169314721, "agent_1": 24.62449987990585}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6834105196633391, "mean_processing_ms": 3.6036662552185375, "mean_inference_ms": 2.1151920414529015}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 512, "num_steps_trained": 25713920, "num_steps_sampled": 17303040, "sample_throughput": 7467.586, "train_throughput": 0.0, "num_weight_syncs": 33794, "num_samples_dropped": 599, "learner_queue": {"size_count": 110786, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.505, "replay_time_ms": 96.849, "update_priorities_time_ms": 55.878, "policy_agent_0": {"added_count": 4311808, "sampled_count": 6428160, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4311808, "sampled_count": 6428160, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5233564376831055, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7320563197135925, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 17303040, "episodes_total": 173024, "training_iteration": 179, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-05-53", "timestamp": 1569060353, "time_this_iter_s": 30.464604377746582, "time_total_s": 5474.792377471924, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365a5e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5474.792377471924, "timesteps_since_restore": 17303040, "iterations_since_restore": 179, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.18791276011327, "episode_reward_min": 46.71981564787966, "episode_reward_mean": 48.31500614891401, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 23.344077344811833, "agent_1": 24.970928804102087}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6827410266765754, "mean_processing_ms": 3.601155688379182, "mean_inference_ms": 2.1141150016111574}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 515, "num_steps_trained": 25861120, "num_steps_sampled": 17402112, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33988, "num_samples_dropped": 599, "learner_queue": {"size_count": 111361, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.271, "replay_time_ms": 105.729, "update_priorities_time_ms": 54.852, "policy_agent_0": {"added_count": 4334592, "sampled_count": 6467584, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4334592, "sampled_count": 6467584, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6299927234649658, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7027082443237305, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 17402112, "episodes_total": 174032, "training_iteration": 180, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-06-24", "timestamp": 1569060384, "time_this_iter_s": 30.49755096435547, "time_total_s": 5505.289928436279, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365e3400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5505.289928436279, "timesteps_since_restore": 17402112, "iterations_since_restore": 180, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 51.08689276372869, "episode_reward_min": 47.332858914050526, "episode_reward_mean": 48.7804333423496, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 23.42655060994963, "agent_1": 25.353882732399878}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6834405070809634, "mean_processing_ms": 3.602272269283368, "mean_inference_ms": 2.113933050409591}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 518, "num_steps_trained": 26010880, "num_steps_sampled": 17499392, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 34178, "num_samples_dropped": 599, "learner_queue": {"size_count": 111946, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.908, "replay_time_ms": 88.129, "update_priorities_time_ms": 49.426, "policy_agent_0": {"added_count": 4356864, "sampled_count": 6506496, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4356864, "sampled_count": 6506496, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6805383563041687, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.669874370098114, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 17499392, "episodes_total": 175000, "training_iteration": 181, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-06-54", "timestamp": 1569060414, "time_this_iter_s": 30.503706216812134, "time_total_s": 5535.793634653091, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365e40d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5535.793634653091, "timesteps_since_restore": 17499392, "iterations_since_restore": 181, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.39291341144176, "episode_reward_min": 46.44954702302893, "episode_reward_mean": 48.757367799596565, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 23.473950406509896, "agent_1": 25.283417393086573}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6837240029515521, "mean_processing_ms": 3.6021906538704305, "mean_inference_ms": 2.1134423529746877}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 521, "num_steps_trained": 26157056, "num_steps_sampled": 17600000, "sample_throughput": 17846.915, "train_throughput": 0.0, "num_weight_syncs": 34374, "num_samples_dropped": 599, "learner_queue": {"size_count": 112517, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 42.823, "replay_time_ms": 90.823, "update_priorities_time_ms": 48.483, "policy_agent_0": {"added_count": 4381440, "sampled_count": 6543104, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4381440, "sampled_count": 6543104, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.701104462146759, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6459664106369019, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 17600000, "episodes_total": 176000, "training_iteration": 182, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-07-25", "timestamp": 1569060445, "time_this_iter_s": 30.54830026626587, "time_total_s": 5566.341934919357, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36739488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5566.341934919357, "timesteps_since_restore": 17600000, "iterations_since_restore": 182, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.152889404732264, "episode_reward_min": 47.48472093893372, "episode_reward_mean": 48.42992131169171, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 23.2282128521932, "agent_1": 25.20170845949842}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6837103948043174, "mean_processing_ms": 3.6020700354402333, "mean_inference_ms": 2.113315564755185}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 524, "num_steps_trained": 26302464, "num_steps_sampled": 17700352, "sample_throughput": 0.0, "train_throughput": 22541.974, "num_weight_syncs": 34570, "num_samples_dropped": 599, "learner_queue": {"size_count": 113086, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.733, "replay_time_ms": 106.057, "update_priorities_time_ms": 54.327, "policy_agent_0": {"added_count": 4407296, "sampled_count": 6578176, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4407296, "sampled_count": 6578176, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7290918231010437, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.627394437789917, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 17700352, "episodes_total": 177008, "training_iteration": 183, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-07-55", "timestamp": 1569060475, "time_this_iter_s": 30.602293491363525, "time_total_s": 5596.944228410721, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3661c268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5596.944228410721, "timesteps_since_restore": 17700352, "iterations_since_restore": 183, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 49.472018848924364, "episode_reward_min": 47.12112387275059, "episode_reward_mean": 48.12601082077204, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 22.849699296618788, "agent_1": 25.276311524153176}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.683436415950074, "mean_processing_ms": 3.6012577739385008, "mean_inference_ms": 2.112829364744206}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 527, "num_steps_trained": 26456064, "num_steps_sampled": 17796352, "sample_throughput": 19775.343, "train_throughput": 0.0, "num_weight_syncs": 34757, "num_samples_dropped": 599, "learner_queue": {"size_count": 113685, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.072, "replay_time_ms": 108.039, "update_priorities_time_ms": 51.89, "policy_agent_0": {"added_count": 4426496, "sampled_count": 6614528, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4426496, "sampled_count": 6614528, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.748751163482666, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6094602346420288, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 17796352, "episodes_total": 177968, "training_iteration": 184, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-08-26", "timestamp": 1569060506, "time_this_iter_s": 30.52623462677002, "time_total_s": 5627.470463037491, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36609b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5627.470463037491, "timesteps_since_restore": 17796352, "iterations_since_restore": 184, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.77370064495846, "episode_reward_min": 46.54093921077343, "episode_reward_mean": 47.834513884223504, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 22.732771742305022, "agent_1": 25.101742141918415}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6833123599566011, "mean_processing_ms": 3.599831031663001, "mean_inference_ms": 2.1126121119534207}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 530, "num_steps_trained": 26602496, "num_steps_sampled": 17895168, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 34950, "num_samples_dropped": 599, "learner_queue": {"size_count": 114257, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.688, "replay_time_ms": 88.433, "update_priorities_time_ms": 47.012, "policy_agent_0": {"added_count": 4453632, "sampled_count": 6649088, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4453632, "sampled_count": 6649088, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7666184902191162, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5907324552536011, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 17895168, "episodes_total": 178960, "training_iteration": 185, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-08-56", "timestamp": 1569060536, "time_this_iter_s": 30.455782175064087, "time_total_s": 5657.926245212555, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36697730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5657.926245212555, "timesteps_since_restore": 17895168, "iterations_since_restore": 185, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 48.961964914905536, "episode_reward_min": 45.67856557371059, "episode_reward_mean": 46.82771587380748, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 22.868208852586818, "agent_1": 23.959507021220567}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6833504285993531, "mean_processing_ms": 3.6018976670061047, "mean_inference_ms": 2.1131783928824928}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 533, "num_steps_trained": 26749696, "num_steps_sampled": 17995520, "sample_throughput": 7222.9, "train_throughput": 7222.9, "num_weight_syncs": 35146, "num_samples_dropped": 599, "learner_queue": {"size_count": 114832, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.811, "replay_time_ms": 98.666, "update_priorities_time_ms": 52.333, "policy_agent_0": {"added_count": 4480512, "sampled_count": 6688768, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4480512, "sampled_count": 6688768, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.789032518863678, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6018610000610352, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 17995520, "episodes_total": 179960, "training_iteration": 186, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-09-27", "timestamp": 1569060567, "time_this_iter_s": 30.545870065689087, "time_total_s": 5688.472115278244, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36737e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5688.472115278244, "timesteps_since_restore": 17995520, "iterations_since_restore": 186, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 52.93897713321898, "episode_reward_min": 44.790651764668134, "episode_reward_mean": 46.94633615037138, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 23.137914463975427, "agent_1": 23.808421686395924}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6827536497105858, "mean_processing_ms": 3.5987925862088677, "mean_inference_ms": 2.112023151893853}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 535, "num_steps_trained": 26896128, "num_steps_sampled": 18095360, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 35341, "num_samples_dropped": 599, "learner_queue": {"size_count": 115404, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.57, "replay_time_ms": 92.208, "update_priorities_time_ms": 45.344, "policy_agent_0": {"added_count": 4501248, "sampled_count": 6727168, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4501248, "sampled_count": 6727168, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7949962019920349, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6264348030090332, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 18095360, "episodes_total": 180952, "training_iteration": 187, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-09-57", "timestamp": 1569060597, "time_this_iter_s": 30.485326766967773, "time_total_s": 5718.957442045212, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3673eae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5718.957442045212, "timesteps_since_restore": 18095360, "iterations_since_restore": 187, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.43005023509192, "episode_reward_min": 45.09667861098301, "episode_reward_mean": 47.94758324216334, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 24.507877662114872, "agent_1": 23.439705580048447}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6839450480608816, "mean_processing_ms": 3.602555072643699, "mean_inference_ms": 2.112545027443418}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 538, "num_steps_trained": 27042048, "num_steps_sampled": 18194176, "sample_throughput": 0.0, "train_throughput": 21331.489, "num_weight_syncs": 35534, "num_samples_dropped": 599, "learner_queue": {"size_count": 115974, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.465, "replay_time_ms": 86.237, "update_priorities_time_ms": 46.877, "policy_agent_0": {"added_count": 4531200, "sampled_count": 6763008, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4531200, "sampled_count": 6763008, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8046004772186279, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6561808586120605, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 18194176, "episodes_total": 181944, "training_iteration": 188, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-10-28", "timestamp": 1569060628, "time_this_iter_s": 30.486196279525757, "time_total_s": 5749.443638324738, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3671ed90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5749.443638324738, "timesteps_since_restore": 18194176, "iterations_since_restore": 188, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.69579862669942, "episode_reward_min": 47.51994774255876, "episode_reward_mean": 53.98017730275036, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.109146923887955, "agent_1": 25.871030378862336}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6826878974958616, "mean_processing_ms": 3.5975339076506865, "mean_inference_ms": 2.1107228798205124}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 541, "num_steps_trained": 27187968, "num_steps_sampled": 18294016, "sample_throughput": 6872.08, "train_throughput": 13744.159, "num_weight_syncs": 35730, "num_samples_dropped": 599, "learner_queue": {"size_count": 116545, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 27.564, "replay_time_ms": 83.646, "update_priorities_time_ms": 50.015, "policy_agent_0": {"added_count": 4557568, "sampled_count": 6801408, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4557568, "sampled_count": 6801408, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7480983734130859, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6517832279205322, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 18294016, "episodes_total": 182952, "training_iteration": 189, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-10-59", "timestamp": 1569060659, "time_this_iter_s": 30.60346746444702, "time_total_s": 5780.047105789185, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366a77b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5780.047105789185, "timesteps_since_restore": 18294016, "iterations_since_restore": 189, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.74033583518691, "episode_reward_min": 53.700596652352665, "episode_reward_mean": 54.43209178059517, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.584236949732112, "agent_1": 25.84785483086301}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6833620027791928, "mean_processing_ms": 3.5996611330331887, "mean_inference_ms": 2.1109192426420185}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 544, "num_steps_trained": 27337728, "num_steps_sampled": 18393344, "sample_throughput": 17481.673, "train_throughput": 0.0, "num_weight_syncs": 35923, "num_samples_dropped": 599, "learner_queue": {"size_count": 117129, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.805, "replay_time_ms": 95.891, "update_priorities_time_ms": 51.491, "policy_agent_0": {"added_count": 4579840, "sampled_count": 6840320, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4579840, "sampled_count": 6840320, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6520805358886719, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6160078048706055, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 18393344, "episodes_total": 183944, "training_iteration": 190, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-11-29", "timestamp": 1569060689, "time_this_iter_s": 30.569602966308594, "time_total_s": 5810.616708755493, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366bb488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5810.616708755493, "timesteps_since_restore": 18393344, "iterations_since_restore": 190, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.92804813546016, "episode_reward_min": 53.907112675112714, "episode_reward_mean": 55.20352715178771, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.948717419075905, "agent_1": 27.254809732711806}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6832712119409938, "mean_processing_ms": 3.6006708213709886, "mean_inference_ms": 2.1115166736270607}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 547, "num_steps_trained": 27486720, "num_steps_sampled": 18491904, "sample_throughput": 4483.826, "train_throughput": 8967.652, "num_weight_syncs": 36116, "num_samples_dropped": 599, "learner_queue": {"size_count": 117711, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.867, "replay_time_ms": 92.152, "update_priorities_time_ms": 44.014, "policy_agent_0": {"added_count": 4605696, "sampled_count": 6878464, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4605696, "sampled_count": 6878464, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5752435922622681, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5703128576278687, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 18491904, "episodes_total": 184928, "training_iteration": 191, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-12-00", "timestamp": 1569060720, "time_this_iter_s": 30.511584520339966, "time_total_s": 5841.128293275833, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36651d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5841.128293275833, "timesteps_since_restore": 18491904, "iterations_since_restore": 191, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.429947263402426, "episode_reward_min": 52.48981712276248, "episode_reward_mean": 53.813470214155686, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.96609684480876, "agent_1": 26.847373369347004}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6826565503128215, "mean_processing_ms": 3.5976595112562566, "mean_inference_ms": 2.1102225518587487}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 550, "num_steps_trained": 27629824, "num_steps_sampled": 18593792, "sample_throughput": 12014.298, "train_throughput": 6007.149, "num_weight_syncs": 36315, "num_samples_dropped": 599, "learner_queue": {"size_count": 118270, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.921, "replay_time_ms": 105.176, "update_priorities_time_ms": 57.534, "policy_agent_0": {"added_count": 4625920, "sampled_count": 6914304, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4625920, "sampled_count": 6914304, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5253419280052185, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5324981808662415, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 18593792, "episodes_total": 185944, "training_iteration": 192, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-12-30", "timestamp": 1569060750, "time_this_iter_s": 30.566538095474243, "time_total_s": 5871.694831371307, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36657620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5871.694831371307, "timesteps_since_restore": 18593792, "iterations_since_restore": 192, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.43407474617266, "episode_reward_min": 50.30142961022314, "episode_reward_mean": 52.644889739729486, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 28.018185784210868, "agent_1": 24.62670395551866}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828427541966456, "mean_processing_ms": 3.598025446704979, "mean_inference_ms": 2.1100447321352114}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 553, "num_steps_trained": 27778560, "num_steps_sampled": 18691328, "sample_throughput": 5570.529, "train_throughput": 0.0, "num_weight_syncs": 36506, "num_samples_dropped": 599, "learner_queue": {"size_count": 118851, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.728, "replay_time_ms": 88.924, "update_priorities_time_ms": 43.544, "policy_agent_0": {"added_count": 4649472, "sampled_count": 6950912, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4649472, "sampled_count": 6950912, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46862226724624634, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5255236625671387, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 18691328, "episodes_total": 186912, "training_iteration": 193, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-13-01", "timestamp": 1569060781, "time_this_iter_s": 30.466009616851807, "time_total_s": 5902.160840988159, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366b00d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5902.160840988159, "timesteps_since_restore": 18691328, "iterations_since_restore": 193, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 56.49165314903191, "episode_reward_min": 48.438885395889834, "episode_reward_mean": 51.93584155256236, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.066445058992958, "agent_1": 23.869396493569457}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6830707155851254, "mean_processing_ms": 3.5995247443389076, "mean_inference_ms": 2.1104536100810365}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 556, "num_steps_trained": 27927552, "num_steps_sampled": 18789632, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36697, "num_samples_dropped": 599, "learner_queue": {"size_count": 119434, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.773, "replay_time_ms": 93.267, "update_priorities_time_ms": 49.122, "policy_agent_0": {"added_count": 4678656, "sampled_count": 6990592, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4678656, "sampled_count": 6990592, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44972357153892517, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.548788845539093, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 18789632, "episodes_total": 187904, "training_iteration": 194, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-13-31", "timestamp": 1569060811, "time_this_iter_s": 30.490164279937744, "time_total_s": 5932.651005268097, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36653ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5932.651005268097, "timesteps_since_restore": 18789632, "iterations_since_restore": 194, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.338262996581115, "episode_reward_min": 48.435252144904375, "episode_reward_mean": 50.855884693888804, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.971540366855454, "agent_1": 22.884344327033396}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6826183454972953, "mean_processing_ms": 3.5967903233079834, "mean_inference_ms": 2.109587312262655}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 559, "num_steps_trained": 28072960, "num_steps_sampled": 18890496, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36895, "num_samples_dropped": 599, "learner_queue": {"size_count": 120001, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.433, "replay_time_ms": 90.683, "update_priorities_time_ms": 51.343, "policy_agent_0": {"added_count": 4707584, "sampled_count": 7025152, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4707584, "sampled_count": 7025152, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43930214643478394, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6267246603965759, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 18890496, "episodes_total": 188912, "training_iteration": 195, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-14-02", "timestamp": 1569060842, "time_this_iter_s": 30.61388850212097, "time_total_s": 5963.264893770218, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365b2158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5963.264893770218, "timesteps_since_restore": 18890496, "iterations_since_restore": 195, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.549270759892096, "episode_reward_min": 46.324652778694315, "episode_reward_mean": 51.45405504748925, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.167440143388433, "agent_1": 23.286614904100812}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6834621732654894, "mean_processing_ms": 3.599124454896957, "mean_inference_ms": 2.1093930386685353}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 562, "num_steps_trained": 28216064, "num_steps_sampled": 18991872, "sample_throughput": 8546.994, "train_throughput": 8546.994, "num_weight_syncs": 37093, "num_samples_dropped": 599, "learner_queue": {"size_count": 120560, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.715, "replay_time_ms": 81.867, "update_priorities_time_ms": 53.379, "policy_agent_0": {"added_count": 4732416, "sampled_count": 7062272, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4732416, "sampled_count": 7062272, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4263294041156769, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6863430738449097, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 18991872, "episodes_total": 189920, "training_iteration": 196, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-14-33", "timestamp": 1569060873, "time_this_iter_s": 30.614901065826416, "time_total_s": 5993.879794836044, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365cc7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5993.879794836044, "timesteps_since_restore": 18991872, "iterations_since_restore": 196, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.55396095910712, "episode_reward_min": 49.24217346334867, "episode_reward_mean": 52.383390441317985, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 28.4739632640235, "agent_1": 23.90942717729448}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6828617523029291, "mean_processing_ms": 3.5983787907038667, "mean_inference_ms": 2.10856207794325}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 565, "num_steps_trained": 28357632, "num_steps_sampled": 19093248, "sample_throughput": 27009.655, "train_throughput": 0.0, "num_weight_syncs": 37290, "num_samples_dropped": 599, "learner_queue": {"size_count": 121113, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.611, "replay_time_ms": 101.896, "update_priorities_time_ms": 47.307, "policy_agent_0": {"added_count": 4756736, "sampled_count": 7098880, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4756736, "sampled_count": 7098880, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4090920090675354, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.713791012763977, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 19093248, "episodes_total": 190944, "training_iteration": 197, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-15-03", "timestamp": 1569060903, "time_this_iter_s": 30.464032411575317, "time_total_s": 6024.34382724762, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d3658c6a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6024.34382724762, "timesteps_since_restore": 19093248, "iterations_since_restore": 197, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.33784609468779, "episode_reward_min": 49.39955429479077, "episode_reward_mean": 52.11384930997496, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.470529240148863, "agent_1": 23.643320069826117}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6821110434667841, "mean_processing_ms": 3.5961933294807777, "mean_inference_ms": 2.1084342094768727}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 567, "num_steps_trained": 28502784, "num_steps_sampled": 19192832, "sample_throughput": 18479.336, "train_throughput": 18479.336, "num_weight_syncs": 37485, "num_samples_dropped": 599, "learner_queue": {"size_count": 121680, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.142, "replay_time_ms": 78.008, "update_priorities_time_ms": 44.075, "policy_agent_0": {"added_count": 4782848, "sampled_count": 7137024, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4782848, "sampled_count": 7137024, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41842567920684814, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7107795476913452, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 19192832, "episodes_total": 191936, "training_iteration": 198, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-15-34", "timestamp": 1569060934, "time_this_iter_s": 30.578052759170532, "time_total_s": 6054.92188000679, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365926a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6054.92188000679, "timesteps_since_restore": 19192832, "iterations_since_restore": 198, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.11218748844318, "episode_reward_min": 47.89555095114823, "episode_reward_mean": 50.957199187027314, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.35828124287532, "agent_1": 22.598917944152028}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6819217995659835, "mean_processing_ms": 3.5951339541062906, "mean_inference_ms": 2.1077573244448984}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 570, "num_steps_trained": 28648704, "num_steps_sampled": 19293440, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 37681, "num_samples_dropped": 599, "learner_queue": {"size_count": 122250, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.581, "replay_time_ms": 101.119, "update_priorities_time_ms": 58.008, "policy_agent_0": {"added_count": 4808192, "sampled_count": 7173376, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4808192, "sampled_count": 7173376, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39503124356269836, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7307515144348145, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 19293440, "episodes_total": 192936, "training_iteration": 199, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-16-04", "timestamp": 1569060964, "time_this_iter_s": 30.502801656723022, "time_total_s": 6085.424681663513, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36559ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6085.424681663513, "timesteps_since_restore": 19293440, "iterations_since_restore": 199, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.46995287031656, "episode_reward_min": 48.68483346551828, "episode_reward_mean": 51.16663847650161, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.28217757308331, "agent_1": 22.88446090341832}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6829629197289633, "mean_processing_ms": 3.597120985594965, "mean_inference_ms": 2.1074006105292438}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 573, "num_steps_trained": 28794624, "num_steps_sampled": 19393024, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 37876, "num_samples_dropped": 599, "learner_queue": {"size_count": 122821, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.857, "replay_time_ms": 95.983, "update_priorities_time_ms": 48.803, "policy_agent_0": {"added_count": 4832512, "sampled_count": 7212288, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4832512, "sampled_count": 7212288, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39374208450317383, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7630869746208191, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 19393024, "episodes_total": 193936, "training_iteration": 200, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-16-35", "timestamp": 1569060995, "time_this_iter_s": 30.47976303100586, "time_total_s": 6115.904444694519, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36557048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6115.904444694519, "timesteps_since_restore": 19393024, "iterations_since_restore": 200, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.34898592660253, "episode_reward_min": 49.72788424153474, "episode_reward_mean": 52.0803973924889, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.123622454441787, "agent_1": 23.956774938047158}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6820400577932331, "mean_processing_ms": 3.5929875380624208, "mean_inference_ms": 2.106590468775229}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 576, "num_steps_trained": 28939264, "num_steps_sampled": 19493632, "sample_throughput": 6884.328, "train_throughput": 0.0, "num_weight_syncs": 38072, "num_samples_dropped": 599, "learner_queue": {"size_count": 123386, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.998, "replay_time_ms": 101.726, "update_priorities_time_ms": 54.103, "policy_agent_0": {"added_count": 4857344, "sampled_count": 7249664, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4857344, "sampled_count": 7249664, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39133864641189575, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.77764892578125, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 19493632, "episodes_total": 194944, "training_iteration": 201, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-17-05", "timestamp": 1569061025, "time_this_iter_s": 30.61485743522644, "time_total_s": 6146.5193021297455, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36559ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6146.5193021297455, "timesteps_since_restore": 19493632, "iterations_since_restore": 201, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 53.97832708338675, "episode_reward_min": 48.46143611525026, "episode_reward_mean": 51.25275762067351, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.873914138164977, "agent_1": 23.378843482508596}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6822207198886093, "mean_processing_ms": 3.59532297630662, "mean_inference_ms": 2.1068855567673057}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 579, "num_steps_trained": 29083136, "num_steps_sampled": 19595264, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38271, "num_samples_dropped": 599, "learner_queue": {"size_count": 123947, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 25.611, "replay_time_ms": 80.419, "update_priorities_time_ms": 44.893, "policy_agent_0": {"added_count": 4881408, "sampled_count": 7288064, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4881408, "sampled_count": 7288064, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38226085901260376, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7747699618339539, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 19595264, "episodes_total": 195960, "training_iteration": 202, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-17-36", "timestamp": 1569061056, "time_this_iter_s": 30.587311506271362, "time_total_s": 6177.106613636017, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36592400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6177.106613636017, "timesteps_since_restore": 19595264, "iterations_since_restore": 202, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.40034391087389, "episode_reward_min": 46.64091140458715, "episode_reward_mean": 51.86989150969822, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.836932462300098, "agent_1": 24.032959047398148}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6822837497239744, "mean_processing_ms": 3.5948716039692594, "mean_inference_ms": 2.1065902526347413}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 582, "num_steps_trained": 29229824, "num_steps_sampled": 19694336, "sample_throughput": 5942.913, "train_throughput": 0.0, "num_weight_syncs": 38465, "num_samples_dropped": 599, "learner_queue": {"size_count": 124521, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.637, "replay_time_ms": 81.721, "update_priorities_time_ms": 47.458, "policy_agent_0": {"added_count": 4906496, "sampled_count": 7327744, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4906496, "sampled_count": 7327744, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39754509925842285, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7794344425201416, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 19694336, "episodes_total": 196944, "training_iteration": 203, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-18-07", "timestamp": 1569061087, "time_this_iter_s": 30.48397922515869, "time_total_s": 6207.5905928611755, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365cc400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6207.5905928611755, "timesteps_since_restore": 19694336, "iterations_since_restore": 203, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.378447566427766, "episode_reward_min": 46.33251620652243, "episode_reward_mean": 51.4892669165626, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.712153958919515, "agent_1": 23.777112957643112}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6825113319097907, "mean_processing_ms": 3.5966440700697246, "mean_inference_ms": 2.1065706204493453}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 585, "num_steps_trained": 29377024, "num_steps_sampled": 19793152, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38657, "num_samples_dropped": 599, "learner_queue": {"size_count": 125095, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.843, "replay_time_ms": 100.782, "update_priorities_time_ms": 58.817, "policy_agent_0": {"added_count": 4932352, "sampled_count": 7363584, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4932352, "sampled_count": 7363584, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38888710737228394, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7665185332298279, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 19793152, "episodes_total": 197936, "training_iteration": 204, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-18-37", "timestamp": 1569061117, "time_this_iter_s": 30.493425846099854, "time_total_s": 6238.084018707275, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365b26a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6238.084018707275, "timesteps_since_restore": 19793152, "iterations_since_restore": 204, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.81097146312847, "episode_reward_min": 50.54136956998875, "episode_reward_mean": 53.487976869298734, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.78255382667621, "agent_1": 25.70542304262255}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6822941641962461, "mean_processing_ms": 3.5937578319128343, "mean_inference_ms": 2.1057627424392105}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 588, "num_steps_trained": 29521408, "num_steps_sampled": 19892480, "sample_throughput": 10084.403, "train_throughput": 5042.201, "num_weight_syncs": 38851, "num_samples_dropped": 599, "learner_queue": {"size_count": 125659, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.101, "replay_time_ms": 94.791, "update_priorities_time_ms": 53.436, "policy_agent_0": {"added_count": 4958208, "sampled_count": 7399168, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4958208, "sampled_count": 7399168, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40995827317237854, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7635790109634399, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 19892480, "episodes_total": 198936, "training_iteration": 205, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-19-08", "timestamp": 1569061148, "time_this_iter_s": 30.590754508972168, "time_total_s": 6268.674773216248, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d36653c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6268.674773216248, "timesteps_since_restore": 19892480, "iterations_since_restore": 205, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 55.07758765164771, "episode_reward_min": 49.05499619782412, "episode_reward_mean": 52.72927846089022, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.20873666826029, "agent_1": 24.52054179262999}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.682036760825768, "mean_processing_ms": 3.5926924574863115, "mean_inference_ms": 2.105067940043531}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 591, "num_steps_trained": 29666560, "num_steps_sampled": 19993600, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 39049, "num_samples_dropped": 599, "learner_queue": {"size_count": 126226, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.066, "replay_time_ms": 106.796, "update_priorities_time_ms": 51.595, "policy_agent_0": {"added_count": 4985088, "sampled_count": 7436544, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 4985088, "sampled_count": 7436544, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3934193253517151, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.746638834476471, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 19993600, "episodes_total": 199944, "training_iteration": 206, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-19-38", "timestamp": 1569061178, "time_this_iter_s": 30.49982237815857, "time_total_s": 6299.174595594406, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d365c96a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6299.174595594406, "timesteps_since_restore": 19993600, "iterations_since_restore": 206, "num_healthy_workers": 4, "trial_id": "84acc574"}
{"episode_reward_max": 54.63297639046909, "episode_reward_min": 47.23402260901515, "episode_reward_mean": 52.64694824800785, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 27.864758816651992, "agent_1": 24.782189431355885}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6822743201192949, "mean_processing_ms": 3.5931578998518723, "mean_inference_ms": 2.104967799407438}, "off_policy_estimator": {}, "info": {"min_exploration": 0.040000000000000036, "max_exploration": 0.040000000000000036, "num_target_updates": 594, "num_steps_trained": 29808384, "num_steps_sampled": 20095744, "sample_throughput": 0.0, "train_throughput": 14815.545, "num_weight_syncs": 39248, "num_samples_dropped": 599, "learner_queue": {"size_count": 126780, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.134, "replay_time_ms": 89.793, "update_priorities_time_ms": 53.186, "policy_agent_0": {"added_count": 5012992, "sampled_count": 7473152, "est_size_bytes": 97727424, "num_entries": 75000}, "policy_agent_1": {"added_count": 5012992, "sampled_count": 7473152, "est_size_bytes": 97727424, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39770376682281494, "model": {}}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7334562540054321, "model": {}}}}, "timesteps_this_iter": 102144, "done": true, "timesteps_total": 20095744, "episodes_total": 200968, "training_iteration": 207, "experiment_id": "5edfda66b364405d946092b413a86c09", "date": "2019-09-21_10-20-09", "timestamp": 1569061209, "time_this_iter_s": 30.52128267288208, "time_total_s": 6329.695878267288, "pid": 3621, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7f0d366570d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.04, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6329.695878267288, "timesteps_since_restore": 20095744, "iterations_since_restore": 207, "num_healthy_workers": 4, "trial_id": "84acc574"}
