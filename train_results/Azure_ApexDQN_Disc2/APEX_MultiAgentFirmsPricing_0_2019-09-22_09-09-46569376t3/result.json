{"episode_reward_max": 58.50434738379329, "episode_reward_min": 53.62137999973347, "episode_reward_mean": 55.95195621770121, "episode_len_mean": 100.0, "episodes_this_iter": 752, "policy_reward_mean": {"agent_0": 27.94673682871358, "agent_1": 28.005219388987662}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6373941336662079, "mean_processing_ms": 3.591541350483179, "mean_inference_ms": 1.9962704563251876}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1, "num_steps_trained": 85248, "num_steps_sampled": 74496, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 144, "num_samples_dropped": 314, "learner_queue": {"size_count": 11454, "size_mean": 0.22, "size_std": 0.41424630354415964, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 26.884, "replay_time_ms": 90.723, "update_priorities_time_ms": 46.772, "policy_agent_0": {"added_count": 16128, "sampled_count": 20480, "est_size_bytes": 21015280, "num_entries": 16128}, "policy_agent_1": {"added_count": 16128, "sampled_count": 20480, "est_size_bytes": 21015280, "num_entries": 16128}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 2.235781192779541, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 2.2213380336761475, "model": {}}}}, "timesteps_this_iter": 74496, "done": false, "timesteps_total": 74496, "episodes_total": 752, "training_iteration": 1, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-11-00", "timestamp": 1569143460, "time_this_iter_s": 30.584943771362305, "time_total_s": 30.584943771362305, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3657748c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 30.584943771362305, "timesteps_since_restore": 74496, "iterations_since_restore": 1, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.559840913944996, "episode_reward_min": 52.82260722626176, "episode_reward_mean": 55.34779770995771, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 27.583564624262976, "agent_1": 27.76423308569477}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6734819480939669, "mean_processing_ms": 3.615103842071163, "mean_inference_ms": 2.037159401457396}, "off_policy_estimator": {}, "info": {"min_exploration": 0.85398784, "max_exploration": 0.85398784, "num_target_updates": 4, "num_steps_trained": 242944, "num_steps_sampled": 169984, "sample_throughput": 7514.044, "train_throughput": 0.0, "num_weight_syncs": 331, "num_samples_dropped": 314, "learner_queue": {"size_count": 12071, "size_mean": 0.2, "size_std": 0.447213595499958, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.119, "replay_time_ms": 102.485, "update_priorities_time_ms": 57.177, "policy_agent_0": {"added_count": 35840, "sampled_count": 61952, "est_size_bytes": 46700668, "num_entries": 35840}, "policy_agent_1": {"added_count": 35840, "sampled_count": 61952, "est_size_bytes": 46700668, "num_entries": 35840}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 2.090955972671509, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 2.0518083572387695, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 169984, "episodes_total": 1704, "training_iteration": 2, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-11-31", "timestamp": 1569143491, "time_this_iter_s": 30.574585914611816, "time_total_s": 61.15952968597412, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36577f9d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 61.15952968597412, "timesteps_since_restore": 169984, "iterations_since_restore": 2, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.223619758838524, "episode_reward_min": 51.599078694056, "episode_reward_mean": 54.46553778757414, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 27.123195649135862, "agent_1": 27.342342138438312}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6704497378966221, "mean_processing_ms": 3.6040446285465197, "mean_inference_ms": 2.046320815096828}, "off_policy_estimator": {}, "info": {"min_exploration": 0.66683136, "max_exploration": 0.66683136, "num_target_updates": 7, "num_steps_trained": 397824, "num_steps_sampled": 266240, "sample_throughput": 18849.812, "train_throughput": 0.0, "num_weight_syncs": 519, "num_samples_dropped": 314, "learner_queue": {"size_count": 12675, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.262, "replay_time_ms": 91.087, "update_priorities_time_ms": 50.476, "policy_agent_0": {"added_count": 58112, "sampled_count": 101888, "est_size_bytes": 75721884, "num_entries": 58112}, "policy_agent_1": {"added_count": 58112, "sampled_count": 101888, "est_size_bytes": 75721884, "num_entries": 58112}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.9287313222885132, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.8759098052978516, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 266240, "episodes_total": 2664, "training_iteration": 3, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-12-01", "timestamp": 1569143521, "time_this_iter_s": 30.514636754989624, "time_total_s": 91.67416644096375, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365787ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 91.67416644096375, "timesteps_since_restore": 266240, "iterations_since_restore": 3, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.06299145833148, "episode_reward_min": 49.83689412688746, "episode_reward_mean": 53.22446739343498, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.648248432971393, "agent_1": 26.576218960463603}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6655420239232949, "mean_processing_ms": 3.5778611583208906, "mean_inference_ms": 2.0623445043085473}, "off_policy_estimator": {}, "info": {"min_exploration": 0.4781696000000001, "max_exploration": 0.4781696000000001, "num_target_updates": 10, "num_steps_trained": 547840, "num_steps_sampled": 363520, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 708, "num_samples_dropped": 314, "learner_queue": {"size_count": 13261, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 42.799, "replay_time_ms": 89.273, "update_priorities_time_ms": 53.583, "policy_agent_0": {"added_count": 83968, "sampled_count": 138240, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 83968, "sampled_count": 138240, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.7625648975372314, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.7066285610198975, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 363520, "episodes_total": 3648, "training_iteration": 4, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-12-32", "timestamp": 1569143552, "time_this_iter_s": 30.52829599380493, "time_total_s": 122.20246243476868, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365715f28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 122.20246243476868, "timesteps_since_restore": 363520, "iterations_since_restore": 4, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.453932160821594, "episode_reward_min": 48.51744614049299, "episode_reward_mean": 52.09482903000672, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 26.085344251254494, "agent_1": 26.009484778752253}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6639609989698206, "mean_processing_ms": 3.563645798003251, "mean_inference_ms": 2.075758074575016}, "off_policy_estimator": {}, "info": {"min_exploration": 0.2875008, "max_exploration": 0.2875008, "num_target_updates": 13, "num_steps_trained": 698368, "num_steps_sampled": 461056, "sample_throughput": 19998.916, "train_throughput": 19998.916, "num_weight_syncs": 899, "num_samples_dropped": 314, "learner_queue": {"size_count": 13849, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.931, "replay_time_ms": 89.179, "update_priorities_time_ms": 45.573, "policy_agent_0": {"added_count": 109312, "sampled_count": 175104, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 109312, "sampled_count": 175104, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.6062955856323242, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.5340032577514648, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 461056, "episodes_total": 4616, "training_iteration": 5, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-13-02", "timestamp": 1569143582, "time_this_iter_s": 30.538357257843018, "time_total_s": 152.7408196926117, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36572a488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 152.7408196926117, "timesteps_since_restore": 461056, "iterations_since_restore": 5, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.0839690706164, "episode_reward_min": 44.314239157570995, "episode_reward_mean": 50.03484115563829, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 24.873389216440376, "agent_1": 25.161451939197935}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6708639248711582, "mean_processing_ms": 3.5705963377540177, "mean_inference_ms": 2.0690200016848292}, "off_policy_estimator": {}, "info": {"min_exploration": 0.09633024000000001, "max_exploration": 0.09633024000000001, "num_target_updates": 16, "num_steps_trained": 845056, "num_steps_sampled": 558080, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1089, "num_samples_dropped": 314, "learner_queue": {"size_count": 14422, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.721, "replay_time_ms": 104.602, "update_priorities_time_ms": 51.446, "policy_agent_0": {"added_count": 131840, "sampled_count": 212992, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 131840, "sampled_count": 212992, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.4526804685592651, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.3792887926101685, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 558080, "episodes_total": 5584, "training_iteration": 6, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-13-33", "timestamp": 1569143613, "time_this_iter_s": 30.52742600440979, "time_total_s": 183.26824569702148, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3657350d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 183.26824569702148, "timesteps_since_restore": 558080, "iterations_since_restore": 6, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 53.29411123273653, "episode_reward_min": 43.98939799000052, "episode_reward_mean": 48.29777776076189, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 24.072656659132996, "agent_1": 24.225121101628844}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6687779456666891, "mean_processing_ms": 3.5676473302082385, "mean_inference_ms": 2.0678250590998473}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 19, "num_steps_trained": 991232, "num_steps_sampled": 655360, "sample_throughput": 6955.323, "train_throughput": 0.0, "num_weight_syncs": 1279, "num_samples_dropped": 314, "learner_queue": {"size_count": 14994, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.416, "replay_time_ms": 106.71, "update_priorities_time_ms": 53.361, "policy_agent_0": {"added_count": 158208, "sampled_count": 251136, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 158208, "sampled_count": 251136, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.3307130336761475, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.2421274185180664, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 655360, "episodes_total": 6552, "training_iteration": 7, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-14-03", "timestamp": 1569143643, "time_this_iter_s": 30.575583696365356, "time_total_s": 213.84382939338684, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36573a598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 213.84382939338684, "timesteps_since_restore": 655360, "iterations_since_restore": 7, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.091714021436715, "episode_reward_min": 44.11686120127317, "episode_reward_mean": 48.67034516362356, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 24.466455704023723, "agent_1": 24.203889459599814}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6664791726399286, "mean_processing_ms": 3.560051183232749, "mean_inference_ms": 2.0735343820335728}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 22, "num_steps_trained": 1138432, "num_steps_sampled": 752384, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1468, "num_samples_dropped": 314, "learner_queue": {"size_count": 15568, "size_mean": 0.12, "size_std": 0.3815756805667783, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.599, "replay_time_ms": 111.317, "update_priorities_time_ms": 54.689, "policy_agent_0": {"added_count": 181248, "sampled_count": 288512, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 181248, "sampled_count": 288512, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.2196910381317139, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.148597240447998, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 752384, "episodes_total": 7528, "training_iteration": 8, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-14-34", "timestamp": 1569143674, "time_this_iter_s": 30.53165578842163, "time_total_s": 244.37548518180847, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3657491e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 244.37548518180847, "timesteps_since_restore": 752384, "iterations_since_restore": 8, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 53.366769950150335, "episode_reward_min": 43.52772932337441, "episode_reward_mean": 48.19564822181564, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 24.86859039576683, "agent_1": 23.32705782604878}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6662535665918544, "mean_processing_ms": 3.557582460691039, "mean_inference_ms": 2.074400943109675}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 25, "num_steps_trained": 1281792, "num_steps_sampled": 850688, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1660, "num_samples_dropped": 314, "learner_queue": {"size_count": 16128, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.133, "replay_time_ms": 101.135, "update_priorities_time_ms": 47.034, "policy_agent_0": {"added_count": 205824, "sampled_count": 322816, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 205824, "sampled_count": 322816, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.1193960905075073, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.0659903287887573, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 850688, "episodes_total": 8512, "training_iteration": 9, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-15-05", "timestamp": 1569143705, "time_this_iter_s": 30.5619695186615, "time_total_s": 274.93745470046997, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656d16a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 274.93745470046997, "timesteps_since_restore": 850688, "iterations_since_restore": 9, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.78619922627525, "episode_reward_min": 44.2681459759727, "episode_reward_mean": 47.170776255371294, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 23.22822237937064, "agent_1": 23.942553876000623}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6652028588546102, "mean_processing_ms": 3.552190821087409, "mean_inference_ms": 2.0821024103293264}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 28, "num_steps_trained": 1430016, "num_steps_sampled": 946944, "sample_throughput": 0.0, "train_throughput": 34687.185, "num_weight_syncs": 1849, "num_samples_dropped": 314, "learner_queue": {"size_count": 16707, "size_mean": 0.04, "size_std": 0.19595917942265426, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.235, "replay_time_ms": 106.872, "update_priorities_time_ms": 52.802, "policy_agent_0": {"added_count": 228864, "sampled_count": 360960, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 228864, "sampled_count": 360960, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 1.0449461936950684, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.9915989637374878, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 946944, "episodes_total": 9480, "training_iteration": 10, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-15-35", "timestamp": 1569143735, "time_this_iter_s": 30.659635543823242, "time_total_s": 305.5970902442932, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656df2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 305.5970902442932, "timesteps_since_restore": 946944, "iterations_since_restore": 10, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 54.888097666015675, "episode_reward_min": 44.23762839698945, "episode_reward_mean": 48.20689473489045, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 23.697377969177662, "agent_1": 24.50951676571276}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6654206960342121, "mean_processing_ms": 3.5522882452853075, "mean_inference_ms": 2.0841121459020484}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 31, "num_steps_trained": 1577216, "num_steps_sampled": 1043200, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2036, "num_samples_dropped": 314, "learner_queue": {"size_count": 17282, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.734, "replay_time_ms": 103.487, "update_priorities_time_ms": 48.753, "policy_agent_0": {"added_count": 256256, "sampled_count": 396800, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 256256, "sampled_count": 396800, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.9814690351486206, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.9258089065551758, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 1043200, "episodes_total": 10432, "training_iteration": 11, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-16-06", "timestamp": 1569143766, "time_this_iter_s": 30.560222148895264, "time_total_s": 336.1573123931885, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656e27b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 336.1573123931885, "timesteps_since_restore": 1043200, "iterations_since_restore": 11, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.37044603081323, "episode_reward_min": 48.00225644305549, "episode_reward_mean": 53.24463792066237, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.33659394678525, "agent_1": 25.908043973877284}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6613282928341232, "mean_processing_ms": 3.54127630420178, "mean_inference_ms": 2.0828614777611607}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 34, "num_steps_trained": 1718272, "num_steps_sampled": 1143040, "sample_throughput": 13599.415, "train_throughput": 13599.415, "num_weight_syncs": 2231, "num_samples_dropped": 314, "learner_queue": {"size_count": 17833, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.75, "replay_time_ms": 121.859, "update_priorities_time_ms": 53.647, "policy_agent_0": {"added_count": 281600, "sampled_count": 431104, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 281600, "sampled_count": 431104, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.9003189206123352, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8416780233383179, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 1143040, "episodes_total": 11432, "training_iteration": 12, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-16-36", "timestamp": 1569143796, "time_this_iter_s": 30.537598609924316, "time_total_s": 366.6949110031128, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656f3400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 366.6949110031128, "timesteps_since_restore": 1143040, "iterations_since_restore": 12, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.42134729172467, "episode_reward_min": 47.73624025775322, "episode_reward_mean": 53.036430835893945, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 27.052387174607908, "agent_1": 25.984043661286222}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6609173851918487, "mean_processing_ms": 3.539843692613353, "mean_inference_ms": 2.0838261573931627}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 37, "num_steps_trained": 1863936, "num_steps_sampled": 1240064, "sample_throughput": 4139.488, "train_throughput": 0.0, "num_weight_syncs": 2421, "num_samples_dropped": 314, "learner_queue": {"size_count": 18402, "size_mean": 0.16, "size_std": 0.41761226035642207, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.653, "replay_time_ms": 113.131, "update_priorities_time_ms": 53.395, "policy_agent_0": {"added_count": 305152, "sampled_count": 468224, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 305152, "sampled_count": 468224, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7997106313705444, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7640895843505859, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 1240064, "episodes_total": 12400, "training_iteration": 13, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-17-07", "timestamp": 1569143827, "time_this_iter_s": 30.607930421829224, "time_total_s": 397.302841424942, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656fe8c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 397.302841424942, "timesteps_since_restore": 1240064, "iterations_since_restore": 13, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.060334451897454, "episode_reward_min": 47.77201768317953, "episode_reward_mean": 53.98045418718559, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 24.157791938441036, "agent_1": 29.82266224874464}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6600834624469963, "mean_processing_ms": 3.53834222844743, "mean_inference_ms": 2.0823053084380687}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 40, "num_steps_trained": 2009856, "num_steps_sampled": 1337600, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2612, "num_samples_dropped": 314, "learner_queue": {"size_count": 18972, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.706, "replay_time_ms": 113.708, "update_priorities_time_ms": 57.489, "policy_agent_0": {"added_count": 328960, "sampled_count": 506624, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 328960, "sampled_count": 506624, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7192382216453552, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6786339282989502, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 1337600, "episodes_total": 13384, "training_iteration": 14, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-17-38", "timestamp": 1569143858, "time_this_iter_s": 30.542367935180664, "time_total_s": 427.8452093601227, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656d17b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 427.8452093601227, "timesteps_since_restore": 1337600, "iterations_since_restore": 14, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.15876909521743, "episode_reward_min": 48.57296504035872, "episode_reward_mean": 52.45721567810205, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 24.52903702779017, "agent_1": 27.928178650311917}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6616120444702213, "mean_processing_ms": 3.5400846776429336, "mean_inference_ms": 2.081419505826193}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 42, "num_steps_trained": 2153472, "num_steps_sampled": 1435648, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2803, "num_samples_dropped": 314, "learner_queue": {"size_count": 19533, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.302, "replay_time_ms": 108.579, "update_priorities_time_ms": 52.443, "policy_agent_0": {"added_count": 354304, "sampled_count": 543232, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 354304, "sampled_count": 543232, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7325889468193054, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6247730851173401, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 1435648, "episodes_total": 14368, "training_iteration": 15, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-18-08", "timestamp": 1569143888, "time_this_iter_s": 30.510563373565674, "time_total_s": 458.35577273368835, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365750bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 458.35577273368835, "timesteps_since_restore": 1435648, "iterations_since_restore": 15, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.493066448025665, "episode_reward_min": 47.29848325843629, "episode_reward_mean": 54.32951465581133, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 25.183909882923214, "agent_1": 29.14560477288832}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6605896773964096, "mean_processing_ms": 3.539060761874947, "mean_inference_ms": 2.0884843963659123}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 45, "num_steps_trained": 2303744, "num_steps_sampled": 1530624, "sample_throughput": 7621.514, "train_throughput": 15243.029, "num_weight_syncs": 2988, "num_samples_dropped": 314, "learner_queue": {"size_count": 20120, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.783, "replay_time_ms": 93.51, "update_priorities_time_ms": 50.962, "policy_agent_0": {"added_count": 374528, "sampled_count": 580096, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 374528, "sampled_count": 580096, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6942372918128967, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5285276770591736, "model": {}}}}, "timesteps_this_iter": 94976, "done": false, "timesteps_total": 1530624, "episodes_total": 15312, "training_iteration": 16, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-18-39", "timestamp": 1569143919, "time_this_iter_s": 30.550732135772705, "time_total_s": 488.90650486946106, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd366050d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 488.90650486946106, "timesteps_since_restore": 1530624, "iterations_since_restore": 16, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.492038647227446, "episode_reward_min": 51.13109966502035, "episode_reward_mean": 57.0835702828184, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.13689590256777, "agent_1": 29.946674380250805}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6593010101102404, "mean_processing_ms": 3.5337909306468522, "mean_inference_ms": 2.0854260277263506}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 48, "num_steps_trained": 2447360, "num_steps_sampled": 1628672, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3180, "num_samples_dropped": 314, "learner_queue": {"size_count": 20681, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.694, "replay_time_ms": 101.741, "update_priorities_time_ms": 54.921, "policy_agent_0": {"added_count": 398848, "sampled_count": 616448, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 398848, "sampled_count": 616448, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6432105302810669, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.49403151869773865, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 1628672, "episodes_total": 16296, "training_iteration": 17, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-19-09", "timestamp": 1569143949, "time_this_iter_s": 30.477391004562378, "time_total_s": 519.3838958740234, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656fe950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 519.3838958740234, "timesteps_since_restore": 1628672, "iterations_since_restore": 17, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.4590508859178, "episode_reward_min": 51.835992726860155, "episode_reward_mean": 59.75969043740569, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 29.712205343425445, "agent_1": 30.047485093980292}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6604796252226468, "mean_processing_ms": 3.538675438604651, "mean_inference_ms": 2.084210057610894}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 51, "num_steps_trained": 2590720, "num_steps_sampled": 1726720, "sample_throughput": 7146.725, "train_throughput": 3573.362, "num_weight_syncs": 3372, "num_samples_dropped": 314, "learner_queue": {"size_count": 21243, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.145, "replay_time_ms": 106.526, "update_priorities_time_ms": 62.138, "policy_agent_0": {"added_count": 420608, "sampled_count": 653056, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 420608, "sampled_count": 653056, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5878792405128479, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.42926928400993347, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 1726720, "episodes_total": 17272, "training_iteration": 18, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-19-40", "timestamp": 1569143980, "time_this_iter_s": 30.70238757133484, "time_total_s": 550.0862834453583, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656df6a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 550.0862834453583, "timesteps_since_restore": 1726720, "iterations_since_restore": 18, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.40137851025686, "episode_reward_min": 52.631388394472665, "episode_reward_mean": 57.14410636694744, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 28.215860586591127, "agent_1": 28.9282457803564}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6588287099787324, "mean_processing_ms": 3.5378666796572285, "mean_inference_ms": 2.0862234850109944}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 54, "num_steps_trained": 2739968, "num_steps_sampled": 1822464, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3558, "num_samples_dropped": 314, "learner_queue": {"size_count": 21824, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 27.926, "replay_time_ms": 93.534, "update_priorities_time_ms": 48.229, "policy_agent_0": {"added_count": 444416, "sampled_count": 690432, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 444416, "sampled_count": 690432, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.49516257643699646, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4127578139305115, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 1822464, "episodes_total": 18224, "training_iteration": 19, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-20-11", "timestamp": 1569144011, "time_this_iter_s": 30.560877799987793, "time_total_s": 580.6471612453461, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365704b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 580.6471612453461, "timesteps_since_restore": 1822464, "iterations_since_restore": 19, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.434019232226724, "episode_reward_min": 45.87503102749522, "episode_reward_mean": 51.1667496940768, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.635258713506484, "agent_1": 25.53149098057036}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6583723529839206, "mean_processing_ms": 3.534249297730129, "mean_inference_ms": 2.08293958397388}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 57, "num_steps_trained": 2883840, "num_steps_sampled": 1921024, "sample_throughput": 8355.285, "train_throughput": 4177.642, "num_weight_syncs": 3752, "num_samples_dropped": 314, "learner_queue": {"size_count": 22387, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.674, "replay_time_ms": 106.234, "update_priorities_time_ms": 53.192, "policy_agent_0": {"added_count": 471040, "sampled_count": 728064, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 471040, "sampled_count": 728064, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4779461622238159, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4599105715751648, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 1921024, "episodes_total": 19208, "training_iteration": 20, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-20-41", "timestamp": 1569144041, "time_this_iter_s": 30.582552671432495, "time_total_s": 611.2297139167786, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3657067b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 611.2297139167786, "timesteps_since_restore": 1921024, "iterations_since_restore": 20, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.44594377157769, "episode_reward_min": 47.37364525240356, "episode_reward_mean": 58.4085395651045, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 29.14352111777653, "agent_1": 29.265018447328043}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6599894797422725, "mean_processing_ms": 3.536369593437072, "mean_inference_ms": 2.0821681043246345}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 60, "num_steps_trained": 3027712, "num_steps_sampled": 2018816, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3942, "num_samples_dropped": 314, "learner_queue": {"size_count": 22949, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.859, "replay_time_ms": 114.797, "update_priorities_time_ms": 56.441, "policy_agent_0": {"added_count": 493824, "sampled_count": 763392, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 493824, "sampled_count": 763392, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.46510088443756104, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4570901095867157, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 2018816, "episodes_total": 20192, "training_iteration": 21, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-21-12", "timestamp": 1569144072, "time_this_iter_s": 30.666025400161743, "time_total_s": 641.8957393169403, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365774620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 641.8957393169403, "timesteps_since_restore": 2018816, "iterations_since_restore": 21, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.439771634161715, "episode_reward_min": 56.75900332400245, "episode_reward_mean": 59.87654871058339, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 30.131436463243897, "agent_1": 29.745112247339566}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6588020877772088, "mean_processing_ms": 3.5327697980809427, "mean_inference_ms": 2.0814148670683323}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 63, "num_steps_trained": 3170560, "num_steps_sampled": 2117632, "sample_throughput": 0.0, "train_throughput": 9265.901, "num_weight_syncs": 4135, "num_samples_dropped": 314, "learner_queue": {"size_count": 23506, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.507, "replay_time_ms": 100.135, "update_priorities_time_ms": 49.706, "policy_agent_0": {"added_count": 517888, "sampled_count": 798976, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 517888, "sampled_count": 798976, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4421159029006958, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.41645175218582153, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 2117632, "episodes_total": 21184, "training_iteration": 22, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-21-43", "timestamp": 1569144103, "time_this_iter_s": 30.609936475753784, "time_total_s": 672.5056757926941, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365707950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 672.5056757926941, "timesteps_since_restore": 2117632, "iterations_since_restore": 22, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.443069106633466, "episode_reward_min": 50.124280225839556, "episode_reward_mean": 59.91740635397664, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 30.05527763200361, "agent_1": 29.862128721973097}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6595937940380331, "mean_processing_ms": 3.5332042651035547, "mean_inference_ms": 2.0812517831708375}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 66, "num_steps_trained": 3314688, "num_steps_sampled": 2215424, "sample_throughput": 6475.892, "train_throughput": 6475.892, "num_weight_syncs": 4326, "num_samples_dropped": 314, "learner_queue": {"size_count": 24070, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.622, "replay_time_ms": 77.424, "update_priorities_time_ms": 45.751, "policy_agent_0": {"added_count": 539136, "sampled_count": 837120, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 539136, "sampled_count": 837120, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.37116026878356934, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.37698066234588623, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 2215424, "episodes_total": 22160, "training_iteration": 23, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-22-13", "timestamp": 1569144133, "time_this_iter_s": 30.47454810142517, "time_total_s": 702.9802238941193, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365728e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 702.9802238941193, "timesteps_since_restore": 2215424, "iterations_since_restore": 23, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.34934455785369, "episode_reward_min": 51.49909460128907, "episode_reward_mean": 54.35200231852354, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 30.86259442890409, "agent_1": 23.48940788961952}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6599151374881321, "mean_processing_ms": 3.531392663956786, "mean_inference_ms": 2.0793526357915364}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 68, "num_steps_trained": 3455488, "num_steps_sampled": 2315008, "sample_throughput": 0.0, "train_throughput": 34232.667, "num_weight_syncs": 4520, "num_samples_dropped": 314, "learner_queue": {"size_count": 24619, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.413, "replay_time_ms": 108.026, "update_priorities_time_ms": 52.799, "policy_agent_0": {"added_count": 566528, "sampled_count": 871936, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 566528, "sampled_count": 871936, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.36076468229293823, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.41356033086776733, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 2315008, "episodes_total": 23160, "training_iteration": 24, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-22-44", "timestamp": 1569144164, "time_this_iter_s": 30.61407995223999, "time_total_s": 733.5943038463593, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365710a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 733.5943038463593, "timesteps_since_restore": 2315008, "iterations_since_restore": 24, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.87563049625338, "episode_reward_min": 45.8637631591944, "episode_reward_mean": 52.51948835558905, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.894703051555492, "agent_1": 23.624785304033615}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6597099250434213, "mean_processing_ms": 3.527467846105338, "mean_inference_ms": 2.0753314689445927}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 71, "num_steps_trained": 3598336, "num_steps_sampled": 2414080, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4715, "num_samples_dropped": 314, "learner_queue": {"size_count": 25178, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.928, "replay_time_ms": 102.532, "update_priorities_time_ms": 49.856, "policy_agent_0": {"added_count": 592640, "sampled_count": 907264, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 592640, "sampled_count": 907264, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.35559511184692383, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4922370910644531, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 2414080, "episodes_total": 24144, "training_iteration": 25, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-23-14", "timestamp": 1569144194, "time_this_iter_s": 30.56335186958313, "time_total_s": 764.1576557159424, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365724f28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 764.1576557159424, "timesteps_since_restore": 2414080, "iterations_since_restore": 25, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.34934455785369, "episode_reward_min": 43.89438560493652, "episode_reward_mean": 49.241219479393195, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 27.359281235236164, "agent_1": 21.88193824415705}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6599429868396903, "mean_processing_ms": 3.530604403792083, "mean_inference_ms": 2.074594907352056}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 74, "num_steps_trained": 3739392, "num_steps_sampled": 2512384, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4906, "num_samples_dropped": 314, "learner_queue": {"size_count": 25728, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.176, "replay_time_ms": 118.851, "update_priorities_time_ms": 57.565, "policy_agent_0": {"added_count": 619008, "sampled_count": 942592, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 619008, "sampled_count": 942592, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.39219343662261963, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6185379028320312, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 2512384, "episodes_total": 25128, "training_iteration": 26, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-23-45", "timestamp": 1569144225, "time_this_iter_s": 30.63555145263672, "time_total_s": 794.7932071685791, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365692b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 794.7932071685791, "timesteps_since_restore": 2512384, "iterations_since_restore": 26, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.87929012992525, "episode_reward_min": 43.43065039780943, "episode_reward_mean": 45.92033160467908, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 23.508794212733243, "agent_1": 22.41153739194584}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6603294733405052, "mean_processing_ms": 3.5283890190259837, "mean_inference_ms": 2.0744292495879897}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 77, "num_steps_trained": 3885312, "num_steps_sampled": 2610176, "sample_throughput": 0.0, "train_throughput": 16368.016, "num_weight_syncs": 5096, "num_samples_dropped": 314, "learner_queue": {"size_count": 26298, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.453, "replay_time_ms": 100.047, "update_priorities_time_ms": 50.237, "policy_agent_0": {"added_count": 642816, "sampled_count": 980480, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 642816, "sampled_count": 980480, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4836723804473877, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6719576120376587, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 2610176, "episodes_total": 26112, "training_iteration": 27, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-24-16", "timestamp": 1569144256, "time_this_iter_s": 30.59650945663452, "time_total_s": 825.3897166252136, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656a00d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 825.3897166252136, "timesteps_since_restore": 2610176, "iterations_since_restore": 27, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.778824319458366, "episode_reward_min": 43.09807568371972, "episode_reward_mean": 47.97179017132428, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.05806447847818, "agent_1": 21.913725692846164}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6597953594966883, "mean_processing_ms": 3.5288100122233783, "mean_inference_ms": 2.077287416027299}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 80, "num_steps_trained": 4028928, "num_steps_sampled": 2707456, "sample_throughput": 0.0, "train_throughput": 19992.214, "num_weight_syncs": 5288, "num_samples_dropped": 314, "learner_queue": {"size_count": 26860, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.782, "replay_time_ms": 114.249, "update_priorities_time_ms": 57.08, "policy_agent_0": {"added_count": 665600, "sampled_count": 1015808, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 665600, "sampled_count": 1015808, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5473887920379639, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7447113394737244, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 2707456, "episodes_total": 27088, "training_iteration": 28, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-24-46", "timestamp": 1569144286, "time_this_iter_s": 30.64018750190735, "time_total_s": 856.029904127121, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656a0c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 856.029904127121, "timesteps_since_restore": 2707456, "iterations_since_restore": 28, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.02806243388297, "episode_reward_min": 42.892274255710376, "episode_reward_mean": 50.7733043765151, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 27.75383755427557, "agent_1": 23.01946682223966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6598251259654321, "mean_processing_ms": 3.5308447266643057, "mean_inference_ms": 2.078925815405557}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 83, "num_steps_trained": 4176640, "num_steps_sampled": 2802944, "sample_throughput": 8513.315, "train_throughput": 8513.315, "num_weight_syncs": 5474, "num_samples_dropped": 314, "learner_queue": {"size_count": 27436, "size_mean": 0.48, "size_std": 1.0814804667676619, "size_quantiles": [0.0, 0.0, 0.0, 1.1000000000000014, 5.0]}, "replay_shard_0": {"add_batch_time_ms": 36.465, "replay_time_ms": 88.597, "update_priorities_time_ms": 43.862, "policy_agent_0": {"added_count": 690176, "sampled_count": 1051136, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 690176, "sampled_count": 1051136, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5455688238143921, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7747209072113037, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 2802944, "episodes_total": 28032, "training_iteration": 29, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-25-17", "timestamp": 1569144317, "time_this_iter_s": 30.50728964805603, "time_total_s": 886.537193775177, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656b01e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 886.537193775177, "timesteps_since_restore": 2802944, "iterations_since_restore": 29, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 54.09691947832806, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 43.7017695582845, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 20.75933945987754, "agent_1": 22.94243009840703}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6591323479547226, "mean_processing_ms": 3.528909407792032, "mean_inference_ms": 2.079856357516957}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 86, "num_steps_trained": 4322048, "num_steps_sampled": 2898944, "sample_throughput": 0.0, "train_throughput": 15684.222, "num_weight_syncs": 5660, "num_samples_dropped": 314, "learner_queue": {"size_count": 28005, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 43.935, "replay_time_ms": 116.64, "update_priorities_time_ms": 52.921, "policy_agent_0": {"added_count": 714240, "sampled_count": 1085952, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 714240, "sampled_count": 1085952, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6460655927658081, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.787760853767395, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 2898944, "episodes_total": 28992, "training_iteration": 30, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-25-47", "timestamp": 1569144347, "time_this_iter_s": 30.61365032196045, "time_total_s": 917.1508440971375, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656b0d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 917.1508440971375, "timesteps_since_restore": 2898944, "iterations_since_restore": 30, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.23025306911246, "episode_reward_min": 41.30708172157314, "episode_reward_mean": 44.03895954564417, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 22.589418585573274, "agent_1": 21.449540960070955}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6602223428909573, "mean_processing_ms": 3.533043292303081, "mean_inference_ms": 2.0800420560581303}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 89, "num_steps_trained": 4466944, "num_steps_sampled": 2996224, "sample_throughput": 0.0, "train_throughput": 11938.822, "num_weight_syncs": 5851, "num_samples_dropped": 314, "learner_queue": {"size_count": 28570, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.6, "replay_time_ms": 112.872, "update_priorities_time_ms": 50.614, "policy_agent_0": {"added_count": 738048, "sampled_count": 1121792, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 738048, "sampled_count": 1121792, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7207452654838562, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.799435019493103, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 2996224, "episodes_total": 29976, "training_iteration": 31, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-26-18", "timestamp": 1569144378, "time_this_iter_s": 30.594589948654175, "time_total_s": 947.7454340457916, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656ca2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 947.7454340457916, "timesteps_since_restore": 2996224, "iterations_since_restore": 31, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.63441597209703, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 48.35918432532093, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 26.522646711432916, "agent_1": 21.836537613888133}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6605128731831529, "mean_processing_ms": 3.534803107423134, "mean_inference_ms": 2.082624365030209}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 91, "num_steps_trained": 4614144, "num_steps_sampled": 3091968, "sample_throughput": 6409.213, "train_throughput": 0.0, "num_weight_syncs": 6038, "num_samples_dropped": 314, "learner_queue": {"size_count": 29145, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.574, "replay_time_ms": 126.996, "update_priorities_time_ms": 54.251, "policy_agent_0": {"added_count": 760832, "sampled_count": 1159424, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 760832, "sampled_count": 1159424, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7359375357627869, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8169766068458557, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 3091968, "episodes_total": 30928, "training_iteration": 32, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-26-49", "timestamp": 1569144409, "time_this_iter_s": 30.584428071975708, "time_total_s": 978.3298621177673, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656caea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 978.3298621177673, "timesteps_since_restore": 3091968, "iterations_since_restore": 32, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.687137207100925, "episode_reward_min": 55.24523495962933, "episode_reward_mean": 56.17202484650601, "episode_len_mean": 100.0, "episodes_this_iter": 936, "policy_reward_mean": {"agent_0": 32.76981972448081, "agent_1": 23.40220512202539}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6610436692424042, "mean_processing_ms": 3.5374333088400465, "mean_inference_ms": 2.084079157714153}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 94, "num_steps_trained": 4760576, "num_steps_sampled": 3186688, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6223, "num_samples_dropped": 314, "learner_queue": {"size_count": 29718, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.351, "replay_time_ms": 123.011, "update_priorities_time_ms": 59.986, "policy_agent_0": {"added_count": 785152, "sampled_count": 1195264, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 785152, "sampled_count": 1195264, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.666150689125061, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8098316788673401, "model": {}}}}, "timesteps_this_iter": 94720, "done": false, "timesteps_total": 3186688, "episodes_total": 31864, "training_iteration": 33, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-27-19", "timestamp": 1569144439, "time_this_iter_s": 30.622963190078735, "time_total_s": 1008.9528253078461, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365663400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1008.9528253078461, "timesteps_since_restore": 3186688, "iterations_since_restore": 33, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.49347624008491, "episode_reward_min": 51.08789321943698, "episode_reward_mean": 54.69157834751544, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 32.212482419050275, "agent_1": 22.479095928465274}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6624341285644534, "mean_processing_ms": 3.5420668539739655, "mean_inference_ms": 2.0847880268746932}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 97, "num_steps_trained": 4904960, "num_steps_sampled": 3282688, "sample_throughput": 8325.516, "train_throughput": 0.0, "num_weight_syncs": 6411, "num_samples_dropped": 314, "learner_queue": {"size_count": 30281, "size_mean": 0.2, "size_std": 0.5291502622129182, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.495, "replay_time_ms": 103.072, "update_priorities_time_ms": 50.962, "policy_agent_0": {"added_count": 808960, "sampled_count": 1230592, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 808960, "sampled_count": 1230592, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5033384561538696, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8042744398117065, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 3282688, "episodes_total": 32832, "training_iteration": 34, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-27-50", "timestamp": 1569144470, "time_this_iter_s": 30.502915859222412, "time_total_s": 1039.4557411670685, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36566b048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1039.4557411670685, "timesteps_since_restore": 3282688, "iterations_since_restore": 34, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.68875934501203, "episode_reward_min": 52.53516866165019, "episode_reward_mean": 55.139762703873025, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 31.743712990442255, "agent_1": 23.39604971343082}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6633086533266551, "mean_processing_ms": 3.542711473181131, "mean_inference_ms": 2.084987818796807}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 100, "num_steps_trained": 5051136, "num_steps_sampled": 3379968, "sample_throughput": 5111.677, "train_throughput": 3407.785, "num_weight_syncs": 6601, "num_samples_dropped": 314, "learner_queue": {"size_count": 30852, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.571, "replay_time_ms": 106.882, "update_priorities_time_ms": 54.625, "policy_agent_0": {"added_count": 831488, "sampled_count": 1267968, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 831488, "sampled_count": 1267968, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.36869847774505615, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8040838241577148, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 3379968, "episodes_total": 33808, "training_iteration": 35, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-28-20", "timestamp": 1569144500, "time_this_iter_s": 30.614485502243042, "time_total_s": 1070.0702266693115, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36567b510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1070.0702266693115, "timesteps_since_restore": 3379968, "iterations_since_restore": 35, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.48125819460024, "episode_reward_min": 42.5652147132938, "episode_reward_mean": 52.50145252693792, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 30.135223357218425, "agent_1": 22.366229169719517}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6621621691333457, "mean_processing_ms": 3.539532810651167, "mean_inference_ms": 2.0863168393163365}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 103, "num_steps_trained": 5196544, "num_steps_sampled": 3476736, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6789, "num_samples_dropped": 314, "learner_queue": {"size_count": 31420, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.87, "replay_time_ms": 96.178, "update_priorities_time_ms": 46.662, "policy_agent_0": {"added_count": 852992, "sampled_count": 1305856, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 852992, "sampled_count": 1305856, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3344632685184479, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8148787021636963, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 3476736, "episodes_total": 34768, "training_iteration": 36, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-28-51", "timestamp": 1569144531, "time_this_iter_s": 30.514918088912964, "time_total_s": 1100.5851447582245, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656ca488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1100.5851447582245, "timesteps_since_restore": 3476736, "iterations_since_restore": 36, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.98278102666402, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 43.87810759882971, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 20.572650694907363, "agent_1": 23.305456903922423}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6628843481035135, "mean_processing_ms": 3.543624676393082, "mean_inference_ms": 2.087579797690008}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 106, "num_steps_trained": 5341696, "num_steps_sampled": 3572992, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6977, "num_samples_dropped": 314, "learner_queue": {"size_count": 31987, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.968, "replay_time_ms": 125.428, "update_priorities_time_ms": 62.522, "policy_agent_0": {"added_count": 876800, "sampled_count": 1342720, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 876800, "sampled_count": 1342720, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.487865686416626, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8064066171646118, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 3572992, "episodes_total": 35736, "training_iteration": 37, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-29-22", "timestamp": 1569144562, "time_this_iter_s": 30.601053476333618, "time_total_s": 1131.186198234558, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656b0b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1131.186198234558, "timesteps_since_restore": 3572992, "iterations_since_restore": 37, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.42803495397807, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 43.660710632450034, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 22.276423965689762, "agent_1": 21.38428666676036}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6619565209580498, "mean_processing_ms": 3.5396268023113953, "mean_inference_ms": 2.0877159992848355}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 109, "num_steps_trained": 5481216, "num_steps_sampled": 3672576, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7172, "num_samples_dropped": 314, "learner_queue": {"size_count": 32532, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.152, "replay_time_ms": 109.339, "update_priorities_time_ms": 54.265, "policy_agent_0": {"added_count": 901376, "sampled_count": 1376768, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 901376, "sampled_count": 1376768, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6503504514694214, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8171137571334839, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 3672576, "episodes_total": 36736, "training_iteration": 38, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-29-52", "timestamp": 1569144592, "time_this_iter_s": 30.521740674972534, "time_total_s": 1161.7079389095306, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365706bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1161.7079389095306, "timesteps_since_restore": 3672576, "iterations_since_restore": 38, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.14400236740172, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 44.18576027026806, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 22.833389244923477, "agent_1": 21.35237102534471}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6619761024552753, "mean_processing_ms": 3.538224488841587, "mean_inference_ms": 2.086608023525221}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 112, "num_steps_trained": 5624832, "num_steps_sampled": 3768576, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7359, "num_samples_dropped": 314, "learner_queue": {"size_count": 33093, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.701, "replay_time_ms": 98.878, "update_priorities_time_ms": 47.108, "policy_agent_0": {"added_count": 922112, "sampled_count": 1415168, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 922112, "sampled_count": 1415168, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7442482709884644, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8308893442153931, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 3768576, "episodes_total": 37696, "training_iteration": 39, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-30-23", "timestamp": 1569144623, "time_this_iter_s": 30.488348960876465, "time_total_s": 1192.196287870407, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656feb70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1192.196287870407, "timesteps_since_restore": 3768576, "iterations_since_restore": 39, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 54.08382503033984, "episode_reward_min": 42.632872090201744, "episode_reward_mean": 51.30884583420768, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.693579324647718, "agent_1": 23.615266509560055}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6619212227379367, "mean_processing_ms": 3.539477223702258, "mean_inference_ms": 2.0854919384774036}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 114, "num_steps_trained": 5765888, "num_steps_sampled": 3867904, "sample_throughput": 0.0, "train_throughput": 24196.999, "num_weight_syncs": 7553, "num_samples_dropped": 314, "learner_queue": {"size_count": 33644, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.031, "replay_time_ms": 121.029, "update_priorities_time_ms": 53.113, "policy_agent_0": {"added_count": 950528, "sampled_count": 1447680, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 950528, "sampled_count": 1447680, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7208870053291321, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8450137376785278, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 3867904, "episodes_total": 38688, "training_iteration": 40, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-30-53", "timestamp": 1569144653, "time_this_iter_s": 30.639963150024414, "time_total_s": 1222.8362510204315, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365fa3a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1222.8362510204315, "timesteps_since_restore": 3867904, "iterations_since_restore": 40, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 54.49641289457181, "episode_reward_min": 52.1864164100622, "episode_reward_mean": 52.92819314964947, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.45642704739166, "agent_1": 24.471766102257863}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6617082092391156, "mean_processing_ms": 3.539558915460722, "mean_inference_ms": 2.0843515573592084}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 117, "num_steps_trained": 5907712, "num_steps_sampled": 3966464, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7746, "num_samples_dropped": 314, "learner_queue": {"size_count": 34198, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.532, "replay_time_ms": 115.278, "update_priorities_time_ms": 58.329, "policy_agent_0": {"added_count": 973056, "sampled_count": 1483264, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 973056, "sampled_count": 1483264, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6448906064033508, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8222230076789856, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 3966464, "episodes_total": 39664, "training_iteration": 41, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-31-24", "timestamp": 1569144684, "time_this_iter_s": 30.558021068572998, "time_total_s": 1253.3942720890045, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3657509d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1253.3942720890045, "timesteps_since_restore": 3966464, "iterations_since_restore": 41, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.957773326133946, "episode_reward_min": 53.10472644059889, "episode_reward_mean": 54.83933885661128, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.15633526957417, "agent_1": 25.6830035870371}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6618457012750142, "mean_processing_ms": 3.5408990441136288, "mean_inference_ms": 2.0840838210290533}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 120, "num_steps_trained": 6052096, "num_steps_sampled": 4063488, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7935, "num_samples_dropped": 314, "learner_queue": {"size_count": 34762, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.147, "replay_time_ms": 104.509, "update_priorities_time_ms": 53.875, "policy_agent_0": {"added_count": 1002240, "sampled_count": 1518592, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1002240, "sampled_count": 1518592, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.469633013010025, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.799846351146698, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 4063488, "episodes_total": 40632, "training_iteration": 42, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-31-55", "timestamp": 1569144715, "time_this_iter_s": 30.641405820846558, "time_total_s": 1284.035677909851, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365749c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1284.035677909851, "timesteps_since_restore": 4063488, "iterations_since_restore": 42, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.28235637335574, "episode_reward_min": 49.20481321884641, "episode_reward_mean": 52.37501593202236, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 26.288994191081247, "agent_1": 26.08602174094108}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.661911450945968, "mean_processing_ms": 3.5425762414415605, "mean_inference_ms": 2.0840541405682314}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 123, "num_steps_trained": 6198272, "num_steps_sampled": 4159232, "sample_throughput": 18470.753, "train_throughput": 0.0, "num_weight_syncs": 8122, "num_samples_dropped": 314, "learner_queue": {"size_count": 35333, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.314, "replay_time_ms": 75.274, "update_priorities_time_ms": 37.523, "policy_agent_0": {"added_count": 1025024, "sampled_count": 1556224, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1025024, "sampled_count": 1556224, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.43558675050735474, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7331590056419373, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 4159232, "episodes_total": 41592, "training_iteration": 43, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-32-25", "timestamp": 1569144745, "time_this_iter_s": 30.50289249420166, "time_total_s": 1314.5385704040527, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656e2620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1314.5385704040527, "timesteps_since_restore": 4159232, "iterations_since_restore": 43, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 54.36902883538433, "episode_reward_min": 46.59453827784154, "episode_reward_mean": 50.66826594555483, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.685671655369184, "agent_1": 24.982594290185638}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6617503020490807, "mean_processing_ms": 3.5421891204143146, "mean_inference_ms": 2.0834986588803943}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 126, "num_steps_trained": 6339584, "num_steps_sampled": 4257792, "sample_throughput": 7551.511, "train_throughput": 0.0, "num_weight_syncs": 8316, "num_samples_dropped": 314, "learner_queue": {"size_count": 35885, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.879, "replay_time_ms": 118.553, "update_priorities_time_ms": 60.626, "policy_agent_0": {"added_count": 1047808, "sampled_count": 1592832, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1047808, "sampled_count": 1592832, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4349953830242157, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6915587186813354, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 4257792, "episodes_total": 42576, "training_iteration": 44, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-32-56", "timestamp": 1569144776, "time_this_iter_s": 30.568795442581177, "time_total_s": 1345.107365846634, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36567bae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1345.107365846634, "timesteps_since_restore": 4257792, "iterations_since_restore": 44, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.87522394180999, "episode_reward_min": 48.37176077335284, "episode_reward_mean": 55.08019494043793, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.376597381387413, "agent_1": 26.703597559050625}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6621974304325616, "mean_processing_ms": 3.5445575302108305, "mean_inference_ms": 2.083159496291998}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 129, "num_steps_trained": 6479872, "num_steps_sampled": 4356608, "sample_throughput": 24145.85, "train_throughput": 24145.85, "num_weight_syncs": 8508, "num_samples_dropped": 314, "learner_queue": {"size_count": 36433, "size_mean": 0.9, "size_std": 1.8138357147217055, "size_quantiles": [0.0, 0.0, 0.0, 3.1000000000000014, 7.0]}, "replay_shard_0": {"add_batch_time_ms": 37.775, "replay_time_ms": 107.282, "update_priorities_time_ms": 50.022, "policy_agent_0": {"added_count": 1075200, "sampled_count": 1627136, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1075200, "sampled_count": 1627136, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4200032651424408, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.663945734500885, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 4356608, "episodes_total": 43568, "training_iteration": 45, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-33-26", "timestamp": 1569144806, "time_this_iter_s": 30.500024557113647, "time_total_s": 1375.6073904037476, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36576b048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1375.6073904037476, "timesteps_since_restore": 4356608, "iterations_since_restore": 45, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.85160806447666, "episode_reward_min": 50.87893528155648, "episode_reward_mean": 54.95406708383997, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.740658640455607, "agent_1": 26.21340844338441}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6625588395954457, "mean_processing_ms": 3.544639359766512, "mean_inference_ms": 2.0827977329400325}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 131, "num_steps_trained": 6623232, "num_steps_sampled": 4453888, "sample_throughput": 12961.009, "train_throughput": 12961.009, "num_weight_syncs": 8698, "num_samples_dropped": 314, "learner_queue": {"size_count": 36993, "size_mean": 0.1, "size_std": 0.3605551275463989, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.617, "replay_time_ms": 90.145, "update_priorities_time_ms": 48.605, "policy_agent_0": {"added_count": 1099776, "sampled_count": 1662976, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1099776, "sampled_count": 1662976, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.406751811504364, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6471652984619141, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 4453888, "episodes_total": 44544, "training_iteration": 46, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-33-57", "timestamp": 1569144837, "time_this_iter_s": 30.528164386749268, "time_total_s": 1406.1355547904968, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36576bbf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1406.1355547904968, "timesteps_since_restore": 4453888, "iterations_since_restore": 46, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.7743199313959, "episode_reward_min": 46.48414837920572, "episode_reward_mean": 53.756230840989716, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.074876965090123, "agent_1": 25.681353875899635}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6631318897617139, "mean_processing_ms": 3.5447999772120227, "mean_inference_ms": 2.081158674185}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 134, "num_steps_trained": 6765568, "num_steps_sampled": 4552960, "sample_throughput": 18956.302, "train_throughput": 0.0, "num_weight_syncs": 8891, "num_samples_dropped": 314, "learner_queue": {"size_count": 37549, "size_mean": 0.2, "size_std": 0.48989794855663565, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.572, "replay_time_ms": 95.902, "update_priorities_time_ms": 52.428, "policy_agent_0": {"added_count": 1123072, "sampled_count": 1699328, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1123072, "sampled_count": 1699328, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3864881992340088, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6040613651275635, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 4552960, "episodes_total": 45536, "training_iteration": 47, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-34-28", "timestamp": 1569144868, "time_this_iter_s": 30.694087743759155, "time_total_s": 1436.829642534256, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365785158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1436.829642534256, "timesteps_since_restore": 4552960, "iterations_since_restore": 47, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.82612748489468, "episode_reward_min": 45.706591639803044, "episode_reward_mean": 53.89286223155905, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.13980525762659, "agent_1": 25.75305697393256}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6623774753427979, "mean_processing_ms": 3.5412848875578464, "mean_inference_ms": 2.0792727333983456}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 137, "num_steps_trained": 6903552, "num_steps_sampled": 4652544, "sample_throughput": 0.0, "train_throughput": 14628.037, "num_weight_syncs": 9085, "num_samples_dropped": 314, "learner_queue": {"size_count": 38089, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.81, "replay_time_ms": 107.595, "update_priorities_time_ms": 56.173, "policy_agent_0": {"added_count": 1146112, "sampled_count": 1734144, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1146112, "sampled_count": 1734144, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3854040205478668, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6002797484397888, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 4652544, "episodes_total": 46536, "training_iteration": 48, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-34-58", "timestamp": 1569144898, "time_this_iter_s": 30.66743040084839, "time_total_s": 1467.4970729351044, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365785d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1467.4970729351044, "timesteps_since_restore": 4652544, "iterations_since_restore": 48, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.712264548586305, "episode_reward_min": 49.19119055955944, "episode_reward_mean": 54.03491668657772, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 29.22771010149502, "agent_1": 24.807206585082778}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6621580878530389, "mean_processing_ms": 3.5398202764580105, "mean_inference_ms": 2.07737147180511}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 140, "num_steps_trained": 7043584, "num_steps_sampled": 4751104, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9278, "num_samples_dropped": 314, "learner_queue": {"size_count": 38635, "size_mean": 0.68, "size_std": 1.3332666649999168, "size_quantiles": [0.0, 0.0, 0.0, 2.1000000000000014, 6.0]}, "replay_shard_0": {"add_batch_time_ms": 38.177, "replay_time_ms": 91.844, "update_priorities_time_ms": 43.56, "policy_agent_0": {"added_count": 1170176, "sampled_count": 1770240, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1170176, "sampled_count": 1770240, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.36996084451675415, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.614974856376648, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 4751104, "episodes_total": 47520, "training_iteration": 49, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-35-29", "timestamp": 1569144929, "time_this_iter_s": 30.50321125984192, "time_total_s": 1498.0002841949463, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36571d268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1498.0002841949463, "timesteps_since_restore": 4751104, "iterations_since_restore": 49, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.80511412059288, "episode_reward_min": 46.07994256618119, "episode_reward_mean": 53.958209841591845, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 29.554734875454024, "agent_1": 24.403474966137946}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.662330927806252, "mean_processing_ms": 3.540446847818884, "mean_inference_ms": 2.0783358491441266}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 143, "num_steps_trained": 7189504, "num_steps_sampled": 4846592, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9465, "num_samples_dropped": 314, "learner_queue": {"size_count": 39205, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.881, "replay_time_ms": 104.445, "update_priorities_time_ms": 46.831, "policy_agent_0": {"added_count": 1192704, "sampled_count": 1807104, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1192704, "sampled_count": 1807104, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.35756003856658936, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6217265129089355, "model": {}}}}, "timesteps_this_iter": 95488, "done": false, "timesteps_total": 4846592, "episodes_total": 48480, "training_iteration": 50, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-35-59", "timestamp": 1569144959, "time_this_iter_s": 30.52233386039734, "time_total_s": 1528.5226180553436, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36571de18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1528.5226180553436, "timesteps_since_restore": 4846592, "iterations_since_restore": 50, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.642442261335944, "episode_reward_min": 49.812276733621935, "episode_reward_mean": 54.38440725384775, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 29.62316053830772, "agent_1": 24.76124671554017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.66173403057414, "mean_processing_ms": 3.5396524455146383, "mean_inference_ms": 2.0798251769079963}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 146, "num_steps_trained": 7334656, "num_steps_sampled": 4942848, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9653, "num_samples_dropped": 314, "learner_queue": {"size_count": 39772, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.745, "replay_time_ms": 102.672, "update_priorities_time_ms": 54.021, "policy_agent_0": {"added_count": 1216256, "sampled_count": 1846016, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1216256, "sampled_count": 1846016, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3765329122543335, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6303467154502869, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 4942848, "episodes_total": 49432, "training_iteration": 51, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-36-30", "timestamp": 1569144990, "time_this_iter_s": 30.55634570121765, "time_total_s": 1559.0789637565613, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36569a378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1559.0789637565613, "timesteps_since_restore": 4942848, "iterations_since_restore": 51, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.426509729172345, "episode_reward_min": 48.663086908488275, "episode_reward_mean": 54.16882894798144, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 30.25596326183325, "agent_1": 23.912865686148294}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6634813097928614, "mean_processing_ms": 3.5451630627435766, "mean_inference_ms": 2.0800759132816036}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 149, "num_steps_trained": 7478016, "num_steps_sampled": 5039360, "sample_throughput": 31291.654, "train_throughput": 0.0, "num_weight_syncs": 9841, "num_samples_dropped": 314, "learner_queue": {"size_count": 40332, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.29, "replay_time_ms": 108.371, "update_priorities_time_ms": 51.625, "policy_agent_0": {"added_count": 1242624, "sampled_count": 1881088, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1242624, "sampled_count": 1881088, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.34483811259269714, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6498596668243408, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 5039360, "episodes_total": 50392, "training_iteration": 52, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-37-01", "timestamp": 1569145021, "time_this_iter_s": 30.568870782852173, "time_total_s": 1589.6478345394135, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36569af28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1589.6478345394135, "timesteps_since_restore": 5039360, "iterations_since_restore": 52, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.46453677844928, "episode_reward_min": 45.615502093433385, "episode_reward_mean": 53.544917096970714, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.428516313458427, "agent_1": 24.116400783512383}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6635249019908653, "mean_processing_ms": 3.5444077482384047, "mean_inference_ms": 2.080038148161481}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 151, "num_steps_trained": 7618560, "num_steps_sampled": 5135616, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10029, "num_samples_dropped": 314, "learner_queue": {"size_count": 40881, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.995, "replay_time_ms": 114.019, "update_priorities_time_ms": 49.802, "policy_agent_0": {"added_count": 1265920, "sampled_count": 1917440, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1265920, "sampled_count": 1917440, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.35549119114875793, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6416482329368591, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 5135616, "episodes_total": 51360, "training_iteration": 53, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-37-31", "timestamp": 1569145051, "time_this_iter_s": 30.60120439529419, "time_total_s": 1620.2490389347076, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656a8488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1620.2490389347076, "timesteps_since_restore": 5135616, "iterations_since_restore": 53, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.72108834400787, "episode_reward_min": 48.103855824491376, "episode_reward_mean": 56.27915487502129, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 30.424920465325922, "agent_1": 25.854234409695444}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6641549517148959, "mean_processing_ms": 3.5458139750339615, "mean_inference_ms": 2.0797708416701144}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 154, "num_steps_trained": 7758592, "num_steps_sampled": 5231360, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10216, "num_samples_dropped": 314, "learner_queue": {"size_count": 41428, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.99, "replay_time_ms": 104.216, "update_priorities_time_ms": 47.694, "policy_agent_0": {"added_count": 1292032, "sampled_count": 1950464, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1292032, "sampled_count": 1950464, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.34719032049179077, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6711270809173584, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 5231360, "episodes_total": 52312, "training_iteration": 54, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-38-02", "timestamp": 1569145082, "time_this_iter_s": 30.514431476593018, "time_total_s": 1650.7634704113007, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656780d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1650.7634704113007, "timesteps_since_restore": 5231360, "iterations_since_restore": 54, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.58362613852899, "episode_reward_min": 53.031261862428714, "episode_reward_mean": 56.29091287921215, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 30.624772098502007, "agent_1": 25.666140780710254}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6645683089258629, "mean_processing_ms": 3.548722323280338, "mean_inference_ms": 2.0803462281656735}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 157, "num_steps_trained": 7902208, "num_steps_sampled": 5329152, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10407, "num_samples_dropped": 314, "learner_queue": {"size_count": 41990, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.873, "replay_time_ms": 101.562, "update_priorities_time_ms": 59.087, "policy_agent_0": {"added_count": 1315584, "sampled_count": 1987328, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1315584, "sampled_count": 1987328, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.36255231499671936, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.660047173500061, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 5329152, "episodes_total": 53296, "training_iteration": 55, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-38-32", "timestamp": 1569145112, "time_this_iter_s": 30.53920841217041, "time_total_s": 1681.302678823471, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36568c598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1681.302678823471, "timesteps_since_restore": 5329152, "iterations_since_restore": 55, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.49763673555525, "episode_reward_min": 52.79802163042071, "episode_reward_mean": 55.14286066215863, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 30.37664425392396, "agent_1": 24.766216408234747}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6636785484083122, "mean_processing_ms": 3.5455573375634772, "mean_inference_ms": 2.0803484697425167}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 160, "num_steps_trained": 8043264, "num_steps_sampled": 5427968, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10601, "num_samples_dropped": 314, "learner_queue": {"size_count": 42540, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.456, "replay_time_ms": 108.01, "update_priorities_time_ms": 52.044, "policy_agent_0": {"added_count": 1342208, "sampled_count": 2021632, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1342208, "sampled_count": 2021632, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3299884796142578, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6603794097900391, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 5427968, "episodes_total": 54288, "training_iteration": 56, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-39-03", "timestamp": 1569145143, "time_this_iter_s": 30.686429738998413, "time_total_s": 1711.9891085624695, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656131e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1711.9891085624695, "timesteps_since_restore": 5427968, "iterations_since_restore": 56, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.18133903957502, "episode_reward_min": 45.21149236801466, "episode_reward_mean": 54.70748031627938, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.625957291808515, "agent_1": 25.08152302447091}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6646275252458897, "mean_processing_ms": 3.548636936203624, "mean_inference_ms": 2.0803446811247417}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 163, "num_steps_trained": 8186112, "num_steps_sampled": 5524992, "sample_throughput": 12438.509, "train_throughput": 0.0, "num_weight_syncs": 10789, "num_samples_dropped": 314, "learner_queue": {"size_count": 43098, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.425, "replay_time_ms": 111.479, "update_priorities_time_ms": 54.211, "policy_agent_0": {"added_count": 1363200, "sampled_count": 2058752, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1363200, "sampled_count": 2058752, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3239484131336212, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6481207609176636, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 5524992, "episodes_total": 55256, "training_iteration": 57, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-39-34", "timestamp": 1569145174, "time_this_iter_s": 30.499812841415405, "time_total_s": 1742.488921403885, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656196a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1742.488921403885, "timesteps_since_restore": 5524992, "iterations_since_restore": 57, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.16957353023842, "episode_reward_min": 48.36789154661575, "episode_reward_mean": 51.6585157108951, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 30.987565311597454, "agent_1": 20.67095039929769}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6645241871954264, "mean_processing_ms": 3.5486440957141236, "mean_inference_ms": 2.080254307077165}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 165, "num_steps_trained": 8327936, "num_steps_sampled": 5622272, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10980, "num_samples_dropped": 314, "learner_queue": {"size_count": 43652, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.407, "replay_time_ms": 107.089, "update_priorities_time_ms": 56.079, "policy_agent_0": {"added_count": 1388544, "sampled_count": 2094592, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1388544, "sampled_count": 2094592, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.33320152759552, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7046675682067871, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 5622272, "episodes_total": 56232, "training_iteration": 58, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-40-04", "timestamp": 1569145204, "time_this_iter_s": 30.62460231781006, "time_total_s": 1773.113523721695, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656262f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1773.113523721695, "timesteps_since_restore": 5622272, "iterations_since_restore": 58, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.99826571301233, "episode_reward_min": 47.471333585562704, "episode_reward_mean": 53.184328965713924, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 31.206928066869335, "agent_1": 21.97740089884462}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6649675196080691, "mean_processing_ms": 3.549349571931278, "mean_inference_ms": 2.080225656617055}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 168, "num_steps_trained": 8471040, "num_steps_sampled": 5719040, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11169, "num_samples_dropped": 314, "learner_queue": {"size_count": 44212, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.527, "replay_time_ms": 96.822, "update_priorities_time_ms": 56.38, "policy_agent_0": {"added_count": 1409280, "sampled_count": 2130944, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1409280, "sampled_count": 2130944, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.33724066615104675, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7777311205863953, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 5719040, "episodes_total": 57200, "training_iteration": 59, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-40-35", "timestamp": 1569145235, "time_this_iter_s": 30.59713625907898, "time_total_s": 1803.710659980774, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36562e7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1803.710659980774, "timesteps_since_restore": 5719040, "iterations_since_restore": 59, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.27963000507636, "episode_reward_min": 47.82712259742778, "episode_reward_mean": 55.669614282684456, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 32.83748636140612, "agent_1": 22.83212792127837}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6638459545229216, "mean_processing_ms": 3.5445291968907613, "mean_inference_ms": 2.080388132889207}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 171, "num_steps_trained": 8615424, "num_steps_sampled": 5816576, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11360, "num_samples_dropped": 314, "learner_queue": {"size_count": 44775, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.639, "replay_time_ms": 112.986, "update_priorities_time_ms": 60.24, "policy_agent_0": {"added_count": 1430272, "sampled_count": 2168320, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1430272, "sampled_count": 2168320, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.309135377407074, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7828077673912048, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 5816576, "episodes_total": 58176, "training_iteration": 60, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-41-06", "timestamp": 1569145266, "time_this_iter_s": 30.573223114013672, "time_total_s": 1834.2838830947876, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36568c620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1834.2838830947876, "timesteps_since_restore": 5816576, "iterations_since_restore": 60, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.02362424487971, "episode_reward_min": 44.24137727037971, "episode_reward_mean": 55.48511282179918, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 32.769029330325246, "agent_1": 22.71608349147403}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6642563134405748, "mean_processing_ms": 3.5471071800324476, "mean_inference_ms": 2.0805806857642577}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 174, "num_steps_trained": 8758272, "num_steps_sampled": 5914624, "sample_throughput": 0.0, "train_throughput": 15224.55, "num_weight_syncs": 11551, "num_samples_dropped": 314, "learner_queue": {"size_count": 45334, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.501, "replay_time_ms": 111.74, "update_priorities_time_ms": 60.611, "policy_agent_0": {"added_count": 1453824, "sampled_count": 2203136, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1453824, "sampled_count": 2203136, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3071947991847992, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7715011835098267, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 5914624, "episodes_total": 59144, "training_iteration": 61, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-41-36", "timestamp": 1569145296, "time_this_iter_s": 30.435113191604614, "time_total_s": 1864.7189962863922, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36567bc80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1864.7189962863922, "timesteps_since_restore": 5914624, "iterations_since_restore": 61, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.86849176674418, "episode_reward_min": 41.077304799010165, "episode_reward_mean": 51.5627917541756, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.55121683453673, "agent_1": 23.01157491963896}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6639719091913088, "mean_processing_ms": 3.546001984051238, "mean_inference_ms": 2.0795048985859466}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 177, "num_steps_trained": 8898048, "num_steps_sampled": 6014208, "sample_throughput": 20133.918, "train_throughput": 0.0, "num_weight_syncs": 11746, "num_samples_dropped": 314, "learner_queue": {"size_count": 45879, "size_mean": 0.14, "size_std": 0.4476605857119878, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 34.569, "replay_time_ms": 112.099, "update_priorities_time_ms": 54.794, "policy_agent_0": {"added_count": 1479680, "sampled_count": 2238464, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1479680, "sampled_count": 2238464, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3276823163032532, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7884260416030884, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 6014208, "episodes_total": 60144, "training_iteration": 62, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-42-07", "timestamp": 1569145327, "time_this_iter_s": 30.553399324417114, "time_total_s": 1895.2723956108093, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656e2378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1895.2723956108093, "timesteps_since_restore": 6014208, "iterations_since_restore": 62, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.38335283120495, "episode_reward_min": 42.89052737815993, "episode_reward_mean": 49.37414827080876, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 24.88799928922956, "agent_1": 24.486148981579262}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6646298432153966, "mean_processing_ms": 3.5482826657657993, "mean_inference_ms": 2.0803280859318236}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 180, "num_steps_trained": 9037568, "num_steps_sampled": 6111488, "sample_throughput": 0.0, "train_throughput": 23695.587, "num_weight_syncs": 11936, "num_samples_dropped": 314, "learner_queue": {"size_count": 46424, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.686, "replay_time_ms": 106.569, "update_priorities_time_ms": 47.346, "policy_agent_0": {"added_count": 1501184, "sampled_count": 2274560, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1501184, "sampled_count": 2274560, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4601808190345764, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7831199169158936, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 6111488, "episodes_total": 61120, "training_iteration": 63, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-42-37", "timestamp": 1569145357, "time_this_iter_s": 30.567550659179688, "time_total_s": 1925.839946269989, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365749730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1925.839946269989, "timesteps_since_restore": 6111488, "iterations_since_restore": 63, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.18581000825909, "episode_reward_min": 43.30149306426688, "episode_reward_mean": 46.10178531313063, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 22.289744580851064, "agent_1": 23.812040732279588}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6644925265458381, "mean_processing_ms": 3.5470256390839645, "mean_inference_ms": 2.0803980016140105}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 182, "num_steps_trained": 9178880, "num_steps_sampled": 6208512, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12125, "num_samples_dropped": 314, "learner_queue": {"size_count": 46976, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.989, "replay_time_ms": 115.388, "update_priorities_time_ms": 52.569, "policy_agent_0": {"added_count": 1525504, "sampled_count": 2312192, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1525504, "sampled_count": 2312192, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6031818985939026, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7977418899536133, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 6208512, "episodes_total": 62088, "training_iteration": 64, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-43-08", "timestamp": 1569145388, "time_this_iter_s": 30.553884029388428, "time_total_s": 1956.3938302993774, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365750e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1956.3938302993774, "timesteps_since_restore": 6208512, "iterations_since_restore": 64, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.57588649251659, "episode_reward_min": 42.985314505250486, "episode_reward_mean": 45.603552026573226, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 22.424875774099235, "agent_1": 23.178676252474038}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6646266969338066, "mean_processing_ms": 3.5474682552019616, "mean_inference_ms": 2.0804021597417512}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 185, "num_steps_trained": 9319680, "num_steps_sampled": 6305792, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12316, "num_samples_dropped": 314, "learner_queue": {"size_count": 47526, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.554, "replay_time_ms": 115.901, "update_priorities_time_ms": 48.991, "policy_agent_0": {"added_count": 1547520, "sampled_count": 2348032, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1547520, "sampled_count": 2348032, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6969544887542725, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7827888131141663, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 6305792, "episodes_total": 63072, "training_iteration": 65, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-43-38", "timestamp": 1569145418, "time_this_iter_s": 30.53686237335205, "time_total_s": 1986.9306926727295, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365fa3e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 1986.9306926727295, "timesteps_since_restore": 6305792, "iterations_since_restore": 65, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.968659959831, "episode_reward_min": 42.60893217865715, "episode_reward_mean": 46.129032721981055, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 23.805571323494974, "agent_1": 22.323461398486163}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.663674673338606, "mean_processing_ms": 3.545488461610891, "mean_inference_ms": 2.0798163129624254}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 188, "num_steps_trained": 9461760, "num_steps_sampled": 6402816, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12505, "num_samples_dropped": 314, "learner_queue": {"size_count": 48081, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.526, "replay_time_ms": 94.809, "update_priorities_time_ms": 51.214, "policy_agent_0": {"added_count": 1571072, "sampled_count": 2385152, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1571072, "sampled_count": 2385152, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7598975896835327, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7975155711174011, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 6402816, "episodes_total": 64032, "training_iteration": 66, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-44-09", "timestamp": 1569145449, "time_this_iter_s": 30.42813229560852, "time_total_s": 2017.358824968338, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365704730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2017.358824968338, "timesteps_since_restore": 6402816, "iterations_since_restore": 66, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.72240256086521, "episode_reward_min": 42.55608585645073, "episode_reward_mean": 45.501138471116924, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 24.243650333847402, "agent_1": 21.257488137269604}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6637840928117478, "mean_processing_ms": 3.546358089817229, "mean_inference_ms": 2.0798970819431872}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 191, "num_steps_trained": 9602304, "num_steps_sampled": 6500864, "sample_throughput": 20325.626, "train_throughput": 0.0, "num_weight_syncs": 12696, "num_samples_dropped": 314, "learner_queue": {"size_count": 48630, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 48.536, "replay_time_ms": 114.623, "update_priorities_time_ms": 57.119, "policy_agent_0": {"added_count": 1597440, "sampled_count": 2418688, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1597440, "sampled_count": 2418688, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7612136006355286, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8098065257072449, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 6500864, "episodes_total": 65016, "training_iteration": 67, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-44-39", "timestamp": 1569145479, "time_this_iter_s": 30.561939001083374, "time_total_s": 2047.9207639694214, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656b0158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2047.9207639694214, "timesteps_since_restore": 6500864, "iterations_since_restore": 67, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.91074660973002, "episode_reward_min": 42.53679579291907, "episode_reward_mean": 56.80756301363029, "episode_len_mean": 100.0, "episodes_this_iter": 944, "policy_reward_mean": {"agent_0": 32.20051598036261, "agent_1": 24.607047033267676}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6647896402317894, "mean_processing_ms": 3.5504302920152684, "mean_inference_ms": 2.081462815886666}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 194, "num_steps_trained": 9745408, "num_steps_sampled": 6595840, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12881, "num_samples_dropped": 314, "learner_queue": {"size_count": 49189, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.933, "replay_time_ms": 85.161, "update_priorities_time_ms": 45.147, "policy_agent_0": {"added_count": 1618176, "sampled_count": 2454784, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1618176, "sampled_count": 2454784, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6752992868423462, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7964097857475281, "model": {}}}}, "timesteps_this_iter": 94976, "done": false, "timesteps_total": 6595840, "episodes_total": 65960, "training_iteration": 68, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-45-10", "timestamp": 1569145510, "time_this_iter_s": 30.498046875, "time_total_s": 2078.4188108444214, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656c92f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2078.4188108444214, "timesteps_since_restore": 6595840, "iterations_since_restore": 68, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 64.67188576830935, "episode_reward_min": 55.37184479336615, "episode_reward_mean": 60.032064315628375, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 33.29324512463912, "agent_1": 26.73881919098924}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6644745545112016, "mean_processing_ms": 3.548504480363787, "mean_inference_ms": 2.0806614110160457}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 197, "num_steps_trained": 9885696, "num_steps_sampled": 6694400, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13074, "num_samples_dropped": 314, "learner_queue": {"size_count": 49737, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.925, "replay_time_ms": 113.038, "update_priorities_time_ms": 53.103, "policy_agent_0": {"added_count": 1642752, "sampled_count": 2491392, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1642752, "sampled_count": 2491392, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5404608845710754, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7527880072593689, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 6694400, "episodes_total": 66944, "training_iteration": 69, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-45-41", "timestamp": 1569145541, "time_this_iter_s": 30.614745140075684, "time_total_s": 2109.033555984497, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656cae18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2109.033555984497, "timesteps_since_restore": 6694400, "iterations_since_restore": 69, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 63.18216667321412, "episode_reward_min": 54.72639633210725, "episode_reward_mean": 58.98977191949154, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 33.01372142660997, "agent_1": 25.976050492881534}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6640420060897593, "mean_processing_ms": 3.547503678646485, "mean_inference_ms": 2.0801171407363697}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 199, "num_steps_trained": 10024960, "num_steps_sampled": 6793216, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13267, "num_samples_dropped": 314, "learner_queue": {"size_count": 50281, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.554, "replay_time_ms": 92.094, "update_priorities_time_ms": 48.104, "policy_agent_0": {"added_count": 1668352, "sampled_count": 2527232, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1668352, "sampled_count": 2527232, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4268486201763153, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7200158834457397, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 6793216, "episodes_total": 67944, "training_iteration": 70, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-46-11", "timestamp": 1569145571, "time_this_iter_s": 30.49653935432434, "time_total_s": 2139.5300953388214, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36562ed90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2139.5300953388214, "timesteps_since_restore": 6793216, "iterations_since_restore": 70, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.06380329626929, "episode_reward_min": 46.18236192676318, "episode_reward_mean": 57.3740119436429, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 33.55917721650043, "agent_1": 23.814834727142465}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6641082664997723, "mean_processing_ms": 3.5470588095028717, "mean_inference_ms": 2.0802732130716683}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 202, "num_steps_trained": 10169088, "num_steps_sampled": 6889472, "sample_throughput": 20813.387, "train_throughput": 10406.694, "num_weight_syncs": 13455, "num_samples_dropped": 314, "learner_queue": {"size_count": 50844, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.554, "replay_time_ms": 141.5, "update_priorities_time_ms": 56.571, "policy_agent_0": {"added_count": 1690112, "sampled_count": 2565120, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1690112, "sampled_count": 2565120, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.33812373876571655, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6908702254295349, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 6889472, "episodes_total": 68904, "training_iteration": 71, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-46-42", "timestamp": 1569145602, "time_this_iter_s": 30.55741786956787, "time_total_s": 2170.0875132083893, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36570c2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2170.0875132083893, "timesteps_since_restore": 6889472, "iterations_since_restore": 71, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 63.13578959903169, "episode_reward_min": 48.49789904447621, "episode_reward_mean": 59.18118955407941, "episode_len_mean": 100.0, "episodes_this_iter": 928, "policy_reward_mean": {"agent_0": 28.223083617463633, "agent_1": 30.958105936615652}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6646284837274341, "mean_processing_ms": 3.548882415138184, "mean_inference_ms": 2.0818686591065134}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 205, "num_steps_trained": 10317824, "num_steps_sampled": 6981888, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13635, "num_samples_dropped": 314, "learner_queue": {"size_count": 51425, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.216, "replay_time_ms": 87.899, "update_priorities_time_ms": 48.819, "policy_agent_0": {"added_count": 1714688, "sampled_count": 2602240, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1714688, "sampled_count": 2602240, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.31204742193222046, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5860180258750916, "model": {}}}}, "timesteps_this_iter": 92416, "done": false, "timesteps_total": 6981888, "episodes_total": 69832, "training_iteration": 72, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-47-12", "timestamp": 1569145632, "time_this_iter_s": 30.535195350646973, "time_total_s": 2200.6227085590363, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36570cea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2200.6227085590363, "timesteps_since_restore": 6981888, "iterations_since_restore": 72, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 63.14122413296873, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 54.77108931960765, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.65766475884691, "agent_1": 29.113424560760688}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6646964840897488, "mean_processing_ms": 3.5482048219763724, "mean_inference_ms": 2.0812285353601045}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 208, "num_steps_trained": 10456832, "num_steps_sampled": 7080192, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13828, "num_samples_dropped": 314, "learner_queue": {"size_count": 51968, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.828, "replay_time_ms": 115.838, "update_priorities_time_ms": 55.56, "policy_agent_0": {"added_count": 1737984, "sampled_count": 2638336, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1737984, "sampled_count": 2638336, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3442758619785309, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5193135738372803, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 7080192, "episodes_total": 70800, "training_iteration": 73, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-47-43", "timestamp": 1569145663, "time_this_iter_s": 30.538196086883545, "time_total_s": 2231.16090464592, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656a8400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2231.16090464592, "timesteps_since_restore": 7080192, "iterations_since_restore": 73, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 63.134667685367425, "episode_reward_min": 46.1870865604419, "episode_reward_mean": 51.972281245334365, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 24.895360480447142, "agent_1": 27.076920764887216}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6653002506605193, "mean_processing_ms": 3.5497162404441003, "mean_inference_ms": 2.082414531428467}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 211, "num_steps_trained": 10601984, "num_steps_sampled": 7175936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14015, "num_samples_dropped": 314, "learner_queue": {"size_count": 52535, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.205, "replay_time_ms": 96.441, "update_priorities_time_ms": 48.42, "policy_agent_0": {"added_count": 1761536, "sampled_count": 2673664, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1761536, "sampled_count": 2673664, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.44730690121650696, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.48344123363494873, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 7175936, "episodes_total": 71768, "training_iteration": 74, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-48-13", "timestamp": 1569145693, "time_this_iter_s": 30.61396026611328, "time_total_s": 2261.774864912033, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365698048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2261.774864912033, "timesteps_since_restore": 7175936, "iterations_since_restore": 74, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 63.15575279630084, "episode_reward_min": 46.556580255525205, "episode_reward_mean": 55.17113175670975, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 26.219718382986255, "agent_1": 28.95141337372349}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.666098466716856, "mean_processing_ms": 3.5532475964850097, "mean_inference_ms": 2.08244760897016}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 214, "num_steps_trained": 10743296, "num_steps_sampled": 7273216, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14204, "num_samples_dropped": 314, "learner_queue": {"size_count": 53088, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.607, "replay_time_ms": 100.285, "update_priorities_time_ms": 54.095, "policy_agent_0": {"added_count": 1785088, "sampled_count": 2707456, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1785088, "sampled_count": 2707456, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5362026691436768, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4796975255012512, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 7273216, "episodes_total": 72736, "training_iteration": 75, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-48-44", "timestamp": 1569145724, "time_this_iter_s": 30.501115798950195, "time_total_s": 2292.2759807109833, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36569a510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2292.2759807109833, "timesteps_since_restore": 7273216, "iterations_since_restore": 75, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.37686577387216, "episode_reward_min": 45.55201112757706, "episode_reward_mean": 53.093748001649686, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 25.86641176485391, "agent_1": 27.227336236795843}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6661121110688544, "mean_processing_ms": 3.553358975106822, "mean_inference_ms": 2.082101269394573}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 216, "num_steps_trained": 10886400, "num_steps_sampled": 7369216, "sample_throughput": 9703.597, "train_throughput": 9703.597, "num_weight_syncs": 14392, "num_samples_dropped": 314, "learner_queue": {"size_count": 53646, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.575, "replay_time_ms": 103.35, "update_priorities_time_ms": 51.029, "policy_agent_0": {"added_count": 1807872, "sampled_count": 2744064, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1807872, "sampled_count": 2744064, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5506371259689331, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.48524826765060425, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 7369216, "episodes_total": 73696, "training_iteration": 76, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-49-15", "timestamp": 1569145755, "time_this_iter_s": 30.577096700668335, "time_total_s": 2322.8530774116516, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365735158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2322.8530774116516, "timesteps_since_restore": 7369216, "iterations_since_restore": 76, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.98505436581392, "episode_reward_min": 45.725719996175656, "episode_reward_mean": 58.288586726919114, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 29.208894075792827, "agent_1": 29.079692651126308}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6660321099530632, "mean_processing_ms": 3.552851073222475, "mean_inference_ms": 2.0824916196778505}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 219, "num_steps_trained": 11029760, "num_steps_sampled": 7465728, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14581, "num_samples_dropped": 314, "learner_queue": {"size_count": 54206, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.979, "replay_time_ms": 96.62, "update_priorities_time_ms": 49.543, "policy_agent_0": {"added_count": 1833472, "sampled_count": 2778368, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1833472, "sampled_count": 2778368, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5550296902656555, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.44207891821861267, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 7465728, "episodes_total": 74656, "training_iteration": 77, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-49-45", "timestamp": 1569145785, "time_this_iter_s": 30.557742595672607, "time_total_s": 2353.410820007324, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365692620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2353.410820007324, "timesteps_since_restore": 7465728, "iterations_since_restore": 77, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.406189162216464, "episode_reward_min": 56.602954849894104, "episode_reward_mean": 61.602105706897405, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 31.015206888074992, "agent_1": 30.58689881882241}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6659019604558568, "mean_processing_ms": 3.55297202782175, "mean_inference_ms": 2.0819019387080377}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 222, "num_steps_trained": 11173120, "num_steps_sampled": 7561472, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14767, "num_samples_dropped": 314, "learner_queue": {"size_count": 54766, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.437, "replay_time_ms": 112.944, "update_priorities_time_ms": 53.964, "policy_agent_0": {"added_count": 1861120, "sampled_count": 2813440, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1861120, "sampled_count": 2813440, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5059915781021118, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.42428988218307495, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 7561472, "episodes_total": 75616, "training_iteration": 78, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-50-16", "timestamp": 1569145816, "time_this_iter_s": 30.54924178123474, "time_total_s": 2383.960061788559, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365788268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2383.960061788559, "timesteps_since_restore": 7561472, "iterations_since_restore": 78, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.75206041822869, "episode_reward_min": 56.49455981176451, "episode_reward_mean": 61.517292198534825, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 30.916339766331333, "agent_1": 30.600952432203492}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6656898018968732, "mean_processing_ms": 3.552153710896275, "mean_inference_ms": 2.0818259688176606}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 225, "num_steps_trained": 11316480, "num_steps_sampled": 7659264, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 14958, "num_samples_dropped": 314, "learner_queue": {"size_count": 55326, "size_mean": 0.16, "size_std": 0.3666060555964672, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.79, "replay_time_ms": 103.643, "update_priorities_time_ms": 46.626, "policy_agent_0": {"added_count": 1886208, "sampled_count": 2848768, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1886208, "sampled_count": 2848768, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.38581356406211853, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3648144602775574, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 7659264, "episodes_total": 76592, "training_iteration": 79, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-50-46", "timestamp": 1569145846, "time_this_iter_s": 30.465115070343018, "time_total_s": 2414.425176858902, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36575d730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2414.425176858902, "timesteps_since_restore": 7659264, "iterations_since_restore": 79, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 64.18351380592115, "episode_reward_min": 51.247633941660865, "episode_reward_mean": 60.62078210651648, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 31.122706552140954, "agent_1": 29.49807555437552}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6660031665773568, "mean_processing_ms": 3.552497440778026, "mean_inference_ms": 2.0820542404918854}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 228, "num_steps_trained": 11459584, "num_steps_sampled": 7755776, "sample_throughput": 9335.262, "train_throughput": 0.0, "num_weight_syncs": 15147, "num_samples_dropped": 314, "learner_queue": {"size_count": 55885, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.808, "replay_time_ms": 103.123, "update_priorities_time_ms": 46.863, "policy_agent_0": {"added_count": 1908736, "sampled_count": 2885888, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1908736, "sampled_count": 2885888, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.35166630148887634, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3463561236858368, "model": {}}}}, "timesteps_this_iter": 96512, "done": false, "timesteps_total": 7755776, "episodes_total": 77560, "training_iteration": 80, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-51-17", "timestamp": 1569145877, "time_this_iter_s": 30.4712336063385, "time_total_s": 2444.8964104652405, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365635378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2444.8964104652405, "timesteps_since_restore": 7755776, "iterations_since_restore": 80, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 63.12678508342794, "episode_reward_min": 46.70186242246738, "episode_reward_mean": 53.586708432782416, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 31.969127940106453, "agent_1": 21.617580492675977}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6664889908877687, "mean_processing_ms": 3.5545550773539185, "mean_inference_ms": 2.082142790030021}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 231, "num_steps_trained": 11601920, "num_steps_sampled": 7854848, "sample_throughput": 5138.578, "train_throughput": 5138.578, "num_weight_syncs": 15341, "num_samples_dropped": 314, "learner_queue": {"size_count": 56441, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.402, "replay_time_ms": 105.155, "update_priorities_time_ms": 49.491, "policy_agent_0": {"added_count": 1936384, "sampled_count": 2920704, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1936384, "sampled_count": 2920704, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.324853777885437, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4735625088214874, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 7854848, "episodes_total": 78552, "training_iteration": 81, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-51-47", "timestamp": 1569145907, "time_this_iter_s": 30.529781103134155, "time_total_s": 2475.4261915683746, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365646158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2475.4261915683746, "timesteps_since_restore": 7854848, "iterations_since_restore": 81, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 59.98719132105741, "episode_reward_min": 47.24914452361823, "episode_reward_mean": 53.89030707930128, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 30.97398038051769, "agent_1": 22.916326698783617}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.666385083122212, "mean_processing_ms": 3.5532465110171643, "mean_inference_ms": 2.081767447435263}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 234, "num_steps_trained": 11743232, "num_steps_sampled": 7953920, "sample_throughput": 24098.703, "train_throughput": 0.0, "num_weight_syncs": 15534, "num_samples_dropped": 314, "learner_queue": {"size_count": 56993, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.774, "replay_time_ms": 89.323, "update_priorities_time_ms": 46.646, "policy_agent_0": {"added_count": 1958400, "sampled_count": 2955776, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1958400, "sampled_count": 2955776, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.295490562915802, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6065977811813354, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 7953920, "episodes_total": 79544, "training_iteration": 82, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-52-18", "timestamp": 1569145938, "time_this_iter_s": 30.67971682548523, "time_total_s": 2506.10590839386, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655d36a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2506.10590839386, "timesteps_since_restore": 7953920, "iterations_since_restore": 82, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.97292610031169, "episode_reward_min": 51.53050789215252, "episode_reward_mean": 57.20429514536619, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 31.893882064031487, "agent_1": 25.310413081334733}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6662897902895574, "mean_processing_ms": 3.5533795564748267, "mean_inference_ms": 2.0821638265507265}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 236, "num_steps_trained": 11888896, "num_steps_sampled": 8050944, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15724, "num_samples_dropped": 314, "learner_queue": {"size_count": 57562, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.291, "replay_time_ms": 82.141, "update_priorities_time_ms": 43.075, "policy_agent_0": {"added_count": 1985280, "sampled_count": 2994176, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 1985280, "sampled_count": 2994176, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.29086726903915405, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6546253561973572, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 8050944, "episodes_total": 80512, "training_iteration": 83, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-52-49", "timestamp": 1569145969, "time_this_iter_s": 30.48300576210022, "time_total_s": 2536.58891415596, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365788a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2536.58891415596, "timesteps_since_restore": 8050944, "iterations_since_restore": 83, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.23195729723837, "episode_reward_min": 47.82927564575272, "episode_reward_mean": 56.780890353564196, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 32.18633892179395, "agent_1": 24.59455143177035}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6659910104423032, "mean_processing_ms": 3.55287159935602, "mean_inference_ms": 2.082393122097681}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 239, "num_steps_trained": 12033024, "num_steps_sampled": 8148736, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 15914, "num_samples_dropped": 314, "learner_queue": {"size_count": 58126, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 26.543, "replay_time_ms": 99.749, "update_priorities_time_ms": 57.922, "policy_agent_0": {"added_count": 2011648, "sampled_count": 3030528, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2011648, "sampled_count": 3030528, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.27835607528686523, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6446147561073303, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 8148736, "episodes_total": 81488, "training_iteration": 84, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-53-19", "timestamp": 1569145999, "time_this_iter_s": 30.60118293762207, "time_total_s": 2567.190097093582, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365735d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2567.190097093582, "timesteps_since_restore": 8148736, "iterations_since_restore": 84, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.43415120531468, "episode_reward_min": 52.074445302075084, "episode_reward_mean": 57.98715098719286, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 32.72569516132723, "agent_1": 25.261455825865713}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6655890642127343, "mean_processing_ms": 3.551403725330453, "mean_inference_ms": 2.0816478820243858}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 242, "num_steps_trained": 12174592, "num_steps_sampled": 8247552, "sample_throughput": 7715.381, "train_throughput": 7715.381, "num_weight_syncs": 16107, "num_samples_dropped": 314, "learner_queue": {"size_count": 58678, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.881, "replay_time_ms": 91.028, "update_priorities_time_ms": 48.413, "policy_agent_0": {"added_count": 2034432, "sampled_count": 3069952, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2034432, "sampled_count": 3069952, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.27757132053375244, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6213728189468384, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 8247552, "episodes_total": 82480, "training_iteration": 85, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-53-50", "timestamp": 1569146030, "time_this_iter_s": 30.47231698036194, "time_total_s": 2597.662414073944, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36562ed08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2597.662414073944, "timesteps_since_restore": 8247552, "iterations_since_restore": 85, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.408813618165496, "episode_reward_min": 50.892700391942434, "episode_reward_mean": 54.48985721201612, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 30.432343864091703, "agent_1": 24.057513347924484}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6664440226552687, "mean_processing_ms": 3.5538757175089537, "mean_inference_ms": 2.0811928384382115}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 245, "num_steps_trained": 12316160, "num_steps_sampled": 8346624, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16301, "num_samples_dropped": 314, "learner_queue": {"size_count": 59231, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.452, "replay_time_ms": 85.442, "update_priorities_time_ms": 46.989, "policy_agent_0": {"added_count": 2059520, "sampled_count": 3106304, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2059520, "sampled_count": 3106304, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.28808003664016724, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6287586092948914, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 8346624, "episodes_total": 83472, "training_iteration": 86, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-54-20", "timestamp": 1569146060, "time_this_iter_s": 30.521809339523315, "time_total_s": 2628.1842234134674, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656cabf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2628.1842234134674, "timesteps_since_restore": 8346624, "iterations_since_restore": 86, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.318859959238836, "episode_reward_min": 49.24925124635486, "episode_reward_mean": 54.612313261900624, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 29.50404563151769, "agent_1": 25.10826763038301}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6658429349342296, "mean_processing_ms": 3.5516828696258287, "mean_inference_ms": 2.080797376167197}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 248, "num_steps_trained": 12460288, "num_steps_sampled": 8443392, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16490, "num_samples_dropped": 314, "learner_queue": {"size_count": 59794, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.82, "replay_time_ms": 107.877, "update_priorities_time_ms": 56.609, "policy_agent_0": {"added_count": 2082560, "sampled_count": 3141376, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2082560, "sampled_count": 3141376, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.2942013442516327, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6410607099533081, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 8443392, "episodes_total": 84440, "training_iteration": 87, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-54-51", "timestamp": 1569146091, "time_this_iter_s": 30.68973994255066, "time_total_s": 2658.873963356018, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656c9730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2658.873963356018, "timesteps_since_restore": 8443392, "iterations_since_restore": 87, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.51052799085358, "episode_reward_min": 43.734324625809066, "episode_reward_mean": 52.19610485459148, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 28.635604122296268, "agent_1": 23.56050073229526}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6660039173386694, "mean_processing_ms": 3.5522023335205155, "mean_inference_ms": 2.0812623005825728}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 251, "num_steps_trained": 12604672, "num_steps_sampled": 8541952, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16682, "num_samples_dropped": 314, "learner_queue": {"size_count": 60358, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.177, "replay_time_ms": 100.189, "update_priorities_time_ms": 43.986, "policy_agent_0": {"added_count": 2104320, "sampled_count": 3178496, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2104320, "sampled_count": 3178496, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3225594758987427, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6807868480682373, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 8541952, "episodes_total": 85424, "training_iteration": 88, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-55-22", "timestamp": 1569146122, "time_this_iter_s": 30.550153255462646, "time_total_s": 2689.4241166114807, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365706ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2689.4241166114807, "timesteps_since_restore": 8541952, "iterations_since_restore": 88, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.24372870972502, "episode_reward_min": 46.50115576549922, "episode_reward_mean": 52.165003945718674, "episode_len_mean": 100.0, "episodes_this_iter": 920, "policy_reward_mean": {"agent_0": 28.146567666144293, "agent_1": 24.018436279574427}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6656656110046848, "mean_processing_ms": 3.552017436957426, "mean_inference_ms": 2.0825744034589238}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 253, "num_steps_trained": 12742144, "num_steps_sampled": 8634880, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 16864, "num_samples_dropped": 314, "learner_queue": {"size_count": 60895, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.039, "replay_time_ms": 107.26, "update_priorities_time_ms": 65.168, "policy_agent_0": {"added_count": 2121728, "sampled_count": 3215872, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2121728, "sampled_count": 3215872, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3463404178619385, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6929512023925781, "model": {}}}}, "timesteps_this_iter": 92928, "done": false, "timesteps_total": 8634880, "episodes_total": 86344, "training_iteration": 89, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-55-52", "timestamp": 1569146152, "time_this_iter_s": 30.567097425460815, "time_total_s": 2719.9912140369415, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365704488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2719.9912140369415, "timesteps_since_restore": 8634880, "iterations_since_restore": 89, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.901116107224865, "episode_reward_min": 44.6860147960523, "episode_reward_mean": 53.81720693872293, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 29.53668482641141, "agent_1": 24.28052211231154}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.66588120100322, "mean_processing_ms": 3.5526109288297696, "mean_inference_ms": 2.0829057441728662}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 256, "num_steps_trained": 12887808, "num_steps_sampled": 8732672, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17055, "num_samples_dropped": 314, "learner_queue": {"size_count": 61464, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.527, "replay_time_ms": 114.969, "update_priorities_time_ms": 57.221, "policy_agent_0": {"added_count": 2142976, "sampled_count": 3253504, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2142976, "sampled_count": 3253504, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3752378225326538, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.706340491771698, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 8732672, "episodes_total": 87336, "training_iteration": 90, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-56-23", "timestamp": 1569146183, "time_this_iter_s": 30.637022256851196, "time_total_s": 2750.6282362937927, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365fb0048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2750.6282362937927, "timesteps_since_restore": 8732672, "iterations_since_restore": 90, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.023019417792405, "episode_reward_min": 44.65896369243713, "episode_reward_mean": 54.19759790786428, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 29.368068927133525, "agent_1": 24.82952898073077}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6658540476071386, "mean_processing_ms": 3.553170942166514, "mean_inference_ms": 2.0826139605884784}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 259, "num_steps_trained": 13030656, "num_steps_sampled": 8830720, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17246, "num_samples_dropped": 314, "learner_queue": {"size_count": 62022, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 42.871, "replay_time_ms": 112.341, "update_priorities_time_ms": 54.198, "policy_agent_0": {"added_count": 2167552, "sampled_count": 3289088, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2167552, "sampled_count": 3289088, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.39476028084754944, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6663753390312195, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 8830720, "episodes_total": 88312, "training_iteration": 91, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-56-53", "timestamp": 1569146213, "time_this_iter_s": 30.59283947944641, "time_total_s": 2781.221075773239, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365750c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2781.221075773239, "timesteps_since_restore": 8830720, "iterations_since_restore": 91, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.54830069388493, "episode_reward_min": 48.99441121882489, "episode_reward_mean": 58.15289655925655, "episode_len_mean": 100.0, "episodes_this_iter": 952, "policy_reward_mean": {"agent_0": 32.42689614660052, "agent_1": 25.726000412656006}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6658209169609777, "mean_processing_ms": 3.553424922904313, "mean_inference_ms": 2.0830148190788176}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 262, "num_steps_trained": 13179648, "num_steps_sampled": 8925696, "sample_throughput": 6884.637, "train_throughput": 0.0, "num_weight_syncs": 17432, "num_samples_dropped": 314, "learner_queue": {"size_count": 62606, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.92, "replay_time_ms": 94.55, "update_priorities_time_ms": 55.991, "policy_agent_0": {"added_count": 2189312, "sampled_count": 3325696, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2189312, "sampled_count": 3325696, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.39390796422958374, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6322259306907654, "model": {}}}}, "timesteps_this_iter": 94976, "done": false, "timesteps_total": 8925696, "episodes_total": 89264, "training_iteration": 92, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-57-24", "timestamp": 1569146244, "time_this_iter_s": 30.531055212020874, "time_total_s": 2811.75213098526, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656d11e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2811.75213098526, "timesteps_since_restore": 8925696, "iterations_since_restore": 92, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.54204570026579, "episode_reward_min": 56.612750878823235, "episode_reward_mean": 58.72909405510553, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 32.23777551331611, "agent_1": 26.49131854178942}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6652652859237453, "mean_processing_ms": 3.5521618559156884, "mean_inference_ms": 2.082249197898118}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 265, "num_steps_trained": 13320192, "num_steps_sampled": 9026048, "sample_throughput": 0.0, "train_throughput": 15692.015, "num_weight_syncs": 17628, "num_samples_dropped": 314, "learner_queue": {"size_count": 63153, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.726, "replay_time_ms": 107.242, "update_priorities_time_ms": 58.023, "policy_agent_0": {"added_count": 2212352, "sampled_count": 3362304, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2212352, "sampled_count": 3362304, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3472192883491516, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5907679200172424, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 9026048, "episodes_total": 90272, "training_iteration": 93, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-57-55", "timestamp": 1569146275, "time_this_iter_s": 30.593896865844727, "time_total_s": 2842.3460278511047, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656e2268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2842.3460278511047, "timesteps_since_restore": 9026048, "iterations_since_restore": 93, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 59.883698533657444, "episode_reward_min": 51.21656963127205, "episode_reward_mean": 57.80645230777804, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 31.77702620707526, "agent_1": 26.02942610070281}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6661072634432196, "mean_processing_ms": 3.5543801750152992, "mean_inference_ms": 2.0827161989265757}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 268, "num_steps_trained": 13467136, "num_steps_sampled": 9123584, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 17818, "num_samples_dropped": 314, "learner_queue": {"size_count": 63727, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.837, "replay_time_ms": 104.971, "update_priorities_time_ms": 65.061, "policy_agent_0": {"added_count": 2233344, "sampled_count": 3399424, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2233344, "sampled_count": 3399424, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.28149712085723877, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5845432281494141, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 9123584, "episodes_total": 91248, "training_iteration": 94, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-58-25", "timestamp": 1569146305, "time_this_iter_s": 30.599853992462158, "time_total_s": 2872.945881843567, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656788c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2872.945881843567, "timesteps_since_restore": 9123584, "iterations_since_restore": 94, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.55482866130872, "episode_reward_min": 47.31749819899314, "episode_reward_mean": 57.40010991090016, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 31.38708164053905, "agent_1": 26.013028270361122}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.665751900628383, "mean_processing_ms": 3.552680467968652, "mean_inference_ms": 2.081642944228967}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 271, "num_steps_trained": 13611008, "num_steps_sampled": 9223424, "sample_throughput": 7602.035, "train_throughput": 0.0, "num_weight_syncs": 18013, "num_samples_dropped": 314, "learner_queue": {"size_count": 64289, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.104, "replay_time_ms": 91.786, "update_priorities_time_ms": 47.774, "policy_agent_0": {"added_count": 2256384, "sampled_count": 3437056, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2256384, "sampled_count": 3437056, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.2919355034828186, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5512915849685669, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 9223424, "episodes_total": 92240, "training_iteration": 95, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-58-56", "timestamp": 1569146336, "time_this_iter_s": 30.591920852661133, "time_total_s": 2903.537802696228, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36568c488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2903.537802696228, "timesteps_since_restore": 9223424, "iterations_since_restore": 95, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 59.724202087083306, "episode_reward_min": 50.41597643418637, "episode_reward_mean": 56.33255309859602, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 30.02413857683512, "agent_1": 26.30841452176097}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6656490090564688, "mean_processing_ms": 3.551971167566459, "mean_inference_ms": 2.0820110997430823}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 274, "num_steps_trained": 13760512, "num_steps_sampled": 9319680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18202, "num_samples_dropped": 314, "learner_queue": {"size_count": 64875, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 48.207, "replay_time_ms": 106.393, "update_priorities_time_ms": 54.718, "policy_agent_0": {"added_count": 2279936, "sampled_count": 3472128, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2279936, "sampled_count": 3472128, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.30316683650016785, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5463114380836487, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 9319680, "episodes_total": 93200, "training_iteration": 96, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-59-26", "timestamp": 1569146366, "time_this_iter_s": 30.53174138069153, "time_total_s": 2934.0695440769196, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365619598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2934.0695440769196, "timesteps_since_restore": 9319680, "iterations_since_restore": 96, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.55827868915324, "episode_reward_min": 45.3952820892655, "episode_reward_mean": 56.62349149592319, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 29.931473324607307, "agent_1": 26.69201817131598}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.66578456461587, "mean_processing_ms": 3.5520654385015034, "mean_inference_ms": 2.0810992181190557}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 277, "num_steps_trained": 13905408, "num_steps_sampled": 9418752, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18394, "num_samples_dropped": 314, "learner_queue": {"size_count": 65439, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.806, "replay_time_ms": 107.626, "update_priorities_time_ms": 46.747, "policy_agent_0": {"added_count": 2304512, "sampled_count": 3508224, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2304512, "sampled_count": 3508224, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3176197111606598, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5157068371772766, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 9418752, "episodes_total": 94192, "training_iteration": 97, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_09-59-57", "timestamp": 1569146397, "time_this_iter_s": 30.518627643585205, "time_total_s": 2964.5881717205048, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36570c1e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2964.5881717205048, "timesteps_since_restore": 9418752, "iterations_since_restore": 97, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.941619011528466, "episode_reward_min": 45.41732617276573, "episode_reward_mean": 49.68905782449718, "episode_len_mean": 100.0, "episodes_this_iter": 904, "policy_reward_mean": {"agent_0": 27.717945243394293, "agent_1": 21.971112581102947}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6653389011092722, "mean_processing_ms": 3.551870793549848, "mean_inference_ms": 2.0828703570608287}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 279, "num_steps_trained": 14043392, "num_steps_sampled": 9509888, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18573, "num_samples_dropped": 314, "learner_queue": {"size_count": 65978, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 41.277, "replay_time_ms": 108.897, "update_priorities_time_ms": 48.501, "policy_agent_0": {"added_count": 2324992, "sampled_count": 3544064, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2324992, "sampled_count": 3544064, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3450338542461395, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5641866326332092, "model": {}}}}, "timesteps_this_iter": 91136, "done": false, "timesteps_total": 9509888, "episodes_total": 95096, "training_iteration": 98, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-00-28", "timestamp": 1569146428, "time_this_iter_s": 30.534154176712036, "time_total_s": 2995.122325897217, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656866a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 2995.122325897217, "timesteps_since_restore": 9509888, "iterations_since_restore": 98, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.239801933771304, "episode_reward_min": 45.41927135747379, "episode_reward_mean": 55.182588145084544, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 29.27350397067213, "agent_1": 25.909084174412403}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6655282676432657, "mean_processing_ms": 3.5518196560398287, "mean_inference_ms": 2.0821264759648437}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 282, "num_steps_trained": 14186752, "num_steps_sampled": 9610240, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18769, "num_samples_dropped": 314, "learner_queue": {"size_count": 66538, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.443, "replay_time_ms": 108.858, "update_priorities_time_ms": 57.727, "policy_agent_0": {"added_count": 2353920, "sampled_count": 3579648, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2353920, "sampled_count": 3579648, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3509058356285095, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6292983293533325, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 9610240, "episodes_total": 96104, "training_iteration": 99, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-00-58", "timestamp": 1569146458, "time_this_iter_s": 30.504904985427856, "time_total_s": 3025.6272308826447, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36569a2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3025.6272308826447, "timesteps_since_restore": 9610240, "iterations_since_restore": 99, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 63.381442135666454, "episode_reward_min": 48.305657848327705, "episode_reward_mean": 56.70236907275823, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.610840687432056, "agent_1": 29.09152838532618}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6654296753124377, "mean_processing_ms": 3.55160262879112, "mean_inference_ms": 2.0818710059474097}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 285, "num_steps_trained": 14330880, "num_steps_sampled": 9709312, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 18963, "num_samples_dropped": 314, "learner_queue": {"size_count": 67101, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.724, "replay_time_ms": 107.048, "update_priorities_time_ms": 58.961, "policy_agent_0": {"added_count": 2381568, "sampled_count": 3613440, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2381568, "sampled_count": 3613440, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3677903711795807, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5915943384170532, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 9709312, "episodes_total": 97096, "training_iteration": 100, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-01-29", "timestamp": 1569146489, "time_this_iter_s": 30.579641342163086, "time_total_s": 3056.2068722248077, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656987b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3056.2068722248077, "timesteps_since_restore": 9709312, "iterations_since_restore": 100, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.54814813559343, "episode_reward_min": 46.216455847044145, "episode_reward_mean": 55.18742525701047, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 28.057644177944727, "agent_1": 27.1297810790658}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6657724956000207, "mean_processing_ms": 3.5525663033783554, "mean_inference_ms": 2.082541213915025}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 288, "num_steps_trained": 14484480, "num_steps_sampled": 9805056, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19149, "num_samples_dropped": 314, "learner_queue": {"size_count": 67701, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.79, "replay_time_ms": 116.523, "update_priorities_time_ms": 54.664, "policy_agent_0": {"added_count": 2403584, "sampled_count": 3650048, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2403584, "sampled_count": 3650048, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3838779926300049, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5218283534049988, "model": {}}}}, "timesteps_this_iter": 95744, "done": false, "timesteps_total": 9805056, "episodes_total": 98056, "training_iteration": 101, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-01-59", "timestamp": 1569146519, "time_this_iter_s": 30.529056787490845, "time_total_s": 3086.7359290122986, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655e7378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3086.7359290122986, "timesteps_since_restore": 9805056, "iterations_since_restore": 101, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.53516996538608, "episode_reward_min": 54.85637077058747, "episode_reward_mean": 57.978808592902496, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 30.797679425547724, "agent_1": 27.181129167354783}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6655089745205657, "mean_processing_ms": 3.5519810269533587, "mean_inference_ms": 2.0824577715098784}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 291, "num_steps_trained": 14634240, "num_steps_sampled": 9901824, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19339, "num_samples_dropped": 314, "learner_queue": {"size_count": 68286, "size_mean": 0.4, "size_std": 0.692820323027551, "size_quantiles": [0.0, 0.0, 0.0, 2.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.483, "replay_time_ms": 88.972, "update_priorities_time_ms": 45.019, "policy_agent_0": {"added_count": 2430720, "sampled_count": 3685632, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2430720, "sampled_count": 3685632, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3935932517051697, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.48734450340270996, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 9901824, "episodes_total": 99032, "training_iteration": 102, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-02-30", "timestamp": 1569146550, "time_this_iter_s": 30.60109519958496, "time_total_s": 3117.3370242118835, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655e48c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3117.3370242118835, "timesteps_since_restore": 9901824, "iterations_since_restore": 102, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.16051480568794, "episode_reward_min": 43.0701335603198, "episode_reward_mean": 49.908155093333455, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 21.77793406454005, "agent_1": 28.130221028793436}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6654535392666664, "mean_processing_ms": 3.551506093681031, "mean_inference_ms": 2.081911434201593}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 294, "num_steps_trained": 14776832, "num_steps_sampled": 10002176, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19534, "num_samples_dropped": 314, "learner_queue": {"size_count": 68844, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.147, "replay_time_ms": 88.707, "update_priorities_time_ms": 44.891, "policy_agent_0": {"added_count": 2456064, "sampled_count": 3721216, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2456064, "sampled_count": 3721216, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5150006413459778, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.46024948358535767, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 10002176, "episodes_total": 100032, "training_iteration": 103, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-03-00", "timestamp": 1569146580, "time_this_iter_s": 30.523616075515747, "time_total_s": 3147.8606402873993, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655dd510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3147.8606402873993, "timesteps_since_restore": 10002176, "iterations_since_restore": 103, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.83483700546949, "episode_reward_min": 44.833372008050084, "episode_reward_mean": 51.21379473580217, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 22.729840813642543, "agent_1": 28.483953922159646}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6653729014327069, "mean_processing_ms": 3.550950696259533, "mean_inference_ms": 2.0812871904741357}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 297, "num_steps_trained": 14925312, "num_steps_sampled": 10099712, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 19725, "num_samples_dropped": 314, "learner_queue": {"size_count": 69423, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.564, "replay_time_ms": 96.118, "update_priorities_time_ms": 52.241, "policy_agent_0": {"added_count": 2481408, "sampled_count": 3758080, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2481408, "sampled_count": 3758080, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6221480965614319, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.43755942583084106, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 10099712, "episodes_total": 101000, "training_iteration": 104, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-03-31", "timestamp": 1569146611, "time_this_iter_s": 30.62441658973694, "time_total_s": 3178.4850568771362, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655f69d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3178.4850568771362, "timesteps_since_restore": 10099712, "iterations_since_restore": 104, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.274841441343725, "episode_reward_min": 45.47699492071061, "episode_reward_mean": 52.61075245288257, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 24.63427667133818, "agent_1": 27.97647578154445}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.664808366483782, "mean_processing_ms": 3.5488188833316894, "mean_inference_ms": 2.08054639985083}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 300, "num_steps_trained": 15075072, "num_steps_sampled": 10197760, "sample_throughput": 8182.823, "train_throughput": 0.0, "num_weight_syncs": 19917, "num_samples_dropped": 314, "learner_queue": {"size_count": 70008, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 30.893, "replay_time_ms": 112.29, "update_priorities_time_ms": 46.942, "policy_agent_0": {"added_count": 2507008, "sampled_count": 3790080, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2507008, "sampled_count": 3790080, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6785600185394287, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.40680214762687683, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 10197760, "episodes_total": 101976, "training_iteration": 105, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-04-02", "timestamp": 1569146642, "time_this_iter_s": 30.453975200653076, "time_total_s": 3208.9390320777893, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655fd620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3208.9390320777893, "timesteps_since_restore": 10197760, "iterations_since_restore": 105, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.28966502479461, "episode_reward_min": 45.881985270871624, "episode_reward_mean": 54.965161269772395, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.756250647326702, "agent_1": 29.208910622445817}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6653667433242971, "mean_processing_ms": 3.5504226087452064, "mean_inference_ms": 2.08081192018984}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 303, "num_steps_trained": 15221760, "num_steps_sampled": 10295552, "sample_throughput": 0.0, "train_throughput": 34050.289, "num_weight_syncs": 20107, "num_samples_dropped": 314, "learner_queue": {"size_count": 70581, "size_mean": 1.36, "size_std": 2.488051446413438, "size_quantiles": [0.0, 0.0, 0.0, 5.100000000000001, 9.0]}, "replay_shard_0": {"add_batch_time_ms": 28.663, "replay_time_ms": 90.206, "update_priorities_time_ms": 47.316, "policy_agent_0": {"added_count": 2530560, "sampled_count": 3825408, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2530560, "sampled_count": 3825408, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.664336085319519, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3894433081150055, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 10295552, "episodes_total": 102960, "training_iteration": 106, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-04-32", "timestamp": 1569146672, "time_this_iter_s": 30.509856700897217, "time_total_s": 3239.4488887786865, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365606ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3239.4488887786865, "timesteps_since_restore": 10295552, "iterations_since_restore": 106, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.29256770392783, "episode_reward_min": 48.59674603749528, "episode_reward_mean": 56.624516263057245, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.69305510789499, "agent_1": 29.93146115516234}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6654805707939002, "mean_processing_ms": 3.550425653431794, "mean_inference_ms": 2.0807344789737368}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 306, "num_steps_trained": 15371520, "num_steps_sampled": 10393344, "sample_throughput": 9838.837, "train_throughput": 0.0, "num_weight_syncs": 20299, "num_samples_dropped": 314, "learner_queue": {"size_count": 71166, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.227, "replay_time_ms": 114.595, "update_priorities_time_ms": 54.67, "policy_agent_0": {"added_count": 2554624, "sampled_count": 3860480, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2554624, "sampled_count": 3860480, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6220647692680359, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3590242862701416, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 10393344, "episodes_total": 103936, "training_iteration": 107, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-05-03", "timestamp": 1569146703, "time_this_iter_s": 30.623589277267456, "time_total_s": 3270.072478055954, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655e49d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3270.072478055954, "timesteps_since_restore": 10393344, "iterations_since_restore": 107, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.548794160538336, "episode_reward_min": 51.46245599061619, "episode_reward_mean": 56.468465537129056, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 27.693220354695264, "agent_1": 28.775245182433814}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6653173186656993, "mean_processing_ms": 3.549924971772482, "mean_inference_ms": 2.0813197362547964}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 309, "num_steps_trained": 15515648, "num_steps_sampled": 10489600, "sample_throughput": 19312.945, "train_throughput": 0.0, "num_weight_syncs": 20487, "num_samples_dropped": 314, "learner_queue": {"size_count": 71729, "size_mean": 0.12, "size_std": 0.3815756805667783, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.356, "replay_time_ms": 91.934, "update_priorities_time_ms": 48.138, "policy_agent_0": {"added_count": 2575360, "sampled_count": 3895808, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2575360, "sampled_count": 3895808, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5803676843643188, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3537532687187195, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 10489600, "episodes_total": 104904, "training_iteration": 108, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-05-33", "timestamp": 1569146733, "time_this_iter_s": 30.685229778289795, "time_total_s": 3300.757707834244, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365698c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3300.757707834244, "timesteps_since_restore": 10489600, "iterations_since_restore": 108, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.70986516130056, "episode_reward_min": 44.17700982128574, "episode_reward_mean": 48.905224138729075, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 22.293789169193868, "agent_1": 26.61143496953523}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6657246828266596, "mean_processing_ms": 3.551465828220682, "mean_inference_ms": 2.0813750198162047}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 312, "num_steps_trained": 15667200, "num_steps_sampled": 10586624, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20676, "num_samples_dropped": 314, "learner_queue": {"size_count": 72321, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.983, "replay_time_ms": 99.249, "update_priorities_time_ms": 49.903, "policy_agent_0": {"added_count": 2598912, "sampled_count": 3931392, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2598912, "sampled_count": 3931392, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5862395167350769, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.35803425312042236, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 10586624, "episodes_total": 105872, "training_iteration": 109, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-06-04", "timestamp": 1569146764, "time_this_iter_s": 30.616933822631836, "time_total_s": 3331.3746416568756, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36569a268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3331.3746416568756, "timesteps_since_restore": 10586624, "iterations_since_restore": 109, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 59.05348406485825, "episode_reward_min": 47.34337368507333, "episode_reward_mean": 51.93379983918814, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 23.89874133882625, "agent_1": 28.035058500361888}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6662149047536509, "mean_processing_ms": 3.552982436048628, "mean_inference_ms": 2.0816306939262694}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 315, "num_steps_trained": 15816704, "num_steps_sampled": 10684416, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 20866, "num_samples_dropped": 314, "learner_queue": {"size_count": 72905, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.535, "replay_time_ms": 116.75, "update_priorities_time_ms": 56.151, "policy_agent_0": {"added_count": 2624768, "sampled_count": 3964928, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2624768, "sampled_count": 3964928, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6212157607078552, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3816545903682709, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 10684416, "episodes_total": 106848, "training_iteration": 110, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-06-35", "timestamp": 1569146795, "time_this_iter_s": 30.5997052192688, "time_total_s": 3361.9743468761444, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36568c488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3361.9743468761444, "timesteps_since_restore": 10684416, "iterations_since_restore": 110, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 59.17793309668256, "episode_reward_min": 48.375997045451875, "episode_reward_mean": 53.08798126455706, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 26.05922900146047, "agent_1": 27.028752263096607}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6660762822182771, "mean_processing_ms": 3.551902493763137, "mean_inference_ms": 2.081178346372241}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 318, "num_steps_trained": 15966464, "num_steps_sampled": 10781952, "sample_throughput": 10181.653, "train_throughput": 0.0, "num_weight_syncs": 21058, "num_samples_dropped": 314, "learner_queue": {"size_count": 73490, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.826, "replay_time_ms": 95.277, "update_priorities_time_ms": 44.406, "policy_agent_0": {"added_count": 2648064, "sampled_count": 3999488, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2648064, "sampled_count": 3999488, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6200100183486938, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.39188718795776367, "model": {}}}}, "timesteps_this_iter": 97536, "done": false, "timesteps_total": 10781952, "episodes_total": 107816, "training_iteration": 111, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-07-05", "timestamp": 1569146825, "time_this_iter_s": 30.584886074066162, "time_total_s": 3392.5592329502106, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36568c840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3392.5592329502106, "timesteps_since_restore": 10781952, "iterations_since_restore": 111, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.115912483502115, "episode_reward_min": 49.97148580796124, "episode_reward_mean": 56.70854139131857, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.713288294890575, "agent_1": 28.99525309642801}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6655526316236616, "mean_processing_ms": 3.549644159365151, "mean_inference_ms": 2.081235721009895}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 321, "num_steps_trained": 16117248, "num_steps_sampled": 10880768, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21251, "num_samples_dropped": 314, "learner_queue": {"size_count": 74079, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.385, "replay_time_ms": 114.968, "update_priorities_time_ms": 53.177, "policy_agent_0": {"added_count": 2668800, "sampled_count": 4034816, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2668800, "sampled_count": 4034816, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5765613317489624, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.41463014483451843, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 10880768, "episodes_total": 108816, "training_iteration": 112, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-07-36", "timestamp": 1569146856, "time_this_iter_s": 30.553221225738525, "time_total_s": 3423.112454175949, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36567b7b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3423.112454175949, "timesteps_since_restore": 10880768, "iterations_since_restore": 112, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.80622796426364, "episode_reward_min": 44.81220618673977, "episode_reward_mean": 53.71232606741837, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.008678283737847, "agent_1": 27.703647783680548}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6659774933617408, "mean_processing_ms": 3.551434146407993, "mean_inference_ms": 2.0810613550337695}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 324, "num_steps_trained": 16269056, "num_steps_sampled": 10979072, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21443, "num_samples_dropped": 314, "learner_queue": {"size_count": 74673, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.426, "replay_time_ms": 102.267, "update_priorities_time_ms": 53.064, "policy_agent_0": {"added_count": 2693120, "sampled_count": 4074240, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2693120, "sampled_count": 4074240, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5346533060073853, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3989495635032654, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 10979072, "episodes_total": 109792, "training_iteration": 113, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-08-07", "timestamp": 1569146887, "time_this_iter_s": 30.56644368171692, "time_total_s": 3453.678897857666, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656e27b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3453.678897857666, "timesteps_since_restore": 10979072, "iterations_since_restore": 113, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.37250084080524, "episode_reward_min": 42.554480370019306, "episode_reward_mean": 52.67235750120005, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 24.627626714874992, "agent_1": 28.044730786325054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6654260480571554, "mean_processing_ms": 3.5494354708205607, "mean_inference_ms": 2.0809379708858327}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 327, "num_steps_trained": 16420608, "num_steps_sampled": 11077632, "sample_throughput": 0.0, "train_throughput": 11667.175, "num_weight_syncs": 21634, "num_samples_dropped": 314, "learner_queue": {"size_count": 75265, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.653, "replay_time_ms": 120.518, "update_priorities_time_ms": 60.409, "policy_agent_0": {"added_count": 2714880, "sampled_count": 4110336, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2714880, "sampled_count": 4110336, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5426900386810303, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4145713746547699, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 11077632, "episodes_total": 110776, "training_iteration": 114, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-08-37", "timestamp": 1569146917, "time_this_iter_s": 30.680916786193848, "time_total_s": 3484.35981464386, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365749e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3484.35981464386, "timesteps_since_restore": 11077632, "iterations_since_restore": 114, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 64.07646401371753, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 57.483402512980646, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 26.71953429235206, "agent_1": 30.763868220628602}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6658511743263258, "mean_processing_ms": 3.5515630242032583, "mean_inference_ms": 2.0814294228253565}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 330, "num_steps_trained": 16573696, "num_steps_sampled": 11174400, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 21823, "num_samples_dropped": 314, "learner_queue": {"size_count": 75862, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.334, "replay_time_ms": 111.975, "update_priorities_time_ms": 59.579, "policy_agent_0": {"added_count": 2738944, "sampled_count": 4146432, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2738944, "sampled_count": 4146432, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5597878098487854, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.42621439695358276, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 11174400, "episodes_total": 111752, "training_iteration": 115, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-09-08", "timestamp": 1569146948, "time_this_iter_s": 30.583661317825317, "time_total_s": 3514.943475961685, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365750a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3514.943475961685, "timesteps_since_restore": 11174400, "iterations_since_restore": 115, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.58907017175422, "episode_reward_min": 55.816489210831826, "episode_reward_mean": 58.322140291394774, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 25.600212911409187, "agent_1": 32.72192737998558}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6659965763475789, "mean_processing_ms": 3.552999086431991, "mean_inference_ms": 2.081402105645774}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 333, "num_steps_trained": 16725504, "num_steps_sampled": 11272192, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22015, "num_samples_dropped": 314, "learner_queue": {"size_count": 76455, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.031, "replay_time_ms": 102.824, "update_priorities_time_ms": 52.743, "policy_agent_0": {"added_count": 2765824, "sampled_count": 4184064, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2765824, "sampled_count": 4184064, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5446613430976868, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.36650076508522034, "model": {}}}}, "timesteps_this_iter": 97792, "done": false, "timesteps_total": 11272192, "episodes_total": 112728, "training_iteration": 116, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-09-38", "timestamp": 1569146978, "time_this_iter_s": 30.565635681152344, "time_total_s": 3545.5091116428375, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365fa3378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3545.5091116428375, "timesteps_since_restore": 11272192, "iterations_since_restore": 116, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.02835785526304, "episode_reward_min": 54.12591358266009, "episode_reward_mean": 56.62089808635318, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 24.68124415292481, "agent_1": 31.939653933428367}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6655326412968895, "mean_processing_ms": 3.550746131580281, "mean_inference_ms": 2.080768144885163}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 336, "num_steps_trained": 16876800, "num_steps_sampled": 11371008, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22207, "num_samples_dropped": 314, "learner_queue": {"size_count": 77046, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.336, "replay_time_ms": 109.308, "update_priorities_time_ms": 56.457, "policy_agent_0": {"added_count": 2789632, "sampled_count": 4221440, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2789632, "sampled_count": 4221440, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5526296496391296, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.320850133895874, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 11371008, "episodes_total": 113712, "training_iteration": 117, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-10-09", "timestamp": 1569147009, "time_this_iter_s": 30.504279375076294, "time_total_s": 3576.013391017914, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365704620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3576.013391017914, "timesteps_since_restore": 11371008, "iterations_since_restore": 117, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.98560921772919, "episode_reward_min": 46.831880853109766, "episode_reward_mean": 54.95941167881897, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 23.61997544850213, "agent_1": 31.339436230316856}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6656502900665621, "mean_processing_ms": 3.5515486177085, "mean_inference_ms": 2.0808481493092295}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 339, "num_steps_trained": 17032704, "num_steps_sampled": 11468032, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22398, "num_samples_dropped": 314, "learner_queue": {"size_count": 77655, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.341, "replay_time_ms": 105.524, "update_priorities_time_ms": 54.711, "policy_agent_0": {"added_count": 2815232, "sampled_count": 4258048, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2815232, "sampled_count": 4258048, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6003606915473938, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3050796389579773, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 11468032, "episodes_total": 114688, "training_iteration": 118, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-10-40", "timestamp": 1569147040, "time_this_iter_s": 30.592109203338623, "time_total_s": 3606.6055002212524, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656b0400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3606.6055002212524, "timesteps_since_restore": 11468032, "iterations_since_restore": 118, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.48989345547143, "episode_reward_min": 45.0669731996187, "episode_reward_mean": 56.34390121098132, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 24.35790178425891, "agent_1": 31.98599942672247}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6652680368452216, "mean_processing_ms": 3.5505447942261457, "mean_inference_ms": 2.0803711569820784}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 342, "num_steps_trained": 17185536, "num_steps_sampled": 11566080, "sample_throughput": 22669.52, "train_throughput": 0.0, "num_weight_syncs": 22589, "num_samples_dropped": 314, "learner_queue": {"size_count": 78252, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.528, "replay_time_ms": 107.754, "update_priorities_time_ms": 53.802, "policy_agent_0": {"added_count": 2838272, "sampled_count": 4297984, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2838272, "sampled_count": 4297984, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6420360803604126, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.307384192943573, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 11566080, "episodes_total": 115664, "training_iteration": 119, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-11-10", "timestamp": 1569147070, "time_this_iter_s": 30.508206367492676, "time_total_s": 3637.113706588745, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656c9598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3637.113706588745, "timesteps_since_restore": 11566080, "iterations_since_restore": 119, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.411783354119066, "episode_reward_min": 44.67031953008343, "episode_reward_mean": 52.49014857630006, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 23.620211824278048, "agent_1": 28.869936752022085}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6653489019567301, "mean_processing_ms": 3.550301809468264, "mean_inference_ms": 2.0803786237799295}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 345, "num_steps_trained": 17336576, "num_steps_sampled": 11664896, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22782, "num_samples_dropped": 314, "learner_queue": {"size_count": 78842, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.478, "replay_time_ms": 97.61, "update_priorities_time_ms": 50.641, "policy_agent_0": {"added_count": 2857984, "sampled_count": 4336384, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2857984, "sampled_count": 4336384, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6882933378219604, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3525034785270691, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 11664896, "episodes_total": 116648, "training_iteration": 120, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-11-41", "timestamp": 1569147101, "time_this_iter_s": 30.487043857574463, "time_total_s": 3667.6007504463196, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656ca510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3667.6007504463196, "timesteps_since_restore": 11664896, "iterations_since_restore": 120, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.731543767838616, "episode_reward_min": 48.881414727656285, "episode_reward_mean": 51.72250742782989, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 25.32188730961212, "agent_1": 26.400620118217798}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6651325421213912, "mean_processing_ms": 3.5491908933883787, "mean_inference_ms": 2.080757990294237}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 348, "num_steps_trained": 17492480, "num_steps_sampled": 11761920, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 22971, "num_samples_dropped": 314, "learner_queue": {"size_count": 79451, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.77, "replay_time_ms": 86.528, "update_priorities_time_ms": 48.065, "policy_agent_0": {"added_count": 2883840, "sampled_count": 4375296, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2883840, "sampled_count": 4375296, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6725590229034424, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3689219057559967, "model": {}}}}, "timesteps_this_iter": 97024, "done": false, "timesteps_total": 11761920, "episodes_total": 117624, "training_iteration": 121, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-12-11", "timestamp": 1569147131, "time_this_iter_s": 30.552485704421997, "time_total_s": 3698.1532361507416, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36562e950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3698.1532361507416, "timesteps_since_restore": 11761920, "iterations_since_restore": 121, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.787154636824894, "episode_reward_min": 42.52034297059099, "episode_reward_mean": 50.31378093064011, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 23.90829586127937, "agent_1": 26.405485069360743}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6653029810687574, "mean_processing_ms": 3.549739771364271, "mean_inference_ms": 2.080987839717534}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 351, "num_steps_trained": 17646592, "num_steps_sampled": 11859200, "sample_throughput": 0.0, "train_throughput": 23963.707, "num_weight_syncs": 23162, "num_samples_dropped": 314, "learner_queue": {"size_count": 80054, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.231, "replay_time_ms": 86.319, "update_priorities_time_ms": 48.261, "policy_agent_0": {"added_count": 2912256, "sampled_count": 4413696, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2912256, "sampled_count": 4413696, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6765279173851013, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4670570194721222, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 11859200, "episodes_total": 118600, "training_iteration": 122, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-12-42", "timestamp": 1569147162, "time_this_iter_s": 30.527013540267944, "time_total_s": 3728.6802496910095, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365692400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3728.6802496910095, "timesteps_since_restore": 11859200, "iterations_since_restore": 122, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.34618982489004, "episode_reward_min": 48.18188691406724, "episode_reward_mean": 54.719790792826466, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.07727630537334, "agent_1": 28.642514487453166}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.664990151891266, "mean_processing_ms": 3.548032808888277, "mean_inference_ms": 2.0807539922796447}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 354, "num_steps_trained": 17798144, "num_steps_sampled": 11958528, "sample_throughput": 0.0, "train_throughput": 19430.021, "num_weight_syncs": 23355, "num_samples_dropped": 314, "learner_queue": {"size_count": 80645, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.463, "replay_time_ms": 115.839, "update_priorities_time_ms": 57.964, "policy_agent_0": {"added_count": 2937344, "sampled_count": 4452864, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2937344, "sampled_count": 4452864, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6337946653366089, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.45118436217308044, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 11958528, "episodes_total": 119584, "training_iteration": 123, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-13-13", "timestamp": 1569147193, "time_this_iter_s": 30.70959186553955, "time_total_s": 3759.389841556549, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365788730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3759.389841556549, "timesteps_since_restore": 11958528, "iterations_since_restore": 123, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.3889172557159, "episode_reward_min": 45.82057144972072, "episode_reward_mean": 58.54862969386195, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.339884835786847, "agent_1": 31.208744858075185}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6653999203729373, "mean_processing_ms": 3.549892016845677, "mean_inference_ms": 2.0806007759137644}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 357, "num_steps_trained": 17948416, "num_steps_sampled": 12059136, "sample_throughput": 0.0, "train_throughput": 27781.879, "num_weight_syncs": 23552, "num_samples_dropped": 314, "learner_queue": {"size_count": 81232, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.716, "replay_time_ms": 90.724, "update_priorities_time_ms": 43.65, "policy_agent_0": {"added_count": 2962176, "sampled_count": 4490496, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2962176, "sampled_count": 4490496, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6040938496589661, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3998531103134155, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 12059136, "episodes_total": 120600, "training_iteration": 124, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-13-43", "timestamp": 1569147223, "time_this_iter_s": 30.56596612930298, "time_total_s": 3789.955807685852, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36575d158>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3789.955807685852, "timesteps_since_restore": 12059136, "iterations_since_restore": 124, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.27714094977577, "episode_reward_min": 44.562189131081176, "episode_reward_mean": 59.622403944061794, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 29.28153405259996, "agent_1": 30.340869891461917}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6650053932610062, "mean_processing_ms": 3.5486598021175824, "mean_inference_ms": 2.0803145537119705}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 360, "num_steps_trained": 18101248, "num_steps_sampled": 12158208, "sample_throughput": 5918.705, "train_throughput": 0.0, "num_weight_syncs": 23746, "num_samples_dropped": 314, "learner_queue": {"size_count": 81831, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 47.709, "replay_time_ms": 103.601, "update_priorities_time_ms": 49.362, "policy_agent_0": {"added_count": 2987264, "sampled_count": 4529664, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 2987264, "sampled_count": 4529664, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5259508490562439, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.34657955169677734, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 12158208, "episodes_total": 121584, "training_iteration": 125, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-14-14", "timestamp": 1569147254, "time_this_iter_s": 30.50556182861328, "time_total_s": 3820.4613695144653, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36560b598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3820.4613695144653, "timesteps_since_restore": 12158208, "iterations_since_restore": 125, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.29811809176033, "episode_reward_min": 44.03032525585254, "episode_reward_mean": 56.58558476236914, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.146014106796677, "agent_1": 29.439570655572513}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6648388056147312, "mean_processing_ms": 3.5476267189908928, "mean_inference_ms": 2.079986044406838}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 363, "num_steps_trained": 18253312, "num_steps_sampled": 12257792, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 23940, "num_samples_dropped": 314, "learner_queue": {"size_count": 82423, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.928, "replay_time_ms": 111.704, "update_priorities_time_ms": 54.725, "policy_agent_0": {"added_count": 3013120, "sampled_count": 4567296, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3013120, "sampled_count": 4567296, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.49277251958847046, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.34600377082824707, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 12257792, "episodes_total": 122584, "training_iteration": 126, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-14-44", "timestamp": 1569147284, "time_this_iter_s": 30.5964298248291, "time_total_s": 3851.0577993392944, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36560fa60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3851.0577993392944, "timesteps_since_restore": 12257792, "iterations_since_restore": 126, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.09022386749816, "episode_reward_min": 54.45740730180757, "episode_reward_mean": 58.089653230356355, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 27.51767102305488, "agent_1": 30.57198220730149}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6652293584788058, "mean_processing_ms": 3.549040581207555, "mean_inference_ms": 2.080276237959864}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 366, "num_steps_trained": 18408448, "num_steps_sampled": 12355072, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24130, "num_samples_dropped": 314, "learner_queue": {"size_count": 83029, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.48, "replay_time_ms": 90.506, "update_priorities_time_ms": 50.575, "policy_agent_0": {"added_count": 3033856, "sampled_count": 4607488, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3033856, "sampled_count": 4607488, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4587825536727905, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3591660261154175, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 12355072, "episodes_total": 123552, "training_iteration": 127, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-15-15", "timestamp": 1569147315, "time_this_iter_s": 30.585265636444092, "time_total_s": 3881.6430649757385, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656076a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3881.6430649757385, "timesteps_since_restore": 12355072, "iterations_since_restore": 127, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.28333179569703, "episode_reward_min": 52.57507641926022, "episode_reward_mean": 57.74047505445819, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.864939711655055, "agent_1": 29.87553534280319}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6650680661331646, "mean_processing_ms": 3.548828943862147, "mean_inference_ms": 2.080123556109717}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 369, "num_steps_trained": 18560256, "num_steps_sampled": 12455936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 24327, "num_samples_dropped": 314, "learner_queue": {"size_count": 83622, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.886, "replay_time_ms": 114.152, "update_priorities_time_ms": 55.486, "policy_agent_0": {"added_count": 3058432, "sampled_count": 4644096, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3058432, "sampled_count": 4644096, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.46125707030296326, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.380974680185318, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 12455936, "episodes_total": 124560, "training_iteration": 128, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-15-46", "timestamp": 1569147346, "time_this_iter_s": 30.572946548461914, "time_total_s": 3912.2160115242004, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365597b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3912.2160115242004, "timesteps_since_restore": 12455936, "iterations_since_restore": 128, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.657991378200094, "episode_reward_min": 51.26941748966315, "episode_reward_mean": 57.16551429400654, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 29.10791888627302, "agent_1": 28.057595407733604}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.664432997288373, "mean_processing_ms": 3.545969003727728, "mean_inference_ms": 2.0788429450678296}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 372, "num_steps_trained": 18707456, "num_steps_sampled": 12558592, "sample_throughput": 0.0, "train_throughput": 21491.17, "num_weight_syncs": 24527, "num_samples_dropped": 314, "learner_queue": {"size_count": 84197, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 22.716, "replay_time_ms": 85.882, "update_priorities_time_ms": 45.217, "policy_agent_0": {"added_count": 3086592, "sampled_count": 4679680, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3086592, "sampled_count": 4679680, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4469231367111206, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3781483769416809, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 12558592, "episodes_total": 125592, "training_iteration": 129, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-16-16", "timestamp": 1569147376, "time_this_iter_s": 30.517058610916138, "time_total_s": 3942.7330701351166, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655a07b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3942.7330701351166, "timesteps_since_restore": 12558592, "iterations_since_restore": 129, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.19522214835839, "episode_reward_min": 47.81754282136083, "episode_reward_mean": 57.5705889030676, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 29.32545993181021, "agent_1": 28.2451289712575}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6641467994881586, "mean_processing_ms": 3.544635618172143, "mean_inference_ms": 2.0788403700476934}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 375, "num_steps_trained": 18862080, "num_steps_sampled": 12656896, "sample_throughput": 0.0, "train_throughput": 36109.155, "num_weight_syncs": 24720, "num_samples_dropped": 314, "learner_queue": {"size_count": 84801, "size_mean": 0.26, "size_std": 0.5589275444992848, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.585, "replay_time_ms": 106.735, "update_priorities_time_ms": 55.763, "policy_agent_0": {"added_count": 3106816, "sampled_count": 4718592, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3106816, "sampled_count": 4718592, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4071972668170929, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.38571205735206604, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 12656896, "episodes_total": 126576, "training_iteration": 130, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-16-47", "timestamp": 1569147407, "time_this_iter_s": 30.649444818496704, "time_total_s": 3973.3825149536133, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655a6c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 3973.3825149536133, "timesteps_since_restore": 12656896, "iterations_since_restore": 130, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.21127686912305, "episode_reward_min": 43.51725795543059, "episode_reward_mean": 55.65750066810084, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 29.039227908224152, "agent_1": 26.618272759876767}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6640355701954082, "mean_processing_ms": 3.544496348882311, "mean_inference_ms": 2.0784031683454263}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 378, "num_steps_trained": 19011328, "num_steps_sampled": 12757504, "sample_throughput": 0.0, "train_throughput": 14941.927, "num_weight_syncs": 24916, "num_samples_dropped": 314, "learner_queue": {"size_count": 85385, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.743, "replay_time_ms": 107.16, "update_priorities_time_ms": 50.187, "policy_agent_0": {"added_count": 3130880, "sampled_count": 4755712, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3130880, "sampled_count": 4755712, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3855777382850647, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4137101471424103, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 12757504, "episodes_total": 127584, "training_iteration": 131, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-17-17", "timestamp": 1569147437, "time_this_iter_s": 30.536431789398193, "time_total_s": 4003.9189467430115, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36560fbf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4003.9189467430115, "timesteps_since_restore": 12757504, "iterations_since_restore": 131, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.500537521188036, "episode_reward_min": 43.929198920715095, "episode_reward_mean": 53.158628323484024, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.178072330016786, "agent_1": 26.98055599346728}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6636276583151651, "mean_processing_ms": 3.5428755344855296, "mean_inference_ms": 2.07775828514452}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 381, "num_steps_trained": 19160832, "num_steps_sampled": 12859648, "sample_throughput": 7847.384, "train_throughput": 0.0, "num_weight_syncs": 25116, "num_samples_dropped": 314, "learner_queue": {"size_count": 85969, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.841, "replay_time_ms": 93.602, "update_priorities_time_ms": 48.932, "policy_agent_0": {"added_count": 3154944, "sampled_count": 4794880, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3154944, "sampled_count": 4794880, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.41893652081489563, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.44802436232566833, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 12859648, "episodes_total": 128600, "training_iteration": 132, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-17-48", "timestamp": 1569147468, "time_this_iter_s": 30.54013705253601, "time_total_s": 4034.4590837955475, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36560b0d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4034.4590837955475, "timesteps_since_restore": 12859648, "iterations_since_restore": 132, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.29559719182455, "episode_reward_min": 42.80077990699439, "episode_reward_mean": 49.734528499872916, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 24.187247263213273, "agent_1": 25.54728123665966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6640084762637037, "mean_processing_ms": 3.5445181369761665, "mean_inference_ms": 2.0774552889836615}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 384, "num_steps_trained": 19312896, "num_steps_sampled": 12958720, "sample_throughput": 0.0, "train_throughput": 40192.47, "num_weight_syncs": 25308, "num_samples_dropped": 314, "learner_queue": {"size_count": 86562, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.238, "replay_time_ms": 112.016, "update_priorities_time_ms": 54.872, "policy_agent_0": {"added_count": 3183104, "sampled_count": 4833280, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3183104, "sampled_count": 4833280, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.46135157346725464, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4939790964126587, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 12958720, "episodes_total": 129592, "training_iteration": 133, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-18-18", "timestamp": 1569147498, "time_this_iter_s": 30.59921956062317, "time_total_s": 4065.0583033561707, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36575d2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4065.0583033561707, "timesteps_since_restore": 12958720, "iterations_since_restore": 133, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.26884032395219, "episode_reward_min": 41.23137759716327, "episode_reward_mean": 53.99528568327432, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.513800934477572, "agent_1": 27.48148474879683}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6638190974798954, "mean_processing_ms": 3.5434435610262307, "mean_inference_ms": 2.076762997700885}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 387, "num_steps_trained": 19464448, "num_steps_sampled": 13059328, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 25505, "num_samples_dropped": 314, "learner_queue": {"size_count": 87154, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 39.971, "replay_time_ms": 84.004, "update_priorities_time_ms": 51.753, "policy_agent_0": {"added_count": 3208448, "sampled_count": 4875776, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3208448, "sampled_count": 4875776, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5596394538879395, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.54518061876297, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 13059328, "episodes_total": 130600, "training_iteration": 134, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-18-49", "timestamp": 1569147529, "time_this_iter_s": 30.569660186767578, "time_total_s": 4095.6279635429382, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656929d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4095.6279635429382, "timesteps_since_restore": 13059328, "iterations_since_restore": 134, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.29927452664272, "episode_reward_min": 56.817887122088784, "episode_reward_mean": 59.90574769100327, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 28.776818333736614, "agent_1": 31.128929357266763}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6636398248090786, "mean_processing_ms": 3.5427264685087545, "mean_inference_ms": 2.0766741366193298}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 390, "num_steps_trained": 19618304, "num_steps_sampled": 13157632, "sample_throughput": 8996.429, "train_throughput": 4498.215, "num_weight_syncs": 25698, "num_samples_dropped": 314, "learner_queue": {"size_count": 87755, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 35.442, "replay_time_ms": 127.186, "update_priorities_time_ms": 60.116, "policy_agent_0": {"added_count": 3234560, "sampled_count": 4915712, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3234560, "sampled_count": 4915712, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.509035587310791, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5332903265953064, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 13157632, "episodes_total": 131576, "training_iteration": 135, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-19-20", "timestamp": 1569147560, "time_this_iter_s": 30.634251356124878, "time_total_s": 4126.262214899063, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365692510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4126.262214899063, "timesteps_since_restore": 13157632, "iterations_since_restore": 135, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.84545170394724, "episode_reward_min": 56.73718614745034, "episode_reward_mean": 59.11856431481216, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 30.159531996531836, "agent_1": 28.959032318280325}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6636790824862083, "mean_processing_ms": 3.543149535438705, "mean_inference_ms": 2.0770185043381395}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 394, "num_steps_trained": 19773440, "num_steps_sampled": 13256960, "sample_throughput": 6440.776, "train_throughput": 6440.776, "num_weight_syncs": 25892, "num_samples_dropped": 314, "learner_queue": {"size_count": 88363, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.367, "replay_time_ms": 72.055, "update_priorities_time_ms": 41.409, "policy_agent_0": {"added_count": 3258624, "sampled_count": 4952832, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3258624, "sampled_count": 4952832, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4248248338699341, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.38433149456977844, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 13256960, "episodes_total": 132576, "training_iteration": 136, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-19-50", "timestamp": 1569147590, "time_this_iter_s": 30.500232696533203, "time_total_s": 4156.762447595596, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36562ec80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4156.762447595596, "timesteps_since_restore": 13256960, "iterations_since_restore": 136, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 59.89285619231896, "episode_reward_min": 54.424353785487426, "episode_reward_mean": 57.4788660494937, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 26.841905724079314, "agent_1": 30.636960325414396}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6631268355237961, "mean_processing_ms": 3.540919691425383, "mean_inference_ms": 2.0766649748363157}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 397, "num_steps_trained": 19927296, "num_steps_sampled": 13355520, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26083, "num_samples_dropped": 314, "learner_queue": {"size_count": 88962, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.172, "replay_time_ms": 76.446, "update_priorities_time_ms": 46.711, "policy_agent_0": {"added_count": 3279872, "sampled_count": 4994560, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3279872, "sampled_count": 4994560, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4094507098197937, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.33076274394989014, "model": {}}}}, "timesteps_this_iter": 98560, "done": false, "timesteps_total": 13355520, "episodes_total": 133560, "training_iteration": 137, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-20-21", "timestamp": 1569147621, "time_this_iter_s": 30.533280849456787, "time_total_s": 4187.295728445053, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656c9730>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4187.295728445053, "timesteps_since_restore": 13355520, "iterations_since_restore": 137, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 59.05270824461404, "episode_reward_min": 46.60374235514803, "episode_reward_mean": 52.61981035874771, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 24.828279279909754, "agent_1": 27.791531078838045}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6627907087735331, "mean_processing_ms": 3.5394385809459465, "mean_inference_ms": 2.0761065712174664}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 400, "num_steps_trained": 20077056, "num_steps_sampled": 13456384, "sample_throughput": 7394.662, "train_throughput": 7394.662, "num_weight_syncs": 26281, "num_samples_dropped": 314, "learner_queue": {"size_count": 89547, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.112, "replay_time_ms": 95.188, "update_priorities_time_ms": 50.124, "policy_agent_0": {"added_count": 3307776, "sampled_count": 5032704, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3307776, "sampled_count": 5032704, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4502195715904236, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3390040695667267, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 13456384, "episodes_total": 134576, "training_iteration": 138, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-20-52", "timestamp": 1569147652, "time_this_iter_s": 30.635579109191895, "time_total_s": 4217.931307554245, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365706d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4217.931307554245, "timesteps_since_restore": 13456384, "iterations_since_restore": 138, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.84463226376613, "episode_reward_min": 48.94233861138674, "episode_reward_mean": 55.25651473864618, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.186273096252442, "agent_1": 30.07024164239388}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6634648973776561, "mean_processing_ms": 3.5421948590347534, "mean_inference_ms": 2.076294491900448}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 403, "num_steps_trained": 20228608, "num_steps_sampled": 13558016, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 26479, "num_samples_dropped": 314, "learner_queue": {"size_count": 90139, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.322, "replay_time_ms": 78.572, "update_priorities_time_ms": 48.807, "policy_agent_0": {"added_count": 3331584, "sampled_count": 5072384, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3331584, "sampled_count": 5072384, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5128103494644165, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.37504279613494873, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 13558016, "episodes_total": 135584, "training_iteration": 139, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-21-22", "timestamp": 1569147682, "time_this_iter_s": 30.48249316215515, "time_total_s": 4248.4138007164, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365704048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4248.4138007164, "timesteps_since_restore": 13558016, "iterations_since_restore": 139, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.12777440417534, "episode_reward_min": 46.176016315426146, "episode_reward_mean": 54.665423273506136, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 24.576046745916052, "agent_1": 30.08937652759018}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.663402224125785, "mean_processing_ms": 3.5412703762854356, "mean_inference_ms": 2.07558892367172}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 406, "num_steps_trained": 20375296, "num_steps_sampled": 13660672, "sample_throughput": 10560.166, "train_throughput": 0.0, "num_weight_syncs": 26681, "num_samples_dropped": 314, "learner_queue": {"size_count": 90713, "size_mean": 0.08, "size_std": 0.33704599092705434, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.402, "replay_time_ms": 103.94, "update_priorities_time_ms": 45.01, "policy_agent_0": {"added_count": 3358208, "sampled_count": 5108736, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3358208, "sampled_count": 5108736, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5657681822776794, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.349043071269989, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 13660672, "episodes_total": 136608, "training_iteration": 140, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-21-53", "timestamp": 1569147713, "time_this_iter_s": 30.544928312301636, "time_total_s": 4278.958729028702, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365fb0510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4278.958729028702, "timesteps_since_restore": 13660672, "iterations_since_restore": 140, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.981696357104916, "episode_reward_min": 43.85457084641103, "episode_reward_mean": 54.29253565383176, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 23.397548446737655, "agent_1": 30.894987207094193}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6632271856061861, "mean_processing_ms": 3.5402709921000786, "mean_inference_ms": 2.074940477813994}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 409, "num_steps_trained": 20524288, "num_steps_sampled": 13764096, "sample_throughput": 0.0, "train_throughput": 14116.666, "num_weight_syncs": 26881, "num_samples_dropped": 314, "learner_queue": {"size_count": 91294, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.534, "replay_time_ms": 80.38, "update_priorities_time_ms": 51.612, "policy_agent_0": {"added_count": 3383808, "sampled_count": 5145088, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3383808, "sampled_count": 5145088, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5861399173736572, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3411865234375, "model": {}}}}, "timesteps_this_iter": 103424, "done": false, "timesteps_total": 13764096, "episodes_total": 137648, "training_iteration": 141, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-22-23", "timestamp": 1569147743, "time_this_iter_s": 30.537566661834717, "time_total_s": 4309.4962956905365, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3657509d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4309.4962956905365, "timesteps_since_restore": 13764096, "iterations_since_restore": 141, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.07109483884607, "episode_reward_min": 42.56143734970369, "episode_reward_mean": 52.715741630590536, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 22.768236823434215, "agent_1": 29.947504807156342}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6630891250115111, "mean_processing_ms": 3.5390496105941702, "mean_inference_ms": 2.0740628907828262}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 412, "num_steps_trained": 20676608, "num_steps_sampled": 13863936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27077, "num_samples_dropped": 314, "learner_queue": {"size_count": 91889, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 42.33, "replay_time_ms": 69.527, "update_priorities_time_ms": 43.052, "policy_agent_0": {"added_count": 3405824, "sampled_count": 5185280, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3405824, "sampled_count": 5185280, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6774747371673584, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.36200568079948425, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 13863936, "episodes_total": 138640, "training_iteration": 142, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-22-54", "timestamp": 1569147774, "time_this_iter_s": 30.387134790420532, "time_total_s": 4339.883430480957, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656d1ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4339.883430480957, "timesteps_since_restore": 13863936, "iterations_since_restore": 142, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.851263525487084, "episode_reward_min": 45.68076680007722, "episode_reward_mean": 56.82581182561961, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.75957598195674, "agent_1": 31.066235843662948}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6637174057280604, "mean_processing_ms": 3.541460442165231, "mean_inference_ms": 2.0739046562262886}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 414, "num_steps_trained": 20824320, "num_steps_sampled": 13965568, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27275, "num_samples_dropped": 314, "learner_queue": {"size_count": 92466, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.125, "replay_time_ms": 102.66, "update_priorities_time_ms": 53.354, "policy_agent_0": {"added_count": 3435520, "sampled_count": 5220608, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3435520, "sampled_count": 5220608, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6925112009048462, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3772513270378113, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 13965568, "episodes_total": 139656, "training_iteration": 143, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-23-24", "timestamp": 1569147804, "time_this_iter_s": 30.54661989212036, "time_total_s": 4370.430050373077, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656e2510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4370.430050373077, "timesteps_since_restore": 13965568, "iterations_since_restore": 143, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.64020093517885, "episode_reward_min": 45.696547114834985, "episode_reward_mean": 56.010925095188774, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.362069319971216, "agent_1": 30.648855775217747}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.66308741175081, "mean_processing_ms": 3.5389899386110404, "mean_inference_ms": 2.073848531675144}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 418, "num_steps_trained": 20978944, "num_steps_sampled": 14065408, "sample_throughput": 0.0, "train_throughput": 16505.647, "num_weight_syncs": 27471, "num_samples_dropped": 314, "learner_queue": {"size_count": 93070, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 27.174, "replay_time_ms": 72.494, "update_priorities_time_ms": 42.97, "policy_agent_0": {"added_count": 3458304, "sampled_count": 5259008, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3458304, "sampled_count": 5259008, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6618077754974365, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3400886356830597, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 14065408, "episodes_total": 140664, "training_iteration": 144, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-23-55", "timestamp": 1569147835, "time_this_iter_s": 30.464006185531616, "time_total_s": 4400.894056558609, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365678ea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4400.894056558609, "timesteps_since_restore": 14065408, "iterations_since_restore": 144, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 59.332536195352, "episode_reward_min": 53.78818161407423, "episode_reward_mean": 56.23013058790148, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.689893743014142, "agent_1": 30.540236844887552}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.662169328488623, "mean_processing_ms": 3.535215066458237, "mean_inference_ms": 2.0731476872305183}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 421, "num_steps_trained": 21127936, "num_steps_sampled": 14166784, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27668, "num_samples_dropped": 314, "learner_queue": {"size_count": 93652, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 30.63, "replay_time_ms": 88.297, "update_priorities_time_ms": 47.052, "policy_agent_0": {"added_count": 3484672, "sampled_count": 5294848, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3484672, "sampled_count": 5294848, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6209022402763367, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.2996363639831543, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 14166784, "episodes_total": 141672, "training_iteration": 145, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-24-25", "timestamp": 1569147865, "time_this_iter_s": 30.59587574005127, "time_total_s": 4431.48993229866, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36568ce18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4431.48993229866, "timesteps_since_restore": 14166784, "iterations_since_restore": 145, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.67116828475372, "episode_reward_min": 52.628916389912824, "episode_reward_mean": 55.47466596557182, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.46243863143462, "agent_1": 29.012227334137254}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6620361457654336, "mean_processing_ms": 3.5346364008340427, "mean_inference_ms": 2.0729900338218603}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 424, "num_steps_trained": 21280512, "num_steps_sampled": 14268160, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 27866, "num_samples_dropped": 314, "learner_queue": {"size_count": 94248, "size_mean": 0.12, "size_std": 0.3815756805667783, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.603, "replay_time_ms": 71.334, "update_priorities_time_ms": 46.699, "policy_agent_0": {"added_count": 3510528, "sampled_count": 5334016, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3510528, "sampled_count": 5334016, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5879191160202026, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.32126232981681824, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 14268160, "episodes_total": 142688, "training_iteration": 146, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-24-56", "timestamp": 1569147896, "time_this_iter_s": 30.561540603637695, "time_total_s": 4462.051472902298, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655d3ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4462.051472902298, "timesteps_since_restore": 14268160, "iterations_since_restore": 146, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 64.01917745792531, "episode_reward_min": 47.06604491539405, "episode_reward_mean": 57.117605155400256, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 28.285314554702882, "agent_1": 28.832290600697473}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6619741064774226, "mean_processing_ms": 3.533802089154601, "mean_inference_ms": 2.072212911677575}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 427, "num_steps_trained": 21429760, "num_steps_sampled": 14370304, "sample_throughput": 0.0, "train_throughput": 18339.827, "num_weight_syncs": 28066, "num_samples_dropped": 314, "learner_queue": {"size_count": 94832, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.115, "replay_time_ms": 95.039, "update_priorities_time_ms": 60.455, "policy_agent_0": {"added_count": 3536384, "sampled_count": 5373696, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3536384, "sampled_count": 5373696, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5355863571166992, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3282812237739563, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 14370304, "episodes_total": 143704, "training_iteration": 147, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-25-27", "timestamp": 1569147927, "time_this_iter_s": 30.621543884277344, "time_total_s": 4492.673016786575, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36569a378>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4492.673016786575, "timesteps_since_restore": 14370304, "iterations_since_restore": 147, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.88594193345706, "episode_reward_min": 49.86422871337068, "episode_reward_mean": 53.93611260714998, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.311906959019687, "agent_1": 26.624205648130324}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6624503186012143, "mean_processing_ms": 3.5351758185017563, "mean_inference_ms": 2.071522606715319}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 430, "num_steps_trained": 21581824, "num_steps_sampled": 14471168, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 28263, "num_samples_dropped": 314, "learner_queue": {"size_count": 95425, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.44, "replay_time_ms": 107.162, "update_priorities_time_ms": 52.746, "policy_agent_0": {"added_count": 3564032, "sampled_count": 5411072, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3564032, "sampled_count": 5411072, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5165844559669495, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.35832884907722473, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 14471168, "episodes_total": 144712, "training_iteration": 148, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-25-57", "timestamp": 1569147957, "time_this_iter_s": 30.64084529876709, "time_total_s": 4523.313862085342, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655e71e0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4523.313862085342, "timesteps_since_restore": 14471168, "iterations_since_restore": 148, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.54066946007872, "episode_reward_min": 45.29053494129523, "episode_reward_mean": 51.559790351556124, "episode_len_mean": 100.0, "episodes_this_iter": 1032, "policy_reward_mean": {"agent_0": 25.699951461162758, "agent_1": 25.859838890393355}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6624723020214659, "mean_processing_ms": 3.534839908406064, "mean_inference_ms": 2.071189168323539}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 433, "num_steps_trained": 21731840, "num_steps_sampled": 14573824, "sample_throughput": 6910.225, "train_throughput": 6910.225, "num_weight_syncs": 28464, "num_samples_dropped": 314, "learner_queue": {"size_count": 96012, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 40.151, "replay_time_ms": 115.758, "update_priorities_time_ms": 52.086, "policy_agent_0": {"added_count": 3588096, "sampled_count": 5449472, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3588096, "sampled_count": 5449472, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5112980008125305, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3842604458332062, "model": {}}}}, "timesteps_this_iter": 102656, "done": false, "timesteps_total": 14573824, "episodes_total": 145744, "training_iteration": 149, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-26-28", "timestamp": 1569147988, "time_this_iter_s": 30.654964447021484, "time_total_s": 4553.968826532364, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655e4840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4553.968826532364, "timesteps_since_restore": 14573824, "iterations_since_restore": 149, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 64.67830161996122, "episode_reward_min": 46.88129744536966, "episode_reward_mean": 53.134285446943586, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.432814800134675, "agent_1": 26.70147064680895}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6628119269240755, "mean_processing_ms": 3.5362588828694084, "mean_inference_ms": 2.071031450090646}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 436, "num_steps_trained": 21883648, "num_steps_sampled": 14674688, "sample_throughput": 0.0, "train_throughput": 30383.187, "num_weight_syncs": 28661, "num_samples_dropped": 314, "learner_queue": {"size_count": 96605, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.285, "replay_time_ms": 95.629, "update_priorities_time_ms": 47.801, "policy_agent_0": {"added_count": 3617024, "sampled_count": 5489408, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3617024, "sampled_count": 5489408, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5264487862586975, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.44492894411087036, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 14674688, "episodes_total": 146752, "training_iteration": 150, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-26-58", "timestamp": 1569148018, "time_this_iter_s": 30.498446226119995, "time_total_s": 4584.467272758484, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655f6950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4584.467272758484, "timesteps_since_restore": 14674688, "iterations_since_restore": 150, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 63.168513061938675, "episode_reward_min": 45.84173621046567, "episode_reward_mean": 50.945780861015514, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 23.410468264556883, "agent_1": 27.535312596458706}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6624730437525004, "mean_processing_ms": 3.5351195429552136, "mean_inference_ms": 2.070407387714012}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 439, "num_steps_trained": 22033920, "num_steps_sampled": 14776064, "sample_throughput": 0.0, "train_throughput": 14417.093, "num_weight_syncs": 28858, "num_samples_dropped": 314, "learner_queue": {"size_count": 97191, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.734, "replay_time_ms": 89.224, "update_priorities_time_ms": 42.713, "policy_agent_0": {"added_count": 3643136, "sampled_count": 5527552, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3643136, "sampled_count": 5527552, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.558792769908905, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4511786699295044, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 14776064, "episodes_total": 147760, "training_iteration": 151, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-27-29", "timestamp": 1569148049, "time_this_iter_s": 30.588635444641113, "time_total_s": 4615.055908203125, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655b2840>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4615.055908203125, "timesteps_since_restore": 14776064, "iterations_since_restore": 151, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 63.80688097409714, "episode_reward_min": 42.52034297059098, "episode_reward_mean": 53.17980064137217, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 25.141592371334674, "agent_1": 28.038208270037575}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6626594245448996, "mean_processing_ms": 3.535490621431048, "mean_inference_ms": 2.0696032346140716}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 442, "num_steps_trained": 22184960, "num_steps_sampled": 14877952, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29057, "num_samples_dropped": 314, "learner_queue": {"size_count": 97782, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.421, "replay_time_ms": 93.941, "update_priorities_time_ms": 45.522, "policy_agent_0": {"added_count": 3673600, "sampled_count": 5564672, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3673600, "sampled_count": 5564672, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5644781589508057, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4912768602371216, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 14877952, "episodes_total": 148784, "training_iteration": 152, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-28-00", "timestamp": 1569148080, "time_this_iter_s": 30.574524879455566, "time_total_s": 4645.630433082581, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655c2d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4645.630433082581, "timesteps_since_restore": 14877952, "iterations_since_restore": 152, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 60.65547347949022, "episode_reward_min": 46.73501696473049, "episode_reward_mean": 59.263508829306254, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.491854096586778, "agent_1": 32.77165473271949}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6619419478926899, "mean_processing_ms": 3.53278479394267, "mean_inference_ms": 2.0690403085692046}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 445, "num_steps_trained": 22336512, "num_steps_sampled": 14979072, "sample_throughput": 7546.894, "train_throughput": 3773.447, "num_weight_syncs": 29255, "num_samples_dropped": 314, "learner_queue": {"size_count": 98373, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 37.229, "replay_time_ms": 82.445, "update_priorities_time_ms": 42.166, "policy_agent_0": {"added_count": 3696384, "sampled_count": 5604352, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3696384, "sampled_count": 5604352, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5730335712432861, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4301604926586151, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 14979072, "episodes_total": 149792, "training_iteration": 153, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-28-30", "timestamp": 1569148110, "time_this_iter_s": 30.526488780975342, "time_total_s": 4676.156921863556, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655cb950>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4676.156921863556, "timesteps_since_restore": 14979072, "iterations_since_restore": 153, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 64.37621332725374, "episode_reward_min": 45.64857318789255, "episode_reward_mean": 60.412495944817174, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.632326664691714, "agent_1": 31.78016928012536}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6623383945932867, "mean_processing_ms": 3.5337122932837937, "mean_inference_ms": 2.0688197054246364}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 448, "num_steps_trained": 22489344, "num_steps_sampled": 15078400, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29448, "num_samples_dropped": 314, "learner_queue": {"size_count": 98970, "size_mean": 0.24, "size_std": 0.4270831300812525, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.766, "replay_time_ms": 110.995, "update_priorities_time_ms": 53.653, "policy_agent_0": {"added_count": 3717888, "sampled_count": 5644800, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3717888, "sampled_count": 5644800, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5167211294174194, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.37464749813079834, "model": {}}}}, "timesteps_this_iter": 99328, "done": false, "timesteps_total": 15078400, "episodes_total": 150792, "training_iteration": 154, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-29-01", "timestamp": 1569148141, "time_this_iter_s": 30.514386415481567, "time_total_s": 4706.6713082790375, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655c7e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4706.6713082790375, "timesteps_since_restore": 15078400, "iterations_since_restore": 154, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.53829436333281, "episode_reward_min": 46.04520680307771, "episode_reward_mean": 57.35519698307295, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 27.40377861232795, "agent_1": 29.95141837074495}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6621680926027215, "mean_processing_ms": 3.53278136142599, "mean_inference_ms": 2.0684659154035128}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 451, "num_steps_trained": 22636544, "num_steps_sampled": 15182080, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29652, "num_samples_dropped": 314, "learner_queue": {"size_count": 99545, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 45.085, "replay_time_ms": 119.907, "update_priorities_time_ms": 59.906, "policy_agent_0": {"added_count": 3743488, "sampled_count": 5681664, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3743488, "sampled_count": 5681664, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.47201451659202576, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.321675568819046, "model": {}}}}, "timesteps_this_iter": 103680, "done": false, "timesteps_total": 15182080, "episodes_total": 151832, "training_iteration": 155, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-29-31", "timestamp": 1569148171, "time_this_iter_s": 30.516352891921997, "time_total_s": 4737.1876611709595, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655a6c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4737.1876611709595, "timesteps_since_restore": 15182080, "iterations_since_restore": 155, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 63.70817991115557, "episode_reward_min": 44.70760628860823, "episode_reward_mean": 55.91546209634819, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.599660871810737, "agent_1": 28.315801224537477}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6617998735011389, "mean_processing_ms": 3.5309077857665057, "mean_inference_ms": 2.068411698911501}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 454, "num_steps_trained": 22789376, "num_steps_sampled": 15281920, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 29847, "num_samples_dropped": 314, "learner_queue": {"size_count": 100142, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 39.491, "replay_time_ms": 92.857, "update_priorities_time_ms": 52.736, "policy_agent_0": {"added_count": 3767040, "sampled_count": 5720832, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3767040, "sampled_count": 5720832, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.46239498257637024, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3636057674884796, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 15281920, "episodes_total": 152824, "training_iteration": 156, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-30-02", "timestamp": 1569148202, "time_this_iter_s": 30.591493129730225, "time_total_s": 4767.77915430069, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655e4268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4767.77915430069, "timesteps_since_restore": 15281920, "iterations_since_restore": 156, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 63.13716302956087, "episode_reward_min": 48.28138531949795, "episode_reward_mean": 56.38199849214662, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 28.153500195649652, "agent_1": 28.228498296497005}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6622110345886107, "mean_processing_ms": 3.5325486042134275, "mean_inference_ms": 2.0680642425944793}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 457, "num_steps_trained": 22938112, "num_steps_sampled": 15384064, "sample_throughput": 6341.831, "train_throughput": 12683.663, "num_weight_syncs": 30046, "num_samples_dropped": 314, "learner_queue": {"size_count": 100723, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.473, "replay_time_ms": 100.121, "update_priorities_time_ms": 51.95, "policy_agent_0": {"added_count": 3790336, "sampled_count": 5758720, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3790336, "sampled_count": 5758720, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.43601930141448975, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.40450918674468994, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 15384064, "episodes_total": 153848, "training_iteration": 157, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-30-32", "timestamp": 1569148232, "time_this_iter_s": 30.48168420791626, "time_total_s": 4798.260838508606, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655e7d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4798.260838508606, "timesteps_since_restore": 15384064, "iterations_since_restore": 157, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 59.72942656081465, "episode_reward_min": 54.080589954889064, "episode_reward_mean": 55.7840941994492, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 28.192078118881064, "agent_1": 27.592016080568136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.662094076646065, "mean_processing_ms": 3.531496847127649, "mean_inference_ms": 2.067527182562055}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 460, "num_steps_trained": 23090176, "num_steps_sampled": 15483904, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30241, "num_samples_dropped": 314, "learner_queue": {"size_count": 101317, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.509, "replay_time_ms": 92.446, "update_priorities_time_ms": 46.824, "policy_agent_0": {"added_count": 3815936, "sampled_count": 5797888, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3815936, "sampled_count": 5797888, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4286021590232849, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.39131149649620056, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 15483904, "episodes_total": 154848, "training_iteration": 158, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-31-03", "timestamp": 1569148263, "time_this_iter_s": 30.613245725631714, "time_total_s": 4828.874084234238, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36569a268>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4828.874084234238, "timesteps_since_restore": 15483904, "iterations_since_restore": 158, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.980370968454345, "episode_reward_min": 53.552508527373256, "episode_reward_mean": 55.866792670602436, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.92441192679026, "agent_1": 27.942380743812173}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6614943237473218, "mean_processing_ms": 3.5289015898225, "mean_inference_ms": 2.0672537167998954}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 463, "num_steps_trained": 23243008, "num_steps_sampled": 15584000, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 30437, "num_samples_dropped": 314, "learner_queue": {"size_count": 101914, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.925, "replay_time_ms": 84.37, "update_priorities_time_ms": 44.647, "policy_agent_0": {"added_count": 3840000, "sampled_count": 5834496, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3840000, "sampled_count": 5834496, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4024859666824341, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.424936443567276, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 15584000, "episodes_total": 155848, "training_iteration": 159, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-31-33", "timestamp": 1569148293, "time_this_iter_s": 30.4159734249115, "time_total_s": 4859.290057659149, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365619598>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4859.290057659149, "timesteps_since_restore": 15584000, "iterations_since_restore": 159, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.748818890861294, "episode_reward_min": 54.64642580592637, "episode_reward_mean": 56.004387302265265, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 27.76880448281409, "agent_1": 28.235582819451245}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.661408244864084, "mean_processing_ms": 3.5288767558737915, "mean_inference_ms": 2.0666792813407078}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 466, "num_steps_trained": 23392256, "num_steps_sampled": 15686400, "sample_throughput": 6950.055, "train_throughput": 6950.055, "num_weight_syncs": 30636, "num_samples_dropped": 314, "learner_queue": {"size_count": 102498, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.13, "replay_time_ms": 87.253, "update_priorities_time_ms": 48.477, "policy_agent_0": {"added_count": 3864064, "sampled_count": 5874432, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3864064, "sampled_count": 5874432, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3829704225063324, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4036461114883423, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 15686400, "episodes_total": 156864, "training_iteration": 160, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-32-04", "timestamp": 1569148324, "time_this_iter_s": 30.52799654006958, "time_total_s": 4889.818054199219, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365678048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4889.818054199219, "timesteps_since_restore": 15686400, "iterations_since_restore": 160, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 59.45752266397061, "episode_reward_min": 49.39949893494536, "episode_reward_mean": 55.2951077865575, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 28.053424309192977, "agent_1": 27.241683477364543}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6617329489674867, "mean_processing_ms": 3.5301652163610138, "mean_inference_ms": 2.0664397320519594}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 469, "num_steps_trained": 23543808, "num_steps_sampled": 15786496, "sample_throughput": 6622.967, "train_throughput": 0.0, "num_weight_syncs": 30832, "num_samples_dropped": 314, "learner_queue": {"size_count": 103091, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.104, "replay_time_ms": 111.123, "update_priorities_time_ms": 52.261, "policy_agent_0": {"added_count": 3889152, "sampled_count": 5911552, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3889152, "sampled_count": 5911552, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3825363516807556, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.40722036361694336, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 15786496, "episodes_total": 157872, "training_iteration": 161, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-32-35", "timestamp": 1569148355, "time_this_iter_s": 30.646214485168457, "time_total_s": 4920.464268684387, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36567bea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4920.464268684387, "timesteps_since_restore": 15786496, "iterations_since_restore": 161, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.29781967909502, "episode_reward_min": 46.035474509895835, "episode_reward_mean": 53.356058191177524, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 28.100008852296373, "agent_1": 25.25604933888122}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6616790774794543, "mean_processing_ms": 3.5294140592346674, "mean_inference_ms": 2.0660643872390105}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 472, "num_steps_trained": 23698432, "num_steps_sampled": 15886080, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31027, "num_samples_dropped": 314, "learner_queue": {"size_count": 103693, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.07, "replay_time_ms": 109.023, "update_priorities_time_ms": 52.144, "policy_agent_0": {"added_count": 3912192, "sampled_count": 5952768, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3912192, "sampled_count": 5952768, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.3941231071949005, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4418838620185852, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 15886080, "episodes_total": 158864, "training_iteration": 162, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-33-05", "timestamp": 1569148385, "time_this_iter_s": 30.580052852630615, "time_total_s": 4951.044321537018, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656e27b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4951.044321537018, "timesteps_since_restore": 15886080, "iterations_since_restore": 162, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.180595653275105, "episode_reward_min": 50.65969789766642, "episode_reward_mean": 54.09135425264175, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 27.869995495065446, "agent_1": 26.221358757576333}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6615919162770786, "mean_processing_ms": 3.529791688389695, "mean_inference_ms": 2.0664673781045995}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 475, "num_steps_trained": 23855104, "num_steps_sampled": 15984384, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31219, "num_samples_dropped": 314, "learner_queue": {"size_count": 104305, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.59, "replay_time_ms": 85.508, "update_priorities_time_ms": 42.108, "policy_agent_0": {"added_count": 3939328, "sampled_count": 5991424, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3939328, "sampled_count": 5991424, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.39259636402130127, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4890254735946655, "model": {}}}}, "timesteps_this_iter": 98304, "done": false, "timesteps_total": 15984384, "episodes_total": 159856, "training_iteration": 163, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-33-36", "timestamp": 1569148416, "time_this_iter_s": 30.545762538909912, "time_total_s": 4981.590084075928, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656d1620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 4981.590084075928, "timesteps_since_restore": 15984384, "iterations_since_restore": 163, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.12787843485265, "episode_reward_min": 46.56601058495131, "episode_reward_mean": 53.234683824830164, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 27.20177167874817, "agent_1": 26.03291214608203}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6612019996904083, "mean_processing_ms": 3.52845355532329, "mean_inference_ms": 2.065977484733346}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 478, "num_steps_trained": 24005120, "num_steps_sampled": 16086784, "sample_throughput": 9279.153, "train_throughput": 4639.576, "num_weight_syncs": 31419, "num_samples_dropped": 314, "learner_queue": {"size_count": 104891, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.139, "replay_time_ms": 109.227, "update_priorities_time_ms": 59.497, "policy_agent_0": {"added_count": 3968256, "sampled_count": 6028800, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3968256, "sampled_count": 6028800, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4082947373390198, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5024702548980713, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 16086784, "episodes_total": 160864, "training_iteration": 164, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-34-07", "timestamp": 1569148447, "time_this_iter_s": 30.66474485397339, "time_total_s": 5012.254828929901, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365750d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5012.254828929901, "timesteps_since_restore": 16086784, "iterations_since_restore": 164, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.16127334354899, "episode_reward_min": 49.07976392893342, "episode_reward_mean": 53.805611136722575, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 27.026632437411966, "agent_1": 26.778978699310645}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6612345929133926, "mean_processing_ms": 3.5286922070309314, "mean_inference_ms": 2.0661222561986556}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 481, "num_steps_trained": 24158976, "num_steps_sampled": 16185856, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 31612, "num_samples_dropped": 314, "learner_queue": {"size_count": 105493, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.327, "replay_time_ms": 97.513, "update_priorities_time_ms": 53.342, "policy_agent_0": {"added_count": 3988480, "sampled_count": 6067968, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 3988480, "sampled_count": 6067968, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.42327994108200073, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4940590262413025, "model": {}}}}, "timesteps_this_iter": 99072, "done": false, "timesteps_total": 16185856, "episodes_total": 161864, "training_iteration": 165, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-34-37", "timestamp": 1569148477, "time_this_iter_s": 30.544060230255127, "time_total_s": 5042.798889160156, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3657040d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5042.798889160156, "timesteps_since_restore": 16185856, "iterations_since_restore": 165, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.2418624427656, "episode_reward_min": 44.87190004975397, "episode_reward_mean": 52.69708111713767, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 25.94637875855131, "agent_1": 26.750702358586437}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6613367910112496, "mean_processing_ms": 3.528938647652053, "mean_inference_ms": 2.065411745652793}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 484, "num_steps_trained": 24308224, "num_steps_sampled": 16287744, "sample_throughput": 6925.669, "train_throughput": 6925.669, "num_weight_syncs": 31812, "num_samples_dropped": 314, "learner_queue": {"size_count": 106075, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.031, "replay_time_ms": 81.072, "update_priorities_time_ms": 41.966, "policy_agent_0": {"added_count": 4018176, "sampled_count": 6105088, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4018176, "sampled_count": 6105088, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.44608715176582336, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.48387834429740906, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 16287744, "episodes_total": 162888, "training_iteration": 166, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-35-08", "timestamp": 1569148508, "time_this_iter_s": 30.577816486358643, "time_total_s": 5073.376705646515, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656b02f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5073.376705646515, "timesteps_since_restore": 16287744, "iterations_since_restore": 166, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.003950004248836, "episode_reward_min": 53.620846728133095, "episode_reward_mean": 55.05967544556774, "episode_len_mean": 100.0, "episodes_this_iter": 976, "policy_reward_mean": {"agent_0": 25.774708468621103, "agent_1": 29.284966976946755}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6604611269437024, "mean_processing_ms": 3.5256857263275303, "mean_inference_ms": 2.065649615038447}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 487, "num_steps_trained": 24464128, "num_steps_sampled": 16386560, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32004, "num_samples_dropped": 314, "learner_queue": {"size_count": 106684, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 33.273, "replay_time_ms": 107.971, "update_priorities_time_ms": 53.152, "policy_agent_0": {"added_count": 4045312, "sampled_count": 6143488, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4045312, "sampled_count": 6143488, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.470867395401001, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.45799413323402405, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 16386560, "episodes_total": 163864, "training_iteration": 167, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-35-38", "timestamp": 1569148538, "time_this_iter_s": 30.544139623641968, "time_total_s": 5103.920845270157, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656b0400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5103.920845270157, "timesteps_since_restore": 16386560, "iterations_since_restore": 167, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.83904268882741, "episode_reward_min": 51.85093024274238, "episode_reward_mean": 53.91182225393102, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 25.89792079424239, "agent_1": 28.013901459688714}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6608143157122933, "mean_processing_ms": 3.5268936895188197, "mean_inference_ms": 2.0651834137071097}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 490, "num_steps_trained": 24614144, "num_steps_sampled": 16488960, "sample_throughput": 5941.269, "train_throughput": 11882.538, "num_weight_syncs": 32204, "num_samples_dropped": 314, "learner_queue": {"size_count": 107270, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.318, "replay_time_ms": 86.212, "update_priorities_time_ms": 43.046, "policy_agent_0": {"added_count": 4071680, "sampled_count": 6178304, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4071680, "sampled_count": 6178304, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4894401729106903, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4408131241798401, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 16488960, "episodes_total": 164904, "training_iteration": 168, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-36-09", "timestamp": 1569148569, "time_this_iter_s": 30.507764101028442, "time_total_s": 5134.428609371185, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36562ee18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5134.428609371185, "timesteps_since_restore": 16488960, "iterations_since_restore": 168, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.117837850085, "episode_reward_min": 47.77105919113888, "episode_reward_mean": 53.67310768781842, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 25.361237206572884, "agent_1": 28.311870481245577}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6614030208417637, "mean_processing_ms": 3.5290660642825467, "mean_inference_ms": 2.0651666145482475}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 493, "num_steps_trained": 24766720, "num_steps_sampled": 16589824, "sample_throughput": 11865.731, "train_throughput": 0.0, "num_weight_syncs": 32401, "num_samples_dropped": 314, "learner_queue": {"size_count": 107867, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.419, "replay_time_ms": 96.621, "update_priorities_time_ms": 44.219, "policy_agent_0": {"added_count": 4097280, "sampled_count": 6215424, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4097280, "sampled_count": 6215424, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.474819540977478, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4248497188091278, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 16589824, "episodes_total": 165904, "training_iteration": 169, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-36-39", "timestamp": 1569148599, "time_this_iter_s": 30.460278034210205, "time_total_s": 5164.8888874053955, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365692510>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5164.8888874053955, "timesteps_since_restore": 16589824, "iterations_since_restore": 169, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 55.26946040958171, "episode_reward_min": 44.22332289626069, "episode_reward_mean": 50.1111419107028, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 24.58079833381244, "agent_1": 25.53034357689038}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6610040912544133, "mean_processing_ms": 3.5273004735411284, "mean_inference_ms": 2.0650579897501524}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 496, "num_steps_trained": 24920320, "num_steps_sampled": 16688640, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32593, "num_samples_dropped": 314, "learner_queue": {"size_count": 108466, "size_mean": 0.24, "size_std": 0.4270831300812525, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 28.606, "replay_time_ms": 105.933, "update_priorities_time_ms": 49.0, "policy_agent_0": {"added_count": 4124672, "sampled_count": 6252800, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4124672, "sampled_count": 6252800, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.49181175231933594, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.470072478055954, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 16688640, "episodes_total": 166896, "training_iteration": 170, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-37-10", "timestamp": 1569148630, "time_this_iter_s": 30.6700496673584, "time_total_s": 5195.558937072754, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3657888c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5195.558937072754, "timesteps_since_restore": 16688640, "iterations_since_restore": 170, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 56.64226455642043, "episode_reward_min": 45.53598486942121, "episode_reward_mean": 50.35008589615262, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 24.793866108123925, "agent_1": 25.556219788028727}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6609611247777621, "mean_processing_ms": 3.527352915470835, "mean_inference_ms": 2.0647585756117124}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 499, "num_steps_trained": 25074432, "num_steps_sampled": 16789248, "sample_throughput": 5862.892, "train_throughput": 5862.892, "num_weight_syncs": 32791, "num_samples_dropped": 314, "learner_queue": {"size_count": 109069, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.467, "replay_time_ms": 105.589, "update_priorities_time_ms": 50.87, "policy_agent_0": {"added_count": 4152064, "sampled_count": 6291968, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4152064, "sampled_count": 6291968, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5450975298881531, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5107539296150208, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 16789248, "episodes_total": 167896, "training_iteration": 171, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-37-41", "timestamp": 1569148661, "time_this_iter_s": 30.528255701065063, "time_total_s": 5226.087192773819, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36575d2f0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5226.087192773819, "timesteps_since_restore": 16789248, "iterations_since_restore": 171, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 62.73723375229903, "episode_reward_min": 44.22332289626069, "episode_reward_mean": 50.86460769594527, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 26.684075307106717, "agent_1": 24.180532388838593}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6606969904732188, "mean_processing_ms": 3.526389005472327, "mean_inference_ms": 2.064579396151088}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 502, "num_steps_trained": 25227776, "num_steps_sampled": 16890112, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 32987, "num_samples_dropped": 314, "learner_queue": {"size_count": 109667, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 44.018, "replay_time_ms": 92.616, "update_priorities_time_ms": 58.763, "policy_agent_0": {"added_count": 4175872, "sampled_count": 6330112, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4175872, "sampled_count": 6330112, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.573920726776123, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6147376298904419, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 16890112, "episodes_total": 168904, "training_iteration": 172, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-38-11", "timestamp": 1569148691, "time_this_iter_s": 30.515231609344482, "time_total_s": 5256.602424383163, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36560bea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5256.602424383163, "timesteps_since_restore": 16890112, "iterations_since_restore": 172, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 61.64589785667661, "episode_reward_min": 43.73909857417023, "episode_reward_mean": 49.484016400356666, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 28.549896718279005, "agent_1": 20.934119682077704}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6604209264017565, "mean_processing_ms": 3.525114492847827, "mean_inference_ms": 2.0641550238047075}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 505, "num_steps_trained": 25375232, "num_steps_sampled": 16993280, "sample_throughput": 0.0, "train_throughput": 15578.635, "num_weight_syncs": 33189, "num_samples_dropped": 314, "learner_queue": {"size_count": 110243, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.593, "replay_time_ms": 102.194, "update_priorities_time_ms": 52.675, "policy_agent_0": {"added_count": 4204032, "sampled_count": 6368512, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4204032, "sampled_count": 6368512, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.542162299156189, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6916255950927734, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 16993280, "episodes_total": 169944, "training_iteration": 173, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-38-42", "timestamp": 1569148722, "time_this_iter_s": 30.508968353271484, "time_total_s": 5287.111392736435, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36560f400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5287.111392736435, "timesteps_since_restore": 16993280, "iterations_since_restore": 173, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 57.22854241511485, "episode_reward_min": 46.235627055474104, "episode_reward_mean": 51.61493571858065, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 30.418890887673257, "agent_1": 21.196044830907443}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6607907420113663, "mean_processing_ms": 3.526455321239503, "mean_inference_ms": 2.064281032549263}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 508, "num_steps_trained": 25529344, "num_steps_sampled": 17093632, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33385, "num_samples_dropped": 314, "learner_queue": {"size_count": 110846, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.205, "replay_time_ms": 108.966, "update_priorities_time_ms": 46.945, "policy_agent_0": {"added_count": 4228352, "sampled_count": 6407424, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4228352, "sampled_count": 6407424, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.45721155405044556, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7487543821334839, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 17093632, "episodes_total": 170944, "training_iteration": 174, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-39-12", "timestamp": 1569148752, "time_this_iter_s": 30.49791955947876, "time_total_s": 5317.609312295914, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365597a60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5317.609312295914, "timesteps_since_restore": 17093632, "iterations_since_restore": 174, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.41274969150643, "episode_reward_min": 44.97876569702179, "episode_reward_mean": 48.586308980215236, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 26.84986723360648, "agent_1": 21.736441746608776}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6606470494064179, "mean_processing_ms": 3.5255233298355435, "mean_inference_ms": 2.0637359961263844}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 511, "num_steps_trained": 25679616, "num_steps_sampled": 17194496, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33581, "num_samples_dropped": 314, "learner_queue": {"size_count": 111433, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 32.982, "replay_time_ms": 101.662, "update_priorities_time_ms": 53.432, "policy_agent_0": {"added_count": 4252672, "sampled_count": 6443264, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4252672, "sampled_count": 6443264, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.44006437063217163, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7883626818656921, "model": {}}}}, "timesteps_this_iter": 100864, "done": false, "timesteps_total": 17194496, "episodes_total": 171960, "training_iteration": 175, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-39-43", "timestamp": 1569148783, "time_this_iter_s": 30.699366092681885, "time_total_s": 5348.308678388596, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655599d8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5348.308678388596, "timesteps_since_restore": 17194496, "iterations_since_restore": 175, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 58.390874484487306, "episode_reward_min": 49.392552439443335, "episode_reward_mean": 53.14594825670496, "episode_len_mean": 100.0, "episodes_this_iter": 992, "policy_reward_mean": {"agent_0": 29.6100384729563, "agent_1": 23.535909783748664}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6610430444050376, "mean_processing_ms": 3.5267843758211384, "mean_inference_ms": 2.063817815390255}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 514, "num_steps_trained": 25835008, "num_steps_sampled": 17294848, "sample_throughput": 5368.333, "train_throughput": 5368.333, "num_weight_syncs": 33779, "num_samples_dropped": 314, "learner_queue": {"size_count": 112040, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.523, "replay_time_ms": 100.776, "update_priorities_time_ms": 49.57, "policy_agent_0": {"added_count": 4277248, "sampled_count": 6481408, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4277248, "sampled_count": 6481408, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4213317334651947, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8018355369567871, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 17294848, "episodes_total": 172952, "training_iteration": 176, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-40-14", "timestamp": 1569148814, "time_this_iter_s": 30.527408123016357, "time_total_s": 5378.836086511612, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36555bea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5378.836086511612, "timesteps_since_restore": 17294848, "iterations_since_restore": 176, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 59.641288093485215, "episode_reward_min": 51.42638048039242, "episode_reward_mean": 53.58884797487229, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 29.79076905486863, "agent_1": 23.798078920003647}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6606376664620536, "mean_processing_ms": 3.525333337694197, "mean_inference_ms": 2.0632390790996813}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 517, "num_steps_trained": 25987584, "num_steps_sampled": 17395968, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 33975, "num_samples_dropped": 314, "learner_queue": {"size_count": 112636, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.091, "replay_time_ms": 107.298, "update_priorities_time_ms": 58.033, "policy_agent_0": {"added_count": 4305152, "sampled_count": 6519040, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4305152, "sampled_count": 6519040, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4110364317893982, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7970506548881531, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 17395968, "episodes_total": 173968, "training_iteration": 177, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-40-44", "timestamp": 1569148844, "time_this_iter_s": 30.55062985420227, "time_total_s": 5409.386716365814, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365568ae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5409.386716365814, "timesteps_since_restore": 17395968, "iterations_since_restore": 177, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 54.087138663729185, "episode_reward_min": 41.06769176698751, "episode_reward_mean": 49.592714064369105, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.20142733880171, "agent_1": 24.391286725567447}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.660759678816274, "mean_processing_ms": 3.5251467212574594, "mean_inference_ms": 2.062963314341413}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 520, "num_steps_trained": 26138880, "num_steps_sampled": 17497856, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 34175, "num_samples_dropped": 314, "learner_queue": {"size_count": 113226, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 31.182, "replay_time_ms": 82.222, "update_priorities_time_ms": 43.468, "policy_agent_0": {"added_count": 4330496, "sampled_count": 6558208, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4330496, "sampled_count": 6558208, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.4085710942745209, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7872602939605713, "model": {}}}}, "timesteps_this_iter": 101888, "done": false, "timesteps_total": 17497856, "episodes_total": 174984, "training_iteration": 178, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-41-15", "timestamp": 1569148875, "time_this_iter_s": 30.523911952972412, "time_total_s": 5439.910628318787, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365579048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5439.910628318787, "timesteps_since_restore": 17497856, "iterations_since_restore": 178, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 53.978430122005925, "episode_reward_min": 46.983745722968415, "episode_reward_mean": 50.01146269111824, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 23.801967140971854, "agent_1": 26.209495550146396}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6604017325023261, "mean_processing_ms": 3.523661482716514, "mean_inference_ms": 2.062704565541093}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 523, "num_steps_trained": 26292480, "num_steps_sampled": 17597440, "sample_throughput": 0.0, "train_throughput": 19359.606, "num_weight_syncs": 34369, "num_samples_dropped": 314, "learner_queue": {"size_count": 113827, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.739, "replay_time_ms": 106.924, "update_priorities_time_ms": 50.884, "policy_agent_0": {"added_count": 4359424, "sampled_count": 6593792, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4359424, "sampled_count": 6593792, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.49595746397972107, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7251503467559814, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 17597440, "episodes_total": 175984, "training_iteration": 179, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-41-45", "timestamp": 1569148905, "time_this_iter_s": 30.572980642318726, "time_total_s": 5470.483608961105, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655970d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5470.483608961105, "timesteps_since_restore": 17597440, "iterations_since_restore": 179, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.848338489083986, "episode_reward_min": 44.858552712792786, "episode_reward_mean": 48.33369979192583, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 22.9901610371426, "agent_1": 25.343538754783275}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6605390197590559, "mean_processing_ms": 3.524176725791171, "mean_inference_ms": 2.0625449003313405}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 526, "num_steps_trained": 26444288, "num_steps_sampled": 17698048, "sample_throughput": 0.0, "train_throughput": 16298.944, "num_weight_syncs": 34566, "num_samples_dropped": 314, "learner_queue": {"size_count": 114419, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 43.233, "replay_time_ms": 111.382, "update_priorities_time_ms": 51.177, "policy_agent_0": {"added_count": 4387840, "sampled_count": 6630912, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4387840, "sampled_count": 6630912, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.5859679579734802, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6702327132225037, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 17698048, "episodes_total": 176992, "training_iteration": 180, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-42-16", "timestamp": 1569148936, "time_this_iter_s": 30.512404203414917, "time_total_s": 5500.99601316452, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36560bea0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5500.99601316452, "timesteps_since_restore": 17698048, "iterations_since_restore": 180, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.54816449850949, "episode_reward_min": 45.17831263866264, "episode_reward_mean": 48.21509023714854, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 22.657887994393715, "agent_1": 25.557202242754887}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.660340746940995, "mean_processing_ms": 3.5231381305937415, "mean_inference_ms": 2.0623275245191963}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 529, "num_steps_trained": 26594816, "num_steps_sampled": 17799424, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 34763, "num_samples_dropped": 314, "learner_queue": {"size_count": 115007, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.722, "replay_time_ms": 103.682, "update_priorities_time_ms": 49.735, "policy_agent_0": {"added_count": 4408320, "sampled_count": 6670080, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4408320, "sampled_count": 6670080, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6495577692985535, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6274386644363403, "model": {}}}}, "timesteps_this_iter": 101376, "done": false, "timesteps_total": 17799424, "episodes_total": 178000, "training_iteration": 181, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-42-46", "timestamp": 1569148966, "time_this_iter_s": 30.59677290916443, "time_total_s": 5531.592786073685, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655a0b70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5531.592786073685, "timesteps_since_restore": 17799424, "iterations_since_restore": 181, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 49.05732911498693, "episode_reward_min": 43.93052608556036, "episode_reward_mean": 46.841641761868054, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 23.748914760379474, "agent_1": 23.092727001488676}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6603201698864047, "mean_processing_ms": 3.5222613628011805, "mean_inference_ms": 2.062377915586015}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 533, "num_steps_trained": 26752512, "num_steps_sampled": 17896704, "sample_throughput": 29782.316, "train_throughput": 0.0, "num_weight_syncs": 34954, "num_samples_dropped": 314, "learner_queue": {"size_count": 115623, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.044, "replay_time_ms": 97.339, "update_priorities_time_ms": 52.331, "policy_agent_0": {"added_count": 4432640, "sampled_count": 6710016, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4432640, "sampled_count": 6710016, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6924679279327393, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6406798958778381, "model": {}}}}, "timesteps_this_iter": 97280, "done": false, "timesteps_total": 17896704, "episodes_total": 178968, "training_iteration": 182, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-43-17", "timestamp": 1569148997, "time_this_iter_s": 30.690120697021484, "time_total_s": 5562.282906770706, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3657888c8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5562.282906770706, "timesteps_since_restore": 17896704, "iterations_since_restore": 182, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.285356354910235, "episode_reward_min": 43.88752655437051, "episode_reward_mean": 46.34688936693468, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 22.970224459091483, "agent_1": 23.376664907843253}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6611727006876073, "mean_processing_ms": 3.5256079530425333, "mean_inference_ms": 2.0624134250003143}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 536, "num_steps_trained": 26903040, "num_steps_sampled": 17997824, "sample_throughput": 9494.998, "train_throughput": 0.0, "num_weight_syncs": 35151, "num_samples_dropped": 314, "learner_queue": {"size_count": 116211, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.419, "replay_time_ms": 106.71, "update_priorities_time_ms": 52.514, "policy_agent_0": {"added_count": 4455168, "sampled_count": 6747136, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4455168, "sampled_count": 6747136, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7277669310569763, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6749140024185181, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 17997824, "episodes_total": 179984, "training_iteration": 183, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-43-48", "timestamp": 1569149028, "time_this_iter_s": 30.55095338821411, "time_total_s": 5592.83386015892, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3657887b8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5592.83386015892, "timesteps_since_restore": 17997824, "iterations_since_restore": 183, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 47.91579632218791, "episode_reward_min": 42.52034297059098, "episode_reward_mean": 45.00554151650485, "episode_len_mean": 100.0, "episodes_this_iter": 1048, "policy_reward_mean": {"agent_0": 22.43645035707405, "agent_1": 22.56909115943085}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6601137688355212, "mean_processing_ms": 3.5205829064097443, "mean_inference_ms": 2.0609619893469953}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 539, "num_steps_trained": 27049216, "num_steps_sampled": 18102272, "sample_throughput": 7750.522, "train_throughput": 0.0, "num_weight_syncs": 35355, "num_samples_dropped": 314, "learner_queue": {"size_count": 116783, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.112, "replay_time_ms": 88.033, "update_priorities_time_ms": 51.531, "policy_agent_0": {"added_count": 4480256, "sampled_count": 6785280, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4480256, "sampled_count": 6785280, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7535136938095093, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7019813656806946, "model": {}}}}, "timesteps_this_iter": 104448, "done": false, "timesteps_total": 18102272, "episodes_total": 181032, "training_iteration": 184, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-44-18", "timestamp": 1569149058, "time_this_iter_s": 30.610676050186157, "time_total_s": 5623.444536209106, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365735620>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5623.444536209106, "timesteps_since_restore": 18102272, "iterations_since_restore": 184, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 52.01248345405474, "episode_reward_min": 42.03523271954653, "episode_reward_mean": 44.26615054493259, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 21.344758025682843, "agent_1": 22.92139251924978}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6604218818633628, "mean_processing_ms": 3.5217704764068465, "mean_inference_ms": 2.0610315599002744}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 542, "num_steps_trained": 27203328, "num_steps_sampled": 18201856, "sample_throughput": 0.0, "train_throughput": 14104.057, "num_weight_syncs": 35550, "num_samples_dropped": 314, "learner_queue": {"size_count": 117384, "size_mean": 0.14, "size_std": 0.40049968789001567, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 41.407, "replay_time_ms": 98.498, "update_priorities_time_ms": 48.824, "policy_agent_0": {"added_count": 4508160, "sampled_count": 6822656, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4508160, "sampled_count": 6822656, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7906886339187622, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7242457270622253, "model": {}}}}, "timesteps_this_iter": 99584, "done": false, "timesteps_total": 18201856, "episodes_total": 182032, "training_iteration": 185, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-44-49", "timestamp": 1569149089, "time_this_iter_s": 30.60848641395569, "time_total_s": 5654.053022623062, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36562ea60>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5654.053022623062, "timesteps_since_restore": 18201856, "iterations_since_restore": 185, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.660069415188474, "episode_reward_min": 41.084566711287636, "episode_reward_mean": 44.06991264169844, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 22.509581948694322, "agent_1": 21.56033069300415}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6606603396325704, "mean_processing_ms": 3.5227932090886163, "mean_inference_ms": 2.060961433458132}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 545, "num_steps_trained": 27354368, "num_steps_sampled": 18302976, "sample_throughput": 7351.224, "train_throughput": 0.0, "num_weight_syncs": 35748, "num_samples_dropped": 314, "learner_queue": {"size_count": 117975, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 38.723, "replay_time_ms": 106.472, "update_priorities_time_ms": 59.906, "policy_agent_0": {"added_count": 4535552, "sampled_count": 6857984, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4535552, "sampled_count": 6857984, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8128544092178345, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7781404256820679, "model": {}}}}, "timesteps_this_iter": 101120, "done": false, "timesteps_total": 18302976, "episodes_total": 183032, "training_iteration": 186, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-45-20", "timestamp": 1569149120, "time_this_iter_s": 30.570623874664307, "time_total_s": 5684.623646497726, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656b0048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5684.623646497726, "timesteps_since_restore": 18302976, "iterations_since_restore": 186, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.13639761839721, "episode_reward_min": 41.04075608154486, "episode_reward_mean": 42.557335053615404, "episode_len_mean": 100.0, "episodes_this_iter": 1040, "policy_reward_mean": {"agent_0": 21.4894635206462, "agent_1": 21.06787153296929}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6608090883528543, "mean_processing_ms": 3.523785173371681, "mean_inference_ms": 2.060686551915332}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 548, "num_steps_trained": 27502080, "num_steps_sampled": 18406144, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 35949, "num_samples_dropped": 314, "learner_queue": {"size_count": 118551, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.047, "replay_time_ms": 115.86, "update_priorities_time_ms": 54.638, "policy_agent_0": {"added_count": 4560640, "sampled_count": 6897408, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4560640, "sampled_count": 6897408, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8269554376602173, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8051477074623108, "model": {}}}}, "timesteps_this_iter": 103168, "done": false, "timesteps_total": 18406144, "episodes_total": 184072, "training_iteration": 187, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-45-50", "timestamp": 1569149150, "time_this_iter_s": 30.59869384765625, "time_total_s": 5715.222340345383, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365706e18>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5715.222340345383, "timesteps_since_restore": 18406144, "iterations_since_restore": 187, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 48.82258447527449, "episode_reward_min": 41.12111542875294, "episode_reward_mean": 43.93824524032494, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 21.674808529542556, "agent_1": 22.26343671078239}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6602439332985083, "mean_processing_ms": 3.521187990612146, "mean_inference_ms": 2.0604704654524952}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 551, "num_steps_trained": 27659008, "num_steps_sampled": 18504960, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36142, "num_samples_dropped": 314, "learner_queue": {"size_count": 119164, "size_mean": 0.02, "size_std": 0.13999999999999999, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 35.501, "replay_time_ms": 82.503, "update_priorities_time_ms": 39.072, "policy_agent_0": {"added_count": 4585472, "sampled_count": 6938624, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4585472, "sampled_count": 6938624, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8273749947547913, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8113597631454468, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 18504960, "episodes_total": 185056, "training_iteration": 188, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-46-21", "timestamp": 1569149181, "time_this_iter_s": 30.557674646377563, "time_total_s": 5745.78001499176, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656f36a8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5745.78001499176, "timesteps_since_restore": 18504960, "iterations_since_restore": 188, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 48.917633319520924, "episode_reward_min": 43.80824525236468, "episode_reward_mean": 46.40895058097563, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 23.479987411559307, "agent_1": 22.928963169416175}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6605260295343102, "mean_processing_ms": 3.5221704616272485, "mean_inference_ms": 2.060424677816057}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 554, "num_steps_trained": 27813376, "num_steps_sampled": 18604800, "sample_throughput": 5158.079, "train_throughput": 5158.079, "num_weight_syncs": 36337, "num_samples_dropped": 314, "learner_queue": {"size_count": 119768, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 34.978, "replay_time_ms": 96.447, "update_priorities_time_ms": 58.512, "policy_agent_0": {"added_count": 4611328, "sampled_count": 6976256, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4611328, "sampled_count": 6976256, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8302212357521057, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8066409826278687, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 18604800, "episodes_total": 186056, "training_iteration": 189, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-46-51", "timestamp": 1569149211, "time_this_iter_s": 30.50677251815796, "time_total_s": 5776.286787509918, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365749c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5776.286787509918, "timesteps_since_restore": 18604800, "iterations_since_restore": 189, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 47.15165717239874, "episode_reward_min": 44.7383209224959, "episode_reward_mean": 45.79415384405732, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 23.733924876883428, "agent_1": 22.060228967173735}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6599456837141535, "mean_processing_ms": 3.5199770904526995, "mean_inference_ms": 2.060354252644741}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 557, "num_steps_trained": 27967232, "num_steps_sampled": 18705408, "sample_throughput": 8012.759, "train_throughput": 0.0, "num_weight_syncs": 36532, "num_samples_dropped": 314, "learner_queue": {"size_count": 120369, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.515, "replay_time_ms": 99.189, "update_priorities_time_ms": 48.41, "policy_agent_0": {"added_count": 4633600, "sampled_count": 7015168, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4633600, "sampled_count": 7015168, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8313532471656799, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8231348991394043, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 18705408, "episodes_total": 187064, "training_iteration": 190, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-47-22", "timestamp": 1569149242, "time_this_iter_s": 30.576634883880615, "time_total_s": 5806.863422393799, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656d1f28>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5806.863422393799, "timesteps_since_restore": 18705408, "iterations_since_restore": 190, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 48.11780655342767, "episode_reward_min": 44.220598597732746, "episode_reward_mean": 45.810587515010134, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 23.25290229268739, "agent_1": 22.55768522232264}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6606524135815516, "mean_processing_ms": 3.522538595240232, "mean_inference_ms": 2.0603045307712864}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 560, "num_steps_trained": 28123136, "num_steps_sampled": 18805504, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 36728, "num_samples_dropped": 314, "learner_queue": {"size_count": 120977, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 32.447, "replay_time_ms": 114.502, "update_priorities_time_ms": 57.134, "policy_agent_0": {"added_count": 4657408, "sampled_count": 7053568, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4657408, "sampled_count": 7053568, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8131752610206604, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8261275887489319, "model": {}}}}, "timesteps_this_iter": 100096, "done": false, "timesteps_total": 18805504, "episodes_total": 188064, "training_iteration": 191, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-47-53", "timestamp": 1569149273, "time_this_iter_s": 30.53087568283081, "time_total_s": 5837.39429807663, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3656e2400>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5837.39429807663, "timesteps_since_restore": 18805504, "iterations_since_restore": 191, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 51.11364237916076, "episode_reward_min": 42.57492726531471, "episode_reward_mean": 45.38651642376715, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 22.42823601291946, "agent_1": 22.958280410847667}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6603625160762225, "mean_processing_ms": 3.521225848144586, "mean_inference_ms": 2.0598495565428703}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 563, "num_steps_trained": 28273664, "num_steps_sampled": 18907136, "sample_throughput": 8982.356, "train_throughput": 0.0, "num_weight_syncs": 36928, "num_samples_dropped": 314, "learner_queue": {"size_count": 121566, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 36.239, "replay_time_ms": 100.014, "update_priorities_time_ms": 52.357, "policy_agent_0": {"added_count": 4681984, "sampled_count": 7091712, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4681984, "sampled_count": 7091712, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8207154273986816, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8321455717086792, "model": {}}}}, "timesteps_this_iter": 101632, "done": false, "timesteps_total": 18907136, "episodes_total": 189072, "training_iteration": 192, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-48-23", "timestamp": 1569149303, "time_this_iter_s": 30.63701319694519, "time_total_s": 5868.031311273575, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365678d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5868.031311273575, "timesteps_since_restore": 18907136, "iterations_since_restore": 192, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 46.9647777644406, "episode_reward_min": 44.189263297747296, "episode_reward_mean": 44.74417986025243, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 22.412057608076655, "agent_1": 22.332122252175747}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6605773266170984, "mean_processing_ms": 3.5214557324892706, "mean_inference_ms": 2.0594977946806203}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 566, "num_steps_trained": 28425984, "num_steps_sampled": 19007744, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 37124, "num_samples_dropped": 314, "learner_queue": {"size_count": 122160, "size_mean": 1.56, "size_std": 2.7579702681501117, "size_quantiles": [0.0, 0.0, 0.0, 6.100000000000001, 10.0]}, "replay_shard_0": {"add_batch_time_ms": 29.044, "replay_time_ms": 85.577, "update_priorities_time_ms": 46.369, "policy_agent_0": {"added_count": 4703744, "sampled_count": 7133184, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4703744, "sampled_count": 7133184, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8262643814086914, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8363649845123291, "model": {}}}}, "timesteps_this_iter": 100608, "done": false, "timesteps_total": 19007744, "episodes_total": 190088, "training_iteration": 193, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-48-54", "timestamp": 1569149334, "time_this_iter_s": 30.583398818969727, "time_total_s": 5898.614710092545, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365619488>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5898.614710092545, "timesteps_since_restore": 19007744, "iterations_since_restore": 193, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 47.31326367503666, "episode_reward_min": 41.95180953678043, "episode_reward_mean": 44.29326223284593, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 22.569295249095997, "agent_1": 21.723966983749936}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6603675171946801, "mean_processing_ms": 3.520632192209174, "mean_inference_ms": 2.0593526934648274}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 569, "num_steps_trained": 28573440, "num_steps_sampled": 19110144, "sample_throughput": 18110.762, "train_throughput": 0.0, "num_weight_syncs": 37324, "num_samples_dropped": 314, "learner_queue": {"size_count": 122736, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 40.333, "replay_time_ms": 91.812, "update_priorities_time_ms": 46.424, "policy_agent_0": {"added_count": 4726784, "sampled_count": 7173632, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4726784, "sampled_count": 7173632, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8336487412452698, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8390573263168335, "model": {}}}}, "timesteps_this_iter": 102400, "done": false, "timesteps_total": 19110144, "episodes_total": 191104, "training_iteration": 194, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-49-24", "timestamp": 1569149364, "time_this_iter_s": 30.563806772232056, "time_total_s": 5929.178516864777, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd365698d90>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5929.178516864777, "timesteps_since_restore": 19110144, "iterations_since_restore": 194, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 49.45980349557204, "episode_reward_min": 45.1856041183315, "episode_reward_mean": 47.04481958785399, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 24.60298184066453, "agent_1": 22.441837747189428}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6599296339112084, "mean_processing_ms": 3.5191635450998784, "mean_inference_ms": 2.059594293487728}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 572, "num_steps_trained": 28724736, "num_steps_sampled": 19206144, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 37511, "num_samples_dropped": 314, "learner_queue": {"size_count": 123327, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.489, "replay_time_ms": 97.419, "update_priorities_time_ms": 49.73, "policy_agent_0": {"added_count": 4752896, "sampled_count": 7213568, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4752896, "sampled_count": 7213568, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8196419477462769, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8435193300247192, "model": {}}}}, "timesteps_this_iter": 96000, "done": false, "timesteps_total": 19206144, "episodes_total": 192064, "training_iteration": 195, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-49-55", "timestamp": 1569149395, "time_this_iter_s": 30.686197519302368, "time_total_s": 5959.864714384079, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655e7048>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5959.864714384079, "timesteps_since_restore": 19206144, "iterations_since_restore": 195, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.22547112589933, "episode_reward_min": 45.545204546357795, "episode_reward_mean": 46.47406063719449, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 23.41502046032086, "agent_1": 23.059040176873598}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6604092766665259, "mean_processing_ms": 3.5214062108012203, "mean_inference_ms": 2.060023240502076}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 575, "num_steps_trained": 28871680, "num_steps_sampled": 19302912, "sample_throughput": 7429.814, "train_throughput": 0.0, "num_weight_syncs": 37700, "num_samples_dropped": 314, "learner_queue": {"size_count": 123901, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 37.902, "replay_time_ms": 109.267, "update_priorities_time_ms": 51.747, "policy_agent_0": {"added_count": 4777216, "sampled_count": 7250176, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4777216, "sampled_count": 7250176, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.803961992263794, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8319097757339478, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 19302912, "episodes_total": 193032, "training_iteration": 196, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-50-26", "timestamp": 1569149426, "time_this_iter_s": 30.556890726089478, "time_total_s": 5990.4216051101685, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655e4d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 5990.4216051101685, "timesteps_since_restore": 19302912, "iterations_since_restore": 196, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 49.20588946732702, "episode_reward_min": 45.585216418633536, "episode_reward_mean": 46.66347231219726, "episode_len_mean": 100.0, "episodes_this_iter": 1000, "policy_reward_mean": {"agent_0": 23.10440665893125, "agent_1": 23.55906565326597}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6609432238557266, "mean_processing_ms": 3.523420974422309, "mean_inference_ms": 2.0600186822256172}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 578, "num_steps_trained": 29017600, "num_steps_sampled": 19403264, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 37896, "num_samples_dropped": 314, "learner_queue": {"size_count": 124472, "size_mean": 0.46, "size_std": 0.8991106717195609, "size_quantiles": [0.0, 0.0, 0.0, 1.1000000000000014, 4.0]}, "replay_shard_0": {"add_batch_time_ms": 36.221, "replay_time_ms": 85.64, "update_priorities_time_ms": 52.375, "policy_agent_0": {"added_count": 4800512, "sampled_count": 7290112, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4800512, "sampled_count": 7290112, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7866419553756714, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8234072923660278, "model": {}}}}, "timesteps_this_iter": 100352, "done": false, "timesteps_total": 19403264, "episodes_total": 194032, "training_iteration": 197, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-50-56", "timestamp": 1569149456, "time_this_iter_s": 30.539589881896973, "time_total_s": 6020.961194992065, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655a6c80>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6020.961194992065, "timesteps_since_restore": 19403264, "iterations_since_restore": 197, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 48.995670431504685, "episode_reward_min": 45.57653984634323, "episode_reward_mean": 46.70813418559646, "episode_len_mean": 100.0, "episodes_this_iter": 1024, "policy_reward_mean": {"agent_0": 23.329841636611228, "agent_1": 23.378292548985197}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.660314556202882, "mean_processing_ms": 3.5213919855557037, "mean_inference_ms": 2.0595849907345967}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 581, "num_steps_trained": 29164288, "num_steps_sampled": 19505408, "sample_throughput": 0.0, "train_throughput": 33662.784, "num_weight_syncs": 38095, "num_samples_dropped": 314, "learner_queue": {"size_count": 125044, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 31.331, "replay_time_ms": 100.786, "update_priorities_time_ms": 52.744, "policy_agent_0": {"added_count": 4827392, "sampled_count": 7326464, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4827392, "sampled_count": 7326464, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7969595193862915, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8217277526855469, "model": {}}}}, "timesteps_this_iter": 102144, "done": false, "timesteps_total": 19505408, "episodes_total": 195056, "training_iteration": 198, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-51-27", "timestamp": 1569149487, "time_this_iter_s": 30.602221965789795, "time_total_s": 6051.563416957855, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655cbae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6051.563416957855, "timesteps_since_restore": 19505408, "iterations_since_restore": 198, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 49.84597514516225, "episode_reward_min": 44.738320922495845, "episode_reward_mean": 46.919177809303655, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 23.76675197996554, "agent_1": 23.15242582933798}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6602954984513145, "mean_processing_ms": 3.520949194240092, "mean_inference_ms": 2.059465862773625}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 584, "num_steps_trained": 29315840, "num_steps_sampled": 19603456, "sample_throughput": 6212.561, "train_throughput": 0.0, "num_weight_syncs": 38288, "num_samples_dropped": 314, "learner_queue": {"size_count": 125636, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 33.955, "replay_time_ms": 111.924, "update_priorities_time_ms": 50.127, "policy_agent_0": {"added_count": 4849152, "sampled_count": 7365632, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4849152, "sampled_count": 7365632, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7952053546905518, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8149415254592896, "model": {}}}}, "timesteps_this_iter": 98048, "done": false, "timesteps_total": 19603456, "episodes_total": 196040, "training_iteration": 199, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-51-57", "timestamp": 1569149517, "time_this_iter_s": 30.571943283081055, "time_total_s": 6082.135360240936, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36557db70>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6082.135360240936, "timesteps_since_restore": 19603456, "iterations_since_restore": 199, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.31754941112431, "episode_reward_min": 45.66553720034061, "episode_reward_mean": 48.62274191460853, "episode_len_mean": 100.0, "episodes_this_iter": 968, "policy_reward_mean": {"agent_0": 25.00280307778251, "agent_1": 23.61993883682591}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6603502268173828, "mean_processing_ms": 3.521324851582849, "mean_inference_ms": 2.059671467275602}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 587, "num_steps_trained": 29458688, "num_steps_sampled": 19700224, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38476, "num_samples_dropped": 314, "learner_queue": {"size_count": 126195, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 29.873, "replay_time_ms": 108.77, "update_priorities_time_ms": 59.092, "policy_agent_0": {"added_count": 4873728, "sampled_count": 7401472, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4873728, "sampled_count": 7401472, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7716185450553894, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8084524273872375, "model": {}}}}, "timesteps_this_iter": 96768, "done": false, "timesteps_total": 19700224, "episodes_total": 197008, "training_iteration": 200, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-52-28", "timestamp": 1569149548, "time_this_iter_s": 30.47915029525757, "time_total_s": 6112.614510536194, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655880d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6112.614510536194, "timesteps_since_restore": 19700224, "iterations_since_restore": 200, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.28938966775162, "episode_reward_min": 48.458854446377714, "episode_reward_mean": 49.161855580282904, "episode_len_mean": 100.0, "episodes_this_iter": 984, "policy_reward_mean": {"agent_0": 25.25525173776036, "agent_1": 23.90660384252242}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6602193823192539, "mean_processing_ms": 3.520672035246708, "mean_inference_ms": 2.059554977364415}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 590, "num_steps_trained": 29609728, "num_steps_sampled": 19799040, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 38669, "num_samples_dropped": 314, "learner_queue": {"size_count": 126784, "size_mean": 0.92, "size_std": 1.874459922217597, "size_quantiles": [0.0, 0.0, 0.0, 3.1000000000000014, 8.0]}, "replay_shard_0": {"add_batch_time_ms": 38.267, "replay_time_ms": 92.868, "update_priorities_time_ms": 49.367, "policy_agent_0": {"added_count": 4900864, "sampled_count": 7438080, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4900864, "sampled_count": 7438080, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7247536778450012, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.8053000569343567, "model": {}}}}, "timesteps_this_iter": 98816, "done": false, "timesteps_total": 19799040, "episodes_total": 197992, "training_iteration": 201, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-52-59", "timestamp": 1569149579, "time_this_iter_s": 30.605403900146484, "time_total_s": 6143.21991443634, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd36557dae8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6143.21991443634, "timesteps_since_restore": 19799040, "iterations_since_restore": 201, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.795639603152935, "episode_reward_min": 48.56714721632387, "episode_reward_mean": 49.329458164601064, "episode_len_mean": 100.0, "episodes_this_iter": 1008, "policy_reward_mean": {"agent_0": 25.302110617442917, "agent_1": 24.02734754715803}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6606596641137864, "mean_processing_ms": 3.5229985852475116, "mean_inference_ms": 2.059894978013448}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 592, "num_steps_trained": 29756160, "num_steps_sampled": 19898880, "sample_throughput": 5007.143, "train_throughput": 0.0, "num_weight_syncs": 38864, "num_samples_dropped": 314, "learner_queue": {"size_count": 127357, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 38.675, "replay_time_ms": 99.15, "update_priorities_time_ms": 53.974, "policy_agent_0": {"added_count": 4921344, "sampled_count": 7474432, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4921344, "sampled_count": 7474432, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6679927706718445, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7994959354400635, "model": {}}}}, "timesteps_this_iter": 99840, "done": false, "timesteps_total": 19898880, "episodes_total": 199000, "training_iteration": 202, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-53-29", "timestamp": 1569149609, "time_this_iter_s": 30.544061422348022, "time_total_s": 6173.763975858688, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655c2d08>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6173.763975858688, "timesteps_since_restore": 19898880, "iterations_since_restore": 202, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.51536919062907, "episode_reward_min": 48.56545937609596, "episode_reward_mean": 49.411844626954455, "episode_len_mean": 100.0, "episodes_this_iter": 960, "policy_reward_mean": {"agent_0": 25.18699360824581, "agent_1": 24.224851018708545}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6607575200277906, "mean_processing_ms": 3.5232445182941947, "mean_inference_ms": 2.0599640551939604}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 595, "num_steps_trained": 29904640, "num_steps_sampled": 19995136, "sample_throughput": 8979.426, "train_throughput": 0.0, "num_weight_syncs": 39052, "num_samples_dropped": 314, "learner_queue": {"size_count": 127936, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 44.42, "replay_time_ms": 110.357, "update_priorities_time_ms": 50.405, "policy_agent_0": {"added_count": 4941824, "sampled_count": 7510528, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4941824, "sampled_count": 7510528, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6331609487533569, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7968094944953918, "model": {}}}}, "timesteps_this_iter": 96256, "done": false, "timesteps_total": 19995136, "episodes_total": 199960, "training_iteration": 203, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-54-00", "timestamp": 1569149640, "time_this_iter_s": 30.485932111740112, "time_total_s": 6204.2499079704285, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655e4bf8>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6204.2499079704285, "timesteps_since_restore": 19995136, "iterations_since_restore": 203, "num_healthy_workers": 4, "trial_id": "b9265774"}
{"episode_reward_max": 50.43011124926282, "episode_reward_min": 46.712151991307344, "episode_reward_mean": 49.36522410635995, "episode_len_mean": 100.0, "episodes_this_iter": 1016, "policy_reward_mean": {"agent_0": 25.21055436867241, "agent_1": 24.154669737687428}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 0.6600238565747854, "mean_processing_ms": 3.5201661834555322, "mean_inference_ms": 2.059277856146868}, "off_policy_estimator": {}, "info": {"min_exploration": 0.020000000000000018, "max_exploration": 0.020000000000000018, "num_target_updates": 598, "num_steps_trained": 30055936, "num_steps_sampled": 20096768, "sample_throughput": 0.0, "train_throughput": 22279.112, "num_weight_syncs": 39250, "num_samples_dropped": 314, "learner_queue": {"size_count": 128527, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 36.51, "replay_time_ms": 116.41, "update_priorities_time_ms": 58.375, "policy_agent_0": {"added_count": 4966656, "sampled_count": 7548672, "est_size_bytes": 97727452, "num_entries": 75000}, "policy_agent_1": {"added_count": 4966656, "sampled_count": 7548672, "est_size_bytes": 97727452, "num_entries": 75000}}, "learner": {"agent_0": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.6205969452857971, "model": {}}, "agent_1": {"cur_lr": 0.009999999776482582, "mean_td_error": 0.7807151079177856, "model": {}}}}, "timesteps_this_iter": 101632, "done": true, "timesteps_total": 20096768, "episodes_total": 200976, "training_iteration": 204, "experiment_id": "8dcecc59c5d44671bfd84f7aa1fd5c41", "date": "2019-09-22_10-54-30", "timestamp": 1569149670, "time_this_iter_s": 30.65032958984375, "time_total_s": 6234.900237560272, "pid": 3279, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [16], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.4315251, "p_max": 1.9509807, "p_num": 15}, "env": "MultiAgentFirmsPricing", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 32, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(15)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fd3655e70d0>)", "policies_to_train": null}, "num_atoms": 10, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [16], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.05, "exploration_final_eps": 0.02, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 300000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.0015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": false, "worker_side_prioritization": true}, "time_since_restore": 6234.900237560272, "timesteps_since_restore": 20096768, "iterations_since_restore": 204, "num_healthy_workers": 4, "trial_id": "b9265774"}
