{"episode_reward_max": 67.08398453303609, "episode_reward_min": 27.74550429718187, "episode_reward_mean": 62.460909983984806, "episode_len_mean": 100.0, "episodes_this_iter": 336, "policy_reward_mean": {"agent_0": 33.91511966075292, "agent_1": 28.54579032323198}, "custom_metrics": {"delta0_mean": 0.983279395786064, "delta0_min": -0.1440483155470527, "delta0_max": 1.2308228706032223, "delta1_mean": 0.506984179745039, "delta1_min": -0.10902401101889553, "delta1_max": 0.6868347873484991, "price0_mean": 1.8402326784492504, "price0_min": 1.5206560863874345, "price0_max": 1.9351894373215135, "price1_mean": 1.8966065324640793, "price1_min": 1.4699812775166587, "price1_max": 1.9974068337993813}, "sampler_perf": {"mean_env_wait_ms": 1.0154370327965783, "mean_processing_ms": 4.0401077162222006, "mean_inference_ms": 1.8599883646772517}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1, "num_steps_trained": 90624, "num_steps_sampled": 67200, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 129, "num_samples_dropped": 875, "learner_queue": {"size_count": 11967, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 13.996, "replay_time_ms": 89.469, "update_priorities_time_ms": 44.801, "policy_agent_0": {"added_count": 19072, "sampled_count": 27392, "est_size_bytes": 24851064, "num_entries": 19072}, "policy_agent_1": {"added_count": 19072, "sampled_count": 27392, "est_size_bytes": 24851064, "num_entries": 19072}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.5559078454971313}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.573909044265747}}}, "timesteps_this_iter": 67200, "done": false, "timesteps_total": 67200, "episodes_total": 336, "training_iteration": 1, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-34-57", "timestamp": 1564907697, "time_this_iter_s": 30.53740382194519, "time_total_s": 30.53740382194519, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1796bf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1796b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1796f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17a22f0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 30.53740382194519, "timesteps_since_restore": 67200, "iterations_since_restore": 1, "num_healthy_workers": 4}
{"episode_reward_max": 66.81819490326136, "episode_reward_min": 25.59341187239894, "episode_reward_mean": 56.0181930544258, "episode_len_mean": 100.0, "episodes_this_iter": 416, "policy_reward_mean": {"agent_0": 35.2861019751539, "agent_1": 20.732091079271946}, "custom_metrics": {"delta0_mean": 1.050377749274714, "delta0_min": -0.20048849834506485, "delta0_max": 1.385175827825649, "delta1_mean": 0.1236546512532397, "delta1_min": -0.49961369974033776, "delta1_max": 0.40958059726877294, "price0_mean": 1.738891147732861, "price0_min": 1.428721514723495, "price0_max": 1.8189577079031731, "price1_mean": 1.8879198419162162, "price1_min": 1.4943592887549468, "price1_max": 1.9940663374809824}, "sampler_perf": {"mean_env_wait_ms": 1.0343406602641096, "mean_processing_ms": 4.254465143138716, "mean_inference_ms": 1.9946603723026253}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 5, "num_steps_trained": 261120, "num_steps_sampled": 151168, "sample_throughput": 9253.523, "train_throughput": 18507.047, "num_weight_syncs": 294, "num_samples_dropped": 875, "learner_queue": {"size_count": 12632, "size_mean": 0.26, "size_std": 0.4386342439892262, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.495, "replay_time_ms": 93.623, "update_priorities_time_ms": 49.879, "policy_agent_0": {"added_count": 42240, "sampled_count": 68352, "est_size_bytes": 55039644, "num_entries": 42240}, "policy_agent_1": {"added_count": 42240, "sampled_count": 68352, "est_size_bytes": 55039644, "num_entries": 42240}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.3569128513336182}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.4602844715118408}}}, "timesteps_this_iter": 83968, "done": false, "timesteps_total": 151168, "episodes_total": 752, "training_iteration": 2, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-35-28", "timestamp": 1564907728, "time_this_iter_s": 30.463472843170166, "time_total_s": 61.000876665115356, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17f7268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17f72f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17f71e0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fad18a1fbf8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 61.000876665115356, "timesteps_since_restore": 151168, "iterations_since_restore": 2, "num_healthy_workers": 4}
{"episode_reward_max": 57.691920879504245, "episode_reward_min": 24.47112538736756, "episode_reward_mean": 47.07492061922467, "episode_len_mean": 100.0, "episodes_this_iter": 416, "policy_reward_mean": {"agent_0": 35.011583466280726, "agent_1": 12.063337152943946}, "custom_metrics": {"delta0_mean": 1.063639168606195, "delta0_min": 0.1910785755704522, "delta0_max": 1.3912307179879828, "delta1_mean": -0.2593308348192732, "delta1_min": -0.6859309157940189, "delta1_max": 0.00022696374950919953, "price0_mean": 1.639623528856518, "price0_min": 1.4289121613633293, "price0_max": 1.7022324896973382, "price1_mean": 1.89236864457745, "price1_min": 1.622584292763158, "price1_max": 1.992901919004305}, "sampler_perf": {"mean_env_wait_ms": 1.0463574427665039, "mean_processing_ms": 4.35973792395021, "mean_inference_ms": 2.0080570978319563}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 8, "num_steps_trained": 430336, "num_steps_sampled": 234240, "sample_throughput": 3786.755, "train_throughput": 0.0, "num_weight_syncs": 456, "num_samples_dropped": 875, "learner_queue": {"size_count": 13293, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 24.411, "replay_time_ms": 84.268, "update_priorities_time_ms": 48.565, "policy_agent_0": {"added_count": 63360, "sampled_count": 112896, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 63360, "sampled_count": 112896, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.1657708883285522}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.3656983375549316}}}, "timesteps_this_iter": 83072, "done": false, "timesteps_total": 234240, "episodes_total": 1168, "training_iteration": 3, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-35-58", "timestamp": 1564907758, "time_this_iter_s": 30.485780239105225, "time_total_s": 91.48665690422058, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fad18a1f620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17a21e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17a2268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd174e048>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 91.48665690422058, "timesteps_since_restore": 234240, "iterations_since_restore": 3, "num_healthy_workers": 4}
{"episode_reward_max": 52.72040573349613, "episode_reward_min": 21.100773340061178, "episode_reward_mean": 36.178886690928664, "episode_len_mean": 100.0, "episodes_this_iter": 424, "policy_reward_mean": {"agent_0": 22.87542033975922, "agent_1": 13.303466351169442}, "custom_metrics": {"delta0_mean": 0.7838766501467712, "delta0_min": 0.129370867854382, "delta0_max": 1.1171453988872437, "delta1_mean": -0.4152460358735701, "delta1_min": -0.7192692464613506, "delta1_max": -0.21930207158893264, "price0_mean": 1.5671224804719468, "price0_min": 1.4104747728352165, "price0_max": 1.6225797504671244, "price1_mean": 1.8004804615743129, "price1_min": 1.5853254840104536, "price1_max": 1.9032785908620342}, "sampler_perf": {"mean_env_wait_ms": 1.0470985953256733, "mean_processing_ms": 4.42926905161409, "mean_inference_ms": 1.984170727878364}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 11, "num_steps_trained": 595712, "num_steps_sampled": 317312, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 618, "num_samples_dropped": 875, "learner_queue": {"size_count": 13939, "size_mean": 0.22, "size_std": 0.45999999999999996, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.639, "replay_time_ms": 83.482, "update_priorities_time_ms": 43.349, "policy_agent_0": {"added_count": 83328, "sampled_count": 157184, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 83328, "sampled_count": 157184, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.0251649618148804}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.2804220914840698}}}, "timesteps_this_iter": 83072, "done": false, "timesteps_total": 317312, "episodes_total": 1592, "training_iteration": 4, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-36-29", "timestamp": 1564907789, "time_this_iter_s": 30.45729160308838, "time_total_s": 121.94394850730896, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17f72f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17f71e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17f7268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd174eae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 121.94394850730896, "timesteps_since_restore": 317312, "iterations_since_restore": 4, "num_healthy_workers": 4}
{"episode_reward_max": 39.26286779665441, "episode_reward_min": 19.990422744242952, "episode_reward_mean": 31.190819498685833, "episode_len_mean": 100.0, "episodes_this_iter": 408, "policy_reward_mean": {"agent_0": 15.46187717847445, "agent_1": 15.728942320211377}, "custom_metrics": {"delta0_mean": 0.487158679739377, "delta0_min": -0.029227118423807867, "delta0_max": 0.7620354040101027, "delta1_mean": -0.45900518995710515, "delta1_min": -0.6991379377552591, "delta1_max": -0.29482174646867926, "price0_mean": 1.5217959438118027, "price0_min": 1.3968121949646854, "price0_max": 1.5702411536872027, "price1_mean": 1.700013868596982, "price1_min": 1.5286000278455367, "price1_max": 1.7830194043071124}, "sampler_perf": {"mean_env_wait_ms": 1.0520739569698663, "mean_processing_ms": 4.505841349242864, "mean_inference_ms": 1.9994220158040774}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 15, "num_steps_trained": 758528, "num_steps_sampled": 398336, "sample_throughput": 4554.231, "train_throughput": 0.0, "num_weight_syncs": 777, "num_samples_dropped": 875, "learner_queue": {"size_count": 14575, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.419, "replay_time_ms": 102.302, "update_priorities_time_ms": 54.254, "policy_agent_0": {"added_count": 102784, "sampled_count": 198656, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 102784, "sampled_count": 198656, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.0040143728256226}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.1584709882736206}}}, "timesteps_this_iter": 81024, "done": false, "timesteps_total": 398336, "episodes_total": 2000, "training_iteration": 5, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-37-00", "timestamp": 1564907820, "time_this_iter_s": 30.495347261428833, "time_total_s": 152.4392957687378, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fad18a1fd08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fad18a1fbf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd174e048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd174fd90>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 152.4392957687378, "timesteps_since_restore": 398336, "iterations_since_restore": 5, "num_healthy_workers": 4}
{"episode_reward_max": 45.791087394366286, "episode_reward_min": 26.46414715591861, "episode_reward_mean": 39.57980761072341, "episode_len_mean": 100.0, "episodes_this_iter": 408, "policy_reward_mean": {"agent_0": 21.58676009631468, "agent_1": 17.993047514408723}, "custom_metrics": {"delta0_mean": 0.389140293281919, "delta0_min": -0.03894017837381195, "delta0_max": 0.6083803561484883, "delta1_mean": -0.45352437985441163, "delta1_min": -0.6537256418477552, "delta1_max": -0.31820008361887214, "price0_mean": 1.498858731123747, "price0_min": 1.3948441173183894, "price0_max": 1.5379502694612026, "price1_mean": 1.6626108583568109, "price1_min": 1.5188021970410306, "price1_max": 1.728793601259916}, "sampler_perf": {"mean_env_wait_ms": 1.05936579348061, "mean_processing_ms": 4.597769261267963, "mean_inference_ms": 2.0008643450267476}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 18, "num_steps_trained": 921088, "num_steps_sampled": 478720, "sample_throughput": 16401.018, "train_throughput": 0.0, "num_weight_syncs": 933, "num_samples_dropped": 875, "learner_queue": {"size_count": 15210, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 12.188, "replay_time_ms": 73.004, "update_priorities_time_ms": 39.739, "policy_agent_0": {"added_count": 123264, "sampled_count": 240896, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 123264, "sampled_count": 240896, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.9399745464324951}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.0643099546432495}}}, "timesteps_this_iter": 80384, "done": false, "timesteps_total": 478720, "episodes_total": 2408, "training_iteration": 6, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-37-30", "timestamp": 1564907850, "time_this_iter_s": 30.439124822616577, "time_total_s": 182.87842059135437, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fad18a1fea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fad18a1f840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fad18a1f620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176b0d0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 182.87842059135437, "timesteps_since_restore": 478720, "iterations_since_restore": 6, "num_healthy_workers": 4}
{"episode_reward_max": 46.29797121318146, "episode_reward_min": 44.573678976784805, "episode_reward_mean": 45.54188680998767, "episode_len_mean": 100.0, "episodes_this_iter": 368, "policy_reward_mean": {"agent_0": 25.62269253514321, "agent_1": 19.919194274844468}, "custom_metrics": {"delta0_mean": 0.3690526204502772, "delta0_min": -0.0005276202889094947, "delta0_max": 0.5608379069644833, "delta1_mean": -0.42760381544279524, "delta1_min": -0.6017541282946596, "delta1_max": -0.3107331915466405, "price0_mean": 1.4906792932207715, "price0_min": 1.4005787427805874, "price0_max": 1.5247724910229177, "price1_mean": 1.64955803267467, "price1_min": 1.5252393512296978, "price1_max": 1.707282375747789}, "sampler_perf": {"mean_env_wait_ms": 1.0683483739524942, "mean_processing_ms": 4.7055496586180725, "mean_inference_ms": 2.014876258423479}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 21, "num_steps_trained": 1086464, "num_steps_sampled": 555520, "sample_throughput": 10452.28, "train_throughput": 0.0, "num_weight_syncs": 1083, "num_samples_dropped": 875, "learner_queue": {"size_count": 15857, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.648, "replay_time_ms": 103.91, "update_priorities_time_ms": 49.702, "policy_agent_0": {"added_count": 142208, "sampled_count": 282112, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 142208, "sampled_count": 282112, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8015735745429993}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 1.0097709894180298}}}, "timesteps_this_iter": 76800, "done": false, "timesteps_total": 555520, "episodes_total": 2776, "training_iteration": 7, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-38-00", "timestamp": 1564907880, "time_this_iter_s": 30.453063011169434, "time_total_s": 213.3314836025238, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176b400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176b488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176b510>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176e7b8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 213.3314836025238, "timesteps_since_restore": 555520, "iterations_since_restore": 7, "num_healthy_workers": 4}
{"episode_reward_max": 46.22736507166199, "episode_reward_min": 44.25620344740889, "episode_reward_mean": 45.26916096055818, "episode_len_mean": 100.0, "episodes_this_iter": 368, "policy_reward_mean": {"agent_0": 24.54690391932879, "agent_1": 20.722257041229387}, "custom_metrics": {"delta0_mean": 0.34123182875678354, "delta0_min": 0.017973218864540775, "delta0_max": 0.5152656836377637, "delta1_mean": -0.3994783639766339, "delta1_min": -0.5515119968649583, "delta1_max": -0.2966306724430941, "price0_mean": 1.485233873863599, "price0_min": 1.4061893378175345, "price0_max": 1.5161190652081944, "price1_mean": 1.6356101544948876, "price1_min": 1.5261706330765088, "price1_max": 1.6879493459470027}, "sampler_perf": {"mean_env_wait_ms": 1.0722692245651224, "mean_processing_ms": 4.824044139212629, "mean_inference_ms": 2.035214252458777}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 25, "num_steps_trained": 1257728, "num_steps_sampled": 629760, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1228, "num_samples_dropped": 875, "learner_queue": {"size_count": 16525, "size_mean": 0.28, "size_std": 0.4915282290977803, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.066, "replay_time_ms": 83.218, "update_priorities_time_ms": 43.294, "policy_agent_0": {"added_count": 160384, "sampled_count": 323328, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 160384, "sampled_count": 323328, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6751795411109924}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.93677818775177}}}, "timesteps_this_iter": 74240, "done": false, "timesteps_total": 629760, "episodes_total": 3144, "training_iteration": 8, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-38-31", "timestamp": 1564907911, "time_this_iter_s": 30.418248891830444, "time_total_s": 243.74973249435425, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17e7840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fad18a1fd08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd174fd90>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1776620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 243.74973249435425, "timesteps_since_restore": 629760, "iterations_since_restore": 8, "num_healthy_workers": 4}
{"episode_reward_max": 44.74421292097661, "episode_reward_min": 42.71490568174879, "episode_reward_mean": 43.80943576548253, "episode_len_mean": 100.0, "episodes_this_iter": 384, "policy_reward_mean": {"agent_0": 23.22134228534074, "agent_1": 20.588093480141797}, "custom_metrics": {"delta0_mean": 0.3127036987890485, "delta0_min": 0.02026185212558284, "delta0_max": 0.46067227212970446, "delta1_mean": -0.37718254839308435, "delta1_min": -0.5150438731947279, "delta1_max": -0.2855294557112388, "price0_mean": 1.4806963716651735, "price0_min": 1.409345916545066, "price0_max": 1.507186374340939, "price1_mean": 1.622073689642206, "price1_min": 1.523347837882369, "price1_max": 1.666814505590655}, "sampler_perf": {"mean_env_wait_ms": 1.0783340506211498, "mean_processing_ms": 4.920271795328234, "mean_inference_ms": 2.0312983266028373}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 28, "num_steps_trained": 1421312, "num_steps_sampled": 704640, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1375, "num_samples_dropped": 875, "learner_queue": {"size_count": 17166, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.106, "replay_time_ms": 91.016, "update_priorities_time_ms": 46.853, "policy_agent_0": {"added_count": 180224, "sampled_count": 365824, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 180224, "sampled_count": 365824, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6431633830070496}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8911774754524231}}}, "timesteps_this_iter": 74880, "done": false, "timesteps_total": 704640, "episodes_total": 3528, "training_iteration": 9, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-39-01", "timestamp": 1564907941, "time_this_iter_s": 30.39261031150818, "time_total_s": 274.1423428058624, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1776950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17769d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1776a60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1700d08>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 274.1423428058624, "timesteps_since_restore": 704640, "iterations_since_restore": 9, "num_healthy_workers": 4}
{"episode_reward_max": 44.81997014889113, "episode_reward_min": 41.910298482602954, "episode_reward_mean": 43.65557298876675, "episode_len_mean": 100.0, "episodes_this_iter": 376, "policy_reward_mean": {"agent_0": 22.933753463440443, "agent_1": 20.721819525326307}, "custom_metrics": {"delta0_mean": 0.28036715968364195, "delta0_min": 0.01954836016966014, "delta0_max": 0.4177877247136066, "delta1_mean": -0.35902483880740355, "delta1_min": -0.48291702776570206, "delta1_max": -0.2762838489643153, "price0_mean": 1.476236198844104, "price0_min": 1.4122572882867026, "price0_max": 1.5008874699086456, "price1_mean": 1.6090819228840527, "price1_min": 1.5203220723298423, "price1_max": 1.6503338018497182}, "sampler_perf": {"mean_env_wait_ms": 1.0785222470816425, "mean_processing_ms": 5.014414169818636, "mean_inference_ms": 2.02138845544977}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 31, "num_steps_trained": 1587456, "num_steps_sampled": 778240, "sample_throughput": 0.0, "train_throughput": 38317.815, "num_weight_syncs": 1519, "num_samples_dropped": 875, "learner_queue": {"size_count": 17813, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 11.271, "replay_time_ms": 73.297, "update_priorities_time_ms": 42.015, "policy_agent_0": {"added_count": 200960, "sampled_count": 405504, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 200960, "sampled_count": 405504, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6277211308479309}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8546861410140991}}}, "timesteps_this_iter": 73600, "done": false, "timesteps_total": 778240, "episodes_total": 3904, "training_iteration": 10, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-39-32", "timestamp": 1564907972, "time_this_iter_s": 30.477741241455078, "time_total_s": 304.6200840473175, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fad18a1f840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fad18a1fea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fad18a1f620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd170cb70>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 304.6200840473175, "timesteps_since_restore": 778240, "iterations_since_restore": 10, "num_healthy_workers": 4}
{"episode_reward_max": 50.9407248560557, "episode_reward_min": 41.77643976928882, "episode_reward_mean": 44.39164358710178, "episode_len_mean": 100.0, "episodes_this_iter": 368, "policy_reward_mean": {"agent_0": 22.635561112800136, "agent_1": 21.75608247430165}, "custom_metrics": {"delta0_mean": 0.2558386532615464, "delta0_min": 0.017154859767116816, "delta0_max": 0.3834289982033448, "delta1_mean": -0.3361386317286355, "delta1_min": -0.45067671370593004, "delta1_max": -0.2575821700530141, "price0_mean": 1.4752579783177708, "price0_min": 1.4163653525055035, "price0_max": 1.4978175749971805, "price1_mean": 1.5985076737033836, "price1_min": 1.517373458410868, "price1_max": 1.6367119216617796}, "sampler_perf": {"mean_env_wait_ms": 1.072214613255557, "mean_processing_ms": 5.0976300371773275, "mean_inference_ms": 2.0239588195465252}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 34, "num_steps_trained": 1751808, "num_steps_sampled": 852352, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 1663, "num_samples_dropped": 875, "learner_queue": {"size_count": 18455, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.719, "replay_time_ms": 94.708, "update_priorities_time_ms": 49.628, "policy_agent_0": {"added_count": 218240, "sampled_count": 448000, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 218240, "sampled_count": 448000, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5932043790817261}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.8103346824645996}}}, "timesteps_this_iter": 74112, "done": false, "timesteps_total": 852352, "episodes_total": 4272, "training_iteration": 11, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-40-02", "timestamp": 1564908002, "time_this_iter_s": 30.392526865005493, "time_total_s": 335.012610912323, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd170cf28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd170cea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1712048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd171b2f0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 335.012610912323, "timesteps_since_restore": 852352, "iterations_since_restore": 11, "num_healthy_workers": 4}
{"episode_reward_max": 59.47850500168156, "episode_reward_min": 40.76467779563641, "episode_reward_mean": 49.50459481057483, "episode_len_mean": 100.0, "episodes_this_iter": 368, "policy_reward_mean": {"agent_0": 25.15272449722961, "agent_1": 24.351870313345216}, "custom_metrics": {"delta0_mean": 0.2536772910122339, "delta0_min": 0.02306656943471728, "delta0_max": 0.3928490256377642, "delta1_mean": -0.29839683714304716, "delta1_min": -0.40867561992723644, "delta1_max": -0.2241015724104942, "price0_mean": 1.479997413428421, "price0_min": 1.4244189249400883, "price0_max": 1.507484049580187, "price1_mean": 1.5945950951106285, "price1_min": 1.5155252256926486, "price1_max": 1.635949110591014}, "sampler_perf": {"mean_env_wait_ms": 1.0703022940219218, "mean_processing_ms": 5.202603692003978, "mean_inference_ms": 2.019536054121738}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 38, "num_steps_trained": 1914624, "num_steps_sampled": 923648, "sample_throughput": 3271.07, "train_throughput": 0.0, "num_weight_syncs": 1803, "num_samples_dropped": 875, "learner_queue": {"size_count": 19091, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 13.019, "replay_time_ms": 84.442, "update_priorities_time_ms": 49.455, "policy_agent_0": {"added_count": 234752, "sampled_count": 488448, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 234752, "sampled_count": 488448, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5919323563575745}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7365335822105408}}}, "timesteps_this_iter": 71296, "done": false, "timesteps_total": 923648, "episodes_total": 4640, "training_iteration": 12, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-40-33", "timestamp": 1564908033, "time_this_iter_s": 30.418906211853027, "time_total_s": 365.431517124176, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176e7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17e7840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1776a60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1726158>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 365.431517124176, "timesteps_since_restore": 923648, "iterations_since_restore": 12, "num_healthy_workers": 4}
{"episode_reward_max": 58.96468874286563, "episode_reward_min": 45.86750530842987, "episode_reward_mean": 52.946957219155244, "episode_len_mean": 100.0, "episodes_this_iter": 352, "policy_reward_mean": {"agent_0": 27.129472464050558, "agent_1": 25.81748475510469}, "custom_metrics": {"delta0_mean": 0.2610146189524994, "delta0_min": 0.02938234901206305, "delta0_max": 0.405595161876397, "delta1_mean": -0.25887054522967684, "delta1_min": -0.3659095033314352, "delta1_max": -0.1807558720302439, "price0_mean": 1.486296722244855, "price0_min": 1.4334472077217075, "price0_max": 1.5144613003189, "price1_mean": 1.5941093720891857, "price1_min": 1.5156753602148167, "price1_max": 1.636556683379539}, "sampler_perf": {"mean_env_wait_ms": 1.068718207009792, "mean_processing_ms": 5.3077718276380415, "mean_inference_ms": 2.016702750069568}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 41, "num_steps_trained": 2077440, "num_steps_sampled": 993408, "sample_throughput": 3893.896, "train_throughput": 0.0, "num_weight_syncs": 1939, "num_samples_dropped": 875, "learner_queue": {"size_count": 19727, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.837, "replay_time_ms": 97.112, "update_priorities_time_ms": 45.321, "policy_agent_0": {"added_count": 250240, "sampled_count": 532480, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 250240, "sampled_count": 532480, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5493393540382385}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.7010320425033569}}}, "timesteps_this_iter": 69760, "done": false, "timesteps_total": 993408, "episodes_total": 4992, "training_iteration": 13, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-41-03", "timestamp": 1564908063, "time_this_iter_s": 30.550915718078613, "time_total_s": 395.98243284225464, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17261e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1726510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1726598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1722840>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 395.98243284225464, "timesteps_since_restore": 993408, "iterations_since_restore": 13, "num_healthy_workers": 4}
{"episode_reward_max": 62.16436949727947, "episode_reward_min": 56.49584468511879, "episode_reward_mean": 58.34284632334875, "episode_len_mean": 100.0, "episodes_this_iter": 336, "policy_reward_mean": {"agent_0": 30.2986024627563, "agent_1": 28.044243860592452}, "custom_metrics": {"delta0_mean": 0.2879390071928669, "delta0_min": 0.07080342913306145, "delta0_max": 0.42153953776174147, "delta1_mean": -0.21298303454993578, "delta1_min": -0.31665764155596426, "delta1_max": -0.1376651659284961, "price0_mean": 1.4967039273636027, "price0_min": 1.4461741433804705, "price0_max": 1.5234891627028382, "price1_mean": 1.5996818725391675, "price1_min": 1.5264309545372894, "price1_max": 1.6391984427861441}, "sampler_perf": {"mean_env_wait_ms": 1.0742283843846632, "mean_processing_ms": 5.428656119711719, "mean_inference_ms": 2.0255831342442048}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 44, "num_steps_trained": 2242560, "num_steps_sampled": 1060864, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2070, "num_samples_dropped": 875, "learner_queue": {"size_count": 20372, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 12.487, "replay_time_ms": 85.027, "update_priorities_time_ms": 44.896, "policy_agent_0": {"added_count": 268672, "sampled_count": 573696, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 268672, "sampled_count": 573696, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46023738384246826}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6124711036682129}}}, "timesteps_this_iter": 67456, "done": false, "timesteps_total": 1060864, "episodes_total": 5328, "training_iteration": 14, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-41-34", "timestamp": 1564908094, "time_this_iter_s": 30.425584316253662, "time_total_s": 426.4080171585083, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd171b2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd170cea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd170cf28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17376a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 426.4080171585083, "timesteps_since_restore": 1060864, "iterations_since_restore": 14, "num_healthy_workers": 4}
{"episode_reward_max": 61.425204664083935, "episode_reward_min": 57.82107651453801, "episode_reward_mean": 59.24330901798997, "episode_len_mean": 100.0, "episodes_this_iter": 336, "policy_reward_mean": {"agent_0": 30.76098123193963, "agent_1": 28.482327786050345}, "custom_metrics": {"delta0_mean": 0.3111475033918237, "delta0_min": 0.1085506596694764, "delta0_max": 0.43856977752022147, "delta1_mean": -0.1708568044569006, "delta1_min": -0.26791825958794696, "delta1_max": -0.10014993186519804, "price0_mean": 1.5061402134343822, "price0_min": 1.4588234818949888, "price0_max": 1.5315950331944874, "price1_mean": 1.6047809929757098, "price1_min": 1.5361605405921663, "price1_max": 1.6423008440783358}, "sampler_perf": {"mean_env_wait_ms": 1.0756098696358112, "mean_processing_ms": 5.5366671440666675, "mean_inference_ms": 2.0308904208061285}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 47, "num_steps_trained": 2408192, "num_steps_sampled": 1128064, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2202, "num_samples_dropped": 875, "learner_queue": {"size_count": 21019, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.063, "replay_time_ms": 102.621, "update_priorities_time_ms": 45.26, "policy_agent_0": {"added_count": 286976, "sampled_count": 614144, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 286976, "sampled_count": 614144, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37853747606277466}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5395760536193848}}}, "timesteps_this_iter": 67200, "done": false, "timesteps_total": 1128064, "episodes_total": 5664, "training_iteration": 15, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-42-04", "timestamp": 1564908124, "time_this_iter_s": 30.504231452941895, "time_total_s": 456.9122486114502, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1737a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17379d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1737ae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c0d90>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 456.9122486114502, "timesteps_since_restore": 1128064, "iterations_since_restore": 15, "num_healthy_workers": 4}
{"episode_reward_max": 62.04865894718468, "episode_reward_min": 57.820352832327856, "episode_reward_mean": 59.72785873311014, "episode_len_mean": 100.0, "episodes_this_iter": 328, "policy_reward_mean": {"agent_0": 31.365869544260843, "agent_1": 28.361989188849293}, "custom_metrics": {"delta0_mean": 0.33636277774866147, "delta0_min": 0.14540839776290918, "delta0_max": 0.4572605027349272, "delta1_mean": -0.13442332983436306, "delta1_min": -0.22714354995827757, "delta1_max": -0.0674362747661099, "price0_mean": 1.5149921070863086, "price0_min": 1.4699524225221845, "price0_max": 1.5392303292299407, "price1_mean": 1.6103829178485565, "price1_min": 1.5456865082959894, "price1_max": 1.6460189358743784}, "sampler_perf": {"mean_env_wait_ms": 1.079335278775311, "mean_processing_ms": 5.64536487169433, "mean_inference_ms": 2.0370808672416767}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 51, "num_steps_trained": 2574336, "num_steps_sampled": 1194624, "sample_throughput": 2667.112, "train_throughput": 0.0, "num_weight_syncs": 2332, "num_samples_dropped": 875, "learner_queue": {"size_count": 21670, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.461, "replay_time_ms": 83.87, "update_priorities_time_ms": 46.828, "policy_agent_0": {"added_count": 302592, "sampled_count": 654080, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 302592, "sampled_count": 654080, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33613598346710205}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46773430705070496}}}, "timesteps_this_iter": 66560, "done": false, "timesteps_total": 1194624, "episodes_total": 5992, "training_iteration": 16, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-42-35", "timestamp": 1564908155, "time_this_iter_s": 30.49649977684021, "time_total_s": 487.4087483882904, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176e7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17e7840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1726598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c9bf8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 487.4087483882904, "timesteps_since_restore": 1194624, "iterations_since_restore": 16, "num_healthy_workers": 4}
{"episode_reward_max": 61.11595435948844, "episode_reward_min": 53.78550913955699, "episode_reward_mean": 57.36243578471394, "episode_len_mean": 100.0, "episodes_this_iter": 328, "policy_reward_mean": {"agent_0": 28.49157266424279, "agent_1": 28.870863120471157}, "custom_metrics": {"delta0_mean": 0.34362077867601326, "delta0_min": 0.1652290690264111, "delta0_max": 0.45855367856661866, "delta1_mean": -0.09983638410155787, "delta1_min": -0.18610082972885486, "delta1_max": -0.03741937857977722, "price0_mean": 1.5217637426542046, "price0_min": 1.4795391802793711, "price0_max": 1.5447603023755714, "price1_mean": 1.611749212985258, "price1_min": 1.5509187297590339, "price1_max": 1.6455512881619152}, "sampler_perf": {"mean_env_wait_ms": 1.0781388466623572, "mean_processing_ms": 5.7438075447293135, "mean_inference_ms": 2.0388368899262295}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 54, "num_steps_trained": 2742016, "num_steps_sampled": 1260032, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2460, "num_samples_dropped": 875, "learner_queue": {"size_count": 22325, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 13.742, "replay_time_ms": 80.748, "update_priorities_time_ms": 43.065, "policy_agent_0": {"added_count": 319360, "sampled_count": 695296, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 319360, "sampled_count": 695296, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32206007838249207}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42393454909324646}}}, "timesteps_this_iter": 65408, "done": false, "timesteps_total": 1260032, "episodes_total": 6320, "training_iteration": 17, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-43-05", "timestamp": 1564908185, "time_this_iter_s": 30.477327823638916, "time_total_s": 517.8860762119293, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c9c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16da048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16da0d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16de378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 517.8860762119293, "timesteps_since_restore": 1260032, "iterations_since_restore": 17, "num_healthy_workers": 4}
{"episode_reward_max": 61.06905528190896, "episode_reward_min": 54.27913214523157, "episode_reward_mean": 57.92462340183566, "episode_len_mean": 100.0, "episodes_this_iter": 320, "policy_reward_mean": {"agent_0": 28.51433068142891, "agent_1": 29.41029272040675}, "custom_metrics": {"delta0_mean": 0.35211646074942526, "delta0_min": 0.18229491992142585, "delta0_max": 0.46141055939618925, "delta1_mean": -0.06671739183819189, "delta1_min": -0.14892947200438542, "delta1_max": -0.007633779437280226, "price0_mean": 1.5286325380953318, "price0_min": 1.488265634812565, "price0_max": 1.5505054716232782, "price1_mean": 1.6136017475699482, "price1_min": 1.5557602140348188, "price1_max": 1.6458219012538762}, "sampler_perf": {"mean_env_wait_ms": 1.0821036371041464, "mean_processing_ms": 5.834367823815052, "mean_inference_ms": 2.0410568555975517}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 57, "num_steps_trained": 2903552, "num_steps_sampled": 1325056, "sample_throughput": 0.0, "train_throughput": 14396.024, "num_weight_syncs": 2586, "num_samples_dropped": 875, "learner_queue": {"size_count": 22954, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.461, "replay_time_ms": 113.732, "update_priorities_time_ms": 52.598, "policy_agent_0": {"added_count": 336512, "sampled_count": 736000, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 336512, "sampled_count": 736000, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3206106424331665}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40475723147392273}}}, "timesteps_this_iter": 65024, "done": false, "timesteps_total": 1325056, "episodes_total": 6640, "training_iteration": 18, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-43-36", "timestamp": 1564908216, "time_this_iter_s": 30.468090772628784, "time_total_s": 548.3541669845581, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd171b2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1737ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17379d8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16ea1e0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 548.3541669845581, "timesteps_since_restore": 1325056, "iterations_since_restore": 18, "num_healthy_workers": 4}
{"episode_reward_max": 59.96686727509572, "episode_reward_min": 53.41795536301091, "episode_reward_mean": 56.21183573157836, "episode_len_mean": 100.0, "episodes_this_iter": 312, "policy_reward_mean": {"agent_0": 26.174298348054105, "agent_1": 30.03753738352426}, "custom_metrics": {"delta0_mean": 0.34900551374144184, "delta0_min": 0.1879063112626229, "delta0_max": 0.45387268698994576, "delta1_mean": -0.03505695705085667, "delta1_min": -0.11289003567234066, "delta1_max": 0.020533638259334734, "price0_mean": 1.5345176472677633, "price0_min": 1.4961702531335683, "price0_max": 1.5554093988141078, "price1_mean": 1.6129928120605803, "price1_min": 1.5579384804013126, "price1_max": 1.6438797518663364}, "sampler_perf": {"mean_env_wait_ms": 1.085388888169697, "mean_processing_ms": 5.954357151661824, "mean_inference_ms": 2.0385607078937755}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 61, "num_steps_trained": 3070976, "num_steps_sampled": 1388544, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2711, "num_samples_dropped": 875, "learner_queue": {"size_count": 23608, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.753, "replay_time_ms": 93.972, "update_priorities_time_ms": 40.307, "policy_agent_0": {"added_count": 353536, "sampled_count": 780288, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 353536, "sampled_count": 780288, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3329143822193146}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3677080273628235}}}, "timesteps_this_iter": 63488, "done": false, "timesteps_total": 1388544, "episodes_total": 6952, "training_iteration": 19, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-44-06", "timestamp": 1564908246, "time_this_iter_s": 30.438025951385498, "time_total_s": 578.7921929359436, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16ea598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16ea510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16ea620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16f38c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 578.7921929359436, "timesteps_since_restore": 1388544, "iterations_since_restore": 19, "num_healthy_workers": 4}
{"episode_reward_max": 61.467188039120686, "episode_reward_min": 52.73194706233119, "episode_reward_mean": 56.47095897389821, "episode_len_mean": 100.0, "episodes_this_iter": 320, "policy_reward_mean": {"agent_0": 26.131027650096847, "agent_1": 30.339931323801363}, "custom_metrics": {"delta0_mean": 0.34727206557141954, "delta0_min": 0.1934684095504488, "delta0_max": 0.4470510982675076, "delta1_mean": -0.004056358874193597, "delta1_min": -0.07846784586637483, "delta1_max": 0.048849126944970706, "price0_mean": 1.5405672197223441, "price0_min": 1.503830987512665, "price0_max": 1.5604456152062591, "price1_mean": 1.6128755283838658, "price1_min": 1.5602873940957342, "price1_max": 1.6423253403771345}, "sampler_perf": {"mean_env_wait_ms": 1.0873296545066726, "mean_processing_ms": 6.054184908519309, "mean_inference_ms": 2.036957068794425}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 64, "num_steps_trained": 3232000, "num_steps_sampled": 1452672, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2835, "num_samples_dropped": 875, "learner_queue": {"size_count": 24237, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.859, "replay_time_ms": 101.482, "update_priorities_time_ms": 54.37, "policy_agent_0": {"added_count": 371712, "sampled_count": 820480, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 371712, "sampled_count": 820480, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36225634813308716}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3467070758342743}}}, "timesteps_this_iter": 64128, "done": false, "timesteps_total": 1452672, "episodes_total": 7272, "training_iteration": 20, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-44-37", "timestamp": 1564908277, "time_this_iter_s": 30.43921661376953, "time_total_s": 609.2314095497131, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16de378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16da048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17e7840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16fc730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 609.2314095497131, "timesteps_since_restore": 1452672, "iterations_since_restore": 20, "num_healthy_workers": 4}
{"episode_reward_max": 61.778645624616765, "episode_reward_min": 54.765853099723564, "episode_reward_mean": 58.37264893540327, "episode_len_mean": 100.0, "episodes_this_iter": 312, "policy_reward_mean": {"agent_0": 27.570576826336094, "agent_1": 30.802072109067165}, "custom_metrics": {"delta0_mean": 0.3509635974411721, "delta0_min": 0.20279629138206576, "delta0_max": 0.44571154252919426, "delta1_mean": 0.025359611943047856, "delta1_min": -0.04762501519173293, "delta1_max": 0.07701179304277542, "price0_mean": 1.546674448515899, "price0_min": 1.5110003413973807, "price0_max": 1.5657254049585798, "price1_mean": 1.6141544605077143, "price1_min": 1.5636419784254543, "price1_max": 1.6421950532949305}, "sampler_perf": {"mean_env_wait_ms": 1.0893758196928174, "mean_processing_ms": 6.145466918926483, "mean_inference_ms": 2.0388369410013567}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 67, "num_steps_trained": 3390976, "num_steps_sampled": 1515904, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 2960, "num_samples_dropped": 875, "learner_queue": {"size_count": 24858, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.48, "replay_time_ms": 112.958, "update_priorities_time_ms": 47.842, "policy_agent_0": {"added_count": 387456, "sampled_count": 858880, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 387456, "sampled_count": 858880, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3708285093307495}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33590036630630493}}}, "timesteps_this_iter": 63232, "done": false, "timesteps_total": 1515904, "episodes_total": 7584, "training_iteration": 21, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-45-08", "timestamp": 1564908308, "time_this_iter_s": 30.508079290390015, "time_total_s": 639.7394888401031, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16fca60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16fcae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16fcb70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1682e18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 639.7394888401031, "timesteps_since_restore": 1515904, "iterations_since_restore": 21, "num_healthy_workers": 4}
{"episode_reward_max": 61.31290980212622, "episode_reward_min": 54.41767199751129, "episode_reward_mean": 59.050912836266875, "episode_len_mean": 100.0, "episodes_this_iter": 280, "policy_reward_mean": {"agent_0": 28.186783471297115, "agent_1": 30.864129364969767}, "custom_metrics": {"delta0_mean": 0.3540911573613661, "delta0_min": 0.2127686901605406, "delta0_max": 0.44857232943585157, "delta1_mean": 0.04968953984612979, "delta1_min": -0.01982368364957269, "delta1_max": 0.09828412735773749, "price0_mean": 1.5516476744919894, "price0_min": 1.5175041384722308, "price0_max": 1.5700649901043677, "price1_mean": 1.6153553072251814, "price1_min": 1.5669670673296783, "price1_max": 1.643004846350938}, "sampler_perf": {"mean_env_wait_ms": 1.0929726112175349, "mean_processing_ms": 6.258269723928525, "mean_inference_ms": 2.041978377900215}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 70, "num_steps_trained": 3556608, "num_steps_sampled": 1575680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3076, "num_samples_dropped": 875, "learner_queue": {"size_count": 25505, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.802, "replay_time_ms": 103.107, "update_priorities_time_ms": 53.465, "policy_agent_0": {"added_count": 405248, "sampled_count": 899584, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 405248, "sampled_count": 899584, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3814190626144409}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3189353346824646}}}, "timesteps_this_iter": 59776, "done": false, "timesteps_total": 1575680, "episodes_total": 7864, "training_iteration": 22, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-45-38", "timestamp": 1564908338, "time_this_iter_s": 30.51594066619873, "time_total_s": 670.2554295063019, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16f38c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16fc7b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd171b2f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1690c80>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 670.2554295063019, "timesteps_since_restore": 1575680, "iterations_since_restore": 22, "num_healthy_workers": 4}
{"episode_reward_max": 61.99358255733664, "episode_reward_min": 54.831528002791806, "episode_reward_mean": 59.726419583428594, "episode_len_mean": 100.0, "episodes_this_iter": 304, "policy_reward_mean": {"agent_0": 29.17135288327933, "agent_1": 30.555066700149276}, "custom_metrics": {"delta0_mean": 0.36386166696132566, "delta0_min": 0.22614043807300968, "delta0_max": 0.4528293952055132, "delta1_mean": 0.0736755912704619, "delta1_min": 0.00560271132357239, "delta1_max": 0.12137608716206227, "price0_mean": 1.5572098447865892, "price0_min": 1.5238274650178778, "price0_max": 1.5747608841868324, "price1_mean": 1.617914589427529, "price1_min": 1.5710225538807836, "price1_max": 1.6441177067464503}, "sampler_perf": {"mean_env_wait_ms": 1.0927518086273214, "mean_processing_ms": 6.3759993513837205, "mean_inference_ms": 2.040707698492729}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 74, "num_steps_trained": 3724288, "num_steps_sampled": 1634048, "sample_throughput": 0.0, "train_throughput": 27349.512, "num_weight_syncs": 3190, "num_samples_dropped": 875, "learner_queue": {"size_count": 26160, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.064, "replay_time_ms": 98.323, "update_priorities_time_ms": 44.037, "policy_agent_0": {"added_count": 418688, "sampled_count": 939264, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 418688, "sampled_count": 939264, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3683863878250122}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3107442855834961}}}, "timesteps_this_iter": 58368, "done": false, "timesteps_total": 1634048, "episodes_total": 8168, "training_iteration": 23, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-46-09", "timestamp": 1564908369, "time_this_iter_s": 30.636373281478882, "time_total_s": 700.8918027877808, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1697048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16970d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1697158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd169f400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 700.8918027877808, "timesteps_since_restore": 1634048, "iterations_since_restore": 23, "num_healthy_workers": 4}
{"episode_reward_max": 61.326446607632974, "episode_reward_min": 46.52607755290663, "episode_reward_mean": 58.731482583420565, "episode_len_mean": 100.0, "episodes_this_iter": 280, "policy_reward_mean": {"agent_0": 28.422276161007773, "agent_1": 30.309206422412796}, "custom_metrics": {"delta0_mean": 0.3663508602649209, "delta0_min": 0.2353359610238417, "delta0_max": 0.45327372248375225, "delta1_mean": 0.09298339867785853, "delta1_min": 0.028316292950836503, "delta1_max": 0.13868891249634602, "price0_mean": 1.5610922001891185, "price0_min": 1.529301804045464, "price0_max": 1.5781707628104855, "price1_mean": 1.6187766388860174, "price1_min": 1.5738512999222605, "price1_max": 1.6442239801409708}, "sampler_perf": {"mean_env_wait_ms": 1.0953234884002159, "mean_processing_ms": 6.48070411834924, "mean_inference_ms": 2.0472670776786694}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 77, "num_steps_trained": 3891712, "num_steps_sampled": 1691392, "sample_throughput": 0.0, "train_throughput": 18240.751, "num_weight_syncs": 3302, "num_samples_dropped": 875, "learner_queue": {"size_count": 26815, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 13.686, "replay_time_ms": 96.713, "update_priorities_time_ms": 49.914, "policy_agent_0": {"added_count": 432768, "sampled_count": 980224, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 432768, "sampled_count": 980224, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3783724308013916}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3109893202781677}}}, "timesteps_this_iter": 57344, "done": false, "timesteps_total": 1691392, "episodes_total": 8448, "training_iteration": 24, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-46-39", "timestamp": 1564908399, "time_this_iter_s": 30.542802810668945, "time_total_s": 731.4346055984497, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16da048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1682ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16de378>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16ab268>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 731.4346055984497, "timesteps_since_restore": 1691392, "iterations_since_restore": 24, "num_healthy_workers": 4}
{"episode_reward_max": 60.54633571204634, "episode_reward_min": 53.05801805815206, "episode_reward_mean": 57.51830491843667, "episode_len_mean": 100.0, "episodes_this_iter": 288, "policy_reward_mean": {"agent_0": 27.182642173029958, "agent_1": 30.33566274540671}, "custom_metrics": {"delta0_mean": 0.3664816415816994, "delta0_min": 0.24020243479894635, "delta0_max": 0.4513684192191144, "delta1_mean": 0.11187352526362718, "delta1_min": 0.05013357761229046, "delta1_max": 0.1555622101174809, "price0_mean": 1.5647040456322685, "price0_min": 1.5342016329256791, "price0_max": 1.5812962481513617, "price1_mean": 1.6189722806643634, "price1_min": 1.5756187679998992, "price1_max": 1.6438251331248512}, "sampler_perf": {"mean_env_wait_ms": 1.0959321321685624, "mean_processing_ms": 6.572788732755416, "mean_inference_ms": 2.047657014829219}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 80, "num_steps_trained": 4058368, "num_steps_sampled": 1748096, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3413, "num_samples_dropped": 875, "learner_queue": {"size_count": 27466, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.895, "replay_time_ms": 106.506, "update_priorities_time_ms": 50.973, "policy_agent_0": {"added_count": 448768, "sampled_count": 1022208, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 448768, "sampled_count": 1022208, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.369336873292923}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30488258600234985}}}, "timesteps_this_iter": 56704, "done": false, "timesteps_total": 1748096, "episodes_total": 8736, "training_iteration": 25, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-47-10", "timestamp": 1564908430, "time_this_iter_s": 30.38683032989502, "time_total_s": 761.8214359283447, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1690bf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1690e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1690620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16829d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 761.8214359283447, "timesteps_since_restore": 1748096, "iterations_since_restore": 25, "num_healthy_workers": 4}
{"episode_reward_max": 60.893602280008885, "episode_reward_min": 54.78349468389749, "episode_reward_mean": 58.92934235716891, "episode_len_mean": 100.0, "episodes_this_iter": 272, "policy_reward_mean": {"agent_0": 28.80503905733957, "agent_1": 30.124303299829347}, "custom_metrics": {"delta0_mean": 0.37142661946932787, "delta0_min": 0.24803546265156323, "delta0_max": 0.45412142781997644, "delta1_mean": 0.12812757586224705, "delta1_min": 0.06946400491716885, "delta1_max": 0.16935984903528992, "price0_mean": 1.5681976797083923, "price0_min": 1.5388987555351412, "price0_max": 1.584136764692799, "price1_mean": 1.6202486182289437, "price1_min": 1.5779280576079606, "price1_max": 1.644436688459725}, "sampler_perf": {"mean_env_wait_ms": 1.0972460768752086, "mean_processing_ms": 6.688160871704601, "mean_inference_ms": 2.0511855836284463}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 84, "num_steps_trained": 4227328, "num_steps_sampled": 1802880, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3521, "num_samples_dropped": 875, "learner_queue": {"size_count": 28126, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.195, "replay_time_ms": 89.202, "update_priorities_time_ms": 46.657, "policy_agent_0": {"added_count": 461440, "sampled_count": 1064192, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 461440, "sampled_count": 1064192, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3754405379295349}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3075941205024719}}}, "timesteps_this_iter": 54784, "done": false, "timesteps_total": 1802880, "episodes_total": 9008, "training_iteration": 26, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-47-40", "timestamp": 1564908460, "time_this_iter_s": 30.3783597946167, "time_total_s": 792.1997957229614, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1697158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16970d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1697048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16f38c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 792.1997957229614, "timesteps_since_restore": 1802880, "iterations_since_restore": 26, "num_healthy_workers": 4}
{"episode_reward_max": 60.16619153056024, "episode_reward_min": 53.08638157754687, "episode_reward_mean": 58.661256944238275, "episode_len_mean": 100.0, "episodes_this_iter": 288, "policy_reward_mean": {"agent_0": 29.249813472942417, "agent_1": 29.411443471295872}, "custom_metrics": {"delta0_mean": 0.3800602079777211, "delta0_min": 0.2589135389660241, "delta0_max": 0.4581113657855608, "delta1_mean": 0.14244489420667528, "delta1_min": 0.08491080489163297, "delta1_max": 0.18285769878799946, "price0_mean": 1.5716370860560263, "price0_min": 1.5427274709396137, "price0_max": 1.5868271818686426, "price1_mean": 1.6220950417594766, "price1_min": 1.5808316955603174, "price1_max": 1.6451052101082597}, "sampler_perf": {"mean_env_wait_ms": 1.0966832049638497, "mean_processing_ms": 6.783052255706862, "mean_inference_ms": 2.052907255909462}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 87, "num_steps_trained": 4386560, "num_steps_sampled": 1861376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3634, "num_samples_dropped": 875, "learner_queue": {"size_count": 28747, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.766, "replay_time_ms": 91.762, "update_priorities_time_ms": 42.139, "policy_agent_0": {"added_count": 476800, "sampled_count": 1103360, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 476800, "sampled_count": 1103360, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3641360402107239}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2914111912250519}}}, "timesteps_this_iter": 58496, "done": false, "timesteps_total": 1861376, "episodes_total": 9296, "training_iteration": 27, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-48-11", "timestamp": 1564908491, "time_this_iter_s": 30.44551134109497, "time_total_s": 822.6453070640564, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16f3c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16f3b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16f3ae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16eae18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 822.6453070640564, "timesteps_since_restore": 1861376, "iterations_since_restore": 27, "num_healthy_workers": 4}
{"episode_reward_max": 61.022219852370476, "episode_reward_min": 49.7342776534069, "episode_reward_mean": 57.32504314561062, "episode_len_mean": 100.0, "episodes_this_iter": 280, "policy_reward_mean": {"agent_0": 28.234354510774136, "agent_1": 29.090688634836482}, "custom_metrics": {"delta0_mean": 0.38240591406466795, "delta0_min": 0.2648651946229964, "delta0_max": 0.458691089461125, "delta1_mean": 0.15451111372008042, "delta1_min": 0.0987344168840181, "delta1_max": 0.19393217797388404, "price0_mean": 1.5739156772582525, "price0_min": 1.5459490611308757, "price0_max": 1.5888128008870888, "price1_mean": 1.6225259987001135, "price1_min": 1.5824125105903908, "price1_max": 1.644959935847273}, "sampler_perf": {"mean_env_wait_ms": 1.0993601756030569, "mean_processing_ms": 6.887219046467253, "mean_inference_ms": 2.0481634332552585}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 90, "num_steps_trained": 4548608, "num_steps_sampled": 1917568, "sample_throughput": 3393.6, "train_throughput": 0.0, "num_weight_syncs": 3744, "num_samples_dropped": 875, "learner_queue": {"size_count": 29381, "size_mean": 0.1, "size_std": 0.36055512754639896, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.368, "replay_time_ms": 66.054, "update_priorities_time_ms": 40.048, "policy_agent_0": {"added_count": 491392, "sampled_count": 1144320, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 491392, "sampled_count": 1144320, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3649933636188507}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30203109979629517}}}, "timesteps_this_iter": 56192, "done": false, "timesteps_total": 1917568, "episodes_total": 9576, "training_iteration": 28, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-48-41", "timestamp": 1564908521, "time_this_iter_s": 30.45071792602539, "time_total_s": 853.0960249900818, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16eaa60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16eaae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16ea7b8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16dabf8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 853.0960249900818, "timesteps_since_restore": 1917568, "iterations_since_restore": 28, "num_healthy_workers": 4}
{"episode_reward_max": 59.912629996995996, "episode_reward_min": 48.08426256740496, "episode_reward_mean": 57.91783139054213, "episode_len_mean": 100.0, "episodes_this_iter": 280, "policy_reward_mean": {"agent_0": 27.459883745357544, "agent_1": 30.457947645184582}, "custom_metrics": {"delta0_mean": 0.38321468199271075, "delta0_min": 0.26915586670541314, "delta0_max": 0.45679075239551803, "delta1_mean": 0.16937918838412247, "delta1_min": 0.11516078999150493, "delta1_max": 0.20770183231702274, "price0_mean": 1.5768485555250287, "price0_min": 1.5497419662129477, "price0_max": 1.5912472549067276, "price1_mean": 1.622878609155771, "price1_min": 1.584036589383681, "price1_max": 1.6445035205061507}, "sampler_perf": {"mean_env_wait_ms": 1.098693727380248, "mean_processing_ms": 6.982235994195511, "mean_inference_ms": 2.0493728275321397}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 93, "num_steps_trained": 4715008, "num_steps_sampled": 1972736, "sample_throughput": 11744.125, "train_throughput": 0.0, "num_weight_syncs": 3852, "num_samples_dropped": 875, "learner_queue": {"size_count": 30030, "size_mean": 0.22, "size_std": 0.41424630354415964, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.44, "replay_time_ms": 106.999, "update_priorities_time_ms": 52.997, "policy_agent_0": {"added_count": 505088, "sampled_count": 1183744, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 505088, "sampled_count": 1183744, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36625778675079346}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30019673705101013}}}, "timesteps_this_iter": 55168, "done": false, "timesteps_total": 1972736, "episodes_total": 9856, "training_iteration": 29, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-49-12", "timestamp": 1564908552, "time_this_iter_s": 30.428104639053345, "time_total_s": 883.5241296291351, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16f3b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16f3ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16f3c80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c9d90>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 883.5241296291351, "timesteps_since_restore": 1972736, "iterations_since_restore": 29, "num_healthy_workers": 4}
{"episode_reward_max": 61.01192342788313, "episode_reward_min": 53.17336059084814, "episode_reward_mean": 58.6218095796015, "episode_len_mean": 100.0, "episodes_this_iter": 272, "policy_reward_mean": {"agent_0": 27.84145382755054, "agent_1": 30.780355752050955}, "custom_metrics": {"delta0_mean": 0.3843319909940823, "delta0_min": 0.2743001550407245, "delta0_max": 0.4565747321892494, "delta1_mean": 0.1837541782783666, "delta1_min": 0.13116615919353397, "delta1_max": 0.22095853321098363, "price0_mean": 1.5797150070265142, "price0_min": 1.5534380451357575, "price0_max": 1.5938201296361652, "price1_mean": 1.6233865400944916, "price1_min": 1.5857733815564818, "price1_max": 1.6445631803175422}, "sampler_perf": {"mean_env_wait_ms": 1.0959638634094755, "mean_processing_ms": 7.079304622121153, "mean_inference_ms": 2.049853240282026}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 97, "num_steps_trained": 4880384, "num_steps_sampled": 2026624, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 3957, "num_samples_dropped": 875, "learner_queue": {"size_count": 30676, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.123, "replay_time_ms": 79.409, "update_priorities_time_ms": 38.324, "policy_agent_0": {"added_count": 517504, "sampled_count": 1223936, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 517504, "sampled_count": 1223936, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3687398433685303}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30671226978302}}}, "timesteps_this_iter": 53888, "done": false, "timesteps_total": 2026624, "episodes_total": 10128, "training_iteration": 30, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-49-43", "timestamp": 1564908583, "time_this_iter_s": 30.549980401992798, "time_total_s": 914.0741100311279, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c9598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c9510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c9a60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c08c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 914.0741100311279, "timesteps_since_restore": 2026624, "iterations_since_restore": 30, "num_healthy_workers": 4}
{"episode_reward_max": 60.52558107720817, "episode_reward_min": 56.986975115044714, "episode_reward_mean": 58.75977886045602, "episode_len_mean": 100.0, "episodes_this_iter": 280, "policy_reward_mean": {"agent_0": 27.759874369357547, "agent_1": 30.99990449109846}, "custom_metrics": {"delta0_mean": 0.3841711430827533, "delta0_min": 0.2784499801828945, "delta0_max": 0.45594290078011024, "delta1_mean": 0.1983124949287917, "delta1_min": 0.14868701894763753, "delta1_max": 0.23312875130803404, "price0_mean": 1.5825035675860297, "price0_min": 1.5575025969263145, "price0_max": 1.59622520230458, "price1_mean": 1.623702899009858, "price1_min": 1.5872532099265781, "price1_max": 1.6445689297087738}, "sampler_perf": {"mean_env_wait_ms": 1.0948903504150858, "mean_processing_ms": 7.1780793906269125, "mean_inference_ms": 2.048485302877412}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 100, "num_steps_trained": 5044480, "num_steps_sampled": 2079488, "sample_throughput": 0.0, "train_throughput": 7565.078, "num_weight_syncs": 4059, "num_samples_dropped": 875, "learner_queue": {"size_count": 31317, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.453, "replay_time_ms": 102.877, "update_priorities_time_ms": 47.44, "policy_agent_0": {"added_count": 530304, "sampled_count": 1265920, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 530304, "sampled_count": 1265920, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3670654296875}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30141034722328186}}}, "timesteps_this_iter": 52864, "done": false, "timesteps_total": 2079488, "episodes_total": 10408, "training_iteration": 31, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-50-13", "timestamp": 1564908613, "time_this_iter_s": 30.64309549331665, "time_total_s": 944.7172055244446, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16dabf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1697048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16970d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1737620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 944.7172055244446, "timesteps_since_restore": 2079488, "iterations_since_restore": 31, "num_healthy_workers": 4}
{"episode_reward_max": 59.779818583417324, "episode_reward_min": 57.00005095700054, "episode_reward_mean": 58.054194963878885, "episode_len_mean": 100.0, "episodes_this_iter": 256, "policy_reward_mean": {"agent_0": 26.500157939670864, "agent_1": 31.55403702420803}, "custom_metrics": {"delta0_mean": 0.38557249718612213, "delta0_min": 0.27958794426575295, "delta0_max": 0.45277394311503943, "delta1_mean": 0.21226558461283118, "delta1_min": 0.1628269162901432, "delta1_max": 0.24689539965430568, "price0_mean": 1.5856232916105601, "price0_min": 1.560651304034474, "price0_max": 1.5987769667761729, "price1_mean": 1.624277561082215, "price1_min": 1.5882258429877363, "price1_max": 1.644104614248662}, "sampler_perf": {"mean_env_wait_ms": 1.0978377289087544, "mean_processing_ms": 7.280225954767035, "mean_inference_ms": 2.0483719072580637}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 103, "num_steps_trained": 5203968, "num_steps_sampled": 2132352, "sample_throughput": 0.0, "train_throughput": 18711.519, "num_weight_syncs": 4163, "num_samples_dropped": 875, "learner_queue": {"size_count": 31941, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.654, "replay_time_ms": 106.455, "update_priorities_time_ms": 47.595, "policy_agent_0": {"added_count": 542208, "sampled_count": 1304832, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 542208, "sampled_count": 1304832, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3534677028656006}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30037206411361694}}}, "timesteps_this_iter": 52864, "done": false, "timesteps_total": 2132352, "episodes_total": 10664, "training_iteration": 32, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-50-44", "timestamp": 1564908644, "time_this_iter_s": 30.44646668434143, "time_total_s": 975.163672208786, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1737488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1737598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1737400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1726378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 975.163672208786, "timesteps_since_restore": 2132352, "iterations_since_restore": 32, "num_healthy_workers": 4}
{"episode_reward_max": 59.194955943766914, "episode_reward_min": 56.03321791690864, "episode_reward_mean": 57.805794163411306, "episode_len_mean": 100.0, "episodes_this_iter": 248, "policy_reward_mean": {"agent_0": 26.41431809180832, "agent_1": 31.391476071602984}, "custom_metrics": {"delta0_mean": 0.38349164571659855, "delta0_min": 0.28076643406116414, "delta0_max": 0.44960462369533966, "delta1_mean": 0.22470748979377164, "delta1_min": 0.17595682531773477, "delta1_max": 0.2587792904353955, "price0_mean": 1.587973623021308, "price0_min": 1.563541292872902, "price0_max": 1.6009825333130188, "price1_mean": 1.6241129010900826, "price1_min": 1.5890255799009165, "price1_max": 1.6435788509913838}, "sampler_perf": {"mean_env_wait_ms": 1.096409909966493, "mean_processing_ms": 7.392085504362751, "mean_inference_ms": 2.0525972654999682}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 106, "num_steps_trained": 5367808, "num_steps_sampled": 2183552, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4264, "num_samples_dropped": 875, "learner_queue": {"size_count": 32583, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.089, "replay_time_ms": 86.723, "update_priorities_time_ms": 42.421, "policy_agent_0": {"added_count": 553728, "sampled_count": 1347328, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 553728, "sampled_count": 1347328, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37001416087150574}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.28082171082496643}}}, "timesteps_this_iter": 51200, "done": false, "timesteps_total": 2183552, "episodes_total": 10912, "training_iteration": 33, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-51-14", "timestamp": 1564908674, "time_this_iter_s": 30.38348364830017, "time_total_s": 1005.5471558570862, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c08c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c9a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c9510>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd171b9d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1005.5471558570862, "timesteps_since_restore": 2183552, "iterations_since_restore": 33, "num_healthy_workers": 4}
{"episode_reward_max": 59.96910028804117, "episode_reward_min": 47.37953947912207, "episode_reward_mean": 55.685703029694196, "episode_len_mean": 100.0, "episodes_this_iter": 256, "policy_reward_mean": {"agent_0": 26.530772382947333, "agent_1": 29.15493064674687}, "custom_metrics": {"delta0_mean": 0.3816686105717123, "delta0_min": 0.2821890899461952, "delta0_max": 0.4470435028038459, "delta1_mean": 0.23240532581740223, "delta1_min": 0.18379007380328757, "delta1_max": 0.266460472824284, "price0_mean": 1.5891985123416228, "price0_min": 1.565209438687214, "price0_max": 1.6021601784353943, "price1_mean": 1.623729061403954, "price1_min": 1.589668446266863, "price1_max": 1.6429452597468206}, "sampler_perf": {"mean_env_wait_ms": 1.0959385903368224, "mean_processing_ms": 7.493861936131729, "mean_inference_ms": 2.052915193945968}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 110, "num_steps_trained": 5533440, "num_steps_sampled": 2235264, "sample_throughput": 3884.851, "train_throughput": 0.0, "num_weight_syncs": 4365, "num_samples_dropped": 875, "learner_queue": {"size_count": 33228, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.711, "replay_time_ms": 104.14, "update_priorities_time_ms": 50.615, "policy_agent_0": {"added_count": 565376, "sampled_count": 1391104, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 565376, "sampled_count": 1391104, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3935037851333618}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29650673270225525}}}, "timesteps_this_iter": 51712, "done": false, "timesteps_total": 2235264, "episodes_total": 11168, "training_iteration": 34, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-51-45", "timestamp": 1564908705, "time_this_iter_s": 30.729865312576294, "time_total_s": 1036.2770211696625, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd171bea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd171be18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd171bd90>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1712400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1036.2770211696625, "timesteps_since_restore": 2235264, "iterations_since_restore": 34, "num_healthy_workers": 4}
{"episode_reward_max": 58.14977054931113, "episode_reward_min": 26.09057802856682, "episode_reward_mean": 51.756151047040284, "episode_len_mean": 100.0, "episodes_this_iter": 248, "policy_reward_mean": {"agent_0": 25.31083639255084, "agent_1": 26.445314654489447}, "custom_metrics": {"delta0_mean": 0.37874948824847293, "delta0_min": 0.28136460238097066, "delta0_max": 0.44278394275803196, "delta1_mean": 0.2344247115848119, "delta1_min": 0.18247687657205422, "delta1_max": 0.2679242331103237, "price0_mean": 1.5891001664887678, "price0_min": 1.564967458980562, "price0_max": 1.6015455913641068, "price1_mean": 1.622460799792577, "price1_min": 1.5891405665436498, "price1_max": 1.6412461533536244}, "sampler_perf": {"mean_env_wait_ms": 1.098703042960484, "mean_processing_ms": 7.594885589301412, "mean_inference_ms": 2.0529710609596954}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 113, "num_steps_trained": 5700096, "num_steps_sampled": 2285952, "sample_throughput": 0.0, "train_throughput": 39796.22, "num_weight_syncs": 4464, "num_samples_dropped": 875, "learner_queue": {"size_count": 33878, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.086, "replay_time_ms": 82.155, "update_priorities_time_ms": 48.786, "policy_agent_0": {"added_count": 579968, "sampled_count": 1433344, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 579968, "sampled_count": 1433344, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41442596912384033}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3427670896053314}}}, "timesteps_this_iter": 50688, "done": false, "timesteps_total": 2285952, "episodes_total": 11416, "training_iteration": 35, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-52-16", "timestamp": 1564908736, "time_this_iter_s": 30.467106103897095, "time_total_s": 1066.7441272735596, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1726378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16dabf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1737400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd170c950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1066.7441272735596, "timesteps_since_restore": 2285952, "iterations_since_restore": 35, "num_healthy_workers": 4}
{"episode_reward_max": 58.70877527982629, "episode_reward_min": 53.44279073943677, "episode_reward_mean": 56.173294922886875, "episode_len_mean": 100.0, "episodes_this_iter": 248, "policy_reward_mean": {"agent_0": 25.198411742867307, "agent_1": 30.974883180019567}, "custom_metrics": {"delta0_mean": 0.37518064289738395, "delta0_min": 0.27970693558782167, "delta0_max": 0.4381895851786595, "delta1_mean": 0.24483760531376977, "delta1_min": 0.19371150141679674, "delta1_max": 0.27790639245119264, "price0_mean": 1.5909977252821639, "price0_min": 1.5673275911352664, "price0_max": 1.603245691320912, "price1_mean": 1.621809056502733, "price1_min": 1.5891772518715543, "price1_max": 1.6402760473309188}, "sampler_perf": {"mean_env_wait_ms": 1.0992974029623328, "mean_processing_ms": 7.708152327764281, "mean_inference_ms": 2.0533814614399963}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 116, "num_steps_trained": 5864448, "num_steps_sampled": 2335616, "sample_throughput": 0.0, "train_throughput": 11245.607, "num_weight_syncs": 4560, "num_samples_dropped": 875, "learner_queue": {"size_count": 34520, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.223, "replay_time_ms": 109.978, "update_priorities_time_ms": 49.682, "policy_agent_0": {"added_count": 591872, "sampled_count": 1473536, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 591872, "sampled_count": 1473536, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4115872383117676}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33840274810791016}}}, "timesteps_this_iter": 49664, "done": false, "timesteps_total": 2335616, "episodes_total": 11664, "training_iteration": 36, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-52-46", "timestamp": 1564908766, "time_this_iter_s": 30.658244371414185, "time_total_s": 1097.4023716449738, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd170c6a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd170c400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd170c1e0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1776620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1097.4023716449738, "timesteps_since_restore": 2335616, "iterations_since_restore": 36, "num_healthy_workers": 4}
{"episode_reward_max": 59.306632858759215, "episode_reward_min": 50.51336158708361, "episode_reward_mean": 56.30460130301963, "episode_len_mean": 100.0, "episodes_this_iter": 248, "policy_reward_mean": {"agent_0": 25.954473610177597, "agent_1": 30.350127692842044}, "custom_metrics": {"delta0_mean": 0.37315622352989203, "delta0_min": 0.2795340036749332, "delta0_max": 0.43432723322314504, "delta1_mean": 0.2536676457678776, "delta1_min": 0.20290555108990113, "delta1_max": 0.28669476355958057, "price0_mean": 1.592587463474798, "price0_min": 1.5692293857015067, "price0_max": 1.6046146679763322, "price1_mean": 1.6213797374303724, "price1_min": 1.5894669221923066, "price1_max": 1.6393495636981097}, "sampler_perf": {"mean_env_wait_ms": 1.1010472272674614, "mean_processing_ms": 7.801947384470181, "mean_inference_ms": 2.0495167944735058}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 120, "num_steps_trained": 6029824, "num_steps_sampled": 2384128, "sample_throughput": 11024.723, "train_throughput": 22049.445, "num_weight_syncs": 4655, "num_samples_dropped": 875, "learner_queue": {"size_count": 35166, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.719, "replay_time_ms": 86.617, "update_priorities_time_ms": 41.402, "policy_agent_0": {"added_count": 602496, "sampled_count": 1513984, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 602496, "sampled_count": 1513984, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4282635450363159}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33404436707496643}}}, "timesteps_this_iter": 48512, "done": false, "timesteps_total": 2384128, "episodes_total": 11912, "training_iteration": 37, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-53-17", "timestamp": 1564908797, "time_this_iter_s": 30.555732250213623, "time_total_s": 1127.9581038951874, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c08c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1712400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd171bd90>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176ef28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1127.9581038951874, "timesteps_since_restore": 2384128, "iterations_since_restore": 37, "num_healthy_workers": 4}
{"episode_reward_max": 55.57264297002797, "episode_reward_min": 50.24862359923569, "episode_reward_mean": 52.40548802802946, "episode_len_mean": 100.0, "episodes_this_iter": 240, "policy_reward_mean": {"agent_0": 23.310441065774892, "agent_1": 29.095046962254575}, "custom_metrics": {"delta0_mean": 0.3661052889318707, "delta0_min": 0.2753582811385789, "delta0_max": 0.42635225052156844, "delta1_mean": 0.25955749858845056, "delta1_min": 0.20978829776813948, "delta1_max": 0.29221819190316595, "price0_mean": 1.5932914631286912, "price0_min": 1.5704611883842354, "price0_max": 1.6051866783654414, "price1_mean": 1.619571245722257, "price1_min": 1.5885269457995959, "price1_max": 1.637239127951897}, "sampler_perf": {"mean_env_wait_ms": 1.1001280386249406, "mean_processing_ms": 7.913502822437488, "mean_inference_ms": 2.0519421886721876}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 123, "num_steps_trained": 6195200, "num_steps_sampled": 2431872, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4748, "num_samples_dropped": 875, "learner_queue": {"size_count": 35812, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.024, "replay_time_ms": 114.276, "update_priorities_time_ms": 50.061, "policy_agent_0": {"added_count": 613888, "sampled_count": 1555968, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 613888, "sampled_count": 1555968, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4582129418849945}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34108486771583557}}}, "timesteps_this_iter": 47744, "done": false, "timesteps_total": 2431872, "episodes_total": 12152, "training_iteration": 38, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-53-48", "timestamp": 1564908828, "time_this_iter_s": 30.661956071853638, "time_total_s": 1158.620059967041, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176eae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176eb70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176ea60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176b620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1158.620059967041, "timesteps_since_restore": 2431872, "iterations_since_restore": 38, "num_healthy_workers": 4}
{"episode_reward_max": 60.66213673996472, "episode_reward_min": 51.97916566812691, "episode_reward_mean": 56.6795558792462, "episode_len_mean": 100.0, "episodes_this_iter": 232, "policy_reward_mean": {"agent_0": 25.802669552810325, "agent_1": 30.876886326435866}, "custom_metrics": {"delta0_mean": 0.36476829458603177, "delta0_min": 0.27533308669236395, "delta0_max": 0.4231794499704523, "delta1_mean": 0.2681998959197218, "delta1_min": 0.2185811743292883, "delta1_max": 0.3007387667828324, "price0_mean": 1.594994179544109, "price0_min": 1.5724268000536634, "price0_max": 1.6066692528691715, "price1_mean": 1.6193781046388567, "price1_min": 1.5888442505164027, "price1_max": 1.6366007345063127}, "sampler_perf": {"mean_env_wait_ms": 1.1013199730866134, "mean_processing_ms": 8.011745145185374, "mean_inference_ms": 2.0533612997942474}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 126, "num_steps_trained": 6358016, "num_steps_sampled": 2478720, "sample_throughput": 0.0, "train_throughput": 29530.041, "num_weight_syncs": 4840, "num_samples_dropped": 875, "learner_queue": {"size_count": 36449, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.879, "replay_time_ms": 102.643, "update_priorities_time_ms": 46.782, "policy_agent_0": {"added_count": 625792, "sampled_count": 1596416, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 625792, "sampled_count": 1596416, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4527669847011566}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3131299316883087}}}, "timesteps_this_iter": 46848, "done": false, "timesteps_total": 2478720, "episodes_total": 12384, "training_iteration": 39, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-54-18", "timestamp": 1564908858, "time_this_iter_s": 30.560032606124878, "time_total_s": 1189.180092573166, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16dabf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1776620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1726378>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd175dc80>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1189.180092573166, "timesteps_since_restore": 2478720, "iterations_since_restore": 39, "num_healthy_workers": 4}
{"episode_reward_max": 61.19553362131881, "episode_reward_min": 55.81577462233002, "episode_reward_mean": 58.35548620940424, "episode_len_mean": 100.0, "episodes_this_iter": 232, "policy_reward_mean": {"agent_0": 27.550618447453765, "agent_1": 30.804867761950455}, "custom_metrics": {"delta0_mean": 0.36467425168327794, "delta0_min": 0.27875751389544284, "delta0_max": 0.42279744610517367, "delta1_mean": 0.27609992094676433, "delta1_min": 0.2280799154903334, "delta1_max": 0.3078038073530377, "price0_mean": 1.5964760614747802, "price0_min": 1.5746199803835192, "price0_max": 1.6080607560863642, "price1_mean": 1.6195309593404799, "price1_min": 1.5898425401148533, "price1_max": 1.636579711974248}, "sampler_perf": {"mean_env_wait_ms": 1.1018086511989933, "mean_processing_ms": 8.116676349584568, "mean_inference_ms": 2.0534418514003225}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 129, "num_steps_trained": 6523136, "num_steps_sampled": 2526080, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 4932, "num_samples_dropped": 875, "learner_queue": {"size_count": 37093, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.802, "replay_time_ms": 115.818, "update_priorities_time_ms": 56.77, "policy_agent_0": {"added_count": 637440, "sampled_count": 1636096, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 637440, "sampled_count": 1636096, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4507679045200348}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3014293909072876}}}, "timesteps_this_iter": 47360, "done": false, "timesteps_total": 2526080, "episodes_total": 12616, "training_iteration": 40, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-54-49", "timestamp": 1564908889, "time_this_iter_s": 30.811633348464966, "time_total_s": 1219.9917259216309, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd175dbf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd175db70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175d598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd174f1e0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1219.9917259216309, "timesteps_since_restore": 2526080, "iterations_since_restore": 40, "num_healthy_workers": 4}
{"episode_reward_max": 62.62473856313268, "episode_reward_min": 55.72837969116009, "episode_reward_mean": 58.5844679425831, "episode_len_mean": 100.0, "episodes_this_iter": 224, "policy_reward_mean": {"agent_0": 27.009818211733023, "agent_1": 31.574649730850073}, "custom_metrics": {"delta0_mean": 0.36535371235048647, "delta0_min": 0.28007170948761495, "delta0_max": 0.4220781812974367, "delta1_mean": 0.28493051248438, "delta1_min": 0.23711136564773297, "delta1_max": 0.31532096964570916, "price0_mean": 1.5983597577814126, "price0_min": 1.5767170830286497, "price0_max": 1.6096434603685048, "price1_mean": 1.6199293165421818, "price1_min": 1.5905590822435436, "price1_max": 1.6366031652557111}, "sampler_perf": {"mean_env_wait_ms": 1.1002908879143847, "mean_processing_ms": 8.223396904776822, "mean_inference_ms": 2.054559798742997}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 133, "num_steps_trained": 6688512, "num_steps_sampled": 2572160, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5022, "num_samples_dropped": 875, "learner_queue": {"size_count": 37740, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 23.617, "replay_time_ms": 94.71, "update_priorities_time_ms": 48.404, "policy_agent_0": {"added_count": 649856, "sampled_count": 1676544, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 649856, "sampled_count": 1676544, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44614270329475403}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30118221044540405}}}, "timesteps_this_iter": 46080, "done": false, "timesteps_total": 2572160, "episodes_total": 12840, "training_iteration": 41, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-55-20", "timestamp": 1564908920, "time_this_iter_s": 30.514601230621338, "time_total_s": 1250.5063271522522, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd175d0d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd175d8c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175d048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd174e730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1250.5063271522522, "timesteps_since_restore": 2572160, "iterations_since_restore": 41, "num_healthy_workers": 4}
{"episode_reward_max": 62.35156008670299, "episode_reward_min": 57.24200327175745, "episode_reward_mean": 59.566531667629974, "episode_len_mean": 100.0, "episodes_this_iter": 224, "policy_reward_mean": {"agent_0": 28.299598841441426, "agent_1": 31.266932826188565}, "custom_metrics": {"delta0_mean": 0.3674335870857214, "delta0_min": 0.28396604672217873, "delta0_max": 0.4224046660725341, "delta1_mean": 0.2928988911478055, "delta1_min": 0.24529110584046465, "delta1_max": 0.3227915993430969, "price0_mean": 1.600130804730766, "price0_min": 1.578753699374854, "price0_max": 1.6112377314722959, "price1_mean": 1.6206442745498666, "price1_min": 1.5917957422490263, "price1_max": 1.6368765720198777}, "sampler_perf": {"mean_env_wait_ms": 1.1001915253312156, "mean_processing_ms": 8.334336748753136, "mean_inference_ms": 2.0551675454587546}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 136, "num_steps_trained": 6854400, "num_steps_sampled": 2617216, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5110, "num_samples_dropped": 875, "learner_queue": {"size_count": 38387, "size_mean": 0.1, "size_std": 0.36055512754639896, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 21.944, "replay_time_ms": 113.174, "update_priorities_time_ms": 56.986, "policy_agent_0": {"added_count": 661632, "sampled_count": 1714688, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 661632, "sampled_count": 1714688, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43579256534576416}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2918685972690582}}}, "timesteps_this_iter": 45056, "done": false, "timesteps_total": 2617216, "episodes_total": 13064, "training_iteration": 42, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-55-51", "timestamp": 1564908951, "time_this_iter_s": 30.76141667366028, "time_total_s": 1281.2677438259125, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd174e1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fad1dc31840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fad1dc318c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16abbf8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1281.2677438259125, "timesteps_since_restore": 2617216, "iterations_since_restore": 42, "num_healthy_workers": 4}
{"episode_reward_max": 61.74417467164971, "episode_reward_min": 52.471199290626274, "episode_reward_mean": 58.22943379595742, "episode_len_mean": 100.0, "episodes_this_iter": 240, "policy_reward_mean": {"agent_0": 26.627342299766543, "agent_1": 31.602091496190884}, "custom_metrics": {"delta0_mean": 0.36590582940832783, "delta0_min": 0.28518843471174443, "delta0_max": 0.420992292818769, "delta1_mean": 0.3015592035129219, "delta1_min": 0.25550205246268176, "delta1_max": 0.3303542308816205, "price0_mean": 1.601839438681496, "price0_min": 1.581158084221124, "price0_max": 1.6127645221658504, "price1_mean": 1.6206380371282505, "price1_min": 1.5925143994932534, "price1_max": 1.6367678354514053}, "sampler_perf": {"mean_env_wait_ms": 1.1004426825979172, "mean_processing_ms": 8.425410944542977, "mean_inference_ms": 2.0553467984556058}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 139, "num_steps_trained": 7014912, "num_steps_sampled": 2664064, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5201, "num_samples_dropped": 875, "learner_queue": {"size_count": 39014, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.015, "replay_time_ms": 85.602, "update_priorities_time_ms": 47.264, "policy_agent_0": {"added_count": 674688, "sampled_count": 1754880, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 674688, "sampled_count": 1754880, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39508727192878723}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2788063883781433}}}, "timesteps_this_iter": 46848, "done": false, "timesteps_total": 2664064, "episodes_total": 13304, "training_iteration": 43, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-56-22", "timestamp": 1564908982, "time_this_iter_s": 30.72410488128662, "time_total_s": 1311.991848707199, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd175db70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd175d598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175dbf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd164d950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1311.991848707199, "timesteps_since_restore": 2664064, "iterations_since_restore": 43, "num_healthy_workers": 4}
{"episode_reward_max": 61.71168306615506, "episode_reward_min": 53.82610117489266, "episode_reward_mean": 57.363948170102596, "episode_len_mean": 100.0, "episodes_this_iter": 232, "policy_reward_mean": {"agent_0": 25.195042237151178, "agent_1": 32.168905932951425}, "custom_metrics": {"delta0_mean": 0.3647557655551352, "delta0_min": 0.2837167685942692, "delta0_max": 0.417281083292768, "delta1_mean": 0.3107999023899227, "delta1_min": 0.2650894966714098, "delta1_max": 0.339191326162179, "price0_mean": 1.603855885150873, "price0_min": 1.583239812768806, "price0_max": 1.6144699014088868, "price1_mean": 1.6206774435209663, "price1_min": 1.592732648070925, "price1_max": 1.6362570878254679}, "sampler_perf": {"mean_env_wait_ms": 1.1018070997077478, "mean_processing_ms": 8.523995753552764, "mean_inference_ms": 2.0539399057957906}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 143, "num_steps_trained": 7180032, "num_steps_sampled": 2708352, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5288, "num_samples_dropped": 875, "learner_queue": {"size_count": 39659, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 12.589, "replay_time_ms": 96.705, "update_priorities_time_ms": 46.096, "policy_agent_0": {"added_count": 685568, "sampled_count": 1796096, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 685568, "sampled_count": 1796096, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40326616168022156}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27620065212249756}}}, "timesteps_this_iter": 44288, "done": false, "timesteps_total": 2708352, "episodes_total": 13536, "training_iteration": 44, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-56-52", "timestamp": 1564909012, "time_this_iter_s": 30.732582330703735, "time_total_s": 1342.7244310379028, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd164dc80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd164dbf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd164dd08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1650f28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1342.7244310379028, "timesteps_since_restore": 2708352, "iterations_since_restore": 44, "num_healthy_workers": 4}
{"episode_reward_max": 63.22981568749936, "episode_reward_min": 53.70364378327149, "episode_reward_mean": 58.41935861382853, "episode_len_mean": 100.0, "episodes_this_iter": 216, "policy_reward_mean": {"agent_0": 26.286886034436318, "agent_1": 32.13247257939221}, "custom_metrics": {"delta0_mean": 0.36277617024364983, "delta0_min": 0.28487899198306527, "delta0_max": 0.41619379240319143, "delta1_mean": 0.3187678920072543, "delta1_min": 0.2744232974102439, "delta1_max": 0.3466898146792774, "price0_mean": 1.6054460869874967, "price0_min": 1.585365637128355, "price0_max": 1.6159426071016887, "price1_mean": 1.6206340633768304, "price1_min": 1.5937984305858817, "price1_max": 1.6362720657461876}, "sampler_perf": {"mean_env_wait_ms": 1.1031216614245853, "mean_processing_ms": 8.620931233848962, "mean_inference_ms": 2.054734748431675}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 146, "num_steps_trained": 7345152, "num_steps_sampled": 2753280, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5376, "num_samples_dropped": 875, "learner_queue": {"size_count": 40304, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.612, "replay_time_ms": 115.09, "update_priorities_time_ms": 52.556, "policy_agent_0": {"added_count": 696960, "sampled_count": 1837056, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 696960, "sampled_count": 1837056, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40207064151763916}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27828869223594666}}}, "timesteps_this_iter": 44928, "done": false, "timesteps_total": 2753280, "episodes_total": 13752, "training_iteration": 45, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-57-23", "timestamp": 1564909043, "time_this_iter_s": 30.771672248840332, "time_total_s": 1373.4961032867432, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd175d598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd175dbf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175db70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1659c80>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1373.4961032867432, "timesteps_since_restore": 2753280, "iterations_since_restore": 45, "num_healthy_workers": 4}
{"episode_reward_max": 62.50519507133747, "episode_reward_min": 49.9083991941959, "episode_reward_mean": 53.673534506502435, "episode_len_mean": 100.0, "episodes_this_iter": 216, "policy_reward_mean": {"agent_0": 23.014958509541547, "agent_1": 30.658575996960895}, "custom_metrics": {"delta0_mean": 0.3574292239225869, "delta0_min": 0.28065671722358365, "delta0_max": 0.4103456955457483, "delta1_mean": 0.32460032614831524, "delta1_min": 0.28121126555481063, "delta1_max": 0.35192867713483705, "price0_mean": 1.6065181909341277, "price0_min": 1.5867934494551381, "price0_max": 1.6168484109878605, "price1_mean": 1.6195292544083546, "price1_min": 1.593145197405493, "price1_max": 1.6350102209392627}, "sampler_perf": {"mean_env_wait_ms": 1.1032711476577528, "mean_processing_ms": 8.71672853916019, "mean_inference_ms": 2.054741033927115}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 149, "num_steps_trained": 7510272, "num_steps_sampled": 2797696, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5463, "num_samples_dropped": 875, "learner_queue": {"size_count": 40949, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.793, "replay_time_ms": 101.362, "update_priorities_time_ms": 49.283, "policy_agent_0": {"added_count": 707200, "sampled_count": 1877760, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 707200, "sampled_count": 1877760, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43189501762390137}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.26637062430381775}}}, "timesteps_this_iter": 44416, "done": false, "timesteps_total": 2797696, "episodes_total": 13968, "training_iteration": 46, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-57-54", "timestamp": 1564909074, "time_this_iter_s": 30.631388425827026, "time_total_s": 1404.1274917125702, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1659f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1663048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16630d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16662f0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1404.1274917125702, "timesteps_since_restore": 2797696, "iterations_since_restore": 46, "num_healthy_workers": 4}
{"episode_reward_max": 62.73331054153735, "episode_reward_min": 49.5185178665276, "episode_reward_mean": 54.781053643914476, "episode_len_mean": 100.0, "episodes_this_iter": 216, "policy_reward_mean": {"agent_0": 25.04022298317841, "agent_1": 29.740830660736055}, "custom_metrics": {"delta0_mean": 0.3549817113414284, "delta0_min": 0.2781842938207641, "delta0_max": 0.40791456612286014, "delta1_mean": 0.32900514036538625, "delta1_min": 0.28481626239559765, "delta1_max": 0.35645588576383, "price0_mean": 1.6072170170706928, "price0_min": 1.5873364706133395, "price0_max": 1.617590924760572, "price1_mean": 1.618908087481602, "price1_min": 1.5930377449591888, "price1_max": 1.6344347975396276}, "sampler_perf": {"mean_env_wait_ms": 1.1051648683468391, "mean_processing_ms": 8.818220707312962, "mean_inference_ms": 2.055067722682883}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 152, "num_steps_trained": 7676416, "num_steps_sampled": 2840704, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5547, "num_samples_dropped": 875, "learner_queue": {"size_count": 41598, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.091, "replay_time_ms": 115.532, "update_priorities_time_ms": 53.729, "policy_agent_0": {"added_count": 717184, "sampled_count": 1918464, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 717184, "sampled_count": 1918464, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4627470076084137}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2820734679698944}}}, "timesteps_this_iter": 43008, "done": false, "timesteps_total": 2840704, "episodes_total": 14184, "training_iteration": 47, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-58-25", "timestamp": 1564909105, "time_this_iter_s": 30.7644944190979, "time_total_s": 1434.891986131668, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1650840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1650d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1650950>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd164dea0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1434.891986131668, "timesteps_since_restore": 2840704, "iterations_since_restore": 47, "num_healthy_workers": 4}
{"episode_reward_max": 64.03537960506613, "episode_reward_min": 48.728668200830725, "episode_reward_mean": 56.602412578345756, "episode_len_mean": 100.0, "episodes_this_iter": 208, "policy_reward_mean": {"agent_0": 25.83224912985081, "agent_1": 30.77016344849494}, "custom_metrics": {"delta0_mean": 0.3543074163164131, "delta0_min": 0.2777941280468458, "delta0_max": 0.4061847042111157, "delta1_mean": 0.33450827590949994, "delta1_min": 0.2906501381075125, "delta1_max": 0.3615014983975007, "price0_mean": 1.6084081800729608, "price0_min": 1.5886850644215582, "price0_max": 1.6183895265747048, "price1_mean": 1.618889829501593, "price1_min": 1.593047447042255, "price1_max": 1.6340505504799947}, "sampler_perf": {"mean_env_wait_ms": 1.1055748989802414, "mean_processing_ms": 8.921319607847936, "mean_inference_ms": 2.0558067917259475}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 156, "num_steps_trained": 7840256, "num_steps_sampled": 2884224, "sample_throughput": 9167.095, "train_throughput": 18334.19, "num_weight_syncs": 5632, "num_samples_dropped": 875, "learner_queue": {"size_count": 42238, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.505, "replay_time_ms": 102.94, "update_priorities_time_ms": 48.272, "policy_agent_0": {"added_count": 728192, "sampled_count": 1958400, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 728192, "sampled_count": 1958400, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46969324350357056}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.28484010696411133}}}, "timesteps_this_iter": 43520, "done": false, "timesteps_total": 2884224, "episodes_total": 14392, "training_iteration": 48, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-58-55", "timestamp": 1564909135, "time_this_iter_s": 30.438786506652832, "time_total_s": 1465.330772638321, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd164d2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd164d8c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd164d840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16ab488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1465.330772638321, "timesteps_since_restore": 2884224, "iterations_since_restore": 48, "num_healthy_workers": 4}
{"episode_reward_max": 66.38571968984871, "episode_reward_min": 51.06260750748919, "episode_reward_mean": 60.98528739024212, "episode_len_mean": 100.0, "episodes_this_iter": 208, "policy_reward_mean": {"agent_0": 26.915744688411493, "agent_1": 34.06954270183064}, "custom_metrics": {"delta0_mean": 0.35443984479821855, "delta0_min": 0.27832180437695403, "delta0_max": 0.4055096714393652, "delta1_mean": 0.3439636773454136, "delta1_min": 0.301221563656702, "delta1_max": 0.3697247449449351, "price0_mean": 1.6106986807528965, "price0_min": 1.591380362811263, "price0_max": 1.620725024147463, "price1_mean": 1.6197297586291735, "price1_min": 1.593998191764055, "price1_max": 1.6347771018903134}, "sampler_perf": {"mean_env_wait_ms": 1.1047304491111003, "mean_processing_ms": 9.026872999040776, "mean_inference_ms": 2.0570498600594473}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 159, "num_steps_trained": 8002816, "num_steps_sampled": 2926592, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5714, "num_samples_dropped": 875, "learner_queue": {"size_count": 42874, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.663, "replay_time_ms": 98.069, "update_priorities_time_ms": 46.08, "policy_agent_0": {"added_count": 738560, "sampled_count": 1998080, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 738560, "sampled_count": 1998080, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47010183334350586}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27275529503822327}}}, "timesteps_this_iter": 42368, "done": false, "timesteps_total": 2926592, "episodes_total": 14600, "training_iteration": 49, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-59-26", "timestamp": 1564909166, "time_this_iter_s": 30.70034170150757, "time_total_s": 1496.0311143398285, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1663048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16630d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1650950>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd174e268>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1496.0311143398285, "timesteps_since_restore": 2926592, "iterations_since_restore": 49, "num_healthy_workers": 4}
{"episode_reward_max": 67.24043937014355, "episode_reward_min": 60.02919142978999, "episode_reward_mean": 64.4771032679943, "episode_len_mean": 100.0, "episodes_this_iter": 200, "policy_reward_mean": {"agent_0": 28.567157938818344, "agent_1": 35.90994532917594}, "custom_metrics": {"delta0_mean": 0.3571787714175912, "delta0_min": 0.2815685301459741, "delta0_max": 0.4070971792768235, "delta1_mean": 0.3550874521773347, "delta1_min": 0.3122532534417627, "delta1_max": 0.3809083138397744, "price0_mean": 1.6138607121699122, "price0_min": 1.5945601893343957, "price0_max": 1.6238347393994126, "price1_mean": 1.6216701981797133, "price1_min": 1.5961236540034665, "price1_max": 1.6365119761969362}, "sampler_perf": {"mean_env_wait_ms": 1.1059801022423554, "mean_processing_ms": 9.130078715371559, "mean_inference_ms": 2.0586306911947867}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 162, "num_steps_trained": 8168448, "num_steps_sampled": 2968576, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5796, "num_samples_dropped": 875, "learner_queue": {"size_count": 43520, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.407, "replay_time_ms": 125.629, "update_priorities_time_ms": 59.99, "policy_agent_0": {"added_count": 748288, "sampled_count": 2039296, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 748288, "sampled_count": 2039296, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44541263580322266}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.272853821516037}}}, "timesteps_this_iter": 41984, "done": false, "timesteps_total": 2968576, "episodes_total": 14800, "training_iteration": 50, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_08-59-57", "timestamp": 1564909197, "time_this_iter_s": 30.786289930343628, "time_total_s": 1526.8174042701721, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd174e598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd174e510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd174eae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd175d488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1526.8174042701721, "timesteps_since_restore": 2968576, "iterations_since_restore": 50, "num_healthy_workers": 4}
{"episode_reward_max": 66.29214437761632, "episode_reward_min": 58.99002659855872, "episode_reward_mean": 63.84155545441356, "episode_len_mean": 100.0, "episodes_this_iter": 200, "policy_reward_mean": {"agent_0": 28.05426337434562, "agent_1": 35.787292080067935}, "custom_metrics": {"delta0_mean": 0.3573614291073537, "delta0_min": 0.28411011904392125, "delta0_max": 0.4075521349616925, "delta1_mean": 0.3655708146681384, "delta1_min": 0.3238960194263969, "delta1_max": 0.3906291057191826, "price0_mean": 1.6165761572960125, "price0_min": 1.597845901207698, "price0_max": 1.6262950559062537, "price1_mean": 1.6229950168328577, "price1_min": 1.5979287059506295, "price1_max": 1.6376356262193368}, "sampler_perf": {"mean_env_wait_ms": 1.1055992571087927, "mean_processing_ms": 9.233760499377965, "mean_inference_ms": 2.062305200678271}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 165, "num_steps_trained": 8326144, "num_steps_sampled": 3008256, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 5874, "num_samples_dropped": 875, "learner_queue": {"size_count": 44137, "size_mean": 0.22, "size_std": 0.45999999999999996, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 21.703, "replay_time_ms": 115.215, "update_priorities_time_ms": 55.616, "policy_agent_0": {"added_count": 758656, "sampled_count": 2077184, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 758656, "sampled_count": 2077184, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4177647829055786}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.24950361251831055}}}, "timesteps_this_iter": 39680, "done": false, "timesteps_total": 3008256, "episodes_total": 15000, "training_iteration": 51, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-00-28", "timestamp": 1564909228, "time_this_iter_s": 30.861348628997803, "time_total_s": 1557.67875289917, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16ab400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16ab488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16ab268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176ba60>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1557.67875289917, "timesteps_since_restore": 3008256, "iterations_since_restore": 51, "num_healthy_workers": 4}
{"episode_reward_max": 66.76803312502467, "episode_reward_min": 62.57061268208517, "episode_reward_mean": 65.07440746402084, "episode_len_mean": 100.0, "episodes_this_iter": 208, "policy_reward_mean": {"agent_0": 29.588710604241705, "agent_1": 35.48569685977914}, "custom_metrics": {"delta0_mean": 0.3601506519142145, "delta0_min": 0.28865310847237685, "delta0_max": 0.4098013050171485, "delta1_mean": 0.3759621570679326, "delta1_min": 0.3357473081332341, "delta1_max": 0.3997753066777916, "price0_mean": 1.6196556578732821, "price0_min": 1.6014546993130987, "price0_max": 1.6289866973439753, "price1_mean": 1.625032921561278, "price1_min": 1.6003387772727393, "price1_max": 1.639327213496437}, "sampler_perf": {"mean_env_wait_ms": 1.1051172787814185, "mean_processing_ms": 9.324857515156253, "mean_inference_ms": 2.062980524879049}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 169, "num_steps_trained": 8489472, "num_steps_sampled": 3050240, "sample_throughput": 0.0, "train_throughput": 10729.693, "num_weight_syncs": 5955, "num_samples_dropped": 875, "learner_queue": {"size_count": 44776, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.119, "replay_time_ms": 111.299, "update_priorities_time_ms": 53.949, "policy_agent_0": {"added_count": 770560, "sampled_count": 2117120, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 770560, "sampled_count": 2117120, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37407317757606506}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.24238291382789612}}}, "timesteps_this_iter": 41984, "done": false, "timesteps_total": 3050240, "episodes_total": 15208, "training_iteration": 52, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-00-59", "timestamp": 1564909259, "time_this_iter_s": 30.81093716621399, "time_total_s": 1588.489690065384, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176bae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176bd08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176b9d8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176e400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1588.489690065384, "timesteps_since_restore": 3050240, "iterations_since_restore": 52, "num_healthy_workers": 4}
{"episode_reward_max": 66.31901135422082, "episode_reward_min": 61.74140110448519, "episode_reward_mean": 63.93240891840152, "episode_len_mean": 100.0, "episodes_this_iter": 208, "policy_reward_mean": {"agent_0": 29.350406707733864, "agent_1": 34.58200221066765}, "custom_metrics": {"delta0_mean": 0.36426640107036046, "delta0_min": 0.29249648329612776, "delta0_max": 0.4120766150310462, "delta1_mean": 0.38501017222975936, "delta1_min": 0.34538486123771966, "delta1_max": 0.4082681213912896, "price0_mean": 1.6223386020563946, "price0_min": 1.6042553431596924, "price0_max": 1.6313895526785807, "price1_mean": 1.626888284609329, "price1_min": 1.6023312383665538, "price1_max": 1.6407567990759442}, "sampler_perf": {"mean_env_wait_ms": 1.1069589145881018, "mean_processing_ms": 9.416838925159256, "mean_inference_ms": 2.062560127966933}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 172, "num_steps_trained": 8649984, "num_steps_sampled": 3091456, "sample_throughput": 5413.861, "train_throughput": 5413.861, "num_weight_syncs": 6036, "num_samples_dropped": 875, "learner_queue": {"size_count": 45403, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.568, "replay_time_ms": 97.056, "update_priorities_time_ms": 46.004, "policy_agent_0": {"added_count": 779648, "sampled_count": 2157312, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 779648, "sampled_count": 2157312, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3504222631454468}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.22816933691501617}}}, "timesteps_this_iter": 41216, "done": false, "timesteps_total": 3091456, "episodes_total": 15416, "training_iteration": 53, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-01-30", "timestamp": 1564909290, "time_this_iter_s": 30.41667866706848, "time_total_s": 1618.9063687324524, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176e1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176e620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176e8c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17000d0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1618.9063687324524, "timesteps_since_restore": 3091456, "iterations_since_restore": 53, "num_healthy_workers": 4}
{"episode_reward_max": 65.64081573456058, "episode_reward_min": 61.88056925538849, "episode_reward_mean": 63.60972319501427, "episode_len_mean": 100.0, "episodes_this_iter": 200, "policy_reward_mean": {"agent_0": 29.481715970832784, "agent_1": 34.128007224181495}, "custom_metrics": {"delta0_mean": 0.3677653866816617, "delta0_min": 0.2963045572921417, "delta0_max": 0.414319984312972, "delta1_mean": 0.392959061095887, "delta1_min": 0.3534387936242722, "delta1_max": 0.4162930511735984, "price0_mean": 1.6246165050338879, "price0_min": 1.606600820480195, "price0_max": 1.633578553402373, "price1_mean": 1.6284362927669958, "price1_min": 1.6041275211863864, "price1_max": 1.6420475948472608}, "sampler_perf": {"mean_env_wait_ms": 1.107689547340712, "mean_processing_ms": 9.523089866512763, "mean_inference_ms": 2.061454269450439}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 175, "num_steps_trained": 8813824, "num_steps_sampled": 3132032, "sample_throughput": 5258.337, "train_throughput": 10516.673, "num_weight_syncs": 6116, "num_samples_dropped": 875, "learner_queue": {"size_count": 46042, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.219, "replay_time_ms": 112.955, "update_priorities_time_ms": 51.119, "policy_agent_0": {"added_count": 791552, "sampled_count": 2198272, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 791552, "sampled_count": 2198272, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.326800137758255}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.23687982559204102}}}, "timesteps_this_iter": 40576, "done": false, "timesteps_total": 3132032, "episodes_total": 15616, "training_iteration": 54, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-02-00", "timestamp": 1564909320, "time_this_iter_s": 30.560830116271973, "time_total_s": 1649.4671988487244, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176bd08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176b9d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176bae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd170c950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1649.4671988487244, "timesteps_since_restore": 3132032, "iterations_since_restore": 54, "num_healthy_workers": 4}
{"episode_reward_max": 64.05341697210065, "episode_reward_min": 61.09089402869927, "episode_reward_mean": 62.44923386814242, "episode_len_mean": 100.0, "episodes_this_iter": 200, "policy_reward_mean": {"agent_0": 29.857241031070586, "agent_1": 32.59199283707183}, "custom_metrics": {"delta0_mean": 0.3698491465003135, "delta0_min": 0.3005967999017911, "delta0_max": 0.4168242728493166, "delta1_mean": 0.3989106730073529, "delta1_min": 0.3601792620238953, "delta1_max": 0.421752006560124, "price0_mean": 1.6261197000570333, "price0_min": 1.6085338514809, "price0_max": 1.635033692646709, "price1_mean": 1.629380160529042, "price1_min": 1.605517587514929, "price1_max": 1.6429818919469439}, "sampler_perf": {"mean_env_wait_ms": 1.1075896431286194, "mean_processing_ms": 9.616321158765825, "mean_inference_ms": 2.0607086786893216}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 178, "num_steps_trained": 8979968, "num_steps_sampled": 3172480, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6194, "num_samples_dropped": 875, "learner_queue": {"size_count": 46690, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.678, "replay_time_ms": 109.387, "update_priorities_time_ms": 56.141, "policy_agent_0": {"added_count": 801024, "sampled_count": 2241792, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 801024, "sampled_count": 2241792, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.323009729385376}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2382715791463852}}}, "timesteps_this_iter": 40448, "done": false, "timesteps_total": 3172480, "episodes_total": 15816, "training_iteration": 55, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-02-31", "timestamp": 1564909351, "time_this_iter_s": 30.832948684692383, "time_total_s": 1680.3001475334167, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd170cf28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd170cb70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd170c620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1712b70>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1680.3001475334167, "timesteps_since_restore": 3172480, "iterations_since_restore": 55, "num_healthy_workers": 4}
{"episode_reward_max": 62.77976133702183, "episode_reward_min": 60.41044109796386, "episode_reward_mean": 61.344881883079914, "episode_len_mean": 100.0, "episodes_this_iter": 200, "policy_reward_mean": {"agent_0": 29.655186069137063, "agent_1": 31.689695813942855}, "custom_metrics": {"delta0_mean": 0.37395644729506805, "delta0_min": 0.3041632462759587, "delta0_max": 0.41931575951676403, "delta1_mean": 0.4038104015929911, "delta1_min": 0.36520742135681966, "delta1_max": 0.42659657459713496, "price0_mean": 1.627518941025814, "price0_min": 1.6099171770105942, "price0_max": 1.6362664041349486, "price1_mean": 1.6304946589881721, "price1_min": 1.6067935057466958, "price1_max": 1.6437694705691002}, "sampler_perf": {"mean_env_wait_ms": 1.1081256631581977, "mean_processing_ms": 9.71405316249704, "mean_inference_ms": 2.0631497589826955}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 182, "num_steps_trained": 9147648, "num_steps_sampled": 3211648, "sample_throughput": 0.0, "train_throughput": 12018.601, "num_weight_syncs": 6272, "num_samples_dropped": 875, "learner_queue": {"size_count": 47346, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.796, "replay_time_ms": 101.039, "update_priorities_time_ms": 45.306, "policy_agent_0": {"added_count": 811776, "sampled_count": 2283008, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 811776, "sampled_count": 2283008, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3270546793937683}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.23261362314224243}}}, "timesteps_this_iter": 39168, "done": false, "timesteps_total": 3211648, "episodes_total": 16016, "training_iteration": 56, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-03-02", "timestamp": 1564909382, "time_this_iter_s": 30.763001680374146, "time_total_s": 1711.063149213791, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17000d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16ab268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16ab488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd171ba60>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1711.063149213791, "timesteps_since_restore": 3211648, "iterations_since_restore": 56, "num_healthy_workers": 4}
{"episode_reward_max": 63.58440542506204, "episode_reward_min": 57.875330285010634, "episode_reward_mean": 61.20982830748537, "episode_len_mean": 100.0, "episodes_this_iter": 192, "policy_reward_mean": {"agent_0": 29.083587948586118, "agent_1": 32.126240358899246}, "custom_metrics": {"delta0_mean": 0.37436579568506945, "delta0_min": 0.3072641757803317, "delta0_max": 0.42085948660371864, "delta1_mean": 0.4087624329934121, "delta1_min": 0.37114656985828937, "delta1_max": 0.43095330839644497, "price0_mean": 1.6285740959909554, "price0_min": 1.611500543402555, "price0_max": 1.6373163868347398, "price1_mean": 1.6309272467564864, "price1_min": 1.6076983012149089, "price1_max": 1.644327380117909}, "sampler_perf": {"mean_env_wait_ms": 1.1086840440660097, "mean_processing_ms": 9.803248947237917, "mean_inference_ms": 2.064487923245165}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 185, "num_steps_trained": 9316864, "num_steps_sampled": 3250688, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6347, "num_samples_dropped": 875, "learner_queue": {"size_count": 48006, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.194, "replay_time_ms": 103.377, "update_priorities_time_ms": 46.886, "policy_agent_0": {"added_count": 821760, "sampled_count": 2327040, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 821760, "sampled_count": 2327040, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3244004249572754}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.234022855758667}}}, "timesteps_this_iter": 39040, "done": false, "timesteps_total": 3250688, "episodes_total": 16208, "training_iteration": 57, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-03-33", "timestamp": 1564909413, "time_this_iter_s": 30.872931003570557, "time_total_s": 1741.9360802173615, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1726048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1726c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1726bf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1722950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1741.9360802173615, "timesteps_since_restore": 3250688, "iterations_since_restore": 57, "num_healthy_workers": 4}
{"episode_reward_max": 62.0066446037467, "episode_reward_min": 58.59247860839896, "episode_reward_mean": 60.6428567035053, "episode_len_mean": 100.0, "episodes_this_iter": 184, "policy_reward_mean": {"agent_0": 29.617756799983304, "agent_1": 31.025099903521994}, "custom_metrics": {"delta0_mean": 0.3775048967461423, "delta0_min": 0.3107290185581682, "delta0_max": 0.4228724690246582, "delta1_mean": 0.4123642835095879, "delta1_min": 0.3752735891963964, "delta1_max": 0.43415895343860017, "price0_mean": 1.6295476308638612, "price0_min": 1.6126351450339178, "price0_max": 1.6381199173425725, "price1_mean": 1.631704351279727, "price1_min": 1.608607752031994, "price1_max": 1.6448519946652524}, "sampler_perf": {"mean_env_wait_ms": 1.1092901888083662, "mean_processing_ms": 9.906271840303598, "mean_inference_ms": 2.0663498326022487}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 188, "num_steps_trained": 9482752, "num_steps_sampled": 3290496, "sample_throughput": 0.0, "train_throughput": 16883.795, "num_weight_syncs": 6425, "num_samples_dropped": 875, "learner_queue": {"size_count": 48654, "size_mean": 0.28, "size_std": 0.6013318551349163, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 19.92, "replay_time_ms": 91.305, "update_priorities_time_ms": 43.47, "policy_agent_0": {"added_count": 831360, "sampled_count": 2368256, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 831360, "sampled_count": 2368256, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3240838944911957}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2571508586406708}}}, "timesteps_this_iter": 39808, "done": false, "timesteps_total": 3290496, "episodes_total": 16392, "training_iteration": 58, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-04-04", "timestamp": 1564909444, "time_this_iter_s": 30.42073702812195, "time_total_s": 1772.3568172454834, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1712b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd170c620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd170cb70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1737730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1772.3568172454834, "timesteps_since_restore": 3290496, "iterations_since_restore": 58, "num_healthy_workers": 4}
{"episode_reward_max": 63.76820637468034, "episode_reward_min": 57.415603099379055, "episode_reward_mean": 60.34292625721446, "episode_len_mean": 100.0, "episodes_this_iter": 208, "policy_reward_mean": {"agent_0": 29.159205196332103, "agent_1": 31.183721060882355}, "custom_metrics": {"delta0_mean": 0.38042771627428107, "delta0_min": 0.3138630495118762, "delta0_max": 0.424728247923693, "delta1_mean": 0.41650368528636494, "delta1_min": 0.3798863911543533, "delta1_max": 0.437910886760966, "price0_mean": 1.6306159581503923, "price0_min": 1.6138568805882523, "price0_max": 1.6390031206714946, "price1_mean": 1.6324519605564032, "price1_min": 1.6095117551350855, "price1_max": 1.6453379525927596}, "sampler_perf": {"mean_env_wait_ms": 1.1094158151312226, "mean_processing_ms": 10.001686740827605, "mean_inference_ms": 2.0666206451049}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 192, "num_steps_trained": 9648128, "num_steps_sampled": 3329024, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6501, "num_samples_dropped": 875, "learner_queue": {"size_count": 49300, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 23.054, "replay_time_ms": 109.949, "update_priorities_time_ms": 52.685, "policy_agent_0": {"added_count": 842624, "sampled_count": 2408960, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 842624, "sampled_count": 2408960, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31729426980018616}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2774917483329773}}}, "timesteps_this_iter": 38528, "done": false, "timesteps_total": 3329024, "episodes_total": 16600, "training_iteration": 59, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-04-35", "timestamp": 1564909475, "time_this_iter_s": 31.02843737602234, "time_total_s": 1803.3852546215057, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1737d90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1737d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17378c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c9e18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1803.3852546215057, "timesteps_since_restore": 3329024, "iterations_since_restore": 59, "num_healthy_workers": 4}
{"episode_reward_max": 63.33506637493935, "episode_reward_min": 51.78886360567042, "episode_reward_mean": 59.841600197841366, "episode_len_mean": 100.0, "episodes_this_iter": 192, "policy_reward_mean": {"agent_0": 27.731621807019028, "agent_1": 32.10997839082234}, "custom_metrics": {"delta0_mean": 0.3810640067586766, "delta0_min": 0.31535303250247093, "delta0_max": 0.424565839553349, "delta1_mean": 0.4211688117380277, "delta1_min": 0.38506378081011816, "delta1_max": 0.44216728138206973, "price0_mean": 1.6316574230165444, "price0_min": 1.6151149121588995, "price0_max": 1.6399335574833493, "price1_mean": 1.632791120670005, "price1_min": 1.6100748755379242, "price1_max": 1.6454516700103052}, "sampler_perf": {"mean_env_wait_ms": 1.10956702828383, "mean_processing_ms": 10.09179021847419, "mean_inference_ms": 2.0673518835679023}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 195, "num_steps_trained": 9814272, "num_steps_sampled": 3367936, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6577, "num_samples_dropped": 875, "learner_queue": {"size_count": 49949, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.093, "replay_time_ms": 102.569, "update_priorities_time_ms": 47.712, "policy_agent_0": {"added_count": 852352, "sampled_count": 2450432, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 852352, "sampled_count": 2450432, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3279641270637512}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2704864740371704}}}, "timesteps_this_iter": 38912, "done": false, "timesteps_total": 3367936, "episodes_total": 16792, "training_iteration": 60, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-05-06", "timestamp": 1564909506, "time_this_iter_s": 30.860673904418945, "time_total_s": 1834.2459285259247, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1722950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd171ba60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd171b2f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1690c80>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1834.2459285259247, "timesteps_since_restore": 3367936, "iterations_since_restore": 60, "num_healthy_workers": 4}
{"episode_reward_max": 61.48037338999756, "episode_reward_min": 57.51460614072679, "episode_reward_mean": 59.889504842492215, "episode_len_mean": 100.0, "episodes_this_iter": 184, "policy_reward_mean": {"agent_0": 27.739481336149264, "agent_1": 32.150023506342954}, "custom_metrics": {"delta0_mean": 0.38224286470659086, "delta0_min": 0.3165327569698277, "delta0_max": 0.42467226888485743, "delta1_mean": 0.42558395482109884, "delta1_min": 0.3896488206263655, "delta1_max": 0.4464964047325136, "price0_mean": 1.6326645032208746, "price0_min": 1.6161755811209404, "price0_max": 1.6408205133383176, "price1_mean": 1.633194550375176, "price1_min": 1.6105586654990283, "price1_max": 1.6456109586377723}, "sampler_perf": {"mean_env_wait_ms": 1.109354416626655, "mean_processing_ms": 10.190574069569028, "mean_inference_ms": 2.0679861744772423}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 198, "num_steps_trained": 9981952, "num_steps_sampled": 3405184, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6649, "num_samples_dropped": 875, "learner_queue": {"size_count": 50604, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.883, "replay_time_ms": 86.722, "update_priorities_time_ms": 43.947, "policy_agent_0": {"added_count": 862080, "sampled_count": 2490368, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 862080, "sampled_count": 2490368, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3378058671951294}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27768170833587646}}}, "timesteps_this_iter": 37248, "done": false, "timesteps_total": 3405184, "episodes_total": 16976, "training_iteration": 61, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-05-36", "timestamp": 1564909536, "time_this_iter_s": 30.59824776649475, "time_total_s": 1864.8441762924194, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16da510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16da840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16da488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16de9d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1864.8441762924194, "timesteps_since_restore": 3405184, "iterations_since_restore": 61, "num_healthy_workers": 4}
{"episode_reward_max": 62.04777882242844, "episode_reward_min": 57.14637807429439, "episode_reward_mean": 59.87223327334701, "episode_len_mean": 100.0, "episodes_this_iter": 176, "policy_reward_mean": {"agent_0": 28.033965866012498, "agent_1": 31.838267407334527}, "custom_metrics": {"delta0_mean": 0.38249065486973133, "delta0_min": 0.31789900311783825, "delta0_max": 0.42529419160563714, "delta1_mean": 0.4294251971337193, "delta1_min": 0.3939040597482859, "delta1_max": 0.4500624450555193, "price0_mean": 1.6334353611198542, "price0_min": 1.6171747583899498, "price0_max": 1.6415823049767275, "price1_mean": 1.633395052564371, "price1_min": 1.6110832754391882, "price1_max": 1.645844700621376}, "sampler_perf": {"mean_env_wait_ms": 1.1102681430613117, "mean_processing_ms": 10.27928586986411, "mean_inference_ms": 2.069143771654237}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 202, "num_steps_trained": 10148352, "num_steps_sampled": 3442176, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6722, "num_samples_dropped": 875, "learner_queue": {"size_count": 51254, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 21.546, "replay_time_ms": 89.207, "update_priorities_time_ms": 43.979, "policy_agent_0": {"added_count": 871424, "sampled_count": 2531328, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 871424, "sampled_count": 2531328, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.348585307598114}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2760704457759857}}}, "timesteps_this_iter": 36992, "done": false, "timesteps_total": 3442176, "episodes_total": 17152, "training_iteration": 62, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-06-07", "timestamp": 1564909567, "time_this_iter_s": 30.36140513420105, "time_total_s": 1895.2055814266205, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1712b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c9e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17378c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16ea268>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1895.2055814266205, "timesteps_since_restore": 3442176, "iterations_since_restore": 62, "num_healthy_workers": 4}
{"episode_reward_max": 62.960416532145096, "episode_reward_min": 57.873518067966955, "episode_reward_mean": 60.628840340398476, "episode_len_mean": 100.0, "episodes_this_iter": 192, "policy_reward_mean": {"agent_0": 28.24617448245948, "agent_1": 32.382665857938996}, "custom_metrics": {"delta0_mean": 0.38358989455182035, "delta0_min": 0.3196907150300796, "delta0_max": 0.42611081375834386, "delta1_mean": 0.434067434779767, "delta1_min": 0.3989560416669211, "delta1_max": 0.4545870032870566, "price0_mean": 1.6344999781737666, "price0_min": 1.6184149242432098, "price0_max": 1.6426073765189149, "price1_mean": 1.6338651280823777, "price1_min": 1.6117885478752505, "price1_max": 1.6462451780079361}, "sampler_perf": {"mean_env_wait_ms": 1.1114602228527606, "mean_processing_ms": 10.376081821729676, "mean_inference_ms": 2.0678834535642014}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 205, "num_steps_trained": 10312192, "num_steps_sampled": 3479680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6795, "num_samples_dropped": 875, "learner_queue": {"size_count": 51894, "size_mean": 0.22, "size_std": 0.41424630354415964, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.287, "replay_time_ms": 102.825, "update_priorities_time_ms": 43.163, "policy_agent_0": {"added_count": 880128, "sampled_count": 2573312, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 880128, "sampled_count": 2573312, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36036375164985657}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2777295708656311}}}, "timesteps_this_iter": 37504, "done": false, "timesteps_total": 3479680, "episodes_total": 17344, "training_iteration": 63, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-06-38", "timestamp": 1564909598, "time_this_iter_s": 30.88357377052307, "time_total_s": 1926.0891551971436, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16ea510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16ea950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16ea8c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16fc048>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1926.0891551971436, "timesteps_since_restore": 3479680, "iterations_since_restore": 63, "num_healthy_workers": 4}
{"episode_reward_max": 62.84132266408156, "episode_reward_min": 56.418557982758614, "episode_reward_mean": 59.373570325355224, "episode_len_mean": 100.0, "episodes_this_iter": 184, "policy_reward_mean": {"agent_0": 27.561888199277497, "agent_1": 31.811682126077713}, "custom_metrics": {"delta0_mean": 0.38341575001512085, "delta0_min": 0.32102971345133813, "delta0_max": 0.4260063385434114, "delta1_mean": 0.43788695663135085, "delta1_min": 0.40325834452179765, "delta1_max": 0.4579595569312305, "price0_mean": 1.6352399628629675, "price0_min": 1.61944016078363, "price0_max": 1.6432798867526348, "price1_mean": 1.633956627257569, "price1_min": 1.6121607127962725, "price1_max": 1.6462888321976032}, "sampler_perf": {"mean_env_wait_ms": 1.1119631255405218, "mean_processing_ms": 10.471101575859796, "mean_inference_ms": 2.0669395605003316}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 208, "num_steps_trained": 10483968, "num_steps_sampled": 3516544, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6868, "num_samples_dropped": 875, "learner_queue": {"size_count": 52565, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.352, "replay_time_ms": 112.572, "update_priorities_time_ms": 53.454, "policy_agent_0": {"added_count": 889728, "sampled_count": 2614784, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 889728, "sampled_count": 2614784, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35931479930877686}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27123185992240906}}}, "timesteps_this_iter": 36864, "done": false, "timesteps_total": 3516544, "episodes_total": 17528, "training_iteration": 64, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-07-09", "timestamp": 1564909629, "time_this_iter_s": 31.13490343093872, "time_total_s": 1957.2240586280823, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16de9d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16da488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16da840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1682400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1957.2240586280823, "timesteps_since_restore": 3516544, "iterations_since_restore": 64, "num_healthy_workers": 4}
{"episode_reward_max": 63.56556874868279, "episode_reward_min": 55.92820605542188, "episode_reward_mean": 60.20206046303745, "episode_len_mean": 100.0, "episodes_this_iter": 184, "policy_reward_mean": {"agent_0": 28.32397035340349, "agent_1": 31.87809010963396}, "custom_metrics": {"delta0_mean": 0.3845251772524766, "delta0_min": 0.3228732582087779, "delta0_max": 0.42647438162200957, "delta1_mean": 0.4416997762928718, "delta1_min": 0.40764309713713276, "delta1_max": 0.4613085421523435, "price0_mean": 1.6361677274482451, "price0_min": 1.620565688936529, "price0_max": 1.6440633880010136, "price1_mean": 1.6343745134901313, "price1_min": 1.6126972974226477, "price1_max": 1.6465186294976968}, "sampler_perf": {"mean_env_wait_ms": 1.1129984938457511, "mean_processing_ms": 10.555251374978008, "mean_inference_ms": 2.066938897321524}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 212, "num_steps_trained": 10647296, "num_steps_sampled": 3554304, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 6940, "num_samples_dropped": 875, "learner_queue": {"size_count": 53203, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 20.791, "replay_time_ms": 115.3, "update_priorities_time_ms": 54.06, "policy_agent_0": {"added_count": 897536, "sampled_count": 2653440, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 897536, "sampled_count": 2653440, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3682057559490204}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2695857882499695}}}, "timesteps_this_iter": 37760, "done": false, "timesteps_total": 3554304, "episodes_total": 17712, "training_iteration": 65, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-07-39", "timestamp": 1564909659, "time_this_iter_s": 30.417192220687866, "time_total_s": 1987.6412508487701, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1666510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1666488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1666598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16737b8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 1987.6412508487701, "timesteps_since_restore": 3554304, "iterations_since_restore": 65, "num_healthy_workers": 4}
{"episode_reward_max": 60.87166638740258, "episode_reward_min": 49.40267899782289, "episode_reward_mean": 57.69327145798139, "episode_len_mean": 100.0, "episodes_this_iter": 184, "policy_reward_mean": {"agent_0": 25.571270444754468, "agent_1": 32.12200101322692}, "custom_metrics": {"delta0_mean": 0.38418449724384596, "delta0_min": 0.32180181304495015, "delta0_max": 0.4242728925874885, "delta1_mean": 0.44563197388164794, "delta1_min": 0.4118259291163918, "delta1_max": 0.46518776420987173, "price0_mean": 1.6370427930069062, "price0_min": 1.6214566182026278, "price0_max": 1.644789411646382, "price1_mean": 1.6343739926799339, "price1_min": 1.6127786963774944, "price1_max": 1.6461330342135478}, "sampler_perf": {"mean_env_wait_ms": 1.1132647968752891, "mean_processing_ms": 10.644615623313557, "mean_inference_ms": 2.0670474093777855}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 215, "num_steps_trained": 10813952, "num_steps_sampled": 3591680, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7013, "num_samples_dropped": 875, "learner_queue": {"size_count": 53854, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.185, "replay_time_ms": 112.657, "update_priorities_time_ms": 54.27, "policy_agent_0": {"added_count": 906624, "sampled_count": 2694400, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 906624, "sampled_count": 2694400, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38885945081710815}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2802610695362091}}}, "timesteps_this_iter": 37376, "done": false, "timesteps_total": 3591680, "episodes_total": 17896, "training_iteration": 66, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-08-11", "timestamp": 1564909691, "time_this_iter_s": 30.799741983413696, "time_total_s": 2018.4409928321838, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c9e18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16fc048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1712b70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd167c510>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2018.4409928321838, "timesteps_since_restore": 3591680, "iterations_since_restore": 66, "num_healthy_workers": 4}
{"episode_reward_max": 62.44545809020884, "episode_reward_min": 25.562564858459428, "episode_reward_mean": 52.94946146004479, "episode_len_mean": 100.0, "episodes_this_iter": 176, "policy_reward_mean": {"agent_0": 25.707830925957435, "agent_1": 27.241630534087356}, "custom_metrics": {"delta0_mean": 0.38238899121151027, "delta0_min": 0.3217161470746084, "delta0_max": 0.42263893046190876, "delta1_mean": 0.44512550525581546, "delta1_min": 0.4128026734486469, "delta1_max": 0.4668975133901733, "price0_mean": 1.636695891157415, "price0_min": 1.621613352639455, "price0_max": 1.6444509267149672, "price1_mean": 1.6343458525861294, "price1_min": 1.6131069593797926, "price1_max": 1.646107388855706}, "sampler_perf": {"mean_env_wait_ms": 1.1122999889081002, "mean_processing_ms": 10.736447716498482, "mean_inference_ms": 2.0696179155136716}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 218, "num_steps_trained": 10987008, "num_steps_sampled": 3627776, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7084, "num_samples_dropped": 875, "learner_queue": {"size_count": 54530, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.615, "replay_time_ms": 113.728, "update_priorities_time_ms": 55.92, "policy_agent_0": {"added_count": 916480, "sampled_count": 2737664, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 916480, "sampled_count": 2737664, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3926721215248108}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.305122435092926}}}, "timesteps_this_iter": 36096, "done": false, "timesteps_total": 3627776, "episodes_total": 18072, "training_iteration": 67, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-08-41", "timestamp": 1564909721, "time_this_iter_s": 30.598750829696655, "time_total_s": 2049.0397436618805, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd167c7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd167c840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd167c8c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1602ae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2049.0397436618805, "timesteps_since_restore": 3627776, "iterations_since_restore": 67, "num_healthy_workers": 4}
{"episode_reward_max": 60.57568603751117, "episode_reward_min": 40.966283286473114, "episode_reward_mean": 55.12832815212421, "episode_len_mean": 100.0, "episodes_this_iter": 176, "policy_reward_mean": {"agent_0": 25.498671651327403, "agent_1": 29.629656500796816}, "custom_metrics": {"delta0_mean": 0.3809946508826165, "delta0_min": 0.3207576154807039, "delta0_max": 0.4212700761874252, "delta1_mean": 0.4466596176715847, "delta1_min": 0.4143906979061529, "delta1_max": 0.4685040313669509, "price0_mean": 1.6368431396698633, "price0_min": 1.6218338359422202, "price0_max": 1.6445749677214203, "price1_mean": 1.6339293440470726, "price1_min": 1.6126957720547888, "price1_max": 1.6456907084469188}, "sampler_perf": {"mean_env_wait_ms": 1.1133382557328715, "mean_processing_ms": 10.817413539125345, "mean_inference_ms": 2.0702632012844084}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 222, "num_steps_trained": 11151872, "num_steps_sampled": 3665024, "sample_throughput": 0.0, "train_throughput": 25975.006, "num_weight_syncs": 7157, "num_samples_dropped": 875, "learner_queue": {"size_count": 55175, "size_mean": 0.26, "size_std": 0.6575712889109439, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 20.709, "replay_time_ms": 109.731, "update_priorities_time_ms": 56.866, "policy_agent_0": {"added_count": 924928, "sampled_count": 2777344, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 924928, "sampled_count": 2777344, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4218830466270447}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3281579911708832}}}, "timesteps_this_iter": 37248, "done": false, "timesteps_total": 3665024, "episodes_total": 18248, "training_iteration": 68, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-09-12", "timestamp": 1564909752, "time_this_iter_s": 30.4676616191864, "time_total_s": 2079.507405281067, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16737b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1682400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1682268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd160c840>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2079.507405281067, "timesteps_since_restore": 3665024, "iterations_since_restore": 68, "num_healthy_workers": 4}
{"episode_reward_max": 59.48284655491162, "episode_reward_min": 54.3109337925122, "episode_reward_mean": 57.06168162721377, "episode_len_mean": 100.0, "episodes_this_iter": 184, "policy_reward_mean": {"agent_0": 26.134831022166523, "agent_1": 30.926850605047242}, "custom_metrics": {"delta0_mean": 0.3806773157282593, "delta0_min": 0.3207804600071302, "delta0_max": 0.4200733928712467, "delta1_mean": 0.4494068859586005, "delta1_min": 0.4171541166339754, "delta1_max": 0.47102028355028275, "price0_mean": 1.6373254759667082, "price0_min": 1.6223544363638434, "price0_max": 1.6448813161918663, "price1_mean": 1.6337875312224346, "price1_min": 1.6126441736496642, "price1_max": 1.645318924384888}, "sampler_perf": {"mean_env_wait_ms": 1.114388217844841, "mean_processing_ms": 10.90799681498924, "mean_inference_ms": 2.069656483436287}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 225, "num_steps_trained": 11323648, "num_steps_sampled": 3699840, "sample_throughput": 0.0, "train_throughput": 23945.003, "num_weight_syncs": 7225, "num_samples_dropped": 875, "learner_queue": {"size_count": 55845, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.138, "replay_time_ms": 107.009, "update_priorities_time_ms": 50.4, "policy_agent_0": {"added_count": 933504, "sampled_count": 2819840, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 933504, "sampled_count": 2819840, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42649728059768677}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3302761912345886}}}, "timesteps_this_iter": 34816, "done": false, "timesteps_total": 3699840, "episodes_total": 18432, "training_iteration": 69, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-09-43", "timestamp": 1564909783, "time_this_iter_s": 30.429503679275513, "time_total_s": 2109.9369089603424, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd160cb70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd160cae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd160cbf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd161ae18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2109.9369089603424, "timesteps_since_restore": 3699840, "iterations_since_restore": 69, "num_healthy_workers": 4}
{"episode_reward_max": 59.75105462634213, "episode_reward_min": 56.0898224169332, "episode_reward_mean": 57.34884951374824, "episode_len_mean": 100.0, "episodes_this_iter": 192, "policy_reward_mean": {"agent_0": 26.860728519886067, "agent_1": 30.488120993862168}, "custom_metrics": {"delta0_mean": 0.3799036535376438, "delta0_min": 0.32097672200022626, "delta0_max": 0.41953476315898275, "delta1_mean": 0.4517680939905195, "delta1_min": 0.41996942621224154, "delta1_max": 0.4731741995442803, "price0_mean": 1.6376259598441694, "price0_min": 1.6228879858729754, "price0_max": 1.6451774970631163, "price1_mean": 1.6335523476441713, "price1_min": 1.6127493428958048, "price1_max": 1.6450869453911616}, "sampler_perf": {"mean_env_wait_ms": 1.1144092826436507, "mean_processing_ms": 10.985149237757035, "mean_inference_ms": 2.069207974625856}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 228, "num_steps_trained": 11486208, "num_steps_sampled": 3736448, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7296, "num_samples_dropped": 875, "learner_queue": {"size_count": 56480, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.828, "replay_time_ms": 97.101, "update_priorities_time_ms": 51.363, "policy_agent_0": {"added_count": 943104, "sampled_count": 2859008, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 943104, "sampled_count": 2859008, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43323826789855957}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31562039256095886}}}, "timesteps_this_iter": 36608, "done": false, "timesteps_total": 3736448, "episodes_total": 18624, "training_iteration": 70, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-10-14", "timestamp": 1564909814, "time_this_iter_s": 30.84955620765686, "time_total_s": 2140.7864651679993, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1602488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1602a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1602400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd167cd90>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2140.7864651679993, "timesteps_since_restore": 3736448, "iterations_since_restore": 70, "num_healthy_workers": 4}
{"episode_reward_max": 60.39286247546766, "episode_reward_min": 54.99478714494419, "episode_reward_mean": 56.82143240766401, "episode_len_mean": 100.0, "episodes_this_iter": 176, "policy_reward_mean": {"agent_0": 27.54856048661875, "agent_1": 29.27287192104525}, "custom_metrics": {"delta0_mean": 0.380276763278544, "delta0_min": 0.3218398746668155, "delta0_max": 0.4194167257424485, "delta1_mean": 0.4529009819436911, "delta1_min": 0.42150120083573706, "delta1_max": 0.4740840695780542, "price0_mean": 1.6377288829446448, "price0_min": 1.6231516801913888, "price0_max": 1.645205446703499, "price1_mean": 1.6334539121836302, "price1_min": 1.6128177194907838, "price1_max": 1.644850476744768}, "sampler_perf": {"mean_env_wait_ms": 1.1154268886062781, "mean_processing_ms": 11.07028605504231, "mean_inference_ms": 2.068335306250035}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 232, "num_steps_trained": 11654912, "num_steps_sampled": 3772288, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7367, "num_samples_dropped": 875, "learner_queue": {"size_count": 57139, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.594, "replay_time_ms": 110.63, "update_priorities_time_ms": 48.218, "policy_agent_0": {"added_count": 952448, "sampled_count": 2901504, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 952448, "sampled_count": 2901504, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4147356152534485}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34213167428970337}}}, "timesteps_this_iter": 35840, "done": false, "timesteps_total": 3772288, "episodes_total": 18800, "training_iteration": 71, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-10-45", "timestamp": 1564909845, "time_this_iter_s": 30.665299654006958, "time_total_s": 2171.451764822006, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd167cd08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd167ca60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd167c268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1666f28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2171.451764822006, "timesteps_since_restore": 3772288, "iterations_since_restore": 71, "num_healthy_workers": 4}
{"episode_reward_max": 62.8487320677743, "episode_reward_min": 56.624898497759766, "episode_reward_mean": 57.4451894551683, "episode_len_mean": 100.0, "episodes_this_iter": 184, "policy_reward_mean": {"agent_0": 28.214408967331934, "agent_1": 29.230780487836366}, "custom_metrics": {"delta0_mean": 0.3817606729388646, "delta0_min": 0.3232734423208074, "delta0_max": 0.4198519324042209, "delta1_mean": 0.45405568257733614, "delta1_min": 0.42282344360722346, "delta1_max": 0.47507637326688795, "price0_mean": 1.6379446924324492, "price0_min": 1.623417521361446, "price0_max": 1.6452984873520249, "price1_mean": 1.6335962025648747, "price1_min": 1.6130487872678139, "price1_max": 1.6447535601907868}, "sampler_perf": {"mean_env_wait_ms": 1.116039032599522, "mean_processing_ms": 11.157841139051559, "mean_inference_ms": 2.069400598617356}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 235, "num_steps_trained": 11823104, "num_steps_sampled": 3808896, "sample_throughput": 2958.798, "train_throughput": 11835.191, "num_weight_syncs": 7438, "num_samples_dropped": 875, "learner_queue": {"size_count": 57797, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.801, "replay_time_ms": 116.9, "update_priorities_time_ms": 50.137, "policy_agent_0": {"added_count": 962304, "sampled_count": 2942464, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 962304, "sampled_count": 2942464, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40965965390205383}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3214426338672638}}}, "timesteps_this_iter": 36608, "done": false, "timesteps_total": 3808896, "episodes_total": 18984, "training_iteration": 72, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-11-17", "timestamp": 1564909877, "time_this_iter_s": 31.316238403320312, "time_total_s": 2202.7680032253265, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1602400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1602a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1602488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1682378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2202.7680032253265, "timesteps_since_restore": 3808896, "iterations_since_restore": 72, "num_healthy_workers": 4}
{"episode_reward_max": 60.008522953649184, "episode_reward_min": 55.289998283432865, "episode_reward_mean": 57.04563052347541, "episode_len_mean": 100.0, "episodes_this_iter": 176, "policy_reward_mean": {"agent_0": 28.538930320929254, "agent_1": 28.506700202546156}, "custom_metrics": {"delta0_mean": 0.38238623174242464, "delta0_min": 0.3249660193924915, "delta0_max": 0.4206001286751979, "delta1_mean": 0.4544938377251391, "delta1_min": 0.42363476279713147, "delta1_max": 0.47546989736833983, "price0_mean": 1.6378957345150715, "price0_min": 1.6235737741650738, "price0_max": 1.6452494947045138, "price1_mean": 1.6335532426241735, "price1_min": 1.613274315403589, "price1_max": 1.6446873273693412}, "sampler_perf": {"mean_env_wait_ms": 1.1160553419690713, "mean_processing_ms": 11.241293881529513, "mean_inference_ms": 2.070139505990534}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 239, "num_steps_trained": 11995136, "num_steps_sampled": 3844608, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7508, "num_samples_dropped": 875, "learner_queue": {"size_count": 58468, "size_mean": 0.3, "size_std": 0.49999999999999994, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.597, "replay_time_ms": 119.883, "update_priorities_time_ms": 56.039, "policy_agent_0": {"added_count": 971648, "sampled_count": 2984704, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 971648, "sampled_count": 2984704, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38423630595207214}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30300480127334595}}}, "timesteps_this_iter": 35712, "done": false, "timesteps_total": 3844608, "episodes_total": 19160, "training_iteration": 73, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-11-48", "timestamp": 1564909908, "time_this_iter_s": 31.096771478652954, "time_total_s": 2233.8647747039795, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16fce18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16fcea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16fcd90>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16f3bf8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2233.8647747039795, "timesteps_since_restore": 3844608, "iterations_since_restore": 73, "num_healthy_workers": 4}
{"episode_reward_max": 58.52913901935343, "episode_reward_min": 55.606830825327734, "episode_reward_mean": 56.533550866733215, "episode_len_mean": 100.0, "episodes_this_iter": 176, "policy_reward_mean": {"agent_0": 27.562215628982337, "agent_1": 28.971335237750893}, "custom_metrics": {"delta0_mean": 0.38273714904774747, "delta0_min": 0.32595516298529187, "delta0_max": 0.42054264819892107, "delta1_mean": 0.45532748989344324, "delta1_min": 0.42452902940205384, "delta1_max": 0.4761125575429157, "price0_mean": 1.6379366856832898, "price0_min": 1.6237011745405332, "price0_max": 1.6452234152785365, "price1_mean": 1.6334388972076133, "price1_min": 1.6133428909554763, "price1_max": 1.6444574829549217}, "sampler_perf": {"mean_env_wait_ms": 1.1153488354372936, "mean_processing_ms": 11.327416559801142, "mean_inference_ms": 2.071044480445892}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 242, "num_steps_trained": 12163328, "num_steps_sampled": 3880576, "sample_throughput": 15632.16, "train_throughput": 0.0, "num_weight_syncs": 7578, "num_samples_dropped": 875, "learner_queue": {"size_count": 59126, "size_mean": 0.2, "size_std": 0.44721359549995804, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.131, "replay_time_ms": 101.102, "update_priorities_time_ms": 46.963, "policy_agent_0": {"added_count": 981376, "sampled_count": 3024128, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 981376, "sampled_count": 3024128, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3783309757709503}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30748119950294495}}}, "timesteps_this_iter": 35968, "done": false, "timesteps_total": 3880576, "episodes_total": 19336, "training_iteration": 74, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-12-19", "timestamp": 1564909939, "time_this_iter_s": 31.05327033996582, "time_total_s": 2264.9180450439453, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16821e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1682ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1682158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16eac80>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2264.9180450439453, "timesteps_since_restore": 3880576, "iterations_since_restore": 74, "num_healthy_workers": 4}
{"episode_reward_max": 58.15696244577676, "episode_reward_min": 51.667182688257384, "episode_reward_mean": 55.3607661639016, "episode_len_mean": 100.0, "episodes_this_iter": 168, "policy_reward_mean": {"agent_0": 27.541028000989257, "agent_1": 27.819738162912337}, "custom_metrics": {"delta0_mean": 0.38248813158733175, "delta0_min": 0.32677130469761057, "delta0_max": 0.42065003864688, "delta1_mean": 0.4551899118425424, "delta1_min": 0.4245437735033685, "delta1_max": 0.47599351308604815, "price0_mean": 1.6377081635168107, "price0_min": 1.623632463501836, "price0_max": 1.6450606178956864, "price1_mean": 1.6331938269115156, "price1_min": 1.6133902905661694, "price1_max": 1.6442635634277427}, "sampler_perf": {"mean_env_wait_ms": 1.115738586272124, "mean_processing_ms": 11.409725247374086, "mean_inference_ms": 2.070663947952968}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 245, "num_steps_trained": 12332032, "num_steps_sampled": 3915136, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7645, "num_samples_dropped": 875, "learner_queue": {"size_count": 59785, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.905, "replay_time_ms": 98.03, "update_priorities_time_ms": 44.093, "policy_agent_0": {"added_count": 990336, "sampled_count": 3065600, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 990336, "sampled_count": 3065600, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36801934242248535}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3271735906600952}}}, "timesteps_this_iter": 34560, "done": false, "timesteps_total": 3915136, "episodes_total": 19504, "training_iteration": 75, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-12-49", "timestamp": 1564909969, "time_this_iter_s": 30.392237186431885, "time_total_s": 2295.310282230377, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16ded90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16deb70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16dec80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16da2f0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2295.310282230377, "timesteps_since_restore": 3915136, "iterations_since_restore": 75, "num_healthy_workers": 4}
{"episode_reward_max": 63.626661849081565, "episode_reward_min": 51.96594546489638, "episode_reward_mean": 59.504169143988854, "episode_len_mean": 100.0, "episodes_this_iter": 168, "policy_reward_mean": {"agent_0": 29.91412727324353, "agent_1": 29.590041870745317}, "custom_metrics": {"delta0_mean": 0.38571942979120033, "delta0_min": 0.3298785142267736, "delta0_max": 0.4227613918832336, "delta1_mean": 0.45651748403586095, "delta1_min": 0.42641650127091035, "delta1_max": 0.4770238953857154, "price0_mean": 1.6382235190415373, "price0_min": 1.6243234461762506, "price0_max": 1.645531252987669, "price1_mean": 1.6338496603397676, "price1_min": 1.6141779956530053, "price1_max": 1.6447487459418557}, "sampler_perf": {"mean_env_wait_ms": 1.1161721434250946, "mean_processing_ms": 11.506606470646991, "mean_inference_ms": 2.071088587717483}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 249, "num_steps_trained": 12499200, "num_steps_sampled": 3950592, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7714, "num_samples_dropped": 875, "learner_queue": {"size_count": 60437, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.393, "replay_time_ms": 81.976, "update_priorities_time_ms": 41.23, "policy_agent_0": {"added_count": 997888, "sampled_count": 3104768, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 997888, "sampled_count": 3104768, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.368073433637619}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34152883291244507}}}, "timesteps_this_iter": 35456, "done": false, "timesteps_total": 3950592, "episodes_total": 19672, "training_iteration": 76, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-13-21", "timestamp": 1564910001, "time_this_iter_s": 30.716165781021118, "time_total_s": 2326.0264480113983, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1682378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16fcd90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16fcea0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c99d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2326.0264480113983, "timesteps_since_restore": 3950592, "iterations_since_restore": 76, "num_healthy_workers": 4}
{"episode_reward_max": 63.44748331064451, "episode_reward_min": 49.710111489726046, "episode_reward_mean": 55.49811633838347, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 29.411814620619776, "agent_1": 26.08630171776371}, "custom_metrics": {"delta0_mean": 0.386771711119496, "delta0_min": 0.3315906869190435, "delta0_max": 0.42393248521278504, "delta1_mean": 0.4551268741412617, "delta1_min": 0.4292504983442124, "delta1_max": 0.4739544641745602, "price0_mean": 1.6378316191225963, "price0_min": 1.6248040112418383, "price0_max": 1.6448356922815393, "price1_mean": 1.6339181971738868, "price1_min": 1.6143252176258667, "price1_max": 1.644693717476554}, "sampler_perf": {"mean_env_wait_ms": 1.116567750260294, "mean_processing_ms": 11.592107710428243, "mean_inference_ms": 2.07213980141739}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 252, "num_steps_trained": 12665856, "num_steps_sampled": 3985152, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7781, "num_samples_dropped": 875, "learner_queue": {"size_count": 61088, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.629, "replay_time_ms": 100.829, "update_priorities_time_ms": 48.667, "policy_agent_0": {"added_count": 1005952, "sampled_count": 3146752, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1005952, "sampled_count": 3146752, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3531924784183502}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3492794632911682}}}, "timesteps_this_iter": 34560, "done": false, "timesteps_total": 3985152, "episodes_total": 19832, "training_iteration": 77, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-13-52", "timestamp": 1564910032, "time_this_iter_s": 30.654271841049194, "time_total_s": 2356.6807198524475, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c9d90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c9048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c9ae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1737f28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2356.6807198524475, "timesteps_since_restore": 3985152, "iterations_since_restore": 77, "num_healthy_workers": 4}
{"episode_reward_max": 64.3545625281135, "episode_reward_min": 49.87923794616241, "episode_reward_mean": 54.12143691713876, "episode_len_mean": 100.0, "episodes_this_iter": 168, "policy_reward_mean": {"agent_0": 29.101986353436555, "agent_1": 25.019450563702208}, "custom_metrics": {"delta0_mean": 0.38768097982058436, "delta0_min": 0.3349863579494253, "delta0_max": 0.4244343147227688, "delta1_mean": 0.45296389657846836, "delta1_min": 0.4321581079664288, "delta1_max": 0.47073106077123467, "price0_mean": 1.6372474140428939, "price0_min": 1.6253505901674126, "price0_max": 1.644004356137561, "price1_mean": 1.6339270149874419, "price1_min": 1.6151825605254362, "price1_max": 1.6444881768235442}, "sampler_perf": {"mean_env_wait_ms": 1.1167515356431503, "mean_processing_ms": 11.6735258357973, "mean_inference_ms": 2.0713156747931913}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 255, "num_steps_trained": 12834048, "num_steps_sampled": 4020352, "sample_throughput": 3554.66, "train_throughput": 7109.319, "num_weight_syncs": 7851, "num_samples_dropped": 875, "learner_queue": {"size_count": 61745, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.791, "replay_time_ms": 104.148, "update_priorities_time_ms": 59.91, "policy_agent_0": {"added_count": 1015040, "sampled_count": 3188736, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1015040, "sampled_count": 3188736, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35391658544540405}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36333033442497253}}}, "timesteps_this_iter": 35200, "done": false, "timesteps_total": 4020352, "episodes_total": 20000, "training_iteration": 78, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-14-23", "timestamp": 1564910063, "time_this_iter_s": 31.11043906211853, "time_total_s": 2387.791158914566, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17379d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1737ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1737bf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1722400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2387.791158914566, "timesteps_since_restore": 4020352, "iterations_since_restore": 78, "num_healthy_workers": 4}
{"episode_reward_max": 64.55215830583771, "episode_reward_min": 49.957561211864686, "episode_reward_mean": 59.88716472572093, "episode_len_mean": 100.0, "episodes_this_iter": 168, "policy_reward_mean": {"agent_0": 29.881357863370802, "agent_1": 30.005806862350113}, "custom_metrics": {"delta0_mean": 0.390729815161346, "delta0_min": 0.3376191308173796, "delta0_max": 0.42683767948381757, "delta1_mean": 0.45447515040824726, "delta1_min": 0.43443636494703686, "delta1_max": 0.471294200571637, "price0_mean": 1.6378232200791971, "price0_min": 1.6258569577944817, "price0_max": 1.6445528737123118, "price1_mean": 1.6346550387170855, "price1_min": 1.6159000520705193, "price1_max": 1.6451590119448456}, "sampler_perf": {"mean_env_wait_ms": 1.116851391464299, "mean_processing_ms": 11.767841625531926, "mean_inference_ms": 2.071925286174111}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 259, "num_steps_trained": 13001216, "num_steps_sampled": 4053376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7915, "num_samples_dropped": 875, "learner_queue": {"size_count": 62398, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 21.664, "replay_time_ms": 115.16, "update_priorities_time_ms": 49.664, "policy_agent_0": {"added_count": 1024256, "sampled_count": 3230976, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1024256, "sampled_count": 3230976, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33366578817367554}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.40836092829704285}}}, "timesteps_this_iter": 33024, "done": false, "timesteps_total": 4053376, "episodes_total": 20168, "training_iteration": 79, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-14-54", "timestamp": 1564910094, "time_this_iter_s": 30.802236795425415, "time_total_s": 2418.5933957099915, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16fcd90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16fcea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c9ae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1726730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2418.5933957099915, "timesteps_since_restore": 4053376, "iterations_since_restore": 79, "num_healthy_workers": 4}
{"episode_reward_max": 63.320391581486, "episode_reward_min": 48.1060771515968, "episode_reward_mean": 55.746970893332495, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.52953219658414, "agent_1": 27.21743869674836}, "custom_metrics": {"delta0_mean": 0.3909292076373882, "delta0_min": 0.3381480354672208, "delta0_max": 0.4269191391607139, "delta1_mean": 0.45408120260708196, "delta1_min": 0.43378257476991533, "delta1_max": 0.4716383620784752, "price0_mean": 1.6376397589353777, "price0_min": 1.625505166868262, "price0_max": 1.6439502538056678, "price1_mean": 1.6346319725116671, "price1_min": 1.6158686812283618, "price1_max": 1.6449469173153208}, "sampler_perf": {"mean_env_wait_ms": 1.1183414513861585, "mean_processing_ms": 11.862891847765464, "mean_inference_ms": 2.075349876066497}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 261, "num_steps_trained": 13142272, "num_steps_sampled": 4080896, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 7969, "num_samples_dropped": 875, "learner_queue": {"size_count": 62950, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.464, "replay_time_ms": 113.785, "update_priorities_time_ms": 52.139, "policy_agent_0": {"added_count": 1031680, "sampled_count": 3265024, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1031680, "sampled_count": 3265024, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33538979291915894}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4142376482486725}}}, "timesteps_this_iter": 27520, "done": false, "timesteps_total": 4080896, "episodes_total": 20296, "training_iteration": 80, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-15-25", "timestamp": 1564910125, "time_this_iter_s": 30.500652074813843, "time_total_s": 2449.0940477848053, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd171b510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd171b950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd171b620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1712730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2449.0940477848053, "timesteps_since_restore": 4080896, "iterations_since_restore": 80, "num_healthy_workers": 4}
{"episode_reward_max": 63.79338663467519, "episode_reward_min": 41.96446995380952, "episode_reward_mean": 51.62941318327578, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 26.023503693469678, "agent_1": 25.605909489806102}, "custom_metrics": {"delta0_mean": 0.38958916373842295, "delta0_min": 0.33730688985720797, "delta0_max": 0.4254604964341107, "delta1_mean": 0.45262825826752073, "delta1_min": 0.43120131634250736, "delta1_max": 0.4693248495601955, "price0_mean": 1.6370805681208394, "price0_min": 1.6248458312777503, "price0_max": 1.6431686692082481, "price1_mean": 1.6341037428515761, "price1_min": 1.615393858566593, "price1_max": 1.6442644601084762}, "sampler_perf": {"mean_env_wait_ms": 1.1186856131048901, "mean_processing_ms": 11.955410122347955, "mean_inference_ms": 2.076565911049319}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 264, "num_steps_trained": 13291008, "num_steps_sampled": 4110464, "sample_throughput": 8178.086, "train_throughput": 0.0, "num_weight_syncs": 8027, "num_samples_dropped": 875, "learner_queue": {"size_count": 63530, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.813, "replay_time_ms": 99.849, "update_priorities_time_ms": 43.874, "policy_agent_0": {"added_count": 1038464, "sampled_count": 3301632, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1038464, "sampled_count": 3301632, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3249210715293884}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4291653037071228}}}, "timesteps_this_iter": 29568, "done": false, "timesteps_total": 4110464, "episodes_total": 20448, "training_iteration": 81, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-15-55", "timestamp": 1564910155, "time_this_iter_s": 30.44036865234375, "time_total_s": 2479.534416437149, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1737ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1737bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17379d8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd170c8c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2479.534416437149, "timesteps_since_restore": 4110464, "iterations_since_restore": 81, "num_healthy_workers": 4}
{"episode_reward_max": 64.29028616611802, "episode_reward_min": 46.209593773207445, "episode_reward_mean": 57.23995870161943, "episode_len_mean": 100.0, "episodes_this_iter": 168, "policy_reward_mean": {"agent_0": 27.847455816292513, "agent_1": 29.39250288532692}, "custom_metrics": {"delta0_mean": 0.3901206378043056, "delta0_min": 0.33620759208560963, "delta0_max": 0.4246957371873236, "delta1_mean": 0.4536953308539195, "delta1_min": 0.4313695592162299, "delta1_max": 0.4689189308976365, "price0_mean": 1.6373381747072813, "price0_min": 1.624820122682613, "price0_max": 1.6431667971572677, "price1_mean": 1.6341610885344977, "price1_min": 1.6149955629351171, "price1_max": 1.6439427068359997}, "sampler_perf": {"mean_env_wait_ms": 1.1177992174341191, "mean_processing_ms": 12.041034222616453, "mean_inference_ms": 2.075723464155124}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 268, "num_steps_trained": 13450752, "num_steps_sampled": 4142848, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8090, "num_samples_dropped": 875, "learner_queue": {"size_count": 64154, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.215, "replay_time_ms": 122.31, "update_priorities_time_ms": 58.451, "policy_agent_0": {"added_count": 1047552, "sampled_count": 3340544, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1047552, "sampled_count": 3340544, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3286508023738861}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4408729374408722}}}, "timesteps_this_iter": 32384, "done": false, "timesteps_total": 4142848, "episodes_total": 20616, "training_iteration": 82, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-16-26", "timestamp": 1564910186, "time_this_iter_s": 30.71937346458435, "time_total_s": 2510.2537899017334, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16630d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17000d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1700bf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17761e0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2510.2537899017334, "timesteps_since_restore": 4142848, "iterations_since_restore": 82, "num_healthy_workers": 4}
{"episode_reward_max": 64.48906257655794, "episode_reward_min": 46.058357522735, "episode_reward_mean": 60.55330985947042, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 30.706559199221704, "agent_1": 29.846750660248734}, "custom_metrics": {"delta0_mean": 0.39298679651421364, "delta0_min": 0.33597717461076415, "delta0_max": 0.42790078614882426, "delta1_mean": 0.45491965064912687, "delta1_min": 0.4308922631276458, "delta1_max": 0.4693356787926176, "price0_mean": 1.6379115923549876, "price0_min": 1.6253946200660558, "price0_max": 1.6439595324053013, "price1_mean": 1.634849611184747, "price1_min": 1.615595609987105, "price1_max": 1.6448444327602525}, "sampler_perf": {"mean_env_wait_ms": 1.1175551810902191, "mean_processing_ms": 12.131349321310207, "mean_inference_ms": 2.0778177369679405}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 271, "num_steps_trained": 13614080, "num_steps_sampled": 4174848, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8153, "num_samples_dropped": 875, "learner_queue": {"size_count": 64792, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.888, "replay_time_ms": 93.461, "update_priorities_time_ms": 52.285, "policy_agent_0": {"added_count": 1054976, "sampled_count": 3379456, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1054976, "sampled_count": 3379456, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33297619223594666}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41698673367500305}}}, "timesteps_this_iter": 32000, "done": false, "timesteps_total": 4174848, "episodes_total": 20776, "training_iteration": 83, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-16-57", "timestamp": 1564910217, "time_this_iter_s": 30.891923904418945, "time_total_s": 2541.1457138061523, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1712730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd171b620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd171b950>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176e158>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2541.1457138061523, "timesteps_since_restore": 4174848, "iterations_since_restore": 83, "num_healthy_workers": 4}
{"episode_reward_max": 63.91156861155917, "episode_reward_min": 46.33812696866404, "episode_reward_mean": 60.32897431999472, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 29.597196753168863, "agent_1": 30.731777566825865}, "custom_metrics": {"delta0_mean": 0.394582351604731, "delta0_min": 0.3334544148043292, "delta0_max": 0.429981019955159, "delta1_mean": 0.45680957622693974, "delta1_min": 0.4292836823321946, "delta1_max": 0.47186942780320645, "price0_mean": 1.6384766000434037, "price0_min": 1.6249057736200487, "price0_max": 1.6447362593103725, "price1_mean": 1.635312651015666, "price1_min": 1.6164894088535091, "price1_max": 1.645519109754803}, "sampler_perf": {"mean_env_wait_ms": 1.1177077638701007, "mean_processing_ms": 12.215048620891594, "mean_inference_ms": 2.076615997027823}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 274, "num_steps_trained": 13773824, "num_steps_sampled": 4207360, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8216, "num_samples_dropped": 875, "learner_queue": {"size_count": 65416, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.868, "replay_time_ms": 113.761, "update_priorities_time_ms": 53.399, "policy_agent_0": {"added_count": 1063040, "sampled_count": 3417856, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1063040, "sampled_count": 3417856, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3456745743751526}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3980323076248169}}}, "timesteps_this_iter": 32512, "done": false, "timesteps_total": 4207360, "episodes_total": 20936, "training_iteration": 84, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-17-27", "timestamp": 1564910247, "time_this_iter_s": 30.429880142211914, "time_total_s": 2571.5755939483643, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176e950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176e488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176e730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd175dae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2571.5755939483643, "timesteps_since_restore": 4207360, "iterations_since_restore": 84, "num_healthy_workers": 4}
{"episode_reward_max": 63.22432874518288, "episode_reward_min": 45.431160946778846, "episode_reward_mean": 60.94654913314122, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 30.309677070624588, "agent_1": 30.636872062516634}, "custom_metrics": {"delta0_mean": 0.395892806715964, "delta0_min": 0.3322638786179094, "delta0_max": 0.4321867622307894, "delta1_mean": 0.4585209538197537, "delta1_min": 0.42753690377579817, "delta1_max": 0.474169043469301, "price0_mean": 1.6389503518314321, "price0_min": 1.6242753369292657, "price0_max": 1.6453718294313873, "price1_mean": 1.6357233092873837, "price1_min": 1.6168724056186128, "price1_max": 1.646129245847771}, "sampler_perf": {"mean_env_wait_ms": 1.118034677495844, "mean_processing_ms": 12.298422341395266, "mean_inference_ms": 2.0793801244032974}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 277, "num_steps_trained": 13933312, "num_steps_sampled": 4238592, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8277, "num_samples_dropped": 875, "learner_queue": {"size_count": 66040, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 22.578, "replay_time_ms": 114.762, "update_priorities_time_ms": 53.394, "policy_agent_0": {"added_count": 1070336, "sampled_count": 3456000, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1070336, "sampled_count": 3456000, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3614967167377472}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3663286566734314}}}, "timesteps_this_iter": 31232, "done": false, "timesteps_total": 4238592, "episodes_total": 21088, "training_iteration": 85, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-17-58", "timestamp": 1564910278, "time_this_iter_s": 30.81458616256714, "time_total_s": 2602.3901801109314, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17000d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1700bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17761e0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd174e488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2602.3901801109314, "timesteps_since_restore": 4238592, "iterations_since_restore": 85, "num_healthy_workers": 4}
{"episode_reward_max": 63.45942823044769, "episode_reward_min": 48.53107024019177, "episode_reward_mean": 61.95590726599885, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 30.504489167761488, "agent_1": 31.45141809823738}, "custom_metrics": {"delta0_mean": 0.3984715522106572, "delta0_min": 0.3327151493285513, "delta0_max": 0.43422403872397425, "delta1_mean": 0.4606038069511369, "delta1_min": 0.42784074228771246, "delta1_max": 0.4763451075993179, "price0_mean": 1.6396472698849298, "price0_min": 1.6243272571077343, "price0_max": 1.6460538431667497, "price1_mean": 1.6364203460837417, "price1_min": 1.6168997946544796, "price1_max": 1.6467469098700198}, "sampler_perf": {"mean_env_wait_ms": 1.1192286884853457, "mean_processing_ms": 12.382157385861227, "mean_inference_ms": 2.081001213855472}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 280, "num_steps_trained": 14099712, "num_steps_sampled": 4269952, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8338, "num_samples_dropped": 875, "learner_queue": {"size_count": 66689, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.471, "replay_time_ms": 110.903, "update_priorities_time_ms": 55.106, "policy_agent_0": {"added_count": 1077376, "sampled_count": 3494912, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1077376, "sampled_count": 3494912, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36288192868232727}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36351948976516724}}}, "timesteps_this_iter": 31360, "done": false, "timesteps_total": 4269952, "episodes_total": 21232, "training_iteration": 86, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-18-29", "timestamp": 1564910309, "time_this_iter_s": 30.464158296585083, "time_total_s": 2632.8543384075165, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd174e7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fad1dc31730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fad1dc318c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16abb70>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2632.8543384075165, "timesteps_since_restore": 4269952, "iterations_since_restore": 86, "num_healthy_workers": 4}
{"episode_reward_max": 62.9679246449806, "episode_reward_min": 61.79345422715977, "episode_reward_mean": 62.44049355846637, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 31.207366328520756, "agent_1": 31.23312722994562}, "custom_metrics": {"delta0_mean": 0.40105905872948683, "delta0_min": 0.335869017198835, "delta0_max": 0.4365713110257048, "delta1_mean": 0.4627438262246525, "delta1_min": 0.4301986207171737, "delta1_max": 0.47838729775956185, "price0_mean": 1.6403417643306066, "price0_min": 1.6251405539353703, "price0_max": 1.6466951646195533, "price1_mean": 1.6371361021319728, "price1_min": 1.6177804345654625, "price1_max": 1.6473867266209616}, "sampler_perf": {"mean_env_wait_ms": 1.1190570311427568, "mean_processing_ms": 12.467344801549396, "mean_inference_ms": 2.08151595897642}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 284, "num_steps_trained": 14264320, "num_steps_sampled": 4301824, "sample_throughput": 4320.11, "train_throughput": 4320.11, "num_weight_syncs": 8402, "num_samples_dropped": 875, "learner_queue": {"size_count": 67333, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.368, "replay_time_ms": 99.193, "update_priorities_time_ms": 48.971, "policy_agent_0": {"added_count": 1086464, "sampled_count": 3534592, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1086464, "sampled_count": 3534592, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33133628964424133}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3358578383922577}}}, "timesteps_this_iter": 31872, "done": false, "timesteps_total": 4301824, "episodes_total": 21392, "training_iteration": 87, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-19-00", "timestamp": 1564910340, "time_this_iter_s": 30.458472967147827, "time_total_s": 2663.3128113746643, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd175dae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1712730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176e730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd164de18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2663.3128113746643, "timesteps_since_restore": 4301824, "iterations_since_restore": 87, "num_healthy_workers": 4}
{"episode_reward_max": 62.7034182895789, "episode_reward_min": 60.8126685421505, "episode_reward_mean": 61.31025697528613, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 30.257600790173, "agent_1": 31.052656185113143}, "custom_metrics": {"delta0_mean": 0.40298331221434314, "delta0_min": 0.33826314239577543, "delta0_max": 0.4383023727508905, "delta1_mean": 0.4647327199418464, "delta1_min": 0.4324767047164653, "delta1_max": 0.4803003820864538, "price0_mean": 1.6408979300732114, "price0_min": 1.6258224781506438, "price0_max": 1.6471906458873913, "price1_mean": 1.6376400067656398, "price1_min": 1.6184334730306855, "price1_max": 1.6478220088163842}, "sampler_perf": {"mean_env_wait_ms": 1.1193840211275226, "mean_processing_ms": 12.546358722353975, "mean_inference_ms": 2.0823123853168872}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 287, "num_steps_trained": 14421504, "num_steps_sampled": 4333312, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8461, "num_samples_dropped": 875, "learner_queue": {"size_count": 67946, "size_mean": 0.3, "size_std": 0.5385164807134504, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 21.551, "replay_time_ms": 93.441, "update_priorities_time_ms": 47.709, "policy_agent_0": {"added_count": 1094144, "sampled_count": 3571200, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1094144, "sampled_count": 3571200, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.331439346075058}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3012939393520355}}}, "timesteps_this_iter": 31488, "done": false, "timesteps_total": 4333312, "episodes_total": 21552, "training_iteration": 88, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-19-32", "timestamp": 1564910372, "time_this_iter_s": 31.223060369491577, "time_total_s": 2694.535871744156, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd164db70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd164d9d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd164da60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd161d2f0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2694.535871744156, "timesteps_since_restore": 4333312, "iterations_since_restore": 88, "num_healthy_workers": 4}
{"episode_reward_max": 62.10407988675431, "episode_reward_min": 60.91433364520677, "episode_reward_mean": 61.38744738545279, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 30.115456105803922, "agent_1": 31.27199127964887}, "custom_metrics": {"delta0_mean": 0.4047851003428284, "delta0_min": 0.34053720434452867, "delta0_max": 0.4398306225203417, "delta1_mean": 0.46683563117949556, "delta1_min": 0.4348475531203174, "delta1_max": 0.4822820653496347, "price0_mean": 1.641483328261458, "price0_min": 1.6265280683411085, "price0_max": 1.6477203985118192, "price1_mean": 1.6381411100128915, "price1_min": 1.6190810903364397, "price1_max": 1.648239407020059}, "sampler_perf": {"mean_env_wait_ms": 1.1191836526587664, "mean_processing_ms": 12.627272532811054, "mean_inference_ms": 2.083076678537045}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 290, "num_steps_trained": 14581760, "num_steps_sampled": 4364544, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8523, "num_samples_dropped": 875, "learner_queue": {"size_count": 68573, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.691, "replay_time_ms": 107.276, "update_priorities_time_ms": 51.141, "policy_agent_0": {"added_count": 1101696, "sampled_count": 3610112, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1101696, "sampled_count": 3610112, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32651135325431824}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29319968819618225}}}, "timesteps_this_iter": 31232, "done": false, "timesteps_total": 4364544, "episodes_total": 21712, "training_iteration": 89, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-20-03", "timestamp": 1564910403, "time_this_iter_s": 31.25539255142212, "time_total_s": 2725.791264295578, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fad1dc31730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fad1dc318c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16abb70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1627048>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2725.791264295578, "timesteps_since_restore": 4364544, "iterations_since_restore": 89, "num_healthy_workers": 4}
{"episode_reward_max": 62.08145156562405, "episode_reward_min": 60.04742221898783, "episode_reward_mean": 60.683045707947485, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.36805831173765, "agent_1": 31.314987396209833}, "custom_metrics": {"delta0_mean": 0.40581936122166873, "delta0_min": 0.3418960527180576, "delta0_max": 0.4406591614060699, "delta1_mean": 0.46851868272399444, "delta1_min": 0.43670636691166115, "delta1_max": 0.48384283770542813, "price0_mean": 1.6419050643332458, "price0_min": 1.6270282418951763, "price0_max": 1.6481303400309792, "price1_mean": 1.6384350483068966, "price1_min": 1.6194715608220678, "price1_max": 1.6484868794524619}, "sampler_perf": {"mean_env_wait_ms": 1.119793456710997, "mean_processing_ms": 12.765175027966666, "mean_inference_ms": 2.0938500889603144}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 293, "num_steps_trained": 14720768, "num_steps_sampled": 4389632, "sample_throughput": 4442.089, "train_throughput": 0.0, "num_weight_syncs": 8572, "num_samples_dropped": 875, "learner_queue": {"size_count": 69115, "size_mean": 0.2, "size_std": 0.447213595499958, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 29.881, "replay_time_ms": 213.266, "update_priorities_time_ms": 95.613, "policy_agent_0": {"added_count": 1106560, "sampled_count": 3642624, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1106560, "sampled_count": 3642624, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31779706478118896}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.28860414028167725}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 4389632, "episodes_total": 21840, "training_iteration": 90, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-20-42", "timestamp": 1564910442, "time_this_iter_s": 39.262425661087036, "time_total_s": 2765.053689956665, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1627378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16272f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1627400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd162e620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2765.053689956665, "timesteps_since_restore": 4389632, "iterations_since_restore": 90, "num_healthy_workers": 4}
{"episode_reward_max": 62.59544506850601, "episode_reward_min": 59.31991013803166, "episode_reward_mean": 60.66956964155929, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 29.77951872591126, "agent_1": 30.89005091564804}, "custom_metrics": {"delta0_mean": 0.40736066449625047, "delta0_min": 0.34395960215484517, "delta0_max": 0.4418166643832467, "delta1_mean": 0.470319937920448, "delta1_min": 0.4386905151943201, "delta1_max": 0.4855738397740783, "price0_mean": 1.6423909002773898, "price0_min": 1.6276181471766726, "price0_max": 1.6485738905761793, "price1_mean": 1.6388393451863599, "price1_min": 1.6200252693108619, "price1_max": 1.648810774605156}, "sampler_perf": {"mean_env_wait_ms": 1.1203840200235073, "mean_processing_ms": 12.843027291378522, "mean_inference_ms": 2.0942606398010053}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 296, "num_steps_trained": 14885120, "num_steps_sampled": 4421376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8634, "num_samples_dropped": 875, "learner_queue": {"size_count": 69757, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.716, "replay_time_ms": 124.571, "update_priorities_time_ms": 61.315, "policy_agent_0": {"added_count": 1114624, "sampled_count": 3681024, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1114624, "sampled_count": 3681024, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.302458256483078}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29217812418937683}}}, "timesteps_this_iter": 31744, "done": false, "timesteps_total": 4421376, "episodes_total": 22000, "training_iteration": 91, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-21-14", "timestamp": 1564910474, "time_this_iter_s": 31.24750518798828, "time_total_s": 2796.3011951446533, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd161d2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1712730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175dae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1632378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2796.3011951446533, "timesteps_since_restore": 4421376, "iterations_since_restore": 91, "num_healthy_workers": 4}
{"episode_reward_max": 62.58059664816814, "episode_reward_min": 59.04053908566395, "episode_reward_mean": 60.182601553597046, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 29.338014619159082, "agent_1": 30.844586934437956}, "custom_metrics": {"delta0_mean": 0.4085961225871098, "delta0_min": 0.3456755531751591, "delta0_max": 0.44282542546322895, "delta1_mean": 0.4720655930028343, "delta1_min": 0.4405483412734585, "delta1_max": 0.48714558864036056, "price0_mean": 1.6428267427867613, "price0_min": 1.6281323702830188, "price0_max": 1.6489788774800977, "price1_mean": 1.6391596277540466, "price1_min": 1.620473359172789, "price1_max": 1.6490675230114027}, "sampler_perf": {"mean_env_wait_ms": 1.1204855253747688, "mean_processing_ms": 12.923604338723461, "mean_inference_ms": 2.0941601048210723}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 299, "num_steps_trained": 15048704, "num_steps_sampled": 4452736, "sample_throughput": 3156.486, "train_throughput": 0.0, "num_weight_syncs": 8695, "num_samples_dropped": 875, "learner_queue": {"size_count": 70397, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.429, "replay_time_ms": 86.851, "update_priorities_time_ms": 41.024, "policy_agent_0": {"added_count": 1122816, "sampled_count": 3719936, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1122816, "sampled_count": 3719936, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3017314076423645}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2865501046180725}}}, "timesteps_this_iter": 31360, "done": false, "timesteps_total": 4452736, "episodes_total": 22160, "training_iteration": 92, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-21-46", "timestamp": 1564910506, "time_this_iter_s": 31.433712005615234, "time_total_s": 2827.7349071502686, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16326a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1632620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1632730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd163a950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2827.7349071502686, "timesteps_since_restore": 4452736, "iterations_since_restore": 92, "num_healthy_workers": 4}
{"episode_reward_max": 60.39688124118239, "episode_reward_min": 57.50673479522153, "episode_reward_mean": 58.54071179623411, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 29.51037115653998, "agent_1": 29.03034063969414}, "custom_metrics": {"delta0_mean": 0.4104774728221144, "delta0_min": 0.3472128467021136, "delta0_max": 0.4439094770124677, "delta1_mean": 0.47262601433204027, "delta1_min": 0.44128619013061715, "delta1_max": 0.48748790558290017, "price0_mean": 1.6430195910749719, "price0_min": 1.6283462066107155, "price0_max": 1.6490811082543377, "price1_mean": 1.6394754015323514, "price1_min": 1.6207695279761607, "price1_max": 1.6492034546032512}, "sampler_perf": {"mean_env_wait_ms": 1.121330490489716, "mean_processing_ms": 13.004283238889842, "mean_inference_ms": 2.094269289656634}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 303, "num_steps_trained": 15223808, "num_steps_sampled": 4483712, "sample_throughput": 0.0, "train_throughput": 9781.029, "num_weight_syncs": 8756, "num_samples_dropped": 875, "learner_queue": {"size_count": 71082, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.247, "replay_time_ms": 104.129, "update_priorities_time_ms": 47.26, "policy_agent_0": {"added_count": 1130368, "sampled_count": 3763456, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1130368, "sampled_count": 3763456, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2980334162712097}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.28509223461151123}}}, "timesteps_this_iter": 30976, "done": false, "timesteps_total": 4483712, "episodes_total": 22312, "training_iteration": 93, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-22-16", "timestamp": 1564910536, "time_this_iter_s": 30.50457763671875, "time_total_s": 2858.2394847869873, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd162e0d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd162e048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd162e510>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1627598>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2858.2394847869873, "timesteps_since_restore": 4483712, "iterations_since_restore": 93, "num_healthy_workers": 4}
{"episode_reward_max": 60.62526216174597, "episode_reward_min": 55.50474934218739, "episode_reward_mean": 58.01662800131834, "episode_len_mean": 100.0, "episodes_this_iter": 168, "policy_reward_mean": {"agent_0": 29.474682014544992, "agent_1": 28.541945986773335}, "custom_metrics": {"delta0_mean": 0.4106547496728705, "delta0_min": 0.3491682045852617, "delta0_max": 0.44496761002538826, "delta1_mean": 0.47284980229072343, "delta1_min": 0.4418476554189021, "delta1_max": 0.48755235294968674, "price0_mean": 1.6429443178092655, "price0_min": 1.6285276698793008, "price0_max": 1.6491075159389454, "price1_mean": 1.6394296277959763, "price1_min": 1.6211166265253978, "price1_max": 1.6493017342512706}, "sampler_perf": {"mean_env_wait_ms": 1.121755340327479, "mean_processing_ms": 13.066947578749415, "mean_inference_ms": 2.0936892593070824}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 306, "num_steps_trained": 15390976, "num_steps_sampled": 4516608, "sample_throughput": 6126.495, "train_throughput": 12252.991, "num_weight_syncs": 8820, "num_samples_dropped": 875, "learner_queue": {"size_count": 71733, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.488, "replay_time_ms": 113.493, "update_priorities_time_ms": 53.296, "policy_agent_0": {"added_count": 1137664, "sampled_count": 3804160, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1137664, "sampled_count": 3804160, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3009161353111267}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2897576093673706}}}, "timesteps_this_iter": 32896, "done": false, "timesteps_total": 4516608, "episodes_total": 22480, "training_iteration": 94, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-22-47", "timestamp": 1564910567, "time_this_iter_s": 31.168558597564697, "time_total_s": 2889.408043384552, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd161df28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd161d2f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd161d7b8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1650f28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2889.408043384552, "timesteps_since_restore": 4516608, "iterations_since_restore": 94, "num_healthy_workers": 4}
{"episode_reward_max": 58.84725740561036, "episode_reward_min": 53.42225563187282, "episode_reward_mean": 56.85339262647767, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 29.543358609102917, "agent_1": 27.310034017374733}, "custom_metrics": {"delta0_mean": 0.41252114881818824, "delta0_min": 0.3506458387752249, "delta0_max": 0.44610976525408114, "delta1_mean": 0.4723437003073291, "delta1_min": 0.4414710615134925, "delta1_max": 0.48692114742397136, "price0_mean": 1.6428592875018944, "price0_min": 1.628441162807161, "price0_max": 1.6489198134102907, "price1_mean": 1.639641105219382, "price1_min": 1.621277517503846, "price1_max": 1.649384530850808}, "sampler_perf": {"mean_env_wait_ms": 1.1212482803253647, "mean_processing_ms": 13.142083889362448, "mean_inference_ms": 2.092830214203266}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 310, "num_steps_trained": 15563264, "num_steps_sampled": 4548992, "sample_throughput": 4975.957, "train_throughput": 0.0, "num_weight_syncs": 8883, "num_samples_dropped": 875, "learner_queue": {"size_count": 72406, "size_mean": 0.14, "size_std": 0.40049968789001567, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.563, "replay_time_ms": 101.401, "update_priorities_time_ms": 42.67, "policy_agent_0": {"added_count": 1146624, "sampled_count": 3844096, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1146624, "sampled_count": 3844096, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29929083585739136}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30688372254371643}}}, "timesteps_this_iter": 32384, "done": false, "timesteps_total": 4548992, "episodes_total": 22640, "training_iteration": 95, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-23-19", "timestamp": 1564910599, "time_this_iter_s": 31.5036301612854, "time_total_s": 2920.9116735458374, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd162e0d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd162e620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd162e598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd164d2f0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2920.9116735458374, "timesteps_since_restore": 4548992, "iterations_since_restore": 95, "num_healthy_workers": 4}
{"episode_reward_max": 59.296037238546056, "episode_reward_min": 56.493692975334916, "episode_reward_mean": 57.8088249363452, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 29.825334388942508, "agent_1": 27.98349054740269}, "custom_metrics": {"delta0_mean": 0.4139898150427845, "delta0_min": 0.35265008758755256, "delta0_max": 0.44739670247114893, "delta1_mean": 0.47224573874406106, "delta1_min": 0.441547802560277, "delta1_max": 0.486747556433109, "price0_mean": 1.642845804200613, "price0_min": 1.6285306421950443, "price0_max": 1.6488589081199359, "price1_mean": 1.6398270211853707, "price1_min": 1.6216130490391623, "price1_max": 1.6494869919220525}, "sampler_perf": {"mean_env_wait_ms": 1.1221386796695636, "mean_processing_ms": 13.216523153504705, "mean_inference_ms": 2.092228997239153}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 313, "num_steps_trained": 15734528, "num_steps_sampled": 4580736, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 8946, "num_samples_dropped": 875, "learner_queue": {"size_count": 73076, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.035, "replay_time_ms": 75.112, "update_priorities_time_ms": 43.643, "policy_agent_0": {"added_count": 1155072, "sampled_count": 3885312, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1155072, "sampled_count": 3885312, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3073226809501648}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3080974519252777}}}, "timesteps_this_iter": 31744, "done": false, "timesteps_total": 4580736, "episodes_total": 22800, "training_iteration": 96, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-23-50", "timestamp": 1564910630, "time_this_iter_s": 31.273216247558594, "time_total_s": 2952.184889793396, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd164d268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16abb70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16abbf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fad1dc318c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2952.184889793396, "timesteps_since_restore": 4580736, "iterations_since_restore": 96, "num_healthy_workers": 4}
{"episode_reward_max": 59.776694706515016, "episode_reward_min": 55.78999236491718, "episode_reward_mean": 58.01983168944635, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 29.590879253370332, "agent_1": 28.42895243607603}, "custom_metrics": {"delta0_mean": 0.4152928763128621, "delta0_min": 0.3544299527259976, "delta0_max": 0.44856267751941464, "delta1_mean": 0.4724256207392264, "delta1_min": 0.4417819190864692, "delta1_max": 0.48689476836707096, "price0_mean": 1.642885205779205, "price0_min": 1.628636307441319, "price0_max": 1.6488422015765767, "price1_mean": 1.6399993070140035, "price1_min": 1.6219088444169665, "price1_max": 1.6496006984424394}, "sampler_perf": {"mean_env_wait_ms": 1.1221006651759775, "mean_processing_ms": 13.290244080043617, "mean_inference_ms": 2.091644270758731}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 317, "num_steps_trained": 15907072, "num_steps_sampled": 4612608, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9008, "num_samples_dropped": 875, "learner_queue": {"size_count": 73749, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.946, "replay_time_ms": 95.759, "update_priorities_time_ms": 45.996, "policy_agent_0": {"added_count": 1161984, "sampled_count": 3927040, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1161984, "sampled_count": 3927040, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3094569146633148}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32806068658828735}}}, "timesteps_this_iter": 31872, "done": false, "timesteps_total": 4612608, "episodes_total": 22960, "training_iteration": 97, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-24-21", "timestamp": 1564910661, "time_this_iter_s": 30.807921171188354, "time_total_s": 2982.9928109645844, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1650f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd162e598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd162e620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd175d400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 2982.9928109645844, "timesteps_since_restore": 4612608, "iterations_since_restore": 97, "num_healthy_workers": 4}
{"episode_reward_max": 59.76506718544911, "episode_reward_min": 51.72441745123641, "episode_reward_mean": 56.05188181636607, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 26.111852036700498, "agent_1": 29.940029779665572}, "custom_metrics": {"delta0_mean": 0.41508426069683907, "delta0_min": 0.3539884119119385, "delta0_max": 0.44762053357176446, "delta1_mean": 0.4734969014888767, "delta1_min": 0.4429650963529646, "delta1_max": 0.4877236708013328, "price0_mean": 1.6430911242245827, "price0_min": 1.6288627574757435, "price0_max": 1.6489488077980228, "price1_mean": 1.639870837670535, "price1_min": 1.6217840384921267, "price1_max": 1.649307000048943}, "sampler_perf": {"mean_env_wait_ms": 1.1221962277968602, "mean_processing_ms": 13.366884353695719, "mean_inference_ms": 2.0911194525099965}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 320, "num_steps_trained": 16078336, "num_steps_sampled": 4644096, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9069, "num_samples_dropped": 875, "learner_queue": {"size_count": 74418, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.797, "replay_time_ms": 102.724, "update_priorities_time_ms": 43.699, "policy_agent_0": {"added_count": 1169920, "sampled_count": 3967744, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1169920, "sampled_count": 3967744, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3246249854564667}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3364375829696655}}}, "timesteps_this_iter": 31488, "done": false, "timesteps_total": 4644096, "episodes_total": 23112, "training_iteration": 98, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-24-52", "timestamp": 1564910692, "time_this_iter_s": 30.923290252685547, "time_total_s": 3013.91610121727, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd175da60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd175d620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175de18>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176e158>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3013.91610121727, "timesteps_since_restore": 4644096, "iterations_since_restore": 98, "num_healthy_workers": 4}
{"episode_reward_max": 54.41476071727123, "episode_reward_min": 52.30016411689775, "episode_reward_mean": 53.799224195179, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 24.54827018902186, "agent_1": 29.250954006157134}, "custom_metrics": {"delta0_mean": 0.4133684435723904, "delta0_min": 0.35282725612247423, "delta0_max": 0.4456679714070862, "delta1_mean": 0.4741335853031751, "delta1_min": 0.44370903740463913, "delta1_max": 0.48827252432401214, "price0_mean": 1.6430513147770274, "price0_min": 1.628901323594855, "price0_max": 1.6488494210402027, "price1_mean": 1.639354697066125, "price1_min": 1.6214209331035525, "price1_max": 1.648707507927509}, "sampler_perf": {"mean_env_wait_ms": 1.1230833712639439, "mean_processing_ms": 13.44461676629915, "mean_inference_ms": 2.0904418241967053}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 323, "num_steps_trained": 16252928, "num_steps_sampled": 4674944, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9130, "num_samples_dropped": 875, "learner_queue": {"size_count": 75101, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.444, "replay_time_ms": 101.344, "update_priorities_time_ms": 47.843, "policy_agent_0": {"added_count": 1177088, "sampled_count": 4011520, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1177088, "sampled_count": 4011520, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3445773720741272}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32387423515319824}}}, "timesteps_this_iter": 30848, "done": false, "timesteps_total": 4674944, "episodes_total": 23264, "training_iteration": 99, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-25-24", "timestamp": 1564910724, "time_this_iter_s": 31.26739764213562, "time_total_s": 3045.1834988594055, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16abb70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16abbf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd164d268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1776400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3045.1834988594055, "timesteps_since_restore": 4674944, "iterations_since_restore": 99, "num_healthy_workers": 4}
{"episode_reward_max": 54.30464490110959, "episode_reward_min": 52.11599474146836, "episode_reward_mean": 53.14128904031693, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 24.992702003137225, "agent_1": 28.148587037179702}, "custom_metrics": {"delta0_mean": 0.4107541493188343, "delta0_min": 0.3517831325188778, "delta0_max": 0.44409747720592024, "delta1_mean": 0.47407688106010015, "delta1_min": 0.44386639140929246, "delta1_max": 0.48817967327098916, "price0_mean": 1.642719756699341, "price0_min": 1.6287711386675687, "price0_max": 1.6486340736062852, "price1_mean": 1.6386109254298156, "price1_min": 1.6210017804379322, "price1_max": 1.648158313244694}, "sampler_perf": {"mean_env_wait_ms": 1.1225302670469837, "mean_processing_ms": 13.5148298698913, "mean_inference_ms": 2.0901475213953633}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 327, "num_steps_trained": 16431104, "num_steps_sampled": 4706304, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9190, "num_samples_dropped": 875, "learner_queue": {"size_count": 75796, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.443, "replay_time_ms": 82.422, "update_priorities_time_ms": 48.848, "policy_agent_0": {"added_count": 1184512, "sampled_count": 4055808, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1184512, "sampled_count": 4055808, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3610634505748749}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32133960723876953}}}, "timesteps_this_iter": 31360, "done": false, "timesteps_total": 4706304, "episodes_total": 23416, "training_iteration": 100, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-25-55", "timestamp": 1564910755, "time_this_iter_s": 31.444546461105347, "time_total_s": 3076.628045320511, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1776730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1776ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1776840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd170c400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3076.628045320511, "timesteps_since_restore": 4706304, "iterations_since_restore": 100, "num_healthy_workers": 4}
{"episode_reward_max": 53.86227829534753, "episode_reward_min": 51.52231821472478, "episode_reward_mean": 52.72898574423709, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 24.45744139807879, "agent_1": 28.271544346158294}, "custom_metrics": {"delta0_mean": 0.4095443879766639, "delta0_min": 0.3503983306694636, "delta0_max": 0.4420562874010201, "delta1_mean": 0.474170154871261, "delta1_min": 0.44419423241765743, "delta1_max": 0.4881290488858028, "price0_mean": 1.642588802467209, "price0_min": 1.6286854689226684, "price0_max": 1.6483871264355372, "price1_mean": 1.6381190615351435, "price1_min": 1.6205258910320948, "price1_max": 1.6474825384911618}, "sampler_perf": {"mean_env_wait_ms": 1.1228014535882107, "mean_processing_ms": 13.589070529883742, "mean_inference_ms": 2.0906948183934944}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 330, "num_steps_trained": 16609536, "num_steps_sampled": 4737280, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9251, "num_samples_dropped": 875, "learner_queue": {"size_count": 76493, "size_mean": 0.24, "size_std": 0.512249938994628, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 20.846, "replay_time_ms": 101.541, "update_priorities_time_ms": 51.321, "policy_agent_0": {"added_count": 1191808, "sampled_count": 4098816, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1191808, "sampled_count": 4098816, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3833255469799042}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32802319526672363}}}, "timesteps_this_iter": 30976, "done": false, "timesteps_total": 4737280, "episodes_total": 23576, "training_iteration": 101, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-26-26", "timestamp": 1564910786, "time_this_iter_s": 30.97151780128479, "time_total_s": 3107.5995631217957, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1650f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176e158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175de18>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1712378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3107.5995631217957, "timesteps_since_restore": 4737280, "iterations_since_restore": 101, "num_healthy_workers": 4}
{"episode_reward_max": 57.000383067359444, "episode_reward_min": 51.41794948433028, "episode_reward_mean": 53.378516360898374, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 25.211053344839417, "agent_1": 28.16746301605896}, "custom_metrics": {"delta0_mean": 0.40834672235352737, "delta0_min": 0.3497027416988359, "delta0_max": 0.44041378057266517, "delta1_mean": 0.4741735814661787, "delta1_min": 0.4443146757359762, "delta1_max": 0.48832382761695564, "price0_mean": 1.6424130518706783, "price0_min": 1.6285836640988773, "price0_max": 1.6481737969358747, "price1_mean": 1.6376733646174217, "price1_min": 1.6202135006565825, "price1_max": 1.646923047078092}, "sampler_perf": {"mean_env_wait_ms": 1.1232529773235553, "mean_processing_ms": 13.664076920684838, "mean_inference_ms": 2.0899487358066375}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 334, "num_steps_trained": 16789760, "num_steps_sampled": 4768000, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9311, "num_samples_dropped": 875, "learner_queue": {"size_count": 77197, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.834, "replay_time_ms": 101.874, "update_priorities_time_ms": 47.272, "policy_agent_0": {"added_count": 1200512, "sampled_count": 4143360, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1200512, "sampled_count": 4143360, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4209524393081665}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31548961997032166}}}, "timesteps_this_iter": 30720, "done": false, "timesteps_total": 4768000, "episodes_total": 23720, "training_iteration": 102, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-26-57", "timestamp": 1564910817, "time_this_iter_s": 30.37241840362549, "time_total_s": 3137.971981525421, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17127b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1712d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1712d08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1726950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3137.971981525421, "timesteps_since_restore": 4768000, "iterations_since_restore": 102, "num_healthy_workers": 4}
{"episode_reward_max": 53.35883154830223, "episode_reward_min": 50.57894349852716, "episode_reward_mean": 51.77204134196563, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 24.871202652310707, "agent_1": 26.900838689654933}, "custom_metrics": {"delta0_mean": 0.4068316046418258, "delta0_min": 0.3486548834394234, "delta0_max": 0.4386580867384072, "delta1_mean": 0.47342437549133487, "delta1_min": 0.4437591238884714, "delta1_max": 0.4874381818741262, "price0_mean": 1.6420223678460903, "price0_min": 1.6282842740552272, "price0_max": 1.6477254918121778, "price1_mean": 1.6370768565211917, "price1_min": 1.619751109744078, "price1_max": 1.6462538658778278}, "sampler_perf": {"mean_env_wait_ms": 1.1230550406938837, "mean_processing_ms": 13.736037523678794, "mean_inference_ms": 2.08913225316522}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 338, "num_steps_trained": 16967168, "num_steps_sampled": 4799232, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9372, "num_samples_dropped": 875, "learner_queue": {"size_count": 77890, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.758, "replay_time_ms": 78.043, "update_priorities_time_ms": 46.672, "policy_agent_0": {"added_count": 1208064, "sampled_count": 4187648, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1208064, "sampled_count": 4187648, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43828192353248596}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3232342004776001}}}, "timesteps_this_iter": 31232, "done": false, "timesteps_total": 4799232, "episodes_total": 23880, "training_iteration": 103, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-27-29", "timestamp": 1564910849, "time_this_iter_s": 31.120251178741455, "time_total_s": 3169.0922327041626, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1726488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1726ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17267b8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1722620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3169.0922327041626, "timesteps_since_restore": 4799232, "iterations_since_restore": 103, "num_healthy_workers": 4}
{"episode_reward_max": 52.66322605114752, "episode_reward_min": 48.60565040218874, "episode_reward_mean": 50.27014811009358, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 24.831043431560346, "agent_1": 25.439104678533244}, "custom_metrics": {"delta0_mean": 0.40595104858734676, "delta0_min": 0.34762328569177386, "delta0_max": 0.4369727983890038, "delta1_mean": 0.47192356742165825, "delta1_min": 0.44245324277174103, "delta1_max": 0.4858221102994851, "price0_mean": 1.641502037652071, "price0_min": 1.6278061268512851, "price0_max": 1.6470407646871938, "price1_mean": 1.6365626789265788, "price1_min": 1.6192639647378426, "price1_max": 1.6455506287224935}, "sampler_perf": {"mean_env_wait_ms": 1.1224816652783072, "mean_processing_ms": 13.809266836782315, "mean_inference_ms": 2.0898372497392934}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 341, "num_steps_trained": 17141760, "num_steps_sampled": 4830720, "sample_throughput": 0.0, "train_throughput": 42828.041, "num_weight_syncs": 9433, "num_samples_dropped": 875, "learner_queue": {"size_count": 78572, "size_mean": 0.14, "size_std": 0.40049968789001567, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.208, "replay_time_ms": 90.663, "update_priorities_time_ms": 53.885, "policy_agent_0": {"added_count": 1215232, "sampled_count": 4232192, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1215232, "sampled_count": 4232192, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4543455243110657}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33811870217323303}}}, "timesteps_this_iter": 31488, "done": false, "timesteps_total": 4830720, "episodes_total": 24032, "training_iteration": 104, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-28-00", "timestamp": 1564910880, "time_this_iter_s": 31.291205644607544, "time_total_s": 3200.38343834877, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1712d90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1712d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17127b8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17372f0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3200.38343834877, "timesteps_since_restore": 4830720, "iterations_since_restore": 104, "num_healthy_workers": 4}
{"episode_reward_max": 53.25176647428733, "episode_reward_min": 47.15674657222898, "episode_reward_mean": 49.891862006220215, "episode_len_mean": 100.0, "episodes_this_iter": 160, "policy_reward_mean": {"agent_0": 25.885600461357, "agent_1": 24.006261544863204}, "custom_metrics": {"delta0_mean": 0.4045044195876777, "delta0_min": 0.34712858417943515, "delta0_max": 0.4359180068345053, "delta1_mean": 0.4694787814151198, "delta1_min": 0.43987348782524693, "delta1_max": 0.48330160484880974, "price0_mean": 1.6406681258823554, "price0_min": 1.6270383429079285, "price0_max": 1.646328643072349, "price1_mean": 1.6359527064319408, "price1_min": 1.618869532267219, "price1_max": 1.645002129680644}, "sampler_perf": {"mean_env_wait_ms": 1.1230435987187164, "mean_processing_ms": 13.874579852922256, "mean_inference_ms": 2.0890246474699117}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 345, "num_steps_trained": 17318144, "num_steps_sampled": 4861696, "sample_throughput": 3728.814, "train_throughput": 0.0, "num_weight_syncs": 9494, "num_samples_dropped": 875, "learner_queue": {"size_count": 79261, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 13.707, "replay_time_ms": 93.188, "update_priorities_time_ms": 46.708, "policy_agent_0": {"added_count": 1222528, "sampled_count": 4278016, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1222528, "sampled_count": 4278016, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.439145028591156}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3603077530860901}}}, "timesteps_this_iter": 30976, "done": false, "timesteps_total": 4861696, "episodes_total": 24192, "training_iteration": 105, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-28-32", "timestamp": 1564910912, "time_this_iter_s": 31.49427103996277, "time_total_s": 3231.877709388733, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1697158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16970d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c0048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c90d0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3231.877709388733, "timesteps_since_restore": 4861696, "iterations_since_restore": 105, "num_healthy_workers": 4}
{"episode_reward_max": 48.38273123682586, "episode_reward_min": 43.24280987909773, "episode_reward_mean": 45.65524169465603, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 25.421066140741907, "agent_1": 20.234175553914124}, "custom_metrics": {"delta0_mean": 0.4034771283577606, "delta0_min": 0.34646118352824246, "delta0_max": 0.4347475617296692, "delta1_mean": 0.46534512599662126, "delta1_min": 0.4359170381529062, "delta1_max": 0.4790944156831899, "price0_mean": 1.639509365334518, "price0_min": 1.6259617152544168, "price0_max": 1.6451388092224721, "price1_mean": 1.6354997759558414, "price1_min": 1.6185222763607006, "price1_max": 1.644504542476283}, "sampler_perf": {"mean_env_wait_ms": 1.1227171193048402, "mean_processing_ms": 13.949440623106439, "mean_inference_ms": 2.089615765974869}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 348, "num_steps_trained": 17504000, "num_steps_sampled": 4890240, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9550, "num_samples_dropped": 875, "learner_queue": {"size_count": 79987, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.917, "replay_time_ms": 65.903, "update_priorities_time_ms": 38.619, "policy_agent_0": {"added_count": 1230464, "sampled_count": 4324864, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1230464, "sampled_count": 4324864, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4508454203605652}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39906859397888184}}}, "timesteps_this_iter": 28544, "done": false, "timesteps_total": 4890240, "episodes_total": 24336, "training_iteration": 106, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-29-03", "timestamp": 1564910943, "time_this_iter_s": 30.431759357452393, "time_total_s": 3262.3094687461853, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd175de18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1722620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176e158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16ea598>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3262.3094687461853, "timesteps_since_restore": 4890240, "iterations_since_restore": 106, "num_healthy_workers": 4}
{"episode_reward_max": 60.57471293559856, "episode_reward_min": 44.22165371286486, "episode_reward_mean": 53.26975297260611, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 29.872129353228, "agent_1": 23.397623619378095}, "custom_metrics": {"delta0_mean": 0.4043102678659951, "delta0_min": 0.3483275028014909, "delta0_max": 0.4358873567463178, "delta1_mean": 0.46274739485278255, "delta1_min": 0.4335011167099959, "delta1_max": 0.47651204388399937, "price0_mean": 1.6388881587037272, "price0_min": 1.625484249450069, "price0_max": 1.644601352550016, "price1_mean": 1.6355522883276743, "price1_min": 1.6188071744289365, "price1_max": 1.6446016782816169}, "sampler_perf": {"mean_env_wait_ms": 1.1225120752459294, "mean_processing_ms": 14.018633048399678, "mean_inference_ms": 2.0902669591389267}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 352, "num_steps_trained": 17682944, "num_steps_sampled": 4920320, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9609, "num_samples_dropped": 875, "learner_queue": {"size_count": 80686, "size_mean": 0.2, "size_std": 0.447213595499958, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 24.373, "replay_time_ms": 137.749, "update_priorities_time_ms": 64.054, "policy_agent_0": {"added_count": 1239296, "sampled_count": 4367104, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1239296, "sampled_count": 4367104, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4402793049812317}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4635397791862488}}}, "timesteps_this_iter": 30080, "done": false, "timesteps_total": 4920320, "episodes_total": 24488, "training_iteration": 107, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-29-34", "timestamp": 1564910974, "time_this_iter_s": 31.413340091705322, "time_total_s": 3293.7228088378906, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16ea400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16ea268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16eaa60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16fcd90>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3293.7228088378906, "timesteps_since_restore": 4920320, "iterations_since_restore": 107, "num_healthy_workers": 4}
{"episode_reward_max": 60.25447419611428, "episode_reward_min": 56.041970369188306, "episode_reward_mean": 58.33236350147995, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 33.540116537079506, "agent_1": 24.79224696440045}, "custom_metrics": {"delta0_mean": 0.40805030312126667, "delta0_min": 0.35188542234192793, "delta0_max": 0.43883955280838766, "delta1_mean": 0.46109568710805937, "delta1_min": 0.43191127275251195, "delta1_max": 0.4748663188359825, "price0_mean": 1.6388233500577654, "price0_min": 1.6254261675885457, "price0_max": 1.6444430488199848, "price1_mean": 1.6362538619933562, "price1_min": 1.6195139470217585, "price1_max": 1.6451352417246963}, "sampler_perf": {"mean_env_wait_ms": 1.122356791945152, "mean_processing_ms": 14.084943100342636, "mean_inference_ms": 2.091041767920158}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 355, "num_steps_trained": 17859072, "num_steps_sampled": 4951040, "sample_throughput": 0.0, "train_throughput": 38950.26, "num_weight_syncs": 9668, "num_samples_dropped": 875, "learner_queue": {"size_count": 81374, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.595, "replay_time_ms": 100.819, "update_priorities_time_ms": 49.224, "policy_agent_0": {"added_count": 1246848, "sampled_count": 4411904, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1246848, "sampled_count": 4411904, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4192381799221039}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46574097871780396}}}, "timesteps_this_iter": 30720, "done": false, "timesteps_total": 4951040, "episodes_total": 24632, "training_iteration": 108, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-30-05", "timestamp": 1564911005, "time_this_iter_s": 30.48454713821411, "time_total_s": 3324.2073559761047, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c90d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c0048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16970d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1682400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3324.2073559761047, "timesteps_since_restore": 4951040, "iterations_since_restore": 108, "num_healthy_workers": 4}
{"episode_reward_max": 57.5505432061535, "episode_reward_min": 54.833750123593916, "episode_reward_mean": 56.28297031223353, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 33.665490250040754, "agent_1": 22.61748006219278}, "custom_metrics": {"delta0_mean": 0.41199442894710403, "delta0_min": 0.35547761849327963, "delta0_max": 0.4422171597455014, "delta1_mean": 0.4581731584622132, "delta1_min": 0.42940228538631164, "delta1_max": 0.4715763135719695, "price0_mean": 1.6385028895210234, "price0_min": 1.6251741105198514, "price0_max": 1.6439933681488652, "price1_mean": 1.636990055943869, "price1_min": 1.620221515203934, "price1_max": 1.6457478320957228}, "sampler_perf": {"mean_env_wait_ms": 1.1223988746111753, "mean_processing_ms": 14.162021961412444, "mean_inference_ms": 2.0908088098341024}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 359, "num_steps_trained": 18035456, "num_steps_sampled": 4981248, "sample_throughput": 0.0, "train_throughput": 32036.694, "num_weight_syncs": 9727, "num_samples_dropped": 875, "learner_queue": {"size_count": 82064, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.64, "replay_time_ms": 87.781, "update_priorities_time_ms": 45.568, "policy_agent_0": {"added_count": 1254784, "sampled_count": 4458240, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1254784, "sampled_count": 4458240, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38337963819503784}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4815710484981537}}}, "timesteps_this_iter": 30208, "done": false, "timesteps_total": 4981248, "episodes_total": 24784, "training_iteration": 109, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-30-36", "timestamp": 1564911036, "time_this_iter_s": 31.551835298538208, "time_total_s": 3355.759191274643, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16669d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1666a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1666c80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16737b8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3355.759191274643, "timesteps_since_restore": 4981248, "iterations_since_restore": 109, "num_healthy_workers": 4}
{"episode_reward_max": 57.266585178712376, "episode_reward_min": 53.88129761035246, "episode_reward_mean": 56.006821774293584, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 33.87931782048023, "agent_1": 22.12750395381336}, "custom_metrics": {"delta0_mean": 0.41474119943777293, "delta0_min": 0.3590335348630806, "delta0_max": 0.4453734451267979, "delta1_mean": 0.4551573806000573, "delta1_min": 0.4265768571186467, "delta1_max": 0.46855448665919097, "price0_mean": 1.6380602199721837, "price0_min": 1.6248587783172495, "price0_max": 1.6435891523456818, "price1_mean": 1.6375176248587366, "price1_min": 1.6209340056951207, "price1_max": 1.6463323721728667}, "sampler_perf": {"mean_env_wait_ms": 1.1217616340972152, "mean_processing_ms": 14.22921896673304, "mean_inference_ms": 2.0910015087800686}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 362, "num_steps_trained": 18213632, "num_steps_sampled": 5011200, "sample_throughput": 0.0, "train_throughput": 19584.894, "num_weight_syncs": 9785, "num_samples_dropped": 875, "learner_queue": {"size_count": 82761, "size_mean": 0.28, "size_std": 0.49152822909778027, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.161, "replay_time_ms": 74.322, "update_priorities_time_ms": 43.379, "policy_agent_0": {"added_count": 1262592, "sampled_count": 4503296, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1262592, "sampled_count": 4503296, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34523773193359375}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5227364897727966}}}, "timesteps_this_iter": 29952, "done": false, "timesteps_total": 5011200, "episodes_total": 24928, "training_iteration": 110, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-31-07", "timestamp": 1564911067, "time_this_iter_s": 30.864187002182007, "time_total_s": 3386.623378276825, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1722620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16fcd90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175de18>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd167c6a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3386.623378276825, "timesteps_since_restore": 5011200, "iterations_since_restore": 110, "num_healthy_workers": 4}
{"episode_reward_max": 56.62535474539714, "episode_reward_min": 51.06831525237089, "episode_reward_mean": 54.948427299311895, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 33.90244668690607, "agent_1": 21.045980612405845}, "custom_metrics": {"delta0_mean": 0.41873513566813186, "delta0_min": 0.36263526149350994, "delta0_max": 0.4487777380382754, "delta1_mean": 0.45145439201890436, "delta1_min": 0.4231914776550025, "delta1_max": 0.4646504014099962, "price0_mean": 1.6376003800235808, "price0_min": 1.6244411083754249, "price0_max": 1.6430209593030676, "price1_mean": 1.6382980238473899, "price1_min": 1.6216757538715474, "price1_max": 1.646981159830266}, "sampler_perf": {"mean_env_wait_ms": 1.122196913970918, "mean_processing_ms": 14.299959724324516, "mean_inference_ms": 2.090925921452238}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 366, "num_steps_trained": 18388224, "num_steps_sampled": 5040384, "sample_throughput": 0.0, "train_throughput": 42681.632, "num_weight_syncs": 9842, "num_samples_dropped": 875, "learner_queue": {"size_count": 83441, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 22.685, "replay_time_ms": 104.253, "update_priorities_time_ms": 52.769, "policy_agent_0": {"added_count": 1269248, "sampled_count": 4546048, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1269248, "sampled_count": 4546048, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3081759512424469}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5646381974220276}}}, "timesteps_this_iter": 29184, "done": false, "timesteps_total": 5040384, "episodes_total": 25080, "training_iteration": 111, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-31-38", "timestamp": 1564911098, "time_this_iter_s": 30.9620418548584, "time_total_s": 3417.5854201316833, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd167c9d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd167cea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd167cc80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd163ad90>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3417.5854201316833, "timesteps_since_restore": 5040384, "iterations_since_restore": 111, "num_healthy_workers": 4}
{"episode_reward_max": 63.59129842508827, "episode_reward_min": 45.17022417838326, "episode_reward_mean": 54.80121352073638, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 33.60747954591752, "agent_1": 21.19373397481885}, "custom_metrics": {"delta0_mean": 0.42090975144076925, "delta0_min": 0.36655800242063974, "delta0_max": 0.4514371545601357, "delta1_mean": 0.44784503593536845, "delta1_min": 0.41940726457921423, "delta1_max": 0.46111751442093296, "price0_mean": 1.6370078193291588, "price0_min": 1.6239804021857434, "price0_max": 1.6425593622304109, "price1_mean": 1.6387972920697618, "price1_min": 1.6225132655706396, "price1_max": 1.6475919422802678}, "sampler_perf": {"mean_env_wait_ms": 1.1227275647155694, "mean_processing_ms": 14.365878027859349, "mean_inference_ms": 2.0889455415895664}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 369, "num_steps_trained": 18558208, "num_steps_sampled": 5071744, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 9904, "num_samples_dropped": 875, "learner_queue": {"size_count": 84105, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 21.244, "replay_time_ms": 92.444, "update_priorities_time_ms": 50.243, "policy_agent_0": {"added_count": 1277568, "sampled_count": 4587264, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1277568, "sampled_count": 4587264, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29867470264434814}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5942767858505249}}}, "timesteps_this_iter": 31360, "done": false, "timesteps_total": 5071744, "episodes_total": 25232, "training_iteration": 112, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-32-10", "timestamp": 1564911130, "time_this_iter_s": 31.42516779899597, "time_total_s": 3449.0105879306793, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd167c730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd167cf28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd167c598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15c3ae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3449.0105879306793, "timesteps_since_restore": 5071744, "iterations_since_restore": 112, "num_healthy_workers": 4}
{"episode_reward_max": 60.1396491429283, "episode_reward_min": 50.215041639820996, "episode_reward_mean": 55.88839326285389, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 34.262620342039604, "agent_1": 21.625772920814267}, "custom_metrics": {"delta0_mean": 0.42552378626042286, "delta0_min": 0.37026064165278705, "delta0_max": 0.45492300261540597, "delta1_mean": 0.4445577546654432, "delta1_min": 0.41643705145764875, "delta1_max": 0.45764903058537215, "price0_mean": 1.636713626168438, "price0_min": 1.6236763323305303, "price0_max": 1.6421422459111228, "price1_mean": 1.6397129618370998, "price1_min": 1.623289703396639, "price1_max": 1.6482748411796742}, "sampler_perf": {"mean_env_wait_ms": 1.123840819745494, "mean_processing_ms": 14.433246274815737, "mean_inference_ms": 2.0894399277727214}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 373, "num_steps_trained": 18734080, "num_steps_sampled": 5101696, "sample_throughput": 0.0, "train_throughput": 13921.918, "num_weight_syncs": 9963, "num_samples_dropped": 875, "learner_queue": {"size_count": 84792, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.676, "replay_time_ms": 97.283, "update_priorities_time_ms": 50.934, "policy_agent_0": {"added_count": 1286272, "sampled_count": 4631040, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1286272, "sampled_count": 4631040, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2735646069049835}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6111412644386292}}}, "timesteps_this_iter": 29952, "done": false, "timesteps_total": 5101696, "episodes_total": 25384, "training_iteration": 113, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-32-41", "timestamp": 1564911161, "time_this_iter_s": 31.06296968460083, "time_total_s": 3480.07355761528, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15c3b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15c3bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15c3ea0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15d4158>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3480.07355761528, "timesteps_since_restore": 5101696, "iterations_since_restore": 113, "num_healthy_workers": 4}
{"episode_reward_max": 64.72266350316161, "episode_reward_min": 53.555447587844085, "episode_reward_mean": 57.40622141838713, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 35.60921222496538, "agent_1": 21.797009193421758}, "custom_metrics": {"delta0_mean": 0.4286985986002373, "delta0_min": 0.37511290320308577, "delta0_max": 0.4587509949987283, "delta1_mean": 0.44133648972448375, "delta1_min": 0.4136148017392843, "delta1_max": 0.45470466265958737, "price0_mean": 1.6363417613042155, "price0_min": 1.6235915818858366, "price0_max": 1.6417825040085956, "price1_mean": 1.6403979971897027, "price1_min": 1.6243639052921552, "price1_max": 1.649057549012232}, "sampler_perf": {"mean_env_wait_ms": 1.1242827984362662, "mean_processing_ms": 14.49232348273214, "mean_inference_ms": 2.0889683984955143}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 376, "num_steps_trained": 18912000, "num_steps_sampled": 5130880, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10020, "num_samples_dropped": 875, "learner_queue": {"size_count": 85487, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.008, "replay_time_ms": 98.485, "update_priorities_time_ms": 42.789, "policy_agent_0": {"added_count": 1292672, "sampled_count": 4675072, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1292672, "sampled_count": 4675072, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2599087953567505}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6352498531341553}}}, "timesteps_this_iter": 29184, "done": false, "timesteps_total": 5130880, "episodes_total": 25536, "training_iteration": 114, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-33-12", "timestamp": 1564911192, "time_this_iter_s": 31.31162142753601, "time_total_s": 3511.385179042816, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16fcd90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd163aea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1722620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15d4e18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3511.385179042816, "timesteps_since_restore": 5130880, "iterations_since_restore": 114, "num_healthy_workers": 4}
{"episode_reward_max": 64.89223151975297, "episode_reward_min": 52.47934031341505, "episode_reward_mean": 58.312995192019066, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 36.13777487499577, "agent_1": 22.175220317023282}, "custom_metrics": {"delta0_mean": 0.4334382827494151, "delta0_min": 0.37952050190997233, "delta0_max": 0.4627370465115999, "delta1_mean": 0.43856501863424996, "delta1_min": 0.41076213659169397, "delta1_max": 0.4527027946296247, "price0_mean": 1.6362530803433981, "price0_min": 1.6234695305640998, "price0_max": 1.64151766631949, "price1_mean": 1.6414113503304781, "price1_min": 1.6253660505596945, "price1_max": 1.6498763742900606}, "sampler_perf": {"mean_env_wait_ms": 1.123691090660032, "mean_processing_ms": 14.555094661178401, "mean_inference_ms": 2.089179403079685}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 380, "num_steps_trained": 19092224, "num_steps_sampled": 5160320, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10077, "num_samples_dropped": 875, "learner_queue": {"size_count": 86191, "size_mean": 0.3, "size_std": 0.5744562646538027, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.132, "replay_time_ms": 92.905, "update_priorities_time_ms": 47.697, "policy_agent_0": {"added_count": 1300736, "sampled_count": 4719872, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1300736, "sampled_count": 4719872, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.24717018008232117}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6490217447280884}}}, "timesteps_this_iter": 29440, "done": false, "timesteps_total": 5160320, "episodes_total": 25680, "training_iteration": 115, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-33-43", "timestamp": 1564911223, "time_this_iter_s": 30.513246297836304, "time_total_s": 3541.8984253406525, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15e0158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15e01e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15e0268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15de488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3541.8984253406525, "timesteps_since_restore": 5160320, "iterations_since_restore": 115, "num_healthy_workers": 4}
{"episode_reward_max": 64.0545625441945, "episode_reward_min": 49.68178784530193, "episode_reward_mean": 58.471639361588636, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 36.002730151682734, "agent_1": 22.468909209905902}, "custom_metrics": {"delta0_mean": 0.4372571301610312, "delta0_min": 0.3843295668098149, "delta0_max": 0.46668976011192465, "delta1_mean": 0.43576575376566196, "delta1_min": 0.40728464632784406, "delta1_max": 0.4515704567049102, "price0_mean": 1.636047550656848, "price0_min": 1.6232115540842105, "price0_max": 1.6412306829506638, "price1_mean": 1.6422280836829708, "price1_min": 1.6263934119084196, "price1_max": 1.6506786940157687}, "sampler_perf": {"mean_env_wait_ms": 1.1234631728973359, "mean_processing_ms": 14.62459724771915, "mean_inference_ms": 2.087549345714177}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 384, "num_steps_trained": 19277312, "num_steps_sampled": 5189376, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10133, "num_samples_dropped": 875, "learner_queue": {"size_count": 86915, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.723, "replay_time_ms": 83.416, "update_priorities_time_ms": 39.665, "policy_agent_0": {"added_count": 1308416, "sampled_count": 4766208, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1308416, "sampled_count": 4766208, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.23512761294841766}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6585203409194946}}}, "timesteps_this_iter": 29056, "done": false, "timesteps_total": 5189376, "episodes_total": 25832, "training_iteration": 116, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-34-14", "timestamp": 1564911254, "time_this_iter_s": 31.148619890213013, "time_total_s": 3573.0470452308655, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15d19d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15d1a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15d1f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15c3f28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3573.0470452308655, "timesteps_since_restore": 5189376, "iterations_since_restore": 116, "num_healthy_workers": 4}
{"episode_reward_max": 66.40216474285859, "episode_reward_min": 55.137903687502295, "episode_reward_mean": 62.53862553429238, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 37.98016455763205, "agent_1": 24.558460976660335}, "custom_metrics": {"delta0_mean": 0.4428045516251731, "delta0_min": 0.3901330823614398, "delta0_max": 0.471495433370636, "delta1_mean": 0.4342417523617692, "delta1_min": 0.40664674280135904, "delta1_max": 0.4505524084182967, "price0_mean": 1.6364776419485119, "price0_min": 1.6239786060451167, "price0_max": 1.6416107199747536, "price1_mean": 1.6435700570100054, "price1_min": 1.6279365744768495, "price1_max": 1.6518629434409313}, "sampler_perf": {"mean_env_wait_ms": 1.1237932479362909, "mean_processing_ms": 14.692676875150356, "mean_inference_ms": 2.0887775340698806}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 387, "num_steps_trained": 19453952, "num_steps_sampled": 5218944, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10192, "num_samples_dropped": 875, "learner_queue": {"size_count": 87604, "size_mean": 0.18, "size_std": 0.3841874542459709, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 21.853, "replay_time_ms": 102.033, "update_priorities_time_ms": 51.298, "policy_agent_0": {"added_count": 1317504, "sampled_count": 4809216, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1317504, "sampled_count": 4809216, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2369324117898941}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6476448774337769}}}, "timesteps_this_iter": 29568, "done": false, "timesteps_total": 5218944, "episodes_total": 25976, "training_iteration": 117, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-34-46", "timestamp": 1564911286, "time_this_iter_s": 31.044617176055908, "time_total_s": 3604.0916624069214, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15c32f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15c3598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15c39d8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1602a60>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3604.0916624069214, "timesteps_since_restore": 5218944, "iterations_since_restore": 117, "num_healthy_workers": 4}
{"episode_reward_max": 66.69618075752565, "episode_reward_min": 54.447360833859264, "episode_reward_mean": 64.57980716353828, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 39.430638506062856, "agent_1": 25.14916865747542}, "custom_metrics": {"delta0_mean": 0.44848880819503223, "delta0_min": 0.3969341217532104, "delta0_max": 0.47757971391803317, "delta1_mean": 0.4329888558185242, "delta1_min": 0.4053554510204585, "delta1_max": 0.44931467634112804, "price0_mean": 1.6371355973541692, "price0_min": 1.62493966147698, "price0_max": 1.642405536149763, "price1_mean": 1.6450828574707337, "price1_min": 1.6289180752551333, "price1_max": 1.6535325982826592}, "sampler_perf": {"mean_env_wait_ms": 1.123916422885384, "mean_processing_ms": 14.75877592217772, "mean_inference_ms": 2.0893588606868114}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 391, "num_steps_trained": 19638272, "num_steps_sampled": 5247104, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10247, "num_samples_dropped": 875, "learner_queue": {"size_count": 88324, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 11.376, "replay_time_ms": 83.76, "update_priorities_time_ms": 52.106, "policy_agent_0": {"added_count": 1325696, "sampled_count": 4854784, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1325696, "sampled_count": 4854784, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.23037397861480713}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6168632507324219}}}, "timesteps_this_iter": 28160, "done": false, "timesteps_total": 5247104, "episodes_total": 26120, "training_iteration": 118, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-35-17", "timestamp": 1564911317, "time_this_iter_s": 30.821656942367554, "time_total_s": 3634.913319349289, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15c3488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15e01e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15e0158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd167c488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3634.913319349289, "timesteps_since_restore": 5247104, "iterations_since_restore": 118, "num_healthy_workers": 4}
{"episode_reward_max": 66.47751028255459, "episode_reward_min": 57.60000423716319, "episode_reward_mean": 64.84298274887732, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 39.99729209622146, "agent_1": 24.845690652655883}, "custom_metrics": {"delta0_mean": 0.45438704482343856, "delta0_min": 0.40347711786190465, "delta0_max": 0.4835251870761001, "delta1_mean": 0.43160125947412564, "delta1_min": 0.4039651316080298, "delta1_max": 0.4474461487066094, "price0_mean": 1.6378122997089923, "price0_min": 1.6257522219603806, "price0_max": 1.6431146713663332, "price1_mean": 1.6466476234446652, "price1_min": 1.6298277918751258, "price1_max": 1.6551208743582355}, "sampler_perf": {"mean_env_wait_ms": 1.123603628316741, "mean_processing_ms": 14.825742617147013, "mean_inference_ms": 2.0891972624084207}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 394, "num_steps_trained": 19814656, "num_steps_sampled": 5276160, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10304, "num_samples_dropped": 875, "learner_queue": {"size_count": 89013, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.533, "replay_time_ms": 96.37, "update_priorities_time_ms": 55.238, "policy_agent_0": {"added_count": 1332480, "sampled_count": 4900352, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1332480, "sampled_count": 4900352, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.21530310809612274}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5905986428260803}}}, "timesteps_this_iter": 29056, "done": false, "timesteps_total": 5276160, "episodes_total": 26264, "training_iteration": 119, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-35-48", "timestamp": 1564911348, "time_this_iter_s": 30.626394987106323, "time_total_s": 3665.5397143363953, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1673a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1673d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1673b70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1666950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3665.5397143363953, "timesteps_since_restore": 5276160, "iterations_since_restore": 119, "num_healthy_workers": 4}
{"episode_reward_max": 66.47741023331265, "episode_reward_min": 63.53191043783983, "episode_reward_mean": 64.72444054453301, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 39.685092921915306, "agent_1": 25.039347622617704}, "custom_metrics": {"delta0_mean": 0.460070023780808, "delta0_min": 0.4094273031640756, "delta0_max": 0.4890006001017049, "delta1_mean": 0.4303228360435376, "delta1_min": 0.40291130867630387, "delta1_max": 0.44578476359439434, "price0_mean": 1.6384142862993405, "price0_min": 1.6264494239687561, "price0_max": 1.6436537763093462, "price1_mean": 1.648103992367032, "price1_min": 1.6314005436879553, "price1_max": 1.6565005468716836}, "sampler_perf": {"mean_env_wait_ms": 1.1236197962220351, "mean_processing_ms": 14.885657649498004, "mean_inference_ms": 2.0887557039673257}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 398, "num_steps_trained": 19994112, "num_steps_sampled": 5305088, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10360, "num_samples_dropped": 875, "learner_queue": {"size_count": 89715, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.608, "replay_time_ms": 71.185, "update_priorities_time_ms": 46.906, "policy_agent_0": {"added_count": 1339392, "sampled_count": 4944640, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1339392, "sampled_count": 4944640, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.22270184755325317}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5648001432418823}}}, "timesteps_this_iter": 28928, "done": false, "timesteps_total": 5305088, "episodes_total": 26408, "training_iteration": 120, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-36-19", "timestamp": 1564911379, "time_this_iter_s": 30.77320432662964, "time_total_s": 3696.312918663025, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15c39d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15c3488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15c3598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16fc620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3696.312918663025, "timesteps_since_restore": 5305088, "iterations_since_restore": 120, "num_healthy_workers": 4}
{"episode_reward_max": 65.71303637373354, "episode_reward_min": 63.37616138175061, "episode_reward_mean": 64.50593816867577, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 39.62948250327928, "agent_1": 24.876455665396506}, "custom_metrics": {"delta0_mean": 0.4656645098965715, "delta0_min": 0.4151620750167113, "delta0_max": 0.49457024488095186, "delta1_mean": 0.428979536554544, "delta1_min": 0.40185894802229144, "delta1_max": 0.44430848628148145, "price0_mean": 1.6389674031711248, "price0_min": 1.627070358829116, "price0_max": 1.6441791359634441, "price1_mean": 1.649514368747542, "price1_min": 1.6328704042704054, "price1_max": 1.6578958336160519}, "sampler_perf": {"mean_env_wait_ms": 1.1236655914905889, "mean_processing_ms": 14.958226100078718, "mean_inference_ms": 2.0882391181225373}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 402, "num_steps_trained": 20175104, "num_steps_sampled": 5333376, "sample_throughput": 0.0, "train_throughput": 16784.822, "num_weight_syncs": 10415, "num_samples_dropped": 875, "learner_queue": {"size_count": 90421, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.198, "replay_time_ms": 88.708, "update_priorities_time_ms": 45.653, "policy_agent_0": {"added_count": 1345408, "sampled_count": 4992256, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1345408, "sampled_count": 4992256, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2145339399576187}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5429453253746033}}}, "timesteps_this_iter": 28288, "done": false, "timesteps_total": 5333376, "episodes_total": 26552, "training_iteration": 121, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-36-50", "timestamp": 1564911410, "time_this_iter_s": 31.55812358856201, "time_total_s": 3727.871042251587, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16fc400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16fcd08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16fc048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16ea400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3727.871042251587, "timesteps_since_restore": 5333376, "iterations_since_restore": 121, "num_healthy_workers": 4}
{"episode_reward_max": 65.37715947579953, "episode_reward_min": 63.97404987130411, "episode_reward_mean": 64.65734803800157, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 39.5807077412173, "agent_1": 25.076640296784277}, "custom_metrics": {"delta0_mean": 0.47117492773586217, "delta0_min": 0.42093445183909634, "delta0_max": 0.499845200948875, "delta1_mean": 0.4277468092703896, "delta1_min": 0.40078186288078954, "delta1_max": 0.4430892965255972, "price0_mean": 1.639545156367736, "price0_min": 1.6277111727156575, "price0_max": 1.644729970782269, "price1_mean": 1.650921158936442, "price1_min": 1.6343539012213484, "price1_max": 1.6592382691821734}, "sampler_perf": {"mean_env_wait_ms": 1.1232890497842452, "mean_processing_ms": 15.020630017361896, "mean_inference_ms": 2.08771778589885}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 405, "num_steps_trained": 20354816, "num_steps_sampled": 5362304, "sample_throughput": 3245.992, "train_throughput": 6491.985, "num_weight_syncs": 10472, "num_samples_dropped": 875, "learner_queue": {"size_count": 91124, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.985, "replay_time_ms": 88.87, "update_priorities_time_ms": 51.75, "policy_agent_0": {"added_count": 1353600, "sampled_count": 5037312, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1353600, "sampled_count": 5037312, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.20397086441516876}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4973442256450653}}}, "timesteps_this_iter": 28928, "done": false, "timesteps_total": 5362304, "episodes_total": 26696, "training_iteration": 122, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-37-21", "timestamp": 1564911441, "time_this_iter_s": 30.691307067871094, "time_total_s": 3758.562349319458, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1666950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1602a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1673b70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c9378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3758.562349319458, "timesteps_since_restore": 5362304, "iterations_since_restore": 122, "num_healthy_workers": 4}
{"episode_reward_max": 65.34543042496017, "episode_reward_min": 62.82586439467023, "episode_reward_mean": 64.23907376262173, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 38.896031579546076, "agent_1": 25.343042183075642}, "custom_metrics": {"delta0_mean": 0.4763010306540546, "delta0_min": 0.4263914013303867, "delta0_max": 0.5048310861167459, "delta1_mean": 0.4266547039080307, "delta1_min": 0.3997367056841099, "delta1_max": 0.4420891462434746, "price0_mean": 1.6400553836973715, "price0_min": 1.628273442432222, "price0_max": 1.6452320925609782, "price1_mean": 1.6522078604835464, "price1_min": 1.6357152797510903, "price1_max": 1.6604952538413404}, "sampler_perf": {"mean_env_wait_ms": 1.1233453614568054, "mean_processing_ms": 15.082068590577105, "mean_inference_ms": 2.087183392838342}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 409, "num_steps_trained": 20531200, "num_steps_sampled": 5391360, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10528, "num_samples_dropped": 875, "learner_queue": {"size_count": 91812, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.658, "replay_time_ms": 93.898, "update_priorities_time_ms": 44.724, "policy_agent_0": {"added_count": 1359616, "sampled_count": 5083136, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1359616, "sampled_count": 5083136, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.1755371391773224}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46911221742630005}}}, "timesteps_this_iter": 29056, "done": false, "timesteps_total": 5391360, "episodes_total": 26840, "training_iteration": 123, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-37-53", "timestamp": 1564911473, "time_this_iter_s": 30.70445227622986, "time_total_s": 3789.266801595688, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c97b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c9730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c9158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17378c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3789.266801595688, "timesteps_since_restore": 5391360, "iterations_since_restore": 123, "num_healthy_workers": 4}
{"episode_reward_max": 64.6392075797216, "episode_reward_min": 62.67376478656624, "episode_reward_mean": 63.86983041179383, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 38.33699722025087, "agent_1": 25.532833191542952}, "custom_metrics": {"delta0_mean": 0.48093095872013747, "delta0_min": 0.4319618201166755, "delta0_max": 0.509531427204014, "delta1_mean": 0.4256003072485597, "delta1_min": 0.3988342700757466, "delta1_max": 0.4410145205968485, "price0_mean": 1.6404896924701975, "price0_min": 1.6288352198088674, "price0_max": 1.6456510678627279, "price1_mean": 1.6533756858699717, "price1_min": 1.6369999113970393, "price1_max": 1.6616393875258901}, "sampler_perf": {"mean_env_wait_ms": 1.1226248051239476, "mean_processing_ms": 15.143439131442483, "mean_inference_ms": 2.0854811744464286}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 412, "num_steps_trained": 20706816, "num_steps_sampled": 5420416, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10585, "num_samples_dropped": 875, "learner_queue": {"size_count": 92499, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.806, "replay_time_ms": 115.953, "update_priorities_time_ms": 50.657, "policy_agent_0": {"added_count": 1366400, "sampled_count": 5126656, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1366400, "sampled_count": 5126656, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.1825881451368332}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46621716022491455}}}, "timesteps_this_iter": 29056, "done": false, "timesteps_total": 5420416, "episodes_total": 26992, "training_iteration": 124, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-38-25", "timestamp": 1564911505, "time_this_iter_s": 31.08514976501465, "time_total_s": 3820.3519513607025, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16ea400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16fc048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16fcd08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1722158>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3820.3519513607025, "timesteps_since_restore": 5420416, "iterations_since_restore": 124, "num_healthy_workers": 4}
{"episode_reward_max": 64.76315189881348, "episode_reward_min": 62.847747843979334, "episode_reward_mean": 63.70366846396376, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 37.30942787828449, "agent_1": 26.394240585679267}, "custom_metrics": {"delta0_mean": 0.4856442149784395, "delta0_min": 0.43647463258573604, "delta0_max": 0.5136091537737086, "delta1_mean": 0.4250341357552277, "delta1_min": 0.39843890422384226, "delta1_max": 0.44037790301555935, "price0_mean": 1.6409600640417703, "price0_min": 1.629336791900887, "price0_max": 1.6460436850376474, "price1_mean": 1.6544937010706238, "price1_min": 1.6381367000028777, "price1_max": 1.6626228628280677}, "sampler_perf": {"mean_env_wait_ms": 1.1228304026419786, "mean_processing_ms": 15.212860377981062, "mean_inference_ms": 2.0859736094006402}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 416, "num_steps_trained": 20888320, "num_steps_sampled": 5449216, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10641, "num_samples_dropped": 875, "learner_queue": {"size_count": 93207, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.296, "replay_time_ms": 94.459, "update_priorities_time_ms": 41.825, "policy_agent_0": {"added_count": 1374976, "sampled_count": 5171968, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1374976, "sampled_count": 5171968, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.19502976536750793}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4370122253894806}}}, "timesteps_this_iter": 28800, "done": false, "timesteps_total": 5449216, "episodes_total": 27136, "training_iteration": 125, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-38-57", "timestamp": 1564911537, "time_this_iter_s": 31.827513456344604, "time_total_s": 3852.179464817047, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17227b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1722488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1722ae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd171b1e0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3852.179464817047, "timesteps_since_restore": 5449216, "iterations_since_restore": 125, "num_healthy_workers": 4}
{"episode_reward_max": 64.27755253330763, "episode_reward_min": 61.67529859348482, "episode_reward_mean": 62.76470390077124, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 37.02561111564312, "agent_1": 25.739092785128133}, "custom_metrics": {"delta0_mean": 0.48973526798422934, "delta0_min": 0.44080956630297013, "delta0_max": 0.5175574557025843, "delta1_mean": 0.4241590044414131, "delta1_min": 0.39764241250974913, "delta1_max": 0.4394841549073463, "price0_mean": 1.6412646208171158, "price0_min": 1.6296816601103685, "price0_max": 1.6463402769673254, "price1_mean": 1.6554455398994987, "price1_min": 1.6391870359319676, "price1_max": 1.663539752546594}, "sampler_perf": {"mean_env_wait_ms": 1.123111531633609, "mean_processing_ms": 15.27537348100209, "mean_inference_ms": 2.0851163741112493}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 419, "num_steps_trained": 21063680, "num_steps_sampled": 5478144, "sample_throughput": 0.0, "train_throughput": 22879.159, "num_weight_syncs": 10698, "num_samples_dropped": 875, "learner_queue": {"size_count": 93892, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.12, "replay_time_ms": 103.264, "update_priorities_time_ms": 52.305, "policy_agent_0": {"added_count": 1381120, "sampled_count": 5214720, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1381120, "sampled_count": 5214720, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.18792244791984558}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4359091818332672}}}, "timesteps_this_iter": 28928, "done": false, "timesteps_total": 5478144, "episodes_total": 27280, "training_iteration": 126, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-39-28", "timestamp": 1564911568, "time_this_iter_s": 31.124992609024048, "time_total_s": 3883.304457426071, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1602a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17378c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1666950>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1712e18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3883.304457426071, "timesteps_since_restore": 5478144, "iterations_since_restore": 126, "num_healthy_workers": 4}
{"episode_reward_max": 64.33358169384746, "episode_reward_min": 61.69520719013101, "episode_reward_mean": 62.639421968593055, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 36.8664266217472, "agent_1": 25.77299534684586}, "custom_metrics": {"delta0_mean": 0.4937085871965318, "delta0_min": 0.4450842717424839, "delta0_max": 0.5213730297743197, "delta1_mean": 0.4233093149571028, "delta1_min": 0.3968934269252831, "delta1_max": 0.43862873079132075, "price0_mean": 1.6415506224795609, "price0_min": 1.6300287269323168, "price0_max": 1.6465935303203545, "price1_mean": 1.6563619878410345, "price1_min": 1.6401812598933418, "price1_max": 1.664408014008388}, "sampler_perf": {"mean_env_wait_ms": 1.1233468072995183, "mean_processing_ms": 15.33198309709056, "mean_inference_ms": 2.0854303562127248}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 423, "num_steps_trained": 21242880, "num_steps_sampled": 5506560, "sample_throughput": 0.0, "train_throughput": 17792.795, "num_weight_syncs": 10753, "num_samples_dropped": 875, "learner_queue": {"size_count": 94593, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 13.236, "replay_time_ms": 71.586, "update_priorities_time_ms": 40.959, "policy_agent_0": {"added_count": 1388544, "sampled_count": 5261568, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1388544, "sampled_count": 5261568, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.1866227090358734}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4296340346336365}}}, "timesteps_this_iter": 28416, "done": false, "timesteps_total": 5506560, "episodes_total": 27424, "training_iteration": 127, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-39-59", "timestamp": 1564911599, "time_this_iter_s": 30.788458347320557, "time_total_s": 3914.0929157733917, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1712f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1712ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1712840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1776510>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3914.0929157733917, "timesteps_since_restore": 5506560, "iterations_since_restore": 127, "num_healthy_workers": 4}
{"episode_reward_max": 64.36302579474057, "episode_reward_min": 60.366010743776, "episode_reward_mean": 62.67407045612132, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 36.49820710492149, "agent_1": 26.175863351199823}, "custom_metrics": {"delta0_mean": 0.4974713217093145, "delta0_min": 0.44911305559559844, "delta0_max": 0.5249845665229907, "delta1_mean": 0.4226546334679815, "delta1_min": 0.3964073748329528, "delta1_max": 0.437841269823921, "price0_mean": 1.6418499645474138, "price0_min": 1.6304006197337262, "price0_max": 1.6468486460167286, "price1_mean": 1.6572380388184875, "price1_min": 1.6411382172114775, "price1_max": 1.6652337099653691}, "sampler_perf": {"mean_env_wait_ms": 1.123974194010165, "mean_processing_ms": 15.393833340172428, "mean_inference_ms": 2.085225899901108}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 426, "num_steps_trained": 21421568, "num_steps_sampled": 5534848, "sample_throughput": 0.0, "train_throughput": 28706.604, "num_weight_syncs": 10809, "num_samples_dropped": 875, "learner_queue": {"size_count": 95290, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.534, "replay_time_ms": 81.974, "update_priorities_time_ms": 45.341, "policy_agent_0": {"added_count": 1395584, "sampled_count": 5305856, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1395584, "sampled_count": 5305856, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.18572945892810822}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4251246452331543}}}, "timesteps_this_iter": 28288, "done": false, "timesteps_total": 5534848, "episodes_total": 27568, "training_iteration": 128, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-40-30", "timestamp": 1564911630, "time_this_iter_s": 31.5172016620636, "time_total_s": 3945.6101174354553, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1776f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1776598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17761e0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176b1e0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3945.6101174354553, "timesteps_since_restore": 5534848, "iterations_since_restore": 128, "num_healthy_workers": 4}
{"episode_reward_max": 63.69227735135278, "episode_reward_min": 59.7402849053295, "episode_reward_mean": 61.87998250453479, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 35.74403902382072, "agent_1": 26.135943480714065}, "custom_metrics": {"delta0_mean": 0.5008466966614321, "delta0_min": 0.45268292519427067, "delta0_max": 0.528252734478645, "delta1_mean": 0.421988090853995, "delta1_min": 0.395896229297727, "delta1_max": 0.4370806503422055, "price0_mean": 1.642062426697949, "price0_min": 1.6306636862947013, "price0_max": 1.647024230306111, "price1_mean": 1.6579902080739548, "price1_min": 1.6419727161981723, "price1_max": 1.6659502747184265}, "sampler_perf": {"mean_env_wait_ms": 1.123923380354377, "mean_processing_ms": 15.452856967655995, "mean_inference_ms": 2.0851212593044033}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 430, "num_steps_trained": 21594880, "num_steps_sampled": 5562880, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10864, "num_samples_dropped": 875, "learner_queue": {"size_count": 95968, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.066, "replay_time_ms": 105.196, "update_priorities_time_ms": 53.975, "policy_agent_0": {"added_count": 1400960, "sampled_count": 5349376, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1400960, "sampled_count": 5349376, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.18501166999340057}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42253944277763367}}}, "timesteps_this_iter": 28032, "done": false, "timesteps_total": 5562880, "episodes_total": 27712, "training_iteration": 129, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-41-01", "timestamp": 1564911661, "time_this_iter_s": 30.53044867515564, "time_total_s": 3976.140566110611, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1712ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1712840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1712f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd175df28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 3976.140566110611, "timesteps_since_restore": 5562880, "iterations_since_restore": 129, "num_healthy_workers": 4}
{"episode_reward_max": 63.0882938907353, "episode_reward_min": 60.202248090976674, "episode_reward_mean": 61.56708250771797, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 35.5400489501122, "agent_1": 26.027033557605776}, "custom_metrics": {"delta0_mean": 0.5040925145442583, "delta0_min": 0.4560889831763229, "delta0_max": 0.5314749333226794, "delta1_mean": 0.4212798387250136, "delta1_min": 0.3954164514960441, "delta1_max": 0.43619941667938805, "price0_mean": 1.642239171012808, "price0_min": 1.6309045162445281, "price0_max": 1.6471775506879633, "price1_mean": 1.6587014531652062, "price1_min": 1.6427788161439554, "price1_max": 1.66664901676277}, "sampler_perf": {"mean_env_wait_ms": 1.1244956575390632, "mean_processing_ms": 15.51489261097221, "mean_inference_ms": 2.0850079808248885}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 433, "num_steps_trained": 21776128, "num_steps_sampled": 5591552, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 10920, "num_samples_dropped": 875, "learner_queue": {"size_count": 96676, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.746, "replay_time_ms": 87.713, "update_priorities_time_ms": 50.908, "policy_agent_0": {"added_count": 1407872, "sampled_count": 5395456, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1407872, "sampled_count": 5395456, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.20959581434726715}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42554599046707153}}}, "timesteps_this_iter": 28672, "done": false, "timesteps_total": 5591552, "episodes_total": 27856, "training_iteration": 130, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-41-33", "timestamp": 1564911693, "time_this_iter_s": 31.29908037185669, "time_total_s": 4007.4396464824677, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd175d488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd174eae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd174e9d8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16ab6a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4007.4396464824677, "timesteps_since_restore": 5591552, "iterations_since_restore": 130, "num_healthy_workers": 4}
{"episode_reward_max": 64.01971704001456, "episode_reward_min": 60.431444031271795, "episode_reward_mean": 61.701526245922985, "episode_len_mean": 100.0, "episodes_this_iter": 152, "policy_reward_mean": {"agent_0": 33.71530784448961, "agent_1": 27.98621840143339}, "custom_metrics": {"delta0_mean": 0.5070438431988092, "delta0_min": 0.45869405509751265, "delta0_max": 0.5340066222643483, "delta1_mean": 0.42148300171088254, "delta1_min": 0.395818918203317, "delta1_max": 0.4361891922357266, "price0_mean": 1.6425498662114546, "price0_min": 1.6312472275147545, "price0_max": 1.6474115010509516, "price1_mean": 1.6593491101814826, "price1_min": 1.6434916775239994, "price1_max": 1.667204785448268}, "sampler_perf": {"mean_env_wait_ms": 1.1245385266640575, "mean_processing_ms": 15.575841910750897, "mean_inference_ms": 2.08480703234742}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 437, "num_steps_trained": 21953536, "num_steps_sampled": 5621120, "sample_throughput": 19087.386, "train_throughput": 0.0, "num_weight_syncs": 10977, "num_samples_dropped": 875, "learner_queue": {"size_count": 97368, "size_mean": 0.2, "size_std": 0.447213595499958, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.097, "replay_time_ms": 98.436, "update_priorities_time_ms": 56.699, "policy_agent_0": {"added_count": 1415936, "sampled_count": 5440768, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1415936, "sampled_count": 5440768, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.18320414423942566}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4202706813812256}}}, "timesteps_this_iter": 29568, "done": false, "timesteps_total": 5621120, "episodes_total": 28008, "training_iteration": 131, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-42-05", "timestamp": 1564911725, "time_this_iter_s": 31.817530155181885, "time_total_s": 4039.2571766376495, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176b1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1602a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17378c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd164dea0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4039.2571766376495, "timesteps_since_restore": 5621120, "iterations_since_restore": 131, "num_healthy_workers": 4}
{"episode_reward_max": 61.27829180377781, "episode_reward_min": 57.33578953018859, "episode_reward_mean": 59.514108056894266, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 29.08056310318877, "agent_1": 30.4335449537055}, "custom_metrics": {"delta0_mean": 0.5068545612837815, "delta0_min": 0.4591062050338715, "delta0_max": 0.534214856346215, "delta1_mean": 0.42278238300842474, "delta1_min": 0.39729595793343564, "delta1_max": 0.43739544541573505, "price0_mean": 1.6427730576110013, "price0_min": 1.6315634387368612, "price0_max": 1.6476446779668488, "price1_mean": 1.6593465730626553, "price1_min": 1.6436598201322092, "price1_max": 1.6672596574482654}, "sampler_perf": {"mean_env_wait_ms": 1.1241424509180655, "mean_processing_ms": 15.636186219908938, "mean_inference_ms": 2.0837822326618127}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 440, "num_steps_trained": 22129664, "num_steps_sampled": 5650176, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11033, "num_samples_dropped": 875, "learner_queue": {"size_count": 98056, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.856, "replay_time_ms": 97.742, "update_priorities_time_ms": 58.154, "policy_agent_0": {"added_count": 1424128, "sampled_count": 5483776, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1424128, "sampled_count": 5483776, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.21714942157268524}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4052770137786865}}}, "timesteps_this_iter": 29056, "done": false, "timesteps_total": 5650176, "episodes_total": 28152, "training_iteration": 132, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-42-36", "timestamp": 1564911756, "time_this_iter_s": 31.316574096679688, "time_total_s": 4070.573750734329, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1632488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1632730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1632598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd161d950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4070.573750734329, "timesteps_since_restore": 5650176, "iterations_since_restore": 132, "num_healthy_workers": 4}
{"episode_reward_max": 58.220256537631236, "episode_reward_min": 56.13190917560863, "episode_reward_mean": 56.95861952689292, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 25.40621708667879, "agent_1": 31.552402440214124}, "custom_metrics": {"delta0_mean": 0.5054438596422762, "delta0_min": 0.45792686422595236, "delta0_max": 0.5326793298732676, "delta1_mean": 0.42457537449031857, "delta1_min": 0.3992448016542714, "delta1_max": 0.4390861175284526, "price0_mean": 1.643030438331868, "price0_min": 1.6318850632817752, "price0_max": 1.6478689802530122, "price1_mean": 1.6590649166491582, "price1_min": 1.643450261670845, "price1_max": 1.6669368603247858}, "sampler_perf": {"mean_env_wait_ms": 1.1240772158961088, "mean_processing_ms": 15.697658370916194, "mean_inference_ms": 2.0827477320126717}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 444, "num_steps_trained": 22308352, "num_steps_sampled": 5678464, "sample_throughput": 0.0, "train_throughput": 11978.245, "num_weight_syncs": 11088, "num_samples_dropped": 875, "learner_queue": {"size_count": 98755, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.141, "replay_time_ms": 84.172, "update_priorities_time_ms": 45.898, "policy_agent_0": {"added_count": 1430144, "sampled_count": 5528064, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1430144, "sampled_count": 5528064, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.25461500883102417}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37183916568756104}}}, "timesteps_this_iter": 28288, "done": false, "timesteps_total": 5678464, "episodes_total": 28296, "training_iteration": 133, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-43-08", "timestamp": 1564911788, "time_this_iter_s": 31.571295261383057, "time_total_s": 4102.145045995712, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd174eae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd174e9d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16ab6a8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1627950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4102.145045995712, "timesteps_since_restore": 5678464, "iterations_since_restore": 133, "num_healthy_workers": 4}
{"episode_reward_max": 57.593074213880236, "episode_reward_min": 54.31140794957081, "episode_reward_mean": 56.01501589113469, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 23.753274127953908, "agent_1": 32.26174176318079}, "custom_metrics": {"delta0_mean": 0.50292276047832, "delta0_min": 0.45593743668616743, "delta0_max": 0.5307240826950931, "delta1_mean": 0.4265621337163091, "delta1_min": 0.4014755334601971, "delta1_max": 0.44086835383136685, "price0_mean": 1.6433004477690727, "price0_min": 1.6322682190516073, "price0_max": 1.648131801898299, "price1_mean": 1.6586032404946465, "price1_min": 1.643181791273359, "price1_max": 1.666559740552518}, "sampler_perf": {"mean_env_wait_ms": 1.1244653142648704, "mean_processing_ms": 15.756491404269264, "mean_inference_ms": 2.0823056345178155}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 448, "num_steps_trained": 22488320, "num_steps_sampled": 5706240, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11143, "num_samples_dropped": 875, "learner_queue": {"size_count": 99458, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 22.36, "replay_time_ms": 98.342, "update_priorities_time_ms": 45.658, "policy_agent_0": {"added_count": 1437056, "sampled_count": 5571072, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1437056, "sampled_count": 5571072, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32619452476501465}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3431326150894165}}}, "timesteps_this_iter": 27776, "done": false, "timesteps_total": 5706240, "episodes_total": 28432, "training_iteration": 134, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-43-39", "timestamp": 1564911819, "time_this_iter_s": 31.13673758506775, "time_total_s": 4133.28178358078, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1627a60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16279d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1627ae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15de8c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4133.28178358078, "timesteps_since_restore": 5706240, "iterations_since_restore": 134, "num_healthy_workers": 4}
{"episode_reward_max": 56.023247160945346, "episode_reward_min": 51.8787567689586, "episode_reward_mean": 54.40454690279014, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 21.97323990258649, "agent_1": 32.43130700020365}, "custom_metrics": {"delta0_mean": 0.5011606063887063, "delta0_min": 0.45348993752493266, "delta0_max": 0.5276725771212453, "delta1_mean": 0.42858095253360284, "delta1_min": 0.4035178732124525, "delta1_max": 0.44293262222389246, "price0_mean": 1.643721479475736, "price0_min": 1.6326525238911647, "price0_max": 1.648463906452318, "price1_mean": 1.6582574769172274, "price1_min": 1.642713485438002, "price1_max": 1.6659711872761362}, "sampler_perf": {"mean_env_wait_ms": 1.124797805373774, "mean_processing_ms": 15.817185723958433, "mean_inference_ms": 2.0829684065044916}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 451, "num_steps_trained": 22666752, "num_steps_sampled": 5734400, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11199, "num_samples_dropped": 875, "learner_queue": {"size_count": 100154, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.681, "replay_time_ms": 103.649, "update_priorities_time_ms": 48.976, "policy_agent_0": {"added_count": 1442688, "sampled_count": 5614592, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1442688, "sampled_count": 5614592, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.358111709356308}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3186008930206299}}}, "timesteps_this_iter": 28160, "done": false, "timesteps_total": 5734400, "episodes_total": 28568, "training_iteration": 135, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-44-10", "timestamp": 1564911850, "time_this_iter_s": 30.36562752723694, "time_total_s": 4163.647411108017, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd161d950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1632598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1632730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15f3620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4163.647411108017, "timesteps_since_restore": 5734400, "iterations_since_restore": 135, "num_healthy_workers": 4}
{"episode_reward_max": 55.53939118560531, "episode_reward_min": 50.549443576369185, "episode_reward_mean": 53.50096004779452, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 21.11519208754923, "agent_1": 32.385767960245296}, "custom_metrics": {"delta0_mean": 0.49740170650308024, "delta0_min": 0.4503684031909289, "delta0_max": 0.5243137867766523, "delta1_mean": 0.43069176644921514, "delta1_min": 0.40576712292575046, "delta1_max": 0.4450091371709182, "price0_mean": 1.6440626979192083, "price0_min": 1.6330935592125044, "price0_max": 1.648813537100323, "price1_mean": 1.6575620488518295, "price1_min": 1.6421800241371354, "price1_max": 1.6653246931835293}, "sampler_perf": {"mean_env_wait_ms": 1.1247737698331157, "mean_processing_ms": 15.880608660751278, "mean_inference_ms": 2.0819292957054722}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 455, "num_steps_trained": 22841600, "num_steps_sampled": 5762944, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11255, "num_samples_dropped": 875, "learner_queue": {"size_count": 100837, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.059, "replay_time_ms": 99.463, "update_priorities_time_ms": 55.006, "policy_agent_0": {"added_count": 1451648, "sampled_count": 5656064, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1451648, "sampled_count": 5656064, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4303337037563324}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2955939471721649}}}, "timesteps_this_iter": 28544, "done": false, "timesteps_total": 5762944, "episodes_total": 28712, "training_iteration": 136, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-44-43", "timestamp": 1564911883, "time_this_iter_s": 31.770769119262695, "time_total_s": 4195.41818022728, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15f38c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15f3950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15f39d8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15eabf8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4195.41818022728, "timesteps_since_restore": 5762944, "iterations_since_restore": 136, "num_healthy_workers": 4}
{"episode_reward_max": 54.86580800740239, "episode_reward_min": 46.36650533904361, "episode_reward_mean": 51.33100640332296, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 19.23911145520704, "agent_1": 32.09189494811592}, "custom_metrics": {"delta0_mean": 0.4933331832714802, "delta0_min": 0.4464394926566928, "delta0_max": 0.5204197702225141, "delta1_mean": 0.43264844980679595, "delta1_min": 0.40799582263346046, "delta1_max": 0.44671208035658444, "price0_mean": 1.6444928004714616, "price0_min": 1.6336337655764372, "price0_max": 1.649132909440361, "price1_mean": 1.6567969051923486, "price1_min": 1.6414920927273573, "price1_max": 1.6645408558099706}, "sampler_perf": {"mean_env_wait_ms": 1.124815831044714, "mean_processing_ms": 15.939474819135118, "mean_inference_ms": 2.0814282588629043}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 458, "num_steps_trained": 23022592, "num_steps_sampled": 5790336, "sample_throughput": 2682.37, "train_throughput": 10729.478, "num_weight_syncs": 11308, "num_samples_dropped": 875, "learner_queue": {"size_count": 101544, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.817, "replay_time_ms": 86.372, "update_priorities_time_ms": 42.454, "policy_agent_0": {"added_count": 1459072, "sampled_count": 5702400, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1459072, "sampled_count": 5702400, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4968889057636261}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.285261869430542}}}, "timesteps_this_iter": 27392, "done": false, "timesteps_total": 5790336, "episodes_total": 28856, "training_iteration": 137, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-45-15", "timestamp": 1564911915, "time_this_iter_s": 31.70453405380249, "time_total_s": 4227.122714281082, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15de8c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd174e9d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd174eae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15fd950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4227.122714281082, "timesteps_since_restore": 5790336, "iterations_since_restore": 137, "num_healthy_workers": 4}
{"episode_reward_max": 57.31866142849411, "episode_reward_min": 46.53874777749509, "episode_reward_mean": 53.39663510250671, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 21.542504047093647, "agent_1": 31.854131055413077}, "custom_metrics": {"delta0_mean": 0.4909688346846951, "delta0_min": 0.4442029595937716, "delta0_max": 0.5173043205381053, "delta1_mean": 0.4343732623439303, "delta1_min": 0.4096345238206683, "delta1_max": 0.4485399515872584, "price0_mean": 1.6448494274056404, "price0_min": 1.6339342425545087, "price0_max": 1.6494280341149414, "price1_mean": 1.6563279869847245, "price1_min": 1.6409957088430627, "price1_max": 1.6639166796946179}, "sampler_perf": {"mean_env_wait_ms": 1.1248066248940547, "mean_processing_ms": 16.00061468132644, "mean_inference_ms": 2.081375470750526}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 462, "num_steps_trained": 23203072, "num_steps_sampled": 5816960, "sample_throughput": 4599.924, "train_throughput": 0.0, "num_weight_syncs": 11360, "num_samples_dropped": 875, "learner_queue": {"size_count": 102249, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.828, "replay_time_ms": 109.748, "update_priorities_time_ms": 54.096, "policy_agent_0": {"added_count": 1466240, "sampled_count": 5747712, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1466240, "sampled_count": 5747712, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5793088674545288}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2769396901130676}}}, "timesteps_this_iter": 26624, "done": false, "timesteps_total": 5816960, "episodes_total": 28992, "training_iteration": 138, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-45-45", "timestamp": 1564911945, "time_this_iter_s": 30.50647497177124, "time_total_s": 4257.629189252853, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15fdc80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15fdbf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15fdd08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd158bf28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4257.629189252853, "timesteps_since_restore": 5816960, "iterations_since_restore": 138, "num_healthy_workers": 4}
{"episode_reward_max": 55.63185192761721, "episode_reward_min": 44.70137307969797, "episode_reward_mean": 51.21241693654667, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 20.428347931055313, "agent_1": 30.78406900549136}, "custom_metrics": {"delta0_mean": 0.48701394833570827, "delta0_min": 0.4408454137789065, "delta0_max": 0.513951880297592, "delta1_mean": 0.4357264872324174, "delta1_min": 0.4112096995766365, "delta1_max": 0.44991401249690527, "price0_mean": 1.6450940884646255, "price0_min": 1.634304118674225, "price0_max": 1.649631743524074, "price1_mean": 1.6555473412705342, "price1_min": 1.640373037527953, "price1_max": 1.6632137269764316}, "sampler_perf": {"mean_env_wait_ms": 1.1248199172508784, "mean_processing_ms": 16.05950554650751, "mean_inference_ms": 2.079979499753789}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 465, "num_steps_trained": 23381248, "num_steps_sampled": 5844864, "sample_throughput": 0.0, "train_throughput": 22192.543, "num_weight_syncs": 11414, "num_samples_dropped": 875, "learner_queue": {"size_count": 102945, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.061, "replay_time_ms": 83.871, "update_priorities_time_ms": 39.628, "policy_agent_0": {"added_count": 1472640, "sampled_count": 5793536, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1472640, "sampled_count": 5793536, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6173285245895386}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2822296619415283}}}, "timesteps_this_iter": 27904, "done": false, "timesteps_total": 5844864, "episodes_total": 29136, "training_iteration": 139, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-46-17", "timestamp": 1564911977, "time_this_iter_s": 31.484416246414185, "time_total_s": 4289.113605499268, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15eaa60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15ea510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15ea620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15f3b70>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4289.113605499268, "timesteps_since_restore": 5844864, "iterations_since_restore": 139, "num_healthy_workers": 4}
{"episode_reward_max": 52.46437958653337, "episode_reward_min": 49.95070194739192, "episode_reward_mean": 51.42136335255714, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 27.02255555013039, "agent_1": 24.398807802426752}, "custom_metrics": {"delta0_mean": 0.48645326064798117, "delta0_min": 0.440576911179692, "delta0_max": 0.5132852689189837, "delta1_mean": 0.4342738077588238, "delta1_min": 0.4097286940376241, "delta1_max": 0.44856107663981964, "price0_mean": 1.6445763517939918, "price0_min": 1.6338125830740275, "price0_max": 1.6490822466371835, "price1_mean": 1.655204622353092, "price1_min": 1.6401098487450179, "price1_max": 1.6628383063105177}, "sampler_perf": {"mean_env_wait_ms": 1.1246811260884177, "mean_processing_ms": 16.118669268873536, "mean_inference_ms": 2.080003048044273}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 469, "num_steps_trained": 23559680, "num_steps_sampled": 5872256, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11467, "num_samples_dropped": 875, "learner_queue": {"size_count": 103642, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.811, "replay_time_ms": 96.255, "update_priorities_time_ms": 46.145, "policy_agent_0": {"added_count": 1477248, "sampled_count": 5840640, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1477248, "sampled_count": 5840640, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6378498077392578}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30297213792800903}}}, "timesteps_this_iter": 27392, "done": false, "timesteps_total": 5872256, "episodes_total": 29280, "training_iteration": 140, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-46-49", "timestamp": 1564912009, "time_this_iter_s": 31.743306159973145, "time_total_s": 4320.856911659241, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15f3400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15f3510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15f3378>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd162e620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4320.856911659241, "timesteps_since_restore": 5872256, "iterations_since_restore": 140, "num_healthy_workers": 4}
{"episode_reward_max": 51.7066259725575, "episode_reward_min": 48.71932539496343, "episode_reward_mean": 50.468323949448134, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 27.710303534017907, "agent_1": 22.758020415430245}, "custom_metrics": {"delta0_mean": 0.4857333886971958, "delta0_min": 0.4406195532879489, "delta0_max": 0.5129637628282785, "delta1_mean": 0.4322426274227872, "delta1_min": 0.40768716404616717, "delta1_max": 0.44651250876220333, "price0_mean": 1.643923584012155, "price0_min": 1.6332158234279297, "price0_max": 1.6484775404393552, "price1_mean": 1.6548723871331372, "price1_min": 1.6399287099434, "price1_max": 1.6625714242335372}, "sampler_perf": {"mean_env_wait_ms": 1.124530597310741, "mean_processing_ms": 16.17539196539144, "mean_inference_ms": 2.0800789682279146}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 472, "num_steps_trained": 23735552, "num_steps_sampled": 5899520, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11520, "num_samples_dropped": 875, "learner_queue": {"size_count": 104329, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.516, "replay_time_ms": 81.559, "update_priorities_time_ms": 44.646, "policy_agent_0": {"added_count": 1485312, "sampled_count": 5885184, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1485312, "sampled_count": 5885184, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6328901052474976}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33224427700042725}}}, "timesteps_this_iter": 27264, "done": false, "timesteps_total": 5899520, "episodes_total": 29416, "training_iteration": 141, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-47-20", "timestamp": 1564912040, "time_this_iter_s": 31.135791063308716, "time_total_s": 4351.992702722549, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15eab70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15eaa60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15ea598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd161dd08>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4351.992702722549, "timesteps_since_restore": 5899520, "iterations_since_restore": 141, "num_healthy_workers": 4}
{"episode_reward_max": 52.8188295013089, "episode_reward_min": 48.220563799228955, "episode_reward_mean": 50.021324273292, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 28.45661608301823, "agent_1": 21.564708190273763}, "custom_metrics": {"delta0_mean": 0.48580109120513754, "delta0_min": 0.44086163930069605, "delta0_max": 0.5129715440249393, "delta1_mean": 0.42973638402840325, "delta1_min": 0.405222575412069, "delta1_max": 0.444034061257079, "price0_mean": 1.6432471278831065, "price0_min": 1.632563227036022, "price0_max": 1.647817415285012, "price1_mean": 1.6547211387329772, "price1_min": 1.6398561663029605, "price1_max": 1.662414092606544}, "sampler_perf": {"mean_env_wait_ms": 1.124994569008492, "mean_processing_ms": 16.233222456689106, "mean_inference_ms": 2.0792190820279113}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 476, "num_steps_trained": 23912960, "num_steps_sampled": 5926528, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11574, "num_samples_dropped": 875, "learner_queue": {"size_count": 105022, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 12.233, "replay_time_ms": 85.132, "update_priorities_time_ms": 48.613, "policy_agent_0": {"added_count": 1492096, "sampled_count": 5928704, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1492096, "sampled_count": 5928704, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5986671447753906}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37004420161247253}}}, "timesteps_this_iter": 27008, "done": false, "timesteps_total": 5926528, "episodes_total": 29552, "training_iteration": 142, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-47-51", "timestamp": 1564912071, "time_this_iter_s": 31.228220462799072, "time_total_s": 4383.2209231853485, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd161dc80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd161dae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd161d268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1650400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4383.2209231853485, "timesteps_since_restore": 5926528, "iterations_since_restore": 142, "num_healthy_workers": 4}
{"episode_reward_max": 50.465152170727755, "episode_reward_min": 43.58383223302854, "episode_reward_mean": 48.10463507981527, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 26.605771735132333, "agent_1": 21.49886334468294}, "custom_metrics": {"delta0_mean": 0.48555310228216897, "delta0_min": 0.44048383191293006, "delta0_max": 0.512122605373159, "delta1_mean": 0.42708964325802984, "delta1_min": 0.4026719359179757, "delta1_max": 0.44126247244426836, "price0_mean": 1.6425081135826798, "price0_min": 1.6318423234905894, "price0_max": 1.6470122900412485, "price1_mean": 1.65443328959329, "price1_min": 1.639496212559196, "price1_max": 1.6620125357080733}, "sampler_perf": {"mean_env_wait_ms": 1.124940596884978, "mean_processing_ms": 16.295859777744184, "mean_inference_ms": 2.078833223996083}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 480, "num_steps_trained": 24093184, "num_steps_sampled": 5952896, "sample_throughput": 0.0, "train_throughput": 33063.644, "num_weight_syncs": 11626, "num_samples_dropped": 875, "learner_queue": {"size_count": 105726, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.618, "replay_time_ms": 88.409, "update_priorities_time_ms": 45.6, "policy_agent_0": {"added_count": 1498112, "sampled_count": 5973504, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1498112, "sampled_count": 5973504, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5617510676383972}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4489336609840393}}}, "timesteps_this_iter": 26368, "done": false, "timesteps_total": 5952896, "episodes_total": 29696, "training_iteration": 143, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-48-23", "timestamp": 1564912103, "time_this_iter_s": 31.586642265319824, "time_total_s": 4414.807565450668, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15eab70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15eaa60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15ea620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16aba60>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4414.807565450668, "timesteps_since_restore": 5952896, "iterations_since_restore": 143, "num_healthy_workers": 4}
{"episode_reward_max": 51.15579022472306, "episode_reward_min": 47.775512685852306, "episode_reward_mean": 49.225503019209995, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 26.846775445046905, "agent_1": 22.37872757416309}, "custom_metrics": {"delta0_mean": 0.4854393448184234, "delta0_min": 0.4401065742846197, "delta0_max": 0.5113648788795535, "delta1_mean": 0.4249585508680933, "delta1_min": 0.40081253873290046, "delta1_max": 0.43889835304673464, "price0_mean": 1.6418785808878948, "price0_min": 1.6312697436224217, "price0_max": 1.646286531733257, "price1_mean": 1.6541799365477237, "price1_min": 1.639207618610139, "price1_max": 1.661621038710541}, "sampler_perf": {"mean_env_wait_ms": 1.1252074082621002, "mean_processing_ms": 16.356014299106953, "mean_inference_ms": 2.0792206245330904}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 483, "num_steps_trained": 24271104, "num_steps_sampled": 5979904, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11678, "num_samples_dropped": 875, "learner_queue": {"size_count": 106421, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.438, "replay_time_ms": 87.181, "update_priorities_time_ms": 45.063, "policy_agent_0": {"added_count": 1505664, "sampled_count": 6018304, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1505664, "sampled_count": 6018304, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4950869381427765}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5085799694061279}}}, "timesteps_this_iter": 27008, "done": false, "timesteps_total": 5979904, "episodes_total": 29832, "training_iteration": 144, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-48-55", "timestamp": 1564912135, "time_this_iter_s": 31.765740394592285, "time_total_s": 4446.573305845261, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16ab950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16ab9d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16ab598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd175dae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4446.573305845261, "timesteps_since_restore": 5979904, "iterations_since_restore": 144, "num_healthy_workers": 4}
{"episode_reward_max": 50.50149833753967, "episode_reward_min": 47.49743904076252, "episode_reward_mean": 48.60640050141939, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 26.75962491604649, "agent_1": 21.846775585372896}, "custom_metrics": {"delta0_mean": 0.4848205475178916, "delta0_min": 0.4396922848463501, "delta0_max": 0.5105736198530856, "delta1_mean": 0.42263165517938583, "delta1_min": 0.39874454479737653, "delta1_max": 0.4363539989215256, "price0_mean": 1.6411693949572215, "price0_min": 1.6306498737583444, "price0_max": 1.6455151679795381, "price1_mean": 1.6538511145360275, "price1_min": 1.6389304905305662, "price1_max": 1.6612353040648822}, "sampler_perf": {"mean_env_wait_ms": 1.125451908018072, "mean_processing_ms": 16.413518172023714, "mean_inference_ms": 2.07932310714468}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 487, "num_steps_trained": 24448000, "num_steps_sampled": 6006784, "sample_throughput": 0.0, "train_throughput": 37198.747, "num_weight_syncs": 11731, "num_samples_dropped": 875, "learner_queue": {"size_count": 107112, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.725, "replay_time_ms": 75.601, "update_priorities_time_ms": 45.983, "policy_agent_0": {"added_count": 1513216, "sampled_count": 6062336, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1513216, "sampled_count": 6062336, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4679029583930969}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.551537275314331}}}, "timesteps_this_iter": 26880, "done": false, "timesteps_total": 6006784, "episodes_total": 29968, "training_iteration": 145, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-49-26", "timestamp": 1564912166, "time_this_iter_s": 31.514484167099, "time_total_s": 4478.08779001236, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15ea598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15eab70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd158bf28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176b268>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4478.08779001236, "timesteps_since_restore": 6006784, "iterations_since_restore": 145, "num_healthy_workers": 4}
{"episode_reward_max": 50.880520561912256, "episode_reward_min": 46.783789500802214, "episode_reward_mean": 48.54881087284885, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 26.650882935469852, "agent_1": 21.89792793737899}, "custom_metrics": {"delta0_mean": 0.4837380259447596, "delta0_min": 0.4392348265562433, "delta0_max": 0.5098219762898337, "delta1_mean": 0.42050039370685494, "delta1_min": 0.3967159286935061, "delta1_max": 0.4341402740136476, "price0_mean": 1.6404790652972667, "price0_min": 1.6300359690653212, "price0_max": 1.6448314218990192, "price1_mean": 1.6534583299995895, "price1_min": 1.6386723944453754, "price1_max": 1.6608822320509598}, "sampler_perf": {"mean_env_wait_ms": 1.1254582416706673, "mean_processing_ms": 16.4666394583495, "mean_inference_ms": 2.078131011716581}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 490, "num_steps_trained": 24629248, "num_steps_sampled": 6033408, "sample_throughput": 17101.067, "train_throughput": 0.0, "num_weight_syncs": 11783, "num_samples_dropped": 875, "learner_queue": {"size_count": 107820, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.51, "replay_time_ms": 90.068, "update_priorities_time_ms": 50.22, "policy_agent_0": {"added_count": 1519744, "sampled_count": 6107648, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1519744, "sampled_count": 6107648, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4070957601070404}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6038087010383606}}}, "timesteps_this_iter": 26624, "done": false, "timesteps_total": 6033408, "episodes_total": 30096, "training_iteration": 146, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-49-57", "timestamp": 1564912197, "time_this_iter_s": 30.421493768692017, "time_total_s": 4508.509283781052, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176bea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176b0d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176bd08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1776598>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4508.509283781052, "timesteps_since_restore": 6033408, "iterations_since_restore": 146, "num_healthy_workers": 4}
{"episode_reward_max": 56.242622653552324, "episode_reward_min": 36.665573895387205, "episode_reward_mean": 49.75497708480245, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 28.37497217286573, "agent_1": 21.380004911936727}, "custom_metrics": {"delta0_mean": 0.48330752880487204, "delta0_min": 0.4394205997019399, "delta0_max": 0.5104715453834069, "delta1_mean": 0.4180531263829521, "delta1_min": 0.3943757833042691, "delta1_max": 0.4319301772036864, "price0_mean": 1.639805468169289, "price0_min": 1.6294165128274705, "price0_max": 1.644326390203839, "price1_mean": 1.6532662465316932, "price1_min": 1.6384957326099967, "price1_max": 1.6608865783285047}, "sampler_perf": {"mean_env_wait_ms": 1.1257474469267041, "mean_processing_ms": 16.531206446897954, "mean_inference_ms": 2.0775169554556925}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 494, "num_steps_trained": 24807424, "num_steps_sampled": 6059648, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11833, "num_samples_dropped": 875, "learner_queue": {"size_count": 108517, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.843, "replay_time_ms": 93.022, "update_priorities_time_ms": 50.715, "policy_agent_0": {"added_count": 1526016, "sampled_count": 6150912, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1526016, "sampled_count": 6150912, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39084476232528687}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6276348829269409}}}, "timesteps_this_iter": 26240, "done": false, "timesteps_total": 6059648, "episodes_total": 30232, "training_iteration": 147, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-50-29", "timestamp": 1564912229, "time_this_iter_s": 31.738681316375732, "time_total_s": 4540.247965097427, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15ea620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15ea598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15eaa60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1712ea0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4540.247965097427, "timesteps_since_restore": 6059648, "iterations_since_restore": 147, "num_healthy_workers": 4}
{"episode_reward_max": 56.84236200743941, "episode_reward_min": 47.210904693939916, "episode_reward_mean": 50.573045788649544, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.900105723960106, "agent_1": 22.672940064689442}, "custom_metrics": {"delta0_mean": 0.4836440686229347, "delta0_min": 0.43928677391504917, "delta0_max": 0.5106585164032523, "delta1_mean": 0.4162181996835622, "delta1_min": 0.39262994702693027, "delta1_max": 0.4298375729810815, "price0_mean": 1.6393036543800057, "price0_min": 1.6289013183596321, "price0_max": 1.6437913069337056, "price1_mean": 1.6531466047820051, "price1_min": 1.6383433376208458, "price1_max": 1.6607651510194434}, "sampler_perf": {"mean_env_wait_ms": 1.1258836646629335, "mean_processing_ms": 16.590562055046806, "mean_inference_ms": 2.077491919145131}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 497, "num_steps_trained": 24985600, "num_steps_sampled": 6086528, "sample_throughput": 0.0, "train_throughput": 28831.476, "num_weight_syncs": 11887, "num_samples_dropped": 875, "learner_queue": {"size_count": 109212, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.582, "replay_time_ms": 95.606, "update_priorities_time_ms": 54.227, "policy_agent_0": {"added_count": 1532672, "sampled_count": 6195712, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1532672, "sampled_count": 6195712, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3865302801132202}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6369158625602722}}}, "timesteps_this_iter": 26880, "done": false, "timesteps_total": 6086528, "episodes_total": 30360, "training_iteration": 148, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-51-00", "timestamp": 1564912260, "time_this_iter_s": 30.81177258491516, "time_total_s": 4571.0597376823425, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1712730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17122f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17121e0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17228c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4571.0597376823425, "timesteps_since_restore": 6086528, "iterations_since_restore": 148, "num_healthy_workers": 4}
{"episode_reward_max": 57.06241435855192, "episode_reward_min": 46.16977929930465, "episode_reward_mean": 50.016459046827215, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 27.054084486555993, "agent_1": 22.962374560271222}, "custom_metrics": {"delta0_mean": 0.4826703254673114, "delta0_min": 0.43823726077937397, "delta0_max": 0.5102337874380907, "delta1_mean": 0.4144291629095966, "delta1_min": 0.3906109046917507, "delta1_max": 0.4279069379748445, "price0_mean": 1.6386953474902985, "price0_min": 1.6282265957479913, "price0_max": 1.6432830311914066, "price1_mean": 1.6527577559694162, "price1_min": 1.6380297218518416, "price1_max": 1.6604793191819502}, "sampler_perf": {"mean_env_wait_ms": 1.126539280343114, "mean_processing_ms": 16.64692912032155, "mean_inference_ms": 2.0766724167837545}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 501, "num_steps_trained": 25161984, "num_steps_sampled": 6113152, "sample_throughput": 3734.806, "train_throughput": 7469.612, "num_weight_syncs": 11938, "num_samples_dropped": 875, "learner_queue": {"size_count": 109901, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.841, "replay_time_ms": 83.014, "update_priorities_time_ms": 45.758, "policy_agent_0": {"added_count": 1539456, "sampled_count": 6239488, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1539456, "sampled_count": 6239488, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39095962047576904}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6553866863250732}}}, "timesteps_this_iter": 26624, "done": false, "timesteps_total": 6113152, "episodes_total": 30496, "training_iteration": 149, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-51-33", "timestamp": 1564912293, "time_this_iter_s": 31.725260257720947, "time_total_s": 4602.7849979400635, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15eab70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15ea620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175dae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c01e0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4602.7849979400635, "timesteps_since_restore": 6113152, "iterations_since_restore": 149, "num_healthy_workers": 4}
{"episode_reward_max": 57.06241435855192, "episode_reward_min": 46.43250670082341, "episode_reward_mean": 50.28272663757801, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 26.99600127836309, "agent_1": 23.28672535921491}, "custom_metrics": {"delta0_mean": 0.4821659310766729, "delta0_min": 0.4373843332939871, "delta0_max": 0.5090501280394577, "delta1_mean": 0.4127607277600645, "delta1_min": 0.38868030277129084, "delta1_max": 0.42628195702122645, "price0_mean": 1.6381489721799511, "price0_min": 1.6275876071329831, "price0_max": 1.64268369739175, "price1_mean": 1.652452798192426, "price1_min": 1.6377263406702893, "price1_max": 1.660007437363037}, "sampler_perf": {"mean_env_wait_ms": 1.1262160010744515, "mean_processing_ms": 16.703945802633058, "mean_inference_ms": 2.076507267766211}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 504, "num_steps_trained": 25340928, "num_steps_sampled": 6138880, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 11989, "num_samples_dropped": 875, "learner_queue": {"size_count": 110600, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.73, "replay_time_ms": 76.027, "update_priorities_time_ms": 43.545, "policy_agent_0": {"added_count": 1544960, "sampled_count": 6285056, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1544960, "sampled_count": 6285056, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37284573912620544}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6549848318099976}}}, "timesteps_this_iter": 25728, "done": false, "timesteps_total": 6138880, "episodes_total": 30632, "training_iteration": 150, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-52-04", "timestamp": 1564912324, "time_this_iter_s": 31.274548768997192, "time_total_s": 4634.059546709061, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c0378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c0620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c02f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1690d08>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4634.059546709061, "timesteps_since_restore": 6138880, "iterations_since_restore": 150, "num_healthy_workers": 4}
{"episode_reward_max": 56.48966252913988, "episode_reward_min": 47.15809887813355, "episode_reward_mean": 52.3804077625281, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 27.78414859082829, "agent_1": 24.596259171699813}, "custom_metrics": {"delta0_mean": 0.4819840423278759, "delta0_min": 0.4367039730687094, "delta0_max": 0.5084375648384639, "delta1_mean": 0.4116328484260593, "delta1_min": 0.38762157836534966, "delta1_max": 0.424922472787517, "price0_mean": 1.6377537144941088, "price0_min": 1.627168555799944, "price0_max": 1.6422354347275534, "price1_mean": 1.6522344391662913, "price1_min": 1.6375553138395114, "price1_max": 1.6596849186332363}, "sampler_perf": {"mean_env_wait_ms": 1.1259751440163148, "mean_processing_ms": 16.761900702260117, "mean_inference_ms": 2.0759737717798203}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 508, "num_steps_trained": 25518336, "num_steps_sampled": 6166016, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12041, "num_samples_dropped": 875, "learner_queue": {"size_count": 111294, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.937, "replay_time_ms": 85.67, "update_priorities_time_ms": 46.586, "policy_agent_0": {"added_count": 1550592, "sampled_count": 6330368, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1550592, "sampled_count": 6330368, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38006529211997986}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6536598801612854}}}, "timesteps_this_iter": 27136, "done": false, "timesteps_total": 6166016, "episodes_total": 30768, "training_iteration": 151, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-52-36", "timestamp": 1564912356, "time_this_iter_s": 31.82609486579895, "time_total_s": 4665.88564157486, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17228c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c0e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c0c80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16ea048>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4665.88564157486, "timesteps_since_restore": 6166016, "iterations_since_restore": 151, "num_healthy_workers": 4}
{"episode_reward_max": 58.29994039011605, "episode_reward_min": 49.3191926570311, "episode_reward_mean": 53.158660071217, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.991228258322227, "agent_1": 25.167431812894804}, "custom_metrics": {"delta0_mean": 0.48238828039702025, "delta0_min": 0.4369071156940512, "delta0_max": 0.5078059691531625, "delta1_mean": 0.4107962533822279, "delta1_min": 0.3864754616419307, "delta1_max": 0.42353967547868027, "price0_mean": 1.6374842859314949, "price0_min": 1.626817199715552, "price0_max": 1.6419789502842308, "price1_mean": 1.6521475483429369, "price1_min": 1.6373857063111705, "price1_max": 1.6593844100020876}, "sampler_perf": {"mean_env_wait_ms": 1.126157024456026, "mean_processing_ms": 16.81832481365148, "mean_inference_ms": 2.0757705609661956}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 512, "num_steps_trained": 25696768, "num_steps_sampled": 6192000, "sample_throughput": 6544.572, "train_throughput": 0.0, "num_weight_syncs": 12093, "num_samples_dropped": 875, "learner_queue": {"size_count": 111992, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 13.924, "replay_time_ms": 79.8, "update_priorities_time_ms": 45.976, "policy_agent_0": {"added_count": 1556864, "sampled_count": 6374400, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1556864, "sampled_count": 6374400, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3695172071456909}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6315387487411499}}}, "timesteps_this_iter": 25984, "done": false, "timesteps_total": 6192000, "episodes_total": 30896, "training_iteration": 152, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-53-06", "timestamp": 1564912386, "time_this_iter_s": 30.43877339363098, "time_total_s": 4696.324414968491, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c0bf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c0400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175dae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1697048>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4696.324414968491, "timesteps_since_restore": 6192000, "iterations_since_restore": 152, "num_healthy_workers": 4}
{"episode_reward_max": 58.72619917432701, "episode_reward_min": 46.993350848844116, "episode_reward_mean": 52.4027027816029, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 27.9428872746816, "agent_1": 24.4598155069213}, "custom_metrics": {"delta0_mean": 0.48275100973905105, "delta0_min": 0.436497671586837, "delta0_max": 0.50766971141967, "delta1_mean": 0.40963316367432556, "delta1_min": 0.38488655928331994, "delta1_max": 0.4218889108047266, "price0_mean": 1.6371270917145226, "price0_min": 1.6263054390972498, "price0_max": 1.64150661409208, "price1_mean": 1.6520355355886753, "price1_min": 1.6371965724557436, "price1_max": 1.659161104171184}, "sampler_perf": {"mean_env_wait_ms": 1.1261085278899852, "mean_processing_ms": 16.8780134843702, "mean_inference_ms": 2.0757632914616484}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 515, "num_steps_trained": 25871360, "num_steps_sampled": 6218368, "sample_throughput": 2410.346, "train_throughput": 4820.693, "num_weight_syncs": 12144, "num_samples_dropped": 875, "learner_queue": {"size_count": 112673, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.555, "replay_time_ms": 106.51, "update_priorities_time_ms": 59.456, "policy_agent_0": {"added_count": 1564544, "sampled_count": 6416896, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1564544, "sampled_count": 6416896, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36963367462158203}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6151009798049927}}}, "timesteps_this_iter": 26368, "done": false, "timesteps_total": 6218368, "episodes_total": 31032, "training_iteration": 153, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-53-38", "timestamp": 1564912418, "time_this_iter_s": 31.26018977165222, "time_total_s": 4727.584604740143, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16826a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1682488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1682158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1673488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4727.584604740143, "timesteps_since_restore": 6218368, "iterations_since_restore": 153, "num_healthy_workers": 4}
{"episode_reward_max": 57.685462443551955, "episode_reward_min": 50.895548735925004, "episode_reward_mean": 53.90374567548203, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 28.33466930064739, "agent_1": 25.569076374834648}, "custom_metrics": {"delta0_mean": 0.48278061337609907, "delta0_min": 0.43739042517423593, "delta0_max": 0.5082321495904799, "delta1_mean": 0.408904791987809, "delta1_min": 0.38414146120309317, "delta1_max": 0.4213920454646746, "price0_mean": 1.6368495715167404, "price0_min": 1.6261196306765735, "price0_max": 1.6412008377076686, "price1_mean": 1.6518871959407537, "price1_min": 1.6369989657925061, "price1_max": 1.6591295749459791}, "sampler_perf": {"mean_env_wait_ms": 1.1259663200471537, "mean_processing_ms": 16.929275182392093, "mean_inference_ms": 2.0750510158664213}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 519, "num_steps_trained": 26053120, "num_steps_sampled": 6244736, "sample_throughput": 15092.09, "train_throughput": 0.0, "num_weight_syncs": 12195, "num_samples_dropped": 875, "learner_queue": {"size_count": 113383, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 13.898, "replay_time_ms": 86.946, "update_priorities_time_ms": 47.752, "policy_agent_0": {"added_count": 1570944, "sampled_count": 6461952, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1570944, "sampled_count": 6461952, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3700013756752014}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6025893688201904}}}, "timesteps_this_iter": 26368, "done": false, "timesteps_total": 6244736, "episodes_total": 31168, "training_iteration": 154, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-54-10", "timestamp": 1564912450, "time_this_iter_s": 31.73912811279297, "time_total_s": 4759.323732852936, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c0c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c0bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c0e18>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd167c158>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4759.323732852936, "timesteps_since_restore": 6244736, "iterations_since_restore": 154, "num_healthy_workers": 4}
{"episode_reward_max": 58.02166298315359, "episode_reward_min": 51.615365563366616, "episode_reward_mean": 55.64672276337168, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.964533043705046, "agent_1": 26.682189719666667}, "custom_metrics": {"delta0_mean": 0.48255260141304, "delta0_min": 0.4379584141829289, "delta0_max": 0.5086583942290758, "delta1_mean": 0.4086425202281397, "delta1_min": 0.384152182959261, "delta1_max": 0.4211863508608895, "price0_mean": 1.6366706645245275, "price0_min": 1.6260794950533322, "price0_max": 1.641067934297611, "price1_mean": 1.6517384512751123, "price1_min": 1.6369458421000276, "price1_max": 1.6591035420030475}, "sampler_perf": {"mean_env_wait_ms": 1.1257762314857205, "mean_processing_ms": 16.984872851094813, "mean_inference_ms": 2.074843612700815}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 522, "num_steps_trained": 26230272, "num_steps_sampled": 6270592, "sample_throughput": 7568.491, "train_throughput": 0.0, "num_weight_syncs": 12247, "num_samples_dropped": 875, "learner_queue": {"size_count": 114074, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.824, "replay_time_ms": 90.477, "update_priorities_time_ms": 49.362, "policy_agent_0": {"added_count": 1578624, "sampled_count": 6508800, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1578624, "sampled_count": 6508800, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35501712560653687}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5696959495544434}}}, "timesteps_this_iter": 25856, "done": false, "timesteps_total": 6270592, "episodes_total": 31296, "training_iteration": 155, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-54-42", "timestamp": 1564912482, "time_this_iter_s": 31.299678325653076, "time_total_s": 4790.623411178589, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd167c510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd167c268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15d4048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd163ab70>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4790.623411178589, "timesteps_since_restore": 6270592, "iterations_since_restore": 155, "num_healthy_workers": 4}
{"episode_reward_max": 59.211259590132144, "episode_reward_min": 53.3316276832759, "episode_reward_mean": 56.74702396816118, "episode_len_mean": 100.0, "episodes_this_iter": 144, "policy_reward_mean": {"agent_0": 29.88102881124583, "agent_1": 26.865995156915393}, "custom_metrics": {"delta0_mean": 0.48321292532086435, "delta0_min": 0.4388689144864224, "delta0_max": 0.509322848560265, "delta1_mean": 0.4084152266400793, "delta1_min": 0.38399187648807465, "delta1_max": 0.4210222661697679, "price0_mean": 1.636571608189929, "price0_min": 1.626024020118098, "price0_max": 1.640962188448798, "price1_mean": 1.6517708922567156, "price1_min": 1.6370097522029308, "price1_max": 1.6591320336816928}, "sampler_perf": {"mean_env_wait_ms": 1.125758481256778, "mean_processing_ms": 17.0395084353091, "mean_inference_ms": 2.0737566516497346}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 526, "num_steps_trained": 26406400, "num_steps_sampled": 6296832, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12298, "num_samples_dropped": 875, "learner_queue": {"size_count": 114763, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.696, "replay_time_ms": 91.302, "update_priorities_time_ms": 48.284, "policy_agent_0": {"added_count": 1585152, "sampled_count": 6552832, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1585152, "sampled_count": 6552832, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3612437844276428}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5436914563179016}}}, "timesteps_this_iter": 26240, "done": false, "timesteps_total": 6296832, "episodes_total": 31440, "training_iteration": 156, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-55-13", "timestamp": 1564912513, "time_this_iter_s": 31.48843002319336, "time_total_s": 4822.111841201782, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c0c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c0bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c0400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15c3ae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4822.111841201782, "timesteps_since_restore": 6296832, "iterations_since_restore": 156, "num_healthy_workers": 4}
{"episode_reward_max": 59.22085233844226, "episode_reward_min": 56.798584707116085, "episode_reward_mean": 58.563168410022406, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 30.208141360719164, "agent_1": 28.355027049303253}, "custom_metrics": {"delta0_mean": 0.4834836292306849, "delta0_min": 0.43984038287595545, "delta0_max": 0.5099540578723353, "delta1_mean": 0.40878652106971775, "delta1_min": 0.3844970407229341, "delta1_max": 0.4213353990125011, "price0_mean": 1.6365998801844708, "price0_min": 1.6261394192874783, "price0_max": 1.6410055353917534, "price1_mean": 1.651795863979782, "price1_min": 1.637180377818669, "price1_max": 1.6592132798904495}, "sampler_perf": {"mean_env_wait_ms": 1.1254984439794757, "mean_processing_ms": 17.096990724813164, "mean_inference_ms": 2.072715357974665}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 529, "num_steps_trained": 26583808, "num_steps_sampled": 6322688, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12348, "num_samples_dropped": 875, "learner_queue": {"size_count": 115457, "size_mean": 0.22, "size_std": 0.41424630354415964, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.369, "replay_time_ms": 99.911, "update_priorities_time_ms": 52.568, "policy_agent_0": {"added_count": 1591552, "sampled_count": 6598656, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1591552, "sampled_count": 6598656, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34609255194664}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49502888321876526}}}, "timesteps_this_iter": 25856, "done": false, "timesteps_total": 6322688, "episodes_total": 31576, "training_iteration": 157, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-55-45", "timestamp": 1564912545, "time_this_iter_s": 31.873029470443726, "time_total_s": 4853.984870672226, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15c3ea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15c3b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15c3bf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1590400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4853.984870672226, "timesteps_since_restore": 6322688, "iterations_since_restore": 157, "num_healthy_workers": 4}
{"episode_reward_max": 62.67568904458505, "episode_reward_min": 57.682549252264586, "episode_reward_mean": 59.089813702031236, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 29.556338923897957, "agent_1": 29.533474778133282}, "custom_metrics": {"delta0_mean": 0.4839764372285664, "delta0_min": 0.440557206163875, "delta0_max": 0.5103275928306507, "delta1_mean": 0.4095936339201625, "delta1_min": 0.3854931729008555, "delta1_max": 0.4220893901618088, "price0_mean": 1.6367557580039958, "price0_min": 1.6263602290967678, "price0_max": 1.6411213419209605, "price1_mean": 1.6518912426783017, "price1_min": 1.637335209981885, "price1_max": 1.6592690926034355}, "sampler_perf": {"mean_env_wait_ms": 1.124891174361721, "mean_processing_ms": 17.148645724458092, "mean_inference_ms": 2.0725534569641306}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 533, "num_steps_trained": 26758912, "num_steps_sampled": 6349312, "sample_throughput": 0.0, "train_throughput": 16908.521, "num_weight_syncs": 12400, "num_samples_dropped": 875, "learner_queue": {"size_count": 116139, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.281, "replay_time_ms": 87.92, "update_priorities_time_ms": 47.449, "policy_agent_0": {"added_count": 1598464, "sampled_count": 6644992, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1598464, "sampled_count": 6644992, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33375614881515503}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46953973174095154}}}, "timesteps_this_iter": 26624, "done": false, "timesteps_total": 6349312, "episodes_total": 31712, "training_iteration": 158, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-56-17", "timestamp": 1564912577, "time_this_iter_s": 31.637959003448486, "time_total_s": 4885.622829675674, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd171b1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c0400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c0bf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1597158>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4885.622829675674, "timesteps_since_restore": 6349312, "iterations_since_restore": 158, "num_healthy_workers": 4}
{"episode_reward_max": 58.78836617670662, "episode_reward_min": 57.53093323034785, "episode_reward_mean": 58.16456498309261, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.037047043686773, "agent_1": 29.127517939405838}, "custom_metrics": {"delta0_mean": 0.48472094353762546, "delta0_min": 0.4410023177995165, "delta0_max": 0.5105140738957034, "delta1_mean": 0.41017723856698196, "delta1_min": 0.38619002061759833, "delta1_max": 0.42260833532694436, "price0_mean": 1.6368717138636986, "price0_min": 1.6264846321487347, "price0_max": 1.641184586663819, "price1_mean": 1.6519928832935353, "price1_min": 1.6374114522259575, "price1_max": 1.6592615522191634}, "sampler_perf": {"mean_env_wait_ms": 1.1250741531019952, "mean_processing_ms": 17.206123240703974, "mean_inference_ms": 2.0727457277909718}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 536, "num_steps_trained": 26931456, "num_steps_sampled": 6374912, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12450, "num_samples_dropped": 875, "learner_queue": {"size_count": 116813, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.217, "replay_time_ms": 92.48, "update_priorities_time_ms": 43.228, "policy_agent_0": {"added_count": 1604352, "sampled_count": 6686464, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1604352, "sampled_count": 6686464, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33213990926742554}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43254315853118896}}}, "timesteps_this_iter": 25600, "done": false, "timesteps_total": 6374912, "episodes_total": 31840, "training_iteration": 159, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-56-47", "timestamp": 1564912607, "time_this_iter_s": 30.45937418937683, "time_total_s": 4916.082203865051, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15971e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1597268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1597510>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15a1730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4916.082203865051, "timesteps_since_restore": 6374912, "iterations_since_restore": 159, "num_healthy_workers": 4}
{"episode_reward_max": 59.665982818638724, "episode_reward_min": 56.994281044159365, "episode_reward_mean": 58.33127967919762, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.96362145084592, "agent_1": 30.3676582283517}, "custom_metrics": {"delta0_mean": 0.484608157089017, "delta0_min": 0.4411628886016979, "delta0_max": 0.5102365306089586, "delta1_mean": 0.41121717560191334, "delta1_min": 0.38722767010462367, "delta1_max": 0.4234940499205791, "price0_mean": 1.637035137079986, "price0_min": 1.6266732858500208, "price0_max": 1.6413442750600247, "price1_mean": 1.65196330366024, "price1_min": 1.637431534256094, "price1_max": 1.659195199836091}, "sampler_perf": {"mean_env_wait_ms": 1.1254220905012966, "mean_processing_ms": 17.26410619970252, "mean_inference_ms": 2.072947317440514}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 540, "num_steps_trained": 27111168, "num_steps_sampled": 6401408, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12502, "num_samples_dropped": 875, "learner_queue": {"size_count": 117515, "size_mean": 0.22, "size_std": 0.41424630354415964, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.159, "replay_time_ms": 96.273, "update_priorities_time_ms": 52.034, "policy_agent_0": {"added_count": 1612160, "sampled_count": 6730496, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1612160, "sampled_count": 6730496, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3132142722606659}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3865245282649994}}}, "timesteps_this_iter": 26496, "done": false, "timesteps_total": 6401408, "episodes_total": 31968, "training_iteration": 160, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-57-20", "timestamp": 1564912640, "time_this_iter_s": 31.90222144126892, "time_total_s": 4947.98442530632, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1590400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15d4048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd163ab70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15a4488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4947.98442530632, "timesteps_since_restore": 6401408, "iterations_since_restore": 160, "num_healthy_workers": 4}
{"episode_reward_max": 57.53639567890853, "episode_reward_min": 56.1596395036232, "episode_reward_mean": 56.90315308915508, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 26.686690501691018, "agent_1": 30.216462587464076}, "custom_metrics": {"delta0_mean": 0.4840446609538195, "delta0_min": 0.4407892175268826, "delta0_max": 0.5095383824441652, "delta1_mean": 0.4121960418656095, "delta1_min": 0.3883180984446015, "delta1_max": 0.4244172964019395, "price0_mean": 1.6371490284862418, "price0_min": 1.6268323361459749, "price0_max": 1.6414491112750311, "price1_mean": 1.6518146575606116, "price1_min": 1.6373333962464616, "price1_max": 1.6590143552703183}, "sampler_perf": {"mean_env_wait_ms": 1.125353087061819, "mean_processing_ms": 17.31914153580549, "mean_inference_ms": 2.072917645437457}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 543, "num_steps_trained": 27289088, "num_steps_sampled": 6427008, "sample_throughput": 0.0, "train_throughput": 31893.953, "num_weight_syncs": 12551, "num_samples_dropped": 875, "learner_queue": {"size_count": 118210, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.735, "replay_time_ms": 86.379, "update_priorities_time_ms": 43.371, "policy_agent_0": {"added_count": 1618432, "sampled_count": 6777600, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1618432, "sampled_count": 6777600, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3226032853126526}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3693109154701233}}}, "timesteps_this_iter": 25600, "done": false, "timesteps_total": 6427008, "episodes_total": 32096, "training_iteration": 161, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-57-51", "timestamp": 1564912671, "time_this_iter_s": 30.45518946647644, "time_total_s": 4978.439614772797, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15a47b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15a4730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15a4840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15ada60>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 4978.439614772797, "timesteps_since_restore": 6427008, "iterations_since_restore": 161, "num_healthy_workers": 4}
{"episode_reward_max": 57.58110077529074, "episode_reward_min": 53.267785517693916, "episode_reward_mean": 55.517245708631044, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.968806297313588, "agent_1": 27.548439411317453}, "custom_metrics": {"delta0_mean": 0.48393597141651984, "delta0_min": 0.44096310962060953, "delta0_max": 0.5092271522260238, "delta1_mean": 0.41222861904342906, "delta1_min": 0.3882855135601227, "delta1_max": 0.42437980884308657, "price0_mean": 1.6370752387204843, "price0_min": 1.626765913522677, "price0_max": 1.6413906726672791, "price1_mean": 1.6517228573195397, "price1_min": 1.6372904756969135, "price1_max": 1.658881446504182}, "sampler_perf": {"mean_env_wait_ms": 1.125482750780872, "mean_processing_ms": 17.376192121416583, "mean_inference_ms": 2.0726852218601373}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 547, "num_steps_trained": 27472384, "num_steps_sampled": 6452224, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12601, "num_samples_dropped": 875, "learner_queue": {"size_count": 118927, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.762, "replay_time_ms": 97.739, "update_priorities_time_ms": 53.33, "policy_agent_0": {"added_count": 1624832, "sampled_count": 6822912, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1624832, "sampled_count": 6822912, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3207712769508362}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3459269106388092}}}, "timesteps_this_iter": 25216, "done": false, "timesteps_total": 6452224, "episodes_total": 32224, "training_iteration": 162, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-58-24", "timestamp": 1564912704, "time_this_iter_s": 31.60841417312622, "time_total_s": 5010.048028945923, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15a1598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15a1048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15a1158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15976a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5010.048028945923, "timesteps_since_restore": 6452224, "iterations_since_restore": 162, "num_healthy_workers": 4}
{"episode_reward_max": 56.97306132901089, "episode_reward_min": 51.26375432694499, "episode_reward_mean": 54.30248266661785, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 30.836190443373667, "agent_1": 23.46629222324418}, "custom_metrics": {"delta0_mean": 0.4853423462843865, "delta0_min": 0.4420886991521342, "delta0_max": 0.5100993958627261, "delta1_mean": 0.4107389095401344, "delta1_min": 0.3868205405467978, "delta1_max": 0.4227862933307117, "price0_mean": 1.636786403354228, "price0_min": 1.626472726137772, "price0_max": 1.6410558359704903, "price1_mean": 1.651916571340476, "price1_min": 1.637467789067257, "price1_max": 1.658969959655212}, "sampler_perf": {"mean_env_wait_ms": 1.1253764229701733, "mean_processing_ms": 17.43365248149102, "mean_inference_ms": 2.072421836564917}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 551, "num_steps_trained": 27650304, "num_steps_sampled": 6478080, "sample_throughput": 0.0, "train_throughput": 39499.037, "num_weight_syncs": 12651, "num_samples_dropped": 875, "learner_queue": {"size_count": 119621, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.436, "replay_time_ms": 92.059, "update_priorities_time_ms": 51.37, "policy_agent_0": {"added_count": 1630080, "sampled_count": 6869760, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1630080, "sampled_count": 6869760, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3250384032726288}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36036577820777893}}}, "timesteps_this_iter": 25856, "done": false, "timesteps_total": 6478080, "episodes_total": 32360, "training_iteration": 163, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-58-56", "timestamp": 1564912736, "time_this_iter_s": 31.86586284637451, "time_total_s": 5041.913891792297, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1590400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1590a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1590b70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15d1488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5041.913891792297, "timesteps_since_restore": 6478080, "iterations_since_restore": 163, "num_healthy_workers": 4}
{"episode_reward_max": 54.56074366907064, "episode_reward_min": 50.28029830502077, "episode_reward_mean": 53.170743199905466, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 31.474865055632343, "agent_1": 21.695878144273124}, "custom_metrics": {"delta0_mean": 0.4860057038832793, "delta0_min": 0.443357742833304, "delta0_max": 0.5111081743689272, "delta1_mean": 0.4087308978259244, "delta1_min": 0.38494881391834174, "delta1_max": 0.4207714188347013, "price0_mean": 1.6363411623374544, "price0_min": 1.6261108932229797, "price0_max": 1.640613640534625, "price1_mean": 1.651999775277176, "price1_min": 1.6376915131705465, "price1_max": 1.659108535545621}, "sampler_perf": {"mean_env_wait_ms": 1.1255268340202187, "mean_processing_ms": 17.491916639218143, "mean_inference_ms": 2.0719420005325024}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 554, "num_steps_trained": 27832320, "num_steps_sampled": 6503552, "sample_throughput": 0.0, "train_throughput": 26591.59, "num_weight_syncs": 12701, "num_samples_dropped": 875, "learner_queue": {"size_count": 120333, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 21.356, "replay_time_ms": 106.225, "update_priorities_time_ms": 60.45, "policy_agent_0": {"added_count": 1635456, "sampled_count": 6915072, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1635456, "sampled_count": 6915072, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31580275297164917}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3729136884212494}}}, "timesteps_this_iter": 25472, "done": false, "timesteps_total": 6503552, "episodes_total": 32488, "training_iteration": 164, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_09-59-28", "timestamp": 1564912768, "time_this_iter_s": 31.960686445236206, "time_total_s": 5073.874578237534, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15a1730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15a1598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15a16a8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15c3378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5073.874578237534, "timesteps_since_restore": 6503552, "iterations_since_restore": 164, "num_healthy_workers": 4}
{"episode_reward_max": 53.16398363983839, "episode_reward_min": 50.2100128387887, "episode_reward_mean": 51.98661067055069, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 31.18566181559506, "agent_1": 20.800948854955625}, "custom_metrics": {"delta0_mean": 0.48752750712722076, "delta0_min": 0.4445089135497126, "delta0_max": 0.5121327264677781, "delta1_mean": 0.40626722493501477, "delta1_min": 0.3827366522507919, "delta1_max": 0.41839596623575315, "price0_mean": 1.6358639540096698, "price0_min": 1.6256693750505264, "price0_max": 1.640059143057717, "price1_mean": 1.6522381730547968, "price1_min": 1.6379290727049083, "price1_max": 1.659243827733418}, "sampler_perf": {"mean_env_wait_ms": 1.1256097934724156, "mean_processing_ms": 17.54249932844302, "mean_inference_ms": 2.0720320993077186}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 558, "num_steps_trained": 28009984, "num_steps_sampled": 6529664, "sample_throughput": 9360.98, "train_throughput": 0.0, "num_weight_syncs": 12751, "num_samples_dropped": 875, "learner_queue": {"size_count": 121027, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.334, "replay_time_ms": 84.978, "update_priorities_time_ms": 42.844, "policy_agent_0": {"added_count": 1640960, "sampled_count": 6961664, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1640960, "sampled_count": 6961664, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.307143896818161}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43965744972229004}}}, "timesteps_this_iter": 26112, "done": false, "timesteps_total": 6529664, "episodes_total": 32624, "training_iteration": 165, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-00-00", "timestamp": 1564912800, "time_this_iter_s": 31.873014211654663, "time_total_s": 5105.747592449188, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15c3620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16970d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1697048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15d4048>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5105.747592449188, "timesteps_since_restore": 6529664, "iterations_since_restore": 165, "num_healthy_workers": 4}
{"episode_reward_max": 52.66948558408943, "episode_reward_min": 47.570863140377035, "episode_reward_mean": 50.00736464177922, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 30.645874567376644, "agent_1": 19.361490074402575}, "custom_metrics": {"delta0_mean": 0.4878859762845794, "delta0_min": 0.4454738018692815, "delta0_max": 0.512895382450138, "delta1_mean": 0.40349491285813477, "delta1_min": 0.380048267657213, "delta1_max": 0.4155740652530503, "price0_mean": 1.6352578294299553, "price0_min": 1.6251365417399743, "price0_max": 1.6394771984611323, "price1_mean": 1.652309439551432, "price1_min": 1.6381595045302346, "price1_max": 1.6593703192084024}, "sampler_perf": {"mean_env_wait_ms": 1.1258646922517728, "mean_processing_ms": 17.604121452277376, "mean_inference_ms": 2.07096775984093}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 561, "num_steps_trained": 28185344, "num_steps_sampled": 6554752, "sample_throughput": 17354.806, "train_throughput": 0.0, "num_weight_syncs": 12801, "num_samples_dropped": 875, "learner_queue": {"size_count": 121711, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.791, "replay_time_ms": 93.51, "update_priorities_time_ms": 45.381, "policy_agent_0": {"added_count": 1648128, "sampled_count": 7003904, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1648128, "sampled_count": 7003904, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.304469496011734}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48720160126686096}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6554752, "episodes_total": 32752, "training_iteration": 166, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-00-33", "timestamp": 1564912833, "time_this_iter_s": 32.765567779541016, "time_total_s": 5138.513160228729, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15a1730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15a1158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15a1048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1673950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5138.513160228729, "timesteps_since_restore": 6554752, "iterations_since_restore": 166, "num_healthy_workers": 4}
{"episode_reward_max": 52.15886277728062, "episode_reward_min": 45.520211461607566, "episode_reward_mean": 49.17385309355148, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.402404759440085, "agent_1": 19.771448334111394}, "custom_metrics": {"delta0_mean": 0.48825985657751736, "delta0_min": 0.4460046850212409, "delta0_max": 0.5131294480097254, "delta1_mean": 0.40087160522798715, "delta1_min": 0.377568498912441, "delta1_max": 0.4130449288620519, "price0_mean": 1.6346461646688233, "price0_min": 1.6245735666164116, "price0_max": 1.6388133973866421, "price1_mean": 1.6523342414400206, "price1_min": 1.6382506565816777, "price1_max": 1.6593761263949032}, "sampler_perf": {"mean_env_wait_ms": 1.1259946867796709, "mean_processing_ms": 17.657201118671363, "mean_inference_ms": 2.0701570193587893}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 565, "num_steps_trained": 28362752, "num_steps_sampled": 6579840, "sample_throughput": 3892.682, "train_throughput": 0.0, "num_weight_syncs": 12850, "num_samples_dropped": 875, "learner_queue": {"size_count": 122404, "size_mean": 0.22, "size_std": 0.41424630354415964, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.654, "replay_time_ms": 98.802, "update_priorities_time_ms": 51.613, "policy_agent_0": {"added_count": 1655040, "sampled_count": 7049216, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1655040, "sampled_count": 7049216, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3093976080417633}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5349582433700562}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6579840, "episodes_total": 32880, "training_iteration": 167, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-01-04", "timestamp": 1564912864, "time_this_iter_s": 30.74947714805603, "time_total_s": 5169.262637376785, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1673510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1673378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1673ae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1682950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5169.262637376785, "timesteps_since_restore": 6579840, "iterations_since_restore": 167, "num_healthy_workers": 4}
{"episode_reward_max": 51.11380853101657, "episode_reward_min": 46.795118842384106, "episode_reward_mean": 48.90553255855706, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.35709766151613, "agent_1": 21.548434897040927}, "custom_metrics": {"delta0_mean": 0.48793011497614913, "delta0_min": 0.44578552268494875, "delta0_max": 0.512779986965138, "delta1_mean": 0.39887862766689053, "delta1_min": 0.3756369342398586, "delta1_max": 0.4109796183831254, "price0_mean": 1.6340854447026347, "price0_min": 1.624039128631641, "price0_max": 1.6382572051673088, "price1_mean": 1.6521321390364996, "price1_min": 1.6381223823892777, "price1_max": 1.6591655248064057}, "sampler_perf": {"mean_env_wait_ms": 1.1259556694341621, "mean_processing_ms": 17.71269653184728, "mean_inference_ms": 2.070346011498897}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 568, "num_steps_trained": 28535552, "num_steps_sampled": 6605312, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12900, "num_samples_dropped": 875, "learner_queue": {"size_count": 123079, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 20.468, "replay_time_ms": 92.191, "update_priorities_time_ms": 54.112, "policy_agent_0": {"added_count": 1661568, "sampled_count": 7091712, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1661568, "sampled_count": 7091712, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30379119515419006}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6031010150909424}}}, "timesteps_this_iter": 25472, "done": false, "timesteps_total": 6605312, "episodes_total": 33008, "training_iteration": 168, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-01-36", "timestamp": 1564912896, "time_this_iter_s": 31.380260705947876, "time_total_s": 5200.642898082733, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15a1158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15a1048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15a1730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16f3d08>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5200.642898082733, "timesteps_since_restore": 6605312, "iterations_since_restore": 168, "num_healthy_workers": 4}
{"episode_reward_max": 51.899322228028055, "episode_reward_min": 46.05510551517197, "episode_reward_mean": 48.65504097463468, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 25.580686058179086, "agent_1": 23.0743549164556}, "custom_metrics": {"delta0_mean": 0.48653459924894366, "delta0_min": 0.44502351278747504, "delta0_max": 0.5118904872280812, "delta1_mean": 0.3975240438324094, "delta1_min": 0.37415473674830135, "delta1_max": 0.40934522428007947, "price0_mean": 1.6335720907382205, "price0_min": 1.6235466860386587, "price0_max": 1.6378260522419499, "price1_mean": 1.6516841432395817, "price1_min": 1.6378392886609592, "price1_max": 1.6588137663895484}, "sampler_perf": {"mean_env_wait_ms": 1.1258660278822903, "mean_processing_ms": 17.7650847632107, "mean_inference_ms": 2.0692299208154754}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 572, "num_steps_trained": 28714240, "num_steps_sampled": 6630656, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12949, "num_samples_dropped": 875, "learner_queue": {"size_count": 123777, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 20.626, "replay_time_ms": 88.518, "update_priorities_time_ms": 47.386, "policy_agent_0": {"added_count": 1668224, "sampled_count": 7136256, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1668224, "sampled_count": 7136256, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31158649921417236}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6359076499938965}}}, "timesteps_this_iter": 25344, "done": false, "timesteps_total": 6630656, "episodes_total": 33128, "training_iteration": 169, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-02-06", "timestamp": 1564912926, "time_this_iter_s": 30.803556203842163, "time_total_s": 5231.446454286575, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16f3510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16f3400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16f3488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17379d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5231.446454286575, "timesteps_since_restore": 6630656, "iterations_since_restore": 169, "num_healthy_workers": 4}
{"episode_reward_max": 50.14769815610367, "episode_reward_min": 45.01638139053986, "episode_reward_mean": 47.58064780505091, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 24.36048311776542, "agent_1": 23.220164687285482}, "custom_metrics": {"delta0_mean": 0.4857067812287883, "delta0_min": 0.4438954086720118, "delta0_max": 0.5103948553485748, "delta1_mean": 0.3961228417671786, "delta1_min": 0.37285175257073905, "delta1_max": 0.4079008352957394, "price0_mean": 1.6331009933421785, "price0_min": 1.6230757071536177, "price0_max": 1.6372941523418119, "price1_mean": 1.6512908339752477, "price1_min": 1.6374038598606824, "price1_max": 1.658286485215329}, "sampler_perf": {"mean_env_wait_ms": 1.125574355597082, "mean_processing_ms": 17.818626620421735, "mean_inference_ms": 2.0700429585502826}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 575, "num_steps_trained": 28888832, "num_steps_sampled": 6655872, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 12998, "num_samples_dropped": 875, "learner_queue": {"size_count": 124459, "size_mean": 0.3, "size_std": 0.5, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 20.814, "replay_time_ms": 91.254, "update_priorities_time_ms": 46.222, "policy_agent_0": {"added_count": 1675136, "sampled_count": 7182080, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1675136, "sampled_count": 7182080, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3354935646057129}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6502436399459839}}}, "timesteps_this_iter": 25216, "done": false, "timesteps_total": 6655872, "episodes_total": 33256, "training_iteration": 170, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-02-38", "timestamp": 1564912958, "time_this_iter_s": 30.646580934524536, "time_total_s": 5262.0930352211, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1682950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1697048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16970d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1722730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5262.0930352211, "timesteps_since_restore": 6655872, "iterations_since_restore": 170, "num_healthy_workers": 4}
{"episode_reward_max": 48.90787206451927, "episode_reward_min": 42.18305417819585, "episode_reward_mean": 46.03059226723036, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 23.172734068209472, "agent_1": 22.857858199020896}, "custom_metrics": {"delta0_mean": 0.4839664664322463, "delta0_min": 0.44233350037098423, "delta0_max": 0.50860573223907, "delta1_mean": 0.39461792950298746, "delta1_min": 0.3714319576418736, "delta1_max": 0.4063503330308471, "price0_mean": 1.632550651836313, "price0_min": 1.622561541187572, "price0_max": 1.6367416082006565, "price1_mean": 1.6507018710642725, "price1_min": 1.6368485656483773, "price1_max": 1.6576810601916498}, "sampler_perf": {"mean_env_wait_ms": 1.1258068985074563, "mean_processing_ms": 17.880938509642036, "mean_inference_ms": 2.070018673623068}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 579, "num_steps_trained": 29074688, "num_steps_sampled": 6680960, "sample_throughput": 9619.619, "train_throughput": 0.0, "num_weight_syncs": 13048, "num_samples_dropped": 875, "learner_queue": {"size_count": 125185, "size_mean": 0.18, "size_std": 0.4331281565541544, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.2, "replay_time_ms": 90.083, "update_priorities_time_ms": 47.428, "policy_agent_0": {"added_count": 1681408, "sampled_count": 7227904, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1681408, "sampled_count": 7227904, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36009734869003296}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6572586894035339}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6680960, "episodes_total": 33384, "training_iteration": 171, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-03-11", "timestamp": 1564912991, "time_this_iter_s": 32.22810459136963, "time_total_s": 5294.3211398124695, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17226a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1722378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd171b1e0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd170cd08>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5294.3211398124695, "timesteps_since_restore": 6680960, "iterations_since_restore": 171, "num_healthy_workers": 4}
{"episode_reward_max": 50.6606402876432, "episode_reward_min": 46.22915424965795, "episode_reward_mean": 48.06674838304893, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 24.099215363597054, "agent_1": 23.96753301945187}, "custom_metrics": {"delta0_mean": 0.4825524007619231, "delta0_min": 0.44110057256004764, "delta0_max": 0.5070289281018677, "delta1_mean": 0.3935000132097202, "delta1_min": 0.37040505671848645, "delta1_max": 0.4051699725165404, "price0_mean": 1.6321086893069796, "price0_min": 1.622158682369481, "price0_max": 1.6362811848712482, "price1_mean": 1.650204610560834, "price1_min": 1.636397438199387, "price1_max": 1.657141291075927}, "sampler_perf": {"mean_env_wait_ms": 1.1262698731112182, "mean_processing_ms": 17.936300060382663, "mean_inference_ms": 2.0693086093643265}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 582, "num_steps_trained": 29254144, "num_steps_sampled": 6706048, "sample_throughput": 0.0, "train_throughput": 37763.93, "num_weight_syncs": 13096, "num_samples_dropped": 875, "learner_queue": {"size_count": 125886, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.697, "replay_time_ms": 88.437, "update_priorities_time_ms": 42.631, "policy_agent_0": {"added_count": 1687936, "sampled_count": 7271936, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1687936, "sampled_count": 7271936, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4003424048423767}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6444003582000732}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6706048, "episodes_total": 33512, "training_iteration": 172, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-03-43", "timestamp": 1564913023, "time_this_iter_s": 32.0689959526062, "time_total_s": 5326.390135765076, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17379d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16f3488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16f3400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1776158>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5326.390135765076, "timesteps_since_restore": 6706048, "iterations_since_restore": 172, "num_healthy_workers": 4}
{"episode_reward_max": 55.447011683053354, "episode_reward_min": 45.46669317307919, "episode_reward_mean": 49.59990396717329, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 23.768047307000707, "agent_1": 25.83185666017258}, "custom_metrics": {"delta0_mean": 0.48103703108462653, "delta0_min": 0.4397836380703892, "delta0_max": 0.5053725649092684, "delta1_mean": 0.393020861498081, "delta1_min": 0.369889231061798, "delta1_max": 0.4046406354679064, "price0_mean": 1.6318318497931434, "price0_min": 1.6218888629463162, "price0_max": 1.6360310068091937, "price1_mean": 1.6497252069011346, "price1_min": 1.635979439904453, "price1_max": 1.656640683593471}, "sampler_perf": {"mean_env_wait_ms": 1.125919379938765, "mean_processing_ms": 17.99094991005024, "mean_inference_ms": 2.069402524783605}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 586, "num_steps_trained": 29432320, "num_steps_sampled": 6731648, "sample_throughput": 0.0, "train_throughput": 0.0, "num_weight_syncs": 13147, "num_samples_dropped": 875, "learner_queue": {"size_count": 126582, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.463, "replay_time_ms": 80.454, "update_priorities_time_ms": 46.85, "policy_agent_0": {"added_count": 1694080, "sampled_count": 7314944, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1694080, "sampled_count": 7314944, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4255526065826416}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6258115172386169}}}, "timesteps_this_iter": 25600, "done": false, "timesteps_total": 6731648, "episodes_total": 33640, "training_iteration": 173, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-04-14", "timestamp": 1564913054, "time_this_iter_s": 31.642499685287476, "time_total_s": 5358.032635450363, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fad1dc31840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176e7b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176e6a8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176b488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5358.032635450363, "timesteps_since_restore": 6731648, "iterations_since_restore": 173, "num_healthy_workers": 4}
{"episode_reward_max": 53.08800232264853, "episode_reward_min": 45.70270683594452, "episode_reward_mean": 47.8619483442216, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 23.06677192870984, "agent_1": 24.795176415511754}, "custom_metrics": {"delta0_mean": 0.47929740996730885, "delta0_min": 0.4381850317828067, "delta0_max": 0.5035373999573743, "delta1_mean": 0.39219396217719305, "delta1_min": 0.36907746918129974, "delta1_max": 0.4037073104734372, "price0_mean": 1.6314640274561722, "price0_min": 1.6215423796725406, "price0_max": 1.6356447818751452, "price1_mean": 1.649165742616113, "price1_min": 1.6354889402875816, "price1_max": 1.6560509730593072}, "sampler_perf": {"mean_env_wait_ms": 1.1261251278657842, "mean_processing_ms": 18.03755408549315, "mean_inference_ms": 2.069230438285052}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 589, "num_steps_trained": 29604608, "num_steps_sampled": 6757888, "sample_throughput": 11620.834, "train_throughput": 23241.668, "num_weight_syncs": 13197, "num_samples_dropped": 875, "learner_queue": {"size_count": 127255, "size_mean": 1.6, "size_std": 2.107130750570548, "size_quantiles": [0.0, 0.0, 1.0, 5.0, 8.0]}, "replay_shard_0": {"add_batch_time_ms": 16.968, "replay_time_ms": 77.311, "update_priorities_time_ms": 44.541, "policy_agent_0": {"added_count": 1700096, "sampled_count": 7357952, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1700096, "sampled_count": 7357952, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4510951638221741}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.6195799708366394}}}, "timesteps_this_iter": 26240, "done": false, "timesteps_total": 6757888, "episodes_total": 33768, "training_iteration": 174, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-04-47", "timestamp": 1564913087, "time_this_iter_s": 31.897226810455322, "time_total_s": 5389.9298622608185, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1776378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd171b1e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd170cd08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd174e840>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5389.9298622608185, "timesteps_since_restore": 6757888, "iterations_since_restore": 174, "num_healthy_workers": 4}
{"episode_reward_max": 53.94583948340117, "episode_reward_min": 45.61616837624544, "episode_reward_mean": 51.245407529932464, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 23.710752821044096, "agent_1": 27.53465470888836}, "custom_metrics": {"delta0_mean": 0.4777872924051554, "delta0_min": 0.4367611734057608, "delta0_max": 0.501843098086122, "delta1_mean": 0.39229265617113535, "delta1_min": 0.36927301748167324, "delta1_max": 0.4038400772660079, "price0_mean": 1.631334926918353, "price0_min": 1.6214532577492562, "price0_max": 1.6354442635033033, "price1_mean": 1.6487243536182836, "price1_min": 1.6351016559837264, "price1_max": 1.655544552305991}, "sampler_perf": {"mean_env_wait_ms": 1.1265869077820965, "mean_processing_ms": 18.09311309887718, "mean_inference_ms": 2.068537302685214}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 593, "num_steps_trained": 29784064, "num_steps_sampled": 6782976, "sample_throughput": 17159.004, "train_throughput": 0.0, "num_weight_syncs": 13247, "num_samples_dropped": 875, "learner_queue": {"size_count": 127956, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.226, "replay_time_ms": 87.334, "update_priorities_time_ms": 50.904, "policy_agent_0": {"added_count": 1706752, "sampled_count": 7403520, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1706752, "sampled_count": 7403520, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.48782750964164734}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5847665667533875}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6782976, "episodes_total": 33896, "training_iteration": 175, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-05-18", "timestamp": 1564913118, "time_this_iter_s": 31.41095733642578, "time_total_s": 5421.340819597244, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd174e9d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd174ebf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17f7378>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd164d510>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5421.340819597244, "timesteps_since_restore": 6782976, "iterations_since_restore": 175, "num_healthy_workers": 4}
{"episode_reward_max": 54.173193513699026, "episode_reward_min": 45.35569626134036, "episode_reward_mean": 48.96047557212138, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 23.313781953464854, "agent_1": 25.646693618656528}, "custom_metrics": {"delta0_mean": 0.47615442238183187, "delta0_min": 0.4353871785791662, "delta0_max": 0.5000333709627354, "delta1_mean": 0.39175837694074866, "delta1_min": 0.3690082670984381, "delta1_max": 0.40356831819845407, "price0_mean": 1.6310456855404527, "price0_min": 1.6212482011885807, "price0_max": 1.6350772591554419, "price1_mean": 1.6482048068274204, "price1_min": 1.634588221578818, "price1_max": 1.6549613665601857}, "sampler_perf": {"mean_env_wait_ms": 1.1268241035632403, "mean_processing_ms": 18.147957371331074, "mean_inference_ms": 2.067516835623341}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 597, "num_steps_trained": 29959680, "num_steps_sampled": 6808448, "sample_throughput": 3472.465, "train_throughput": 6944.931, "num_weight_syncs": 13296, "num_samples_dropped": 875, "learner_queue": {"size_count": 128643, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.808, "replay_time_ms": 92.029, "update_priorities_time_ms": 42.715, "policy_agent_0": {"added_count": 1712000, "sampled_count": 7448320, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1712000, "sampled_count": 7448320, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5095452666282654}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5705007314682007}}}, "timesteps_this_iter": 25472, "done": false, "timesteps_total": 6808448, "episodes_total": 34024, "training_iteration": 176, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-05-50", "timestamp": 1564913150, "time_this_iter_s": 31.506675243377686, "time_total_s": 5452.847494840622, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd174e8c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd174ef28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd174eea0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1650378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5452.847494840622, "timesteps_since_restore": 6808448, "iterations_since_restore": 176, "num_healthy_workers": 4}
{"episode_reward_max": 54.85304519849643, "episode_reward_min": 47.0578752649616, "episode_reward_mean": 52.41564846150115, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.487611410517783, "agent_1": 26.928037050983377}, "custom_metrics": {"delta0_mean": 0.4752575165206655, "delta0_min": 0.43474052758187937, "delta0_max": 0.49906733957108845, "delta1_mean": 0.39165731918880076, "delta1_min": 0.3688754362297264, "delta1_max": 0.4032320131973718, "price0_mean": 1.6308762705675885, "price0_min": 1.6210898611333708, "price0_max": 1.6349292259343882, "price1_mean": 1.647879090719394, "price1_min": 1.6343221476960121, "price1_max": 1.6546219011417043}, "sampler_perf": {"mean_env_wait_ms": 1.126656603930579, "mean_processing_ms": 18.19963799422123, "mean_inference_ms": 2.0669052775193726}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 600, "num_steps_trained": 30140416, "num_steps_sampled": 6833536, "sample_throughput": 18042.442, "train_throughput": 0.0, "num_weight_syncs": 13346, "num_samples_dropped": 875, "learner_queue": {"size_count": 129348, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.039, "replay_time_ms": 103.675, "update_priorities_time_ms": 51.156, "policy_agent_0": {"added_count": 1718400, "sampled_count": 7493888, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1718400, "sampled_count": 7493888, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5155994296073914}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5502867698669434}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6833536, "episodes_total": 34152, "training_iteration": 177, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-06-22", "timestamp": 1564913182, "time_this_iter_s": 31.359844207763672, "time_total_s": 5484.207339048386, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1650840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16508c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1650c80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1627f28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5484.207339048386, "timesteps_since_restore": 6833536, "iterations_since_restore": 177, "num_healthy_workers": 4}
{"episode_reward_max": 55.2519672519134, "episode_reward_min": 46.88273715546209, "episode_reward_mean": 52.58762312094563, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 26.064475147437633, "agent_1": 26.523147973507996}, "custom_metrics": {"delta0_mean": 0.47455891298693564, "delta0_min": 0.4342633546473585, "delta0_max": 0.4982793093689255, "delta1_mean": 0.39142299265164815, "delta1_min": 0.36815122174703796, "delta1_max": 0.40279112103196496, "price0_mean": 1.6306843909649729, "price0_min": 1.620795701782859, "price0_max": 1.6347734237734286, "price1_mean": 1.6475985082340485, "price1_min": 1.6341211423953625, "price1_max": 1.6543225666877726}, "sampler_perf": {"mean_env_wait_ms": 1.1267401718072254, "mean_processing_ms": 18.254715510745758, "mean_inference_ms": 2.0660906037977305}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 604, "num_steps_trained": 30328832, "num_steps_sampled": 6858624, "sample_throughput": 12395.145, "train_throughput": 0.0, "num_weight_syncs": 13394, "num_samples_dropped": 875, "learner_queue": {"size_count": 130084, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.264, "replay_time_ms": 71.696, "update_priorities_time_ms": 41.308, "policy_agent_0": {"added_count": 1725312, "sampled_count": 7543808, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1725312, "sampled_count": 7543808, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5132731795310974}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.525339663028717}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6858624, "episodes_total": 34280, "training_iteration": 178, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-06-55", "timestamp": 1564913215, "time_this_iter_s": 32.131426095962524, "time_total_s": 5516.338765144348, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1627620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1627598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1627840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15de8c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5516.338765144348, "timesteps_since_restore": 6858624, "iterations_since_restore": 178, "num_healthy_workers": 4}
{"episode_reward_max": 55.29072036138704, "episode_reward_min": 48.21174095732781, "episode_reward_mean": 52.791364002714175, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 26.1586023522132, "agent_1": 26.632761650500967}, "custom_metrics": {"delta0_mean": 0.4738961362653206, "delta0_min": 0.43377562358742, "delta0_max": 0.4977364555834336, "delta1_mean": 0.3912264133305704, "delta1_min": 0.3682323126459599, "delta1_max": 0.40236647332655334, "price0_mean": 1.6305037734779542, "price0_min": 1.6207005051213186, "price0_max": 1.634475153565102, "price1_mean": 1.6473269371679327, "price1_min": 1.6339107821745475, "price1_max": 1.6540479163708501}, "sampler_perf": {"mean_env_wait_ms": 1.12704743852189, "mean_processing_ms": 18.310267802225308, "mean_inference_ms": 2.065428088613524}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 608, "num_steps_trained": 30515712, "num_steps_sampled": 6883712, "sample_throughput": 10800.493, "train_throughput": 0.0, "num_weight_syncs": 13444, "num_samples_dropped": 875, "learner_queue": {"size_count": 130814, "size_mean": 0.26, "size_std": 0.4386342439892262, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.951, "replay_time_ms": 92.763, "update_priorities_time_ms": 44.579, "policy_agent_0": {"added_count": 1731456, "sampled_count": 7589888, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1731456, "sampled_count": 7589888, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4991399943828583}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5030211210250854}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6883712, "episodes_total": 34408, "training_iteration": 179, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-07-28", "timestamp": 1564913248, "time_this_iter_s": 32.774550437927246, "time_total_s": 5549.113315582275, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1650378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd174eea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd174ef28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15f3f28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5549.113315582275, "timesteps_since_restore": 6883712, "iterations_since_restore": 179, "num_healthy_workers": 4}
{"episode_reward_max": 55.15902759049774, "episode_reward_min": 46.32379143537355, "episode_reward_mean": 52.90905563390922, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.85005403815456, "agent_1": 27.05900159575466}, "custom_metrics": {"delta0_mean": 0.47313691983447737, "delta0_min": 0.43326858067736745, "delta0_max": 0.49699886658193043, "delta1_mean": 0.39117139618484065, "delta1_min": 0.36830032834723886, "delta1_max": 0.4023658095232836, "price0_mean": 1.6303550261843411, "price0_min": 1.6206008932527498, "price0_max": 1.6342854402127658, "price1_mean": 1.6470440782561817, "price1_min": 1.633678157945696, "price1_max": 1.6537527111713304}, "sampler_perf": {"mean_env_wait_ms": 1.1273859295368847, "mean_processing_ms": 18.368207117357493, "mean_inference_ms": 2.0651290036252785}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 611, "num_steps_trained": 30701568, "num_steps_sampled": 6908800, "sample_throughput": 14647.793, "train_throughput": 0.0, "num_weight_syncs": 13492, "num_samples_dropped": 875, "learner_queue": {"size_count": 131541, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.123, "replay_time_ms": 91.883, "update_priorities_time_ms": 54.664, "policy_agent_0": {"added_count": 1737600, "sampled_count": 7635456, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1737600, "sampled_count": 7635456, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4913337528705597}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47956255078315735}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6908800, "episodes_total": 34536, "training_iteration": 180, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-08-01", "timestamp": 1564913281, "time_this_iter_s": 32.89845657348633, "time_total_s": 5582.011772155762, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15f3ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15f3d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15f3d08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15adea0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5582.011772155762, "timesteps_since_restore": 6908800, "iterations_since_restore": 180, "num_healthy_workers": 4}
{"episode_reward_max": 55.45658617998852, "episode_reward_min": 46.89283568949155, "episode_reward_mean": 52.83445143385073, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.838979257224274, "agent_1": 26.995472176626453}, "custom_metrics": {"delta0_mean": 0.47237969867148655, "delta0_min": 0.4328076961230982, "delta0_max": 0.4962704173989985, "delta1_mean": 0.3910961159945475, "delta1_min": 0.36839919861602827, "delta1_max": 0.40138180483843605, "price0_mean": 1.6302031454923513, "price0_min": 1.6205115566476758, "price0_max": 1.634142807543923, "price1_mean": 1.6467598854654075, "price1_min": 1.633425786538937, "price1_max": 1.6534713315066705}, "sampler_perf": {"mean_env_wait_ms": 1.1270965125024484, "mean_processing_ms": 18.427931571698, "mean_inference_ms": 2.064035636537156}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 615, "num_steps_trained": 30903040, "num_steps_sampled": 6933888, "sample_throughput": 15847.184, "train_throughput": 31694.369, "num_weight_syncs": 13541, "num_samples_dropped": 875, "learner_queue": {"size_count": 132328, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.507, "replay_time_ms": 84.837, "update_priorities_time_ms": 44.892, "policy_agent_0": {"added_count": 1742848, "sampled_count": 7689472, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1742848, "sampled_count": 7689472, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49104368686676025}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4562007784843445}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6933888, "episodes_total": 34664, "training_iteration": 181, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-08-35", "timestamp": 1564913315, "time_this_iter_s": 33.58448266983032, "time_total_s": 5615.596254825592, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15de8c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1650378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16508c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15bebf8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5615.596254825592, "timesteps_since_restore": 6933888, "iterations_since_restore": 181, "num_healthy_workers": 4}
{"episode_reward_max": 54.65282761555108, "episode_reward_min": 47.277706458271886, "episode_reward_mean": 52.279035405537506, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.62342608617611, "agent_1": 26.65560931936139}, "custom_metrics": {"delta0_mean": 0.4715580664488629, "delta0_min": 0.4318492325773278, "delta0_max": 0.49553536998585807, "delta1_mean": 0.3909101396317159, "delta1_min": 0.36776186967947166, "delta1_max": 0.4007245815619994, "price0_mean": 1.6300201776303005, "price0_min": 1.62021826147876, "price0_max": 1.6340012255713026, "price1_mean": 1.6464512042145953, "price1_min": 1.6332186707962901, "price1_max": 1.6531896236809454}, "sampler_perf": {"mean_env_wait_ms": 1.1271684313158115, "mean_processing_ms": 18.48167151366074, "mean_inference_ms": 2.063498516721356}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 619, "num_steps_trained": 31075328, "num_steps_sampled": 6958976, "sample_throughput": 14186.421, "train_throughput": 0.0, "num_weight_syncs": 13590, "num_samples_dropped": 875, "learner_queue": {"size_count": 133000, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.656, "replay_time_ms": 86.24, "update_priorities_time_ms": 43.77, "policy_agent_0": {"added_count": 1748608, "sampled_count": 7733504, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1748608, "sampled_count": 7733504, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4758608043193817}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.435127317905426}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6958976, "episodes_total": 34792, "training_iteration": 182, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-09-07", "timestamp": 1564913347, "time_this_iter_s": 31.92767882347107, "time_total_s": 5647.523933649063, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15beea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15bef28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15bd048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11c4268>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5647.523933649063, "timesteps_since_restore": 6958976, "iterations_since_restore": 182, "num_healthy_workers": 4}
{"episode_reward_max": 54.39440152961734, "episode_reward_min": 49.08686078719422, "episode_reward_mean": 52.398796342890456, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 25.892996046196693, "agent_1": 26.505800296693756}, "custom_metrics": {"delta0_mean": 0.4713603674046974, "delta0_min": 0.43117248812471687, "delta0_max": 0.4945539350594172, "delta1_mean": 0.3907157750066184, "delta1_min": 0.36727459896291886, "delta1_max": 0.3999840738446736, "price0_mean": 1.6298873136534349, "price0_min": 1.6199868366774306, "price0_max": 1.6336751187852923, "price1_mean": 1.646268417365573, "price1_min": 1.6330273517237306, "price1_max": 1.652807081984429}, "sampler_perf": {"mean_env_wait_ms": 1.1269288754871576, "mean_processing_ms": 18.537232403936734, "mean_inference_ms": 2.063482267465911}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 622, "num_steps_trained": 31256832, "num_steps_sampled": 6984064, "sample_throughput": 3475.275, "train_throughput": 0.0, "num_weight_syncs": 13640, "num_samples_dropped": 875, "learner_queue": {"size_count": 133711, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.375, "replay_time_ms": 68.67, "update_priorities_time_ms": 37.893, "policy_agent_0": {"added_count": 1753728, "sampled_count": 7780096, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1753728, "sampled_count": 7780096, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47460275888442993}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4390672743320465}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 6984064, "episodes_total": 34912, "training_iteration": 183, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-09-39", "timestamp": 1564913379, "time_this_iter_s": 31.970134019851685, "time_total_s": 5679.494067668915, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15adea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15adf28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15f3d08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11c4f28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5679.494067668915, "timesteps_since_restore": 6984064, "iterations_since_restore": 183, "num_healthy_workers": 4}
{"episode_reward_max": 54.1706905660927, "episode_reward_min": 49.53063973598355, "episode_reward_mean": 52.56996278524022, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.969851452391236, "agent_1": 26.600111332848982}, "custom_metrics": {"delta0_mean": 0.47017513995172555, "delta0_min": 0.43054388896412155, "delta0_max": 0.4936949309843148, "delta1_mean": 0.3904900980629653, "delta1_min": 0.3668332198084136, "delta1_max": 0.3995650204198759, "price0_mean": 1.6296602702367977, "price0_min": 1.6197576519738162, "price0_max": 1.6334445892400515, "price1_mean": 1.6458989325212077, "price1_min": 1.632771853226505, "price1_max": 1.6524762414319976}, "sampler_perf": {"mean_env_wait_ms": 1.1270438399209322, "mean_processing_ms": 18.595065623468265, "mean_inference_ms": 2.0628707681885974}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 626, "num_steps_trained": 31448576, "num_steps_sampled": 7009152, "sample_throughput": 19264.09, "train_throughput": 0.0, "num_weight_syncs": 13688, "num_samples_dropped": 875, "learner_queue": {"size_count": 134458, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 27.877, "replay_time_ms": 98.27, "update_priorities_time_ms": 58.782, "policy_agent_0": {"added_count": 1760000, "sampled_count": 7830016, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1760000, "sampled_count": 7830016, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4546622633934021}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42183759808540344}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7009152, "episodes_total": 35040, "training_iteration": 184, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-10-13", "timestamp": 1564913413, "time_this_iter_s": 33.77048707008362, "time_total_s": 5713.264554738998, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11d62f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11d6268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11d6378>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11d9598>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5713.264554738998, "timesteps_since_restore": 7009152, "iterations_since_restore": 184, "num_healthy_workers": 4}
{"episode_reward_max": 54.35043825982021, "episode_reward_min": 51.32525558137512, "episode_reward_mean": 53.28011204515133, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.982849972782347, "agent_1": 27.29726207236898}, "custom_metrics": {"delta0_mean": 0.46948630227958454, "delta0_min": 0.43002824286264946, "delta0_max": 0.49291061487620685, "delta1_mean": 0.39051558187396485, "delta1_min": 0.3667826834880221, "delta1_max": 0.3995802695933624, "price0_mean": 1.6295356623095185, "price0_min": 1.6196306130071567, "price0_max": 1.6333307205810197, "price1_mean": 1.6456362254942172, "price1_min": 1.6325603603595271, "price1_max": 1.6521930505496332}, "sampler_perf": {"mean_env_wait_ms": 1.126873374869116, "mean_processing_ms": 18.649665475363868, "mean_inference_ms": 2.062579156034428}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 630, "num_steps_trained": 31630336, "num_steps_sampled": 7034240, "sample_throughput": 10440.491, "train_throughput": 0.0, "num_weight_syncs": 13738, "num_samples_dropped": 875, "learner_queue": {"size_count": 135168, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.283, "replay_time_ms": 112.447, "update_priorities_time_ms": 55.3, "policy_agent_0": {"added_count": 1765632, "sampled_count": 7875840, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1765632, "sampled_count": 7875840, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4457443952560425}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4106473922729492}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7034240, "episodes_total": 35168, "training_iteration": 185, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-10-45", "timestamp": 1564913445, "time_this_iter_s": 32.16419696807861, "time_total_s": 5745.428751707077, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11c4048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11c4158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15bd048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15bebf8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5745.428751707077, "timesteps_since_restore": 7034240, "iterations_since_restore": 185, "num_healthy_workers": 4}
{"episode_reward_max": 54.11817703873794, "episode_reward_min": 51.58601159539194, "episode_reward_mean": 53.112869084568246, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 26.205049671209867, "agent_1": 26.90781941335836}, "custom_metrics": {"delta0_mean": 0.4688742695241991, "delta0_min": 0.4295967135580205, "delta0_max": 0.4921502500831352, "delta1_mean": 0.3904156880666203, "delta1_min": 0.36665364189269106, "delta1_max": 0.3993827485718968, "price0_mean": 1.6293834240055116, "price0_min": 1.6194879930769108, "price0_max": 1.6331925423716318, "price1_mean": 1.6453825505514843, "price1_min": 1.6323350455178856, "price1_max": 1.6519091550741603}, "sampler_perf": {"mean_env_wait_ms": 1.1269776671705216, "mean_processing_ms": 18.704419676307754, "mean_inference_ms": 2.0625012293512657}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 633, "num_steps_trained": 31813888, "num_steps_sampled": 7059328, "sample_throughput": 10031.595, "train_throughput": 0.0, "num_weight_syncs": 13786, "num_samples_dropped": 875, "learner_queue": {"size_count": 135885, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.627, "replay_time_ms": 101.456, "update_priorities_time_ms": 45.373, "policy_agent_0": {"added_count": 1772288, "sampled_count": 7921664, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1772288, "sampled_count": 7921664, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42933133244514465}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4032469689846039}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7059328, "episodes_total": 35296, "training_iteration": 186, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-11-18", "timestamp": 1564913478, "time_this_iter_s": 32.80296516418457, "time_total_s": 5778.231716871262, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15be400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15be6a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15beae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15ea8c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5778.231716871262, "timesteps_since_restore": 7059328, "iterations_since_restore": 186, "num_healthy_workers": 4}
{"episode_reward_max": 54.31644347224705, "episode_reward_min": 51.40134069561955, "episode_reward_mean": 53.15088065246353, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 26.360166808997008, "agent_1": 26.79071384346652}, "custom_metrics": {"delta0_mean": 0.46831601050923954, "delta0_min": 0.4291500364084877, "delta0_max": 0.4914924838770034, "delta1_mean": 0.3902788564265676, "delta1_min": 0.3666066184590414, "delta1_max": 0.3993573191432597, "price0_mean": 1.6292261764832014, "price0_min": 1.6193664276179371, "price0_max": 1.6330710848108734, "price1_mean": 1.645140389045686, "price1_min": 1.6320994227605774, "price1_max": 1.6516527468583437}, "sampler_perf": {"mean_env_wait_ms": 1.1266001974244653, "mean_processing_ms": 18.760359943104397, "mean_inference_ms": 2.062117792749552}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 637, "num_steps_trained": 32011264, "num_steps_sampled": 7084416, "sample_throughput": 7723.872, "train_throughput": 0.0, "num_weight_syncs": 13835, "num_samples_dropped": 875, "learner_queue": {"size_count": 136657, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.012, "replay_time_ms": 68.909, "update_priorities_time_ms": 40.804, "policy_agent_0": {"added_count": 1778432, "sampled_count": 7970304, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1778432, "sampled_count": 7970304, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4288107752799988}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39336517453193665}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7084416, "episodes_total": 35424, "training_iteration": 187, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-11-52", "timestamp": 1564913512, "time_this_iter_s": 33.22701048851013, "time_total_s": 5811.458727359772, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11c41e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11c4048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11c40d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15f3510>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5811.458727359772, "timesteps_since_restore": 7084416, "iterations_since_restore": 187, "num_healthy_workers": 4}
{"episode_reward_max": 54.51568695894002, "episode_reward_min": 50.85204422106361, "episode_reward_mean": 53.200930623093136, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.992942267137977, "agent_1": 27.207988355955145}, "custom_metrics": {"delta0_mean": 0.4676441023582323, "delta0_min": 0.42860942547341846, "delta0_max": 0.4907882550269675, "delta1_mean": 0.39027622716820365, "delta1_min": 0.36681814658983203, "delta1_max": 0.39920223998260396, "price0_mean": 1.629097160429748, "price0_min": 1.6193041018812866, "price0_max": 1.6329505026159792, "price1_mean": 1.6448808579674068, "price1_min": 1.631836623730017, "price1_max": 1.6513868814217052}, "sampler_perf": {"mean_env_wait_ms": 1.1264723570554376, "mean_processing_ms": 18.81272335720212, "mean_inference_ms": 2.061860582520021}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 641, "num_steps_trained": 32192768, "num_steps_sampled": 7109504, "sample_throughput": 4885.664, "train_throughput": 0.0, "num_weight_syncs": 13884, "num_samples_dropped": 875, "learner_queue": {"size_count": 137365, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.076, "replay_time_ms": 67.485, "update_priorities_time_ms": 38.971, "policy_agent_0": {"added_count": 1784704, "sampled_count": 8016128, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1784704, "sampled_count": 8016128, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41821712255477905}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.388858437538147}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7109504, "episodes_total": 35552, "training_iteration": 188, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-12-25", "timestamp": 1564913545, "time_this_iter_s": 32.35461950302124, "time_total_s": 5843.813346862793, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15dee18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15ded90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15deb70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16276a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5843.813346862793, "timesteps_since_restore": 7109504, "iterations_since_restore": 188, "num_healthy_workers": 4}
{"episode_reward_max": 54.61544650787092, "episode_reward_min": 51.54777369858967, "episode_reward_mean": 53.328855570457236, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 26.093217994134044, "agent_1": 27.235637576323207}, "custom_metrics": {"delta0_mean": 0.4670089055895883, "delta0_min": 0.4281028222235328, "delta0_max": 0.49008065005339346, "delta1_mean": 0.39028265441172477, "delta1_min": 0.3669928307759528, "delta1_max": 0.3992896988722561, "price0_mean": 1.6289719293998801, "price0_min": 1.6192343430781, "price0_max": 1.6328307863575569, "price1_mean": 1.6446309554180294, "price1_min": 1.6316024796230717, "price1_max": 1.6511207599845266}, "sampler_perf": {"mean_env_wait_ms": 1.1263815533099886, "mean_processing_ms": 18.871165619009403, "mean_inference_ms": 2.061227824669142}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 645, "num_steps_trained": 32381696, "num_steps_sampled": 7134592, "sample_throughput": 4840.774, "train_throughput": 0.0, "num_weight_syncs": 13934, "num_samples_dropped": 875, "learner_queue": {"size_count": 138104, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.923, "replay_time_ms": 89.423, "update_priorities_time_ms": 48.81, "policy_agent_0": {"added_count": 1790720, "sampled_count": 8066048, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1790720, "sampled_count": 8066048, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41412270069122314}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39047107100486755}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7134592, "episodes_total": 35680, "training_iteration": 189, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-13-00", "timestamp": 1564913580, "time_this_iter_s": 33.68422842025757, "time_total_s": 5877.4975752830505, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11c4158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11c41e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15beae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd161d9d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5877.4975752830505, "timesteps_since_restore": 7134592, "iterations_since_restore": 189, "num_healthy_workers": 4}
{"episode_reward_max": 54.30181673201906, "episode_reward_min": 51.17556991051601, "episode_reward_mean": 52.751939540458835, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.65000096074139, "agent_1": 27.101938579717437}, "custom_metrics": {"delta0_mean": 0.46623745598596045, "delta0_min": 0.42747257089928914, "delta0_max": 0.4892151379341662, "delta1_mean": 0.39024673617446315, "delta1_min": 0.36698541366778326, "delta1_max": 0.3992002819844585, "price0_mean": 1.6288323299379681, "price0_min": 1.6191159494684175, "price0_max": 1.632711655960282, "price1_mean": 1.6443461695870336, "price1_min": 1.6313578913304279, "price1_max": 1.6508198651001114}, "sampler_perf": {"mean_env_wait_ms": 1.1266486604392085, "mean_processing_ms": 18.924121405612095, "mean_inference_ms": 2.060791253134632}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 649, "num_steps_trained": 32571136, "num_steps_sampled": 7159680, "sample_throughput": 10702.101, "train_throughput": 21404.203, "num_weight_syncs": 13981, "num_samples_dropped": 875, "learner_queue": {"size_count": 138843, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 20.524, "replay_time_ms": 106.468, "update_priorities_time_ms": 54.485, "policy_agent_0": {"added_count": 1798016, "sampled_count": 8111104, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1798016, "sampled_count": 8111104, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.426596075296402}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3704454004764557}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7159680, "episodes_total": 35808, "training_iteration": 190, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-13-33", "timestamp": 1564913613, "time_this_iter_s": 33.625460147857666, "time_total_s": 5911.123035430908, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd161da60>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd161df28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd161d6a8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fad1dc316a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5911.123035430908, "timesteps_since_restore": 7159680, "iterations_since_restore": 190, "num_healthy_workers": 4}
{"episode_reward_max": 55.11126659701572, "episode_reward_min": 51.13338457703357, "episode_reward_mean": 52.676112289393146, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 25.706564014882744, "agent_1": 26.969548274510394}, "custom_metrics": {"delta0_mean": 0.4660054469508323, "delta0_min": 0.42692459526097076, "delta0_max": 0.4883599381327092, "delta1_mean": 0.3902021720182926, "delta1_min": 0.3668921271701237, "delta1_max": 0.3992219822559764, "price0_mean": 1.6287384613402731, "price0_min": 1.6189930678017677, "price0_max": 1.63252826239355, "price1_mean": 1.6441672592641923, "price1_min": 1.6311337904507444, "price1_max": 1.6505035906702734}, "sampler_perf": {"mean_env_wait_ms": 1.1264460679248063, "mean_processing_ms": 18.97668563687545, "mean_inference_ms": 2.061864169823083}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 652, "num_steps_trained": 32765184, "num_steps_sampled": 7184768, "sample_throughput": 6919.45, "train_throughput": 9225.934, "num_weight_syncs": 14032, "num_samples_dropped": 875, "learner_queue": {"size_count": 139602, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.75, "replay_time_ms": 61.995, "update_priorities_time_ms": 34.789, "policy_agent_0": {"added_count": 1803648, "sampled_count": 8160000, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1803648, "sampled_count": 8160000, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4341348707675934}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38207316398620605}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7184768, "episodes_total": 35928, "training_iteration": 191, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-14-06", "timestamp": 1564913646, "time_this_iter_s": 32.52500057220459, "time_total_s": 5943.648036003113, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15ea8c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11c41e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11c4158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fad18a1fea0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5943.648036003113, "timesteps_since_restore": 7184768, "iterations_since_restore": 191, "num_healthy_workers": 4}
{"episode_reward_max": 55.37510255328276, "episode_reward_min": 51.92149219800158, "episode_reward_mean": 53.25957004481993, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 26.00724431161299, "agent_1": 27.25232573320695}, "custom_metrics": {"delta0_mean": 0.46525454689027806, "delta0_min": 0.4263869729221744, "delta0_max": 0.48762683314434047, "delta1_mean": 0.3902101335638335, "delta1_min": 0.3669742970281271, "delta1_max": 0.39919748145391176, "price0_mean": 1.6286038296276413, "price0_min": 1.6189016475744564, "price0_max": 1.6323915917275666, "price1_mean": 1.643889304989907, "price1_min": 1.6309271272444974, "price1_max": 1.6502198898640041}, "sampler_perf": {"mean_env_wait_ms": 1.1264386888640385, "mean_processing_ms": 19.03241593907374, "mean_inference_ms": 2.0620881171464664}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 656, "num_steps_trained": 32953088, "num_steps_sampled": 7209856, "sample_throughput": 18623.568, "train_throughput": 0.0, "num_weight_syncs": 14080, "num_samples_dropped": 875, "learner_queue": {"size_count": 140335, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.851, "replay_time_ms": 83.482, "update_priorities_time_ms": 47.441, "policy_agent_0": {"added_count": 1809024, "sampled_count": 8206336, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1809024, "sampled_count": 8206336, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4250360131263733}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38244110345840454}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7209856, "episodes_total": 36064, "training_iteration": 192, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-14-40", "timestamp": 1564913680, "time_this_iter_s": 34.07484412193298, "time_total_s": 5977.722880125046, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176b488>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176b1e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176bc80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17760d0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 5977.722880125046, "timesteps_since_restore": 7209856, "iterations_since_restore": 192, "num_healthy_workers": 4}
{"episode_reward_max": 54.64005974848553, "episode_reward_min": 49.37649633352636, "episode_reward_mean": 52.60101978979109, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.412230033201443, "agent_1": 27.188789756589642}, "custom_metrics": {"delta0_mean": 0.4640150875584598, "delta0_min": 0.4257541539786742, "delta0_max": 0.48668354263718067, "delta1_mean": 0.39017809497644274, "delta1_min": 0.36716082953506607, "delta1_max": 0.3990608873528978, "price0_mean": 1.6284330111385, "price0_min": 1.618832566850953, "price0_max": 1.632241271772626, "price1_mean": 1.643520723806295, "price1_min": 1.6306704211419896, "price1_max": 1.6498931806886081}, "sampler_perf": {"mean_env_wait_ms": 1.1262846873398085, "mean_processing_ms": 19.086035400705946, "mean_inference_ms": 2.061236556402589}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 660, "num_steps_trained": 33138688, "num_steps_sampled": 7234944, "sample_throughput": 19986.26, "train_throughput": 0.0, "num_weight_syncs": 14129, "num_samples_dropped": 875, "learner_queue": {"size_count": 141060, "size_mean": 0.16, "size_std": 0.463033476111609, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.862, "replay_time_ms": 86.08, "update_priorities_time_ms": 47.374, "policy_agent_0": {"added_count": 1816064, "sampled_count": 8253952, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1816064, "sampled_count": 8253952, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4161684513092041}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3707558512687683}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7234944, "episodes_total": 36192, "training_iteration": 193, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-15-14", "timestamp": 1564913714, "time_this_iter_s": 34.05870771408081, "time_total_s": 6011.781587839127, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fad1dc31730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fad1dc316a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16276a8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17126a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6011.781587839127, "timesteps_since_restore": 7234944, "iterations_since_restore": 193, "num_healthy_workers": 4}
{"episode_reward_max": 54.88165388653416, "episode_reward_min": 50.72946588455075, "episode_reward_mean": 52.67874776525026, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.518543857407767, "agent_1": 27.160203907842494}, "custom_metrics": {"delta0_mean": 0.46322490982053843, "delta0_min": 0.4251029936064041, "delta0_max": 0.4857828578075166, "delta1_mean": 0.3901608784092774, "delta1_min": 0.36721170974848044, "delta1_max": 0.39894081058808106, "price0_mean": 1.6283004914659505, "price0_min": 1.6187308790678487, "price0_max": 1.6320780154739842, "price1_mean": 1.6432349315826156, "price1_min": 1.6304239264522302, "price1_max": 1.6495725197195032}, "sampler_perf": {"mean_env_wait_ms": 1.1262177839457597, "mean_processing_ms": 19.140475924549705, "mean_inference_ms": 2.0604096555654188}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 664, "num_steps_trained": 33320704, "num_steps_sampled": 7260032, "sample_throughput": 5275.336, "train_throughput": 21101.343, "num_weight_syncs": 14178, "num_samples_dropped": 875, "learner_queue": {"size_count": 141771, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.373, "replay_time_ms": 99.822, "update_priorities_time_ms": 54.029, "policy_agent_0": {"added_count": 1822208, "sampled_count": 8299264, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1822208, "sampled_count": 8299264, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41649338603019714}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37876319885253906}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7260032, "episodes_total": 36320, "training_iteration": 194, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-15-47", "timestamp": 1564913747, "time_this_iter_s": 33.17683672904968, "time_total_s": 6044.958424568176, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17129d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1712f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1712d08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1722620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6044.958424568176, "timesteps_since_restore": 7260032, "iterations_since_restore": 194, "num_healthy_workers": 4}
{"episode_reward_max": 54.79910448039993, "episode_reward_min": 51.1987572266625, "episode_reward_mean": 52.849669784100584, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 25.55250074686935, "agent_1": 27.297169037231235}, "custom_metrics": {"delta0_mean": 0.46295276513162353, "delta0_min": 0.42451943642801615, "delta0_max": 0.4849727668352307, "delta1_mean": 0.3902145325170286, "delta1_min": 0.3673972145850162, "delta1_max": 0.3988319461101957, "price0_mean": 1.6282300478867417, "price0_min": 1.6186757181295297, "price0_max": 1.6319675348304905, "price1_mean": 1.6430552277167114, "price1_min": 1.6301861331101422, "price1_max": 1.6492898633377764}, "sampler_perf": {"mean_env_wait_ms": 1.1265898724702093, "mean_processing_ms": 19.191798768880293, "mean_inference_ms": 2.061568297778187}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 667, "num_steps_trained": 33513728, "num_steps_sampled": 7285120, "sample_throughput": 4045.627, "train_throughput": 4045.627, "num_weight_syncs": 14228, "num_samples_dropped": 875, "learner_queue": {"size_count": 142526, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.263, "replay_time_ms": 99.048, "update_priorities_time_ms": 48.297, "policy_agent_0": {"added_count": 1828096, "sampled_count": 8348160, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1828096, "sampled_count": 8348160, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41356632113456726}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3795209527015686}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7285120, "episodes_total": 36440, "training_iteration": 195, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-16-20", "timestamp": 1564913780, "time_this_iter_s": 32.662362813949585, "time_total_s": 6077.620787382126, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17760d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1697048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16970d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c0950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6077.620787382126, "timesteps_since_restore": 7285120, "iterations_since_restore": 195, "num_healthy_workers": 4}
{"episode_reward_max": 55.861185653493976, "episode_reward_min": 51.43447732025028, "episode_reward_mean": 53.02352107619676, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.48866780114381, "agent_1": 27.534853275052942}, "custom_metrics": {"delta0_mean": 0.46170810176571436, "delta0_min": 0.4238495784564197, "delta0_max": 0.48410251047864344, "delta1_mean": 0.3902841010360665, "delta1_min": 0.36766508092279926, "delta1_max": 0.3988745433442983, "price0_mean": 1.6280843754393401, "price0_min": 1.6186285000940503, "price0_max": 1.6318470279533788, "price1_mean": 1.642699014005671, "price1_min": 1.6299384143491167, "price1_max": 1.6489902362298197}, "sampler_perf": {"mean_env_wait_ms": 1.1262999158689473, "mean_processing_ms": 19.248594686517325, "mean_inference_ms": 2.0607699146026524}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 671, "num_steps_trained": 33703168, "num_steps_sampled": 7310208, "sample_throughput": 8916.344, "train_throughput": 0.0, "num_weight_syncs": 14276, "num_samples_dropped": 875, "learner_queue": {"size_count": 143265, "size_mean": 0.28, "size_std": 0.44899888641287294, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.328, "replay_time_ms": 102.343, "update_priorities_time_ms": 50.003, "policy_agent_0": {"added_count": 1833344, "sampled_count": 8397568, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1833344, "sampled_count": 8397568, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4252921938896179}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3805934488773346}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7310208, "episodes_total": 36568, "training_iteration": 196, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-16-56", "timestamp": 1564913816, "time_this_iter_s": 34.093605518341064, "time_total_s": 6111.714392900467, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16da2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16da7b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16da268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16fc378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6111.714392900467, "timesteps_since_restore": 7310208, "iterations_since_restore": 196, "num_healthy_workers": 4}
{"episode_reward_max": 55.644723885504035, "episode_reward_min": 51.96868738045676, "episode_reward_mean": 53.64138280803743, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 26.080628442455215, "agent_1": 27.560754365582223}, "custom_metrics": {"delta0_mean": 0.4611073313888066, "delta0_min": 0.42345543502863836, "delta0_max": 0.48329054886373923, "delta1_mean": 0.39039082576958717, "delta1_min": 0.3678832614315579, "delta1_max": 0.39904512062231234, "price0_mean": 1.627992974005865, "price0_min": 1.6185841145118156, "price0_max": 1.6317243338859184, "price1_mean": 1.6424706669403895, "price1_min": 1.6297159543433086, "price1_max": 1.6487030786975962}, "sampler_perf": {"mean_env_wait_ms": 1.126486988764788, "mean_processing_ms": 19.302082703004583, "mean_inference_ms": 2.060285121848505}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 675, "num_steps_trained": 33888256, "num_steps_sampled": 7335296, "sample_throughput": 9676.662, "train_throughput": 0.0, "num_weight_syncs": 14325, "num_samples_dropped": 875, "learner_queue": {"size_count": 143989, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 21.604, "replay_time_ms": 88.928, "update_priorities_time_ms": 52.135, "policy_agent_0": {"added_count": 1840384, "sampled_count": 8443136, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1840384, "sampled_count": 8443136, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4308512210845947}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.380313903093338}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7335296, "episodes_total": 36696, "training_iteration": 197, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-17-29", "timestamp": 1564913849, "time_this_iter_s": 33.44645881652832, "time_total_s": 6145.160851716995, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1722620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fad1dc316a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fad1dc31730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16668c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6145.160851716995, "timesteps_since_restore": 7335296, "iterations_since_restore": 197, "num_healthy_workers": 4}
{"episode_reward_max": 55.644723885504035, "episode_reward_min": 52.2181635833859, "episode_reward_mean": 53.149085507497105, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 25.701676403718654, "agent_1": 27.447409103778448}, "custom_metrics": {"delta0_mean": 0.46087754962329475, "delta0_min": 0.4227859340110879, "delta0_max": 0.482442203894884, "delta1_mean": 0.3904837659012287, "delta1_min": 0.3679930057752586, "delta1_max": 0.3991458176762562, "price0_mean": 1.6279365790049805, "price0_min": 1.6185198887526564, "price0_max": 1.631602492967762, "price1_mean": 1.6423061599625453, "price1_min": 1.6294837222974912, "price1_max": 1.6484090138678233}, "sampler_perf": {"mean_env_wait_ms": 1.1264909897959907, "mean_processing_ms": 19.35531759732248, "mean_inference_ms": 2.0609867916354894}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 679, "num_steps_trained": 34080512, "num_steps_sampled": 7360384, "sample_throughput": 7055.828, "train_throughput": 0.0, "num_weight_syncs": 14374, "num_samples_dropped": 875, "learner_queue": {"size_count": 144740, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.313, "replay_time_ms": 100.495, "update_priorities_time_ms": 55.777, "policy_agent_0": {"added_count": 1847040, "sampled_count": 8491264, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1847040, "sampled_count": 8491264, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4251381754875183}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3729792535305023}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7360384, "episodes_total": 36816, "training_iteration": 198, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-18-03", "timestamp": 1564913883, "time_this_iter_s": 33.409114837646484, "time_total_s": 6178.569966554642, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1666c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16667b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd160c840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd167c378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6178.569966554642, "timesteps_since_restore": 7360384, "iterations_since_restore": 198, "num_healthy_workers": 4}
{"episode_reward_max": 59.81529338411937, "episode_reward_min": 52.21025392611101, "episode_reward_mean": 53.44521672703548, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 25.897787409197395, "agent_1": 27.54742931783808}, "custom_metrics": {"delta0_mean": 0.45935944932223133, "delta0_min": 0.4222575448928192, "delta0_max": 0.481821503971725, "delta1_mean": 0.39054255053455167, "delta1_min": 0.3681855749999411, "delta1_max": 0.39919042163177426, "price0_mean": 1.6277592969834003, "price0_min": 1.6184497417286614, "price0_max": 1.6314814963312199, "price1_mean": 1.6419076269682875, "price1_min": 1.6292835889014665, "price1_max": 1.6481676078844396}, "sampler_perf": {"mean_env_wait_ms": 1.126173081197335, "mean_processing_ms": 19.40788622677313, "mean_inference_ms": 2.058997311956027}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 682, "num_steps_trained": 34266624, "num_steps_sampled": 7385472, "sample_throughput": 3711.748, "train_throughput": 7423.496, "num_weight_syncs": 14424, "num_samples_dropped": 875, "learner_queue": {"size_count": 145466, "size_mean": 0.28, "size_std": 0.4915282290977803, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 13.978, "replay_time_ms": 90.58, "update_priorities_time_ms": 48.221, "policy_agent_0": {"added_count": 1852800, "sampled_count": 8536064, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1852800, "sampled_count": 8536064, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.42679867148399353}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3760054409503937}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7385472, "episodes_total": 36952, "training_iteration": 199, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-18-37", "timestamp": 1564913917, "time_this_iter_s": 33.86999797821045, "time_total_s": 6212.439964532852, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16da7b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16da268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16da2f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1602ae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6212.439964532852, "timesteps_since_restore": 7385472, "iterations_since_restore": 199, "num_healthy_workers": 4}
{"episode_reward_max": 66.87715582296921, "episode_reward_min": 52.45480164375593, "episode_reward_mean": 55.84221138129621, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 26.32705202617814, "agent_1": 29.51515935511806}, "custom_metrics": {"delta0_mean": 0.45969840179114463, "delta0_min": 0.42167302091114955, "delta0_max": 0.4809709822605857, "delta1_mean": 0.391230068205124, "delta1_min": 0.3693189319624105, "delta1_max": 0.4000340400030896, "price0_mean": 1.627922386669617, "price0_min": 1.6186689857024785, "price0_max": 1.631401071922974, "price1_mean": 1.6419453950656078, "price1_min": 1.62907129973004, "price1_max": 1.6478873398528708}, "sampler_perf": {"mean_env_wait_ms": 1.1259081715660775, "mean_processing_ms": 19.462450284972782, "mean_inference_ms": 2.060604656676875}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 686, "num_steps_trained": 34454784, "num_steps_sampled": 7410560, "sample_throughput": 6550.561, "train_throughput": 6550.561, "num_weight_syncs": 14473, "num_samples_dropped": 875, "learner_queue": {"size_count": 146202, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.744, "replay_time_ms": 73.814, "update_priorities_time_ms": 45.83, "policy_agent_0": {"added_count": 1859456, "sampled_count": 8582912, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1859456, "sampled_count": 8582912, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4228672385215759}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3701450824737549}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7410560, "episodes_total": 37072, "training_iteration": 200, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-19-11", "timestamp": 1564913951, "time_this_iter_s": 33.89871430397034, "time_total_s": 6246.3386788368225, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16021e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1602598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1602378>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15a4488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6246.3386788368225, "timesteps_since_restore": 7410560, "iterations_since_restore": 200, "num_healthy_workers": 4}
{"episode_reward_max": 62.97454884811104, "episode_reward_min": 52.48851700749678, "episode_reward_mean": 53.87759784156577, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 26.24227707585458, "agent_1": 27.635320765711192}, "custom_metrics": {"delta0_mean": 0.45873521167029874, "delta0_min": 0.42108417695106887, "delta0_max": 0.48039720038022654, "delta1_mean": 0.39134872226774253, "delta1_min": 0.36948229686117245, "delta1_max": 0.4001397203322826, "price0_mean": 1.627813411433412, "price0_min": 1.6186081424112155, "price0_max": 1.6313219234137704, "price1_mean": 1.6416690678800174, "price1_min": 1.6288581529286432, "price1_max": 1.6476701351889347}, "sampler_perf": {"mean_env_wait_ms": 1.1256653821099996, "mean_processing_ms": 19.515135263120666, "mean_inference_ms": 2.059998098442909}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 690, "num_steps_trained": 34647296, "num_steps_sampled": 7435648, "sample_throughput": 3071.3, "train_throughput": 3071.3, "num_weight_syncs": 14522, "num_samples_dropped": 875, "learner_queue": {"size_count": 146954, "size_mean": 0.48, "size_std": 0.699714227381436, "size_quantiles": [0.0, 0.0, 0.0, 2.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.445, "replay_time_ms": 98.012, "update_priorities_time_ms": 51.355, "policy_agent_0": {"added_count": 1866496, "sampled_count": 8630016, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1866496, "sampled_count": 8630016, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41682666540145874}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37253338098526}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7435648, "episodes_total": 37200, "training_iteration": 201, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-19-45", "timestamp": 1564913985, "time_this_iter_s": 34.09754681587219, "time_total_s": 6280.436225652695, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15a47b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15a4620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16020d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15d18c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6280.436225652695, "timesteps_since_restore": 7435648, "iterations_since_restore": 201, "num_healthy_workers": 4}
{"episode_reward_max": 65.93422552384904, "episode_reward_min": 51.77768408805299, "episode_reward_mean": 56.78362174345349, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.36808378792591, "agent_1": 29.41553795552758}, "custom_metrics": {"delta0_mean": 0.45854627025961364, "delta0_min": 0.4202957937416332, "delta0_max": 0.4800610692378663, "delta1_mean": 0.3920128849356357, "delta1_min": 0.37071645489452615, "delta1_max": 0.40112886438183426, "price0_mean": 1.6279407551434528, "price0_min": 1.6189495075567615, "price0_max": 1.6314451258111837, "price1_mean": 1.641634669417472, "price1_min": 1.6286033285594574, "price1_max": 1.6476016824496573}, "sampler_perf": {"mean_env_wait_ms": 1.125963730500812, "mean_processing_ms": 19.566847472217486, "mean_inference_ms": 2.059413784557904}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 694, "num_steps_trained": 34838528, "num_steps_sampled": 7460736, "sample_throughput": 7056.106, "train_throughput": 14112.213, "num_weight_syncs": 14570, "num_samples_dropped": 875, "learner_queue": {"size_count": 147700, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 13.89, "replay_time_ms": 71.006, "update_priorities_time_ms": 41.961, "policy_agent_0": {"added_count": 1872512, "sampled_count": 8678400, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1872512, "sampled_count": 8678400, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4117012023925781}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35899627208709717}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7460736, "episodes_total": 37328, "training_iteration": 202, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-20-19", "timestamp": 1564914019, "time_this_iter_s": 33.422086000442505, "time_total_s": 6313.858311653137, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15d1950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15d1bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15d1268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1597a60>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6313.858311653137, "timesteps_since_restore": 7460736, "iterations_since_restore": 202, "num_healthy_workers": 4}
{"episode_reward_max": 66.1156571235939, "episode_reward_min": 62.37133827729337, "episode_reward_mean": 64.08632808958683, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 30.06290573079331, "agent_1": 34.02342235879353}, "custom_metrics": {"delta0_mean": 0.4591774971903003, "delta0_min": 0.4211302397047466, "delta0_max": 0.48071156424937933, "delta1_mean": 0.39407062410531685, "delta1_min": 0.37314122940907724, "delta1_max": 0.40308765678239217, "price0_mean": 1.628525444656917, "price0_min": 1.6196511092901675, "price0_max": 1.632010454021448, "price1_mean": 1.6420128284535673, "price1_min": 1.6290032175281717, "price1_max": 1.6479738329422984}, "sampler_perf": {"mean_env_wait_ms": 1.1260919698873502, "mean_processing_ms": 19.623799608329684, "mean_inference_ms": 2.0590327324596984}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 697, "num_steps_trained": 35023616, "num_steps_sampled": 7485824, "sample_throughput": 13402.339, "train_throughput": 0.0, "num_weight_syncs": 14619, "num_samples_dropped": 875, "learner_queue": {"size_count": 148423, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.566, "replay_time_ms": 108.261, "update_priorities_time_ms": 52.797, "policy_agent_0": {"added_count": 1877888, "sampled_count": 8726016, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1877888, "sampled_count": 8726016, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41507798433303833}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3449610769748688}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7485824, "episodes_total": 37456, "training_iteration": 203, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-20-54", "timestamp": 1564914054, "time_this_iter_s": 33.87142467498779, "time_total_s": 6347.729736328125, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1597b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1597ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1597bf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11d99d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6347.729736328125, "timesteps_since_restore": 7485824, "iterations_since_restore": 203, "num_healthy_workers": 4}
{"episode_reward_max": 65.93519982784922, "episode_reward_min": 61.03447793295928, "episode_reward_mean": 63.29028761472078, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.67049948858667, "agent_1": 35.61978812613411}, "custom_metrics": {"delta0_mean": 0.45908113954850094, "delta0_min": 0.42117951527814074, "delta0_max": 0.4806413761863548, "delta1_mean": 0.39659611108710047, "delta1_min": 0.37573343607294335, "delta1_max": 0.4056522011022932, "price0_mean": 1.6291550120241807, "price0_min": 1.6202977198372932, "price0_max": 1.6326393303056395, "price1_mean": 1.6422738490222673, "price1_min": 1.6293147914573587, "price1_max": 1.648243926098122}, "sampler_perf": {"mean_env_wait_ms": 1.125978015700982, "mean_processing_ms": 19.67619981744412, "mean_inference_ms": 2.059291452366811}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 701, "num_steps_trained": 35216384, "num_steps_sampled": 7510912, "sample_throughput": 4710.882, "train_throughput": 9421.763, "num_weight_syncs": 14669, "num_samples_dropped": 875, "learner_queue": {"size_count": 149176, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.866, "replay_time_ms": 91.896, "update_priorities_time_ms": 52.551, "policy_agent_0": {"added_count": 1883904, "sampled_count": 8773888, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1883904, "sampled_count": 8773888, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39596349000930786}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3272515535354614}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7510912, "episodes_total": 37584, "training_iteration": 204, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-21-28", "timestamp": 1564914088, "time_this_iter_s": 34.40353727340698, "time_total_s": 6382.133273601532, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15d1950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15d1bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15d18c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11dd730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6382.133273601532, "timesteps_since_restore": 7510912, "iterations_since_restore": 204, "num_healthy_workers": 4}
{"episode_reward_max": 64.30897280309128, "episode_reward_min": 59.87038379149402, "episode_reward_mean": 62.05289487694664, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 26.491007183488495, "agent_1": 35.561887693458175}, "custom_metrics": {"delta0_mean": 0.4586305515798599, "delta0_min": 0.42086906842707444, "delta0_max": 0.4800921793727712, "delta1_mean": 0.39908701111466083, "delta1_min": 0.37825165238014047, "delta1_max": 0.4081223777600123, "price0_mean": 1.6297294843961634, "price0_min": 1.620915384122787, "price0_max": 1.6332277879667991, "price1_mean": 1.642424902030522, "price1_min": 1.6295068851797405, "price1_max": 1.6483878807260046}, "sampler_perf": {"mean_env_wait_ms": 1.1259027765754503, "mean_processing_ms": 19.72806631662357, "mean_inference_ms": 2.0590394425465686}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 705, "num_steps_trained": 35402240, "num_steps_sampled": 7536000, "sample_throughput": 16695.305, "train_throughput": 33390.609, "num_weight_syncs": 14717, "num_samples_dropped": 875, "learner_queue": {"size_count": 149902, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.469, "replay_time_ms": 94.546, "update_priorities_time_ms": 51.081, "policy_agent_0": {"added_count": 1889920, "sampled_count": 8820480, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1889920, "sampled_count": 8820480, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36475056409835815}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30149954557418823}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7536000, "episodes_total": 37712, "training_iteration": 205, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-22-02", "timestamp": 1564914122, "time_this_iter_s": 33.68341612815857, "time_total_s": 6415.816689729691, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11dd9d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11dda60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11ddae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11ded08>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6415.816689729691, "timesteps_since_restore": 7536000, "iterations_since_restore": 205, "num_healthy_workers": 4}
{"episode_reward_max": 63.05727719949986, "episode_reward_min": 59.99887550207579, "episode_reward_mean": 61.61950768491933, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 26.564068512722535, "agent_1": 35.055439172196806}, "custom_metrics": {"delta0_mean": 0.45782876462259003, "delta0_min": 0.4206699210842488, "delta0_max": 0.47961814310778983, "delta1_mean": 0.401299560210573, "delta1_min": 0.3806485932889096, "delta1_max": 0.4104466600680285, "price0_mean": 1.630200058981878, "price0_min": 1.6214674642298024, "price0_max": 1.633687428550958, "price1_mean": 1.6424797208934558, "price1_min": 1.6296661189898203, "price1_max": 1.648477392657233}, "sampler_perf": {"mean_env_wait_ms": 1.1256504548343582, "mean_processing_ms": 19.77664185810324, "mean_inference_ms": 2.0577669682089845}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 709, "num_steps_trained": 35588864, "num_steps_sampled": 7561088, "sample_throughput": 11823.788, "train_throughput": 0.0, "num_weight_syncs": 14766, "num_samples_dropped": 875, "learner_queue": {"size_count": 150632, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.193, "replay_time_ms": 97.088, "update_priorities_time_ms": 43.201, "policy_agent_0": {"added_count": 1896576, "sampled_count": 8866048, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1896576, "sampled_count": 8866048, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36281073093414307}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2911410629749298}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7561088, "episodes_total": 37832, "training_iteration": 206, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-22-35", "timestamp": 1564914155, "time_this_iter_s": 33.276877880096436, "time_total_s": 6449.093567609787, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15d1268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15d1950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15a47b8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11f3a60>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6449.093567609787, "timesteps_since_restore": 7561088, "iterations_since_restore": 206, "num_healthy_workers": 4}
{"episode_reward_max": 62.683986503577906, "episode_reward_min": 60.59689058533616, "episode_reward_mean": 61.62284356085624, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.336932567264135, "agent_1": 34.28591099359211}, "custom_metrics": {"delta0_mean": 0.4580378812238556, "delta0_min": 0.42063956897377425, "delta0_max": 0.4793877124278097, "delta1_mean": 0.40334359721900187, "delta1_min": 0.3827972837999892, "delta1_max": 0.4124989327728744, "price0_mean": 1.6306866001097928, "price0_min": 1.6219615042248559, "price0_max": 1.6341346085440196, "price1_mean": 1.6426714529511255, "price1_min": 1.6298539398021088, "price1_max": 1.6485929012340799}, "sampler_perf": {"mean_env_wait_ms": 1.1255534989288087, "mean_processing_ms": 19.8319725022477, "mean_inference_ms": 2.0582499842479014}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 712, "num_steps_trained": 35768832, "num_steps_sampled": 7586176, "sample_throughput": 4504.026, "train_throughput": 0.0, "num_weight_syncs": 14816, "num_samples_dropped": 875, "learner_queue": {"size_count": 151335, "size_mean": 0.12, "size_std": 0.38157568056677826, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.456, "replay_time_ms": 98.072, "update_priorities_time_ms": 54.203, "policy_agent_0": {"added_count": 1903360, "sampled_count": 8911616, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1903360, "sampled_count": 8911616, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3551974594593048}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27242138981819153}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7586176, "episodes_total": 37960, "training_iteration": 207, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-23-10", "timestamp": 1564914190, "time_this_iter_s": 33.50545048713684, "time_total_s": 6482.599018096924, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11f3ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11f3b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11f3e18>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd117f0d0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6482.599018096924, "timesteps_since_restore": 7586176, "iterations_since_restore": 207, "num_healthy_workers": 4}
{"episode_reward_max": 62.98710334948709, "episode_reward_min": 58.80657580677945, "episode_reward_mean": 61.5236685163661, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 27.13290127874126, "agent_1": 34.390767237624836}, "custom_metrics": {"delta0_mean": 0.4573940535981226, "delta0_min": 0.4206982664700537, "delta0_max": 0.479211656692326, "delta1_mean": 0.405352751693234, "delta1_min": 0.3849165255648585, "delta1_max": 0.41457497316279923, "price0_mean": 1.631107476025878, "price0_min": 1.6224532538187575, "price0_max": 1.6345202334032853, "price1_mean": 1.6427269681137269, "price1_min": 1.6300543362181117, "price1_max": 1.6486954977792758}, "sampler_perf": {"mean_env_wait_ms": 1.1253750784500967, "mean_processing_ms": 19.88369850693987, "mean_inference_ms": 2.057566048773553}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 716, "num_steps_trained": 35960832, "num_steps_sampled": 7611264, "sample_throughput": 5512.871, "train_throughput": 0.0, "num_weight_syncs": 14864, "num_samples_dropped": 875, "learner_queue": {"size_count": 152085, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 13.209, "replay_time_ms": 83.885, "update_priorities_time_ms": 42.449, "policy_agent_0": {"added_count": 1910016, "sampled_count": 8958720, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1910016, "sampled_count": 8958720, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3552485704421997}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2739787697792053}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7611264, "episodes_total": 38080, "training_iteration": 208, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-23-44", "timestamp": 1564914224, "time_this_iter_s": 34.498011112213135, "time_total_s": 6517.097029209137, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11de620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11de6a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11deb70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11ddf28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6517.097029209137, "timesteps_since_restore": 7611264, "iterations_since_restore": 208, "num_healthy_workers": 4}
{"episode_reward_max": 62.32322521612966, "episode_reward_min": 59.330465890791416, "episode_reward_mean": 61.00670461703571, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.246734177931657, "agent_1": 33.759970439104066}, "custom_metrics": {"delta0_mean": 0.4575847195971504, "delta0_min": 0.42061787103313336, "delta0_max": 0.4787539815793875, "delta1_mean": 0.40720322355459115, "delta1_min": 0.3868460228493662, "delta1_max": 0.4163968817308577, "price0_mean": 1.6315410485039563, "price0_min": 1.622889121369835, "price0_max": 1.6349152589497427, "price1_mean": 1.6428849220138102, "price1_min": 1.6301989605000085, "price1_max": 1.6487339695502952}, "sampler_perf": {"mean_env_wait_ms": 1.1253552436457555, "mean_processing_ms": 19.943168647500176, "mean_inference_ms": 2.0576892789624006}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 720, "num_steps_trained": 36153344, "num_steps_sampled": 7636352, "sample_throughput": 8014.434, "train_throughput": 0.0, "num_weight_syncs": 14913, "num_samples_dropped": 875, "learner_queue": {"size_count": 152836, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.875, "replay_time_ms": 100.749, "update_priorities_time_ms": 52.364, "policy_agent_0": {"added_count": 1917184, "sampled_count": 9006592, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1917184, "sampled_count": 9006592, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3486185371875763}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2633078098297119}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7636352, "episodes_total": 38208, "training_iteration": 209, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-24-20", "timestamp": 1564914260, "time_this_iter_s": 35.27768635749817, "time_total_s": 6552.374715566635, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11dd1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11dd158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11dd620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15a1730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6552.374715566635, "timesteps_since_restore": 7636352, "iterations_since_restore": 209, "num_healthy_workers": 4}
{"episode_reward_max": 62.53532621220606, "episode_reward_min": 58.41865833296142, "episode_reward_mean": 60.606154465963016, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.57511323172509, "agent_1": 33.031041234237925}, "custom_metrics": {"delta0_mean": 0.4574667334491987, "delta0_min": 0.42057704789625816, "delta0_max": 0.47855177869205967, "delta1_mean": 0.4088689499659012, "delta1_min": 0.38859255660962966, "delta1_max": 0.4180477455416877, "price0_mean": 1.631903737132688, "price0_min": 1.6232881260794698, "price0_max": 1.6352643507360094, "price1_mean": 1.6429744376742081, "price1_min": 1.6303191771315673, "price1_max": 1.6487998133684723}, "sampler_perf": {"mean_env_wait_ms": 1.1251741731693379, "mean_processing_ms": 19.994595769111122, "mean_inference_ms": 2.057487553625588}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 724, "num_steps_trained": 36342528, "num_steps_sampled": 7661440, "sample_throughput": 2954.662, "train_throughput": 5909.324, "num_weight_syncs": 14963, "num_samples_dropped": 875, "learner_queue": {"size_count": 153575, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 22.947, "replay_time_ms": 101.992, "update_priorities_time_ms": 55.508, "policy_agent_0": {"added_count": 1924864, "sampled_count": 9051904, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1924864, "sampled_count": 9051904, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34446877241134644}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.24221834540367126}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7661440, "episodes_total": 38336, "training_iteration": 210, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-24-54", "timestamp": 1564914294, "time_this_iter_s": 34.441384077072144, "time_total_s": 6586.816099643707, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11deb70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11de6a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11de620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1590ea0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6586.816099643707, "timesteps_since_restore": 7661440, "iterations_since_restore": 210, "num_healthy_workers": 4}
{"episode_reward_max": 61.337751943676736, "episode_reward_min": 58.84414956088555, "episode_reward_mean": 59.954140508834925, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 27.44684545774596, "agent_1": 32.507295051088946}, "custom_metrics": {"delta0_mean": 0.45692610185679616, "delta0_min": 0.4204885114632301, "delta0_max": 0.4783134980053019, "delta1_mean": 0.4103236334665437, "delta1_min": 0.3901413435182743, "delta1_max": 0.41952109042273944, "price0_mean": 1.6321764670868084, "price0_min": 1.6236237834964824, "price0_max": 1.6355347725056306, "price1_mean": 1.6429658673086713, "price1_min": 1.6303791050255827, "price1_max": 1.648824147211606}, "sampler_perf": {"mean_env_wait_ms": 1.1256686467519688, "mean_processing_ms": 20.042822254767106, "mean_inference_ms": 2.0565642566061277}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 728, "num_steps_trained": 36531968, "num_steps_sampled": 7686528, "sample_throughput": 11331.65, "train_throughput": 0.0, "num_weight_syncs": 15011, "num_samples_dropped": 875, "learner_queue": {"size_count": 154316, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.364, "replay_time_ms": 110.586, "update_priorities_time_ms": 57.172, "policy_agent_0": {"added_count": 1931136, "sampled_count": 9099776, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1931136, "sampled_count": 9099776, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34612196683883667}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.24494315683841705}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7686528, "episodes_total": 38456, "training_iteration": 211, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-25-28", "timestamp": 1564914328, "time_this_iter_s": 33.78849649429321, "time_total_s": 6620.6045961380005, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1590c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1590a60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1590f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1602ae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6620.6045961380005, "timesteps_since_restore": 7686528, "iterations_since_restore": 211, "num_healthy_workers": 4}
{"episode_reward_max": 61.97294182465671, "episode_reward_min": 53.97283066423581, "episode_reward_mean": 58.98796636655541, "episode_len_mean": 100.0, "episodes_this_iter": 136, "policy_reward_mean": {"agent_0": 27.47408705233997, "agent_1": 31.513879314215448}, "custom_metrics": {"delta0_mean": 0.4575164768027567, "delta0_min": 0.42056373532635377, "delta0_max": 0.47803466308911996, "delta1_mean": 0.4115112416267237, "delta1_min": 0.39138782863482846, "delta1_max": 0.4207048200709627, "price0_mean": 1.632460993030697, "price0_min": 1.6238824091850013, "price0_max": 1.6357756480945744, "price1_mean": 1.643097360191496, "price1_min": 1.6304837179555975, "price1_max": 1.6488140035840788}, "sampler_perf": {"mean_env_wait_ms": 1.1254491660556287, "mean_processing_ms": 20.101429534638623, "mean_inference_ms": 2.058314581397778}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 731, "num_steps_trained": 36728576, "num_steps_sampled": 7711616, "sample_throughput": 4922.666, "train_throughput": 9845.333, "num_weight_syncs": 15061, "num_samples_dropped": 875, "learner_queue": {"size_count": 155084, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.434, "replay_time_ms": 84.705, "update_priorities_time_ms": 40.653, "policy_agent_0": {"added_count": 1937920, "sampled_count": 9147136, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1937920, "sampled_count": 9147136, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35009148716926575}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.25003689527511597}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7711616, "episodes_total": 38592, "training_iteration": 212, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-26-04", "timestamp": 1564914364, "time_this_iter_s": 35.59695792198181, "time_total_s": 6656.201554059982, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15a1158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15a1730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15a1048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd167ce18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6656.201554059982, "timesteps_since_restore": 7711616, "iterations_since_restore": 212, "num_healthy_workers": 4}
{"episode_reward_max": 61.71216510786914, "episode_reward_min": 52.45258585351171, "episode_reward_mean": 56.66775551904032, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 26.971163683071666, "agent_1": 29.696591835968654}, "custom_metrics": {"delta0_mean": 0.4572865237046926, "delta0_min": 0.42045530712303786, "delta0_max": 0.47761309051993517, "delta1_mean": 0.4121273133486894, "delta1_min": 0.39196997549995727, "delta1_max": 0.42132396960645074, "price0_mean": 1.6325464751277987, "price0_min": 1.6239694322027596, "price0_max": 1.6358223710642474, "price1_mean": 1.6430293252604407, "price1_min": 1.6304702049469617, "price1_max": 1.648688716535897}, "sampler_perf": {"mean_env_wait_ms": 1.1255724620149217, "mean_processing_ms": 20.154231652557932, "mean_inference_ms": 2.058039315355271}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 735, "num_steps_trained": 36926464, "num_steps_sampled": 7736704, "sample_throughput": 7911.799, "train_throughput": 15823.597, "num_weight_syncs": 15110, "num_samples_dropped": 875, "learner_queue": {"size_count": 155856, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.735, "replay_time_ms": 107.169, "update_priorities_time_ms": 49.887, "policy_agent_0": {"added_count": 1945856, "sampled_count": 9194240, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1945856, "sampled_count": 9194240, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3601405918598175}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.253665566444397}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7736704, "episodes_total": 38712, "training_iteration": 213, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-26-39", "timestamp": 1564914399, "time_this_iter_s": 34.1262891292572, "time_total_s": 6690.3278431892395, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd167c158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd167c488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd167c2f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1666e18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6690.3278431892395, "timesteps_since_restore": 7736704, "iterations_since_restore": 213, "num_healthy_workers": 4}
{"episode_reward_max": 67.12979698798597, "episode_reward_min": 58.011971733912716, "episode_reward_mean": 60.95758751196185, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.305354335580226, "agent_1": 32.65223317638161}, "custom_metrics": {"delta0_mean": 0.45699060181888174, "delta0_min": 0.42065993705834426, "delta0_max": 0.47761776772342907, "delta1_mean": 0.4136813417358785, "delta1_min": 0.39365188116600036, "delta1_max": 0.4229155470154905, "price0_mean": 1.6328993398637792, "price0_min": 1.6244155209024056, "price0_max": 1.6360981384373159, "price1_mean": 1.6431292516651412, "price1_min": 1.6306032969837372, "price1_max": 1.6487608869169266}, "sampler_perf": {"mean_env_wait_ms": 1.1253437075723336, "mean_processing_ms": 20.209261454866986, "mean_inference_ms": 2.0574774432427203}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 739, "num_steps_trained": 37131264, "num_steps_sampled": 7761792, "sample_throughput": 4489.0, "train_throughput": 0.0, "num_weight_syncs": 15158, "num_samples_dropped": 875, "learner_queue": {"size_count": 156656, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 13.981, "replay_time_ms": 94.021, "update_priorities_time_ms": 43.769, "policy_agent_0": {"added_count": 1951744, "sampled_count": 9248256, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1951744, "sampled_count": 9248256, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3541259765625}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.25841856002807617}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7761792, "episodes_total": 38840, "training_iteration": 214, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-27-15", "timestamp": 1564914435, "time_this_iter_s": 36.52810335159302, "time_total_s": 6726.8559465408325, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1602ae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1590f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1590a60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16fc2f0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6726.8559465408325, "timesteps_since_restore": 7761792, "iterations_since_restore": 214, "num_healthy_workers": 4}
{"episode_reward_max": 67.13771490837365, "episode_reward_min": 56.52296350496262, "episode_reward_mean": 62.584547572388104, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.7016936130744, "agent_1": 32.882853959313714}, "custom_metrics": {"delta0_mean": 0.4574962128555295, "delta0_min": 0.42123020347459544, "delta0_max": 0.47804223381875344, "delta1_mean": 0.41525661510361594, "delta1_min": 0.39616562474068734, "delta1_max": 0.4249301374175885, "price0_mean": 1.6334959083887661, "price0_min": 1.6252177946009463, "price0_max": 1.6364909104052323, "price1_mean": 1.6435705284452546, "price1_min": 1.6308506561574696, "price1_max": 1.6489582603421034}, "sampler_perf": {"mean_env_wait_ms": 1.1255172774376885, "mean_processing_ms": 20.265048481764765, "mean_inference_ms": 2.056829211932629}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 743, "num_steps_trained": 37323008, "num_steps_sampled": 7786880, "sample_throughput": 11273.59, "train_throughput": 0.0, "num_weight_syncs": 15208, "num_samples_dropped": 875, "learner_queue": {"size_count": 157405, "size_mean": 0.22, "size_std": 0.4142463035441596, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.96, "replay_time_ms": 83.068, "update_priorities_time_ms": 42.346, "policy_agent_0": {"added_count": 1958528, "sampled_count": 9293056, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1958528, "sampled_count": 9293056, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35977664589881897}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.26032209396362305}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7786880, "episodes_total": 38968, "training_iteration": 215, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-27-50", "timestamp": 1564914470, "time_this_iter_s": 34.68180012702942, "time_total_s": 6761.537746667862, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16f3d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16f3268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16f3158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c0620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6761.537746667862, "timesteps_since_restore": 7786880, "iterations_since_restore": 215, "num_healthy_workers": 4}
{"episode_reward_max": 67.31930144712794, "episode_reward_min": 57.48096255751449, "episode_reward_mean": 61.836452646133246, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 29.64063728672887, "agent_1": 32.19581535940437}, "custom_metrics": {"delta0_mean": 0.4583299842043224, "delta0_min": 0.42170192655192, "delta0_max": 0.47834894440149905, "delta1_mean": 0.4164337548498877, "delta1_min": 0.3980161653458759, "delta1_max": 0.42682540200790203, "price0_mean": 1.633883643536762, "price0_min": 1.625485585021142, "price0_max": 1.637436290650417, "price1_mean": 1.6438778152719924, "price1_min": 1.6310166916593158, "price1_max": 1.6490733103387318}, "sampler_perf": {"mean_env_wait_ms": 1.1256879658487597, "mean_processing_ms": 20.320219073589847, "mean_inference_ms": 2.057392422078123}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 747, "num_steps_trained": 37521408, "num_steps_sampled": 7811968, "sample_throughput": 14258.762, "train_throughput": 0.0, "num_weight_syncs": 15256, "num_samples_dropped": 875, "learner_queue": {"size_count": 158181, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.706, "replay_time_ms": 67.187, "update_priorities_time_ms": 47.125, "policy_agent_0": {"added_count": 1964544, "sampled_count": 9344768, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1964544, "sampled_count": 9344768, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3554515540599823}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.26927971839904785}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7811968, "episodes_total": 39088, "training_iteration": 216, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-28-26", "timestamp": 1564914506, "time_this_iter_s": 35.55779004096985, "time_total_s": 6797.095536708832, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1666e18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16fcd90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd167c2f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1722bf8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6797.095536708832, "timesteps_since_restore": 7811968, "iterations_since_restore": 216, "num_healthy_workers": 4}
{"episode_reward_max": 61.959671778366015, "episode_reward_min": 57.76653514757069, "episode_reward_mean": 59.73554287180222, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.472007540323794, "agent_1": 31.263535331478423}, "custom_metrics": {"delta0_mean": 0.4580923385780191, "delta0_min": 0.42191700915531266, "delta0_max": 0.4784053257499618, "delta1_mean": 0.41762363109015244, "delta1_min": 0.399136342227191, "delta1_max": 0.42785364353782224, "price0_mean": 1.6341279317414201, "price0_min": 1.6257364789158346, "price0_max": 1.6376463929346983, "price1_mean": 1.643923115964423, "price1_min": 1.6311196352154316, "price1_max": 1.6491222025881678}, "sampler_perf": {"mean_env_wait_ms": 1.1255719077084079, "mean_processing_ms": 20.375619238726884, "mean_inference_ms": 2.0561562585455686}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 751, "num_steps_trained": 37730816, "num_steps_sampled": 7837056, "sample_throughput": 4322.771, "train_throughput": 8645.543, "num_weight_syncs": 15306, "num_samples_dropped": 875, "learner_queue": {"size_count": 158998, "size_mean": 0.2, "size_std": 0.447213595499958, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.743, "replay_time_ms": 115.525, "update_priorities_time_ms": 56.649, "policy_agent_0": {"added_count": 1969664, "sampled_count": 9395968, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1969664, "sampled_count": 9395968, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34080183506011963}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27146676182746887}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7837056, "episodes_total": 39216, "training_iteration": 217, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-29-02", "timestamp": 1564914542, "time_this_iter_s": 36.26750326156616, "time_total_s": 6833.363039970398, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17222f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1722730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1722158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd170c598>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6833.363039970398, "timesteps_since_restore": 7837056, "iterations_since_restore": 217, "num_healthy_workers": 4}
{"episode_reward_max": 62.07125969561395, "episode_reward_min": 57.67055175262533, "episode_reward_mean": 60.04160462501929, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.747889784146984, "agent_1": 31.293714840872305}, "custom_metrics": {"delta0_mean": 0.45831337206734346, "delta0_min": 0.42228020258493515, "delta0_max": 0.47858361943709715, "delta1_mean": 0.4187127850032324, "delta1_min": 0.40025935582553135, "delta1_max": 0.4288939879531667, "price0_mean": 1.6343649870483477, "price0_min": 1.6260093580279766, "price0_max": 1.6378619628681867, "price1_mean": 1.6440182219367976, "price1_min": 1.6312662571776853, "price1_max": 1.6492109232348588}, "sampler_perf": {"mean_env_wait_ms": 1.1257822702311435, "mean_processing_ms": 20.429590733280364, "mean_inference_ms": 2.0553449475486643}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 755, "num_steps_trained": 37922048, "num_steps_sampled": 7862144, "sample_throughput": 11425.703, "train_throughput": 0.0, "num_weight_syncs": 15355, "num_samples_dropped": 875, "learner_queue": {"size_count": 159745, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.661, "replay_time_ms": 100.294, "update_priorities_time_ms": 54.058, "policy_agent_0": {"added_count": 1975424, "sampled_count": 9444096, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1975424, "sampled_count": 9444096, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3382459878921509}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27147626876831055}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7862144, "episodes_total": 39344, "training_iteration": 218, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-29-37", "timestamp": 1564914577, "time_this_iter_s": 34.462196350097656, "time_total_s": 6867.825236320496, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16f3d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16f3268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16f3f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176ed08>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6867.825236320496, "timesteps_since_restore": 7862144, "iterations_since_restore": 218, "num_healthy_workers": 4}
{"episode_reward_max": 61.579967221028966, "episode_reward_min": 59.06964381107268, "episode_reward_mean": 60.34655370395741, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 29.612784864756513, "agent_1": 30.73376883920089}, "custom_metrics": {"delta0_mean": 0.45837637804732745, "delta0_min": 0.42282584819336566, "delta0_max": 0.4789488549547865, "delta1_mean": 0.41968021409654377, "delta1_min": 0.4012442937228599, "delta1_max": 0.42983311513649736, "price0_mean": 1.6345841398391812, "price0_min": 1.6262186310071736, "price0_max": 1.6380816686684996, "price1_mean": 1.6441184522060723, "price1_min": 1.6314264125677713, "price1_max": 1.6493154681043467}, "sampler_perf": {"mean_env_wait_ms": 1.1256408632549963, "mean_processing_ms": 20.481942897564572, "mean_inference_ms": 2.0545750339552145}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 759, "num_steps_trained": 38121984, "num_steps_sampled": 7887232, "sample_throughput": 14874.243, "train_throughput": 0.0, "num_weight_syncs": 15403, "num_samples_dropped": 875, "learner_queue": {"size_count": 160526, "size_mean": 0.28, "size_std": 0.4915282290977803, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 22.295, "replay_time_ms": 85.953, "update_priorities_time_ms": 40.912, "policy_agent_0": {"added_count": 1981440, "sampled_count": 9492736, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1981440, "sampled_count": 9492736, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3418341875076294}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2772049903869629}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7887232, "episodes_total": 39464, "training_iteration": 219, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-30-14", "timestamp": 1564914614, "time_this_iter_s": 35.35074853897095, "time_total_s": 6903.175984859467, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176eea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176ee18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176ebf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd175d7b8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6903.175984859467, "timesteps_since_restore": 7887232, "iterations_since_restore": 219, "num_healthy_workers": 4}
{"episode_reward_max": 63.712556599690316, "episode_reward_min": 58.89681185971252, "episode_reward_mean": 61.218756373712395, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.728497287373628, "agent_1": 31.490259086338778}, "custom_metrics": {"delta0_mean": 0.4592526000040028, "delta0_min": 0.4234452657269082, "delta0_max": 0.4793732759666566, "delta1_mean": 0.42070625838816134, "delta1_min": 0.4024623661081543, "delta1_max": 0.4309757518904951, "price0_mean": 1.6348503957280234, "price0_min": 1.6265167130614873, "price0_max": 1.6383613412168032, "price1_mean": 1.6443243554875988, "price1_min": 1.6316396744935349, "price1_max": 1.6494700468571266}, "sampler_perf": {"mean_env_wait_ms": 1.125457953374247, "mean_processing_ms": 20.541799163964157, "mean_inference_ms": 2.0550439302038046}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 763, "num_steps_trained": 38329088, "num_steps_sampled": 7912320, "sample_throughput": 9083.034, "train_throughput": 0.0, "num_weight_syncs": 15452, "num_samples_dropped": 875, "learner_queue": {"size_count": 161337, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.742, "replay_time_ms": 88.001, "update_priorities_time_ms": 48.355, "policy_agent_0": {"added_count": 1988096, "sampled_count": 9544192, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1988096, "sampled_count": 9544192, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3427433669567108}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27641111612319946}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7912320, "episodes_total": 39592, "training_iteration": 220, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-30-50", "timestamp": 1564914650, "time_this_iter_s": 36.22062349319458, "time_total_s": 6939.396608352661, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16f3d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16f3268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16f3158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1632400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6939.396608352661, "timesteps_since_restore": 7912320, "iterations_since_restore": 220, "num_healthy_workers": 4}
{"episode_reward_max": 64.35702120504563, "episode_reward_min": 58.273404144631336, "episode_reward_mean": 61.60797078669648, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 30.06456457862334, "agent_1": 31.54340620807313}, "custom_metrics": {"delta0_mean": 0.4598439883223998, "delta0_min": 0.424142908455179, "delta0_max": 0.47993735866029547, "delta1_mean": 0.42184563380361545, "delta1_min": 0.40363740227515416, "delta1_max": 0.4320656696224349, "price0_mean": 1.6351552667954912, "price0_min": 1.626854406811415, "price0_max": 1.6386445014694866, "price1_mean": 1.6445361219830508, "price1_min": 1.6318926463581935, "price1_max": 1.6496795117351966}, "sampler_perf": {"mean_env_wait_ms": 1.1257882173275717, "mean_processing_ms": 20.593707452715584, "mean_inference_ms": 2.054335448192177}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 767, "num_steps_trained": 38531328, "num_steps_sampled": 7937408, "sample_throughput": 17893.908, "train_throughput": 35787.815, "num_weight_syncs": 15502, "num_samples_dropped": 875, "learner_queue": {"size_count": 162125, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.672, "replay_time_ms": 100.046, "update_priorities_time_ms": 48.378, "policy_agent_0": {"added_count": 1993088, "sampled_count": 9595136, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1993088, "sampled_count": 9595136, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34607455134391785}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2735241949558258}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7937408, "episodes_total": 39720, "training_iteration": 221, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-31-25", "timestamp": 1564914685, "time_this_iter_s": 35.243332862854004, "time_total_s": 6974.639941215515, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1650510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1650048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1650f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd161dd90>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 6974.639941215515, "timesteps_since_restore": 7937408, "iterations_since_restore": 221, "num_healthy_workers": 4}
{"episode_reward_max": 63.087277682373546, "episode_reward_min": 54.613333284672706, "episode_reward_mean": 59.28158410801771, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.02821962392022, "agent_1": 31.253364484097478}, "custom_metrics": {"delta0_mean": 0.4598514054070604, "delta0_min": 0.42428957462563116, "delta0_max": 0.47970575893487527, "delta1_mean": 0.42289524942417844, "delta1_min": 0.40471515554510434, "delta1_max": 0.4331295679019159, "price0_mean": 1.6353877430884984, "price0_min": 1.6271066290270924, "price0_max": 1.6388945860250963, "price1_mean": 1.6445853703486695, "price1_min": 1.631984190073534, "price1_max": 1.6496607749253518}, "sampler_perf": {"mean_env_wait_ms": 1.1259682848350423, "mean_processing_ms": 20.64244084908774, "mean_inference_ms": 2.0549641126030815}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 771, "num_steps_trained": 38717696, "num_steps_sampled": 7962496, "sample_throughput": 5323.037, "train_throughput": 0.0, "num_weight_syncs": 15551, "num_samples_dropped": 875, "learner_queue": {"size_count": 162853, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.123, "replay_time_ms": 81.622, "update_priorities_time_ms": 42.059, "policy_agent_0": {"added_count": 1999616, "sampled_count": 9641728, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 1999616, "sampled_count": 9641728, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3461133539676666}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27695587277412415}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7962496, "episodes_total": 39848, "training_iteration": 222, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-32-01", "timestamp": 1564914721, "time_this_iter_s": 34.649388551712036, "time_total_s": 7009.289329767227, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16f3f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16f3d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176ebf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd162e620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7009.289329767227, "timesteps_since_restore": 7962496, "iterations_since_restore": 222, "num_healthy_workers": 4}
{"episode_reward_max": 65.49785851055437, "episode_reward_min": 55.5367896635655, "episode_reward_mean": 60.9654381433364, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.69866474943256, "agent_1": 32.26677339390385}, "custom_metrics": {"delta0_mean": 0.4600504187191629, "delta0_min": 0.4246778513835872, "delta0_max": 0.4797879424941594, "delta1_mean": 0.42422517796899073, "delta1_min": 0.4061127964614411, "delta1_max": 0.4344075248753933, "price0_mean": 1.6357226010419663, "price0_min": 1.627480669925761, "price0_max": 1.6392000646318443, "price1_mean": 1.6447351864353834, "price1_min": 1.6321968067831993, "price1_max": 1.6497715697320068}, "sampler_perf": {"mean_env_wait_ms": 1.126079616227496, "mean_processing_ms": 20.696687589085418, "mean_inference_ms": 2.054789379166905}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 775, "num_steps_trained": 38916608, "num_steps_sampled": 7987584, "sample_throughput": 4419.709, "train_throughput": 0.0, "num_weight_syncs": 15600, "num_samples_dropped": 875, "learner_queue": {"size_count": 163631, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 22.885, "replay_time_ms": 102.346, "update_priorities_time_ms": 52.182, "policy_agent_0": {"added_count": 2006144, "sampled_count": 9692928, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2006144, "sampled_count": 9692928, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3426828384399414}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2854921221733093}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 7987584, "episodes_total": 39976, "training_iteration": 223, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-32-38", "timestamp": 1564914758, "time_this_iter_s": 36.372920989990234, "time_total_s": 7045.662250757217, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15deb70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15ded90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15dee18>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11c41e0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7045.662250757217, "timesteps_since_restore": 7987584, "iterations_since_restore": 223, "num_healthy_workers": 4}
{"episode_reward_max": 67.48435656048959, "episode_reward_min": 58.00940403435666, "episode_reward_mean": 64.52908210984435, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 30.436010204357032, "agent_1": 34.09307190548729}, "custom_metrics": {"delta0_mean": 0.46073808307764863, "delta0_min": 0.42558493525858465, "delta0_max": 0.4801661651440527, "delta1_mean": 0.4260646773942358, "delta1_min": 0.4080150965631155, "delta1_max": 0.43618484135625074, "price0_mean": 1.6363746672698938, "price0_min": 1.6282328493239753, "price0_max": 1.6397818719435702, "price1_mean": 1.6452216676876126, "price1_min": 1.6327990869325142, "price1_max": 1.6502213366566774}, "sampler_perf": {"mean_env_wait_ms": 1.1257674803325977, "mean_processing_ms": 20.75009754525806, "mean_inference_ms": 2.054902457688727}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 779, "num_steps_trained": 39126016, "num_steps_sampled": 8012672, "sample_throughput": 19073.824, "train_throughput": 0.0, "num_weight_syncs": 15648, "num_samples_dropped": 875, "learner_queue": {"size_count": 164448, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.458, "replay_time_ms": 91.936, "update_priorities_time_ms": 46.429, "policy_agent_0": {"added_count": 2012160, "sampled_count": 9745920, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2012160, "sampled_count": 9745920, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33588528633117676}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.28005096316337585}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8012672, "episodes_total": 40104, "training_iteration": 224, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-33-14", "timestamp": 1564914794, "time_this_iter_s": 36.10091233253479, "time_total_s": 7081.763163089752, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd161dd90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16f3d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16f3f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15ea7b8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7081.763163089752, "timesteps_since_restore": 8012672, "iterations_since_restore": 224, "num_healthy_workers": 4}
{"episode_reward_max": 67.36622999382203, "episode_reward_min": 60.02685590874444, "episode_reward_mean": 65.23217726281369, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 31.567961308962403, "agent_1": 33.66421595385129}, "custom_metrics": {"delta0_mean": 0.46174282552441825, "delta0_min": 0.4266213145121191, "delta0_max": 0.48099292546738, "delta1_mean": 0.4277705728122516, "delta1_min": 0.4097487782974294, "delta1_max": 0.437919333146473, "price0_mean": 1.6370107359667156, "price0_min": 1.6288244467069044, "price0_max": 1.6404340526976036, "price1_mean": 1.645757016756627, "price1_min": 1.6333135903273057, "price1_max": 1.6506927949210126}, "sampler_perf": {"mean_env_wait_ms": 1.1256121288335734, "mean_processing_ms": 20.805590913439307, "mean_inference_ms": 2.054548530297506}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 783, "num_steps_trained": 39329280, "num_steps_sampled": 8037760, "sample_throughput": 5342.105, "train_throughput": 21368.422, "num_weight_syncs": 15697, "num_samples_dropped": 875, "learner_queue": {"size_count": 165242, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.281, "replay_time_ms": 86.466, "update_priorities_time_ms": 48.746, "policy_agent_0": {"added_count": 2018816, "sampled_count": 9795072, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2018816, "sampled_count": 9795072, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33069145679473877}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27137795090675354}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8037760, "episodes_total": 40232, "training_iteration": 225, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-33-51", "timestamp": 1564914831, "time_this_iter_s": 36.34268808364868, "time_total_s": 7118.105851173401, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15adae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15adbf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15ada60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15bd6a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7118.105851173401, "timesteps_since_restore": 8037760, "iterations_since_restore": 225, "num_healthy_workers": 4}
{"episode_reward_max": 67.4777126492109, "episode_reward_min": 58.15191477950997, "episode_reward_mean": 66.11114878367597, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 31.891979161039146, "agent_1": 34.219169622636834}, "custom_metrics": {"delta0_mean": 0.4628329946936177, "delta0_min": 0.42797167854775225, "delta0_max": 0.48217421416977674, "delta1_mean": 0.4296232420037557, "delta1_min": 0.41161349258296387, "delta1_max": 0.43965434788429064, "price0_mean": 1.6378708878284867, "price0_min": 1.6297756930793792, "price0_max": 1.6412573555804872, "price1_mean": 1.646507298072337, "price1_min": 1.6341820750735525, "price1_max": 1.6514999793381568}, "sampler_perf": {"mean_env_wait_ms": 1.1255932599011087, "mean_processing_ms": 20.863625304500715, "mean_inference_ms": 2.0550224236197856}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 787, "num_steps_trained": 39542272, "num_steps_sampled": 8062848, "sample_throughput": 3839.015, "train_throughput": 0.0, "num_weight_syncs": 15747, "num_samples_dropped": 875, "learner_queue": {"size_count": 166074, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.854, "replay_time_ms": 98.393, "update_priorities_time_ms": 53.551, "policy_agent_0": {"added_count": 2026496, "sampled_count": 9846016, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2026496, "sampled_count": 9846016, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32254332304000854}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.26936614513397217}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8062848, "episodes_total": 40360, "training_iteration": 226, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-34-29", "timestamp": 1564914869, "time_this_iter_s": 37.27077651023865, "time_total_s": 7155.3766276836395, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15ea2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15ea7b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15ea488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15bdd08>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7155.3766276836395, "timesteps_since_restore": 8062848, "iterations_since_restore": 226, "num_healthy_workers": 4}
{"episode_reward_max": 67.40367701216418, "episode_reward_min": 54.19199086946889, "episode_reward_mean": 61.72179557374483, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.29452145818458, "agent_1": 32.427274115560245}, "custom_metrics": {"delta0_mean": 0.4631864843001765, "delta0_min": 0.4282498510068422, "delta0_max": 0.48224972447513287, "delta1_mean": 0.430960382533893, "delta1_min": 0.413046492403587, "delta1_max": 0.4409294853349779, "price0_mean": 1.6383624086039834, "price0_min": 1.6302914000031126, "price0_max": 1.6417156319574497, "price1_mean": 1.6468226168446487, "price1_min": 1.6345067018633326, "price1_max": 1.6517757286841257}, "sampler_perf": {"mean_env_wait_ms": 1.1258897613481915, "mean_processing_ms": 20.915195976412246, "mean_inference_ms": 2.054749666917843}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 791, "num_steps_trained": 39735552, "num_steps_sampled": 8087936, "sample_throughput": 15561.927, "train_throughput": 0.0, "num_weight_syncs": 15795, "num_samples_dropped": 875, "learner_queue": {"size_count": 166830, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.706, "replay_time_ms": 88.709, "update_priorities_time_ms": 47.792, "policy_agent_0": {"added_count": 2031872, "sampled_count": 9893632, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2031872, "sampled_count": 9893632, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3308013677597046}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2694512903690338}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8087936, "episodes_total": 40488, "training_iteration": 227, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-35-07", "timestamp": 1564914907, "time_this_iter_s": 35.880364179611206, "time_total_s": 7191.256991863251, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15bdd90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16f3d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16f3f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd118b268>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7191.256991863251, "timesteps_since_restore": 8087936, "iterations_since_restore": 227, "num_healthy_workers": 4}
{"episode_reward_max": 67.37619298847785, "episode_reward_min": 59.46715089968017, "episode_reward_mean": 64.78362658694594, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 31.808689042449956, "agent_1": 32.97493754449599}, "custom_metrics": {"delta0_mean": 0.463833816656782, "delta0_min": 0.4294871118358651, "delta0_max": 0.4832874233775379, "delta1_mean": 0.43246189601295615, "delta1_min": 0.4145430068273622, "delta1_max": 0.4423759216382265, "price0_mean": 1.638994567472235, "price0_min": 1.63091643266212, "price0_max": 1.6423438778487973, "price1_mean": 1.647336951682196, "price1_min": 1.63510492620373, "price1_max": 1.652313275365243}, "sampler_perf": {"mean_env_wait_ms": 1.1256211060452768, "mean_processing_ms": 20.969469649534098, "mean_inference_ms": 2.0549231147751126}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 796, "num_steps_trained": 39947008, "num_steps_sampled": 8113024, "sample_throughput": 3687.402, "train_throughput": 0.0, "num_weight_syncs": 15845, "num_samples_dropped": 875, "learner_queue": {"size_count": 167655, "size_mean": 0.16, "size_std": 0.3666060555964672, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.254, "replay_time_ms": 92.769, "update_priorities_time_ms": 54.407, "policy_agent_0": {"added_count": 2039040, "sampled_count": 9947392, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2039040, "sampled_count": 9947392, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31772392988204956}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.26058104634284973}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8113024, "episodes_total": 40608, "training_iteration": 228, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-35-45", "timestamp": 1564914945, "time_this_iter_s": 37.364712715148926, "time_total_s": 7228.6217045784, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd118b2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd118b378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd118b620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1185840>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7228.6217045784, "timesteps_since_restore": 8113024, "iterations_since_restore": 228, "num_healthy_workers": 4}
{"episode_reward_max": 67.31193361499618, "episode_reward_min": 59.4434945514647, "episode_reward_mean": 65.14276518997772, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 32.02287365335353, "agent_1": 33.11989153662418}, "custom_metrics": {"delta0_mean": 0.46528269474484596, "delta0_min": 0.4306196231599745, "delta0_max": 0.4842366520819833, "delta1_mean": 0.43386369193121493, "delta1_min": 0.41606101173267646, "delta1_max": 0.4437891937807284, "price0_mean": 1.6395722774068964, "price0_min": 1.631521163288651, "price0_max": 1.642947089338332, "price1_mean": 1.6478847337544804, "price1_min": 1.635636197309883, "price1_max": 1.652784935797158}, "sampler_perf": {"mean_env_wait_ms": 1.1257684503367422, "mean_processing_ms": 21.029533250959833, "mean_inference_ms": 2.0550940394126425}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 800, "num_steps_trained": 40154880, "num_steps_sampled": 8138112, "sample_throughput": 11692.713, "train_throughput": 0.0, "num_weight_syncs": 15893, "num_samples_dropped": 875, "learner_queue": {"size_count": 168467, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.009, "replay_time_ms": 102.835, "update_priorities_time_ms": 53.45, "policy_agent_0": {"added_count": 2044032, "sampled_count": 9998592, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2044032, "sampled_count": 9998592, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3017031252384186}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.25454795360565186}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8138112, "episodes_total": 40736, "training_iteration": 229, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-36-21", "timestamp": 1564914981, "time_this_iter_s": 36.33846473693848, "time_total_s": 7264.960169315338, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15ea2f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15ea7b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15bdd90>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1198598>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7264.960169315338, "timesteps_since_restore": 8138112, "iterations_since_restore": 229, "num_healthy_workers": 4}
{"episode_reward_max": 67.17689020567332, "episode_reward_min": 61.59060798170116, "episode_reward_mean": 64.96375666818508, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 31.57242773155364, "agent_1": 33.391328936631474}, "custom_metrics": {"delta0_mean": 0.46625887323494686, "delta0_min": 0.43197834295544435, "delta0_max": 0.4854000351533613, "delta1_mean": 0.43544341760009003, "delta1_min": 0.4177482784141421, "delta1_max": 0.44543283146895873, "price0_mean": 1.6401160614950707, "price0_min": 1.6321364253310309, "price0_max": 1.643451657692876, "price1_mean": 1.648337026010928, "price1_min": 1.636216677201617, "price1_max": 1.6532966157471964}, "sampler_perf": {"mean_env_wait_ms": 1.1260692233150793, "mean_processing_ms": 21.08754585056927, "mean_inference_ms": 2.054269812725189}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 804, "num_steps_trained": 40367104, "num_steps_sampled": 8163200, "sample_throughput": 3326.07, "train_throughput": 0.0, "num_weight_syncs": 15943, "num_samples_dropped": 875, "learner_queue": {"size_count": 169296, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 21.727, "replay_time_ms": 93.964, "update_priorities_time_ms": 54.513, "policy_agent_0": {"added_count": 2049920, "sampled_count": 10052608, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2049920, "sampled_count": 10052608, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30427759885787964}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2485044002532959}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8163200, "episodes_total": 40864, "training_iteration": 230, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-37-00", "timestamp": 1564915020, "time_this_iter_s": 37.290836811065674, "time_total_s": 7302.251006126404, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11988c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1198840>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1198950>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11a3b70>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7302.251006126404, "timesteps_since_restore": 8163200, "iterations_since_restore": 230, "num_healthy_workers": 4}
{"episode_reward_max": 66.15739774743288, "episode_reward_min": 62.14638142926012, "episode_reward_mean": 64.09264725359586, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 30.96306840810379, "agent_1": 33.129578845492084}, "custom_metrics": {"delta0_mean": 0.4670594663815156, "delta0_min": 0.4329845381738756, "delta0_max": 0.48621588955383027, "delta1_mean": 0.4369403580862371, "delta1_min": 0.41932455035782024, "delta1_max": 0.4469256218319306, "price0_mean": 1.6405765668239953, "price0_min": 1.6326396632212485, "price0_max": 1.6438949970566834, "price1_mean": 1.6486928580663913, "price1_min": 1.6366420018676713, "price1_max": 1.6536672177187905}, "sampler_perf": {"mean_env_wait_ms": 1.1261033953164667, "mean_processing_ms": 21.139984865200155, "mean_inference_ms": 2.0541680225353036}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 808, "num_steps_trained": 40569600, "num_steps_sampled": 8188288, "sample_throughput": 8758.947, "train_throughput": 0.0, "num_weight_syncs": 15991, "num_samples_dropped": 875, "learner_queue": {"size_count": 170087, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.021, "replay_time_ms": 95.831, "update_priorities_time_ms": 51.227, "policy_agent_0": {"added_count": 2056064, "sampled_count": 10102272, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2056064, "sampled_count": 10102272, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2913964092731476}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.24325160682201385}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8188288, "episodes_total": 40992, "training_iteration": 231, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-37-36", "timestamp": 1564915056, "time_this_iter_s": 36.022687911987305, "time_total_s": 7338.273694038391, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11856a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1185158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1185268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd118b7b8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7338.273694038391, "timesteps_since_restore": 8188288, "iterations_since_restore": 231, "num_healthy_workers": 4}
{"episode_reward_max": 65.53127649304307, "episode_reward_min": 63.43646686993584, "episode_reward_mean": 64.26121761536577, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.695840361768493, "agent_1": 34.56537725359726}, "custom_metrics": {"delta0_mean": 0.46750552942300716, "delta0_min": 0.4334724052056174, "delta0_max": 0.4865894612579851, "delta1_mean": 0.43882469077281777, "delta1_min": 0.42127236237295673, "delta1_max": 0.44873309806885636, "price0_mean": 1.641097773654232, "price0_min": 1.633193863467834, "price0_max": 1.6444008028763502, "price1_mean": 1.649013723214564, "price1_min": 1.6369926654017501, "price1_max": 1.6539719421039136}, "sampler_perf": {"mean_env_wait_ms": 1.1259125929792677, "mean_processing_ms": 21.194649048478404, "mean_inference_ms": 2.053816804186846}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 812, "num_steps_trained": 40771328, "num_steps_sampled": 8213376, "sample_throughput": 8185.88, "train_throughput": 16371.759, "num_weight_syncs": 16041, "num_samples_dropped": 875, "learner_queue": {"size_count": 170876, "size_mean": 0.14, "size_std": 0.34698703145794946, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.708, "replay_time_ms": 99.836, "update_priorities_time_ms": 48.716, "policy_agent_0": {"added_count": 2063232, "sampled_count": 10154496, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2063232, "sampled_count": 10154496, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3034963011741638}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.23994827270507812}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8213376, "episodes_total": 41120, "training_iteration": 232, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-38-14", "timestamp": 1564915094, "time_this_iter_s": 37.08396911621094, "time_total_s": 7375.357663154602, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd117fbf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd117fae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd117fc80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15bdae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7375.357663154602, "timesteps_since_restore": 8213376, "iterations_since_restore": 232, "num_healthy_workers": 4}
{"episode_reward_max": 65.21895623550495, "episode_reward_min": 62.725458553062786, "episode_reward_mean": 63.64035113696636, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.864594930829597, "agent_1": 33.775756206136776}, "custom_metrics": {"delta0_mean": 0.467995522277694, "delta0_min": 0.43399540000278514, "delta0_max": 0.4869948915647309, "delta1_mean": 0.4404798775440968, "delta1_min": 0.4229578029955824, "delta1_max": 0.4503320108875669, "price0_mean": 1.6415519389711628, "price0_min": 1.633686188463083, "price0_max": 1.6448401363919682, "price1_mean": 1.6493019493864598, "price1_min": 1.6373124613166032, "price1_max": 1.6542406082412369}, "sampler_perf": {"mean_env_wait_ms": 1.126190967325926, "mean_processing_ms": 21.249828510209266, "mean_inference_ms": 2.0535955188217723}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 816, "num_steps_trained": 40983552, "num_steps_sampled": 8238464, "sample_throughput": 14506.496, "train_throughput": 0.0, "num_weight_syncs": 16089, "num_samples_dropped": 875, "learner_queue": {"size_count": 171704, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.749, "replay_time_ms": 85.418, "update_priorities_time_ms": 50.343, "policy_agent_0": {"added_count": 2069760, "sampled_count": 10207744, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2069760, "sampled_count": 10207744, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3049006462097168}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.23682060837745667}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8238464, "episodes_total": 41248, "training_iteration": 233, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-38-51", "timestamp": 1564915131, "time_this_iter_s": 37.48305320739746, "time_total_s": 7412.8407163619995, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11857b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11856a8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11851e0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15eab70>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7412.8407163619995, "timesteps_since_restore": 8238464, "iterations_since_restore": 233, "num_healthy_workers": 4}
{"episode_reward_max": 63.99563326056299, "episode_reward_min": 59.54720959626659, "episode_reward_mean": 62.636265247008055, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.711746284546393, "agent_1": 32.92451896246167}, "custom_metrics": {"delta0_mean": 0.468439427501183, "delta0_min": 0.43459586200912864, "delta0_max": 0.48736833379400507, "delta1_mean": 0.4418920788655577, "delta1_min": 0.42441085630096836, "delta1_max": 0.45170152614735454, "price0_mean": 1.6419320546137546, "price0_min": 1.6340889510279941, "price0_max": 1.645208782442134, "price1_mean": 1.6495435301397792, "price1_min": 1.6375986350753962, "price1_max": 1.6544663693273913}, "sampler_perf": {"mean_env_wait_ms": 1.126623777197033, "mean_processing_ms": 21.305199425345773, "mean_inference_ms": 2.0533186610264047}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 820, "num_steps_trained": 41193216, "num_steps_sampled": 8263552, "sample_throughput": 16851.997, "train_throughput": 33703.993, "num_weight_syncs": 16139, "num_samples_dropped": 875, "learner_queue": {"size_count": 172524, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.341, "replay_time_ms": 100.635, "update_priorities_time_ms": 53.593, "policy_agent_0": {"added_count": 2075392, "sampled_count": 10259968, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2075392, "sampled_count": 10259968, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30690616369247437}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2513599395751953}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8263552, "episodes_total": 41376, "training_iteration": 234, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-39-29", "timestamp": 1564915169, "time_this_iter_s": 37.65205454826355, "time_total_s": 7450.492770910263, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11d6048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11d60d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11d62f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15de620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7450.492770910263, "timesteps_since_restore": 8263552, "iterations_since_restore": 234, "num_healthy_workers": 4}
{"episode_reward_max": 62.958981895971554, "episode_reward_min": 60.262757775184376, "episode_reward_mean": 61.90481382476433, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.00823782851305, "agent_1": 34.89657599625129}, "custom_metrics": {"delta0_mean": 0.4681414897628595, "delta0_min": 0.4344468248675118, "delta0_max": 0.4870409818980689, "delta1_mean": 0.44383455066055055, "delta1_min": 0.42640779650621613, "delta1_max": 0.4536270365002329, "price0_mean": 1.6423767048432167, "price0_min": 1.6345615720545332, "price0_max": 1.6456436426003658, "price1_mean": 1.649662848168202, "price1_min": 1.6377670347696789, "price1_max": 1.654578819143823}, "sampler_perf": {"mean_env_wait_ms": 1.1265042999729065, "mean_processing_ms": 21.35686106675416, "mean_inference_ms": 2.0528832649390876}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 824, "num_steps_trained": 41395456, "num_steps_sampled": 8288640, "sample_throughput": 19598.12, "train_throughput": 0.0, "num_weight_syncs": 16187, "num_samples_dropped": 875, "learner_queue": {"size_count": 173313, "size_mean": 0.34, "size_std": 0.5517245689653488, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.335, "replay_time_ms": 102.61, "update_priorities_time_ms": 51.594, "policy_agent_0": {"added_count": 2080256, "sampled_count": 10309376, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2080256, "sampled_count": 10309376, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30047607421875}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2369823157787323}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8288640, "episodes_total": 41504, "training_iteration": 235, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-40-06", "timestamp": 1564915206, "time_this_iter_s": 36.63085985183716, "time_total_s": 7487.1236307621, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11857b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1185268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1185158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1627510>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7487.1236307621, "timesteps_since_restore": 8288640, "iterations_since_restore": 235, "num_healthy_workers": 4}
{"episode_reward_max": 61.60520912058792, "episode_reward_min": 58.68520000886875, "episode_reward_mean": 60.206636193792534, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 25.20646459220625, "agent_1": 35.00017160158629}, "custom_metrics": {"delta0_mean": 0.4677415790546393, "delta0_min": 0.4337179695481769, "delta0_max": 0.4861190294113037, "delta1_mean": 0.4455763218085195, "delta1_min": 0.42810339472217235, "delta1_max": 0.4552475888508248, "price0_mean": 1.6427571999230517, "price0_min": 1.6350166580422125, "price0_max": 1.6459839918526926, "price1_mean": 1.6496908595174078, "price1_min": 1.6378040518094414, "price1_max": 1.6545640676302187}, "sampler_perf": {"mean_env_wait_ms": 1.1264375652312983, "mean_processing_ms": 21.414669375539223, "mean_inference_ms": 2.0534363094875183}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 829, "num_steps_trained": 41602816, "num_steps_sampled": 8313728, "sample_throughput": 10258.941, "train_throughput": 0.0, "num_weight_syncs": 16237, "num_samples_dropped": 875, "learner_queue": {"size_count": 174123, "size_mean": 0.24, "size_std": 0.4270831300812525, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.797, "replay_time_ms": 104.321, "update_priorities_time_ms": 46.152, "policy_agent_0": {"added_count": 2085376, "sampled_count": 10362880, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2085376, "sampled_count": 10362880, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30589160323143005}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.22971923649311066}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8313728, "episodes_total": 41624, "training_iteration": 236, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-40-43", "timestamp": 1564915243, "time_this_iter_s": 37.04062819480896, "time_total_s": 7524.164258956909, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1627378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1627400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd161d2f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16500d0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7524.164258956909, "timesteps_since_restore": 8313728, "iterations_since_restore": 236, "num_healthy_workers": 4}
{"episode_reward_max": 60.34146563393083, "episode_reward_min": 57.170225089302164, "episode_reward_mean": 59.01135210925844, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 23.957121512206967, "agent_1": 35.05423059705148}, "custom_metrics": {"delta0_mean": 0.46628017038537517, "delta0_min": 0.4326507698462249, "delta0_max": 0.4849348992011904, "delta1_mean": 0.44763309278001684, "delta1_min": 0.43006136046074467, "delta1_max": 0.457122693623765, "price0_mean": 1.6431774721104782, "price0_min": 1.6354645887891863, "price0_max": 1.6463680821924533, "price1_mean": 1.649590384695105, "price1_min": 1.6377668531957523, "price1_max": 1.654480276402735}, "sampler_perf": {"mean_env_wait_ms": 1.1265510016041498, "mean_processing_ms": 21.472078574998473, "mean_inference_ms": 2.053347041039895}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 833, "num_steps_trained": 41820672, "num_steps_sampled": 8338816, "sample_throughput": 12375.145, "train_throughput": 0.0, "num_weight_syncs": 16286, "num_samples_dropped": 875, "learner_queue": {"size_count": 174975, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.739, "replay_time_ms": 88.39, "update_priorities_time_ms": 63.153, "policy_agent_0": {"added_count": 2091392, "sampled_count": 10417664, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2091392, "sampled_count": 10417664, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3307989239692688}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.23622199892997742}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8338816, "episodes_total": 41752, "training_iteration": 237, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-41-22", "timestamp": 1564915282, "time_this_iter_s": 37.963133811950684, "time_total_s": 7562.12739276886, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1185268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1185158>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11857b8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd174e9d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7562.12739276886, "timesteps_since_restore": 8338816, "iterations_since_restore": 237, "num_healthy_workers": 4}
{"episode_reward_max": 59.24491207241153, "episode_reward_min": 56.43646889862267, "episode_reward_mean": 57.73072257408997, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 23.25599502645187, "agent_1": 34.474727547638096}, "custom_metrics": {"delta0_mean": 0.4649738966608362, "delta0_min": 0.4314451200332472, "delta0_max": 0.4835265334967429, "delta1_mean": 0.4494269337164284, "delta1_min": 0.4319560758086041, "delta1_max": 0.45889153841096025, "price0_mean": 1.6435351927209774, "price0_min": 1.635835563235811, "price0_max": 1.6467166975107046, "price1_mean": 1.6494461980216233, "price1_min": 1.6376511863729981, "price1_max": 1.654310599811426}, "sampler_perf": {"mean_env_wait_ms": 1.1267639873322137, "mean_processing_ms": 21.521343704221817, "mean_inference_ms": 2.0532717118464285}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 837, "num_steps_trained": 42032384, "num_steps_sampled": 8363904, "sample_throughput": 3456.703, "train_throughput": 0.0, "num_weight_syncs": 16334, "num_samples_dropped": 875, "learner_queue": {"size_count": 175802, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.223, "replay_time_ms": 101.708, "update_priorities_time_ms": 55.562, "policy_agent_0": {"added_count": 2098048, "sampled_count": 10471424, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2098048, "sampled_count": 10471424, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3721260130405426}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.23743966221809387}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8363904, "episodes_total": 41880, "training_iteration": 238, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-41-59", "timestamp": 1564915319, "time_this_iter_s": 37.12487173080444, "time_total_s": 7599.252264499664, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd175d268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd175d1e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175dae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176e7b8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7599.252264499664, "timesteps_since_restore": 8363904, "iterations_since_restore": 238, "num_healthy_workers": 4}
{"episode_reward_max": 59.00668373350731, "episode_reward_min": 55.155104030862184, "episode_reward_mean": 57.47723907898436, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 22.721888989164846, "agent_1": 34.75535008981952}, "custom_metrics": {"delta0_mean": 0.4635314832610843, "delta0_min": 0.43011887342448923, "delta0_max": 0.482010025246727, "delta1_mean": 0.4512846068658962, "delta1_min": 0.43378110688142857, "delta1_max": 0.46063243207312043, "price0_mean": 1.6439162168563972, "price0_min": 1.6362600835925387, "price0_max": 1.6470628057157055, "price1_mean": 1.6492912935108006, "price1_min": 1.637549237907665, "price1_max": 1.6541550972662962}, "sampler_perf": {"mean_env_wait_ms": 1.1271957284427023, "mean_processing_ms": 21.574574952379052, "mean_inference_ms": 2.0525769635027458}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 841, "num_steps_trained": 42235648, "num_steps_sampled": 8388992, "sample_throughput": 22432.245, "train_throughput": 0.0, "num_weight_syncs": 16384, "num_samples_dropped": 875, "learner_queue": {"size_count": 176595, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.457, "replay_time_ms": 107.44, "update_priorities_time_ms": 48.048, "policy_agent_0": {"added_count": 2104448, "sampled_count": 10522112, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2104448, "sampled_count": 10522112, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39940738677978516}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2178802490234375}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8388992, "episodes_total": 42008, "training_iteration": 239, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-42-36", "timestamp": 1564915356, "time_this_iter_s": 36.95729303359985, "time_total_s": 7636.209557533264, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd174e9d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd174ebf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd161d2f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd170c6a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7636.209557533264, "timesteps_since_restore": 8388992, "iterations_since_restore": 239, "num_healthy_workers": 4}
{"episode_reward_max": 60.31526644081879, "episode_reward_min": 57.228585652851756, "episode_reward_mean": 58.788852738262634, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 23.214667068631034, "agent_1": 35.5741856696316}, "custom_metrics": {"delta0_mean": 0.46263695707609476, "delta0_min": 0.42891695652100015, "delta0_max": 0.4806873101437036, "delta1_mean": 0.45314561576893614, "delta1_min": 0.4356654504213138, "delta1_max": 0.4624012512580927, "price0_mean": 1.6443132917581138, "price0_min": 1.6367161834269524, "price0_max": 1.6474260847732254, "price1_mean": 1.6492297122093234, "price1_min": 1.637491700177506, "price1_max": 1.6540523977904567}, "sampler_perf": {"mean_env_wait_ms": 1.1274381462241332, "mean_processing_ms": 21.63695118945725, "mean_inference_ms": 2.0528485875973734}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 845, "num_steps_trained": 42452224, "num_steps_sampled": 8414080, "sample_throughput": 5483.254, "train_throughput": 0.0, "num_weight_syncs": 16432, "num_samples_dropped": 875, "learner_queue": {"size_count": 177442, "size_mean": 0.38, "size_std": 0.7453858061433689, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 20.685, "replay_time_ms": 59.812, "update_priorities_time_ms": 35.745, "policy_agent_0": {"added_count": 2110464, "sampled_count": 10576896, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2110464, "sampled_count": 10576896, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4308934807777405}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.22892022132873535}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8414080, "episodes_total": 42128, "training_iteration": 240, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-43-14", "timestamp": 1564915394, "time_this_iter_s": 38.20590615272522, "time_total_s": 7674.415463685989, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17126a8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17122f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17129d8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17228c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7674.415463685989, "timesteps_since_restore": 8414080, "iterations_since_restore": 240, "num_healthy_workers": 4}
{"episode_reward_max": 60.60562835592025, "episode_reward_min": 53.64668617180725, "episode_reward_mean": 56.37548202086418, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 23.784344830747035, "agent_1": 32.59113719011715}, "custom_metrics": {"delta0_mean": 0.4611698469825396, "delta0_min": 0.4278965140220243, "delta0_max": 0.4795181603838414, "delta1_mean": 0.45447739326665376, "delta1_min": 0.4369937622127048, "delta1_max": 0.46368315097353635, "price0_mean": 1.644534744081913, "price0_min": 1.636944586156196, "price0_max": 1.6476439581530835, "price1_mean": 1.6490162167055198, "price1_min": 1.6373411407650387, "price1_max": 1.653854543041772}, "sampler_perf": {"mean_env_wait_ms": 1.1276813707889346, "mean_processing_ms": 21.695334193668867, "mean_inference_ms": 2.05263978289158}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 850, "num_steps_trained": 42680832, "num_steps_sampled": 8439168, "sample_throughput": 12010.266, "train_throughput": 0.0, "num_weight_syncs": 16481, "num_samples_dropped": 875, "learner_queue": {"size_count": 178334, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.437, "replay_time_ms": 94.534, "update_priorities_time_ms": 54.773, "policy_agent_0": {"added_count": 2117248, "sampled_count": 10635008, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2117248, "sampled_count": 10635008, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4741460680961609}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.236667200922966}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8439168, "episodes_total": 42256, "training_iteration": 241, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-43-53", "timestamp": 1564915433, "time_this_iter_s": 38.69573092460632, "time_total_s": 7713.111194610596, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd175dae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd175d1e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd175d268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c01e0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7713.111194610596, "timesteps_since_restore": 8439168, "iterations_since_restore": 241, "num_healthy_workers": 4}
{"episode_reward_max": 59.03521990886167, "episode_reward_min": 52.95205484160587, "episode_reward_mean": 55.16228248210327, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 24.480159428601304, "agent_1": 30.682123053501968}, "custom_metrics": {"delta0_mean": 0.46022280412520444, "delta0_min": 0.4270858389226723, "delta0_max": 0.478514879354673, "delta1_mean": 0.45521274209593227, "delta1_min": 0.43786784984797067, "delta1_max": 0.4644823563857514, "price0_mean": 1.6446190575769486, "price0_min": 1.6370357279405796, "price0_max": 1.647745297122793, "price1_mean": 1.648803560942269, "price1_min": 1.6371628759718253, "price1_max": 1.653615573158699}, "sampler_perf": {"mean_env_wait_ms": 1.1276862445721274, "mean_processing_ms": 21.75053700669326, "mean_inference_ms": 2.052152735802287}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 854, "num_steps_trained": 42893568, "num_steps_sampled": 8464256, "sample_throughput": 4186.161, "train_throughput": 0.0, "num_weight_syncs": 16531, "num_samples_dropped": 875, "learner_queue": {"size_count": 179167, "size_mean": 0.28, "size_std": 0.448998886412873, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.078, "replay_time_ms": 91.275, "update_priorities_time_ms": 40.114, "policy_agent_0": {"added_count": 2123776, "sampled_count": 10688256, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2123776, "sampled_count": 10688256, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4928745627403259}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2505399286746979}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8464256, "episodes_total": 42384, "training_iteration": 242, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-44-32", "timestamp": 1564915472, "time_this_iter_s": 38.319990396499634, "time_total_s": 7751.431185007095, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16ea268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16ea0d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16eae18>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16829d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7751.431185007095, "timesteps_since_restore": 8464256, "iterations_since_restore": 242, "num_healthy_workers": 4}
{"episode_reward_max": 55.58392184679676, "episode_reward_min": 46.749721170139175, "episode_reward_mean": 51.43853971092456, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.85449846375837, "agent_1": 25.58404124716619}, "custom_metrics": {"delta0_mean": 0.45964832876577044, "delta0_min": 0.4266163082759007, "delta0_max": 0.47785816116450497, "delta1_mean": 0.45458224957481924, "delta1_min": 0.43734908038435416, "delta1_max": 0.46386845612829986, "price0_mean": 1.6443624922184028, "price0_min": 1.6368011271657332, "price0_max": 1.6474896498731186, "price1_mean": 1.6485586305538078, "price1_min": 1.6369614820206737, "price1_max": 1.653352623108306}, "sampler_perf": {"mean_env_wait_ms": 1.1274829427862247, "mean_processing_ms": 21.80274589869714, "mean_inference_ms": 2.0525653348752995}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 858, "num_steps_trained": 43099904, "num_steps_sampled": 8489344, "sample_throughput": 10738.277, "train_throughput": 0.0, "num_weight_syncs": 16579, "num_samples_dropped": 875, "learner_queue": {"size_count": 179972, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.646, "replay_time_ms": 75.787, "update_priorities_time_ms": 42.722, "policy_agent_0": {"added_count": 2131712, "sampled_count": 10738688, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2131712, "sampled_count": 10738688, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5041519999504089}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.25542518496513367}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8489344, "episodes_total": 42512, "training_iteration": 243, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-45-10", "timestamp": 1564915510, "time_this_iter_s": 37.524287939071655, "time_total_s": 7788.955472946167, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17228c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd17129d8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17122f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd161ae18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7788.955472946167, "timesteps_since_restore": 8489344, "iterations_since_restore": 243, "num_healthy_workers": 4}
{"episode_reward_max": 53.980999813548365, "episode_reward_min": 43.10070775380423, "episode_reward_mean": 49.42896871680861, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.05813412170416, "agent_1": 21.370834595104448}, "custom_metrics": {"delta0_mean": 0.4596654215375492, "delta0_min": 0.4268277664654206, "delta0_max": 0.477900915864051, "delta1_mean": 0.45283189637140664, "delta1_min": 0.4357340494976095, "delta1_max": 0.4620703148671227, "price0_mean": 1.6439158097506406, "price0_min": 1.6363735135491988, "price0_max": 1.647028202843282, "price1_mean": 1.6484758867322786, "price1_min": 1.6369414823666233, "price1_max": 1.6532818217907719}, "sampler_perf": {"mean_env_wait_ms": 1.1273211028339576, "mean_processing_ms": 21.860635146563595, "mean_inference_ms": 2.051963125199205}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 863, "num_steps_trained": 43312640, "num_steps_sampled": 8514432, "sample_throughput": 4000.707, "train_throughput": 8001.415, "num_weight_syncs": 16629, "num_samples_dropped": 875, "learner_queue": {"size_count": 180803, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 22.574, "replay_time_ms": 96.902, "update_priorities_time_ms": 47.517, "policy_agent_0": {"added_count": 2137728, "sampled_count": 10791424, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2137728, "sampled_count": 10791424, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5037081241607666}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30226612091064453}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8514432, "episodes_total": 42640, "training_iteration": 244, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-45-48", "timestamp": 1564915548, "time_this_iter_s": 38.153435707092285, "time_total_s": 7827.108908653259, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1673158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1673730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1673378>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15d4f28>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7827.108908653259, "timesteps_since_restore": 8514432, "iterations_since_restore": 244, "num_healthy_workers": 4}
{"episode_reward_max": 49.08637605588639, "episode_reward_min": 42.13300431784144, "episode_reward_mean": 47.79456641023382, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 24.75266020490176, "agent_1": 23.041906205332065}, "custom_metrics": {"delta0_mean": 0.45917610972275796, "delta0_min": 0.425931865117826, "delta0_max": 0.47677619095115387, "delta1_mean": 0.4515228242992553, "delta1_min": 0.4346624357355165, "delta1_max": 0.46092653117857263, "price0_mean": 1.6434959585559494, "price0_min": 1.635958656217616, "price0_max": 1.6466418304946464, "price1_mean": 1.6481728291805098, "price1_min": 1.6365911799221664, "price1_max": 1.6528627181412527}, "sampler_perf": {"mean_env_wait_ms": 1.1274010088879507, "mean_processing_ms": 21.915063506054175, "mean_inference_ms": 2.05213068993027}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 867, "num_steps_trained": 43517952, "num_steps_sampled": 8539520, "sample_throughput": 6176.645, "train_throughput": 0.0, "num_weight_syncs": 16678, "num_samples_dropped": 875, "learner_queue": {"size_count": 181604, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.864, "replay_time_ms": 70.496, "update_priorities_time_ms": 44.929, "policy_agent_0": {"added_count": 2143360, "sampled_count": 10842368, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2143360, "sampled_count": 10842368, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4840277135372162}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3617511987686157}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8539520, "episodes_total": 42760, "training_iteration": 245, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-46-26", "timestamp": 1564915586, "time_this_iter_s": 37.846694231033325, "time_total_s": 7864.955602884293, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16829d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c01e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c0400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15d1d08>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7864.955602884293, "timesteps_since_restore": 8539520, "iterations_since_restore": 245, "num_healthy_workers": 4}
{"episode_reward_max": 49.511330946997404, "episode_reward_min": 48.04191982261444, "episode_reward_mean": 48.861835608754376, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.363732369439298, "agent_1": 23.498103239315085}, "custom_metrics": {"delta0_mean": 0.4581607869822596, "delta0_min": 0.4253797997371929, "delta0_max": 0.47606300807065244, "delta1_mean": 0.45044967624322396, "delta1_min": 0.43358656694486014, "delta1_max": 0.4597496363443636, "price0_mean": 1.6431085020669776, "price0_min": 1.635581803825797, "price0_max": 1.646236088554707, "price1_mean": 1.6478424644491692, "price1_min": 1.636331251736752, "price1_max": 1.6525522185435713}, "sampler_perf": {"mean_env_wait_ms": 1.1275246791523061, "mean_processing_ms": 21.976697376564783, "mean_inference_ms": 2.0513760865363544}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 871, "num_steps_trained": 43745536, "num_steps_sampled": 8564608, "sample_throughput": 20043.715, "train_throughput": 0.0, "num_weight_syncs": 16726, "num_samples_dropped": 875, "learner_queue": {"size_count": 182493, "size_mean": 0.24, "size_std": 0.42708313008125254, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.337, "replay_time_ms": 95.287, "update_priorities_time_ms": 59.605, "policy_agent_0": {"added_count": 2149504, "sampled_count": 10898688, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2149504, "sampled_count": 10898688, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4901086688041687}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43841102719306946}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8564608, "episodes_total": 42888, "training_iteration": 246, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-47-06", "timestamp": 1564915626, "time_this_iter_s": 39.3698456287384, "time_total_s": 7904.325448513031, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15d11e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15d10d0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1590a60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1597488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7904.325448513031, "timesteps_since_restore": 8564608, "iterations_since_restore": 246, "num_healthy_workers": 4}
{"episode_reward_max": 49.64315858705768, "episode_reward_min": 47.35609055696183, "episode_reward_mean": 48.65603166055759, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 24.956947851245413, "agent_1": 23.699083809312178}, "custom_metrics": {"delta0_mean": 0.45772873042033513, "delta0_min": 0.42468119596914045, "delta0_max": 0.4752068368317541, "delta1_mean": 0.44930984432949955, "delta1_min": 0.43267865803817557, "delta1_max": 0.4587681488840005, "price0_mean": 1.6427293224310355, "price0_min": 1.6352086609593308, "price0_max": 1.645889411871839, "price1_mean": 1.6475580006928419, "price1_min": 1.6360374866993337, "price1_max": 1.6522082156862563}, "sampler_perf": {"mean_env_wait_ms": 1.1274624174227654, "mean_processing_ms": 22.03353618960296, "mean_inference_ms": 2.051486147055827}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 876, "num_steps_trained": 43963648, "num_steps_sampled": 8589696, "sample_throughput": 2807.946, "train_throughput": 5615.893, "num_weight_syncs": 16776, "num_samples_dropped": 875, "learner_queue": {"size_count": 183345, "size_mean": 0.04, "size_std": 0.19595917942265428, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.985, "replay_time_ms": 97.68, "update_priorities_time_ms": 48.775, "policy_agent_0": {"added_count": 2155136, "sampled_count": 10951680, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2155136, "sampled_count": 10951680, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4612431526184082}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45550546050071716}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8589696, "episodes_total": 43008, "training_iteration": 247, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-47-43", "timestamp": 1564915663, "time_this_iter_s": 37.35590076446533, "time_total_s": 7941.681349277496, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15d1bf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15d1268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15d1950>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11d9730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7941.681349277496, "timesteps_since_restore": 8589696, "iterations_since_restore": 247, "num_healthy_workers": 4}
{"episode_reward_max": 49.91919545684215, "episode_reward_min": 47.570898955575785, "episode_reward_mean": 48.84825115797332, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 24.401171802524456, "agent_1": 24.447079355448874}, "custom_metrics": {"delta0_mean": 0.45647060191080646, "delta0_min": 0.4238228641800763, "delta0_max": 0.47420981268253776, "delta1_mean": 0.44850745394986863, "delta1_min": 0.43183212906227003, "delta1_max": 0.4578508224078063, "price0_mean": 1.6423986210331545, "price0_min": 1.6348829967317975, "price0_max": 1.6455389246874317, "price1_mean": 1.6471735474525655, "price1_min": 1.6357074412671346, "price1_max": 1.651833998576201}, "sampler_perf": {"mean_env_wait_ms": 1.127597008894504, "mean_processing_ms": 22.090974472352432, "mean_inference_ms": 2.050784115864473}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 880, "num_steps_trained": 44188672, "num_steps_sampled": 8614784, "sample_throughput": 4816.671, "train_throughput": 9633.341, "num_weight_syncs": 16824, "num_samples_dropped": 875, "learner_queue": {"size_count": 184225, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.582, "replay_time_ms": 78.901, "update_priorities_time_ms": 36.079, "policy_agent_0": {"added_count": 2160512, "sampled_count": 11008256, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2160512, "sampled_count": 11008256, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.45408377051353455}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49419644474983215}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8614784, "episodes_total": 43136, "training_iteration": 248, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-48-24", "timestamp": 1564915704, "time_this_iter_s": 38.77796912193298, "time_total_s": 7980.459318399429, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11d98c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11d9598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11d9b70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11dd7b8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 7980.459318399429, "timesteps_since_restore": 8614784, "iterations_since_restore": 248, "num_healthy_workers": 4}
{"episode_reward_max": 50.155434911798054, "episode_reward_min": 47.317026790624915, "episode_reward_mean": 48.87198109942686, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 24.01497307239101, "agent_1": 24.85700802703585}, "custom_metrics": {"delta0_mean": 0.45518053155936106, "delta0_min": 0.4229852682230394, "delta0_max": 0.4732413682673316, "delta1_mean": 0.4478659514737353, "delta1_min": 0.4311451423784583, "delta1_max": 0.4570593815238053, "price0_mean": 1.6421138582312376, "price0_min": 1.6346136913613947, "price0_max": 1.6452195849199134, "price1_mean": 1.6467925837509454, "price1_min": 1.6354001282470294, "price1_max": 1.6514847212739137}, "sampler_perf": {"mean_env_wait_ms": 1.1275739260074142, "mean_processing_ms": 22.140662333498074, "mean_inference_ms": 2.049681378047313}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 884, "num_steps_trained": 44388864, "num_steps_sampled": 8639872, "sample_throughput": 7505.063, "train_throughput": 0.0, "num_weight_syncs": 16874, "num_samples_dropped": 875, "learner_queue": {"size_count": 185007, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.942, "replay_time_ms": 61.149, "update_priorities_time_ms": 35.093, "policy_agent_0": {"added_count": 2166912, "sampled_count": 11056640, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2166912, "sampled_count": 11056640, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.44940459728240967}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5168486833572388}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8639872, "episodes_total": 43256, "training_iteration": 249, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-49-02", "timestamp": 1564915742, "time_this_iter_s": 37.24057078361511, "time_total_s": 8017.699889183044, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1597158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1597488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15972f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11a3b70>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8017.699889183044, "timesteps_since_restore": 8639872, "iterations_since_restore": 249, "num_healthy_workers": 4}
{"episode_reward_max": 50.14822195838404, "episode_reward_min": 46.653378834115635, "episode_reward_mean": 48.27823123783712, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 23.791886213882286, "agent_1": 24.48634502395484}, "custom_metrics": {"delta0_mean": 0.45441100908181653, "delta0_min": 0.42199594674494056, "delta0_max": 0.4721141902759255, "delta1_mean": 0.44688116002445316, "delta1_min": 0.43028339531234827, "delta1_max": 0.45610226784461994, "price0_mean": 1.6417603650404953, "price0_min": 1.634303163866468, "price0_max": 1.6448577974629381, "price1_mean": 1.6464246895614023, "price1_min": 1.6350425687497465, "price1_max": 1.6510823758254947}, "sampler_perf": {"mean_env_wait_ms": 1.1275478764016311, "mean_processing_ms": 22.193695521708367, "mean_inference_ms": 2.050527716931926}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 888, "num_steps_trained": 44605440, "num_steps_sampled": 8664960, "sample_throughput": 7565.078, "train_throughput": 0.0, "num_weight_syncs": 16922, "num_samples_dropped": 875, "learner_queue": {"size_count": 185853, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 12.09, "replay_time_ms": 85.609, "update_priorities_time_ms": 49.337, "policy_agent_0": {"added_count": 2173952, "sampled_count": 11110144, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2173952, "sampled_count": 11110144, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4615178108215332}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5263155698776245}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8664960, "episodes_total": 43384, "training_iteration": 250, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-49-41", "timestamp": 1564915781, "time_this_iter_s": 39.16090798377991, "time_total_s": 8056.860797166824, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11a3e18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11a3ea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11a3f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11ab1e0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8056.860797166824, "timesteps_since_restore": 8664960, "iterations_since_restore": 250, "num_healthy_workers": 4}
{"episode_reward_max": 50.02256503962564, "episode_reward_min": 47.394383222768134, "episode_reward_mean": 48.94281339211178, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 23.541603800409927, "agent_1": 25.401209591701857}, "custom_metrics": {"delta0_mean": 0.4532636046059646, "delta0_min": 0.42093575482632106, "delta0_max": 0.470918710889923, "delta1_mean": 0.446241516614445, "delta1_min": 0.4296152908494201, "delta1_max": 0.45536885173492536, "price0_mean": 1.6414824063191786, "price0_min": 1.634067859297852, "price0_max": 1.6445536113672807, "price1_mean": 1.6460293351654125, "price1_min": 1.6346827682848593, "price1_max": 1.6506794997421885}, "sampler_perf": {"mean_env_wait_ms": 1.127724268033875, "mean_processing_ms": 22.24922531902449, "mean_inference_ms": 2.0505506564132654}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 893, "num_steps_trained": 44814592, "num_steps_sampled": 8690048, "sample_throughput": 15311.608, "train_throughput": 0.0, "num_weight_syncs": 16971, "num_samples_dropped": 875, "learner_queue": {"size_count": 186669, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 26.834, "replay_time_ms": 94.335, "update_priorities_time_ms": 51.056, "policy_agent_0": {"added_count": 2180224, "sampled_count": 11162880, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2180224, "sampled_count": 11162880, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4707059860229492}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5223445892333984}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8690048, "episodes_total": 43512, "training_iteration": 251, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-50-20", "timestamp": 1564915820, "time_this_iter_s": 37.949934005737305, "time_total_s": 8094.810731172562, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11a3c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11a3d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11a3bf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11abc80>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8094.810731172562, "timesteps_since_restore": 8690048, "iterations_since_restore": 251, "num_healthy_workers": 4}
{"episode_reward_max": 50.639649922022755, "episode_reward_min": 44.627943920759016, "episode_reward_mean": 47.19196322659521, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 23.17254441186189, "agent_1": 24.01941881473333}, "custom_metrics": {"delta0_mean": 0.4524136432515184, "delta0_min": 0.41977157443840835, "delta0_max": 0.4696020874266542, "delta1_mean": 0.44521190376655917, "delta1_min": 0.4287733776352391, "delta1_max": 0.45444526272443975, "price0_mean": 1.6411231531881583, "price0_min": 1.6337258081153936, "price0_max": 1.6442142445024963, "price1_mean": 1.6456538931998483, "price1_min": 1.634284379771106, "price1_max": 1.6502330295824612}, "sampler_perf": {"mean_env_wait_ms": 1.1277214129213033, "mean_processing_ms": 22.30102254742106, "mean_inference_ms": 2.0512239672607424}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 897, "num_steps_trained": 45030912, "num_steps_sampled": 8715136, "sample_throughput": 4615.902, "train_throughput": 0.0, "num_weight_syncs": 17021, "num_samples_dropped": 875, "learner_queue": {"size_count": 187514, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.208, "replay_time_ms": 98.692, "update_priorities_time_ms": 63.083, "policy_agent_0": {"added_count": 2186624, "sampled_count": 11214592, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2186624, "sampled_count": 11214592, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4831538796424866}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5204921364784241}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8715136, "episodes_total": 43632, "training_iteration": 252, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-50-58", "timestamp": 1564915858, "time_this_iter_s": 37.27222466468811, "time_total_s": 8132.08295583725, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11abd90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11abe18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11abd08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd113f0d0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8132.08295583725, "timesteps_since_restore": 8715136, "iterations_since_restore": 252, "num_healthy_workers": 4}
{"episode_reward_max": 49.49101586044196, "episode_reward_min": 45.90124366529937, "episode_reward_mean": 47.79859828996717, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 23.160701162941546, "agent_1": 24.63789712702562}, "custom_metrics": {"delta0_mean": 0.45063130956867875, "delta0_min": 0.4187804641086053, "delta0_max": 0.46850061338623167, "delta1_mean": 0.4446233393359869, "delta1_min": 0.42805188885645723, "delta1_max": 0.45363255708870204, "price0_mean": 1.640840730434672, "price0_min": 1.6334464563486513, "price0_max": 1.6438918539354739, "price1_mean": 1.645213363038857, "price1_min": 1.6339466437622714, "price1_max": 1.6498577201842954}, "sampler_perf": {"mean_env_wait_ms": 1.1277188431771499, "mean_processing_ms": 22.35257099560313, "mean_inference_ms": 2.0501984921107144}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 901, "num_steps_trained": 45233408, "num_steps_sampled": 8740224, "sample_throughput": 17776.888, "train_throughput": 0.0, "num_weight_syncs": 17069, "num_samples_dropped": 875, "learner_queue": {"size_count": 188305, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.562, "replay_time_ms": 93.941, "update_priorities_time_ms": 52.057, "policy_agent_0": {"added_count": 2192256, "sampled_count": 11264512, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2192256, "sampled_count": 11264512, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5081351399421692}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5101264715194702}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8740224, "episodes_total": 43752, "training_iteration": 253, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-51-37", "timestamp": 1564915897, "time_this_iter_s": 37.657936334609985, "time_total_s": 8169.74089217186, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd113f378>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd113f400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd113f488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11486a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8169.74089217186, "timesteps_since_restore": 8740224, "iterations_since_restore": 253, "num_healthy_workers": 4}
{"episode_reward_max": 49.59547844300646, "episode_reward_min": 44.91242274279461, "episode_reward_mean": 47.76233460904302, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 23.37409852864336, "agent_1": 24.388236080399658}, "custom_metrics": {"delta0_mean": 0.449775952267947, "delta0_min": 0.4177134952644392, "delta0_max": 0.4672771406036758, "delta1_mean": 0.44363838412957457, "delta1_min": 0.42728001160171597, "delta1_max": 0.4527870201865883, "price0_mean": 1.6404869043309422, "price0_min": 1.6331028011028488, "price0_max": 1.643558633624376, "price1_mean": 1.644829268537309, "price1_min": 1.6335693491991918, "price1_max": 1.6494315074099712}, "sampler_perf": {"mean_env_wait_ms": 1.1277137653701763, "mean_processing_ms": 22.407152381998756, "mean_inference_ms": 2.0510990474592474}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 905, "num_steps_trained": 45451520, "num_steps_sampled": 8765312, "sample_throughput": 3786.915, "train_throughput": 7573.83, "num_weight_syncs": 17118, "num_samples_dropped": 875, "learner_queue": {"size_count": 189157, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.924, "replay_time_ms": 93.852, "update_priorities_time_ms": 51.918, "policy_agent_0": {"added_count": 2198528, "sampled_count": 11318272, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2198528, "sampled_count": 11318272, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5221213102340698}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5122848749160767}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8765312, "episodes_total": 43880, "training_iteration": 254, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-52-16", "timestamp": 1564915936, "time_this_iter_s": 38.77813148498535, "time_total_s": 8208.519023656845, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11a3d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11a3bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11a3c80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11de840>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8208.519023656845, "timesteps_since_restore": 8765312, "iterations_since_restore": 254, "num_healthy_workers": 4}
{"episode_reward_max": 50.89896758852724, "episode_reward_min": 47.18135806268753, "episode_reward_mean": 48.85886896019383, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 23.817241898705397, "agent_1": 25.041627061488438}, "custom_metrics": {"delta0_mean": 0.4490971691978178, "delta0_min": 0.41672931513846917, "delta0_max": 0.46613523282011304, "delta1_mean": 0.442864024440698, "delta1_min": 0.42667373717374385, "delta1_max": 0.4521563701895841, "price0_mean": 1.6401946999579673, "price0_min": 1.6328306360947888, "price0_max": 1.6432960539089527, "price1_mean": 1.6444999122768065, "price1_min": 1.6332206597531451, "price1_max": 1.6490320756626657}, "sampler_perf": {"mean_env_wait_ms": 1.1275977062691154, "mean_processing_ms": 22.46161267290487, "mean_inference_ms": 2.051416412791983}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 909, "num_steps_trained": 45664000, "num_steps_sampled": 8790400, "sample_throughput": 10615.342, "train_throughput": 0.0, "num_weight_syncs": 17167, "num_samples_dropped": 875, "learner_queue": {"size_count": 189987, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.166, "replay_time_ms": 95.119, "update_priorities_time_ms": 55.35, "policy_agent_0": {"added_count": 2205184, "sampled_count": 11372800, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2205184, "sampled_count": 11372800, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5396917462348938}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5136981010437012}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8790400, "episodes_total": 44000, "training_iteration": 255, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-52-55", "timestamp": 1564915975, "time_this_iter_s": 38.24365234375, "time_total_s": 8246.762676000595, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11de0d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11deae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11deb70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11d96a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8246.762676000595, "timesteps_since_restore": 8790400, "iterations_since_restore": 255, "num_healthy_workers": 4}
{"episode_reward_max": 53.12611600622286, "episode_reward_min": 46.823777940143245, "episode_reward_mean": 49.324389559238085, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 24.041326296506266, "agent_1": 25.283063262731833}, "custom_metrics": {"delta0_mean": 0.44780358433202816, "delta0_min": 0.41590201224783424, "delta0_max": 0.46513015783456735, "delta1_mean": 0.4423166770132416, "delta1_min": 0.4261235071199542, "delta1_max": 0.45194418283466953, "price0_mean": 1.6399312571353346, "price0_min": 1.632551657172772, "price0_max": 1.643128348849841, "price1_mean": 1.644119905002677, "price1_min": 1.6329061208209648, "price1_max": 1.6486546826069406}, "sampler_perf": {"mean_env_wait_ms": 1.1272465675969825, "mean_processing_ms": 22.51511661633107, "mean_inference_ms": 2.051097059079818}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 914, "num_steps_trained": 45868544, "num_steps_sampled": 8815488, "sample_throughput": 5213.149, "train_throughput": 0.0, "num_weight_syncs": 17216, "num_samples_dropped": 875, "learner_queue": {"size_count": 190786, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.625, "replay_time_ms": 96.99, "update_priorities_time_ms": 52.524, "policy_agent_0": {"added_count": 2210944, "sampled_count": 11424256, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2210944, "sampled_count": 11424256, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5459449887275696}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5022408962249756}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8815488, "episodes_total": 44128, "training_iteration": 256, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-53-33", "timestamp": 1564916013, "time_this_iter_s": 37.93345022201538, "time_total_s": 8284.69612622261, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11de598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15ada60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15adae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11f3d90>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8284.69612622261, "timesteps_since_restore": 8815488, "iterations_since_restore": 256, "num_healthy_workers": 4}
{"episode_reward_max": 56.89838238540788, "episode_reward_min": 46.77894092484555, "episode_reward_mean": 51.118275619368205, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 24.804438005786643, "agent_1": 26.313837613581534}, "custom_metrics": {"delta0_mean": 0.44701842419225746, "delta0_min": 0.4153394468034966, "delta0_max": 0.4645449473877658, "delta1_mean": 0.44193451342993895, "delta1_min": 0.42572121682613245, "delta1_max": 0.4518123793648811, "price0_mean": 1.6397298653115269, "price0_min": 1.6324043569367295, "price0_max": 1.642980382530262, "price1_mean": 1.6438269766420284, "price1_min": 1.6326856355664598, "price1_max": 1.6483986317530024}, "sampler_perf": {"mean_env_wait_ms": 1.1276545886056304, "mean_processing_ms": 22.569417230591014, "mean_inference_ms": 2.0507787634814925}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 918, "num_steps_trained": 46085120, "num_steps_sampled": 8840576, "sample_throughput": 3776.606, "train_throughput": 7553.211, "num_weight_syncs": 17266, "num_samples_dropped": 875, "learner_queue": {"size_count": 191633, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 13.624, "replay_time_ms": 79.043, "update_priorities_time_ms": 39.499, "policy_agent_0": {"added_count": 2217216, "sampled_count": 11480320, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2217216, "sampled_count": 11480320, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5471371412277222}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4890512228012085}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8840576, "episodes_total": 44256, "training_iteration": 257, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-54-13", "timestamp": 1564916053, "time_this_iter_s": 39.33322477340698, "time_total_s": 8324.029350996017, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd161aea0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15a47b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1597158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1590e18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8324.029350996017, "timesteps_since_restore": 8840576, "iterations_since_restore": 257, "num_healthy_workers": 4}
{"episode_reward_max": 55.9383268908853, "episode_reward_min": 47.94591069643762, "episode_reward_mean": 51.33947099207869, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.368812703873488, "agent_1": 25.970658288205183}, "custom_metrics": {"delta0_mean": 0.446382093127339, "delta0_min": 0.4149155487699436, "delta0_max": 0.46347225994498004, "delta1_mean": 0.4414669924949898, "delta1_min": 0.42515878217967445, "delta1_max": 0.45103862712107395, "price0_mean": 1.6395155455091932, "price0_min": 1.6321541936729507, "price0_max": 1.6426749462621393, "price1_mean": 1.643566664531693, "price1_min": 1.6324720381075204, "price1_max": 1.6480110164580488}, "sampler_perf": {"mean_env_wait_ms": 1.127533686821152, "mean_processing_ms": 22.62224781172777, "mean_inference_ms": 2.05083550028382}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 922, "num_steps_trained": 46295296, "num_steps_sampled": 8865664, "sample_throughput": 13443.619, "train_throughput": 0.0, "num_weight_syncs": 17314, "num_samples_dropped": 875, "learner_queue": {"size_count": 192453, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.217, "replay_time_ms": 101.258, "update_priorities_time_ms": 55.421, "policy_agent_0": {"added_count": 2223232, "sampled_count": 11532800, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2223232, "sampled_count": 11532800, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.5433225035667419}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4880697429180145}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8865664, "episodes_total": 44384, "training_iteration": 258, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-54-52", "timestamp": 1564916092, "time_this_iter_s": 38.79847288131714, "time_total_s": 8362.827823877335, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11de598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11deb70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11deae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1602620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8362.827823877335, "timesteps_since_restore": 8865664, "iterations_since_restore": 258, "num_healthy_workers": 4}
{"episode_reward_max": 57.90470672482804, "episode_reward_min": 47.613121563121005, "episode_reward_mean": 51.32424955084071, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.332150146510642, "agent_1": 25.992099404330077}, "custom_metrics": {"delta0_mean": 0.44574015668306616, "delta0_min": 0.4146714640277492, "delta0_max": 0.46238478086577844, "delta1_mean": 0.44100745708471145, "delta1_min": 0.4246184687209727, "delta1_max": 0.45041857971284865, "price0_mean": 1.6393037335908527, "price0_min": 1.631936070763984, "price0_max": 1.6424042406131225, "price1_mean": 1.6433065795904542, "price1_min": 1.6323500679120808, "price1_max": 1.6476400236109014}, "sampler_perf": {"mean_env_wait_ms": 1.1275715875011558, "mean_processing_ms": 22.67580238859593, "mean_inference_ms": 2.0508196446743807}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 926, "num_steps_trained": 46513920, "num_steps_sampled": 8890752, "sample_throughput": 7875.934, "train_throughput": 15751.868, "num_weight_syncs": 17363, "num_samples_dropped": 875, "learner_queue": {"size_count": 193307, "size_mean": 0.2, "size_std": 0.48989794855663565, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.514, "replay_time_ms": 92.182, "update_priorities_time_ms": 44.357, "policy_agent_0": {"added_count": 2230016, "sampled_count": 11589888, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2230016, "sampled_count": 11589888, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.536168098449707}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4788540005683899}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8890752, "episodes_total": 44512, "training_iteration": 259, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-55-31", "timestamp": 1564916131, "time_this_iter_s": 39.06235218048096, "time_total_s": 8401.890176057816, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16028c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15d4f28>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15d4e18>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1673d90>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8401.890176057816, "timesteps_since_restore": 8890752, "iterations_since_restore": 259, "num_healthy_workers": 4}
{"episode_reward_max": 58.657230629786085, "episode_reward_min": 48.934879640867514, "episode_reward_mean": 52.52628638570892, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.78249985904716, "agent_1": 26.743786526661758}, "custom_metrics": {"delta0_mean": 0.44521646577288576, "delta0_min": 0.4139619216961681, "delta0_max": 0.4613509608004266, "delta1_mean": 0.4407418989499675, "delta1_min": 0.42409097956025416, "delta1_max": 0.4496881330418402, "price0_mean": 1.639143316753756, "price0_min": 1.6317594362961347, "price0_max": 1.6421146323818756, "price1_mean": 1.6430868622013604, "price1_min": 1.6321442551262804, "price1_max": 1.647290191879463}, "sampler_perf": {"mean_env_wait_ms": 1.127641954349801, "mean_processing_ms": 22.737139914493458, "mean_inference_ms": 2.0505851491996485}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 931, "num_steps_trained": 46754816, "num_steps_sampled": 8915840, "sample_throughput": 18058.828, "train_throughput": 36117.657, "num_weight_syncs": 17412, "num_samples_dropped": 875, "learner_queue": {"size_count": 194249, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.548, "replay_time_ms": 105.104, "update_priorities_time_ms": 52.588, "policy_agent_0": {"added_count": 2235904, "sampled_count": 11651072, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2235904, "sampled_count": 11651072, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.517625629901886}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.46825650334358215}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8915840, "episodes_total": 44640, "training_iteration": 260, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-56-12", "timestamp": 1564916172, "time_this_iter_s": 41.42999887466431, "time_total_s": 8443.32017493248, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16027b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1602048>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1597158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16826a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8443.32017493248, "timesteps_since_restore": 8915840, "iterations_since_restore": 260, "num_healthy_workers": 4}
{"episode_reward_max": 58.6834324944516, "episode_reward_min": 48.074044886924646, "episode_reward_mean": 52.68593599787561, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 25.772444803532537, "agent_1": 26.913491194343067}, "custom_metrics": {"delta0_mean": 0.444693265601073, "delta0_min": 0.4136002340524495, "delta0_max": 0.46044700505597624, "delta1_mean": 0.44052089305878295, "delta1_min": 0.42409549287836823, "delta1_max": 0.44938111695999455, "price0_mean": 1.638992936236785, "price0_min": 1.6316511693252704, "price0_max": 1.6419326812940425, "price1_mean": 1.6428707984377202, "price1_min": 1.631932480423882, "price1_max": 1.6469752782010425}, "sampler_perf": {"mean_env_wait_ms": 1.1274919297975468, "mean_processing_ms": 22.79081849154314, "mean_inference_ms": 2.0505477369372422}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 936, "num_steps_trained": 46969856, "num_steps_sampled": 8940928, "sample_throughput": 15786.142, "train_throughput": 0.0, "num_weight_syncs": 17461, "num_samples_dropped": 875, "learner_queue": {"size_count": 195088, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 21.02, "replay_time_ms": 106.241, "update_priorities_time_ms": 54.574, "policy_agent_0": {"added_count": 2241152, "sampled_count": 11703808, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2241152, "sampled_count": 11703808, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.49995532631874084}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4578479826450348}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8940928, "episodes_total": 44768, "training_iteration": 261, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-56-52", "timestamp": 1564916212, "time_this_iter_s": 39.49491095542908, "time_total_s": 8482.815085887909, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16fc598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16fcc80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16fcea0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16c0378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8482.815085887909, "timesteps_since_restore": 8940928, "iterations_since_restore": 261, "num_healthy_workers": 4}
{"episode_reward_max": 58.38225357270778, "episode_reward_min": 50.16341053909447, "episode_reward_mean": 54.62246873372407, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 26.733024272098383, "agent_1": 27.88944446162565}, "custom_metrics": {"delta0_mean": 0.4444157231927869, "delta0_min": 0.41336704582762934, "delta0_max": 0.459776539345056, "delta1_mean": 0.44054798065262846, "delta1_min": 0.42413614642582, "delta1_max": 0.4493507379031821, "price0_mean": 1.6389195126854395, "price0_min": 1.6316127309675152, "price0_max": 1.6418321418361699, "price1_mean": 1.6427328842412647, "price1_min": 1.631770827766912, "price1_max": 1.6467281425008282}, "sampler_perf": {"mean_env_wait_ms": 1.1274115954761328, "mean_processing_ms": 22.845842497813603, "mean_inference_ms": 2.0501543287382513}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 940, "num_steps_trained": 47187712, "num_steps_sampled": 8966016, "sample_throughput": 15585.871, "train_throughput": 0.0, "num_weight_syncs": 17510, "num_samples_dropped": 875, "learner_queue": {"size_count": 195939, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.894, "replay_time_ms": 85.711, "update_priorities_time_ms": 52.501, "policy_agent_0": {"added_count": 2247168, "sampled_count": 11755008, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2247168, "sampled_count": 11755008, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.47435691952705383}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43526604771614075}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8966016, "episodes_total": 44896, "training_iteration": 262, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-57-32", "timestamp": 1564916252, "time_this_iter_s": 40.275190591812134, "time_total_s": 8523.090276479721, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1682950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15d4e18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15d4f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd17226a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8523.090276479721, "timesteps_since_restore": 8966016, "iterations_since_restore": 262, "num_healthy_workers": 4}
{"episode_reward_max": 58.85534642963534, "episode_reward_min": 53.42688176327193, "episode_reward_mean": 56.490971409568914, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 27.877501167263283, "agent_1": 28.61347024230562}, "custom_metrics": {"delta0_mean": 0.44471192592538533, "delta0_min": 0.41320098403385946, "delta0_max": 0.4599006922976655, "delta1_mean": 0.44064630241017044, "delta1_min": 0.4241199895803397, "delta1_max": 0.4496337932452152, "price0_mean": 1.6388968996315711, "price0_min": 1.631630173216525, "price0_max": 1.6418454105393028, "price1_mean": 1.6427043386682698, "price1_min": 1.6316960796764488, "price1_max": 1.6466884290042487}, "sampler_perf": {"mean_env_wait_ms": 1.1272765432711926, "mean_processing_ms": 22.89954069709037, "mean_inference_ms": 2.0504003910155166}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 944, "num_steps_trained": 47418112, "num_steps_sampled": 8991104, "sample_throughput": 18605.174, "train_throughput": 37210.349, "num_weight_syncs": 17559, "num_samples_dropped": 875, "learner_queue": {"size_count": 196839, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.835, "replay_time_ms": 88.352, "update_priorities_time_ms": 50.044, "policy_agent_0": {"added_count": 2253952, "sampled_count": 11811328, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2253952, "sampled_count": 11811328, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.43214815855026245}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.41496390104293823}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 8991104, "episodes_total": 45016, "training_iteration": 263, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-58-11", "timestamp": 1564916291, "time_this_iter_s": 38.64867305755615, "time_total_s": 8561.738949537277, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd17220d0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1722c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd17222f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd170c510>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8561.738949537277, "timesteps_since_restore": 8991104, "iterations_since_restore": 263, "num_healthy_workers": 4}
{"episode_reward_max": 58.89726314954246, "episode_reward_min": 53.34264476956233, "episode_reward_mean": 56.357290662014286, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.61507526011073, "agent_1": 28.742215401903564}, "custom_metrics": {"delta0_mean": 0.4443740061737762, "delta0_min": 0.4131623093750932, "delta0_max": 0.46012059370060604, "delta1_mean": 0.4409853690153152, "delta1_min": 0.4244591836464497, "delta1_max": 0.449793942799793, "price0_mean": 1.638906544508996, "price0_min": 1.6315756497497351, "price0_max": 1.6418059230618862, "price1_mean": 1.6426226498180767, "price1_min": 1.631621755236432, "price1_max": 1.6466933856172135}, "sampler_perf": {"mean_env_wait_ms": 1.1272401444054148, "mean_processing_ms": 22.95765856876187, "mean_inference_ms": 2.049576076296382}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 949, "num_steps_trained": 47640832, "num_steps_sampled": 9016192, "sample_throughput": 15556.966, "train_throughput": 0.0, "num_weight_syncs": 17608, "num_samples_dropped": 875, "learner_queue": {"size_count": 197709, "size_mean": 0.22, "size_std": 0.5015974481593781, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.407, "replay_time_ms": 110.344, "update_priorities_time_ms": 55.112, "policy_agent_0": {"added_count": 2259712, "sampled_count": 11867392, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2259712, "sampled_count": 11867392, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4077886939048767}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39125731587409973}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9016192, "episodes_total": 45144, "training_iteration": 264, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-58-52", "timestamp": 1564916332, "time_this_iter_s": 39.30817222595215, "time_total_s": 8601.04712176323, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1722950>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1722bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1682950>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd176e048>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8601.04712176323, "timesteps_since_restore": 9016192, "iterations_since_restore": 264, "num_healthy_workers": 4}
{"episode_reward_max": 59.670050373899336, "episode_reward_min": 54.68201721794049, "episode_reward_mean": 57.01463824345864, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.439545591766745, "agent_1": 29.575092651691918}, "custom_metrics": {"delta0_mean": 0.4442771381852506, "delta0_min": 0.4132036951067501, "delta0_max": 0.46027423031983233, "delta1_mean": 0.4414337244315489, "delta1_min": 0.4249989448116039, "delta1_max": 0.4501609675108916, "price0_mean": 1.6389525666444236, "price0_min": 1.6316690186872354, "price0_max": 1.6418370244226506, "price1_mean": 1.642569631188338, "price1_min": 1.6316210393165778, "price1_max": 1.6466983142169225}, "sampler_perf": {"mean_env_wait_ms": 1.1270553764445657, "mean_processing_ms": 23.01032753235081, "mean_inference_ms": 2.0501425821816355}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 953, "num_steps_trained": 47850496, "num_steps_sampled": 9041280, "sample_throughput": 8867.597, "train_throughput": 0.0, "num_weight_syncs": 17657, "num_samples_dropped": 875, "learner_queue": {"size_count": 198528, "size_mean": 0.12, "size_std": 0.3249615361854384, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 22.994, "replay_time_ms": 77.308, "update_priorities_time_ms": 38.493, "policy_agent_0": {"added_count": 2265600, "sampled_count": 11922432, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2265600, "sampled_count": 11922432, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.4002700448036194}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38496947288513184}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9041280, "episodes_total": 45272, "training_iteration": 265, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_10-59-32", "timestamp": 1564916372, "time_this_iter_s": 39.29383563995361, "time_total_s": 8640.340957403183, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd176b1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176b488>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176b400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fad1dc31840>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8640.340957403183, "timesteps_since_restore": 9041280, "iterations_since_restore": 265, "num_healthy_workers": 4}
{"episode_reward_max": 60.83884714288227, "episode_reward_min": 55.710863342212065, "episode_reward_mean": 57.29837734718646, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 27.543096130675355, "agent_1": 29.755281216511094}, "custom_metrics": {"delta0_mean": 0.44450448573118206, "delta0_min": 0.41357240968142, "delta0_max": 0.4600633583403463, "delta1_mean": 0.4417998902635135, "delta1_min": 0.42539839494224085, "delta1_max": 0.45056008038578216, "price0_mean": 1.6389926925591325, "price0_min": 1.6318221404644577, "price0_max": 1.6418727117860696, "price1_mean": 1.6425499494782796, "price1_min": 1.6317180762120862, "price1_max": 1.6466225001463979}, "sampler_perf": {"mean_env_wait_ms": 1.1269293601624033, "mean_processing_ms": 23.068869564102954, "mean_inference_ms": 2.051421543248582}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 957, "num_steps_trained": 48068864, "num_steps_sampled": 9066368, "sample_throughput": 24892.589, "train_throughput": 0.0, "num_weight_syncs": 17707, "num_samples_dropped": 875, "learner_queue": {"size_count": 199381, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 21.502, "replay_time_ms": 122.22, "update_priorities_time_ms": 66.373, "policy_agent_0": {"added_count": 2270592, "sampled_count": 11976704, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2270592, "sampled_count": 11976704, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.39794009923934937}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36325138807296753}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9066368, "episodes_total": 45392, "training_iteration": 266, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-00-13", "timestamp": 1564916413, "time_this_iter_s": 41.68812346458435, "time_total_s": 8682.029080867767, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd170cd08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd170c598>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd169f400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1650950>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8682.029080867767, "timesteps_since_restore": 9066368, "iterations_since_restore": 266, "num_healthy_workers": 4}
{"episode_reward_max": 64.95985155579683, "episode_reward_min": 55.83295269203548, "episode_reward_mean": 59.25816894515087, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.40258509509607, "agent_1": 30.85558385005477}, "custom_metrics": {"delta0_mean": 0.4443547835967865, "delta0_min": 0.41381558521499995, "delta0_max": 0.46008061873220857, "delta1_mean": 0.4426568079952077, "delta1_min": 0.42630606886176153, "delta1_max": 0.45150383790990933, "price0_mean": 1.639161817446284, "price0_min": 1.632047196005634, "price0_max": 1.6420677758509028, "price1_mean": 1.6425838647303517, "price1_min": 1.6319188472621275, "price1_max": 1.6465931719813067}, "sampler_perf": {"mean_env_wait_ms": 1.1268478149965946, "mean_processing_ms": 23.126851466689672, "mean_inference_ms": 2.0511794459812362}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 962, "num_steps_trained": 48291328, "num_steps_sampled": 9091456, "sample_throughput": 13027.685, "train_throughput": 26055.371, "num_weight_syncs": 17755, "num_samples_dropped": 875, "learner_queue": {"size_count": 200250, "size_mean": 0.06, "size_std": 0.23748684174075835, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.682, "replay_time_ms": 106.339, "update_priorities_time_ms": 54.985, "policy_agent_0": {"added_count": 2277632, "sampled_count": 12030720, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2277632, "sampled_count": 12030720, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3858005106449127}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34882164001464844}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9091456, "episodes_total": 45520, "training_iteration": 267, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-00-54", "timestamp": 1564916454, "time_this_iter_s": 40.31097412109375, "time_total_s": 8722.340054988861, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd161dd08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd161d950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd161d8c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd162e268>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8722.340054988861, "timesteps_since_restore": 9091456, "iterations_since_restore": 267, "num_healthy_workers": 4}
{"episode_reward_max": 64.81407317636138, "episode_reward_min": 55.23136594334533, "episode_reward_mean": 58.85719685690296, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 27.189170153780346, "agent_1": 31.668026703122578}, "custom_metrics": {"delta0_mean": 0.444196688426283, "delta0_min": 0.4132980077734621, "delta0_max": 0.45958258952081527, "delta1_mean": 0.4436179553654753, "delta1_min": 0.4273321251820703, "delta1_max": 0.45334048392323234, "price0_mean": 1.6393506060214693, "price0_min": 1.6323124264998197, "price0_max": 1.6425504655312941, "price1_mean": 1.64259411202073, "price1_min": 1.6321301708170461, "price1_max": 1.646483064940009}, "sampler_perf": {"mean_env_wait_ms": 1.1269371064038216, "mean_processing_ms": 23.17948307095152, "mean_inference_ms": 2.0512181932217555}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 966, "num_steps_trained": 48510720, "num_steps_sampled": 9116544, "sample_throughput": 18063.689, "train_throughput": 0.0, "num_weight_syncs": 17804, "num_samples_dropped": 875, "learner_queue": {"size_count": 201107, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.092, "replay_time_ms": 104.741, "update_priorities_time_ms": 53.312, "policy_agent_0": {"added_count": 2284928, "sampled_count": 12085248, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2284928, "sampled_count": 12085248, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37733614444732666}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32764631509780884}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9116544, "episodes_total": 45648, "training_iteration": 268, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-01-34", "timestamp": 1564916494, "time_this_iter_s": 40.05188965797424, "time_total_s": 8762.391944646835, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd170c510>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd176b400>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd176b488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11d61e0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8762.391944646835, "timesteps_since_restore": 9116544, "iterations_since_restore": 268, "num_healthy_workers": 4}
{"episode_reward_max": 65.06153715457243, "episode_reward_min": 52.715783501841216, "episode_reward_mean": 56.91166162978769, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 26.316668948528605, "agent_1": 30.594992681259114}, "custom_metrics": {"delta0_mean": 0.44414707973882145, "delta0_min": 0.41287464319445666, "delta0_max": 0.4589529229647331, "delta1_mean": 0.44414415034152116, "delta1_min": 0.42783694664380423, "delta1_max": 0.4549839971033922, "price0_mean": 1.6394241569943242, "price0_min": 1.6324874896743287, "price0_max": 1.6430059556026309, "price1_mean": 1.6425341710232055, "price1_min": 1.6321437872641031, "price1_max": 1.6463060702503658}, "sampler_perf": {"mean_env_wait_ms": 1.126757857466224, "mean_processing_ms": 23.24003775269943, "mean_inference_ms": 2.051673359361627}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 971, "num_steps_trained": 48745728, "num_steps_sampled": 9141632, "sample_throughput": 3540.547, "train_throughput": 7081.095, "num_weight_syncs": 17854, "num_samples_dropped": 875, "learner_queue": {"size_count": 202025, "size_mean": 0.16, "size_std": 0.41761226035642196, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 13.099, "replay_time_ms": 83.865, "update_priorities_time_ms": 41.647, "policy_agent_0": {"added_count": 2290432, "sampled_count": 12144128, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2290432, "sampled_count": 12144128, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3796893060207367}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3168095648288727}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9141632, "episodes_total": 45768, "training_iteration": 269, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-02-15", "timestamp": 1564916535, "time_this_iter_s": 41.14850330352783, "time_total_s": 8803.540447950363, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15f3c80>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15f3268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15f3488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1198730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8803.540447950363, "timesteps_since_restore": 9141632, "iterations_since_restore": 269, "num_healthy_workers": 4}
{"episode_reward_max": 65.06153715457243, "episode_reward_min": 54.19307681462946, "episode_reward_mean": 60.25234110711562, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.067087447855364, "agent_1": 31.18525365926025}, "custom_metrics": {"delta0_mean": 0.4441534734944413, "delta0_min": 0.41334677388173857, "delta0_max": 0.4591147606496384, "delta1_mean": 0.4450957623697019, "delta1_min": 0.4287901723331279, "delta1_max": 0.4566597617802822, "price0_mean": 1.6396417225118292, "price0_min": 1.6326562403398543, "price0_max": 1.643434488272677, "price1_mean": 1.6426247293463727, "price1_min": 1.6322178023805212, "price1_max": 1.6463531874997823}, "sampler_perf": {"mean_env_wait_ms": 1.126326762111382, "mean_processing_ms": 23.293670622379878, "mean_inference_ms": 2.05151825640216}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 975, "num_steps_trained": 48968192, "num_steps_sampled": 9166720, "sample_throughput": 4131.715, "train_throughput": 0.0, "num_weight_syncs": 17903, "num_samples_dropped": 875, "learner_queue": {"size_count": 202894, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 14.952, "replay_time_ms": 94.892, "update_priorities_time_ms": 50.936, "policy_agent_0": {"added_count": 2296832, "sampled_count": 12202240, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2296832, "sampled_count": 12202240, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.38344940543174744}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31982308626174927}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9166720, "episodes_total": 45896, "training_iteration": 270, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-02-55", "timestamp": 1564916575, "time_this_iter_s": 39.96677565574646, "time_total_s": 8843.50722360611, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd170c598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd170c510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd170cd08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15bda60>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8843.50722360611, "timesteps_since_restore": 9166720, "iterations_since_restore": 270, "num_healthy_workers": 4}
{"episode_reward_max": 62.93466329788778, "episode_reward_min": 54.935175827207445, "episode_reward_mean": 60.926786282944626, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.39332981945781, "agent_1": 31.533456463486807}, "custom_metrics": {"delta0_mean": 0.44454108555404026, "delta0_min": 0.41353408724034485, "delta0_max": 0.45959042565335684, "delta1_mean": 0.4460089121213714, "delta1_min": 0.4295285501437473, "delta1_max": 0.4573426645897033, "price0_mean": 1.639863958305916, "price0_min": 1.6328840578011192, "price0_max": 1.6435557646372143, "price1_mean": 1.642761080507479, "price1_min": 1.6323560985373444, "price1_max": 1.6465217074402312}, "sampler_perf": {"mean_env_wait_ms": 1.1262199475185926, "mean_processing_ms": 23.352286386503557, "mean_inference_ms": 2.0512279310765487}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 980, "num_steps_trained": 49196544, "num_steps_sampled": 9191808, "sample_throughput": 17658.485, "train_throughput": 0.0, "num_weight_syncs": 17951, "num_samples_dropped": 875, "learner_queue": {"size_count": 203786, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.696, "replay_time_ms": 96.093, "update_priorities_time_ms": 50.917, "policy_agent_0": {"added_count": 2304896, "sampled_count": 12258304, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2304896, "sampled_count": 12258304, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.37636175751686096}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3030988574028015}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9191808, "episodes_total": 46024, "training_iteration": 271, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-03-36", "timestamp": 1564916616, "time_this_iter_s": 40.94574952125549, "time_total_s": 8884.452973127365, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd117f1e0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd117f510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd117f620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd118be18>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8884.452973127365, "timesteps_since_restore": 9191808, "iterations_since_restore": 271, "num_healthy_workers": 4}
{"episode_reward_max": 64.25418057531977, "episode_reward_min": 55.887139623159854, "episode_reward_mean": 61.53680561027187, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.627397014590077, "agent_1": 31.909408595681818}, "custom_metrics": {"delta0_mean": 0.4449840642737368, "delta0_min": 0.4138737972953372, "delta0_max": 0.4601017005238685, "delta1_mean": 0.4470089469465607, "delta1_min": 0.4305858689695892, "delta1_max": 0.45826336225275144, "price0_mean": 1.640121012062532, "price0_min": 1.6331619234735937, "price0_max": 1.643779631554887, "price1_mean": 1.6429284461977747, "price1_min": 1.6325435352557665, "price1_max": 1.6467108169708886}, "sampler_perf": {"mean_env_wait_ms": 1.1263172054519777, "mean_processing_ms": 23.40736228941066, "mean_inference_ms": 2.0507841836587386}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 984, "num_steps_trained": 49419776, "num_steps_sampled": 9216896, "sample_throughput": 4236.236, "train_throughput": 0.0, "num_weight_syncs": 18001, "num_samples_dropped": 875, "learner_queue": {"size_count": 204658, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.356, "replay_time_ms": 78.551, "update_priorities_time_ms": 51.569, "policy_agent_0": {"added_count": 2311680, "sampled_count": 12313600, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2311680, "sampled_count": 12313600, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.36701732873916626}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2862306535243988}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9216896, "episodes_total": 46152, "training_iteration": 272, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-04-16", "timestamp": 1564916656, "time_this_iter_s": 40.337753772735596, "time_total_s": 8924.7907269001, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd162e268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1198730>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11d6378>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11486a8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8924.7907269001, "timesteps_since_restore": 9216896, "iterations_since_restore": 272, "num_healthy_workers": 4}
{"episode_reward_max": 63.93756938699069, "episode_reward_min": 61.60163545127071, "episode_reward_mean": 62.67810119255707, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.975161857977902, "agent_1": 32.70293933457917}, "custom_metrics": {"delta0_mean": 0.4455105829013717, "delta0_min": 0.414478758062712, "delta0_max": 0.46058022572193896, "delta1_mean": 0.4481980569911707, "delta1_min": 0.4318393037086833, "delta1_max": 0.45936922894987486, "price0_mean": 1.6404438593158035, "price0_min": 1.6334994140510308, "price0_max": 1.6440824112632828, "price1_mean": 1.6431514215817646, "price1_min": 1.632788043856066, "price1_max": 1.6469258944161678}, "sampler_perf": {"mean_env_wait_ms": 1.1263752371031885, "mean_processing_ms": 23.46499005511277, "mean_inference_ms": 2.0509513422313588}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 989, "num_steps_trained": 49643520, "num_steps_sampled": 9241984, "sample_throughput": 7319.154, "train_throughput": 0.0, "num_weight_syncs": 18049, "num_samples_dropped": 875, "learner_queue": {"size_count": 205532, "size_mean": 0.26, "size_std": 0.482078831727758, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.747, "replay_time_ms": 78.667, "update_priorities_time_ms": 50.919, "policy_agent_0": {"added_count": 2317440, "sampled_count": 12368896, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2317440, "sampled_count": 12368896, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3679710626602173}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.28575366735458374}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9241984, "episodes_total": 46280, "training_iteration": 273, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-04-57", "timestamp": 1564916697, "time_this_iter_s": 41.05630397796631, "time_total_s": 8965.847030878067, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11489d8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1148950>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1148a60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1153c80>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 8965.847030878067, "timesteps_since_restore": 9241984, "iterations_since_restore": 273, "num_healthy_workers": 4}
{"episode_reward_max": 64.83180727965521, "episode_reward_min": 61.496122659323504, "episode_reward_mean": 63.112685130087584, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 30.36025116551196, "agent_1": 32.75243396457562}, "custom_metrics": {"delta0_mean": 0.44612763784748133, "delta0_min": 0.4152093315386198, "delta0_max": 0.4611039175106156, "delta1_mean": 0.44939302200936126, "delta1_min": 0.43307791317465, "delta1_max": 0.4605246779775023, "price0_mean": 1.6407852835039212, "price0_min": 1.6338467410495916, "price0_max": 1.6444201891448786, "price1_mean": 1.6434051513971335, "price1_min": 1.6330519504163352, "price1_max": 1.6471477153239225}, "sampler_perf": {"mean_env_wait_ms": 1.1263944695751058, "mean_processing_ms": 23.51619351252295, "mean_inference_ms": 2.050685051346974}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 993, "num_steps_trained": 49869824, "num_steps_sampled": 9267072, "sample_throughput": 16336.637, "train_throughput": 0.0, "num_weight_syncs": 18098, "num_samples_dropped": 875, "learner_queue": {"size_count": 206416, "size_mean": 0.22, "size_std": 0.46, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 23.814, "replay_time_ms": 95.443, "update_priorities_time_ms": 43.038, "policy_agent_0": {"added_count": 2323072, "sampled_count": 12425728, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2323072, "sampled_count": 12425728, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3690706491470337}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2731298804283142}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9267072, "episodes_total": 46408, "training_iteration": 274, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-05-38", "timestamp": 1564916738, "time_this_iter_s": 40.18259334564209, "time_total_s": 9006.02962422371, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd118be18>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd117f620>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd117f510>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11509d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9006.02962422371, "timesteps_since_restore": 9267072, "iterations_since_restore": 274, "num_healthy_workers": 4}
{"episode_reward_max": 63.238433900845585, "episode_reward_min": 61.31406775048769, "episode_reward_mean": 62.333722853124726, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 30.107220567735308, "agent_1": 32.226502285389415}, "custom_metrics": {"delta0_mean": 0.44695345260496727, "delta0_min": 0.41579479521039475, "delta0_max": 0.46160090034602613, "delta1_mean": 0.45026885313866827, "delta1_min": 0.4340150329668496, "delta1_max": 0.4614203006924834, "price0_mean": 1.6410315081477123, "price0_min": 1.6341579408596587, "price0_max": 1.6446601356363661, "price1_mean": 1.6436168899436359, "price1_min": 1.6332927450169787, "price1_max": 1.647345219770157}, "sampler_perf": {"mean_env_wait_ms": 1.1264121502769728, "mean_processing_ms": 23.5696683658241, "mean_inference_ms": 2.0504962858400066}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 998, "num_steps_trained": 50092800, "num_steps_sampled": 9292160, "sample_throughput": 2631.823, "train_throughput": 10527.293, "num_weight_syncs": 18147, "num_samples_dropped": 875, "learner_queue": {"size_count": 207287, "size_mean": 0.18, "size_std": 0.38418745424597095, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.959, "replay_time_ms": 100.265, "update_priorities_time_ms": 48.494, "policy_agent_0": {"added_count": 2328064, "sampled_count": 12482048, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2328064, "sampled_count": 12482048, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.34578806161880493}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.277557909488678}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9292160, "episodes_total": 46528, "training_iteration": 275, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-06-19", "timestamp": 1564916779, "time_this_iter_s": 40.354028940200806, "time_total_s": 9046.38365316391, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1150d08>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1150c80>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1150d90>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1164048>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9046.38365316391, "timesteps_since_restore": 9292160, "iterations_since_restore": 275, "num_healthy_workers": 4}
{"episode_reward_max": 63.65962499226625, "episode_reward_min": 61.52054834213207, "episode_reward_mean": 62.74270721113834, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 30.182793012060692, "agent_1": 32.559914199077646}, "custom_metrics": {"delta0_mean": 0.4472114961699334, "delta0_min": 0.4163596554739781, "delta0_max": 0.46219842465545324, "delta1_mean": 0.4515233664490682, "delta1_min": 0.4352155708916479, "delta1_max": 0.462534897182255, "price0_mean": 1.641365028928874, "price0_min": 1.6345009537159003, "price0_max": 1.6449533964385206, "price1_mean": 1.643823589059399, "price1_min": 1.633573092043621, "price1_max": 1.6475838822494613}, "sampler_perf": {"mean_env_wait_ms": 1.1266060080931573, "mean_processing_ms": 23.627047380749215, "mean_inference_ms": 2.0492507049337485}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1002, "num_steps_trained": 50316288, "num_steps_sampled": 9317248, "sample_throughput": 12984.833, "train_throughput": 0.0, "num_weight_syncs": 18196, "num_samples_dropped": 875, "learner_queue": {"size_count": 208160, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.368, "replay_time_ms": 95.104, "update_priorities_time_ms": 46.277, "policy_agent_0": {"added_count": 2333440, "sampled_count": 12540160, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2333440, "sampled_count": 12540160, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35400500893592834}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2691527307033539}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9317248, "episodes_total": 46656, "training_iteration": 276, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-06-59", "timestamp": 1564916819, "time_this_iter_s": 40.49951100349426, "time_total_s": 9086.883164167404, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1150bf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1150b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1150ae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1164ae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9086.883164167404, "timesteps_since_restore": 9317248, "iterations_since_restore": 276, "num_healthy_workers": 4}
{"episode_reward_max": 64.88488441588893, "episode_reward_min": 61.658696126596155, "episode_reward_mean": 63.345457233521074, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 31.02619400321617, "agent_1": 32.31926323030493}, "custom_metrics": {"delta0_mean": 0.4479811664660269, "delta0_min": 0.41720386929575054, "delta0_max": 0.46292168080344637, "delta1_mean": 0.45259430310225557, "delta1_min": 0.4363136155374757, "delta1_max": 0.46356660825238993, "price0_mean": 1.6416926005321062, "price0_min": 1.6348362228541242, "price0_max": 1.6452640973017467, "price1_mean": 1.6441015693561924, "price1_min": 1.6338709339906594, "price1_max": 1.6478522684785413}, "sampler_perf": {"mean_env_wait_ms": 1.126690711502384, "mean_processing_ms": 23.680021997869453, "mean_inference_ms": 2.0490418419326746}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1007, "num_steps_trained": 50540288, "num_steps_sampled": 9342336, "sample_throughput": 8887.414, "train_throughput": 0.0, "num_weight_syncs": 18245, "num_samples_dropped": 875, "learner_queue": {"size_count": 209036, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 16.5, "replay_time_ms": 108.096, "update_priorities_time_ms": 51.865, "policy_agent_0": {"added_count": 2338944, "sampled_count": 12596480, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2338944, "sampled_count": 12596480, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32497116923332214}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2704172134399414}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9342336, "episodes_total": 46784, "training_iteration": 277, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-07-40", "timestamp": 1564916860, "time_this_iter_s": 40.2652370929718, "time_total_s": 9127.148401260376, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11507b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11508c8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1150730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11530d0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9127.148401260376, "timesteps_since_restore": 9342336, "iterations_since_restore": 277, "num_healthy_workers": 4}
{"episode_reward_max": 63.64375434382877, "episode_reward_min": 61.825015706080784, "episode_reward_mean": 62.65595257294601, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 30.460002154596197, "agent_1": 32.19595041834981}, "custom_metrics": {"delta0_mean": 0.44860883235267635, "delta0_min": 0.4179148069230868, "delta0_max": 0.46349344166347506, "delta1_mean": 0.4536301125038387, "delta1_min": 0.4374377426693095, "delta1_max": 0.4646007107604202, "price0_mean": 1.6419862222449577, "price0_min": 1.6351434519175403, "price0_max": 1.6455564404120335, "price1_mean": 1.6443300812558368, "price1_min": 1.634124486452985, "price1_max": 1.6480593004261486}, "sampler_perf": {"mean_env_wait_ms": 1.1265808074891517, "mean_processing_ms": 23.735297255784598, "mean_inference_ms": 2.0482821761975405}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1011, "num_steps_trained": 50767360, "num_steps_sampled": 9367424, "sample_throughput": 12098.499, "train_throughput": 0.0, "num_weight_syncs": 18293, "num_samples_dropped": 875, "learner_queue": {"size_count": 209923, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 13.072, "replay_time_ms": 77.814, "update_priorities_time_ms": 42.467, "policy_agent_0": {"added_count": 2343424, "sampled_count": 12653312, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2343424, "sampled_count": 12653312, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31041547656059265}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2756563425064087}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9367424, "episodes_total": 46912, "training_iteration": 278, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-08-21", "timestamp": 1564916901, "time_this_iter_s": 40.6648805141449, "time_total_s": 9167.81328177452, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1148f28>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1148b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1148ea0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd118bae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9167.81328177452, "timesteps_since_restore": 9367424, "iterations_since_restore": 278, "num_healthy_workers": 4}
{"episode_reward_max": 64.93240354980142, "episode_reward_min": 62.125203715947485, "episode_reward_mean": 63.02455058475721, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 31.265446334878302, "agent_1": 31.759104249878888}, "custom_metrics": {"delta0_mean": 0.44942813499369116, "delta0_min": 0.41875943609732663, "delta0_max": 0.4643393844968941, "delta1_mean": 0.45455425681143075, "delta1_min": 0.43846292974228285, "delta1_max": 0.4655362343596647, "price0_mean": 1.6422806538694656, "price0_min": 1.63545331114021, "price0_max": 1.6458393870913786, "price1_mean": 1.6445993780968768, "price1_min": 1.6344331104145926, "price1_max": 1.648325588906001}, "sampler_perf": {"mean_env_wait_ms": 1.1267876206996184, "mean_processing_ms": 23.788414373880656, "mean_inference_ms": 2.0480843229789576}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1016, "num_steps_trained": 50983680, "num_steps_sampled": 9392512, "sample_throughput": 20427.323, "train_throughput": 0.0, "num_weight_syncs": 18344, "num_samples_dropped": 875, "learner_queue": {"size_count": 210767, "size_mean": 0.2, "size_std": 0.4, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.152, "replay_time_ms": 72.713, "update_priorities_time_ms": 42.99, "policy_agent_0": {"added_count": 2348928, "sampled_count": 12709120, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2348928, "sampled_count": 12709120, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31024667620658875}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2749934494495392}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9392512, "episodes_total": 47040, "training_iteration": 279, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-09-02", "timestamp": 1564916942, "time_this_iter_s": 40.9869818687439, "time_total_s": 9208.800263643265, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1150b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11507b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1150bf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd117f400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9208.800263643265, "timesteps_since_restore": 9392512, "iterations_since_restore": 279, "num_healthy_workers": 4}
{"episode_reward_max": 63.635437508082, "episode_reward_min": 59.85956666425111, "episode_reward_mean": 62.00481883312059, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.774861769568737, "agent_1": 32.22995706355186}, "custom_metrics": {"delta0_mean": 0.44988391410540685, "delta0_min": 0.4193144286789057, "delta0_max": 0.46471459712753616, "delta1_mean": 0.4555870416144845, "delta1_min": 0.4395463734469062, "delta1_max": 0.46652570791386144, "price0_mean": 1.6425530629534082, "price0_min": 1.6357447025287528, "price0_max": 1.6461000649721902, "price1_mean": 1.6447806348375182, "price1_min": 1.6346374511925579, "price1_max": 1.648490285820575}, "sampler_perf": {"mean_env_wait_ms": 1.1264418112338728, "mean_processing_ms": 23.842534773314338, "mean_inference_ms": 2.048092868356089}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1020, "num_steps_trained": 51212288, "num_steps_sampled": 9417600, "sample_throughput": 7858.871, "train_throughput": 0.0, "num_weight_syncs": 18391, "num_samples_dropped": 875, "learner_queue": {"size_count": 211661, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 21.179, "replay_time_ms": 80.359, "update_priorities_time_ms": 48.614, "policy_agent_0": {"added_count": 2355200, "sampled_count": 12765440, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2355200, "sampled_count": 12765440, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3084266185760498}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2664334177970886}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9417600, "episodes_total": 47168, "training_iteration": 280, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-09-43", "timestamp": 1564916983, "time_this_iter_s": 40.651527643203735, "time_total_s": 9249.451791286469, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15bd840>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15bdea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15bdc80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15eaae8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9249.451791286469, "timesteps_since_restore": 9417600, "iterations_since_restore": 280, "num_healthy_workers": 4}
{"episode_reward_max": 62.10399331682747, "episode_reward_min": 58.29768390670242, "episode_reward_mean": 60.951502684899026, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.15153158062632, "agent_1": 31.7999711042727}, "custom_metrics": {"delta0_mean": 0.4501872399606543, "delta0_min": 0.41970227203748567, "delta0_max": 0.46494389946264536, "delta1_mean": 0.4565109179753447, "delta1_min": 0.44053366784889986, "delta1_max": 0.46744094480365467, "price0_mean": 1.642775969482814, "price0_min": 1.635983584749418, "price0_max": 1.6463196099858703, "price1_mean": 1.6449029421506824, "price1_min": 1.6347868360374331, "price1_max": 1.6485891323502202}, "sampler_perf": {"mean_env_wait_ms": 1.126811849821632, "mean_processing_ms": 23.895949922303174, "mean_inference_ms": 2.0480392522737034}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1025, "num_steps_trained": 51452928, "num_steps_sampled": 9442688, "sample_throughput": 9450.123, "train_throughput": 0.0, "num_weight_syncs": 18441, "num_samples_dropped": 875, "learner_queue": {"size_count": 212600, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.955, "replay_time_ms": 96.59, "update_priorities_time_ms": 51.21, "policy_agent_0": {"added_count": 2361344, "sampled_count": 12824832, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2361344, "sampled_count": 12824832, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29053592681884766}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2614280581474304}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9442688, "episodes_total": 47296, "training_iteration": 281, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-10-25", "timestamp": 1564917025, "time_this_iter_s": 41.09467101097107, "time_total_s": 9290.54646229744, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1150730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1150b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11508c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11d6268>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9290.54646229744, "timesteps_since_restore": 9442688, "iterations_since_restore": 281, "num_healthy_workers": 4}
{"episode_reward_max": 65.58731728845669, "episode_reward_min": 57.754243932920204, "episode_reward_mean": 60.772131295441156, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 30.220818893828884, "agent_1": 30.551312401612265}, "custom_metrics": {"delta0_mean": 0.45104503419157094, "delta0_min": 0.4199362605904428, "delta0_max": 0.46586253174629705, "delta1_mean": 0.45695648771234276, "delta1_min": 0.4413374487521154, "delta1_max": 0.4681854403892691, "price0_mean": 1.642945826669275, "price0_min": 1.6362117818106443, "price0_max": 1.6464755430777682, "price1_mean": 1.6450900064898057, "price1_min": 1.6350775874480958, "price1_max": 1.648845383799684}, "sampler_perf": {"mean_env_wait_ms": 1.1269113075875257, "mean_processing_ms": 23.94933206497977, "mean_inference_ms": 2.0482059520126437}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1029, "num_steps_trained": 51679488, "num_steps_sampled": 9467776, "sample_throughput": 12188.039, "train_throughput": 0.0, "num_weight_syncs": 18490, "num_samples_dropped": 875, "learner_queue": {"size_count": 213485, "size_mean": 0.12, "size_std": 0.32496153618543844, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.027, "replay_time_ms": 83.962, "update_priorities_time_ms": 44.489, "policy_agent_0": {"added_count": 2367360, "sampled_count": 12880128, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2367360, "sampled_count": 12880128, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2887640595436096}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2666569948196411}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9467776, "episodes_total": 47416, "training_iteration": 282, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-11-05", "timestamp": 1564917065, "time_this_iter_s": 40.74721813201904, "time_total_s": 9331.293680429459, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd15ded90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15de7b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd15de598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1627400>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9331.293680429459, "timesteps_since_restore": 9467776, "iterations_since_restore": 282, "num_healthy_workers": 4}
{"episode_reward_max": 61.106851100552156, "episode_reward_min": 59.287496426030955, "episode_reward_mean": 60.217204402892904, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.353210857153673, "agent_1": 31.863993545739234}, "custom_metrics": {"delta0_mean": 0.4508180537945743, "delta0_min": 0.42011471215794793, "delta0_max": 0.4659844839443577, "delta1_mean": 0.4580232035047468, "delta1_min": 0.4423231582812282, "delta1_max": 0.4691011479489603, "price0_mean": 1.643164463660106, "price0_min": 1.6364291468505567, "price0_max": 1.6466680753950038, "price1_mean": 1.6451327770346933, "price1_min": 1.635167438906718, "price1_max": 1.6489157448472862}, "sampler_perf": {"mean_env_wait_ms": 1.1269173284470972, "mean_processing_ms": 24.009259908419057, "mean_inference_ms": 2.0481512062852336}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1034, "num_steps_trained": 51899904, "num_steps_sampled": 9492864, "sample_throughput": 3457.549, "train_throughput": 0.0, "num_weight_syncs": 18539, "num_samples_dropped": 875, "learner_queue": {"size_count": 214347, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 17.243, "replay_time_ms": 113.265, "update_priorities_time_ms": 55.597, "policy_agent_0": {"added_count": 2373120, "sampled_count": 12937728, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2373120, "sampled_count": 12937728, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2998737692832947}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27076318860054016}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9492864, "episodes_total": 47544, "training_iteration": 283, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-11-47", "timestamp": 1564917107, "time_this_iter_s": 41.74762463569641, "time_total_s": 9373.041305065155, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1150730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1150b70>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1150bf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16508c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9373.041305065155, "timesteps_since_restore": 9492864, "iterations_since_restore": 283, "num_healthy_workers": 4}
{"episode_reward_max": 62.560220870892636, "episode_reward_min": 57.161009948075446, "episode_reward_mean": 60.3799542245329, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.380411132091336, "agent_1": 31.99954309244157}, "custom_metrics": {"delta0_mean": 0.45093298656632214, "delta0_min": 0.420360490945034, "delta0_max": 0.466145497754412, "delta1_mean": 0.4589809132749696, "delta1_min": 0.44333708790041637, "delta1_max": 0.47000847829327824, "price0_mean": 1.6433726947254463, "price0_min": 1.6366578484536174, "price0_max": 1.6468559301873567, "price1_mean": 1.6452078271992812, "price1_min": 1.6352744081010038, "price1_max": 1.6490028502041563}, "sampler_perf": {"mean_env_wait_ms": 1.1269310523124842, "mean_processing_ms": 24.065702045751323, "mean_inference_ms": 2.0478175730407577}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1038, "num_steps_trained": 52125952, "num_steps_sampled": 9517952, "sample_throughput": 19703.131, "train_throughput": 0.0, "num_weight_syncs": 18588, "num_samples_dropped": 875, "learner_queue": {"size_count": 215229, "size_mean": 0.24, "size_std": 0.47159304490206383, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.849, "replay_time_ms": 105.449, "update_priorities_time_ms": 52.123, "policy_agent_0": {"added_count": 2378880, "sampled_count": 12994560, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2378880, "sampled_count": 12994560, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.298674613237381}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2617546319961548}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9517952, "episodes_total": 47672, "training_iteration": 284, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-12-29", "timestamp": 1564917149, "time_this_iter_s": 41.47475337982178, "time_total_s": 9414.516058444977, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1650400>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1650ae8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1632400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1796730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9414.516058444977, "timesteps_since_restore": 9517952, "iterations_since_restore": 284, "num_healthy_workers": 4}
{"episode_reward_max": 61.85115272705921, "episode_reward_min": 59.29689281138655, "episode_reward_mean": 60.81018954696868, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 29.06268720381228, "agent_1": 31.747502343156405}, "custom_metrics": {"delta0_mean": 0.4515271829658339, "delta0_min": 0.4206635746909301, "delta0_max": 0.4663763610099548, "delta1_mean": 0.45968480345705076, "delta1_min": 0.4441879130814031, "delta1_max": 0.47075671555664983, "price0_mean": 1.6435465551677126, "price0_min": 1.6368801059257576, "price0_max": 1.6470253652403528, "price1_mean": 1.6453354797525284, "price1_min": 1.6354056124906386, "price1_max": 1.6490940834471466}, "sampler_perf": {"mean_env_wait_ms": 1.126918058672363, "mean_processing_ms": 24.116397291083445, "mean_inference_ms": 2.048221268616912}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1043, "num_steps_trained": 52350976, "num_steps_sampled": 9543040, "sample_throughput": 3464.577, "train_throughput": 0.0, "num_weight_syncs": 18637, "num_samples_dropped": 875, "learner_queue": {"size_count": 216109, "size_mean": 0.24, "size_std": 0.4270831300812525, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 24.726, "replay_time_ms": 109.715, "update_priorities_time_ms": 52.812, "policy_agent_0": {"added_count": 2385024, "sampled_count": 13050112, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2385024, "sampled_count": 13050112, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.30531832575798035}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.26169466972351074}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9543040, "episodes_total": 47792, "training_iteration": 285, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-13-09", "timestamp": 1564917189, "time_this_iter_s": 40.35130596160889, "time_total_s": 9454.867364406586, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1150b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1150bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1150730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1776488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9454.867364406586, "timesteps_since_restore": 9543040, "iterations_since_restore": 285, "num_healthy_workers": 4}
{"episode_reward_max": 62.08639378014139, "episode_reward_min": 58.70455865495627, "episode_reward_mean": 60.60941794536965, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.92373429868961, "agent_1": 31.685683646680054}, "custom_metrics": {"delta0_mean": 0.45143388252407146, "delta0_min": 0.4209155878483175, "delta0_max": 0.46664707929694477, "delta1_mean": 0.46069149726634057, "delta1_min": 0.44514483269300126, "delta1_max": 0.4716530385700353, "price0_mean": 1.6437635339418015, "price0_min": 1.6370860782495724, "price0_max": 1.6472256588806957, "price1_mean": 1.6454057239382394, "price1_min": 1.6355264457323, "price1_max": 1.6491932669812288}, "sampler_perf": {"mean_env_wait_ms": 1.126644798219606, "mean_processing_ms": 24.17212026441898, "mean_inference_ms": 2.047847799579973}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1048, "num_steps_trained": 52592896, "num_steps_sampled": 9568128, "sample_throughput": 5979.783, "train_throughput": 11959.566, "num_weight_syncs": 18686, "num_samples_dropped": 875, "learner_queue": {"size_count": 217054, "size_mean": 0.24, "size_std": 0.5122499389946279, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.454, "replay_time_ms": 88.046, "update_priorities_time_ms": 51.072, "policy_agent_0": {"added_count": 2390528, "sampled_count": 13113600, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2390528, "sampled_count": 13113600, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3209167420864105}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2751590311527252}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9568128, "episodes_total": 47920, "training_iteration": 286, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-13-51", "timestamp": 1564917231, "time_this_iter_s": 40.72539687156677, "time_total_s": 9495.592761278152, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1776598>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1776510>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1776840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd171bea0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9495.592761278152, "timesteps_since_restore": 9568128, "iterations_since_restore": 286, "num_healthy_workers": 4}
{"episode_reward_max": 61.6372522232248, "episode_reward_min": 58.18781543776709, "episode_reward_mean": 59.594344383404355, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 28.311409775229976, "agent_1": 31.282934608174397}, "custom_metrics": {"delta0_mean": 0.45153023001851017, "delta0_min": 0.4210613459953533, "delta0_max": 0.46667927056086544, "delta1_mean": 0.4614650272332187, "delta1_min": 0.4459999704296984, "delta1_max": 0.4723944165465696, "price0_mean": 1.6439201977202045, "price0_min": 1.6372562830269937, "price0_max": 1.6473746720532358, "price1_mean": 1.645451068261956, "price1_min": 1.635593180211614, "price1_max": 1.6492256615843064}, "sampler_perf": {"mean_env_wait_ms": 1.1263672039766026, "mean_processing_ms": 24.22684294268046, "mean_inference_ms": 2.0473422927498515}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1052, "num_steps_trained": 52817920, "num_steps_sampled": 9593216, "sample_throughput": 11003.934, "train_throughput": 22007.867, "num_weight_syncs": 18735, "num_samples_dropped": 875, "learner_queue": {"size_count": 217933, "size_mean": 0.16, "size_std": 0.36660605559646714, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.524, "replay_time_ms": 106.725, "update_priorities_time_ms": 55.8, "policy_agent_0": {"added_count": 2396800, "sampled_count": 13171200, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2396800, "sampled_count": 13171200, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32339876890182495}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.27094101905822754}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9593216, "episodes_total": 48048, "training_iteration": 287, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-14-32", "timestamp": 1564917272, "time_this_iter_s": 40.84918522834778, "time_total_s": 9536.4419465065, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1776158>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1776bf8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1632400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1737730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9536.4419465065, "timesteps_since_restore": 9593216, "iterations_since_restore": 287, "num_healthy_workers": 4}
{"episode_reward_max": 61.16441983478225, "episode_reward_min": 57.41630124793612, "episode_reward_mean": 59.16925653528924, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 28.129417737388657, "agent_1": 31.039838797900593}, "custom_metrics": {"delta0_mean": 0.4512473559997557, "delta0_min": 0.4212512765842932, "delta0_max": 0.4666509886674505, "delta1_mean": 0.4622669041766265, "delta1_min": 0.44671879080973986, "delta1_max": 0.4730284691614866, "price0_mean": 1.644067897710458, "price0_min": 1.6374034625486478, "price0_max": 1.6474932123448625, "price1_mean": 1.6454508174618132, "price1_min": 1.6356387415560998, "price1_max": 1.649236260025058}, "sampler_perf": {"mean_env_wait_ms": 1.1263537569223956, "mean_processing_ms": 24.2791538424177, "mean_inference_ms": 2.0472052110050902}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1057, "num_steps_trained": 53049856, "num_steps_sampled": 9618304, "sample_throughput": 2755.318, "train_throughput": 5510.636, "num_weight_syncs": 18785, "num_samples_dropped": 875, "learner_queue": {"size_count": 218839, "size_mean": 0.32, "size_std": 0.5455272678794342, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 21.461, "replay_time_ms": 106.671, "update_priorities_time_ms": 51.806, "policy_agent_0": {"added_count": 2403712, "sampled_count": 13228800, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2403712, "sampled_count": 13228800, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.33761751651763916}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2706097364425659}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9618304, "episodes_total": 48168, "training_iteration": 288, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-15-13", "timestamp": 1564917313, "time_this_iter_s": 40.22551870346069, "time_total_s": 9576.667465209961, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c0620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c02f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16c0950>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd16fc598>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9576.667465209961, "timesteps_since_restore": 9618304, "iterations_since_restore": 288, "num_healthy_workers": 4}
{"episode_reward_max": 61.246044477279334, "episode_reward_min": 58.187873138307566, "episode_reward_mean": 59.54954278868095, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 29.052597960191715, "agent_1": 30.496944828489237}, "custom_metrics": {"delta0_mean": 0.45150282207432574, "delta0_min": 0.4215593311065854, "delta0_max": 0.4668869262467765, "delta1_mean": 0.46281467246052554, "delta1_min": 0.44736238866481143, "delta1_max": 0.4735824844239324, "price0_mean": 1.6441838507382551, "price0_min": 1.6375282209788697, "price0_max": 1.6476095105457775, "price1_mean": 1.6455150429605605, "price1_min": 1.63572025451546, "price1_max": 1.6492919392541732}, "sampler_perf": {"mean_env_wait_ms": 1.126615659026575, "mean_processing_ms": 24.33160252494354, "mean_inference_ms": 2.0474275064880563}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1061, "num_steps_trained": 53272064, "num_steps_sampled": 9643392, "sample_throughput": 13548.793, "train_throughput": 0.0, "num_weight_syncs": 18833, "num_samples_dropped": 875, "learner_queue": {"size_count": 219706, "size_mean": 0.18, "size_std": 0.4331281565541543, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 19.097, "replay_time_ms": 100.564, "update_priorities_time_ms": 52.676, "policy_agent_0": {"added_count": 2411136, "sampled_count": 13282560, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2411136, "sampled_count": 13282560, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3437008857727051}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.26936131715774536}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9643392, "episodes_total": 48288, "training_iteration": 289, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-15-56", "timestamp": 1564917356, "time_this_iter_s": 40.83851885795593, "time_total_s": 9617.505984067917, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1737268>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd171bea0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd171b268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd160c8c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9617.505984067917, "timesteps_since_restore": 9643392, "iterations_since_restore": 289, "num_healthy_workers": 4}
{"episode_reward_max": 61.610088922186094, "episode_reward_min": 58.13630260232699, "episode_reward_mean": 59.774033715603935, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.283459116620293, "agent_1": 30.49057459898365}, "custom_metrics": {"delta0_mean": 0.4521554474333668, "delta0_min": 0.4219784071558849, "delta0_max": 0.46716091629930073, "delta1_mean": 0.4632548940897059, "delta1_min": 0.44801288491633284, "delta1_max": 0.4742092486446768, "price0_mean": 1.6442907484096096, "price0_min": 1.6376603124092113, "price0_max": 1.6477526292606541, "price1_mean": 1.6456211561992706, "price1_min": 1.6358240746873567, "price1_max": 1.649353379770742}, "sampler_perf": {"mean_env_wait_ms": 1.126831470374398, "mean_processing_ms": 24.388082535650316, "mean_inference_ms": 2.0478256283934693}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1066, "num_steps_trained": 53508352, "num_steps_sampled": 9668480, "sample_throughput": 8043.612, "train_throughput": 0.0, "num_weight_syncs": 18882, "num_samples_dropped": 875, "learner_queue": {"size_count": 220629, "size_mean": 0.26, "size_std": 0.5219195340279956, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 17.483, "replay_time_ms": 94.778, "update_priorities_time_ms": 51.115, "policy_agent_0": {"added_count": 2416384, "sampled_count": 13339648, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2416384, "sampled_count": 13339648, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3461005687713623}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2812730073928833}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9668480, "episodes_total": 48416, "training_iteration": 290, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-16-38", "timestamp": 1564917398, "time_this_iter_s": 42.014222621917725, "time_total_s": 9659.520206689835, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16737b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1673378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1673b70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1602a60>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9659.520206689835, "timesteps_since_restore": 9668480, "iterations_since_restore": 290, "num_healthy_workers": 4}
{"episode_reward_max": 60.333989050056076, "episode_reward_min": 55.598547455115025, "episode_reward_mean": 58.370807482131504, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 28.540983670189767, "agent_1": 29.829823811941743}, "custom_metrics": {"delta0_mean": 0.45262017755825673, "delta0_min": 0.42220593720220095, "delta0_max": 0.46721745969671313, "delta1_mean": 0.4635112601493196, "delta1_min": 0.4484164291644502, "delta1_max": 0.47454630674902987, "price0_mean": 1.6443342753373948, "price0_min": 1.6377390888519876, "price0_max": 1.6478049796555951, "price1_mean": 1.6456621521877808, "price1_min": 1.6358571237366275, "price1_max": 1.6493469959968852}, "sampler_perf": {"mean_env_wait_ms": 1.1267078277822231, "mean_processing_ms": 24.437624583875515, "mean_inference_ms": 2.0477856463137982}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1070, "num_steps_trained": 53734144, "num_steps_sampled": 9693568, "sample_throughput": 12881.707, "train_throughput": 0.0, "num_weight_syncs": 18932, "num_samples_dropped": 875, "learner_queue": {"size_count": 221511, "size_mean": 0.14, "size_std": 0.4004996878900157, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.536, "replay_time_ms": 95.582, "update_priorities_time_ms": 47.832, "policy_agent_0": {"added_count": 2423552, "sampled_count": 13394688, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2423552, "sampled_count": 13394688, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3366321623325348}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2773798704147339}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9693568, "episodes_total": 48536, "training_iteration": 291, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-17-19", "timestamp": 1564917439, "time_this_iter_s": 40.920006275177, "time_total_s": 9700.440212965012, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16c0620>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16c02f0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1737268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15d10d0>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9700.440212965012, "timesteps_since_restore": 9693568, "iterations_since_restore": 291, "num_healthy_workers": 4}
{"episode_reward_max": 59.823016335093115, "episode_reward_min": 56.53639727751822, "episode_reward_mean": 58.30266006289358, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.7972259731446, "agent_1": 28.50543408974898}, "custom_metrics": {"delta0_mean": 0.4527321960454105, "delta0_min": 0.4227918736099432, "delta0_max": 0.46755369996297136, "delta1_mean": 0.4637558554517286, "delta1_min": 0.44859585809251407, "delta1_max": 0.4746767420112805, "price0_mean": 1.6443721899907633, "price0_min": 1.6377592426574543, "price0_max": 1.6478350034232936, "price1_mean": 1.6456991887543486, "price1_min": 1.6359231764889524, "price1_max": 1.6493800897821354}, "sampler_perf": {"mean_env_wait_ms": 1.1269430908965141, "mean_processing_ms": 24.495310428290285, "mean_inference_ms": 2.0467837748267432}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1075, "num_steps_trained": 53983488, "num_steps_sampled": 9718656, "sample_throughput": 14688.269, "train_throughput": 0.0, "num_weight_syncs": 18979, "num_samples_dropped": 875, "learner_queue": {"size_count": 222485, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 23.189, "replay_time_ms": 83.444, "update_priorities_time_ms": 40.178, "policy_agent_0": {"added_count": 2430464, "sampled_count": 13458176, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2430464, "sampled_count": 13458176, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.332632452249527}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2811252772808075}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9718656, "episodes_total": 48664, "training_iteration": 292, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-18-01", "timestamp": 1564917481, "time_this_iter_s": 42.48228120803833, "time_total_s": 9742.92249417305, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1590048>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd15901e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1590950>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd15a1620>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9742.92249417305, "timesteps_since_restore": 9718656, "iterations_since_restore": 292, "num_healthy_workers": 4}
{"episode_reward_max": 61.41220694425477, "episode_reward_min": 55.51193350520205, "episode_reward_mean": 58.040566563240574, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.789389123637864, "agent_1": 28.25117743960271}, "custom_metrics": {"delta0_mean": 0.45316772659851934, "delta0_min": 0.4233998210822642, "delta0_max": 0.46790954996229567, "delta1_mean": 0.4638040087410129, "delta1_min": 0.4486292589870661, "delta1_max": 0.47469633149515117, "price0_mean": 1.6443761083743418, "price0_min": 1.6377823519862365, "price0_max": 1.6478360888763086, "price1_mean": 1.645757205475952, "price1_min": 1.6359948742183943, "price1_max": 1.6494164135353306}, "sampler_perf": {"mean_env_wait_ms": 1.1270877495329952, "mean_processing_ms": 24.551676521049657, "mean_inference_ms": 2.046482363643312}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1080, "num_steps_trained": 54211840, "num_steps_sampled": 9743744, "sample_throughput": 7329.496, "train_throughput": 0.0, "num_weight_syncs": 19030, "num_samples_dropped": 875, "learner_queue": {"size_count": 223378, "size_mean": 0.16, "size_std": 0.417612260356422, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 13.955, "replay_time_ms": 94.493, "update_priorities_time_ms": 52.459, "policy_agent_0": {"added_count": 2436992, "sampled_count": 13516032, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2436992, "sampled_count": 13516032, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3307238221168518}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2871524393558502}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9743744, "episodes_total": 48792, "training_iteration": 293, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-18-45", "timestamp": 1564917525, "time_this_iter_s": 42.12856721878052, "time_total_s": 9785.05106139183, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16737b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1673378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16731e0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11d99d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9785.05106139183, "timesteps_since_restore": 9743744, "iterations_since_restore": 293, "num_healthy_workers": 4}
{"episode_reward_max": 57.79345747778552, "episode_reward_min": 55.22266358560972, "episode_reward_mean": 56.71821047968638, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 29.412157670484497, "agent_1": 27.306052809201876}, "custom_metrics": {"delta0_mean": 0.45380825030329447, "delta0_min": 0.42375275076813945, "delta0_max": 0.4682187895580751, "delta1_mean": 0.4635060772499126, "delta1_min": 0.44850329822326557, "delta1_max": 0.4745302206662525, "price0_mean": 1.644296937582824, "price0_min": 1.637735006557272, "price0_max": 1.6477754260600603, "price1_mean": 1.6457949926626432, "price1_min": 1.6360269784830006, "price1_max": 1.6494222169776072}, "sampler_perf": {"mean_env_wait_ms": 1.127419431765039, "mean_processing_ms": 24.60303407893451, "mean_inference_ms": 2.046652918213999}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1085, "num_steps_trained": 54449408, "num_steps_sampled": 9768832, "sample_throughput": 20253.93, "train_throughput": 0.0, "num_weight_syncs": 19078, "num_samples_dropped": 875, "learner_queue": {"size_count": 224305, "size_mean": 0.66, "size_std": 1.422814112946593, "size_quantiles": [0.0, 0.0, 0.0, 2.1000000000000014, 6.0]}, "replay_shard_0": {"add_batch_time_ms": 14.259, "replay_time_ms": 78.599, "update_priorities_time_ms": 47.116, "policy_agent_0": {"added_count": 2443648, "sampled_count": 13575680, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2443648, "sampled_count": 13575680, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3205886483192444}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.31047314405441284}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9768832, "episodes_total": 48912, "training_iteration": 294, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-19-26", "timestamp": 1564917566, "time_this_iter_s": 40.95361661911011, "time_total_s": 9826.00467801094, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11d98c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11d9d08>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11d9840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11de840>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9826.00467801094, "timesteps_since_restore": 9768832, "iterations_since_restore": 294, "num_healthy_workers": 4}
{"episode_reward_max": 60.61448317277051, "episode_reward_min": 54.64365759602437, "episode_reward_mean": 57.52614185868899, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.549702724413855, "agent_1": 27.976439134275132}, "custom_metrics": {"delta0_mean": 0.4538650746995101, "delta0_min": 0.4242428909959063, "delta0_max": 0.4685193485921935, "delta1_mean": 0.46362904043341013, "delta1_min": 0.448528295983826, "delta1_max": 0.4745017143584958, "price0_mean": 1.6443014351196164, "price0_min": 1.6377351512835165, "price0_max": 1.6477577113538506, "price1_mean": 1.6458114803558215, "price1_min": 1.6360908468600217, "price1_max": 1.6494409568608852}, "sampler_perf": {"mean_env_wait_ms": 1.1278036934837916, "mean_processing_ms": 24.6622113395847, "mean_inference_ms": 2.04611983909435}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1089, "num_steps_trained": 54684672, "num_steps_sampled": 9793920, "sample_throughput": 2601.346, "train_throughput": 10405.382, "num_weight_syncs": 19128, "num_samples_dropped": 875, "learner_queue": {"size_count": 225224, "size_mean": 0.26, "size_std": 0.48207883172775806, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 14.505, "replay_time_ms": 90.084, "update_priorities_time_ms": 46.015, "policy_agent_0": {"added_count": 2450688, "sampled_count": 13635328, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2450688, "sampled_count": 13635328, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3258092701435089}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3014543354511261}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9793920, "episodes_total": 49040, "training_iteration": 295, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-20-10", "timestamp": 1564917610, "time_this_iter_s": 42.393290996551514, "time_total_s": 9868.397969007492, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16737b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1673378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1673b70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11ab378>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9868.397969007492, "timesteps_since_restore": 9793920, "iterations_since_restore": 295, "num_healthy_workers": 4}
{"episode_reward_max": 62.03319559440416, "episode_reward_min": 55.239632227851246, "episode_reward_mean": 58.08610753260656, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 29.80634020032834, "agent_1": 28.27976733227823}, "custom_metrics": {"delta0_mean": 0.45459029324008166, "delta0_min": 0.4246522614349913, "delta0_max": 0.4689505180500169, "delta1_mean": 0.4635436334870428, "delta1_min": 0.4486146605608661, "delta1_max": 0.47454028837812107, "price0_mean": 1.6442885865361396, "price0_min": 1.6377631638546837, "price0_max": 1.647755690985362, "price1_mean": 1.6458929740800465, "price1_min": 1.636182654793127, "price1_max": 1.6495069165663256}, "sampler_perf": {"mean_env_wait_ms": 1.1278761100293002, "mean_processing_ms": 24.716118653918166, "mean_inference_ms": 2.046697551435111}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1094, "num_steps_trained": 54921728, "num_steps_sampled": 9819008, "sample_throughput": 21264.741, "train_throughput": 0.0, "num_weight_syncs": 19175, "num_samples_dropped": 875, "learner_queue": {"size_count": 226150, "size_mean": 0.14, "size_std": 0.3469870314579494, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 20.482, "replay_time_ms": 101.685, "update_priorities_time_ms": 46.816, "policy_agent_0": {"added_count": 2457856, "sampled_count": 13696000, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2457856, "sampled_count": 13696000, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3262535333633423}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32116442918777466}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9819008, "episodes_total": 49160, "training_iteration": 296, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-20-52", "timestamp": 1564917652, "time_this_iter_s": 41.95468878746033, "time_total_s": 9910.352657794952, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11abd90>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11abe18>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11abb70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1172730>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9910.352657794952, "timesteps_since_restore": 9819008, "iterations_since_restore": 296, "num_healthy_workers": 4}
{"episode_reward_max": 61.643150500438665, "episode_reward_min": 54.44198684367933, "episode_reward_mean": 57.98465752925755, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 29.97360478544362, "agent_1": 28.011052743813927}, "custom_metrics": {"delta0_mean": 0.4543981007315539, "delta0_min": 0.4252792191727701, "delta0_max": 0.469293716543283, "delta1_mean": 0.46380949544049255, "delta1_min": 0.4486180274578165, "delta1_max": 0.4744808512676573, "price0_mean": 1.6443292675733825, "price0_min": 1.6377707710243725, "price0_max": 1.6477431618750833, "price1_mean": 1.6459105928884736, "price1_min": 1.636254691157981, "price1_max": 1.6495507111429195}, "sampler_perf": {"mean_env_wait_ms": 1.1279675839054428, "mean_processing_ms": 24.772761350775955, "mean_inference_ms": 2.045865137032245}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1099, "num_steps_trained": 55159296, "num_steps_sampled": 9844096, "sample_throughput": 7706.465, "train_throughput": 0.0, "num_weight_syncs": 19226, "num_samples_dropped": 875, "learner_queue": {"size_count": 227078, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 15.54, "replay_time_ms": 106.807, "update_priorities_time_ms": 50.524, "policy_agent_0": {"added_count": 2465152, "sampled_count": 13754112, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2465152, "sampled_count": 13754112, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3297359347343445}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.32250264286994934}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9844096, "episodes_total": 49280, "training_iteration": 297, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-21-33", "timestamp": 1564917693, "time_this_iter_s": 40.99159836769104, "time_total_s": 9951.344256162643, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd16737b8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1673378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd16731e0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1171488>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9951.344256162643, "timesteps_since_restore": 9844096, "iterations_since_restore": 297, "num_healthy_workers": 4}
{"episode_reward_max": 58.03451475604525, "episode_reward_min": 54.445751303062956, "episode_reward_mean": 56.12177581523934, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 29.562964738603494, "agent_1": 26.558811076635845}, "custom_metrics": {"delta0_mean": 0.455084630604924, "delta0_min": 0.42572212126207454, "delta0_max": 0.46960924437356355, "delta1_mean": 0.4633316220350545, "delta1_min": 0.448309263947102, "delta1_max": 0.4741296708889216, "price0_mean": 1.6442097455704792, "price0_min": 1.637699222527377, "price0_max": 1.6476420094596806, "price1_mean": 1.645946819183023, "price1_min": 1.6362925001657498, "price1_max": 1.6495518830691849}, "sampler_perf": {"mean_env_wait_ms": 1.1279412123064816, "mean_processing_ms": 24.827663598969675, "mean_inference_ms": 2.0459467895964862}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1103, "num_steps_trained": 55389696, "num_steps_sampled": 9869184, "sample_throughput": 19505.556, "train_throughput": 0.0, "num_weight_syncs": 19274, "num_samples_dropped": 875, "learner_queue": {"size_count": 227978, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 15.458, "replay_time_ms": 83.792, "update_priorities_time_ms": 50.576, "policy_agent_0": {"added_count": 2471296, "sampled_count": 13809408, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2471296, "sampled_count": 13809408, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.327565461397171}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3337976336479187}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9869184, "episodes_total": 49408, "training_iteration": 298, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-22-17", "timestamp": 1564917737, "time_this_iter_s": 42.045403242111206, "time_total_s": 9993.389659404755, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1171730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11717b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1171840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd117ca60>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 9993.389659404755, "timesteps_since_restore": 9869184, "iterations_since_restore": 298, "num_healthy_workers": 4}
{"episode_reward_max": 62.552788761834925, "episode_reward_min": 51.582449855563006, "episode_reward_mean": 57.47679558791988, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 30.13050982885329, "agent_1": 27.346285759066586}, "custom_metrics": {"delta0_mean": 0.45525076734600595, "delta0_min": 0.4263797667820122, "delta0_max": 0.4699004150549128, "delta1_mean": 0.4633196060188175, "delta1_min": 0.44822369684031177, "delta1_max": 0.47400277193160134, "price0_mean": 1.6442032339377812, "price0_min": 1.6376754094704842, "price0_max": 1.6476396428061761, "price1_mean": 1.6459890657091967, "price1_min": 1.6363557623543485, "price1_max": 1.6495671733926722}, "sampler_perf": {"mean_env_wait_ms": 1.128060331388656, "mean_processing_ms": 24.882620735044057, "mean_inference_ms": 2.045898196259491}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1108, "num_steps_trained": 55625472, "num_steps_sampled": 9894272, "sample_throughput": 8623.74, "train_throughput": 17247.479, "num_weight_syncs": 19323, "num_samples_dropped": 875, "learner_queue": {"size_count": 228899, "size_mean": 0.22, "size_std": 0.5758472019555188, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 17.022, "replay_time_ms": 70.679, "update_priorities_time_ms": 48.536, "policy_agent_0": {"added_count": 2477696, "sampled_count": 13867776, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2477696, "sampled_count": 13867776, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3242257237434387}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.35029253363609314}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9894272, "episodes_total": 49528, "training_iteration": 299, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-22-59", "timestamp": 1564917779, "time_this_iter_s": 42.62096190452576, "time_total_s": 10036.01062130928, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1673b70>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd16737b8>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1602a60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd10ff7b8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 10036.01062130928, "timesteps_since_restore": 9894272, "iterations_since_restore": 299, "num_healthy_workers": 4}
{"episode_reward_max": 65.34890918480046, "episode_reward_min": 56.36192117443076, "episode_reward_mean": 62.907528935725885, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 32.55811293614048, "agent_1": 30.3494159995854}, "custom_metrics": {"delta0_mean": 0.4568527391371024, "delta0_min": 0.42728562502101053, "delta0_max": 0.47094320309325927, "delta1_mean": 0.4635424451020195, "delta1_min": 0.4486307458253279, "delta1_max": 0.47444479302814796, "price0_mean": 1.6443733677958232, "price0_min": 1.6379061355410829, "price0_max": 1.6478295185397918, "price1_mean": 1.6463034599747923, "price1_min": 1.6366741463507117, "price1_max": 1.649854249694642}, "sampler_perf": {"mean_env_wait_ms": 1.1279039169955607, "mean_processing_ms": 24.930481745953667, "mean_inference_ms": 2.0470531415481528}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1113, "num_steps_trained": 55858688, "num_steps_sampled": 9919360, "sample_throughput": 3050.698, "train_throughput": 6101.395, "num_weight_syncs": 19372, "num_samples_dropped": 875, "learner_queue": {"size_count": 229811, "size_mean": 0.1, "size_std": 0.3, "size_quantiles": [0.0, 0.0, 0.0, 0.10000000000000142, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 18.483, "replay_time_ms": 87.762, "update_priorities_time_ms": 50.529, "policy_agent_0": {"added_count": 2483968, "sampled_count": 13926400, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2483968, "sampled_count": 13926400, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.313480019569397}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3537486791610718}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9919360, "episodes_total": 49648, "training_iteration": 300, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-23-41", "timestamp": 1564917821, "time_this_iter_s": 41.81440496444702, "time_total_s": 10077.825026273727, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd10ffae8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd10ffa60>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd10ffb70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1108d90>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 10077.825026273727, "timesteps_since_restore": 9919360, "iterations_since_restore": 300, "num_healthy_workers": 4}
{"episode_reward_max": 67.15934106559814, "episode_reward_min": 60.43568996304763, "episode_reward_mean": 64.01163514009508, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 32.807058676793844, "agent_1": 31.20457646330123}, "custom_metrics": {"delta0_mean": 0.4576475292119129, "delta0_min": 0.42846820215252307, "delta0_max": 0.472032852772722, "delta1_mean": 0.4644002020823193, "delta1_min": 0.4494147470305425, "delta1_max": 0.47516349067295055, "price0_mean": 1.6447040686806427, "price0_min": 1.6382052332396204, "price0_max": 1.6481363570050065, "price1_mean": 1.646635704279201, "price1_min": 1.6370389799611398, "price1_max": 1.6502018120276902}, "sampler_perf": {"mean_env_wait_ms": 1.1282657636716888, "mean_processing_ms": 24.98832853144772, "mean_inference_ms": 2.0466575085461716}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1117, "num_steps_trained": 56094208, "num_steps_sampled": 9944448, "sample_throughput": 12338.456, "train_throughput": 0.0, "num_weight_syncs": 19422, "num_samples_dropped": 875, "learner_queue": {"size_count": 230730, "size_mean": 0.24, "size_std": 0.5851495535331118, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 3.0]}, "replay_shard_0": {"add_batch_time_ms": 18.144, "replay_time_ms": 100.365, "update_priorities_time_ms": 49.581, "policy_agent_0": {"added_count": 2490496, "sampled_count": 13986560, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2490496, "sampled_count": 13986560, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3076511323451996}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3523709177970886}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9944448, "episodes_total": 49776, "training_iteration": 301, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-24-25", "timestamp": 1564917865, "time_this_iter_s": 43.43873929977417, "time_total_s": 10121.263765573502, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd117c8c8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd117c378>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd117c488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11719d8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 10121.263765573502, "timesteps_since_restore": 9944448, "iterations_since_restore": 301, "num_healthy_workers": 4}
{"episode_reward_max": 66.93454932379602, "episode_reward_min": 61.74043938965785, "episode_reward_mean": 64.43214621264279, "episode_len_mean": 100.0, "episodes_this_iter": 120, "policy_reward_mean": {"agent_0": 32.374165355003605, "agent_1": 32.05798085763919}, "custom_metrics": {"delta0_mean": 0.45827791462916795, "delta0_min": 0.42951327643531206, "delta0_max": 0.47295696064649423, "delta1_mean": 0.465403009590907, "delta1_min": 0.45034950357513487, "delta1_max": 0.4759725973730863, "price0_mean": 1.6450575353370853, "price0_min": 1.6384801884693274, "price0_max": 1.6484446102299832, "price1_mean": 1.6469482672179403, "price1_min": 1.6373541172944273, "price1_max": 1.6504972770446764}, "sampler_perf": {"mean_env_wait_ms": 1.12813336868592, "mean_processing_ms": 25.04484779607767, "mean_inference_ms": 2.0463464690047433}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1122, "num_steps_trained": 56337664, "num_steps_sampled": 9969536, "sample_throughput": 12357.2, "train_throughput": 0.0, "num_weight_syncs": 19470, "num_samples_dropped": 875, "learner_queue": {"size_count": 231681, "size_mean": 0.08, "size_std": 0.2712931993250107, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 1.0]}, "replay_shard_0": {"add_batch_time_ms": 19.387, "replay_time_ms": 93.766, "update_priorities_time_ms": 47.899, "policy_agent_0": {"added_count": 2496384, "sampled_count": 14045184, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2496384, "sampled_count": 14045184, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.29738062620162964}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.343929648399353}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9969536, "episodes_total": 49896, "training_iteration": 302, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-25-08", "timestamp": 1564917908, "time_this_iter_s": 42.587342977523804, "time_total_s": 10163.851108551025, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd1172730>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1172d90>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd1172d08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd1164c80>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 10163.851108551025, "timesteps_since_restore": 9969536, "iterations_since_restore": 302, "num_healthy_workers": 4}
{"episode_reward_max": 66.00522841573812, "episode_reward_min": 62.39085025082918, "episode_reward_mean": 63.97666955640189, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 32.67046431557063, "agent_1": 31.306205240831265}, "custom_metrics": {"delta0_mean": 0.45964942794915886, "delta0_min": 0.43057929590180766, "delta0_max": 0.47399616514983856, "delta1_mean": 0.465992778836469, "delta1_min": 0.4512308265935048, "delta1_max": 0.4770326420320866, "price0_mean": 1.645334455873766, "price0_min": 1.6388011053179543, "price0_max": 1.6488424610041674, "price1_mean": 1.647306572432853, "price1_min": 1.6377212334435434, "price1_max": 1.6508344727982098}, "sampler_perf": {"mean_env_wait_ms": 1.127965217286815, "mean_processing_ms": 25.09790040788313, "mean_inference_ms": 2.046751425541393}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1127, "num_steps_trained": 56574464, "num_steps_sampled": 9994624, "sample_throughput": 14240.608, "train_throughput": 0.0, "num_weight_syncs": 19519, "num_samples_dropped": 875, "learner_queue": {"size_count": 232606, "size_mean": 0.2, "size_std": 0.4472135954999579, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 18.345, "replay_time_ms": 91.523, "update_priorities_time_ms": 49.858, "policy_agent_0": {"added_count": 2502528, "sampled_count": 14105600, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2502528, "sampled_count": 14105600, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.2857384979724884}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3276820182800293}}}, "timesteps_this_iter": 25088, "done": false, "timesteps_total": 9994624, "episodes_total": 50024, "training_iteration": 303, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-25-51", "timestamp": 1564917951, "time_this_iter_s": 42.977784395217896, "time_total_s": 10206.828892946243, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11712f0>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd1171268>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd117c488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11de8c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 10206.828892946243, "timesteps_since_restore": 9994624, "iterations_since_restore": 303, "num_healthy_workers": 4}
{"episode_reward_max": 65.51243241211418, "episode_reward_min": 63.592217909555956, "episode_reward_mean": 64.57156902667677, "episode_len_mean": 100.0, "episodes_this_iter": 128, "policy_reward_mean": {"agent_0": 33.57075575541892, "agent_1": 31.00081327125784}, "custom_metrics": {"delta0_mean": 0.46091090232571363, "delta0_min": 0.4319670250475107, "delta0_max": 0.4751827154003024, "delta1_mean": 0.466657213161295, "delta1_min": 0.45189311701161144, "delta1_max": 0.47765088471876777, "price0_mean": 1.6456526259035145, "price0_min": 1.6391330861357993, "price0_max": 1.649156844681309, "price1_mean": 1.6476944593472203, "price1_min": 1.6381271272687548, "price1_max": 1.6512012688774096}, "sampler_perf": {"mean_env_wait_ms": 1.1280174715842137, "mean_processing_ms": 25.15135386248354, "mean_inference_ms": 2.047061636304713}, "off_policy_estimator": {}, "num_metric_batches_dropped": 0, "info": {"min_exploration": 0.0, "max_exploration": 0.4, "num_target_updates": 1132, "num_steps_trained": 56818176, "num_steps_sampled": 10019712, "sample_throughput": 18891.932, "train_throughput": 0.0, "num_weight_syncs": 19569, "num_samples_dropped": 875, "learner_queue": {"size_count": 233558, "size_mean": 0.2, "size_std": 0.4898979485566356, "size_quantiles": [0.0, 0.0, 0.0, 1.0, 2.0]}, "replay_shard_0": {"add_batch_time_ms": 16.894, "replay_time_ms": 96.418, "update_priorities_time_ms": 45.658, "policy_agent_0": {"added_count": 2509824, "sampled_count": 14166272, "est_size_bytes": 65151176, "num_entries": 50000}, "policy_agent_1": {"added_count": 2509824, "sampled_count": 14166272, "est_size_bytes": 65151176, "num_entries": 50000}}, "learner": {"agent_0": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.279911071062088}, "agent_1": {"cur_lr": 0.0005000000237487257, "mean_td_error": 0.3210364282131195}}}, "timesteps_this_iter": 25088, "done": true, "timesteps_total": 10019712, "episodes_total": 50152, "training_iteration": 304, "experiment_id": "1c2ba205a0cf4a589df8b2bb94a7da70", "date": "2019-08-04_11-26-34", "timestamp": 1564917994, "time_this_iter_s": 42.789546251297, "time_total_s": 10249.61843919754, "pid": 4366, "hostname": "RL-K80", "node_ip": "10.0.0.4", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function on_episode_start at 0x7fadd11debf8>)", "on_episode_step": "tune.function(<function on_episode_step at 0x7fadd11de1e0>)", "on_episode_end": "tune.function(<function on_episode_end at 0x7fadd11de7b8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "use_eager": false, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {"max_weight_sync_delay": 400, "num_replay_buffer_shards": 4, "debug": false}, "gamma": 0.975, "horizon": 100, "soft_horizon": true, "env_config": {"num_agents": 2, "max_steps": 1000000000, "p_min": 1.2, "p_max": 2}, "env": "MultiAgentFirmsPricingContinuous", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "num_workers": 4, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 8, "sample_batch_size": 16, "train_batch_size": 256, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": true, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 30, "timesteps_per_iteration": 25000, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"agent_0": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}], "agent_1": ["<class 'ray.rllib.policy.tf_policy_template.DQNTFPolicy'>", "Box(2,)", "Discrete(5)", {}]}, "policy_mapping_fn": "tune.function(<function policy_mapping_fn at 0x7fadd11d98c8>)", "policies_to_train": null}, "num_atoms": 5, "v_min": -10.0, "v_max": 10.0, "noisy": false, "sigma0": 0.5, "dueling": true, "double_q": true, "hiddens": [24], "n_step": 3, "schedule_max_timesteps": 10000000, "exploration_fraction": 0.02, "exploration_final_eps": 0.01, "target_network_update_freq": 50000, "soft_q": false, "softmax_temp": 1.0, "parameter_noise": false, "buffer_size": 200000, "prioritized_replay": true, "prioritized_replay_alpha": 0.5, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 1.0, "prioritized_replay_eps": 1e-06, "lr_schedule": null, "adam_epsilon": 0.00015, "grad_norm_clipping": 40, "learning_starts": 20000, "per_worker_exploration": true, "worker_side_prioritization": true}, "time_since_restore": 10249.61843919754, "timesteps_since_restore": 10019712, "iterations_since_restore": 304, "num_healthy_workers": 4}
